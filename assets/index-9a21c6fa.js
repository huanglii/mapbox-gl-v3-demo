var gF=Object.defineProperty;var _F=(e,r,a)=>r in e?gF(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a;var wn=(e,r,a)=>(_F(e,typeof r!="symbol"?r+"":r,a),a);function sA(e,r){for(var a=0;a<r.length;a++){const c=r[a];if(typeof c!="string"&&!Array.isArray(c)){for(const d in c)if(d!=="default"&&!(d in e)){const x=Object.getOwnPropertyDescriptor(c,d);x&&Object.defineProperty(e,d,x.get?x:{enumerable:!0,get:()=>c[d]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))c(d);new MutationObserver(d=>{for(const x of d)if(x.type==="childList")for(const T of x.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&c(T)}).observe(document,{childList:!0,subtree:!0});function a(d){const x={};return d.integrity&&(x.integrity=d.integrity),d.referrerPolicy&&(x.referrerPolicy=d.referrerPolicy),d.crossOrigin==="use-credentials"?x.credentials="include":d.crossOrigin==="anonymous"?x.credentials="omit":x.credentials="same-origin",x}function c(d){if(d.ep)return;d.ep=!0;const x=a(d);fetch(d.href,x)}})();var yF=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function P_(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var lA={exports:{}},b1={},cA={exports:{}},zn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var A_=Symbol.for("react.element"),vF=Symbol.for("react.portal"),xF=Symbol.for("react.fragment"),bF=Symbol.for("react.strict_mode"),wF=Symbol.for("react.profiler"),SF=Symbol.for("react.provider"),EF=Symbol.for("react.context"),TF=Symbol.for("react.forward_ref"),CF=Symbol.for("react.suspense"),MF=Symbol.for("react.memo"),IF=Symbol.for("react.lazy"),kM=Symbol.iterator;function PF(e){return e===null||typeof e!="object"?null:(e=kM&&e[kM]||e["@@iterator"],typeof e=="function"?e:null)}var uA={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},hA=Object.assign,dA={};function Mp(e,r,a){this.props=e,this.context=r,this.refs=dA,this.updater=a||uA}Mp.prototype.isReactComponent={};Mp.prototype.setState=function(e,r){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,r,"setState")};Mp.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function fA(){}fA.prototype=Mp.prototype;function x3(e,r,a){this.props=e,this.context=r,this.refs=dA,this.updater=a||uA}var b3=x3.prototype=new fA;b3.constructor=x3;hA(b3,Mp.prototype);b3.isPureReactComponent=!0;var DM=Array.isArray,pA=Object.prototype.hasOwnProperty,w3={current:null},mA={key:!0,ref:!0,__self:!0,__source:!0};function gA(e,r,a){var c,d={},x=null,T=null;if(r!=null)for(c in r.ref!==void 0&&(T=r.ref),r.key!==void 0&&(x=""+r.key),r)pA.call(r,c)&&!mA.hasOwnProperty(c)&&(d[c]=r[c]);var i=arguments.length-2;if(i===1)d.children=a;else if(1<i){for(var L=Array(i),N=0;N<i;N++)L[N]=arguments[N+2];d.children=L}if(e&&e.defaultProps)for(c in i=e.defaultProps,i)d[c]===void 0&&(d[c]=i[c]);return{$$typeof:A_,type:e,key:x,ref:T,props:d,_owner:w3.current}}function AF(e,r){return{$$typeof:A_,type:e.type,key:r,ref:e.ref,props:e.props,_owner:e._owner}}function S3(e){return typeof e=="object"&&e!==null&&e.$$typeof===A_}function RF(e){var r={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(a){return r[a]})}var OM=/\/+/g;function vw(e,r){return typeof e=="object"&&e!==null&&e.key!=null?RF(""+e.key):r.toString(36)}function _v(e,r,a,c,d){var x=typeof e;(x==="undefined"||x==="boolean")&&(e=null);var T=!1;if(e===null)T=!0;else switch(x){case"string":case"number":T=!0;break;case"object":switch(e.$$typeof){case A_:case vF:T=!0}}if(T)return T=e,d=d(T),e=c===""?"."+vw(T,0):c,DM(d)?(a="",e!=null&&(a=e.replace(OM,"$&/")+"/"),_v(d,r,a,"",function(N){return N})):d!=null&&(S3(d)&&(d=AF(d,a+(!d.key||T&&T.key===d.key?"":(""+d.key).replace(OM,"$&/")+"/")+e)),r.push(d)),1;if(T=0,c=c===""?".":c+":",DM(e))for(var i=0;i<e.length;i++){x=e[i];var L=c+vw(x,i);T+=_v(x,r,a,L,d)}else if(L=PF(e),typeof L=="function")for(e=L.call(e),i=0;!(x=e.next()).done;)x=x.value,L=c+vw(x,i++),T+=_v(x,r,a,L,d);else if(x==="object")throw r=String(e),Error("Objects are not valid as a React child (found: "+(r==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":r)+"). If you meant to render a collection of children, use an array instead.");return T}function Ny(e,r,a){if(e==null)return e;var c=[],d=0;return _v(e,c,"","",function(x){return r.call(a,x,d++)}),c}function zF(e){if(e._status===-1){var r=e._result;r=r(),r.then(function(a){(e._status===0||e._status===-1)&&(e._status=1,e._result=a)},function(a){(e._status===0||e._status===-1)&&(e._status=2,e._result=a)}),e._status===-1&&(e._status=0,e._result=r)}if(e._status===1)return e._result.default;throw e._result}var ma={current:null},yv={transition:null},LF={ReactCurrentDispatcher:ma,ReactCurrentBatchConfig:yv,ReactCurrentOwner:w3};function _A(){throw Error("act(...) is not supported in production builds of React.")}zn.Children={map:Ny,forEach:function(e,r,a){Ny(e,function(){r.apply(this,arguments)},a)},count:function(e){var r=0;return Ny(e,function(){r++}),r},toArray:function(e){return Ny(e,function(r){return r})||[]},only:function(e){if(!S3(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};zn.Component=Mp;zn.Fragment=xF;zn.Profiler=wF;zn.PureComponent=x3;zn.StrictMode=bF;zn.Suspense=CF;zn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=LF;zn.act=_A;zn.cloneElement=function(e,r,a){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var c=hA({},e.props),d=e.key,x=e.ref,T=e._owner;if(r!=null){if(r.ref!==void 0&&(x=r.ref,T=w3.current),r.key!==void 0&&(d=""+r.key),e.type&&e.type.defaultProps)var i=e.type.defaultProps;for(L in r)pA.call(r,L)&&!mA.hasOwnProperty(L)&&(c[L]=r[L]===void 0&&i!==void 0?i[L]:r[L])}var L=arguments.length-2;if(L===1)c.children=a;else if(1<L){i=Array(L);for(var N=0;N<L;N++)i[N]=arguments[N+2];c.children=i}return{$$typeof:A_,type:e.type,key:d,ref:x,props:c,_owner:T}};zn.createContext=function(e){return e={$$typeof:EF,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:SF,_context:e},e.Consumer=e};zn.createElement=gA;zn.createFactory=function(e){var r=gA.bind(null,e);return r.type=e,r};zn.createRef=function(){return{current:null}};zn.forwardRef=function(e){return{$$typeof:TF,render:e}};zn.isValidElement=S3;zn.lazy=function(e){return{$$typeof:IF,_payload:{_status:-1,_result:e},_init:zF}};zn.memo=function(e,r){return{$$typeof:MF,type:e,compare:r===void 0?null:r}};zn.startTransition=function(e){var r=yv.transition;yv.transition={};try{e()}finally{yv.transition=r}};zn.unstable_act=_A;zn.useCallback=function(e,r){return ma.current.useCallback(e,r)};zn.useContext=function(e){return ma.current.useContext(e)};zn.useDebugValue=function(){};zn.useDeferredValue=function(e){return ma.current.useDeferredValue(e)};zn.useEffect=function(e,r){return ma.current.useEffect(e,r)};zn.useId=function(){return ma.current.useId()};zn.useImperativeHandle=function(e,r,a){return ma.current.useImperativeHandle(e,r,a)};zn.useInsertionEffect=function(e,r){return ma.current.useInsertionEffect(e,r)};zn.useLayoutEffect=function(e,r){return ma.current.useLayoutEffect(e,r)};zn.useMemo=function(e,r){return ma.current.useMemo(e,r)};zn.useReducer=function(e,r,a){return ma.current.useReducer(e,r,a)};zn.useRef=function(e){return ma.current.useRef(e)};zn.useState=function(e){return ma.current.useState(e)};zn.useSyncExternalStore=function(e,r,a){return ma.current.useSyncExternalStore(e,r,a)};zn.useTransition=function(){return ma.current.useTransition()};zn.version="18.3.1";cA.exports=zn;var $=cA.exports;const sn=P_($),R_=sA({__proto__:null,default:sn},[$]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kF=$,DF=Symbol.for("react.element"),OF=Symbol.for("react.fragment"),FF=Object.prototype.hasOwnProperty,BF=kF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,NF={key:!0,ref:!0,__self:!0,__source:!0};function yA(e,r,a){var c,d={},x=null,T=null;a!==void 0&&(x=""+a),r.key!==void 0&&(x=""+r.key),r.ref!==void 0&&(T=r.ref);for(c in r)FF.call(r,c)&&!NF.hasOwnProperty(c)&&(d[c]=r[c]);if(e&&e.defaultProps)for(c in r=e.defaultProps,r)d[c]===void 0&&(d[c]=r[c]);return{$$typeof:DF,type:e,key:x,ref:T,props:d,_owner:BF.current}}b1.Fragment=OF;b1.jsx=yA;b1.jsxs=yA;lA.exports=b1;var Wt=lA.exports,vA={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var r={}.hasOwnProperty;function a(){for(var x="",T=0;T<arguments.length;T++){var i=arguments[T];i&&(x=d(x,c(i)))}return x}function c(x){if(typeof x=="string"||typeof x=="number")return x;if(typeof x!="object")return"";if(Array.isArray(x))return a.apply(null,x);if(x.toString!==Object.prototype.toString&&!x.toString.toString().includes("[native code]"))return x.toString();var T="";for(var i in x)r.call(x,i)&&x[i]&&(T=d(T,i));return T}function d(x,T){return T?x?x+" "+T:x+T:x}e.exports?(a.default=a,e.exports=a):window.classNames=a})()})(vA);var jF=vA.exports;const Mr=P_(jF);function Po(){return Po=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var c in a)({}).hasOwnProperty.call(a,c)&&(e[c]=a[c])}return e},Po.apply(null,arguments)}function ln(e){"@babel/helpers - typeof";return ln=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},ln(e)}var $F=Symbol.for("react.element"),VF=Symbol.for("react.transitional.element"),UF=Symbol.for("react.fragment");function xA(e){return e&&ln(e)==="object"&&(e.$$typeof===$F||e.$$typeof===VF)&&e.type===UF}function Yh(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=[];return sn.Children.forEach(e,function(c){c==null&&!r.keepEmpty||(Array.isArray(c)?a=a.concat(Yh(c)):xA(c)&&c.props?a=a.concat(Yh(c.props.children,r)):a.push(c))}),a}var M2={},GF=function(r){};function HF(e,r){}function WF(e,r){}function qF(){M2={}}function bA(e,r,a){!r&&!M2[a]&&(e(!1,a),M2[a]=!0)}function es(e,r){bA(HF,e,r)}function ZF(e,r){bA(WF,e,r)}es.preMessage=GF;es.resetWarned=qF;es.noteOnce=ZF;function XF(e,r){if(ln(e)!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var c=a.call(e,r||"default");if(ln(c)!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function wA(e){var r=XF(e,"string");return ln(r)=="symbol"?r:r+""}function Et(e,r,a){return(r=wA(r))in e?Object.defineProperty(e,r,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[r]=a,e}function FM(e,r){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);r&&(c=c.filter(function(d){return Object.getOwnPropertyDescriptor(e,d).enumerable})),a.push.apply(a,c)}return a}function Ft(e){for(var r=1;r<arguments.length;r++){var a=arguments[r]!=null?arguments[r]:{};r%2?FM(Object(a),!0).forEach(function(c){Et(e,c,a[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):FM(Object(a)).forEach(function(c){Object.defineProperty(e,c,Object.getOwnPropertyDescriptor(a,c))})}return e}var SA={exports:{}},os={},EA={exports:{}},TA={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function r(Ke,tt){var ht=Ke.length;Ke.push(tt);e:for(;0<ht;){var vt=ht-1>>>1,At=Ke[vt];if(0<d(At,tt))Ke[vt]=tt,Ke[ht]=At,ht=vt;else break e}}function a(Ke){return Ke.length===0?null:Ke[0]}function c(Ke){if(Ke.length===0)return null;var tt=Ke[0],ht=Ke.pop();if(ht!==tt){Ke[0]=ht;e:for(var vt=0,At=Ke.length,Pt=At>>>1;vt<Pt;){var qt=2*(vt+1)-1,or=Ke[qt],cr=qt+1,Qt=Ke[cr];if(0>d(or,ht))cr<At&&0>d(Qt,or)?(Ke[vt]=Qt,Ke[cr]=ht,vt=cr):(Ke[vt]=or,Ke[qt]=ht,vt=qt);else if(cr<At&&0>d(Qt,ht))Ke[vt]=Qt,Ke[cr]=ht,vt=cr;else break e}}return tt}function d(Ke,tt){var ht=Ke.sortIndex-tt.sortIndex;return ht!==0?ht:Ke.id-tt.id}if(typeof performance=="object"&&typeof performance.now=="function"){var x=performance;e.unstable_now=function(){return x.now()}}else{var T=Date,i=T.now();e.unstable_now=function(){return T.now()-i}}var L=[],N=[],U=1,q=null,X=3,se=!1,ce=!1,ue=!1,fe=typeof setTimeout=="function"?setTimeout:null,re=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ae(Ke){for(var tt=a(N);tt!==null;){if(tt.callback===null)c(N);else if(tt.startTime<=Ke)c(N),tt.sortIndex=tt.expirationTime,r(L,tt);else break;tt=a(N)}}function ve(Ke){if(ue=!1,ae(Ke),!ce)if(a(L)!==null)ce=!0,ct(Te);else{var tt=a(N);tt!==null&&Ye(ve,tt.startTime-Ke)}}function Te(Ke,tt){ce=!1,ue&&(ue=!1,re(Ne),Ne=-1),se=!0;var ht=X;try{for(ae(tt),q=a(L);q!==null&&(!(q.expirationTime>tt)||Ke&&!Je());){var vt=q.callback;if(typeof vt=="function"){q.callback=null,X=q.priorityLevel;var At=vt(q.expirationTime<=tt);tt=e.unstable_now(),typeof At=="function"?q.callback=At:q===a(L)&&c(L),ae(tt)}else c(L);q=a(L)}if(q!==null)var Pt=!0;else{var qt=a(N);qt!==null&&Ye(ve,qt.startTime-tt),Pt=!1}return Pt}finally{q=null,X=ht,se=!1}}var pe=!1,Ee=null,Ne=-1,Xe=5,Fe=-1;function Je(){return!(e.unstable_now()-Fe<Xe)}function Ct(){if(Ee!==null){var Ke=e.unstable_now();Fe=Ke;var tt=!0;try{tt=Ee(!0,Ke)}finally{tt?ft():(pe=!1,Ee=null)}}else pe=!1}var ft;if(typeof ee=="function")ft=function(){ee(Ct)};else if(typeof MessageChannel<"u"){var yt=new MessageChannel,lt=yt.port2;yt.port1.onmessage=Ct,ft=function(){lt.postMessage(null)}}else ft=function(){fe(Ct,0)};function ct(Ke){Ee=Ke,pe||(pe=!0,ft())}function Ye(Ke,tt){Ne=fe(function(){Ke(e.unstable_now())},tt)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Ke){Ke.callback=null},e.unstable_continueExecution=function(){ce||se||(ce=!0,ct(Te))},e.unstable_forceFrameRate=function(Ke){0>Ke||125<Ke?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Xe=0<Ke?Math.floor(1e3/Ke):5},e.unstable_getCurrentPriorityLevel=function(){return X},e.unstable_getFirstCallbackNode=function(){return a(L)},e.unstable_next=function(Ke){switch(X){case 1:case 2:case 3:var tt=3;break;default:tt=X}var ht=X;X=tt;try{return Ke()}finally{X=ht}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(Ke,tt){switch(Ke){case 1:case 2:case 3:case 4:case 5:break;default:Ke=3}var ht=X;X=Ke;try{return tt()}finally{X=ht}},e.unstable_scheduleCallback=function(Ke,tt,ht){var vt=e.unstable_now();switch(typeof ht=="object"&&ht!==null?(ht=ht.delay,ht=typeof ht=="number"&&0<ht?vt+ht:vt):ht=vt,Ke){case 1:var At=-1;break;case 2:At=250;break;case 5:At=1073741823;break;case 4:At=1e4;break;default:At=5e3}return At=ht+At,Ke={id:U++,callback:tt,priorityLevel:Ke,startTime:ht,expirationTime:At,sortIndex:-1},ht>vt?(Ke.sortIndex=ht,r(N,Ke),a(L)===null&&Ke===a(N)&&(ue?(re(Ne),Ne=-1):ue=!0,Ye(ve,ht-vt))):(Ke.sortIndex=At,r(L,Ke),ce||se||(ce=!0,ct(Te))),Ke},e.unstable_shouldYield=Je,e.unstable_wrapCallback=function(Ke){var tt=X;return function(){var ht=X;X=tt;try{return Ke.apply(this,arguments)}finally{X=ht}}}})(TA);EA.exports=TA;var YF=EA.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KF=$,rs=YF;function rr(e){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)r+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var CA=new Set,Xg={};function sd(e,r){dp(e,r),dp(e+"Capture",r)}function dp(e,r){for(Xg[e]=r,e=0;e<r.length;e++)CA.add(r[e])}var Sc=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),I2=Object.prototype.hasOwnProperty,JF=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,BM={},NM={};function QF(e){return I2.call(NM,e)?!0:I2.call(BM,e)?!1:JF.test(e)?NM[e]=!0:(BM[e]=!0,!1)}function e8(e,r,a,c){if(a!==null&&a.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return c?!1:a!==null?!a.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function t8(e,r,a,c){if(r===null||typeof r>"u"||e8(e,r,a,c))return!0;if(c)return!1;if(a!==null)switch(a.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function ga(e,r,a,c,d,x,T){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=c,this.attributeNamespace=d,this.mustUseProperty=a,this.propertyName=e,this.type=r,this.sanitizeURL=x,this.removeEmptyString=T}var Ho={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Ho[e]=new ga(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var r=e[0];Ho[r]=new ga(r,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Ho[e]=new ga(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Ho[e]=new ga(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Ho[e]=new ga(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Ho[e]=new ga(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Ho[e]=new ga(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Ho[e]=new ga(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Ho[e]=new ga(e,5,!1,e.toLowerCase(),null,!1,!1)});var E3=/[\-:]([a-z])/g;function T3(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var r=e.replace(E3,T3);Ho[r]=new ga(r,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var r=e.replace(E3,T3);Ho[r]=new ga(r,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var r=e.replace(E3,T3);Ho[r]=new ga(r,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Ho[e]=new ga(e,1,!1,e.toLowerCase(),null,!1,!1)});Ho.xlinkHref=new ga("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Ho[e]=new ga(e,1,!1,e.toLowerCase(),null,!0,!0)});function C3(e,r,a,c){var d=Ho.hasOwnProperty(r)?Ho[r]:null;(d!==null?d.type!==0:c||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(t8(r,a,d,c)&&(a=null),c||d===null?QF(r)&&(a===null?e.removeAttribute(r):e.setAttribute(r,""+a)):d.mustUseProperty?e[d.propertyName]=a===null?d.type===3?!1:"":a:(r=d.attributeName,c=d.attributeNamespace,a===null?e.removeAttribute(r):(d=d.type,a=d===3||d===4&&a===!0?"":""+a,c?e.setAttributeNS(c,r,a):e.setAttribute(r,a))))}var Ic=KF.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,jy=Symbol.for("react.element"),Vf=Symbol.for("react.portal"),Uf=Symbol.for("react.fragment"),M3=Symbol.for("react.strict_mode"),P2=Symbol.for("react.profiler"),MA=Symbol.for("react.provider"),IA=Symbol.for("react.context"),I3=Symbol.for("react.forward_ref"),A2=Symbol.for("react.suspense"),R2=Symbol.for("react.suspense_list"),P3=Symbol.for("react.memo"),xu=Symbol.for("react.lazy"),PA=Symbol.for("react.offscreen"),jM=Symbol.iterator;function pg(e){return e===null||typeof e!="object"?null:(e=jM&&e[jM]||e["@@iterator"],typeof e=="function"?e:null)}var ji=Object.assign,xw;function Ag(e){if(xw===void 0)try{throw Error()}catch(a){var r=a.stack.trim().match(/\n( *(at )?)/);xw=r&&r[1]||""}return`
`+xw+e}var bw=!1;function ww(e,r){if(!e||bw)return"";bw=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(N){var c=N}Reflect.construct(e,[],r)}else{try{r.call()}catch(N){c=N}e.call(r.prototype)}else{try{throw Error()}catch(N){c=N}e()}}catch(N){if(N&&c&&typeof N.stack=="string"){for(var d=N.stack.split(`
`),x=c.stack.split(`
`),T=d.length-1,i=x.length-1;1<=T&&0<=i&&d[T]!==x[i];)i--;for(;1<=T&&0<=i;T--,i--)if(d[T]!==x[i]){if(T!==1||i!==1)do if(T--,i--,0>i||d[T]!==x[i]){var L=`
`+d[T].replace(" at new "," at ");return e.displayName&&L.includes("<anonymous>")&&(L=L.replace("<anonymous>",e.displayName)),L}while(1<=T&&0<=i);break}}}finally{bw=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?Ag(e):""}function r8(e){switch(e.tag){case 5:return Ag(e.type);case 16:return Ag("Lazy");case 13:return Ag("Suspense");case 19:return Ag("SuspenseList");case 0:case 2:case 15:return e=ww(e.type,!1),e;case 11:return e=ww(e.type.render,!1),e;case 1:return e=ww(e.type,!0),e;default:return""}}function z2(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Uf:return"Fragment";case Vf:return"Portal";case P2:return"Profiler";case M3:return"StrictMode";case A2:return"Suspense";case R2:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case IA:return(e.displayName||"Context")+".Consumer";case MA:return(e._context.displayName||"Context")+".Provider";case I3:var r=e.render;return e=e.displayName,e||(e=r.displayName||r.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case P3:return r=e.displayName||null,r!==null?r:z2(e.type)||"Memo";case xu:r=e._payload,e=e._init;try{return z2(e(r))}catch{}}return null}function n8(e){var r=e.type;switch(e.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=r.render,e=e.displayName||e.name||"",r.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return z2(r);case 8:return r===M3?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function Nu(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function AA(e){var r=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function i8(e){var r=AA(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,r),c=""+e[r];if(!e.hasOwnProperty(r)&&typeof a<"u"&&typeof a.get=="function"&&typeof a.set=="function"){var d=a.get,x=a.set;return Object.defineProperty(e,r,{configurable:!0,get:function(){return d.call(this)},set:function(T){c=""+T,x.call(this,T)}}),Object.defineProperty(e,r,{enumerable:a.enumerable}),{getValue:function(){return c},setValue:function(T){c=""+T},stopTracking:function(){e._valueTracker=null,delete e[r]}}}}function $y(e){e._valueTracker||(e._valueTracker=i8(e))}function RA(e){if(!e)return!1;var r=e._valueTracker;if(!r)return!0;var a=r.getValue(),c="";return e&&(c=AA(e)?e.checked?"true":"false":e.value),e=c,e!==a?(r.setValue(e),!0):!1}function Bv(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function L2(e,r){var a=r.checked;return ji({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:a??e._wrapperState.initialChecked})}function $M(e,r){var a=r.defaultValue==null?"":r.defaultValue,c=r.checked!=null?r.checked:r.defaultChecked;a=Nu(r.value!=null?r.value:a),e._wrapperState={initialChecked:c,initialValue:a,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function zA(e,r){r=r.checked,r!=null&&C3(e,"checked",r,!1)}function k2(e,r){zA(e,r);var a=Nu(r.value),c=r.type;if(a!=null)c==="number"?(a===0&&e.value===""||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if(c==="submit"||c==="reset"){e.removeAttribute("value");return}r.hasOwnProperty("value")?D2(e,r.type,a):r.hasOwnProperty("defaultValue")&&D2(e,r.type,Nu(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(e.defaultChecked=!!r.defaultChecked)}function VM(e,r,a){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var c=r.type;if(!(c!=="submit"&&c!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+e._wrapperState.initialValue,a||r===e.value||(e.value=r),e.defaultValue=r}a=e.name,a!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,a!==""&&(e.name=a)}function D2(e,r,a){(r!=="number"||Bv(e.ownerDocument)!==e)&&(a==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}var Rg=Array.isArray;function ip(e,r,a,c){if(e=e.options,r){r={};for(var d=0;d<a.length;d++)r["$"+a[d]]=!0;for(a=0;a<e.length;a++)d=r.hasOwnProperty("$"+e[a].value),e[a].selected!==d&&(e[a].selected=d),d&&c&&(e[a].defaultSelected=!0)}else{for(a=""+Nu(a),r=null,d=0;d<e.length;d++){if(e[d].value===a){e[d].selected=!0,c&&(e[d].defaultSelected=!0);return}r!==null||e[d].disabled||(r=e[d])}r!==null&&(r.selected=!0)}}function O2(e,r){if(r.dangerouslySetInnerHTML!=null)throw Error(rr(91));return ji({},r,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function UM(e,r){var a=r.value;if(a==null){if(a=r.children,r=r.defaultValue,a!=null){if(r!=null)throw Error(rr(92));if(Rg(a)){if(1<a.length)throw Error(rr(93));a=a[0]}r=a}r==null&&(r=""),a=r}e._wrapperState={initialValue:Nu(a)}}function LA(e,r){var a=Nu(r.value),c=Nu(r.defaultValue);a!=null&&(a=""+a,a!==e.value&&(e.value=a),r.defaultValue==null&&e.defaultValue!==a&&(e.defaultValue=a)),c!=null&&(e.defaultValue=""+c)}function GM(e){var r=e.textContent;r===e._wrapperState.initialValue&&r!==""&&r!==null&&(e.value=r)}function kA(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function F2(e,r){return e==null||e==="http://www.w3.org/1999/xhtml"?kA(r):e==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Vy,DA=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,a,c,d){MSApp.execUnsafeLocalFunction(function(){return e(r,a,c,d)})}:e}(function(e,r){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=r;else{for(Vy=Vy||document.createElement("div"),Vy.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=Vy.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;r.firstChild;)e.appendChild(r.firstChild)}});function Yg(e,r){if(r){var a=e.firstChild;if(a&&a===e.lastChild&&a.nodeType===3){a.nodeValue=r;return}}e.textContent=r}var Og={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},o8=["Webkit","ms","Moz","O"];Object.keys(Og).forEach(function(e){o8.forEach(function(r){r=r+e.charAt(0).toUpperCase()+e.substring(1),Og[r]=Og[e]})});function OA(e,r,a){return r==null||typeof r=="boolean"||r===""?"":a||typeof r!="number"||r===0||Og.hasOwnProperty(e)&&Og[e]?(""+r).trim():r+"px"}function FA(e,r){e=e.style;for(var a in r)if(r.hasOwnProperty(a)){var c=a.indexOf("--")===0,d=OA(a,r[a],c);a==="float"&&(a="cssFloat"),c?e.setProperty(a,d):e[a]=d}}var a8=ji({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function B2(e,r){if(r){if(a8[e]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(rr(137,e));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(rr(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(rr(61))}if(r.style!=null&&typeof r.style!="object")throw Error(rr(62))}}function N2(e,r){if(e.indexOf("-")===-1)return typeof r.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var j2=null;function A3(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var $2=null,op=null,ap=null;function HM(e){if(e=k_(e)){if(typeof $2!="function")throw Error(rr(280));var r=e.stateNode;r&&(r=C1(r),$2(e.stateNode,e.type,r))}}function BA(e){op?ap?ap.push(e):ap=[e]:op=e}function NA(){if(op){var e=op,r=ap;if(ap=op=null,HM(e),r)for(e=0;e<r.length;e++)HM(r[e])}}function jA(e,r){return e(r)}function $A(){}var Sw=!1;function VA(e,r,a){if(Sw)return e(r,a);Sw=!0;try{return jA(e,r,a)}finally{Sw=!1,(op!==null||ap!==null)&&($A(),NA())}}function Kg(e,r){var a=e.stateNode;if(a===null)return null;var c=C1(a);if(c===null)return null;a=c[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(e=e.type,c=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!c;break e;default:e=!1}if(e)return null;if(a&&typeof a!="function")throw Error(rr(231,r,typeof a));return a}var V2=!1;if(Sc)try{var mg={};Object.defineProperty(mg,"passive",{get:function(){V2=!0}}),window.addEventListener("test",mg,mg),window.removeEventListener("test",mg,mg)}catch{V2=!1}function s8(e,r,a,c,d,x,T,i,L){var N=Array.prototype.slice.call(arguments,3);try{r.apply(a,N)}catch(U){this.onError(U)}}var Fg=!1,Nv=null,jv=!1,U2=null,l8={onError:function(e){Fg=!0,Nv=e}};function c8(e,r,a,c,d,x,T,i,L){Fg=!1,Nv=null,s8.apply(l8,arguments)}function u8(e,r,a,c,d,x,T,i,L){if(c8.apply(this,arguments),Fg){if(Fg){var N=Nv;Fg=!1,Nv=null}else throw Error(rr(198));jv||(jv=!0,U2=N)}}function ld(e){var r=e,a=e;if(e.alternate)for(;r.return;)r=r.return;else{e=r;do r=e,r.flags&4098&&(a=r.return),e=r.return;while(e)}return r.tag===3?a:null}function UA(e){if(e.tag===13){var r=e.memoizedState;if(r===null&&(e=e.alternate,e!==null&&(r=e.memoizedState)),r!==null)return r.dehydrated}return null}function WM(e){if(ld(e)!==e)throw Error(rr(188))}function h8(e){var r=e.alternate;if(!r){if(r=ld(e),r===null)throw Error(rr(188));return r!==e?null:e}for(var a=e,c=r;;){var d=a.return;if(d===null)break;var x=d.alternate;if(x===null){if(c=d.return,c!==null){a=c;continue}break}if(d.child===x.child){for(x=d.child;x;){if(x===a)return WM(d),e;if(x===c)return WM(d),r;x=x.sibling}throw Error(rr(188))}if(a.return!==c.return)a=d,c=x;else{for(var T=!1,i=d.child;i;){if(i===a){T=!0,a=d,c=x;break}if(i===c){T=!0,c=d,a=x;break}i=i.sibling}if(!T){for(i=x.child;i;){if(i===a){T=!0,a=x,c=d;break}if(i===c){T=!0,c=x,a=d;break}i=i.sibling}if(!T)throw Error(rr(189))}}if(a.alternate!==c)throw Error(rr(190))}if(a.tag!==3)throw Error(rr(188));return a.stateNode.current===a?e:r}function GA(e){return e=h8(e),e!==null?HA(e):null}function HA(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var r=HA(e);if(r!==null)return r;e=e.sibling}return null}var WA=rs.unstable_scheduleCallback,qM=rs.unstable_cancelCallback,d8=rs.unstable_shouldYield,f8=rs.unstable_requestPaint,Ki=rs.unstable_now,p8=rs.unstable_getCurrentPriorityLevel,R3=rs.unstable_ImmediatePriority,qA=rs.unstable_UserBlockingPriority,$v=rs.unstable_NormalPriority,m8=rs.unstable_LowPriority,ZA=rs.unstable_IdlePriority,w1=null,Nl=null;function g8(e){if(Nl&&typeof Nl.onCommitFiberRoot=="function")try{Nl.onCommitFiberRoot(w1,e,void 0,(e.current.flags&128)===128)}catch{}}var sl=Math.clz32?Math.clz32:v8,_8=Math.log,y8=Math.LN2;function v8(e){return e>>>=0,e===0?32:31-(_8(e)/y8|0)|0}var Uy=64,Gy=4194304;function zg(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Vv(e,r){var a=e.pendingLanes;if(a===0)return 0;var c=0,d=e.suspendedLanes,x=e.pingedLanes,T=a&268435455;if(T!==0){var i=T&~d;i!==0?c=zg(i):(x&=T,x!==0&&(c=zg(x)))}else T=a&~d,T!==0?c=zg(T):x!==0&&(c=zg(x));if(c===0)return 0;if(r!==0&&r!==c&&!(r&d)&&(d=c&-c,x=r&-r,d>=x||d===16&&(x&4194240)!==0))return r;if(c&4&&(c|=a&16),r=e.entangledLanes,r!==0)for(e=e.entanglements,r&=c;0<r;)a=31-sl(r),d=1<<a,c|=e[a],r&=~d;return c}function x8(e,r){switch(e){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function b8(e,r){for(var a=e.suspendedLanes,c=e.pingedLanes,d=e.expirationTimes,x=e.pendingLanes;0<x;){var T=31-sl(x),i=1<<T,L=d[T];L===-1?(!(i&a)||i&c)&&(d[T]=x8(i,r)):L<=r&&(e.expiredLanes|=i),x&=~i}}function G2(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function XA(){var e=Uy;return Uy<<=1,!(Uy&4194240)&&(Uy=64),e}function Ew(e){for(var r=[],a=0;31>a;a++)r.push(e);return r}function z_(e,r,a){e.pendingLanes|=r,r!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,r=31-sl(r),e[r]=a}function w8(e,r){var a=e.pendingLanes&~r;e.pendingLanes=r,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=r,e.mutableReadLanes&=r,e.entangledLanes&=r,r=e.entanglements;var c=e.eventTimes;for(e=e.expirationTimes;0<a;){var d=31-sl(a),x=1<<d;r[d]=0,c[d]=-1,e[d]=-1,a&=~x}}function z3(e,r){var a=e.entangledLanes|=r;for(e=e.entanglements;a;){var c=31-sl(a),d=1<<c;d&r|e[c]&r&&(e[c]|=r),a&=~d}}var ai=0;function YA(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var KA,L3,JA,QA,eR,H2=!1,Hy=[],Ru=null,zu=null,Lu=null,Jg=new Map,Qg=new Map,wu=[],S8="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ZM(e,r){switch(e){case"focusin":case"focusout":Ru=null;break;case"dragenter":case"dragleave":zu=null;break;case"mouseover":case"mouseout":Lu=null;break;case"pointerover":case"pointerout":Jg.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":Qg.delete(r.pointerId)}}function gg(e,r,a,c,d,x){return e===null||e.nativeEvent!==x?(e={blockedOn:r,domEventName:a,eventSystemFlags:c,nativeEvent:x,targetContainers:[d]},r!==null&&(r=k_(r),r!==null&&L3(r)),e):(e.eventSystemFlags|=c,r=e.targetContainers,d!==null&&r.indexOf(d)===-1&&r.push(d),e)}function E8(e,r,a,c,d){switch(r){case"focusin":return Ru=gg(Ru,e,r,a,c,d),!0;case"dragenter":return zu=gg(zu,e,r,a,c,d),!0;case"mouseover":return Lu=gg(Lu,e,r,a,c,d),!0;case"pointerover":var x=d.pointerId;return Jg.set(x,gg(Jg.get(x)||null,e,r,a,c,d)),!0;case"gotpointercapture":return x=d.pointerId,Qg.set(x,gg(Qg.get(x)||null,e,r,a,c,d)),!0}return!1}function tR(e){var r=jh(e.target);if(r!==null){var a=ld(r);if(a!==null){if(r=a.tag,r===13){if(r=UA(a),r!==null){e.blockedOn=r,eR(e.priority,function(){JA(a)});return}}else if(r===3&&a.stateNode.current.memoizedState.isDehydrated){e.blockedOn=a.tag===3?a.stateNode.containerInfo:null;return}}}e.blockedOn=null}function vv(e){if(e.blockedOn!==null)return!1;for(var r=e.targetContainers;0<r.length;){var a=W2(e.domEventName,e.eventSystemFlags,r[0],e.nativeEvent);if(a===null){a=e.nativeEvent;var c=new a.constructor(a.type,a);j2=c,a.target.dispatchEvent(c),j2=null}else return r=k_(a),r!==null&&L3(r),e.blockedOn=a,!1;r.shift()}return!0}function XM(e,r,a){vv(e)&&a.delete(r)}function T8(){H2=!1,Ru!==null&&vv(Ru)&&(Ru=null),zu!==null&&vv(zu)&&(zu=null),Lu!==null&&vv(Lu)&&(Lu=null),Jg.forEach(XM),Qg.forEach(XM)}function _g(e,r){e.blockedOn===r&&(e.blockedOn=null,H2||(H2=!0,rs.unstable_scheduleCallback(rs.unstable_NormalPriority,T8)))}function e_(e){function r(d){return _g(d,e)}if(0<Hy.length){_g(Hy[0],e);for(var a=1;a<Hy.length;a++){var c=Hy[a];c.blockedOn===e&&(c.blockedOn=null)}}for(Ru!==null&&_g(Ru,e),zu!==null&&_g(zu,e),Lu!==null&&_g(Lu,e),Jg.forEach(r),Qg.forEach(r),a=0;a<wu.length;a++)c=wu[a],c.blockedOn===e&&(c.blockedOn=null);for(;0<wu.length&&(a=wu[0],a.blockedOn===null);)tR(a),a.blockedOn===null&&wu.shift()}var sp=Ic.ReactCurrentBatchConfig,Uv=!0;function C8(e,r,a,c){var d=ai,x=sp.transition;sp.transition=null;try{ai=1,k3(e,r,a,c)}finally{ai=d,sp.transition=x}}function M8(e,r,a,c){var d=ai,x=sp.transition;sp.transition=null;try{ai=4,k3(e,r,a,c)}finally{ai=d,sp.transition=x}}function k3(e,r,a,c){if(Uv){var d=W2(e,r,a,c);if(d===null)kw(e,r,c,Gv,a),ZM(e,c);else if(E8(d,e,r,a,c))c.stopPropagation();else if(ZM(e,c),r&4&&-1<S8.indexOf(e)){for(;d!==null;){var x=k_(d);if(x!==null&&KA(x),x=W2(e,r,a,c),x===null&&kw(e,r,c,Gv,a),x===d)break;d=x}d!==null&&c.stopPropagation()}else kw(e,r,c,null,a)}}var Gv=null;function W2(e,r,a,c){if(Gv=null,e=A3(c),e=jh(e),e!==null)if(r=ld(e),r===null)e=null;else if(a=r.tag,a===13){if(e=UA(r),e!==null)return e;e=null}else if(a===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;e=null}else r!==e&&(e=null);return Gv=e,null}function rR(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(p8()){case R3:return 1;case qA:return 4;case $v:case m8:return 16;case ZA:return 536870912;default:return 16}default:return 16}}var Eu=null,D3=null,xv=null;function nR(){if(xv)return xv;var e,r=D3,a=r.length,c,d="value"in Eu?Eu.value:Eu.textContent,x=d.length;for(e=0;e<a&&r[e]===d[e];e++);var T=a-e;for(c=1;c<=T&&r[a-c]===d[x-c];c++);return xv=d.slice(e,1<c?1-c:void 0)}function bv(e){var r=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&r===13&&(e=13)):e=r,e===10&&(e=13),32<=e||e===13?e:0}function Wy(){return!0}function YM(){return!1}function as(e){function r(a,c,d,x,T){this._reactName=a,this._targetInst=d,this.type=c,this.nativeEvent=x,this.target=T,this.currentTarget=null;for(var i in e)e.hasOwnProperty(i)&&(a=e[i],this[i]=a?a(x):x[i]);return this.isDefaultPrevented=(x.defaultPrevented!=null?x.defaultPrevented:x.returnValue===!1)?Wy:YM,this.isPropagationStopped=YM,this}return ji(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var a=this.nativeEvent;a&&(a.preventDefault?a.preventDefault():typeof a.returnValue!="unknown"&&(a.returnValue=!1),this.isDefaultPrevented=Wy)},stopPropagation:function(){var a=this.nativeEvent;a&&(a.stopPropagation?a.stopPropagation():typeof a.cancelBubble!="unknown"&&(a.cancelBubble=!0),this.isPropagationStopped=Wy)},persist:function(){},isPersistent:Wy}),r}var Ip={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},O3=as(Ip),L_=ji({},Ip,{view:0,detail:0}),I8=as(L_),Tw,Cw,yg,S1=ji({},L_,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:F3,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==yg&&(yg&&e.type==="mousemove"?(Tw=e.screenX-yg.screenX,Cw=e.screenY-yg.screenY):Cw=Tw=0,yg=e),Tw)},movementY:function(e){return"movementY"in e?e.movementY:Cw}}),KM=as(S1),P8=ji({},S1,{dataTransfer:0}),A8=as(P8),R8=ji({},L_,{relatedTarget:0}),Mw=as(R8),z8=ji({},Ip,{animationName:0,elapsedTime:0,pseudoElement:0}),L8=as(z8),k8=ji({},Ip,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),D8=as(k8),O8=ji({},Ip,{data:0}),JM=as(O8),F8={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},B8={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},N8={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function j8(e){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(e):(e=N8[e])?!!r[e]:!1}function F3(){return j8}var $8=ji({},L_,{key:function(e){if(e.key){var r=F8[e.key]||e.key;if(r!=="Unidentified")return r}return e.type==="keypress"?(e=bv(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?B8[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:F3,charCode:function(e){return e.type==="keypress"?bv(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?bv(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),V8=as($8),U8=ji({},S1,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),QM=as(U8),G8=ji({},L_,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:F3}),H8=as(G8),W8=ji({},Ip,{propertyName:0,elapsedTime:0,pseudoElement:0}),q8=as(W8),Z8=ji({},S1,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),X8=as(Z8),Y8=[9,13,27,32],B3=Sc&&"CompositionEvent"in window,Bg=null;Sc&&"documentMode"in document&&(Bg=document.documentMode);var K8=Sc&&"TextEvent"in window&&!Bg,iR=Sc&&(!B3||Bg&&8<Bg&&11>=Bg),eI=String.fromCharCode(32),tI=!1;function oR(e,r){switch(e){case"keyup":return Y8.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function aR(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Gf=!1;function J8(e,r){switch(e){case"compositionend":return aR(r);case"keypress":return r.which!==32?null:(tI=!0,eI);case"textInput":return e=r.data,e===eI&&tI?null:e;default:return null}}function Q8(e,r){if(Gf)return e==="compositionend"||!B3&&oR(e,r)?(e=nR(),xv=D3=Eu=null,Gf=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return iR&&r.locale!=="ko"?null:r.data;default:return null}}var eB={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rI(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r==="input"?!!eB[e.type]:r==="textarea"}function sR(e,r,a,c){BA(c),r=Hv(r,"onChange"),0<r.length&&(a=new O3("onChange","change",null,a,c),e.push({event:a,listeners:r}))}var Ng=null,t_=null;function tB(e){yR(e,0)}function E1(e){var r=qf(e);if(RA(r))return e}function rB(e,r){if(e==="change")return r}var lR=!1;if(Sc){var Iw;if(Sc){var Pw="oninput"in document;if(!Pw){var nI=document.createElement("div");nI.setAttribute("oninput","return;"),Pw=typeof nI.oninput=="function"}Iw=Pw}else Iw=!1;lR=Iw&&(!document.documentMode||9<document.documentMode)}function iI(){Ng&&(Ng.detachEvent("onpropertychange",cR),t_=Ng=null)}function cR(e){if(e.propertyName==="value"&&E1(t_)){var r=[];sR(r,t_,e,A3(e)),VA(tB,r)}}function nB(e,r,a){e==="focusin"?(iI(),Ng=r,t_=a,Ng.attachEvent("onpropertychange",cR)):e==="focusout"&&iI()}function iB(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return E1(t_)}function oB(e,r){if(e==="click")return E1(r)}function aB(e,r){if(e==="input"||e==="change")return E1(r)}function sB(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var dl=typeof Object.is=="function"?Object.is:sB;function r_(e,r){if(dl(e,r))return!0;if(typeof e!="object"||e===null||typeof r!="object"||r===null)return!1;var a=Object.keys(e),c=Object.keys(r);if(a.length!==c.length)return!1;for(c=0;c<a.length;c++){var d=a[c];if(!I2.call(r,d)||!dl(e[d],r[d]))return!1}return!0}function oI(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function aI(e,r){var a=oI(e);e=0;for(var c;a;){if(a.nodeType===3){if(c=e+a.textContent.length,e<=r&&c>=r)return{node:a,offset:r-e};e=c}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=oI(a)}}function uR(e,r){return e&&r?e===r?!0:e&&e.nodeType===3?!1:r&&r.nodeType===3?uR(e,r.parentNode):"contains"in e?e.contains(r):e.compareDocumentPosition?!!(e.compareDocumentPosition(r)&16):!1:!1}function hR(){for(var e=window,r=Bv();r instanceof e.HTMLIFrameElement;){try{var a=typeof r.contentWindow.location.href=="string"}catch{a=!1}if(a)e=r.contentWindow;else break;r=Bv(e.document)}return r}function N3(e){var r=e&&e.nodeName&&e.nodeName.toLowerCase();return r&&(r==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||r==="textarea"||e.contentEditable==="true")}function lB(e){var r=hR(),a=e.focusedElem,c=e.selectionRange;if(r!==a&&a&&a.ownerDocument&&uR(a.ownerDocument.documentElement,a)){if(c!==null&&N3(a)){if(r=c.start,e=c.end,e===void 0&&(e=r),"selectionStart"in a)a.selectionStart=r,a.selectionEnd=Math.min(e,a.value.length);else if(e=(r=a.ownerDocument||document)&&r.defaultView||window,e.getSelection){e=e.getSelection();var d=a.textContent.length,x=Math.min(c.start,d);c=c.end===void 0?x:Math.min(c.end,d),!e.extend&&x>c&&(d=c,c=x,x=d),d=aI(a,x);var T=aI(a,c);d&&T&&(e.rangeCount!==1||e.anchorNode!==d.node||e.anchorOffset!==d.offset||e.focusNode!==T.node||e.focusOffset!==T.offset)&&(r=r.createRange(),r.setStart(d.node,d.offset),e.removeAllRanges(),x>c?(e.addRange(r),e.extend(T.node,T.offset)):(r.setEnd(T.node,T.offset),e.addRange(r)))}}for(r=[],e=a;e=e.parentNode;)e.nodeType===1&&r.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof a.focus=="function"&&a.focus(),a=0;a<r.length;a++)e=r[a],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var cB=Sc&&"documentMode"in document&&11>=document.documentMode,Hf=null,q2=null,jg=null,Z2=!1;function sI(e,r,a){var c=a.window===a?a.document:a.nodeType===9?a:a.ownerDocument;Z2||Hf==null||Hf!==Bv(c)||(c=Hf,"selectionStart"in c&&N3(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),jg&&r_(jg,c)||(jg=c,c=Hv(q2,"onSelect"),0<c.length&&(r=new O3("onSelect","select",null,r,a),e.push({event:r,listeners:c}),r.target=Hf)))}function qy(e,r){var a={};return a[e.toLowerCase()]=r.toLowerCase(),a["Webkit"+e]="webkit"+r,a["Moz"+e]="moz"+r,a}var Wf={animationend:qy("Animation","AnimationEnd"),animationiteration:qy("Animation","AnimationIteration"),animationstart:qy("Animation","AnimationStart"),transitionend:qy("Transition","TransitionEnd")},Aw={},dR={};Sc&&(dR=document.createElement("div").style,"AnimationEvent"in window||(delete Wf.animationend.animation,delete Wf.animationiteration.animation,delete Wf.animationstart.animation),"TransitionEvent"in window||delete Wf.transitionend.transition);function T1(e){if(Aw[e])return Aw[e];if(!Wf[e])return e;var r=Wf[e],a;for(a in r)if(r.hasOwnProperty(a)&&a in dR)return Aw[e]=r[a];return e}var fR=T1("animationend"),pR=T1("animationiteration"),mR=T1("animationstart"),gR=T1("transitionend"),_R=new Map,lI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Vu(e,r){_R.set(e,r),sd(r,[e])}for(var Rw=0;Rw<lI.length;Rw++){var zw=lI[Rw],uB=zw.toLowerCase(),hB=zw[0].toUpperCase()+zw.slice(1);Vu(uB,"on"+hB)}Vu(fR,"onAnimationEnd");Vu(pR,"onAnimationIteration");Vu(mR,"onAnimationStart");Vu("dblclick","onDoubleClick");Vu("focusin","onFocus");Vu("focusout","onBlur");Vu(gR,"onTransitionEnd");dp("onMouseEnter",["mouseout","mouseover"]);dp("onMouseLeave",["mouseout","mouseover"]);dp("onPointerEnter",["pointerout","pointerover"]);dp("onPointerLeave",["pointerout","pointerover"]);sd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));sd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));sd("onBeforeInput",["compositionend","keypress","textInput","paste"]);sd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));sd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));sd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lg="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),dB=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lg));function cI(e,r,a){var c=e.type||"unknown-event";e.currentTarget=a,u8(c,r,void 0,e),e.currentTarget=null}function yR(e,r){r=(r&4)!==0;for(var a=0;a<e.length;a++){var c=e[a],d=c.event;c=c.listeners;e:{var x=void 0;if(r)for(var T=c.length-1;0<=T;T--){var i=c[T],L=i.instance,N=i.currentTarget;if(i=i.listener,L!==x&&d.isPropagationStopped())break e;cI(d,i,N),x=L}else for(T=0;T<c.length;T++){if(i=c[T],L=i.instance,N=i.currentTarget,i=i.listener,L!==x&&d.isPropagationStopped())break e;cI(d,i,N),x=L}}}if(jv)throw e=U2,jv=!1,U2=null,e}function Ii(e,r){var a=r[Q2];a===void 0&&(a=r[Q2]=new Set);var c=e+"__bubble";a.has(c)||(vR(r,e,2,!1),a.add(c))}function Lw(e,r,a){var c=0;r&&(c|=4),vR(a,e,c,r)}var Zy="_reactListening"+Math.random().toString(36).slice(2);function n_(e){if(!e[Zy]){e[Zy]=!0,CA.forEach(function(a){a!=="selectionchange"&&(dB.has(a)||Lw(a,!1,e),Lw(a,!0,e))});var r=e.nodeType===9?e:e.ownerDocument;r===null||r[Zy]||(r[Zy]=!0,Lw("selectionchange",!1,r))}}function vR(e,r,a,c){switch(rR(r)){case 1:var d=C8;break;case 4:d=M8;break;default:d=k3}a=d.bind(null,r,a,e),d=void 0,!V2||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(d=!0),c?d!==void 0?e.addEventListener(r,a,{capture:!0,passive:d}):e.addEventListener(r,a,!0):d!==void 0?e.addEventListener(r,a,{passive:d}):e.addEventListener(r,a,!1)}function kw(e,r,a,c,d){var x=c;if(!(r&1)&&!(r&2)&&c!==null)e:for(;;){if(c===null)return;var T=c.tag;if(T===3||T===4){var i=c.stateNode.containerInfo;if(i===d||i.nodeType===8&&i.parentNode===d)break;if(T===4)for(T=c.return;T!==null;){var L=T.tag;if((L===3||L===4)&&(L=T.stateNode.containerInfo,L===d||L.nodeType===8&&L.parentNode===d))return;T=T.return}for(;i!==null;){if(T=jh(i),T===null)return;if(L=T.tag,L===5||L===6){c=x=T;continue e}i=i.parentNode}}c=c.return}VA(function(){var N=x,U=A3(a),q=[];e:{var X=_R.get(e);if(X!==void 0){var se=O3,ce=e;switch(e){case"keypress":if(bv(a)===0)break e;case"keydown":case"keyup":se=V8;break;case"focusin":ce="focus",se=Mw;break;case"focusout":ce="blur",se=Mw;break;case"beforeblur":case"afterblur":se=Mw;break;case"click":if(a.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":se=KM;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":se=A8;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":se=H8;break;case fR:case pR:case mR:se=L8;break;case gR:se=q8;break;case"scroll":se=I8;break;case"wheel":se=X8;break;case"copy":case"cut":case"paste":se=D8;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":se=QM}var ue=(r&4)!==0,fe=!ue&&e==="scroll",re=ue?X!==null?X+"Capture":null:X;ue=[];for(var ee=N,ae;ee!==null;){ae=ee;var ve=ae.stateNode;if(ae.tag===5&&ve!==null&&(ae=ve,re!==null&&(ve=Kg(ee,re),ve!=null&&ue.push(i_(ee,ve,ae)))),fe)break;ee=ee.return}0<ue.length&&(X=new se(X,ce,null,a,U),q.push({event:X,listeners:ue}))}}if(!(r&7)){e:{if(X=e==="mouseover"||e==="pointerover",se=e==="mouseout"||e==="pointerout",X&&a!==j2&&(ce=a.relatedTarget||a.fromElement)&&(jh(ce)||ce[Ec]))break e;if((se||X)&&(X=U.window===U?U:(X=U.ownerDocument)?X.defaultView||X.parentWindow:window,se?(ce=a.relatedTarget||a.toElement,se=N,ce=ce?jh(ce):null,ce!==null&&(fe=ld(ce),ce!==fe||ce.tag!==5&&ce.tag!==6)&&(ce=null)):(se=null,ce=N),se!==ce)){if(ue=KM,ve="onMouseLeave",re="onMouseEnter",ee="mouse",(e==="pointerout"||e==="pointerover")&&(ue=QM,ve="onPointerLeave",re="onPointerEnter",ee="pointer"),fe=se==null?X:qf(se),ae=ce==null?X:qf(ce),X=new ue(ve,ee+"leave",se,a,U),X.target=fe,X.relatedTarget=ae,ve=null,jh(U)===N&&(ue=new ue(re,ee+"enter",ce,a,U),ue.target=ae,ue.relatedTarget=fe,ve=ue),fe=ve,se&&ce)t:{for(ue=se,re=ce,ee=0,ae=ue;ae;ae=Rf(ae))ee++;for(ae=0,ve=re;ve;ve=Rf(ve))ae++;for(;0<ee-ae;)ue=Rf(ue),ee--;for(;0<ae-ee;)re=Rf(re),ae--;for(;ee--;){if(ue===re||re!==null&&ue===re.alternate)break t;ue=Rf(ue),re=Rf(re)}ue=null}else ue=null;se!==null&&uI(q,X,se,ue,!1),ce!==null&&fe!==null&&uI(q,fe,ce,ue,!0)}}e:{if(X=N?qf(N):window,se=X.nodeName&&X.nodeName.toLowerCase(),se==="select"||se==="input"&&X.type==="file")var Te=rB;else if(rI(X))if(lR)Te=aB;else{Te=iB;var pe=nB}else(se=X.nodeName)&&se.toLowerCase()==="input"&&(X.type==="checkbox"||X.type==="radio")&&(Te=oB);if(Te&&(Te=Te(e,N))){sR(q,Te,a,U);break e}pe&&pe(e,X,N),e==="focusout"&&(pe=X._wrapperState)&&pe.controlled&&X.type==="number"&&D2(X,"number",X.value)}switch(pe=N?qf(N):window,e){case"focusin":(rI(pe)||pe.contentEditable==="true")&&(Hf=pe,q2=N,jg=null);break;case"focusout":jg=q2=Hf=null;break;case"mousedown":Z2=!0;break;case"contextmenu":case"mouseup":case"dragend":Z2=!1,sI(q,a,U);break;case"selectionchange":if(cB)break;case"keydown":case"keyup":sI(q,a,U)}var Ee;if(B3)e:{switch(e){case"compositionstart":var Ne="onCompositionStart";break e;case"compositionend":Ne="onCompositionEnd";break e;case"compositionupdate":Ne="onCompositionUpdate";break e}Ne=void 0}else Gf?oR(e,a)&&(Ne="onCompositionEnd"):e==="keydown"&&a.keyCode===229&&(Ne="onCompositionStart");Ne&&(iR&&a.locale!=="ko"&&(Gf||Ne!=="onCompositionStart"?Ne==="onCompositionEnd"&&Gf&&(Ee=nR()):(Eu=U,D3="value"in Eu?Eu.value:Eu.textContent,Gf=!0)),pe=Hv(N,Ne),0<pe.length&&(Ne=new JM(Ne,e,null,a,U),q.push({event:Ne,listeners:pe}),Ee?Ne.data=Ee:(Ee=aR(a),Ee!==null&&(Ne.data=Ee)))),(Ee=K8?J8(e,a):Q8(e,a))&&(N=Hv(N,"onBeforeInput"),0<N.length&&(U=new JM("onBeforeInput","beforeinput",null,a,U),q.push({event:U,listeners:N}),U.data=Ee))}yR(q,r)})}function i_(e,r,a){return{instance:e,listener:r,currentTarget:a}}function Hv(e,r){for(var a=r+"Capture",c=[];e!==null;){var d=e,x=d.stateNode;d.tag===5&&x!==null&&(d=x,x=Kg(e,a),x!=null&&c.unshift(i_(e,x,d)),x=Kg(e,r),x!=null&&c.push(i_(e,x,d))),e=e.return}return c}function Rf(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function uI(e,r,a,c,d){for(var x=r._reactName,T=[];a!==null&&a!==c;){var i=a,L=i.alternate,N=i.stateNode;if(L!==null&&L===c)break;i.tag===5&&N!==null&&(i=N,d?(L=Kg(a,x),L!=null&&T.unshift(i_(a,L,i))):d||(L=Kg(a,x),L!=null&&T.push(i_(a,L,i)))),a=a.return}T.length!==0&&e.push({event:r,listeners:T})}var fB=/\r\n?/g,pB=/\u0000|\uFFFD/g;function hI(e){return(typeof e=="string"?e:""+e).replace(fB,`
`).replace(pB,"")}function Xy(e,r,a){if(r=hI(r),hI(e)!==r&&a)throw Error(rr(425))}function Wv(){}var X2=null,Y2=null;function K2(e,r){return e==="textarea"||e==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var J2=typeof setTimeout=="function"?setTimeout:void 0,mB=typeof clearTimeout=="function"?clearTimeout:void 0,dI=typeof Promise=="function"?Promise:void 0,gB=typeof queueMicrotask=="function"?queueMicrotask:typeof dI<"u"?function(e){return dI.resolve(null).then(e).catch(_B)}:J2;function _B(e){setTimeout(function(){throw e})}function Dw(e,r){var a=r,c=0;do{var d=a.nextSibling;if(e.removeChild(a),d&&d.nodeType===8)if(a=d.data,a==="/$"){if(c===0){e.removeChild(d),e_(r);return}c--}else a!=="$"&&a!=="$?"&&a!=="$!"||c++;a=d}while(a);e_(r)}function ku(e){for(;e!=null;e=e.nextSibling){var r=e.nodeType;if(r===1||r===3)break;if(r===8){if(r=e.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return e}function fI(e){e=e.previousSibling;for(var r=0;e;){if(e.nodeType===8){var a=e.data;if(a==="$"||a==="$!"||a==="$?"){if(r===0)return e;r--}else a==="/$"&&r++}e=e.previousSibling}return null}var Pp=Math.random().toString(36).slice(2),Bl="__reactFiber$"+Pp,o_="__reactProps$"+Pp,Ec="__reactContainer$"+Pp,Q2="__reactEvents$"+Pp,yB="__reactListeners$"+Pp,vB="__reactHandles$"+Pp;function jh(e){var r=e[Bl];if(r)return r;for(var a=e.parentNode;a;){if(r=a[Ec]||a[Bl]){if(a=r.alternate,r.child!==null||a!==null&&a.child!==null)for(e=fI(e);e!==null;){if(a=e[Bl])return a;e=fI(e)}return r}e=a,a=e.parentNode}return null}function k_(e){return e=e[Bl]||e[Ec],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function qf(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(rr(33))}function C1(e){return e[o_]||null}var eS=[],Zf=-1;function Uu(e){return{current:e}}function Pi(e){0>Zf||(e.current=eS[Zf],eS[Zf]=null,Zf--)}function xi(e,r){Zf++,eS[Zf]=e.current,e.current=r}var ju={},sa=Uu(ju),Ra=Uu(!1),Kh=ju;function fp(e,r){var a=e.type.contextTypes;if(!a)return ju;var c=e.stateNode;if(c&&c.__reactInternalMemoizedUnmaskedChildContext===r)return c.__reactInternalMemoizedMaskedChildContext;var d={},x;for(x in a)d[x]=r[x];return c&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=r,e.__reactInternalMemoizedMaskedChildContext=d),d}function za(e){return e=e.childContextTypes,e!=null}function qv(){Pi(Ra),Pi(sa)}function pI(e,r,a){if(sa.current!==ju)throw Error(rr(168));xi(sa,r),xi(Ra,a)}function xR(e,r,a){var c=e.stateNode;if(r=r.childContextTypes,typeof c.getChildContext!="function")return a;c=c.getChildContext();for(var d in c)if(!(d in r))throw Error(rr(108,n8(e)||"Unknown",d));return ji({},a,c)}function Zv(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ju,Kh=sa.current,xi(sa,e),xi(Ra,Ra.current),!0}function mI(e,r,a){var c=e.stateNode;if(!c)throw Error(rr(169));a?(e=xR(e,r,Kh),c.__reactInternalMemoizedMergedChildContext=e,Pi(Ra),Pi(sa),xi(sa,e)):Pi(Ra),xi(Ra,a)}var _c=null,M1=!1,Ow=!1;function bR(e){_c===null?_c=[e]:_c.push(e)}function xB(e){M1=!0,bR(e)}function Gu(){if(!Ow&&_c!==null){Ow=!0;var e=0,r=ai;try{var a=_c;for(ai=1;e<a.length;e++){var c=a[e];do c=c(!0);while(c!==null)}_c=null,M1=!1}catch(d){throw _c!==null&&(_c=_c.slice(e+1)),WA(R3,Gu),d}finally{ai=r,Ow=!1}}return null}var Xf=[],Yf=0,Xv=null,Yv=0,ys=[],vs=0,Jh=null,yc=1,vc="";function Dh(e,r){Xf[Yf++]=Yv,Xf[Yf++]=Xv,Xv=e,Yv=r}function wR(e,r,a){ys[vs++]=yc,ys[vs++]=vc,ys[vs++]=Jh,Jh=e;var c=yc;e=vc;var d=32-sl(c)-1;c&=~(1<<d),a+=1;var x=32-sl(r)+d;if(30<x){var T=d-d%5;x=(c&(1<<T)-1).toString(32),c>>=T,d-=T,yc=1<<32-sl(r)+d|a<<d|c,vc=x+e}else yc=1<<x|a<<d|c,vc=e}function j3(e){e.return!==null&&(Dh(e,1),wR(e,1,0))}function $3(e){for(;e===Xv;)Xv=Xf[--Yf],Xf[Yf]=null,Yv=Xf[--Yf],Xf[Yf]=null;for(;e===Jh;)Jh=ys[--vs],ys[vs]=null,vc=ys[--vs],ys[vs]=null,yc=ys[--vs],ys[vs]=null}var ts=null,Ja=null,Ri=!1,ol=null;function SR(e,r){var a=xs(5,null,null,0);a.elementType="DELETED",a.stateNode=r,a.return=e,r=e.deletions,r===null?(e.deletions=[a],e.flags|=16):r.push(a)}function gI(e,r){switch(e.tag){case 5:var a=e.type;return r=r.nodeType!==1||a.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(e.stateNode=r,ts=e,Ja=ku(r.firstChild),!0):!1;case 6:return r=e.pendingProps===""||r.nodeType!==3?null:r,r!==null?(e.stateNode=r,ts=e,Ja=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(a=Jh!==null?{id:yc,overflow:vc}:null,e.memoizedState={dehydrated:r,treeContext:a,retryLane:1073741824},a=xs(18,null,null,0),a.stateNode=r,a.return=e,e.child=a,ts=e,Ja=null,!0):!1;default:return!1}}function tS(e){return(e.mode&1)!==0&&(e.flags&128)===0}function rS(e){if(Ri){var r=Ja;if(r){var a=r;if(!gI(e,r)){if(tS(e))throw Error(rr(418));r=ku(a.nextSibling);var c=ts;r&&gI(e,r)?SR(c,a):(e.flags=e.flags&-4097|2,Ri=!1,ts=e)}}else{if(tS(e))throw Error(rr(418));e.flags=e.flags&-4097|2,Ri=!1,ts=e}}}function _I(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;ts=e}function Yy(e){if(e!==ts)return!1;if(!Ri)return _I(e),Ri=!0,!1;var r;if((r=e.tag!==3)&&!(r=e.tag!==5)&&(r=e.type,r=r!=="head"&&r!=="body"&&!K2(e.type,e.memoizedProps)),r&&(r=Ja)){if(tS(e))throw ER(),Error(rr(418));for(;r;)SR(e,r),r=ku(r.nextSibling)}if(_I(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(rr(317));e:{for(e=e.nextSibling,r=0;e;){if(e.nodeType===8){var a=e.data;if(a==="/$"){if(r===0){Ja=ku(e.nextSibling);break e}r--}else a!=="$"&&a!=="$!"&&a!=="$?"||r++}e=e.nextSibling}Ja=null}}else Ja=ts?ku(e.stateNode.nextSibling):null;return!0}function ER(){for(var e=Ja;e;)e=ku(e.nextSibling)}function pp(){Ja=ts=null,Ri=!1}function V3(e){ol===null?ol=[e]:ol.push(e)}var bB=Ic.ReactCurrentBatchConfig;function vg(e,r,a){if(e=a.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(a._owner){if(a=a._owner,a){if(a.tag!==1)throw Error(rr(309));var c=a.stateNode}if(!c)throw Error(rr(147,e));var d=c,x=""+e;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===x?r.ref:(r=function(T){var i=d.refs;T===null?delete i[x]:i[x]=T},r._stringRef=x,r)}if(typeof e!="string")throw Error(rr(284));if(!a._owner)throw Error(rr(290,e))}return e}function Ky(e,r){throw e=Object.prototype.toString.call(r),Error(rr(31,e==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":e))}function yI(e){var r=e._init;return r(e._payload)}function TR(e){function r(re,ee){if(e){var ae=re.deletions;ae===null?(re.deletions=[ee],re.flags|=16):ae.push(ee)}}function a(re,ee){if(!e)return null;for(;ee!==null;)r(re,ee),ee=ee.sibling;return null}function c(re,ee){for(re=new Map;ee!==null;)ee.key!==null?re.set(ee.key,ee):re.set(ee.index,ee),ee=ee.sibling;return re}function d(re,ee){return re=Bu(re,ee),re.index=0,re.sibling=null,re}function x(re,ee,ae){return re.index=ae,e?(ae=re.alternate,ae!==null?(ae=ae.index,ae<ee?(re.flags|=2,ee):ae):(re.flags|=2,ee)):(re.flags|=1048576,ee)}function T(re){return e&&re.alternate===null&&(re.flags|=2),re}function i(re,ee,ae,ve){return ee===null||ee.tag!==6?(ee=Uw(ae,re.mode,ve),ee.return=re,ee):(ee=d(ee,ae),ee.return=re,ee)}function L(re,ee,ae,ve){var Te=ae.type;return Te===Uf?U(re,ee,ae.props.children,ve,ae.key):ee!==null&&(ee.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===xu&&yI(Te)===ee.type)?(ve=d(ee,ae.props),ve.ref=vg(re,ee,ae),ve.return=re,ve):(ve=Iv(ae.type,ae.key,ae.props,null,re.mode,ve),ve.ref=vg(re,ee,ae),ve.return=re,ve)}function N(re,ee,ae,ve){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ae.containerInfo||ee.stateNode.implementation!==ae.implementation?(ee=Gw(ae,re.mode,ve),ee.return=re,ee):(ee=d(ee,ae.children||[]),ee.return=re,ee)}function U(re,ee,ae,ve,Te){return ee===null||ee.tag!==7?(ee=qh(ae,re.mode,ve,Te),ee.return=re,ee):(ee=d(ee,ae),ee.return=re,ee)}function q(re,ee,ae){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return ee=Uw(""+ee,re.mode,ae),ee.return=re,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case jy:return ae=Iv(ee.type,ee.key,ee.props,null,re.mode,ae),ae.ref=vg(re,null,ee),ae.return=re,ae;case Vf:return ee=Gw(ee,re.mode,ae),ee.return=re,ee;case xu:var ve=ee._init;return q(re,ve(ee._payload),ae)}if(Rg(ee)||pg(ee))return ee=qh(ee,re.mode,ae,null),ee.return=re,ee;Ky(re,ee)}return null}function X(re,ee,ae,ve){var Te=ee!==null?ee.key:null;if(typeof ae=="string"&&ae!==""||typeof ae=="number")return Te!==null?null:i(re,ee,""+ae,ve);if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case jy:return ae.key===Te?L(re,ee,ae,ve):null;case Vf:return ae.key===Te?N(re,ee,ae,ve):null;case xu:return Te=ae._init,X(re,ee,Te(ae._payload),ve)}if(Rg(ae)||pg(ae))return Te!==null?null:U(re,ee,ae,ve,null);Ky(re,ae)}return null}function se(re,ee,ae,ve,Te){if(typeof ve=="string"&&ve!==""||typeof ve=="number")return re=re.get(ae)||null,i(ee,re,""+ve,Te);if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case jy:return re=re.get(ve.key===null?ae:ve.key)||null,L(ee,re,ve,Te);case Vf:return re=re.get(ve.key===null?ae:ve.key)||null,N(ee,re,ve,Te);case xu:var pe=ve._init;return se(re,ee,ae,pe(ve._payload),Te)}if(Rg(ve)||pg(ve))return re=re.get(ae)||null,U(ee,re,ve,Te,null);Ky(ee,ve)}return null}function ce(re,ee,ae,ve){for(var Te=null,pe=null,Ee=ee,Ne=ee=0,Xe=null;Ee!==null&&Ne<ae.length;Ne++){Ee.index>Ne?(Xe=Ee,Ee=null):Xe=Ee.sibling;var Fe=X(re,Ee,ae[Ne],ve);if(Fe===null){Ee===null&&(Ee=Xe);break}e&&Ee&&Fe.alternate===null&&r(re,Ee),ee=x(Fe,ee,Ne),pe===null?Te=Fe:pe.sibling=Fe,pe=Fe,Ee=Xe}if(Ne===ae.length)return a(re,Ee),Ri&&Dh(re,Ne),Te;if(Ee===null){for(;Ne<ae.length;Ne++)Ee=q(re,ae[Ne],ve),Ee!==null&&(ee=x(Ee,ee,Ne),pe===null?Te=Ee:pe.sibling=Ee,pe=Ee);return Ri&&Dh(re,Ne),Te}for(Ee=c(re,Ee);Ne<ae.length;Ne++)Xe=se(Ee,re,Ne,ae[Ne],ve),Xe!==null&&(e&&Xe.alternate!==null&&Ee.delete(Xe.key===null?Ne:Xe.key),ee=x(Xe,ee,Ne),pe===null?Te=Xe:pe.sibling=Xe,pe=Xe);return e&&Ee.forEach(function(Je){return r(re,Je)}),Ri&&Dh(re,Ne),Te}function ue(re,ee,ae,ve){var Te=pg(ae);if(typeof Te!="function")throw Error(rr(150));if(ae=Te.call(ae),ae==null)throw Error(rr(151));for(var pe=Te=null,Ee=ee,Ne=ee=0,Xe=null,Fe=ae.next();Ee!==null&&!Fe.done;Ne++,Fe=ae.next()){Ee.index>Ne?(Xe=Ee,Ee=null):Xe=Ee.sibling;var Je=X(re,Ee,Fe.value,ve);if(Je===null){Ee===null&&(Ee=Xe);break}e&&Ee&&Je.alternate===null&&r(re,Ee),ee=x(Je,ee,Ne),pe===null?Te=Je:pe.sibling=Je,pe=Je,Ee=Xe}if(Fe.done)return a(re,Ee),Ri&&Dh(re,Ne),Te;if(Ee===null){for(;!Fe.done;Ne++,Fe=ae.next())Fe=q(re,Fe.value,ve),Fe!==null&&(ee=x(Fe,ee,Ne),pe===null?Te=Fe:pe.sibling=Fe,pe=Fe);return Ri&&Dh(re,Ne),Te}for(Ee=c(re,Ee);!Fe.done;Ne++,Fe=ae.next())Fe=se(Ee,re,Ne,Fe.value,ve),Fe!==null&&(e&&Fe.alternate!==null&&Ee.delete(Fe.key===null?Ne:Fe.key),ee=x(Fe,ee,Ne),pe===null?Te=Fe:pe.sibling=Fe,pe=Fe);return e&&Ee.forEach(function(Ct){return r(re,Ct)}),Ri&&Dh(re,Ne),Te}function fe(re,ee,ae,ve){if(typeof ae=="object"&&ae!==null&&ae.type===Uf&&ae.key===null&&(ae=ae.props.children),typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case jy:e:{for(var Te=ae.key,pe=ee;pe!==null;){if(pe.key===Te){if(Te=ae.type,Te===Uf){if(pe.tag===7){a(re,pe.sibling),ee=d(pe,ae.props.children),ee.return=re,re=ee;break e}}else if(pe.elementType===Te||typeof Te=="object"&&Te!==null&&Te.$$typeof===xu&&yI(Te)===pe.type){a(re,pe.sibling),ee=d(pe,ae.props),ee.ref=vg(re,pe,ae),ee.return=re,re=ee;break e}a(re,pe);break}else r(re,pe);pe=pe.sibling}ae.type===Uf?(ee=qh(ae.props.children,re.mode,ve,ae.key),ee.return=re,re=ee):(ve=Iv(ae.type,ae.key,ae.props,null,re.mode,ve),ve.ref=vg(re,ee,ae),ve.return=re,re=ve)}return T(re);case Vf:e:{for(pe=ae.key;ee!==null;){if(ee.key===pe)if(ee.tag===4&&ee.stateNode.containerInfo===ae.containerInfo&&ee.stateNode.implementation===ae.implementation){a(re,ee.sibling),ee=d(ee,ae.children||[]),ee.return=re,re=ee;break e}else{a(re,ee);break}else r(re,ee);ee=ee.sibling}ee=Gw(ae,re.mode,ve),ee.return=re,re=ee}return T(re);case xu:return pe=ae._init,fe(re,ee,pe(ae._payload),ve)}if(Rg(ae))return ce(re,ee,ae,ve);if(pg(ae))return ue(re,ee,ae,ve);Ky(re,ae)}return typeof ae=="string"&&ae!==""||typeof ae=="number"?(ae=""+ae,ee!==null&&ee.tag===6?(a(re,ee.sibling),ee=d(ee,ae),ee.return=re,re=ee):(a(re,ee),ee=Uw(ae,re.mode,ve),ee.return=re,re=ee),T(re)):a(re,ee)}return fe}var mp=TR(!0),CR=TR(!1),Kv=Uu(null),Jv=null,Kf=null,U3=null;function G3(){U3=Kf=Jv=null}function H3(e){var r=Kv.current;Pi(Kv),e._currentValue=r}function nS(e,r,a){for(;e!==null;){var c=e.alternate;if((e.childLanes&r)!==r?(e.childLanes|=r,c!==null&&(c.childLanes|=r)):c!==null&&(c.childLanes&r)!==r&&(c.childLanes|=r),e===a)break;e=e.return}}function lp(e,r){Jv=e,U3=Kf=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&r&&(Aa=!0),e.firstContext=null)}function Ss(e){var r=e._currentValue;if(U3!==e)if(e={context:e,memoizedValue:r,next:null},Kf===null){if(Jv===null)throw Error(rr(308));Kf=e,Jv.dependencies={lanes:0,firstContext:e}}else Kf=Kf.next=e;return r}var $h=null;function W3(e){$h===null?$h=[e]:$h.push(e)}function MR(e,r,a,c){var d=r.interleaved;return d===null?(a.next=a,W3(r)):(a.next=d.next,d.next=a),r.interleaved=a,Tc(e,c)}function Tc(e,r){e.lanes|=r;var a=e.alternate;for(a!==null&&(a.lanes|=r),a=e,e=e.return;e!==null;)e.childLanes|=r,a=e.alternate,a!==null&&(a.childLanes|=r),a=e,e=e.return;return a.tag===3?a.stateNode:null}var bu=!1;function q3(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function IR(e,r){e=e.updateQueue,r.updateQueue===e&&(r.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function xc(e,r){return{eventTime:e,lane:r,tag:0,payload:null,callback:null,next:null}}function Du(e,r,a){var c=e.updateQueue;if(c===null)return null;if(c=c.shared,qn&2){var d=c.pending;return d===null?r.next=r:(r.next=d.next,d.next=r),c.pending=r,Tc(e,a)}return d=c.interleaved,d===null?(r.next=r,W3(c)):(r.next=d.next,d.next=r),c.interleaved=r,Tc(e,a)}function wv(e,r,a){if(r=r.updateQueue,r!==null&&(r=r.shared,(a&4194240)!==0)){var c=r.lanes;c&=e.pendingLanes,a|=c,r.lanes=a,z3(e,a)}}function vI(e,r){var a=e.updateQueue,c=e.alternate;if(c!==null&&(c=c.updateQueue,a===c)){var d=null,x=null;if(a=a.firstBaseUpdate,a!==null){do{var T={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};x===null?d=x=T:x=x.next=T,a=a.next}while(a!==null);x===null?d=x=r:x=x.next=r}else d=x=r;a={baseState:c.baseState,firstBaseUpdate:d,lastBaseUpdate:x,shared:c.shared,effects:c.effects},e.updateQueue=a;return}e=a.lastBaseUpdate,e===null?a.firstBaseUpdate=r:e.next=r,a.lastBaseUpdate=r}function Qv(e,r,a,c){var d=e.updateQueue;bu=!1;var x=d.firstBaseUpdate,T=d.lastBaseUpdate,i=d.shared.pending;if(i!==null){d.shared.pending=null;var L=i,N=L.next;L.next=null,T===null?x=N:T.next=N,T=L;var U=e.alternate;U!==null&&(U=U.updateQueue,i=U.lastBaseUpdate,i!==T&&(i===null?U.firstBaseUpdate=N:i.next=N,U.lastBaseUpdate=L))}if(x!==null){var q=d.baseState;T=0,U=N=L=null,i=x;do{var X=i.lane,se=i.eventTime;if((c&X)===X){U!==null&&(U=U.next={eventTime:se,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var ce=e,ue=i;switch(X=r,se=a,ue.tag){case 1:if(ce=ue.payload,typeof ce=="function"){q=ce.call(se,q,X);break e}q=ce;break e;case 3:ce.flags=ce.flags&-65537|128;case 0:if(ce=ue.payload,X=typeof ce=="function"?ce.call(se,q,X):ce,X==null)break e;q=ji({},q,X);break e;case 2:bu=!0}}i.callback!==null&&i.lane!==0&&(e.flags|=64,X=d.effects,X===null?d.effects=[i]:X.push(i))}else se={eventTime:se,lane:X,tag:i.tag,payload:i.payload,callback:i.callback,next:null},U===null?(N=U=se,L=q):U=U.next=se,T|=X;if(i=i.next,i===null){if(i=d.shared.pending,i===null)break;X=i,i=X.next,X.next=null,d.lastBaseUpdate=X,d.shared.pending=null}}while(1);if(U===null&&(L=q),d.baseState=L,d.firstBaseUpdate=N,d.lastBaseUpdate=U,r=d.shared.interleaved,r!==null){d=r;do T|=d.lane,d=d.next;while(d!==r)}else x===null&&(d.shared.lanes=0);ed|=T,e.lanes=T,e.memoizedState=q}}function xI(e,r,a){if(e=r.effects,r.effects=null,e!==null)for(r=0;r<e.length;r++){var c=e[r],d=c.callback;if(d!==null){if(c.callback=null,c=a,typeof d!="function")throw Error(rr(191,d));d.call(c)}}}var D_={},jl=Uu(D_),a_=Uu(D_),s_=Uu(D_);function Vh(e){if(e===D_)throw Error(rr(174));return e}function Z3(e,r){switch(xi(s_,r),xi(a_,e),xi(jl,D_),e=r.nodeType,e){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:F2(null,"");break;default:e=e===8?r.parentNode:r,r=e.namespaceURI||null,e=e.tagName,r=F2(r,e)}Pi(jl),xi(jl,r)}function gp(){Pi(jl),Pi(a_),Pi(s_)}function PR(e){Vh(s_.current);var r=Vh(jl.current),a=F2(r,e.type);r!==a&&(xi(a_,e),xi(jl,a))}function X3(e){a_.current===e&&(Pi(jl),Pi(a_))}var Bi=Uu(0);function e1(e){for(var r=e;r!==null;){if(r.tag===13){var a=r.memoizedState;if(a!==null&&(a=a.dehydrated,a===null||a.data==="$?"||a.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if(r.flags&128)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Fw=[];function Y3(){for(var e=0;e<Fw.length;e++)Fw[e]._workInProgressVersionPrimary=null;Fw.length=0}var Sv=Ic.ReactCurrentDispatcher,Bw=Ic.ReactCurrentBatchConfig,Qh=0,Ni=null,_o=null,Co=null,t1=!1,$g=!1,l_=0,wB=0;function ia(){throw Error(rr(321))}function K3(e,r){if(r===null)return!1;for(var a=0;a<r.length&&a<e.length;a++)if(!dl(e[a],r[a]))return!1;return!0}function J3(e,r,a,c,d,x){if(Qh=x,Ni=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Sv.current=e===null||e.memoizedState===null?CB:MB,e=a(c,d),$g){x=0;do{if($g=!1,l_=0,25<=x)throw Error(rr(301));x+=1,Co=_o=null,r.updateQueue=null,Sv.current=IB,e=a(c,d)}while($g)}if(Sv.current=r1,r=_o!==null&&_o.next!==null,Qh=0,Co=_o=Ni=null,t1=!1,r)throw Error(rr(300));return e}function Q3(){var e=l_!==0;return l_=0,e}function Ol(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Co===null?Ni.memoizedState=Co=e:Co=Co.next=e,Co}function Es(){if(_o===null){var e=Ni.alternate;e=e!==null?e.memoizedState:null}else e=_o.next;var r=Co===null?Ni.memoizedState:Co.next;if(r!==null)Co=r,_o=e;else{if(e===null)throw Error(rr(310));_o=e,e={memoizedState:_o.memoizedState,baseState:_o.baseState,baseQueue:_o.baseQueue,queue:_o.queue,next:null},Co===null?Ni.memoizedState=Co=e:Co=Co.next=e}return Co}function c_(e,r){return typeof r=="function"?r(e):r}function Nw(e){var r=Es(),a=r.queue;if(a===null)throw Error(rr(311));a.lastRenderedReducer=e;var c=_o,d=c.baseQueue,x=a.pending;if(x!==null){if(d!==null){var T=d.next;d.next=x.next,x.next=T}c.baseQueue=d=x,a.pending=null}if(d!==null){x=d.next,c=c.baseState;var i=T=null,L=null,N=x;do{var U=N.lane;if((Qh&U)===U)L!==null&&(L=L.next={lane:0,action:N.action,hasEagerState:N.hasEagerState,eagerState:N.eagerState,next:null}),c=N.hasEagerState?N.eagerState:e(c,N.action);else{var q={lane:U,action:N.action,hasEagerState:N.hasEagerState,eagerState:N.eagerState,next:null};L===null?(i=L=q,T=c):L=L.next=q,Ni.lanes|=U,ed|=U}N=N.next}while(N!==null&&N!==x);L===null?T=c:L.next=i,dl(c,r.memoizedState)||(Aa=!0),r.memoizedState=c,r.baseState=T,r.baseQueue=L,a.lastRenderedState=c}if(e=a.interleaved,e!==null){d=e;do x=d.lane,Ni.lanes|=x,ed|=x,d=d.next;while(d!==e)}else d===null&&(a.lanes=0);return[r.memoizedState,a.dispatch]}function jw(e){var r=Es(),a=r.queue;if(a===null)throw Error(rr(311));a.lastRenderedReducer=e;var c=a.dispatch,d=a.pending,x=r.memoizedState;if(d!==null){a.pending=null;var T=d=d.next;do x=e(x,T.action),T=T.next;while(T!==d);dl(x,r.memoizedState)||(Aa=!0),r.memoizedState=x,r.baseQueue===null&&(r.baseState=x),a.lastRenderedState=x}return[x,c]}function AR(){}function RR(e,r){var a=Ni,c=Es(),d=r(),x=!dl(c.memoizedState,d);if(x&&(c.memoizedState=d,Aa=!0),c=c.queue,eE(kR.bind(null,a,c,e),[e]),c.getSnapshot!==r||x||Co!==null&&Co.memoizedState.tag&1){if(a.flags|=2048,u_(9,LR.bind(null,a,c,d,r),void 0,null),Io===null)throw Error(rr(349));Qh&30||zR(a,r,d)}return d}function zR(e,r,a){e.flags|=16384,e={getSnapshot:r,value:a},r=Ni.updateQueue,r===null?(r={lastEffect:null,stores:null},Ni.updateQueue=r,r.stores=[e]):(a=r.stores,a===null?r.stores=[e]:a.push(e))}function LR(e,r,a,c){r.value=a,r.getSnapshot=c,DR(r)&&OR(e)}function kR(e,r,a){return a(function(){DR(r)&&OR(e)})}function DR(e){var r=e.getSnapshot;e=e.value;try{var a=r();return!dl(e,a)}catch{return!0}}function OR(e){var r=Tc(e,1);r!==null&&ll(r,e,1,-1)}function bI(e){var r=Ol();return typeof e=="function"&&(e=e()),r.memoizedState=r.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:c_,lastRenderedState:e},r.queue=e,e=e.dispatch=TB.bind(null,Ni,e),[r.memoizedState,e]}function u_(e,r,a,c){return e={tag:e,create:r,destroy:a,deps:c,next:null},r=Ni.updateQueue,r===null?(r={lastEffect:null,stores:null},Ni.updateQueue=r,r.lastEffect=e.next=e):(a=r.lastEffect,a===null?r.lastEffect=e.next=e:(c=a.next,a.next=e,e.next=c,r.lastEffect=e)),e}function FR(){return Es().memoizedState}function Ev(e,r,a,c){var d=Ol();Ni.flags|=e,d.memoizedState=u_(1|r,a,void 0,c===void 0?null:c)}function I1(e,r,a,c){var d=Es();c=c===void 0?null:c;var x=void 0;if(_o!==null){var T=_o.memoizedState;if(x=T.destroy,c!==null&&K3(c,T.deps)){d.memoizedState=u_(r,a,x,c);return}}Ni.flags|=e,d.memoizedState=u_(1|r,a,x,c)}function wI(e,r){return Ev(8390656,8,e,r)}function eE(e,r){return I1(2048,8,e,r)}function BR(e,r){return I1(4,2,e,r)}function NR(e,r){return I1(4,4,e,r)}function jR(e,r){if(typeof r=="function")return e=e(),r(e),function(){r(null)};if(r!=null)return e=e(),r.current=e,function(){r.current=null}}function $R(e,r,a){return a=a!=null?a.concat([e]):null,I1(4,4,jR.bind(null,r,e),a)}function tE(){}function VR(e,r){var a=Es();r=r===void 0?null:r;var c=a.memoizedState;return c!==null&&r!==null&&K3(r,c[1])?c[0]:(a.memoizedState=[e,r],e)}function UR(e,r){var a=Es();r=r===void 0?null:r;var c=a.memoizedState;return c!==null&&r!==null&&K3(r,c[1])?c[0]:(e=e(),a.memoizedState=[e,r],e)}function GR(e,r,a){return Qh&21?(dl(a,r)||(a=XA(),Ni.lanes|=a,ed|=a,e.baseState=!0),r):(e.baseState&&(e.baseState=!1,Aa=!0),e.memoizedState=a)}function SB(e,r){var a=ai;ai=a!==0&&4>a?a:4,e(!0);var c=Bw.transition;Bw.transition={};try{e(!1),r()}finally{ai=a,Bw.transition=c}}function HR(){return Es().memoizedState}function EB(e,r,a){var c=Fu(e);if(a={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null},WR(e))qR(r,a);else if(a=MR(e,r,a,c),a!==null){var d=fa();ll(a,e,c,d),ZR(a,r,c)}}function TB(e,r,a){var c=Fu(e),d={lane:c,action:a,hasEagerState:!1,eagerState:null,next:null};if(WR(e))qR(r,d);else{var x=e.alternate;if(e.lanes===0&&(x===null||x.lanes===0)&&(x=r.lastRenderedReducer,x!==null))try{var T=r.lastRenderedState,i=x(T,a);if(d.hasEagerState=!0,d.eagerState=i,dl(i,T)){var L=r.interleaved;L===null?(d.next=d,W3(r)):(d.next=L.next,L.next=d),r.interleaved=d;return}}catch{}finally{}a=MR(e,r,d,c),a!==null&&(d=fa(),ll(a,e,c,d),ZR(a,r,c))}}function WR(e){var r=e.alternate;return e===Ni||r!==null&&r===Ni}function qR(e,r){$g=t1=!0;var a=e.pending;a===null?r.next=r:(r.next=a.next,a.next=r),e.pending=r}function ZR(e,r,a){if(a&4194240){var c=r.lanes;c&=e.pendingLanes,a|=c,r.lanes=a,z3(e,a)}}var r1={readContext:Ss,useCallback:ia,useContext:ia,useEffect:ia,useImperativeHandle:ia,useInsertionEffect:ia,useLayoutEffect:ia,useMemo:ia,useReducer:ia,useRef:ia,useState:ia,useDebugValue:ia,useDeferredValue:ia,useTransition:ia,useMutableSource:ia,useSyncExternalStore:ia,useId:ia,unstable_isNewReconciler:!1},CB={readContext:Ss,useCallback:function(e,r){return Ol().memoizedState=[e,r===void 0?null:r],e},useContext:Ss,useEffect:wI,useImperativeHandle:function(e,r,a){return a=a!=null?a.concat([e]):null,Ev(4194308,4,jR.bind(null,r,e),a)},useLayoutEffect:function(e,r){return Ev(4194308,4,e,r)},useInsertionEffect:function(e,r){return Ev(4,2,e,r)},useMemo:function(e,r){var a=Ol();return r=r===void 0?null:r,e=e(),a.memoizedState=[e,r],e},useReducer:function(e,r,a){var c=Ol();return r=a!==void 0?a(r):r,c.memoizedState=c.baseState=r,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},c.queue=e,e=e.dispatch=EB.bind(null,Ni,e),[c.memoizedState,e]},useRef:function(e){var r=Ol();return e={current:e},r.memoizedState=e},useState:bI,useDebugValue:tE,useDeferredValue:function(e){return Ol().memoizedState=e},useTransition:function(){var e=bI(!1),r=e[0];return e=SB.bind(null,e[1]),Ol().memoizedState=e,[r,e]},useMutableSource:function(){},useSyncExternalStore:function(e,r,a){var c=Ni,d=Ol();if(Ri){if(a===void 0)throw Error(rr(407));a=a()}else{if(a=r(),Io===null)throw Error(rr(349));Qh&30||zR(c,r,a)}d.memoizedState=a;var x={value:a,getSnapshot:r};return d.queue=x,wI(kR.bind(null,c,x,e),[e]),c.flags|=2048,u_(9,LR.bind(null,c,x,a,r),void 0,null),a},useId:function(){var e=Ol(),r=Io.identifierPrefix;if(Ri){var a=vc,c=yc;a=(c&~(1<<32-sl(c)-1)).toString(32)+a,r=":"+r+"R"+a,a=l_++,0<a&&(r+="H"+a.toString(32)),r+=":"}else a=wB++,r=":"+r+"r"+a.toString(32)+":";return e.memoizedState=r},unstable_isNewReconciler:!1},MB={readContext:Ss,useCallback:VR,useContext:Ss,useEffect:eE,useImperativeHandle:$R,useInsertionEffect:BR,useLayoutEffect:NR,useMemo:UR,useReducer:Nw,useRef:FR,useState:function(){return Nw(c_)},useDebugValue:tE,useDeferredValue:function(e){var r=Es();return GR(r,_o.memoizedState,e)},useTransition:function(){var e=Nw(c_)[0],r=Es().memoizedState;return[e,r]},useMutableSource:AR,useSyncExternalStore:RR,useId:HR,unstable_isNewReconciler:!1},IB={readContext:Ss,useCallback:VR,useContext:Ss,useEffect:eE,useImperativeHandle:$R,useInsertionEffect:BR,useLayoutEffect:NR,useMemo:UR,useReducer:jw,useRef:FR,useState:function(){return jw(c_)},useDebugValue:tE,useDeferredValue:function(e){var r=Es();return _o===null?r.memoizedState=e:GR(r,_o.memoizedState,e)},useTransition:function(){var e=jw(c_)[0],r=Es().memoizedState;return[e,r]},useMutableSource:AR,useSyncExternalStore:RR,useId:HR,unstable_isNewReconciler:!1};function tl(e,r){if(e&&e.defaultProps){r=ji({},r),e=e.defaultProps;for(var a in e)r[a]===void 0&&(r[a]=e[a]);return r}return r}function iS(e,r,a,c){r=e.memoizedState,a=a(c,r),a=a==null?r:ji({},r,a),e.memoizedState=a,e.lanes===0&&(e.updateQueue.baseState=a)}var P1={isMounted:function(e){return(e=e._reactInternals)?ld(e)===e:!1},enqueueSetState:function(e,r,a){e=e._reactInternals;var c=fa(),d=Fu(e),x=xc(c,d);x.payload=r,a!=null&&(x.callback=a),r=Du(e,x,d),r!==null&&(ll(r,e,d,c),wv(r,e,d))},enqueueReplaceState:function(e,r,a){e=e._reactInternals;var c=fa(),d=Fu(e),x=xc(c,d);x.tag=1,x.payload=r,a!=null&&(x.callback=a),r=Du(e,x,d),r!==null&&(ll(r,e,d,c),wv(r,e,d))},enqueueForceUpdate:function(e,r){e=e._reactInternals;var a=fa(),c=Fu(e),d=xc(a,c);d.tag=2,r!=null&&(d.callback=r),r=Du(e,d,c),r!==null&&(ll(r,e,c,a),wv(r,e,c))}};function SI(e,r,a,c,d,x,T){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(c,x,T):r.prototype&&r.prototype.isPureReactComponent?!r_(a,c)||!r_(d,x):!0}function XR(e,r,a){var c=!1,d=ju,x=r.contextType;return typeof x=="object"&&x!==null?x=Ss(x):(d=za(r)?Kh:sa.current,c=r.contextTypes,x=(c=c!=null)?fp(e,d):ju),r=new r(a,x),e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=P1,e.stateNode=r,r._reactInternals=e,c&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=d,e.__reactInternalMemoizedMaskedChildContext=x),r}function EI(e,r,a,c){e=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(a,c),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(a,c),r.state!==e&&P1.enqueueReplaceState(r,r.state,null)}function oS(e,r,a,c){var d=e.stateNode;d.props=a,d.state=e.memoizedState,d.refs={},q3(e);var x=r.contextType;typeof x=="object"&&x!==null?d.context=Ss(x):(x=za(r)?Kh:sa.current,d.context=fp(e,x)),d.state=e.memoizedState,x=r.getDerivedStateFromProps,typeof x=="function"&&(iS(e,r,x,a),d.state=e.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof d.getSnapshotBeforeUpdate=="function"||typeof d.UNSAFE_componentWillMount!="function"&&typeof d.componentWillMount!="function"||(r=d.state,typeof d.componentWillMount=="function"&&d.componentWillMount(),typeof d.UNSAFE_componentWillMount=="function"&&d.UNSAFE_componentWillMount(),r!==d.state&&P1.enqueueReplaceState(d,d.state,null),Qv(e,a,d,c),d.state=e.memoizedState),typeof d.componentDidMount=="function"&&(e.flags|=4194308)}function _p(e,r){try{var a="",c=r;do a+=r8(c),c=c.return;while(c);var d=a}catch(x){d=`
Error generating stack: `+x.message+`
`+x.stack}return{value:e,source:r,stack:d,digest:null}}function $w(e,r,a){return{value:e,source:null,stack:a??null,digest:r??null}}function aS(e,r){try{console.error(r.value)}catch(a){setTimeout(function(){throw a})}}var PB=typeof WeakMap=="function"?WeakMap:Map;function YR(e,r,a){a=xc(-1,a),a.tag=3,a.payload={element:null};var c=r.value;return a.callback=function(){i1||(i1=!0,gS=c),aS(e,r)},a}function KR(e,r,a){a=xc(-1,a),a.tag=3;var c=e.type.getDerivedStateFromError;if(typeof c=="function"){var d=r.value;a.payload=function(){return c(d)},a.callback=function(){aS(e,r)}}var x=e.stateNode;return x!==null&&typeof x.componentDidCatch=="function"&&(a.callback=function(){aS(e,r),typeof c!="function"&&(Ou===null?Ou=new Set([this]):Ou.add(this));var T=r.stack;this.componentDidCatch(r.value,{componentStack:T!==null?T:""})}),a}function TI(e,r,a){var c=e.pingCache;if(c===null){c=e.pingCache=new PB;var d=new Set;c.set(r,d)}else d=c.get(r),d===void 0&&(d=new Set,c.set(r,d));d.has(a)||(d.add(a),e=UB.bind(null,e,r,a),r.then(e,e))}function CI(e){do{var r;if((r=e.tag===13)&&(r=e.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return e;e=e.return}while(e!==null);return null}function MI(e,r,a,c,d){return e.mode&1?(e.flags|=65536,e.lanes=d,e):(e===r?e.flags|=65536:(e.flags|=128,a.flags|=131072,a.flags&=-52805,a.tag===1&&(a.alternate===null?a.tag=17:(r=xc(-1,1),r.tag=2,Du(a,r,1))),a.lanes|=1),e)}var AB=Ic.ReactCurrentOwner,Aa=!1;function da(e,r,a,c){r.child=e===null?CR(r,null,a,c):mp(r,e.child,a,c)}function II(e,r,a,c,d){a=a.render;var x=r.ref;return lp(r,d),c=J3(e,r,a,c,x,d),a=Q3(),e!==null&&!Aa?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~d,Cc(e,r,d)):(Ri&&a&&j3(r),r.flags|=1,da(e,r,c,d),r.child)}function PI(e,r,a,c,d){if(e===null){var x=a.type;return typeof x=="function"&&!cE(x)&&x.defaultProps===void 0&&a.compare===null&&a.defaultProps===void 0?(r.tag=15,r.type=x,JR(e,r,x,c,d)):(e=Iv(a.type,null,c,r,r.mode,d),e.ref=r.ref,e.return=r,r.child=e)}if(x=e.child,!(e.lanes&d)){var T=x.memoizedProps;if(a=a.compare,a=a!==null?a:r_,a(T,c)&&e.ref===r.ref)return Cc(e,r,d)}return r.flags|=1,e=Bu(x,c),e.ref=r.ref,e.return=r,r.child=e}function JR(e,r,a,c,d){if(e!==null){var x=e.memoizedProps;if(r_(x,c)&&e.ref===r.ref)if(Aa=!1,r.pendingProps=c=x,(e.lanes&d)!==0)e.flags&131072&&(Aa=!0);else return r.lanes=e.lanes,Cc(e,r,d)}return sS(e,r,a,c,d)}function QR(e,r,a){var c=r.pendingProps,d=c.children,x=e!==null?e.memoizedState:null;if(c.mode==="hidden")if(!(r.mode&1))r.memoizedState={baseLanes:0,cachePool:null,transitions:null},xi(Qf,Xa),Xa|=a;else{if(!(a&1073741824))return e=x!==null?x.baseLanes|a:a,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:e,cachePool:null,transitions:null},r.updateQueue=null,xi(Qf,Xa),Xa|=e,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},c=x!==null?x.baseLanes:a,xi(Qf,Xa),Xa|=c}else x!==null?(c=x.baseLanes|a,r.memoizedState=null):c=a,xi(Qf,Xa),Xa|=c;return da(e,r,d,a),r.child}function ez(e,r){var a=r.ref;(e===null&&a!==null||e!==null&&e.ref!==a)&&(r.flags|=512,r.flags|=2097152)}function sS(e,r,a,c,d){var x=za(a)?Kh:sa.current;return x=fp(r,x),lp(r,d),a=J3(e,r,a,c,x,d),c=Q3(),e!==null&&!Aa?(r.updateQueue=e.updateQueue,r.flags&=-2053,e.lanes&=~d,Cc(e,r,d)):(Ri&&c&&j3(r),r.flags|=1,da(e,r,a,d),r.child)}function AI(e,r,a,c,d){if(za(a)){var x=!0;Zv(r)}else x=!1;if(lp(r,d),r.stateNode===null)Tv(e,r),XR(r,a,c),oS(r,a,c,d),c=!0;else if(e===null){var T=r.stateNode,i=r.memoizedProps;T.props=i;var L=T.context,N=a.contextType;typeof N=="object"&&N!==null?N=Ss(N):(N=za(a)?Kh:sa.current,N=fp(r,N));var U=a.getDerivedStateFromProps,q=typeof U=="function"||typeof T.getSnapshotBeforeUpdate=="function";q||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(i!==c||L!==N)&&EI(r,T,c,N),bu=!1;var X=r.memoizedState;T.state=X,Qv(r,c,T,d),L=r.memoizedState,i!==c||X!==L||Ra.current||bu?(typeof U=="function"&&(iS(r,a,U,c),L=r.memoizedState),(i=bu||SI(r,a,i,c,X,L,N))?(q||typeof T.UNSAFE_componentWillMount!="function"&&typeof T.componentWillMount!="function"||(typeof T.componentWillMount=="function"&&T.componentWillMount(),typeof T.UNSAFE_componentWillMount=="function"&&T.UNSAFE_componentWillMount()),typeof T.componentDidMount=="function"&&(r.flags|=4194308)):(typeof T.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=c,r.memoizedState=L),T.props=c,T.state=L,T.context=N,c=i):(typeof T.componentDidMount=="function"&&(r.flags|=4194308),c=!1)}else{T=r.stateNode,IR(e,r),i=r.memoizedProps,N=r.type===r.elementType?i:tl(r.type,i),T.props=N,q=r.pendingProps,X=T.context,L=a.contextType,typeof L=="object"&&L!==null?L=Ss(L):(L=za(a)?Kh:sa.current,L=fp(r,L));var se=a.getDerivedStateFromProps;(U=typeof se=="function"||typeof T.getSnapshotBeforeUpdate=="function")||typeof T.UNSAFE_componentWillReceiveProps!="function"&&typeof T.componentWillReceiveProps!="function"||(i!==q||X!==L)&&EI(r,T,c,L),bu=!1,X=r.memoizedState,T.state=X,Qv(r,c,T,d);var ce=r.memoizedState;i!==q||X!==ce||Ra.current||bu?(typeof se=="function"&&(iS(r,a,se,c),ce=r.memoizedState),(N=bu||SI(r,a,N,c,X,ce,L)||!1)?(U||typeof T.UNSAFE_componentWillUpdate!="function"&&typeof T.componentWillUpdate!="function"||(typeof T.componentWillUpdate=="function"&&T.componentWillUpdate(c,ce,L),typeof T.UNSAFE_componentWillUpdate=="function"&&T.UNSAFE_componentWillUpdate(c,ce,L)),typeof T.componentDidUpdate=="function"&&(r.flags|=4),typeof T.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof T.componentDidUpdate!="function"||i===e.memoizedProps&&X===e.memoizedState||(r.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&X===e.memoizedState||(r.flags|=1024),r.memoizedProps=c,r.memoizedState=ce),T.props=c,T.state=ce,T.context=L,c=N):(typeof T.componentDidUpdate!="function"||i===e.memoizedProps&&X===e.memoizedState||(r.flags|=4),typeof T.getSnapshotBeforeUpdate!="function"||i===e.memoizedProps&&X===e.memoizedState||(r.flags|=1024),c=!1)}return lS(e,r,a,c,x,d)}function lS(e,r,a,c,d,x){ez(e,r);var T=(r.flags&128)!==0;if(!c&&!T)return d&&mI(r,a,!1),Cc(e,r,x);c=r.stateNode,AB.current=r;var i=T&&typeof a.getDerivedStateFromError!="function"?null:c.render();return r.flags|=1,e!==null&&T?(r.child=mp(r,e.child,null,x),r.child=mp(r,null,i,x)):da(e,r,i,x),r.memoizedState=c.state,d&&mI(r,a,!0),r.child}function tz(e){var r=e.stateNode;r.pendingContext?pI(e,r.pendingContext,r.pendingContext!==r.context):r.context&&pI(e,r.context,!1),Z3(e,r.containerInfo)}function RI(e,r,a,c,d){return pp(),V3(d),r.flags|=256,da(e,r,a,c),r.child}var cS={dehydrated:null,treeContext:null,retryLane:0};function uS(e){return{baseLanes:e,cachePool:null,transitions:null}}function rz(e,r,a){var c=r.pendingProps,d=Bi.current,x=!1,T=(r.flags&128)!==0,i;if((i=T)||(i=e!==null&&e.memoizedState===null?!1:(d&2)!==0),i?(x=!0,r.flags&=-129):(e===null||e.memoizedState!==null)&&(d|=1),xi(Bi,d&1),e===null)return rS(r),e=r.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(r.mode&1?e.data==="$!"?r.lanes=8:r.lanes=1073741824:r.lanes=1,null):(T=c.children,e=c.fallback,x?(c=r.mode,x=r.child,T={mode:"hidden",children:T},!(c&1)&&x!==null?(x.childLanes=0,x.pendingProps=T):x=z1(T,c,0,null),e=qh(e,c,a,null),x.return=r,e.return=r,x.sibling=e,r.child=x,r.child.memoizedState=uS(a),r.memoizedState=cS,e):rE(r,T));if(d=e.memoizedState,d!==null&&(i=d.dehydrated,i!==null))return RB(e,r,T,c,i,d,a);if(x){x=c.fallback,T=r.mode,d=e.child,i=d.sibling;var L={mode:"hidden",children:c.children};return!(T&1)&&r.child!==d?(c=r.child,c.childLanes=0,c.pendingProps=L,r.deletions=null):(c=Bu(d,L),c.subtreeFlags=d.subtreeFlags&14680064),i!==null?x=Bu(i,x):(x=qh(x,T,a,null),x.flags|=2),x.return=r,c.return=r,c.sibling=x,r.child=c,c=x,x=r.child,T=e.child.memoizedState,T=T===null?uS(a):{baseLanes:T.baseLanes|a,cachePool:null,transitions:T.transitions},x.memoizedState=T,x.childLanes=e.childLanes&~a,r.memoizedState=cS,c}return x=e.child,e=x.sibling,c=Bu(x,{mode:"visible",children:c.children}),!(r.mode&1)&&(c.lanes=a),c.return=r,c.sibling=null,e!==null&&(a=r.deletions,a===null?(r.deletions=[e],r.flags|=16):a.push(e)),r.child=c,r.memoizedState=null,c}function rE(e,r){return r=z1({mode:"visible",children:r},e.mode,0,null),r.return=e,e.child=r}function Jy(e,r,a,c){return c!==null&&V3(c),mp(r,e.child,null,a),e=rE(r,r.pendingProps.children),e.flags|=2,r.memoizedState=null,e}function RB(e,r,a,c,d,x,T){if(a)return r.flags&256?(r.flags&=-257,c=$w(Error(rr(422))),Jy(e,r,T,c)):r.memoizedState!==null?(r.child=e.child,r.flags|=128,null):(x=c.fallback,d=r.mode,c=z1({mode:"visible",children:c.children},d,0,null),x=qh(x,d,T,null),x.flags|=2,c.return=r,x.return=r,c.sibling=x,r.child=c,r.mode&1&&mp(r,e.child,null,T),r.child.memoizedState=uS(T),r.memoizedState=cS,x);if(!(r.mode&1))return Jy(e,r,T,null);if(d.data==="$!"){if(c=d.nextSibling&&d.nextSibling.dataset,c)var i=c.dgst;return c=i,x=Error(rr(419)),c=$w(x,c,void 0),Jy(e,r,T,c)}if(i=(T&e.childLanes)!==0,Aa||i){if(c=Io,c!==null){switch(T&-T){case 4:d=2;break;case 16:d=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:d=32;break;case 536870912:d=268435456;break;default:d=0}d=d&(c.suspendedLanes|T)?0:d,d!==0&&d!==x.retryLane&&(x.retryLane=d,Tc(e,d),ll(c,e,d,-1))}return lE(),c=$w(Error(rr(421))),Jy(e,r,T,c)}return d.data==="$?"?(r.flags|=128,r.child=e.child,r=GB.bind(null,e),d._reactRetry=r,null):(e=x.treeContext,Ja=ku(d.nextSibling),ts=r,Ri=!0,ol=null,e!==null&&(ys[vs++]=yc,ys[vs++]=vc,ys[vs++]=Jh,yc=e.id,vc=e.overflow,Jh=r),r=rE(r,c.children),r.flags|=4096,r)}function zI(e,r,a){e.lanes|=r;var c=e.alternate;c!==null&&(c.lanes|=r),nS(e.return,r,a)}function Vw(e,r,a,c,d){var x=e.memoizedState;x===null?e.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:c,tail:a,tailMode:d}:(x.isBackwards=r,x.rendering=null,x.renderingStartTime=0,x.last=c,x.tail=a,x.tailMode=d)}function nz(e,r,a){var c=r.pendingProps,d=c.revealOrder,x=c.tail;if(da(e,r,c.children,a),c=Bi.current,c&2)c=c&1|2,r.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=r.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&zI(e,a,r);else if(e.tag===19)zI(e,a,r);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===r)break e;for(;e.sibling===null;){if(e.return===null||e.return===r)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}c&=1}if(xi(Bi,c),!(r.mode&1))r.memoizedState=null;else switch(d){case"forwards":for(a=r.child,d=null;a!==null;)e=a.alternate,e!==null&&e1(e)===null&&(d=a),a=a.sibling;a=d,a===null?(d=r.child,r.child=null):(d=a.sibling,a.sibling=null),Vw(r,!1,d,a,x);break;case"backwards":for(a=null,d=r.child,r.child=null;d!==null;){if(e=d.alternate,e!==null&&e1(e)===null){r.child=d;break}e=d.sibling,d.sibling=a,a=d,d=e}Vw(r,!0,a,null,x);break;case"together":Vw(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function Tv(e,r){!(r.mode&1)&&e!==null&&(e.alternate=null,r.alternate=null,r.flags|=2)}function Cc(e,r,a){if(e!==null&&(r.dependencies=e.dependencies),ed|=r.lanes,!(a&r.childLanes))return null;if(e!==null&&r.child!==e.child)throw Error(rr(153));if(r.child!==null){for(e=r.child,a=Bu(e,e.pendingProps),r.child=a,a.return=r;e.sibling!==null;)e=e.sibling,a=a.sibling=Bu(e,e.pendingProps),a.return=r;a.sibling=null}return r.child}function zB(e,r,a){switch(r.tag){case 3:tz(r),pp();break;case 5:PR(r);break;case 1:za(r.type)&&Zv(r);break;case 4:Z3(r,r.stateNode.containerInfo);break;case 10:var c=r.type._context,d=r.memoizedProps.value;xi(Kv,c._currentValue),c._currentValue=d;break;case 13:if(c=r.memoizedState,c!==null)return c.dehydrated!==null?(xi(Bi,Bi.current&1),r.flags|=128,null):a&r.child.childLanes?rz(e,r,a):(xi(Bi,Bi.current&1),e=Cc(e,r,a),e!==null?e.sibling:null);xi(Bi,Bi.current&1);break;case 19:if(c=(a&r.childLanes)!==0,e.flags&128){if(c)return nz(e,r,a);r.flags|=128}if(d=r.memoizedState,d!==null&&(d.rendering=null,d.tail=null,d.lastEffect=null),xi(Bi,Bi.current),c)break;return null;case 22:case 23:return r.lanes=0,QR(e,r,a)}return Cc(e,r,a)}var iz,hS,oz,az;iz=function(e,r){for(var a=r.child;a!==null;){if(a.tag===5||a.tag===6)e.appendChild(a.stateNode);else if(a.tag!==4&&a.child!==null){a.child.return=a,a=a.child;continue}if(a===r)break;for(;a.sibling===null;){if(a.return===null||a.return===r)return;a=a.return}a.sibling.return=a.return,a=a.sibling}};hS=function(){};oz=function(e,r,a,c){var d=e.memoizedProps;if(d!==c){e=r.stateNode,Vh(jl.current);var x=null;switch(a){case"input":d=L2(e,d),c=L2(e,c),x=[];break;case"select":d=ji({},d,{value:void 0}),c=ji({},c,{value:void 0}),x=[];break;case"textarea":d=O2(e,d),c=O2(e,c),x=[];break;default:typeof d.onClick!="function"&&typeof c.onClick=="function"&&(e.onclick=Wv)}B2(a,c);var T;a=null;for(N in d)if(!c.hasOwnProperty(N)&&d.hasOwnProperty(N)&&d[N]!=null)if(N==="style"){var i=d[N];for(T in i)i.hasOwnProperty(T)&&(a||(a={}),a[T]="")}else N!=="dangerouslySetInnerHTML"&&N!=="children"&&N!=="suppressContentEditableWarning"&&N!=="suppressHydrationWarning"&&N!=="autoFocus"&&(Xg.hasOwnProperty(N)?x||(x=[]):(x=x||[]).push(N,null));for(N in c){var L=c[N];if(i=d!=null?d[N]:void 0,c.hasOwnProperty(N)&&L!==i&&(L!=null||i!=null))if(N==="style")if(i){for(T in i)!i.hasOwnProperty(T)||L&&L.hasOwnProperty(T)||(a||(a={}),a[T]="");for(T in L)L.hasOwnProperty(T)&&i[T]!==L[T]&&(a||(a={}),a[T]=L[T])}else a||(x||(x=[]),x.push(N,a)),a=L;else N==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,i=i?i.__html:void 0,L!=null&&i!==L&&(x=x||[]).push(N,L)):N==="children"?typeof L!="string"&&typeof L!="number"||(x=x||[]).push(N,""+L):N!=="suppressContentEditableWarning"&&N!=="suppressHydrationWarning"&&(Xg.hasOwnProperty(N)?(L!=null&&N==="onScroll"&&Ii("scroll",e),x||i===L||(x=[])):(x=x||[]).push(N,L))}a&&(x=x||[]).push("style",a);var N=x;(r.updateQueue=N)&&(r.flags|=4)}};az=function(e,r,a,c){a!==c&&(r.flags|=4)};function xg(e,r){if(!Ri)switch(e.tailMode){case"hidden":r=e.tail;for(var a=null;r!==null;)r.alternate!==null&&(a=r),r=r.sibling;a===null?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var c=null;a!==null;)a.alternate!==null&&(c=a),a=a.sibling;c===null?r||e.tail===null?e.tail=null:e.tail.sibling=null:c.sibling=null}}function oa(e){var r=e.alternate!==null&&e.alternate.child===e.child,a=0,c=0;if(r)for(var d=e.child;d!==null;)a|=d.lanes|d.childLanes,c|=d.subtreeFlags&14680064,c|=d.flags&14680064,d.return=e,d=d.sibling;else for(d=e.child;d!==null;)a|=d.lanes|d.childLanes,c|=d.subtreeFlags,c|=d.flags,d.return=e,d=d.sibling;return e.subtreeFlags|=c,e.childLanes=a,r}function LB(e,r,a){var c=r.pendingProps;switch($3(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return oa(r),null;case 1:return za(r.type)&&qv(),oa(r),null;case 3:return c=r.stateNode,gp(),Pi(Ra),Pi(sa),Y3(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(e===null||e.child===null)&&(Yy(r)?r.flags|=4:e===null||e.memoizedState.isDehydrated&&!(r.flags&256)||(r.flags|=1024,ol!==null&&(vS(ol),ol=null))),hS(e,r),oa(r),null;case 5:X3(r);var d=Vh(s_.current);if(a=r.type,e!==null&&r.stateNode!=null)oz(e,r,a,c,d),e.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!c){if(r.stateNode===null)throw Error(rr(166));return oa(r),null}if(e=Vh(jl.current),Yy(r)){c=r.stateNode,a=r.type;var x=r.memoizedProps;switch(c[Bl]=r,c[o_]=x,e=(r.mode&1)!==0,a){case"dialog":Ii("cancel",c),Ii("close",c);break;case"iframe":case"object":case"embed":Ii("load",c);break;case"video":case"audio":for(d=0;d<Lg.length;d++)Ii(Lg[d],c);break;case"source":Ii("error",c);break;case"img":case"image":case"link":Ii("error",c),Ii("load",c);break;case"details":Ii("toggle",c);break;case"input":$M(c,x),Ii("invalid",c);break;case"select":c._wrapperState={wasMultiple:!!x.multiple},Ii("invalid",c);break;case"textarea":UM(c,x),Ii("invalid",c)}B2(a,x),d=null;for(var T in x)if(x.hasOwnProperty(T)){var i=x[T];T==="children"?typeof i=="string"?c.textContent!==i&&(x.suppressHydrationWarning!==!0&&Xy(c.textContent,i,e),d=["children",i]):typeof i=="number"&&c.textContent!==""+i&&(x.suppressHydrationWarning!==!0&&Xy(c.textContent,i,e),d=["children",""+i]):Xg.hasOwnProperty(T)&&i!=null&&T==="onScroll"&&Ii("scroll",c)}switch(a){case"input":$y(c),VM(c,x,!0);break;case"textarea":$y(c),GM(c);break;case"select":case"option":break;default:typeof x.onClick=="function"&&(c.onclick=Wv)}c=d,r.updateQueue=c,c!==null&&(r.flags|=4)}else{T=d.nodeType===9?d:d.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=kA(a)),e==="http://www.w3.org/1999/xhtml"?a==="script"?(e=T.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof c.is=="string"?e=T.createElement(a,{is:c.is}):(e=T.createElement(a),a==="select"&&(T=e,c.multiple?T.multiple=!0:c.size&&(T.size=c.size))):e=T.createElementNS(e,a),e[Bl]=r,e[o_]=c,iz(e,r,!1,!1),r.stateNode=e;e:{switch(T=N2(a,c),a){case"dialog":Ii("cancel",e),Ii("close",e),d=c;break;case"iframe":case"object":case"embed":Ii("load",e),d=c;break;case"video":case"audio":for(d=0;d<Lg.length;d++)Ii(Lg[d],e);d=c;break;case"source":Ii("error",e),d=c;break;case"img":case"image":case"link":Ii("error",e),Ii("load",e),d=c;break;case"details":Ii("toggle",e),d=c;break;case"input":$M(e,c),d=L2(e,c),Ii("invalid",e);break;case"option":d=c;break;case"select":e._wrapperState={wasMultiple:!!c.multiple},d=ji({},c,{value:void 0}),Ii("invalid",e);break;case"textarea":UM(e,c),d=O2(e,c),Ii("invalid",e);break;default:d=c}B2(a,d),i=d;for(x in i)if(i.hasOwnProperty(x)){var L=i[x];x==="style"?FA(e,L):x==="dangerouslySetInnerHTML"?(L=L?L.__html:void 0,L!=null&&DA(e,L)):x==="children"?typeof L=="string"?(a!=="textarea"||L!=="")&&Yg(e,L):typeof L=="number"&&Yg(e,""+L):x!=="suppressContentEditableWarning"&&x!=="suppressHydrationWarning"&&x!=="autoFocus"&&(Xg.hasOwnProperty(x)?L!=null&&x==="onScroll"&&Ii("scroll",e):L!=null&&C3(e,x,L,T))}switch(a){case"input":$y(e),VM(e,c,!1);break;case"textarea":$y(e),GM(e);break;case"option":c.value!=null&&e.setAttribute("value",""+Nu(c.value));break;case"select":e.multiple=!!c.multiple,x=c.value,x!=null?ip(e,!!c.multiple,x,!1):c.defaultValue!=null&&ip(e,!!c.multiple,c.defaultValue,!0);break;default:typeof d.onClick=="function"&&(e.onclick=Wv)}switch(a){case"button":case"input":case"select":case"textarea":c=!!c.autoFocus;break e;case"img":c=!0;break e;default:c=!1}}c&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return oa(r),null;case 6:if(e&&r.stateNode!=null)az(e,r,e.memoizedProps,c);else{if(typeof c!="string"&&r.stateNode===null)throw Error(rr(166));if(a=Vh(s_.current),Vh(jl.current),Yy(r)){if(c=r.stateNode,a=r.memoizedProps,c[Bl]=r,(x=c.nodeValue!==a)&&(e=ts,e!==null))switch(e.tag){case 3:Xy(c.nodeValue,a,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Xy(c.nodeValue,a,(e.mode&1)!==0)}x&&(r.flags|=4)}else c=(a.nodeType===9?a:a.ownerDocument).createTextNode(c),c[Bl]=r,r.stateNode=c}return oa(r),null;case 13:if(Pi(Bi),c=r.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Ri&&Ja!==null&&r.mode&1&&!(r.flags&128))ER(),pp(),r.flags|=98560,x=!1;else if(x=Yy(r),c!==null&&c.dehydrated!==null){if(e===null){if(!x)throw Error(rr(318));if(x=r.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(rr(317));x[Bl]=r}else pp(),!(r.flags&128)&&(r.memoizedState=null),r.flags|=4;oa(r),x=!1}else ol!==null&&(vS(ol),ol=null),x=!0;if(!x)return r.flags&65536?r:null}return r.flags&128?(r.lanes=a,r):(c=c!==null,c!==(e!==null&&e.memoizedState!==null)&&c&&(r.child.flags|=8192,r.mode&1&&(e===null||Bi.current&1?yo===0&&(yo=3):lE())),r.updateQueue!==null&&(r.flags|=4),oa(r),null);case 4:return gp(),hS(e,r),e===null&&n_(r.stateNode.containerInfo),oa(r),null;case 10:return H3(r.type._context),oa(r),null;case 17:return za(r.type)&&qv(),oa(r),null;case 19:if(Pi(Bi),x=r.memoizedState,x===null)return oa(r),null;if(c=(r.flags&128)!==0,T=x.rendering,T===null)if(c)xg(x,!1);else{if(yo!==0||e!==null&&e.flags&128)for(e=r.child;e!==null;){if(T=e1(e),T!==null){for(r.flags|=128,xg(x,!1),c=T.updateQueue,c!==null&&(r.updateQueue=c,r.flags|=4),r.subtreeFlags=0,c=a,a=r.child;a!==null;)x=a,e=c,x.flags&=14680066,T=x.alternate,T===null?(x.childLanes=0,x.lanes=e,x.child=null,x.subtreeFlags=0,x.memoizedProps=null,x.memoizedState=null,x.updateQueue=null,x.dependencies=null,x.stateNode=null):(x.childLanes=T.childLanes,x.lanes=T.lanes,x.child=T.child,x.subtreeFlags=0,x.deletions=null,x.memoizedProps=T.memoizedProps,x.memoizedState=T.memoizedState,x.updateQueue=T.updateQueue,x.type=T.type,e=T.dependencies,x.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return xi(Bi,Bi.current&1|2),r.child}e=e.sibling}x.tail!==null&&Ki()>yp&&(r.flags|=128,c=!0,xg(x,!1),r.lanes=4194304)}else{if(!c)if(e=e1(T),e!==null){if(r.flags|=128,c=!0,a=e.updateQueue,a!==null&&(r.updateQueue=a,r.flags|=4),xg(x,!0),x.tail===null&&x.tailMode==="hidden"&&!T.alternate&&!Ri)return oa(r),null}else 2*Ki()-x.renderingStartTime>yp&&a!==1073741824&&(r.flags|=128,c=!0,xg(x,!1),r.lanes=4194304);x.isBackwards?(T.sibling=r.child,r.child=T):(a=x.last,a!==null?a.sibling=T:r.child=T,x.last=T)}return x.tail!==null?(r=x.tail,x.rendering=r,x.tail=r.sibling,x.renderingStartTime=Ki(),r.sibling=null,a=Bi.current,xi(Bi,c?a&1|2:a&1),r):(oa(r),null);case 22:case 23:return sE(),c=r.memoizedState!==null,e!==null&&e.memoizedState!==null!==c&&(r.flags|=8192),c&&r.mode&1?Xa&1073741824&&(oa(r),r.subtreeFlags&6&&(r.flags|=8192)):oa(r),null;case 24:return null;case 25:return null}throw Error(rr(156,r.tag))}function kB(e,r){switch($3(r),r.tag){case 1:return za(r.type)&&qv(),e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 3:return gp(),Pi(Ra),Pi(sa),Y3(),e=r.flags,e&65536&&!(e&128)?(r.flags=e&-65537|128,r):null;case 5:return X3(r),null;case 13:if(Pi(Bi),e=r.memoizedState,e!==null&&e.dehydrated!==null){if(r.alternate===null)throw Error(rr(340));pp()}return e=r.flags,e&65536?(r.flags=e&-65537|128,r):null;case 19:return Pi(Bi),null;case 4:return gp(),null;case 10:return H3(r.type._context),null;case 22:case 23:return sE(),null;case 24:return null;default:return null}}var Qy=!1,aa=!1,DB=typeof WeakSet=="function"?WeakSet:Set,Ir=null;function Jf(e,r){var a=e.ref;if(a!==null)if(typeof a=="function")try{a(null)}catch(c){Vi(e,r,c)}else a.current=null}function dS(e,r,a){try{a()}catch(c){Vi(e,r,c)}}var LI=!1;function OB(e,r){if(X2=Uv,e=hR(),N3(e)){if("selectionStart"in e)var a={start:e.selectionStart,end:e.selectionEnd};else e:{a=(a=e.ownerDocument)&&a.defaultView||window;var c=a.getSelection&&a.getSelection();if(c&&c.rangeCount!==0){a=c.anchorNode;var d=c.anchorOffset,x=c.focusNode;c=c.focusOffset;try{a.nodeType,x.nodeType}catch{a=null;break e}var T=0,i=-1,L=-1,N=0,U=0,q=e,X=null;t:for(;;){for(var se;q!==a||d!==0&&q.nodeType!==3||(i=T+d),q!==x||c!==0&&q.nodeType!==3||(L=T+c),q.nodeType===3&&(T+=q.nodeValue.length),(se=q.firstChild)!==null;)X=q,q=se;for(;;){if(q===e)break t;if(X===a&&++N===d&&(i=T),X===x&&++U===c&&(L=T),(se=q.nextSibling)!==null)break;q=X,X=q.parentNode}q=se}a=i===-1||L===-1?null:{start:i,end:L}}else a=null}a=a||{start:0,end:0}}else a=null;for(Y2={focusedElem:e,selectionRange:a},Uv=!1,Ir=r;Ir!==null;)if(r=Ir,e=r.child,(r.subtreeFlags&1028)!==0&&e!==null)e.return=r,Ir=e;else for(;Ir!==null;){r=Ir;try{var ce=r.alternate;if(r.flags&1024)switch(r.tag){case 0:case 11:case 15:break;case 1:if(ce!==null){var ue=ce.memoizedProps,fe=ce.memoizedState,re=r.stateNode,ee=re.getSnapshotBeforeUpdate(r.elementType===r.type?ue:tl(r.type,ue),fe);re.__reactInternalSnapshotBeforeUpdate=ee}break;case 3:var ae=r.stateNode.containerInfo;ae.nodeType===1?ae.textContent="":ae.nodeType===9&&ae.documentElement&&ae.removeChild(ae.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(rr(163))}}catch(ve){Vi(r,r.return,ve)}if(e=r.sibling,e!==null){e.return=r.return,Ir=e;break}Ir=r.return}return ce=LI,LI=!1,ce}function Vg(e,r,a){var c=r.updateQueue;if(c=c!==null?c.lastEffect:null,c!==null){var d=c=c.next;do{if((d.tag&e)===e){var x=d.destroy;d.destroy=void 0,x!==void 0&&dS(r,a,x)}d=d.next}while(d!==c)}}function A1(e,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var a=r=r.next;do{if((a.tag&e)===e){var c=a.create;a.destroy=c()}a=a.next}while(a!==r)}}function fS(e){var r=e.ref;if(r!==null){var a=e.stateNode;switch(e.tag){case 5:e=a;break;default:e=a}typeof r=="function"?r(e):r.current=e}}function sz(e){var r=e.alternate;r!==null&&(e.alternate=null,sz(r)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(r=e.stateNode,r!==null&&(delete r[Bl],delete r[o_],delete r[Q2],delete r[yB],delete r[vB])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function lz(e){return e.tag===5||e.tag===3||e.tag===4}function kI(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||lz(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function pS(e,r,a){var c=e.tag;if(c===5||c===6)e=e.stateNode,r?a.nodeType===8?a.parentNode.insertBefore(e,r):a.insertBefore(e,r):(a.nodeType===8?(r=a.parentNode,r.insertBefore(e,a)):(r=a,r.appendChild(e)),a=a._reactRootContainer,a!=null||r.onclick!==null||(r.onclick=Wv));else if(c!==4&&(e=e.child,e!==null))for(pS(e,r,a),e=e.sibling;e!==null;)pS(e,r,a),e=e.sibling}function mS(e,r,a){var c=e.tag;if(c===5||c===6)e=e.stateNode,r?a.insertBefore(e,r):a.appendChild(e);else if(c!==4&&(e=e.child,e!==null))for(mS(e,r,a),e=e.sibling;e!==null;)mS(e,r,a),e=e.sibling}var $o=null,rl=!1;function gu(e,r,a){for(a=a.child;a!==null;)cz(e,r,a),a=a.sibling}function cz(e,r,a){if(Nl&&typeof Nl.onCommitFiberUnmount=="function")try{Nl.onCommitFiberUnmount(w1,a)}catch{}switch(a.tag){case 5:aa||Jf(a,r);case 6:var c=$o,d=rl;$o=null,gu(e,r,a),$o=c,rl=d,$o!==null&&(rl?(e=$o,a=a.stateNode,e.nodeType===8?e.parentNode.removeChild(a):e.removeChild(a)):$o.removeChild(a.stateNode));break;case 18:$o!==null&&(rl?(e=$o,a=a.stateNode,e.nodeType===8?Dw(e.parentNode,a):e.nodeType===1&&Dw(e,a),e_(e)):Dw($o,a.stateNode));break;case 4:c=$o,d=rl,$o=a.stateNode.containerInfo,rl=!0,gu(e,r,a),$o=c,rl=d;break;case 0:case 11:case 14:case 15:if(!aa&&(c=a.updateQueue,c!==null&&(c=c.lastEffect,c!==null))){d=c=c.next;do{var x=d,T=x.destroy;x=x.tag,T!==void 0&&(x&2||x&4)&&dS(a,r,T),d=d.next}while(d!==c)}gu(e,r,a);break;case 1:if(!aa&&(Jf(a,r),c=a.stateNode,typeof c.componentWillUnmount=="function"))try{c.props=a.memoizedProps,c.state=a.memoizedState,c.componentWillUnmount()}catch(i){Vi(a,r,i)}gu(e,r,a);break;case 21:gu(e,r,a);break;case 22:a.mode&1?(aa=(c=aa)||a.memoizedState!==null,gu(e,r,a),aa=c):gu(e,r,a);break;default:gu(e,r,a)}}function DI(e){var r=e.updateQueue;if(r!==null){e.updateQueue=null;var a=e.stateNode;a===null&&(a=e.stateNode=new DB),r.forEach(function(c){var d=HB.bind(null,e,c);a.has(c)||(a.add(c),c.then(d,d))})}}function Qs(e,r){var a=r.deletions;if(a!==null)for(var c=0;c<a.length;c++){var d=a[c];try{var x=e,T=r,i=T;e:for(;i!==null;){switch(i.tag){case 5:$o=i.stateNode,rl=!1;break e;case 3:$o=i.stateNode.containerInfo,rl=!0;break e;case 4:$o=i.stateNode.containerInfo,rl=!0;break e}i=i.return}if($o===null)throw Error(rr(160));cz(x,T,d),$o=null,rl=!1;var L=d.alternate;L!==null&&(L.return=null),d.return=null}catch(N){Vi(d,r,N)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)uz(r,e),r=r.sibling}function uz(e,r){var a=e.alternate,c=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Qs(r,e),kl(e),c&4){try{Vg(3,e,e.return),A1(3,e)}catch(ue){Vi(e,e.return,ue)}try{Vg(5,e,e.return)}catch(ue){Vi(e,e.return,ue)}}break;case 1:Qs(r,e),kl(e),c&512&&a!==null&&Jf(a,a.return);break;case 5:if(Qs(r,e),kl(e),c&512&&a!==null&&Jf(a,a.return),e.flags&32){var d=e.stateNode;try{Yg(d,"")}catch(ue){Vi(e,e.return,ue)}}if(c&4&&(d=e.stateNode,d!=null)){var x=e.memoizedProps,T=a!==null?a.memoizedProps:x,i=e.type,L=e.updateQueue;if(e.updateQueue=null,L!==null)try{i==="input"&&x.type==="radio"&&x.name!=null&&zA(d,x),N2(i,T);var N=N2(i,x);for(T=0;T<L.length;T+=2){var U=L[T],q=L[T+1];U==="style"?FA(d,q):U==="dangerouslySetInnerHTML"?DA(d,q):U==="children"?Yg(d,q):C3(d,U,q,N)}switch(i){case"input":k2(d,x);break;case"textarea":LA(d,x);break;case"select":var X=d._wrapperState.wasMultiple;d._wrapperState.wasMultiple=!!x.multiple;var se=x.value;se!=null?ip(d,!!x.multiple,se,!1):X!==!!x.multiple&&(x.defaultValue!=null?ip(d,!!x.multiple,x.defaultValue,!0):ip(d,!!x.multiple,x.multiple?[]:"",!1))}d[o_]=x}catch(ue){Vi(e,e.return,ue)}}break;case 6:if(Qs(r,e),kl(e),c&4){if(e.stateNode===null)throw Error(rr(162));d=e.stateNode,x=e.memoizedProps;try{d.nodeValue=x}catch(ue){Vi(e,e.return,ue)}}break;case 3:if(Qs(r,e),kl(e),c&4&&a!==null&&a.memoizedState.isDehydrated)try{e_(r.containerInfo)}catch(ue){Vi(e,e.return,ue)}break;case 4:Qs(r,e),kl(e);break;case 13:Qs(r,e),kl(e),d=e.child,d.flags&8192&&(x=d.memoizedState!==null,d.stateNode.isHidden=x,!x||d.alternate!==null&&d.alternate.memoizedState!==null||(oE=Ki())),c&4&&DI(e);break;case 22:if(U=a!==null&&a.memoizedState!==null,e.mode&1?(aa=(N=aa)||U,Qs(r,e),aa=N):Qs(r,e),kl(e),c&8192){if(N=e.memoizedState!==null,(e.stateNode.isHidden=N)&&!U&&e.mode&1)for(Ir=e,U=e.child;U!==null;){for(q=Ir=U;Ir!==null;){switch(X=Ir,se=X.child,X.tag){case 0:case 11:case 14:case 15:Vg(4,X,X.return);break;case 1:Jf(X,X.return);var ce=X.stateNode;if(typeof ce.componentWillUnmount=="function"){c=X,a=X.return;try{r=c,ce.props=r.memoizedProps,ce.state=r.memoizedState,ce.componentWillUnmount()}catch(ue){Vi(c,a,ue)}}break;case 5:Jf(X,X.return);break;case 22:if(X.memoizedState!==null){FI(q);continue}}se!==null?(se.return=X,Ir=se):FI(q)}U=U.sibling}e:for(U=null,q=e;;){if(q.tag===5){if(U===null){U=q;try{d=q.stateNode,N?(x=d.style,typeof x.setProperty=="function"?x.setProperty("display","none","important"):x.display="none"):(i=q.stateNode,L=q.memoizedProps.style,T=L!=null&&L.hasOwnProperty("display")?L.display:null,i.style.display=OA("display",T))}catch(ue){Vi(e,e.return,ue)}}}else if(q.tag===6){if(U===null)try{q.stateNode.nodeValue=N?"":q.memoizedProps}catch(ue){Vi(e,e.return,ue)}}else if((q.tag!==22&&q.tag!==23||q.memoizedState===null||q===e)&&q.child!==null){q.child.return=q,q=q.child;continue}if(q===e)break e;for(;q.sibling===null;){if(q.return===null||q.return===e)break e;U===q&&(U=null),q=q.return}U===q&&(U=null),q.sibling.return=q.return,q=q.sibling}}break;case 19:Qs(r,e),kl(e),c&4&&DI(e);break;case 21:break;default:Qs(r,e),kl(e)}}function kl(e){var r=e.flags;if(r&2){try{e:{for(var a=e.return;a!==null;){if(lz(a)){var c=a;break e}a=a.return}throw Error(rr(160))}switch(c.tag){case 5:var d=c.stateNode;c.flags&32&&(Yg(d,""),c.flags&=-33);var x=kI(e);mS(e,x,d);break;case 3:case 4:var T=c.stateNode.containerInfo,i=kI(e);pS(e,i,T);break;default:throw Error(rr(161))}}catch(L){Vi(e,e.return,L)}e.flags&=-3}r&4096&&(e.flags&=-4097)}function FB(e,r,a){Ir=e,hz(e)}function hz(e,r,a){for(var c=(e.mode&1)!==0;Ir!==null;){var d=Ir,x=d.child;if(d.tag===22&&c){var T=d.memoizedState!==null||Qy;if(!T){var i=d.alternate,L=i!==null&&i.memoizedState!==null||aa;i=Qy;var N=aa;if(Qy=T,(aa=L)&&!N)for(Ir=d;Ir!==null;)T=Ir,L=T.child,T.tag===22&&T.memoizedState!==null?BI(d):L!==null?(L.return=T,Ir=L):BI(d);for(;x!==null;)Ir=x,hz(x),x=x.sibling;Ir=d,Qy=i,aa=N}OI(e)}else d.subtreeFlags&8772&&x!==null?(x.return=d,Ir=x):OI(e)}}function OI(e){for(;Ir!==null;){var r=Ir;if(r.flags&8772){var a=r.alternate;try{if(r.flags&8772)switch(r.tag){case 0:case 11:case 15:aa||A1(5,r);break;case 1:var c=r.stateNode;if(r.flags&4&&!aa)if(a===null)c.componentDidMount();else{var d=r.elementType===r.type?a.memoizedProps:tl(r.type,a.memoizedProps);c.componentDidUpdate(d,a.memoizedState,c.__reactInternalSnapshotBeforeUpdate)}var x=r.updateQueue;x!==null&&xI(r,x,c);break;case 3:var T=r.updateQueue;if(T!==null){if(a=null,r.child!==null)switch(r.child.tag){case 5:a=r.child.stateNode;break;case 1:a=r.child.stateNode}xI(r,T,a)}break;case 5:var i=r.stateNode;if(a===null&&r.flags&4){a=i;var L=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":L.autoFocus&&a.focus();break;case"img":L.src&&(a.src=L.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var N=r.alternate;if(N!==null){var U=N.memoizedState;if(U!==null){var q=U.dehydrated;q!==null&&e_(q)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(rr(163))}aa||r.flags&512&&fS(r)}catch(X){Vi(r,r.return,X)}}if(r===e){Ir=null;break}if(a=r.sibling,a!==null){a.return=r.return,Ir=a;break}Ir=r.return}}function FI(e){for(;Ir!==null;){var r=Ir;if(r===e){Ir=null;break}var a=r.sibling;if(a!==null){a.return=r.return,Ir=a;break}Ir=r.return}}function BI(e){for(;Ir!==null;){var r=Ir;try{switch(r.tag){case 0:case 11:case 15:var a=r.return;try{A1(4,r)}catch(L){Vi(r,a,L)}break;case 1:var c=r.stateNode;if(typeof c.componentDidMount=="function"){var d=r.return;try{c.componentDidMount()}catch(L){Vi(r,d,L)}}var x=r.return;try{fS(r)}catch(L){Vi(r,x,L)}break;case 5:var T=r.return;try{fS(r)}catch(L){Vi(r,T,L)}}}catch(L){Vi(r,r.return,L)}if(r===e){Ir=null;break}var i=r.sibling;if(i!==null){i.return=r.return,Ir=i;break}Ir=r.return}}var BB=Math.ceil,n1=Ic.ReactCurrentDispatcher,nE=Ic.ReactCurrentOwner,ws=Ic.ReactCurrentBatchConfig,qn=0,Io=null,ao=null,Uo=0,Xa=0,Qf=Uu(0),yo=0,h_=null,ed=0,R1=0,iE=0,Ug=null,Pa=null,oE=0,yp=1/0,gc=null,i1=!1,gS=null,Ou=null,ev=!1,Tu=null,o1=0,Gg=0,_S=null,Cv=-1,Mv=0;function fa(){return qn&6?Ki():Cv!==-1?Cv:Cv=Ki()}function Fu(e){return e.mode&1?qn&2&&Uo!==0?Uo&-Uo:bB.transition!==null?(Mv===0&&(Mv=XA()),Mv):(e=ai,e!==0||(e=window.event,e=e===void 0?16:rR(e.type)),e):1}function ll(e,r,a,c){if(50<Gg)throw Gg=0,_S=null,Error(rr(185));z_(e,a,c),(!(qn&2)||e!==Io)&&(e===Io&&(!(qn&2)&&(R1|=a),yo===4&&Su(e,Uo)),La(e,c),a===1&&qn===0&&!(r.mode&1)&&(yp=Ki()+500,M1&&Gu()))}function La(e,r){var a=e.callbackNode;b8(e,r);var c=Vv(e,e===Io?Uo:0);if(c===0)a!==null&&qM(a),e.callbackNode=null,e.callbackPriority=0;else if(r=c&-c,e.callbackPriority!==r){if(a!=null&&qM(a),r===1)e.tag===0?xB(NI.bind(null,e)):bR(NI.bind(null,e)),gB(function(){!(qn&6)&&Gu()}),a=null;else{switch(YA(c)){case 1:a=R3;break;case 4:a=qA;break;case 16:a=$v;break;case 536870912:a=ZA;break;default:a=$v}a=vz(a,dz.bind(null,e))}e.callbackPriority=r,e.callbackNode=a}}function dz(e,r){if(Cv=-1,Mv=0,qn&6)throw Error(rr(327));var a=e.callbackNode;if(cp()&&e.callbackNode!==a)return null;var c=Vv(e,e===Io?Uo:0);if(c===0)return null;if(c&30||c&e.expiredLanes||r)r=a1(e,c);else{r=c;var d=qn;qn|=2;var x=pz();(Io!==e||Uo!==r)&&(gc=null,yp=Ki()+500,Wh(e,r));do try{$B();break}catch(i){fz(e,i)}while(1);G3(),n1.current=x,qn=d,ao!==null?r=0:(Io=null,Uo=0,r=yo)}if(r!==0){if(r===2&&(d=G2(e),d!==0&&(c=d,r=yS(e,d))),r===1)throw a=h_,Wh(e,0),Su(e,c),La(e,Ki()),a;if(r===6)Su(e,c);else{if(d=e.current.alternate,!(c&30)&&!NB(d)&&(r=a1(e,c),r===2&&(x=G2(e),x!==0&&(c=x,r=yS(e,x))),r===1))throw a=h_,Wh(e,0),Su(e,c),La(e,Ki()),a;switch(e.finishedWork=d,e.finishedLanes=c,r){case 0:case 1:throw Error(rr(345));case 2:Oh(e,Pa,gc);break;case 3:if(Su(e,c),(c&130023424)===c&&(r=oE+500-Ki(),10<r)){if(Vv(e,0)!==0)break;if(d=e.suspendedLanes,(d&c)!==c){fa(),e.pingedLanes|=e.suspendedLanes&d;break}e.timeoutHandle=J2(Oh.bind(null,e,Pa,gc),r);break}Oh(e,Pa,gc);break;case 4:if(Su(e,c),(c&4194240)===c)break;for(r=e.eventTimes,d=-1;0<c;){var T=31-sl(c);x=1<<T,T=r[T],T>d&&(d=T),c&=~x}if(c=d,c=Ki()-c,c=(120>c?120:480>c?480:1080>c?1080:1920>c?1920:3e3>c?3e3:4320>c?4320:1960*BB(c/1960))-c,10<c){e.timeoutHandle=J2(Oh.bind(null,e,Pa,gc),c);break}Oh(e,Pa,gc);break;case 5:Oh(e,Pa,gc);break;default:throw Error(rr(329))}}}return La(e,Ki()),e.callbackNode===a?dz.bind(null,e):null}function yS(e,r){var a=Ug;return e.current.memoizedState.isDehydrated&&(Wh(e,r).flags|=256),e=a1(e,r),e!==2&&(r=Pa,Pa=a,r!==null&&vS(r)),e}function vS(e){Pa===null?Pa=e:Pa.push.apply(Pa,e)}function NB(e){for(var r=e;;){if(r.flags&16384){var a=r.updateQueue;if(a!==null&&(a=a.stores,a!==null))for(var c=0;c<a.length;c++){var d=a[c],x=d.getSnapshot;d=d.value;try{if(!dl(x(),d))return!1}catch{return!1}}}if(a=r.child,r.subtreeFlags&16384&&a!==null)a.return=r,r=a;else{if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Su(e,r){for(r&=~iE,r&=~R1,e.suspendedLanes|=r,e.pingedLanes&=~r,e=e.expirationTimes;0<r;){var a=31-sl(r),c=1<<a;e[a]=-1,r&=~c}}function NI(e){if(qn&6)throw Error(rr(327));cp();var r=Vv(e,0);if(!(r&1))return La(e,Ki()),null;var a=a1(e,r);if(e.tag!==0&&a===2){var c=G2(e);c!==0&&(r=c,a=yS(e,c))}if(a===1)throw a=h_,Wh(e,0),Su(e,r),La(e,Ki()),a;if(a===6)throw Error(rr(345));return e.finishedWork=e.current.alternate,e.finishedLanes=r,Oh(e,Pa,gc),La(e,Ki()),null}function aE(e,r){var a=qn;qn|=1;try{return e(r)}finally{qn=a,qn===0&&(yp=Ki()+500,M1&&Gu())}}function td(e){Tu!==null&&Tu.tag===0&&!(qn&6)&&cp();var r=qn;qn|=1;var a=ws.transition,c=ai;try{if(ws.transition=null,ai=1,e)return e()}finally{ai=c,ws.transition=a,qn=r,!(qn&6)&&Gu()}}function sE(){Xa=Qf.current,Pi(Qf)}function Wh(e,r){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(a!==-1&&(e.timeoutHandle=-1,mB(a)),ao!==null)for(a=ao.return;a!==null;){var c=a;switch($3(c),c.tag){case 1:c=c.type.childContextTypes,c!=null&&qv();break;case 3:gp(),Pi(Ra),Pi(sa),Y3();break;case 5:X3(c);break;case 4:gp();break;case 13:Pi(Bi);break;case 19:Pi(Bi);break;case 10:H3(c.type._context);break;case 22:case 23:sE()}a=a.return}if(Io=e,ao=e=Bu(e.current,null),Uo=Xa=r,yo=0,h_=null,iE=R1=ed=0,Pa=Ug=null,$h!==null){for(r=0;r<$h.length;r++)if(a=$h[r],c=a.interleaved,c!==null){a.interleaved=null;var d=c.next,x=a.pending;if(x!==null){var T=x.next;x.next=d,c.next=T}a.pending=c}$h=null}return e}function fz(e,r){do{var a=ao;try{if(G3(),Sv.current=r1,t1){for(var c=Ni.memoizedState;c!==null;){var d=c.queue;d!==null&&(d.pending=null),c=c.next}t1=!1}if(Qh=0,Co=_o=Ni=null,$g=!1,l_=0,nE.current=null,a===null||a.return===null){yo=1,h_=r,ao=null;break}e:{var x=e,T=a.return,i=a,L=r;if(r=Uo,i.flags|=32768,L!==null&&typeof L=="object"&&typeof L.then=="function"){var N=L,U=i,q=U.tag;if(!(U.mode&1)&&(q===0||q===11||q===15)){var X=U.alternate;X?(U.updateQueue=X.updateQueue,U.memoizedState=X.memoizedState,U.lanes=X.lanes):(U.updateQueue=null,U.memoizedState=null)}var se=CI(T);if(se!==null){se.flags&=-257,MI(se,T,i,x,r),se.mode&1&&TI(x,N,r),r=se,L=N;var ce=r.updateQueue;if(ce===null){var ue=new Set;ue.add(L),r.updateQueue=ue}else ce.add(L);break e}else{if(!(r&1)){TI(x,N,r),lE();break e}L=Error(rr(426))}}else if(Ri&&i.mode&1){var fe=CI(T);if(fe!==null){!(fe.flags&65536)&&(fe.flags|=256),MI(fe,T,i,x,r),V3(_p(L,i));break e}}x=L=_p(L,i),yo!==4&&(yo=2),Ug===null?Ug=[x]:Ug.push(x),x=T;do{switch(x.tag){case 3:x.flags|=65536,r&=-r,x.lanes|=r;var re=YR(x,L,r);vI(x,re);break e;case 1:i=L;var ee=x.type,ae=x.stateNode;if(!(x.flags&128)&&(typeof ee.getDerivedStateFromError=="function"||ae!==null&&typeof ae.componentDidCatch=="function"&&(Ou===null||!Ou.has(ae)))){x.flags|=65536,r&=-r,x.lanes|=r;var ve=KR(x,i,r);vI(x,ve);break e}}x=x.return}while(x!==null)}gz(a)}catch(Te){r=Te,ao===a&&a!==null&&(ao=a=a.return);continue}break}while(1)}function pz(){var e=n1.current;return n1.current=r1,e===null?r1:e}function lE(){(yo===0||yo===3||yo===2)&&(yo=4),Io===null||!(ed&268435455)&&!(R1&268435455)||Su(Io,Uo)}function a1(e,r){var a=qn;qn|=2;var c=pz();(Io!==e||Uo!==r)&&(gc=null,Wh(e,r));do try{jB();break}catch(d){fz(e,d)}while(1);if(G3(),qn=a,n1.current=c,ao!==null)throw Error(rr(261));return Io=null,Uo=0,yo}function jB(){for(;ao!==null;)mz(ao)}function $B(){for(;ao!==null&&!d8();)mz(ao)}function mz(e){var r=yz(e.alternate,e,Xa);e.memoizedProps=e.pendingProps,r===null?gz(e):ao=r,nE.current=null}function gz(e){var r=e;do{var a=r.alternate;if(e=r.return,r.flags&32768){if(a=kB(a,r),a!==null){a.flags&=32767,ao=a;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{yo=6,ao=null;return}}else if(a=LB(a,r,Xa),a!==null){ao=a;return}if(r=r.sibling,r!==null){ao=r;return}ao=r=e}while(r!==null);yo===0&&(yo=5)}function Oh(e,r,a){var c=ai,d=ws.transition;try{ws.transition=null,ai=1,VB(e,r,a,c)}finally{ws.transition=d,ai=c}return null}function VB(e,r,a,c){do cp();while(Tu!==null);if(qn&6)throw Error(rr(327));a=e.finishedWork;var d=e.finishedLanes;if(a===null)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(rr(177));e.callbackNode=null,e.callbackPriority=0;var x=a.lanes|a.childLanes;if(w8(e,x),e===Io&&(ao=Io=null,Uo=0),!(a.subtreeFlags&2064)&&!(a.flags&2064)||ev||(ev=!0,vz($v,function(){return cp(),null})),x=(a.flags&15990)!==0,a.subtreeFlags&15990||x){x=ws.transition,ws.transition=null;var T=ai;ai=1;var i=qn;qn|=4,nE.current=null,OB(e,a),uz(a,e),lB(Y2),Uv=!!X2,Y2=X2=null,e.current=a,FB(a),f8(),qn=i,ai=T,ws.transition=x}else e.current=a;if(ev&&(ev=!1,Tu=e,o1=d),x=e.pendingLanes,x===0&&(Ou=null),g8(a.stateNode),La(e,Ki()),r!==null)for(c=e.onRecoverableError,a=0;a<r.length;a++)d=r[a],c(d.value,{componentStack:d.stack,digest:d.digest});if(i1)throw i1=!1,e=gS,gS=null,e;return o1&1&&e.tag!==0&&cp(),x=e.pendingLanes,x&1?e===_S?Gg++:(Gg=0,_S=e):Gg=0,Gu(),null}function cp(){if(Tu!==null){var e=YA(o1),r=ws.transition,a=ai;try{if(ws.transition=null,ai=16>e?16:e,Tu===null)var c=!1;else{if(e=Tu,Tu=null,o1=0,qn&6)throw Error(rr(331));var d=qn;for(qn|=4,Ir=e.current;Ir!==null;){var x=Ir,T=x.child;if(Ir.flags&16){var i=x.deletions;if(i!==null){for(var L=0;L<i.length;L++){var N=i[L];for(Ir=N;Ir!==null;){var U=Ir;switch(U.tag){case 0:case 11:case 15:Vg(8,U,x)}var q=U.child;if(q!==null)q.return=U,Ir=q;else for(;Ir!==null;){U=Ir;var X=U.sibling,se=U.return;if(sz(U),U===N){Ir=null;break}if(X!==null){X.return=se,Ir=X;break}Ir=se}}}var ce=x.alternate;if(ce!==null){var ue=ce.child;if(ue!==null){ce.child=null;do{var fe=ue.sibling;ue.sibling=null,ue=fe}while(ue!==null)}}Ir=x}}if(x.subtreeFlags&2064&&T!==null)T.return=x,Ir=T;else e:for(;Ir!==null;){if(x=Ir,x.flags&2048)switch(x.tag){case 0:case 11:case 15:Vg(9,x,x.return)}var re=x.sibling;if(re!==null){re.return=x.return,Ir=re;break e}Ir=x.return}}var ee=e.current;for(Ir=ee;Ir!==null;){T=Ir;var ae=T.child;if(T.subtreeFlags&2064&&ae!==null)ae.return=T,Ir=ae;else e:for(T=ee;Ir!==null;){if(i=Ir,i.flags&2048)try{switch(i.tag){case 0:case 11:case 15:A1(9,i)}}catch(Te){Vi(i,i.return,Te)}if(i===T){Ir=null;break e}var ve=i.sibling;if(ve!==null){ve.return=i.return,Ir=ve;break e}Ir=i.return}}if(qn=d,Gu(),Nl&&typeof Nl.onPostCommitFiberRoot=="function")try{Nl.onPostCommitFiberRoot(w1,e)}catch{}c=!0}return c}finally{ai=a,ws.transition=r}}return!1}function jI(e,r,a){r=_p(a,r),r=YR(e,r,1),e=Du(e,r,1),r=fa(),e!==null&&(z_(e,1,r),La(e,r))}function Vi(e,r,a){if(e.tag===3)jI(e,e,a);else for(;r!==null;){if(r.tag===3){jI(r,e,a);break}else if(r.tag===1){var c=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(Ou===null||!Ou.has(c))){e=_p(a,e),e=KR(r,e,1),r=Du(r,e,1),e=fa(),r!==null&&(z_(r,1,e),La(r,e));break}}r=r.return}}function UB(e,r,a){var c=e.pingCache;c!==null&&c.delete(r),r=fa(),e.pingedLanes|=e.suspendedLanes&a,Io===e&&(Uo&a)===a&&(yo===4||yo===3&&(Uo&130023424)===Uo&&500>Ki()-oE?Wh(e,0):iE|=a),La(e,r)}function _z(e,r){r===0&&(e.mode&1?(r=Gy,Gy<<=1,!(Gy&130023424)&&(Gy=4194304)):r=1);var a=fa();e=Tc(e,r),e!==null&&(z_(e,r,a),La(e,a))}function GB(e){var r=e.memoizedState,a=0;r!==null&&(a=r.retryLane),_z(e,a)}function HB(e,r){var a=0;switch(e.tag){case 13:var c=e.stateNode,d=e.memoizedState;d!==null&&(a=d.retryLane);break;case 19:c=e.stateNode;break;default:throw Error(rr(314))}c!==null&&c.delete(r),_z(e,a)}var yz;yz=function(e,r,a){if(e!==null)if(e.memoizedProps!==r.pendingProps||Ra.current)Aa=!0;else{if(!(e.lanes&a)&&!(r.flags&128))return Aa=!1,zB(e,r,a);Aa=!!(e.flags&131072)}else Aa=!1,Ri&&r.flags&1048576&&wR(r,Yv,r.index);switch(r.lanes=0,r.tag){case 2:var c=r.type;Tv(e,r),e=r.pendingProps;var d=fp(r,sa.current);lp(r,a),d=J3(null,r,c,e,d,a);var x=Q3();return r.flags|=1,typeof d=="object"&&d!==null&&typeof d.render=="function"&&d.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,za(c)?(x=!0,Zv(r)):x=!1,r.memoizedState=d.state!==null&&d.state!==void 0?d.state:null,q3(r),d.updater=P1,r.stateNode=d,d._reactInternals=r,oS(r,c,e,a),r=lS(null,r,c,!0,x,a)):(r.tag=0,Ri&&x&&j3(r),da(null,r,d,a),r=r.child),r;case 16:c=r.elementType;e:{switch(Tv(e,r),e=r.pendingProps,d=c._init,c=d(c._payload),r.type=c,d=r.tag=qB(c),e=tl(c,e),d){case 0:r=sS(null,r,c,e,a);break e;case 1:r=AI(null,r,c,e,a);break e;case 11:r=II(null,r,c,e,a);break e;case 14:r=PI(null,r,c,tl(c.type,e),a);break e}throw Error(rr(306,c,""))}return r;case 0:return c=r.type,d=r.pendingProps,d=r.elementType===c?d:tl(c,d),sS(e,r,c,d,a);case 1:return c=r.type,d=r.pendingProps,d=r.elementType===c?d:tl(c,d),AI(e,r,c,d,a);case 3:e:{if(tz(r),e===null)throw Error(rr(387));c=r.pendingProps,x=r.memoizedState,d=x.element,IR(e,r),Qv(r,c,null,a);var T=r.memoizedState;if(c=T.element,x.isDehydrated)if(x={element:c,isDehydrated:!1,cache:T.cache,pendingSuspenseBoundaries:T.pendingSuspenseBoundaries,transitions:T.transitions},r.updateQueue.baseState=x,r.memoizedState=x,r.flags&256){d=_p(Error(rr(423)),r),r=RI(e,r,c,a,d);break e}else if(c!==d){d=_p(Error(rr(424)),r),r=RI(e,r,c,a,d);break e}else for(Ja=ku(r.stateNode.containerInfo.firstChild),ts=r,Ri=!0,ol=null,a=CR(r,null,c,a),r.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling;else{if(pp(),c===d){r=Cc(e,r,a);break e}da(e,r,c,a)}r=r.child}return r;case 5:return PR(r),e===null&&rS(r),c=r.type,d=r.pendingProps,x=e!==null?e.memoizedProps:null,T=d.children,K2(c,d)?T=null:x!==null&&K2(c,x)&&(r.flags|=32),ez(e,r),da(e,r,T,a),r.child;case 6:return e===null&&rS(r),null;case 13:return rz(e,r,a);case 4:return Z3(r,r.stateNode.containerInfo),c=r.pendingProps,e===null?r.child=mp(r,null,c,a):da(e,r,c,a),r.child;case 11:return c=r.type,d=r.pendingProps,d=r.elementType===c?d:tl(c,d),II(e,r,c,d,a);case 7:return da(e,r,r.pendingProps,a),r.child;case 8:return da(e,r,r.pendingProps.children,a),r.child;case 12:return da(e,r,r.pendingProps.children,a),r.child;case 10:e:{if(c=r.type._context,d=r.pendingProps,x=r.memoizedProps,T=d.value,xi(Kv,c._currentValue),c._currentValue=T,x!==null)if(dl(x.value,T)){if(x.children===d.children&&!Ra.current){r=Cc(e,r,a);break e}}else for(x=r.child,x!==null&&(x.return=r);x!==null;){var i=x.dependencies;if(i!==null){T=x.child;for(var L=i.firstContext;L!==null;){if(L.context===c){if(x.tag===1){L=xc(-1,a&-a),L.tag=2;var N=x.updateQueue;if(N!==null){N=N.shared;var U=N.pending;U===null?L.next=L:(L.next=U.next,U.next=L),N.pending=L}}x.lanes|=a,L=x.alternate,L!==null&&(L.lanes|=a),nS(x.return,a,r),i.lanes|=a;break}L=L.next}}else if(x.tag===10)T=x.type===r.type?null:x.child;else if(x.tag===18){if(T=x.return,T===null)throw Error(rr(341));T.lanes|=a,i=T.alternate,i!==null&&(i.lanes|=a),nS(T,a,r),T=x.sibling}else T=x.child;if(T!==null)T.return=x;else for(T=x;T!==null;){if(T===r){T=null;break}if(x=T.sibling,x!==null){x.return=T.return,T=x;break}T=T.return}x=T}da(e,r,d.children,a),r=r.child}return r;case 9:return d=r.type,c=r.pendingProps.children,lp(r,a),d=Ss(d),c=c(d),r.flags|=1,da(e,r,c,a),r.child;case 14:return c=r.type,d=tl(c,r.pendingProps),d=tl(c.type,d),PI(e,r,c,d,a);case 15:return JR(e,r,r.type,r.pendingProps,a);case 17:return c=r.type,d=r.pendingProps,d=r.elementType===c?d:tl(c,d),Tv(e,r),r.tag=1,za(c)?(e=!0,Zv(r)):e=!1,lp(r,a),XR(r,c,d),oS(r,c,d,a),lS(null,r,c,!0,e,a);case 19:return nz(e,r,a);case 22:return QR(e,r,a)}throw Error(rr(156,r.tag))};function vz(e,r){return WA(e,r)}function WB(e,r,a,c){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xs(e,r,a,c){return new WB(e,r,a,c)}function cE(e){return e=e.prototype,!(!e||!e.isReactComponent)}function qB(e){if(typeof e=="function")return cE(e)?1:0;if(e!=null){if(e=e.$$typeof,e===I3)return 11;if(e===P3)return 14}return 2}function Bu(e,r){var a=e.alternate;return a===null?(a=xs(e.tag,r,e.key,e.mode),a.elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=r,a.type=e.type,a.flags=0,a.subtreeFlags=0,a.deletions=null),a.flags=e.flags&14680064,a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,r=e.dependencies,a.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function Iv(e,r,a,c,d,x){var T=2;if(c=e,typeof e=="function")cE(e)&&(T=1);else if(typeof e=="string")T=5;else e:switch(e){case Uf:return qh(a.children,d,x,r);case M3:T=8,d|=8;break;case P2:return e=xs(12,a,r,d|2),e.elementType=P2,e.lanes=x,e;case A2:return e=xs(13,a,r,d),e.elementType=A2,e.lanes=x,e;case R2:return e=xs(19,a,r,d),e.elementType=R2,e.lanes=x,e;case PA:return z1(a,d,x,r);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case MA:T=10;break e;case IA:T=9;break e;case I3:T=11;break e;case P3:T=14;break e;case xu:T=16,c=null;break e}throw Error(rr(130,e==null?e:typeof e,""))}return r=xs(T,a,r,d),r.elementType=e,r.type=c,r.lanes=x,r}function qh(e,r,a,c){return e=xs(7,e,c,r),e.lanes=a,e}function z1(e,r,a,c){return e=xs(22,e,c,r),e.elementType=PA,e.lanes=a,e.stateNode={isHidden:!1},e}function Uw(e,r,a){return e=xs(6,e,null,r),e.lanes=a,e}function Gw(e,r,a){return r=xs(4,e.children!==null?e.children:[],e.key,r),r.lanes=a,r.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},r}function ZB(e,r,a,c,d){this.tag=r,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ew(0),this.expirationTimes=Ew(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ew(0),this.identifierPrefix=c,this.onRecoverableError=d,this.mutableSourceEagerHydrationData=null}function uE(e,r,a,c,d,x,T,i,L){return e=new ZB(e,r,a,i,L),r===1?(r=1,x===!0&&(r|=8)):r=0,x=xs(3,null,null,r),e.current=x,x.stateNode=e,x.memoizedState={element:c,isDehydrated:a,cache:null,transitions:null,pendingSuspenseBoundaries:null},q3(x),e}function XB(e,r,a){var c=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Vf,key:c==null?null:""+c,children:e,containerInfo:r,implementation:a}}function xz(e){if(!e)return ju;e=e._reactInternals;e:{if(ld(e)!==e||e.tag!==1)throw Error(rr(170));var r=e;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(za(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(rr(171))}if(e.tag===1){var a=e.type;if(za(a))return xR(e,a,r)}return r}function bz(e,r,a,c,d,x,T,i,L){return e=uE(a,c,!0,e,d,x,T,i,L),e.context=xz(null),a=e.current,c=fa(),d=Fu(a),x=xc(c,d),x.callback=r??null,Du(a,x,d),e.current.lanes=d,z_(e,d,c),La(e,c),e}function L1(e,r,a,c){var d=r.current,x=fa(),T=Fu(d);return a=xz(a),r.context===null?r.context=a:r.pendingContext=a,r=xc(x,T),r.payload={element:e},c=c===void 0?null:c,c!==null&&(r.callback=c),e=Du(d,r,T),e!==null&&(ll(e,d,T,x),wv(e,d,T)),T}function s1(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function $I(e,r){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var a=e.retryLane;e.retryLane=a!==0&&a<r?a:r}}function hE(e,r){$I(e,r),(e=e.alternate)&&$I(e,r)}function YB(){return null}var wz=typeof reportError=="function"?reportError:function(e){console.error(e)};function dE(e){this._internalRoot=e}k1.prototype.render=dE.prototype.render=function(e){var r=this._internalRoot;if(r===null)throw Error(rr(409));L1(e,r,null,null)};k1.prototype.unmount=dE.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var r=e.containerInfo;td(function(){L1(null,e,null,null)}),r[Ec]=null}};function k1(e){this._internalRoot=e}k1.prototype.unstable_scheduleHydration=function(e){if(e){var r=QA();e={blockedOn:null,target:e,priority:r};for(var a=0;a<wu.length&&r!==0&&r<wu[a].priority;a++);wu.splice(a,0,e),a===0&&tR(e)}};function fE(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function D1(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function VI(){}function KB(e,r,a,c,d){if(d){if(typeof c=="function"){var x=c;c=function(){var N=s1(T);x.call(N)}}var T=bz(r,c,e,0,null,!1,!1,"",VI);return e._reactRootContainer=T,e[Ec]=T.current,n_(e.nodeType===8?e.parentNode:e),td(),T}for(;d=e.lastChild;)e.removeChild(d);if(typeof c=="function"){var i=c;c=function(){var N=s1(L);i.call(N)}}var L=uE(e,0,!1,null,null,!1,!1,"",VI);return e._reactRootContainer=L,e[Ec]=L.current,n_(e.nodeType===8?e.parentNode:e),td(function(){L1(r,L,a,c)}),L}function O1(e,r,a,c,d){var x=a._reactRootContainer;if(x){var T=x;if(typeof d=="function"){var i=d;d=function(){var L=s1(T);i.call(L)}}L1(r,T,e,d)}else T=KB(a,r,e,d,c);return s1(T)}KA=function(e){switch(e.tag){case 3:var r=e.stateNode;if(r.current.memoizedState.isDehydrated){var a=zg(r.pendingLanes);a!==0&&(z3(r,a|1),La(r,Ki()),!(qn&6)&&(yp=Ki()+500,Gu()))}break;case 13:td(function(){var c=Tc(e,1);if(c!==null){var d=fa();ll(c,e,1,d)}}),hE(e,1)}};L3=function(e){if(e.tag===13){var r=Tc(e,134217728);if(r!==null){var a=fa();ll(r,e,134217728,a)}hE(e,134217728)}};JA=function(e){if(e.tag===13){var r=Fu(e),a=Tc(e,r);if(a!==null){var c=fa();ll(a,e,r,c)}hE(e,r)}};QA=function(){return ai};eR=function(e,r){var a=ai;try{return ai=e,r()}finally{ai=a}};$2=function(e,r,a){switch(r){case"input":if(k2(e,a),r=a.name,a.type==="radio"&&r!=null){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<a.length;r++){var c=a[r];if(c!==e&&c.form===e.form){var d=C1(c);if(!d)throw Error(rr(90));RA(c),k2(c,d)}}}break;case"textarea":LA(e,a);break;case"select":r=a.value,r!=null&&ip(e,!!a.multiple,r,!1)}};jA=aE;$A=td;var JB={usingClientEntryPoint:!1,Events:[k_,qf,C1,BA,NA,aE]},bg={findFiberByHostInstance:jh,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},QB={bundleType:bg.bundleType,version:bg.version,rendererPackageName:bg.rendererPackageName,rendererConfig:bg.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ic.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=GA(e),e===null?null:e.stateNode},findFiberByHostInstance:bg.findFiberByHostInstance||YB,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tv=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tv.isDisabled&&tv.supportsFiber)try{w1=tv.inject(QB),Nl=tv}catch{}}os.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JB;os.createPortal=function(e,r){var a=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!fE(r))throw Error(rr(200));return XB(e,r,null,a)};os.createRoot=function(e,r){if(!fE(e))throw Error(rr(299));var a=!1,c="",d=wz;return r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(c=r.identifierPrefix),r.onRecoverableError!==void 0&&(d=r.onRecoverableError)),r=uE(e,1,!1,null,null,a,!1,c,d),e[Ec]=r.current,n_(e.nodeType===8?e.parentNode:e),new dE(r)};os.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var r=e._reactInternals;if(r===void 0)throw typeof e.render=="function"?Error(rr(188)):(e=Object.keys(e).join(","),Error(rr(268,e)));return e=GA(r),e=e===null?null:e.stateNode,e};os.flushSync=function(e){return td(e)};os.hydrate=function(e,r,a){if(!D1(r))throw Error(rr(200));return O1(null,e,r,!0,a)};os.hydrateRoot=function(e,r,a){if(!fE(e))throw Error(rr(405));var c=a!=null&&a.hydratedSources||null,d=!1,x="",T=wz;if(a!=null&&(a.unstable_strictMode===!0&&(d=!0),a.identifierPrefix!==void 0&&(x=a.identifierPrefix),a.onRecoverableError!==void 0&&(T=a.onRecoverableError)),r=bz(r,null,e,1,a??null,d,!1,x,T),e[Ec]=r.current,n_(e),c)for(e=0;e<c.length;e++)a=c[e],d=a._getVersion,d=d(a._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[a,d]:r.mutableSourceEagerHydrationData.push(a,d);return new k1(r)};os.render=function(e,r,a){if(!D1(r))throw Error(rr(200));return O1(null,e,r,!1,a)};os.unmountComponentAtNode=function(e){if(!D1(e))throw Error(rr(40));return e._reactRootContainer?(td(function(){O1(null,null,e,!1,function(){e._reactRootContainer=null,e[Ec]=null})}),!0):!1};os.unstable_batchedUpdates=aE;os.unstable_renderSubtreeIntoContainer=function(e,r,a,c){if(!D1(a))throw Error(rr(200));if(e==null||e._reactInternals===void 0)throw Error(rr(38));return O1(e,r,a,!1,c)};os.version="18.3.1-next-f1338f8080-20240426";function Sz(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Sz)}catch(e){console.error(e)}}Sz(),SA.exports=os;var F1=SA.exports;const xS=P_(F1),Ez=sA({__proto__:null,default:xS},[F1]);function d_(e){return e instanceof HTMLElement||e instanceof SVGElement}function Tz(e){return e&&ln(e)==="object"&&d_(e.nativeElement)?e.nativeElement:d_(e)?e:null}function Pv(e){var r=Tz(e);if(r)return r;if(e instanceof sn.Component){var a;return(a=xS.findDOMNode)===null||a===void 0?void 0:a.call(xS,e)}return null}var Cz={exports:{}},si={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pE=Symbol.for("react.element"),mE=Symbol.for("react.portal"),B1=Symbol.for("react.fragment"),N1=Symbol.for("react.strict_mode"),j1=Symbol.for("react.profiler"),$1=Symbol.for("react.provider"),V1=Symbol.for("react.context"),e7=Symbol.for("react.server_context"),U1=Symbol.for("react.forward_ref"),G1=Symbol.for("react.suspense"),H1=Symbol.for("react.suspense_list"),W1=Symbol.for("react.memo"),q1=Symbol.for("react.lazy"),t7=Symbol.for("react.offscreen"),Mz;Mz=Symbol.for("react.module.reference");function Cs(e){if(typeof e=="object"&&e!==null){var r=e.$$typeof;switch(r){case pE:switch(e=e.type,e){case B1:case j1:case N1:case G1:case H1:return e;default:switch(e=e&&e.$$typeof,e){case e7:case V1:case U1:case q1:case W1:case $1:return e;default:return r}}case mE:return r}}}si.ContextConsumer=V1;si.ContextProvider=$1;si.Element=pE;si.ForwardRef=U1;si.Fragment=B1;si.Lazy=q1;si.Memo=W1;si.Portal=mE;si.Profiler=j1;si.StrictMode=N1;si.Suspense=G1;si.SuspenseList=H1;si.isAsyncMode=function(){return!1};si.isConcurrentMode=function(){return!1};si.isContextConsumer=function(e){return Cs(e)===V1};si.isContextProvider=function(e){return Cs(e)===$1};si.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===pE};si.isForwardRef=function(e){return Cs(e)===U1};si.isFragment=function(e){return Cs(e)===B1};si.isLazy=function(e){return Cs(e)===q1};si.isMemo=function(e){return Cs(e)===W1};si.isPortal=function(e){return Cs(e)===mE};si.isProfiler=function(e){return Cs(e)===j1};si.isStrictMode=function(e){return Cs(e)===N1};si.isSuspense=function(e){return Cs(e)===G1};si.isSuspenseList=function(e){return Cs(e)===H1};si.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===B1||e===j1||e===N1||e===G1||e===H1||e===t7||typeof e=="object"&&e!==null&&(e.$$typeof===q1||e.$$typeof===W1||e.$$typeof===$1||e.$$typeof===V1||e.$$typeof===U1||e.$$typeof===Mz||e.getModuleId!==void 0)};si.typeOf=Cs;Cz.exports=si;var Hw=Cz.exports;function gE(e,r,a){var c=$.useRef({});return(!("value"in c.current)||a(c.current.condition,r))&&(c.current.value=e(),c.current.condition=r),c.current.value}var _E=function(r,a){typeof r=="function"?r(a):ln(r)==="object"&&r&&"current"in r&&(r.current=a)},cd=function(){for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];var d=a.filter(Boolean);return d.length<=1?d[0]:function(x){a.forEach(function(T){_E(T,x)})}},Z1=function(){for(var r=arguments.length,a=new Array(r),c=0;c<r;c++)a[c]=arguments[c];return gE(function(){return cd.apply(void 0,a)},a,function(d,x){return d.length!==x.length||d.every(function(T,i){return T!==x[i]})})},Ap=function(r){var a,c;if(!r)return!1;if(Iz(r)&&r.props.propertyIsEnumerable("ref"))return!0;var d=Hw.isMemo(r)?r.type.type:r.type;return!(typeof d=="function"&&!((a=d.prototype)!==null&&a!==void 0&&a.render)&&d.$$typeof!==Hw.ForwardRef||typeof r=="function"&&!((c=r.prototype)!==null&&c!==void 0&&c.render)&&r.$$typeof!==Hw.ForwardRef)};function Iz(e){return $.isValidElement(e)&&!xA(e)}var O_=function(r){if(r&&Iz(r)){var a=r;return a.props.propertyIsEnumerable("ref")?a.props.ref:a.ref}return null},bS=$.createContext(null);function r7(e){var r=e.children,a=e.onBatchResize,c=$.useRef(0),d=$.useRef([]),x=$.useContext(bS),T=$.useCallback(function(i,L,N){c.current+=1;var U=c.current;d.current.push({size:i,element:L,data:N}),Promise.resolve().then(function(){U===c.current&&(a==null||a(d.current),d.current=[])}),x==null||x(i,L,N)},[a,x]);return $.createElement(bS.Provider,{value:T},r)}var Pz=function(){if(typeof Map<"u")return Map;function e(r,a){var c=-1;return r.some(function(d,x){return d[0]===a?(c=x,!0):!1}),c}return function(){function r(){this.__entries__=[]}return Object.defineProperty(r.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),r.prototype.get=function(a){var c=e(this.__entries__,a),d=this.__entries__[c];return d&&d[1]},r.prototype.set=function(a,c){var d=e(this.__entries__,a);~d?this.__entries__[d][1]=c:this.__entries__.push([a,c])},r.prototype.delete=function(a){var c=this.__entries__,d=e(c,a);~d&&c.splice(d,1)},r.prototype.has=function(a){return!!~e(this.__entries__,a)},r.prototype.clear=function(){this.__entries__.splice(0)},r.prototype.forEach=function(a,c){c===void 0&&(c=null);for(var d=0,x=this.__entries__;d<x.length;d++){var T=x[d];a.call(c,T[1],T[0])}},r}()}(),wS=typeof window<"u"&&typeof document<"u"&&window.document===document,l1=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),n7=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(l1):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),i7=2;function o7(e,r){var a=!1,c=!1,d=0;function x(){a&&(a=!1,e()),c&&i()}function T(){n7(x)}function i(){var L=Date.now();if(a){if(L-d<i7)return;c=!0}else a=!0,c=!1,setTimeout(T,r);d=L}return i}var a7=20,s7=["top","right","bottom","left","width","height","size","weight"],l7=typeof MutationObserver<"u",c7=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=o7(this.refresh.bind(this),a7)}return e.prototype.addObserver=function(r){~this.observers_.indexOf(r)||this.observers_.push(r),this.connected_||this.connect_()},e.prototype.removeObserver=function(r){var a=this.observers_,c=a.indexOf(r);~c&&a.splice(c,1),!a.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var r=this.updateObservers_();r&&this.refresh()},e.prototype.updateObservers_=function(){var r=this.observers_.filter(function(a){return a.gatherActive(),a.hasActive()});return r.forEach(function(a){return a.broadcastActive()}),r.length>0},e.prototype.connect_=function(){!wS||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),l7?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!wS||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(r){var a=r.propertyName,c=a===void 0?"":a,d=s7.some(function(x){return!!~c.indexOf(x)});d&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),Az=function(e,r){for(var a=0,c=Object.keys(r);a<c.length;a++){var d=c[a];Object.defineProperty(e,d,{value:r[d],enumerable:!1,writable:!1,configurable:!0})}return e},vp=function(e){var r=e&&e.ownerDocument&&e.ownerDocument.defaultView;return r||l1},Rz=X1(0,0,0,0);function c1(e){return parseFloat(e)||0}function UI(e){for(var r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];return r.reduce(function(c,d){var x=e["border-"+d+"-width"];return c+c1(x)},0)}function u7(e){for(var r=["top","right","bottom","left"],a={},c=0,d=r;c<d.length;c++){var x=d[c],T=e["padding-"+x];a[x]=c1(T)}return a}function h7(e){var r=e.getBBox();return X1(0,0,r.width,r.height)}function d7(e){var r=e.clientWidth,a=e.clientHeight;if(!r&&!a)return Rz;var c=vp(e).getComputedStyle(e),d=u7(c),x=d.left+d.right,T=d.top+d.bottom,i=c1(c.width),L=c1(c.height);if(c.boxSizing==="border-box"&&(Math.round(i+x)!==r&&(i-=UI(c,"left","right")+x),Math.round(L+T)!==a&&(L-=UI(c,"top","bottom")+T)),!p7(e)){var N=Math.round(i+x)-r,U=Math.round(L+T)-a;Math.abs(N)!==1&&(i-=N),Math.abs(U)!==1&&(L-=U)}return X1(d.left,d.top,i,L)}var f7=function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof vp(e).SVGGraphicsElement}:function(e){return e instanceof vp(e).SVGElement&&typeof e.getBBox=="function"}}();function p7(e){return e===vp(e).document.documentElement}function m7(e){return wS?f7(e)?h7(e):d7(e):Rz}function g7(e){var r=e.x,a=e.y,c=e.width,d=e.height,x=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,T=Object.create(x.prototype);return Az(T,{x:r,y:a,width:c,height:d,top:a,right:r+c,bottom:d+a,left:r}),T}function X1(e,r,a,c){return{x:e,y:r,width:a,height:c}}var _7=function(){function e(r){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=X1(0,0,0,0),this.target=r}return e.prototype.isActive=function(){var r=m7(this.target);return this.contentRect_=r,r.width!==this.broadcastWidth||r.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var r=this.contentRect_;return this.broadcastWidth=r.width,this.broadcastHeight=r.height,r},e}(),y7=function(){function e(r,a){var c=g7(a);Az(this,{target:r,contentRect:c})}return e}(),v7=function(){function e(r,a,c){if(this.activeObservations_=[],this.observations_=new Pz,typeof r!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=r,this.controller_=a,this.callbackCtx_=c}return e.prototype.observe=function(r){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(r instanceof vp(r).Element))throw new TypeError('parameter 1 is not of type "Element".');var a=this.observations_;a.has(r)||(a.set(r,new _7(r)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(r){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(r instanceof vp(r).Element))throw new TypeError('parameter 1 is not of type "Element".');var a=this.observations_;a.has(r)&&(a.delete(r),a.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var r=this;this.clearActive(),this.observations_.forEach(function(a){a.isActive()&&r.activeObservations_.push(a)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var r=this.callbackCtx_,a=this.activeObservations_.map(function(c){return new y7(c.target,c.broadcastRect())});this.callback_.call(r,a,r),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),zz=typeof WeakMap<"u"?new WeakMap:new Pz,Lz=function(){function e(r){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var a=c7.getInstance(),c=new v7(r,a,this);zz.set(this,c)}return e}();["observe","unobserve","disconnect"].forEach(function(e){Lz.prototype[e]=function(){var r;return(r=zz.get(this))[e].apply(r,arguments)}});var x7=function(){return typeof l1.ResizeObserver<"u"?l1.ResizeObserver:Lz}(),Cu=new Map;function b7(e){e.forEach(function(r){var a,c=r.target;(a=Cu.get(c))===null||a===void 0||a.forEach(function(d){return d(c)})})}var kz=new x7(b7);function w7(e,r){Cu.has(e)||(Cu.set(e,new Set),kz.observe(e)),Cu.get(e).add(r)}function S7(e,r){Cu.has(e)&&(Cu.get(e).delete(r),Cu.get(e).size||(kz.unobserve(e),Cu.delete(e)))}function Ao(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function GI(e,r){for(var a=0;a<r.length;a++){var c=r[a];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,wA(c.key),c)}}function Ro(e,r,a){return r&&GI(e.prototype,r),a&&GI(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function f_(e,r){return f_=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,c){return a.__proto__=c,a},f_(e,r)}function Hu(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),r&&f_(e,r)}function p_(e){return p_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},p_(e)}function yE(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(yE=function(){return!!e})()}function Sn(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E7(e,r){if(r&&(ln(r)=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Sn(e)}function Wu(e){var r=yE();return function(){var a,c=p_(e);if(r){var d=p_(this).constructor;a=Reflect.construct(c,arguments,d)}else a=c.apply(this,arguments);return E7(this,a)}}var T7=function(e){Hu(a,e);var r=Wu(a);function a(){return Ao(this,a),r.apply(this,arguments)}return Ro(a,[{key:"render",value:function(){return this.props.children}}]),a}($.Component);function C7(e,r){var a=e.children,c=e.disabled,d=$.useRef(null),x=$.useRef(null),T=$.useContext(bS),i=typeof a=="function",L=i?a(d):a,N=$.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),U=!i&&$.isValidElement(L)&&Ap(L),q=U?O_(L):null,X=Z1(q,d),se=function(){var re;return Pv(d.current)||(d.current&&ln(d.current)==="object"?Pv((re=d.current)===null||re===void 0?void 0:re.nativeElement):null)||Pv(x.current)};$.useImperativeHandle(r,function(){return se()});var ce=$.useRef(e);ce.current=e;var ue=$.useCallback(function(fe){var re=ce.current,ee=re.onResize,ae=re.data,ve=fe.getBoundingClientRect(),Te=ve.width,pe=ve.height,Ee=fe.offsetWidth,Ne=fe.offsetHeight,Xe=Math.floor(Te),Fe=Math.floor(pe);if(N.current.width!==Xe||N.current.height!==Fe||N.current.offsetWidth!==Ee||N.current.offsetHeight!==Ne){var Je={width:Xe,height:Fe,offsetWidth:Ee,offsetHeight:Ne};N.current=Je;var Ct=Ee===Math.round(Te)?Te:Ee,ft=Ne===Math.round(pe)?pe:Ne,yt=Ft(Ft({},Je),{},{offsetWidth:Ct,offsetHeight:ft});T==null||T(yt,fe,ae),ee&&Promise.resolve().then(function(){ee(yt,fe)})}},[]);return $.useEffect(function(){var fe=se();return fe&&!c&&w7(fe,ue),function(){return S7(fe,ue)}},[d.current,c]),$.createElement(T7,{ref:x},U?$.cloneElement(L,{ref:X}):L)}var M7=$.forwardRef(C7),I7="rc-observer-key";function P7(e,r){var a=e.children,c=typeof a=="function"?[a]:Yh(a);return c.map(function(d,x){var T=(d==null?void 0:d.key)||"".concat(I7,"-").concat(x);return $.createElement(M7,Po({},e,{key:T,ref:x===0?r:void 0}),d)})}var vE=$.forwardRef(P7);vE.Collection=r7;function ud(e,r){var a=Object.assign({},e);return Array.isArray(r)&&r.forEach(function(c){delete a[c]}),a}function SS(e,r){(r==null||r>e.length)&&(r=e.length);for(var a=0,c=Array(r);a<r;a++)c[a]=e[a];return c}function A7(e){if(Array.isArray(e))return SS(e)}function Dz(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function xE(e,r){if(e){if(typeof e=="string")return SS(e,r);var a={}.toString.call(e).slice(8,-1);return a==="Object"&&e.constructor&&(a=e.constructor.name),a==="Map"||a==="Set"?Array.from(e):a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?SS(e,r):void 0}}function R7(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zr(e){return A7(e)||Dz(e)||xE(e)||R7()}var Oz=function(r){return+setTimeout(r,16)},Fz=function(r){return clearTimeout(r)};typeof window<"u"&&"requestAnimationFrame"in window&&(Oz=function(r){return window.requestAnimationFrame(r)},Fz=function(r){return window.cancelAnimationFrame(r)});var HI=0,bE=new Map;function Bz(e){bE.delete(e)}var fl=function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;HI+=1;var c=HI;function d(x){if(x===0)Bz(c),r();else{var T=Oz(function(){d(x-1)});bE.set(c,T)}}return d(a),c};fl.cancel=function(e){var r=bE.get(e);return Bz(e),Fz(r)};function Nz(e){if(Array.isArray(e))return e}function z7(e,r){var a=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(a!=null){var c,d,x,T,i=[],L=!0,N=!1;try{if(x=(a=a.call(e)).next,r===0){if(Object(a)!==a)return;L=!1}else for(;!(L=(c=x.call(a)).done)&&(i.push(c.value),i.length!==r);L=!0);}catch(U){N=!0,d=U}finally{try{if(!L&&a.return!=null&&(T=a.return(),Object(T)!==T))return}finally{if(N)throw d}}return i}}function jz(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sr(e,r){return Nz(e)||z7(e,r)||xE(e,r)||jz()}function m_(e){for(var r=0,a,c=0,d=e.length;d>=4;++c,d-=4)a=e.charCodeAt(c)&255|(e.charCodeAt(++c)&255)<<8|(e.charCodeAt(++c)&255)<<16|(e.charCodeAt(++c)&255)<<24,a=(a&65535)*1540483477+((a>>>16)*59797<<16),a^=a>>>24,r=(a&65535)*1540483477+((a>>>16)*59797<<16)^(r&65535)*1540483477+((r>>>16)*59797<<16);switch(d){case 3:r^=(e.charCodeAt(c+2)&255)<<16;case 2:r^=(e.charCodeAt(c+1)&255)<<8;case 1:r^=e.charCodeAt(c)&255,r=(r&65535)*1540483477+((r>>>16)*59797<<16)}return r^=r>>>13,r=(r&65535)*1540483477+((r>>>16)*59797<<16),((r^r>>>15)>>>0).toString(36)}function ns(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function L7(e,r){if(!e)return!1;if(e.contains)return e.contains(r);for(var a=r;a;){if(a===e)return!0;a=a.parentNode}return!1}var WI="data-rc-order",qI="data-rc-priority",k7="rc-util-key",ES=new Map;function $z(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=e.mark;return r?r.startsWith("data-")?r:"data-".concat(r):k7}function Y1(e){if(e.attachTo)return e.attachTo;var r=document.querySelector("head");return r||document.body}function D7(e){return e==="queue"?"prependQueue":e?"prepend":"append"}function wE(e){return Array.from((ES.get(e)||e).children).filter(function(r){return r.tagName==="STYLE"})}function Vz(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!ns())return null;var a=r.csp,c=r.prepend,d=r.priority,x=d===void 0?0:d,T=D7(c),i=T==="prependQueue",L=document.createElement("style");L.setAttribute(WI,T),i&&x&&L.setAttribute(qI,"".concat(x)),a!=null&&a.nonce&&(L.nonce=a==null?void 0:a.nonce),L.innerHTML=e;var N=Y1(r),U=N.firstChild;if(c){if(i){var q=(r.styles||wE(N)).filter(function(X){if(!["prepend","prependQueue"].includes(X.getAttribute(WI)))return!1;var se=Number(X.getAttribute(qI)||0);return x>=se});if(q.length)return N.insertBefore(L,q[q.length-1].nextSibling),L}N.insertBefore(L,U)}else N.appendChild(L);return L}function Uz(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=Y1(r);return(r.styles||wE(a)).find(function(c){return c.getAttribute($z(r))===e})}function g_(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=Uz(e,r);if(a){var c=Y1(r);c.removeChild(a)}}function O7(e,r){var a=ES.get(e);if(!a||!L7(document,a)){var c=Vz("",r),d=c.parentNode;ES.set(e,d),e.removeChild(c)}}function bc(e,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},c=Y1(a),d=wE(c),x=Ft(Ft({},a),{},{styles:d});O7(c,x);var T=Uz(r,x);if(T){var i,L;if((i=x.csp)!==null&&i!==void 0&&i.nonce&&T.nonce!==((L=x.csp)===null||L===void 0?void 0:L.nonce)){var N;T.nonce=(N=x.csp)===null||N===void 0?void 0:N.nonce}return T.innerHTML!==e&&(T.innerHTML=e),T}var U=Vz(e,x);return U.setAttribute($z(x),r),U}function F7(e,r){if(e==null)return{};var a={};for(var c in e)if({}.hasOwnProperty.call(e,c)){if(r.includes(c))continue;a[c]=e[c]}return a}function is(e,r){if(e==null)return{};var a,c,d=F7(e,r);if(Object.getOwnPropertySymbols){var x=Object.getOwnPropertySymbols(e);for(c=0;c<x.length;c++)a=x[c],r.includes(a)||{}.propertyIsEnumerable.call(e,a)&&(d[a]=e[a])}return d}function TS(e,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,c=new Set;function d(x,T){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,L=c.has(x);if(es(!L,"Warning: There may be circular references"),L)return!1;if(x===T)return!0;if(a&&i>1)return!1;c.add(x);var N=i+1;if(Array.isArray(x)){if(!Array.isArray(T)||x.length!==T.length)return!1;for(var U=0;U<x.length;U++)if(!d(x[U],T[U],N))return!1;return!0}if(x&&T&&ln(x)==="object"&&ln(T)==="object"){var q=Object.keys(x);return q.length!==Object.keys(T).length?!1:q.every(function(X){return d(x[X],T[X],N)})}return!1}return d(e,r)}var B7="%";function CS(e){return e.join(B7)}var N7=function(){function e(r){Ao(this,e),Et(this,"instanceId",void 0),Et(this,"cache",new Map),this.instanceId=r}return Ro(e,[{key:"get",value:function(a){return this.opGet(CS(a))}},{key:"opGet",value:function(a){return this.cache.get(a)||null}},{key:"update",value:function(a,c){return this.opUpdate(CS(a),c)}},{key:"opUpdate",value:function(a,c){var d=this.cache.get(a),x=c(d);x===null?this.cache.delete(a):this.cache.set(a,x)}}]),e}(),xp="data-token-hash",cl="data-css-hash",Mu="__cssinjs_instance__";function j7(){var e=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){var r=document.body.querySelectorAll("style[".concat(cl,"]"))||[],a=document.head.firstChild;Array.from(r).forEach(function(d){d[Mu]=d[Mu]||e,d[Mu]===e&&document.head.insertBefore(d,a)});var c={};Array.from(document.querySelectorAll("style[".concat(cl,"]"))).forEach(function(d){var x=d.getAttribute(cl);if(c[x]){if(d[Mu]===e){var T;(T=d.parentNode)===null||T===void 0||T.removeChild(d)}}else c[x]=!0})}return new N7(e)}var K1=$.createContext({hashPriority:"low",cache:j7(),defaultCache:!0});function $7(e,r){if(e.length!==r.length)return!1;for(var a=0;a<e.length;a++)if(e[a]!==r[a])return!1;return!0}var SE=function(){function e(){Ao(this,e),Et(this,"cache",void 0),Et(this,"keys",void 0),Et(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return Ro(e,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(a){var c,d,x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,T={map:this.cache};return a.forEach(function(i){if(!T)T=void 0;else{var L;T=(L=T)===null||L===void 0||(L=L.map)===null||L===void 0?void 0:L.get(i)}}),(c=T)!==null&&c!==void 0&&c.value&&x&&(T.value[1]=this.cacheCallTimes++),(d=T)===null||d===void 0?void 0:d.value}},{key:"get",value:function(a){var c;return(c=this.internalGet(a,!0))===null||c===void 0?void 0:c[0]}},{key:"has",value:function(a){return!!this.internalGet(a)}},{key:"set",value:function(a,c){var d=this;if(!this.has(a)){if(this.size()+1>e.MAX_CACHE_SIZE+e.MAX_CACHE_OFFSET){var x=this.keys.reduce(function(N,U){var q=Sr(N,2),X=q[1];return d.internalGet(U)[1]<X?[U,d.internalGet(U)[1]]:N},[this.keys[0],this.cacheCallTimes]),T=Sr(x,1),i=T[0];this.delete(i)}this.keys.push(a)}var L=this.cache;a.forEach(function(N,U){if(U===a.length-1)L.set(N,{value:[c,d.cacheCallTimes++]});else{var q=L.get(N);q?q.map||(q.map=new Map):L.set(N,{map:new Map}),L=L.get(N).map}})}},{key:"deleteByPath",value:function(a,c){var d=a.get(c[0]);if(c.length===1){var x;return d.map?a.set(c[0],{map:d.map}):a.delete(c[0]),(x=d.value)===null||x===void 0?void 0:x[0]}var T=this.deleteByPath(d.map,c.slice(1));return(!d.map||d.map.size===0)&&!d.value&&a.delete(c[0]),T}},{key:"delete",value:function(a){if(this.has(a))return this.keys=this.keys.filter(function(c){return!$7(c,a)}),this.deleteByPath(this.cache,a)}}]),e}();Et(SE,"MAX_CACHE_SIZE",20);Et(SE,"MAX_CACHE_OFFSET",5);var ZI=0,Gz=function(){function e(r){Ao(this,e),Et(this,"derivatives",void 0),Et(this,"id",void 0),this.derivatives=Array.isArray(r)?r:[r],this.id=ZI,r.length===0&&(r.length>0,void 0),ZI+=1}return Ro(e,[{key:"getDerivativeToken",value:function(a){return this.derivatives.reduce(function(c,d){return d(a,c)},void 0)}}]),e}(),Ww=new SE;function __(e){var r=Array.isArray(e)?e:[e];return Ww.has(r)||Ww.set(r,new Gz(r)),Ww.get(r)}var V7=new WeakMap,qw={};function U7(e,r){for(var a=V7,c=0;c<r.length;c+=1){var d=r[c];a.has(d)||a.set(d,new WeakMap),a=a.get(d)}return a.has(qw)||a.set(qw,e()),a.get(qw)}var XI=new WeakMap;function Hg(e){var r=XI.get(e)||"";return r||(Object.keys(e).forEach(function(a){var c=e[a];r+=a,c instanceof Gz?r+=c.id:c&&ln(c)==="object"?r+=Hg(c):r+=c}),r=m_(r),XI.set(e,r)),r}function YI(e,r){return m_("".concat(r,"_").concat(Hg(e)))}var MS=ns();function fn(e){return typeof e=="number"?"".concat(e,"px"):e}function u1(e,r,a){var c,d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},x=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(x)return e;var T=Ft(Ft({},d),{},(c={},Et(c,xp,r),Et(c,cl,a),c)),i=Object.keys(T).map(function(L){var N=T[L];return N?"".concat(L,'="').concat(N,'"'):null}).filter(function(L){return L}).join(" ");return"<style ".concat(i,">").concat(e,"</style>")}var Av=function(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return"--".concat(a?"".concat(a,"-"):"").concat(r).replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z]+)([A-Z][a-z0-9]+)/g,"$1-$2").replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase()},G7=function(r,a,c){return Object.keys(r).length?".".concat(a).concat(c!=null&&c.scope?".".concat(c.scope):"","{").concat(Object.entries(r).map(function(d){var x=Sr(d,2),T=x[0],i=x[1];return"".concat(T,":").concat(i,";")}).join(""),"}"):""},Hz=function(r,a,c){var d={},x={};return Object.entries(r).forEach(function(T){var i,L,N=Sr(T,2),U=N[0],q=N[1];if(c!=null&&(i=c.preserve)!==null&&i!==void 0&&i[U])x[U]=q;else if((typeof q=="string"||typeof q=="number")&&!(c!=null&&(L=c.ignore)!==null&&L!==void 0&&L[U])){var X,se=Av(U,c==null?void 0:c.prefix);d[se]=typeof q=="number"&&!(c!=null&&(X=c.unitless)!==null&&X!==void 0&&X[U])?"".concat(q,"px"):String(q),x[U]="var(".concat(se,")")}}),[x,G7(d,a,{scope:c==null?void 0:c.scope})]},KI=ns()?$.useLayoutEffect:$.useEffect,Mo=function(r,a){var c=$.useRef(!0);KI(function(){return r(c.current)},a),KI(function(){return c.current=!1,function(){c.current=!0}},[])},JI=function(r,a){Mo(function(c){if(!c)return r()},a)},H7=Ft({},R_),QI=H7.useInsertionEffect,W7=function(r,a,c){$.useMemo(r,c),Mo(function(){return a(!0)},c)},q7=QI?function(e,r,a){return QI(function(){return e(),r()},a)}:W7,Z7=Ft({},R_),X7=Z7.useInsertionEffect,Y7=function(r){var a=[],c=!1;function d(x){c||a.push(x)}return $.useEffect(function(){return c=!1,function(){c=!0,a.length&&a.forEach(function(x){return x()})}},r),d},K7=function(){return function(r){r()}},J7=typeof X7<"u"?Y7:K7;function EE(e,r,a,c,d){var x=$.useContext(K1),T=x.cache,i=[e].concat(zr(r)),L=CS(i),N=J7([L]),U=function(ce){T.opUpdate(L,function(ue){var fe=ue||[void 0,void 0],re=Sr(fe,2),ee=re[0],ae=ee===void 0?0:ee,ve=re[1],Te=ve,pe=Te||a(),Ee=[ae,pe];return ce?ce(Ee):Ee})};$.useMemo(function(){U()},[L]);var q=T.opGet(L),X=q[1];return q7(function(){d==null||d(X)},function(se){return U(function(ce){var ue=Sr(ce,2),fe=ue[0],re=ue[1];return se&&fe===0&&(d==null||d(X)),[fe+1,re]}),function(){T.opUpdate(L,function(ce){var ue=ce||[],fe=Sr(ue,2),re=fe[0],ee=re===void 0?0:re,ae=fe[1],ve=ee-1;return ve===0?(N(function(){(se||!T.opGet(L))&&(c==null||c(ae,!1))}),null):[ee-1,ae]})}},[L]),X}var Q7={},eN="css",Fh=new Map;function tN(e){Fh.set(e,(Fh.get(e)||0)+1)}function rN(e,r){if(typeof document<"u"){var a=document.querySelectorAll("style[".concat(xp,'="').concat(e,'"]'));a.forEach(function(c){if(c[Mu]===r){var d;(d=c.parentNode)===null||d===void 0||d.removeChild(c)}})}}var nN=0;function iN(e,r){Fh.set(e,(Fh.get(e)||0)-1);var a=Array.from(Fh.keys()),c=a.filter(function(d){var x=Fh.get(d)||0;return x<=0});a.length-c.length>nN&&c.forEach(function(d){rN(d,r),Fh.delete(d)})}var Wz=function(r,a,c,d){var x=c.getDerivativeToken(r),T=Ft(Ft({},x),a);return d&&(T=d(T)),T},qz="token";function oN(e,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},c=$.useContext(K1),d=c.cache.instanceId,x=c.container,T=a.salt,i=T===void 0?"":T,L=a.override,N=L===void 0?Q7:L,U=a.formatToken,q=a.getComputedToken,X=a.cssVar,se=U7(function(){return Object.assign.apply(Object,[{}].concat(zr(r)))},r),ce=Hg(se),ue=Hg(N),fe=X?Hg(X):"",re=EE(qz,[i,e.id,ce,ue,fe],function(){var ee,ae=q?q(se,N,e):Wz(se,N,e,U),ve=Ft({},ae),Te="";if(X){var pe=Hz(ae,X.key,{prefix:X.prefix,ignore:X.ignore,unitless:X.unitless,preserve:X.preserve}),Ee=Sr(pe,2);ae=Ee[0],Te=Ee[1]}var Ne=YI(ae,i);ae._tokenKey=Ne,ve._tokenKey=YI(ve,i);var Xe=(ee=X==null?void 0:X.key)!==null&&ee!==void 0?ee:Ne;ae._themeKey=Xe,tN(Xe);var Fe="".concat(eN,"-").concat(m_(Ne));return ae._hashId=Fe,[ae,Fe,ve,Te,(X==null?void 0:X.key)||""]},function(ee){iN(ee[0]._themeKey,d)},function(ee){var ae=Sr(ee,4),ve=ae[0],Te=ae[3];if(X&&Te){var pe=bc(Te,m_("css-variables-".concat(ve._themeKey)),{mark:cl,prepend:"queue",attachTo:x,priority:-999});pe[Mu]=d,pe.setAttribute(xp,ve._themeKey)}});return re}var aN=function(r,a,c){var d=Sr(r,5),x=d[2],T=d[3],i=d[4],L=c||{},N=L.plain;if(!T)return null;var U=x._tokenKey,q=-999,X={"data-rc-order":"prependQueue","data-rc-priority":"".concat(q)},se=u1(T,i,U,X,N);return[q,U,se]},sN={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Zz="comm",Xz="rule",Yz="decl",lN="@import",cN="@keyframes",uN="@layer",Kz=Math.abs,TE=String.fromCharCode;function Jz(e){return e.trim()}function Rv(e,r,a){return e.replace(r,a)}function hN(e,r,a){return e.indexOf(r,a)}function y_(e,r){return e.charCodeAt(r)|0}function bp(e,r,a){return e.slice(r,a)}function Fl(e){return e.length}function dN(e){return e.length}function rv(e,r){return r.push(e),e}var J1=1,wp=1,Qz=0,Ts=0,oo=0,Rp="";function CE(e,r,a,c,d,x,T,i){return{value:e,root:r,parent:a,type:c,props:d,children:x,line:J1,column:wp,length:T,return:"",siblings:i}}function fN(){return oo}function pN(){return oo=Ts>0?y_(Rp,--Ts):0,wp--,oo===10&&(wp=1,J1--),oo}function ul(){return oo=Ts<Qz?y_(Rp,Ts++):0,wp++,oo===10&&(wp=1,J1++),oo}function Iu(){return y_(Rp,Ts)}function zv(){return Ts}function Q1(e,r){return bp(Rp,e,r)}function v_(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function mN(e){return J1=wp=1,Qz=Fl(Rp=e),Ts=0,[]}function gN(e){return Rp="",e}function Zw(e){return Jz(Q1(Ts-1,IS(e===91?e+2:e===40?e+1:e)))}function _N(e){for(;(oo=Iu())&&oo<33;)ul();return v_(e)>2||v_(oo)>3?"":" "}function yN(e,r){for(;--r&&ul()&&!(oo<48||oo>102||oo>57&&oo<65||oo>70&&oo<97););return Q1(e,zv()+(r<6&&Iu()==32&&ul()==32))}function IS(e){for(;ul();)switch(oo){case e:return Ts;case 34:case 39:e!==34&&e!==39&&IS(oo);break;case 40:e===41&&IS(e);break;case 92:ul();break}return Ts}function vN(e,r){for(;ul()&&e+oo!==47+10;)if(e+oo===42+42&&Iu()===47)break;return"/*"+Q1(r,Ts-1)+"*"+TE(e===47?e:ul())}function xN(e){for(;!v_(Iu());)ul();return Q1(e,Ts)}function bN(e){return gN(Lv("",null,null,null,[""],e=mN(e),0,[0],e))}function Lv(e,r,a,c,d,x,T,i,L){for(var N=0,U=0,q=T,X=0,se=0,ce=0,ue=1,fe=1,re=1,ee=0,ae="",ve=d,Te=x,pe=c,Ee=ae;fe;)switch(ce=ee,ee=ul()){case 40:if(ce!=108&&y_(Ee,q-1)==58){hN(Ee+=Rv(Zw(ee),"&","&\f"),"&\f",Kz(N?i[N-1]:0))!=-1&&(re=-1);break}case 34:case 39:case 91:Ee+=Zw(ee);break;case 9:case 10:case 13:case 32:Ee+=_N(ce);break;case 92:Ee+=yN(zv()-1,7);continue;case 47:switch(Iu()){case 42:case 47:rv(wN(vN(ul(),zv()),r,a,L),L),(v_(ce||1)==5||v_(Iu()||1)==5)&&Fl(Ee)&&bp(Ee,-1,void 0)!==" "&&(Ee+=" ");break;default:Ee+="/"}break;case 123*ue:i[N++]=Fl(Ee)*re;case 125*ue:case 59:case 0:switch(ee){case 0:case 125:fe=0;case 59+U:re==-1&&(Ee=Rv(Ee,/\f/g,"")),se>0&&(Fl(Ee)-q||ue===0&&ce===47)&&rv(se>32?t5(Ee+";",c,a,q-1,L):t5(Rv(Ee," ","")+";",c,a,q-2,L),L);break;case 59:Ee+=";";default:if(rv(pe=e5(Ee,r,a,N,U,d,i,ae,ve=[],Te=[],q,x),x),ee===123)if(U===0)Lv(Ee,r,pe,pe,ve,x,q,i,Te);else switch(X===99&&y_(Ee,3)===110?100:X){case 100:case 108:case 109:case 115:Lv(e,pe,pe,c&&rv(e5(e,pe,pe,0,0,d,i,ae,d,ve=[],q,Te),Te),d,Te,q,i,c?ve:Te);break;default:Lv(Ee,pe,pe,pe,[""],Te,0,i,Te)}}N=U=se=0,ue=re=1,ae=Ee="",q=T;break;case 58:q=1+Fl(Ee),se=ce;default:if(ue<1){if(ee==123)--ue;else if(ee==125&&ue++==0&&pN()==125)continue}switch(Ee+=TE(ee),ee*ue){case 38:re=U>0?1:(Ee+="\f",-1);break;case 44:i[N++]=(Fl(Ee)-1)*re,re=1;break;case 64:Iu()===45&&(Ee+=Zw(ul())),X=Iu(),U=q=Fl(ae=Ee+=xN(zv())),ee++;break;case 45:ce===45&&Fl(Ee)==2&&(ue=0)}}return x}function e5(e,r,a,c,d,x,T,i,L,N,U,q){for(var X=d-1,se=d===0?x:[""],ce=dN(se),ue=0,fe=0,re=0;ue<c;++ue)for(var ee=0,ae=bp(e,X+1,X=Kz(fe=T[ue])),ve=e;ee<ce;++ee)(ve=Jz(fe>0?se[ee]+" "+ae:Rv(ae,/&\f/g,se[ee])))&&(L[re++]=ve);return CE(e,r,a,d===0?Xz:i,L,N,U,q)}function wN(e,r,a,c){return CE(e,r,a,Zz,TE(fN()),bp(e,2,-2),0,c)}function t5(e,r,a,c,d){return CE(e,r,a,Yz,bp(e,0,c),bp(e,c+1,-1),c,d)}function PS(e,r){for(var a="",c=0;c<e.length;c++)a+=r(e[c],c,e,r)||"";return a}function SN(e,r,a,c){switch(e.type){case uN:if(e.children.length)break;case lN:case Yz:return e.return=e.return||e.value;case Zz:return"";case cN:return e.return=e.value+"{"+PS(e.children,c)+"}";case Xz:if(!Fl(e.value=e.props.join(",")))return""}return Fl(a=PS(e.children,c))?e.return=e.value+"{"+a+"}":""}var r5="data-ant-cssinjs-cache-path",eL="_FILE_STYLE__",Zh,tL=!0;function EN(){if(!Zh&&(Zh={},ns())){var e=document.createElement("div");e.className=r5,e.style.position="fixed",e.style.visibility="hidden",e.style.top="-9999px",document.body.appendChild(e);var r=getComputedStyle(e).content||"";r=r.replace(/^"/,"").replace(/"$/,""),r.split(";").forEach(function(d){var x=d.split(":"),T=Sr(x,2),i=T[0],L=T[1];Zh[i]=L});var a=document.querySelector("style[".concat(r5,"]"));if(a){var c;tL=!1,(c=a.parentNode)===null||c===void 0||c.removeChild(a)}document.body.removeChild(e)}}function TN(e){return EN(),!!Zh[e]}function CN(e){var r=Zh[e],a=null;if(r&&ns())if(tL)a=eL;else{var c=document.querySelector("style[".concat(cl,'="').concat(Zh[e],'"]'));c?a=c.innerHTML:delete Zh[e]}return[a,r]}var MN="_skip_check_",rL="_multi_value_";function kv(e){var r=PS(bN(e),SN);return r.replace(/\{%%%\:[^;];}/g,";")}function IN(e){return ln(e)==="object"&&e&&(MN in e||rL in e)}function n5(e,r,a){if(!r)return e;var c=".".concat(r),d=a==="low"?":where(".concat(c,")"):c,x=e.split(",").map(function(T){var i,L=T.trim().split(/\s+/),N=L[0]||"",U=((i=N.match(/^\w+/))===null||i===void 0?void 0:i[0])||"";return N="".concat(U).concat(d).concat(N.slice(U.length)),[N].concat(zr(L.slice(1))).join(" ")});return x.join(",")}var PN=function e(r){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},c=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]},d=c.root,x=c.injectHash,T=c.parentSelectors,i=a.hashId,L=a.layer;a.path;var N=a.hashPriority,U=a.transformers,q=U===void 0?[]:U;a.linters;var X="",se={};function ce(re){var ee=re.getName(i);if(!se[ee]){var ae=e(re.style,a,{root:!1,parentSelectors:T}),ve=Sr(ae,1),Te=ve[0];se[ee]="@keyframes ".concat(re.getName(i)).concat(Te)}}function ue(re){var ee=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return re.forEach(function(ae){Array.isArray(ae)?ue(ae,ee):ae&&ee.push(ae)}),ee}var fe=ue(Array.isArray(r)?r:[r]);return fe.forEach(function(re){var ee=typeof re=="string"&&!d?{}:re;if(typeof ee=="string")X+="".concat(ee,`
`);else if(ee._keyframe)ce(ee);else{var ae=q.reduce(function(ve,Te){var pe;return(Te==null||(pe=Te.visit)===null||pe===void 0?void 0:pe.call(Te,ve))||ve},ee);Object.keys(ae).forEach(function(ve){var Te=ae[ve];if(ln(Te)==="object"&&Te&&(ve!=="animationName"||!Te._keyframe)&&!IN(Te)){var pe=!1,Ee=ve.trim(),Ne=!1;(d||x)&&i?Ee.startsWith("@")?pe=!0:Ee==="&"?Ee=n5("",i,N):Ee=n5(ve,i,N):d&&!i&&(Ee==="&"||Ee==="")&&(Ee="",Ne=!0);var Xe=e(Te,a,{root:Ne,injectHash:pe,parentSelectors:[].concat(zr(T),[Ee])}),Fe=Sr(Xe,2),Je=Fe[0],Ct=Fe[1];se=Ft(Ft({},se),Ct),X+="".concat(Ee).concat(Je)}else{let ct=function(Ye,Ke){var tt=Ye.replace(/[A-Z]/g,function(vt){return"-".concat(vt.toLowerCase())}),ht=Ke;!sN[Ye]&&typeof ht=="number"&&ht!==0&&(ht="".concat(ht,"px")),Ye==="animationName"&&Ke!==null&&Ke!==void 0&&Ke._keyframe&&(ce(Ke),ht=Ke.getName(i)),X+="".concat(tt,":").concat(ht,";")};var lt=ct,ft,yt=(ft=Te==null?void 0:Te.value)!==null&&ft!==void 0?ft:Te;ln(Te)==="object"&&Te!==null&&Te!==void 0&&Te[rL]&&Array.isArray(yt)?yt.forEach(function(Ye){ct(ve,Ye)}):ct(ve,yt)}})}}),d?L&&(X&&(X="@layer ".concat(L.name," {").concat(X,"}")),L.dependencies&&(se["@layer ".concat(L.name)]=L.dependencies.map(function(re){return"@layer ".concat(re,", ").concat(L.name,";")}).join(`
`))):X="{".concat(X,"}"),[X,se]};function nL(e,r){return m_("".concat(e.join("%")).concat(r))}function AN(){return null}var iL="style";function AS(e,r){var a=e.token,c=e.path,d=e.hashId,x=e.layer,T=e.nonce,i=e.clientOnly,L=e.order,N=L===void 0?0:L,U=$.useContext(K1),q=U.autoClear;U.mock;var X=U.defaultCache,se=U.hashPriority,ce=U.container,ue=U.ssrInline,fe=U.transformers,re=U.linters,ee=U.cache,ae=U.layer,ve=a._tokenKey,Te=[ve];ae&&Te.push("layer"),Te.push.apply(Te,zr(c));var pe=MS,Ee=EE(iL,Te,function(){var Ct=Te.join("|");if(TN(Ct)){var ft=CN(Ct),yt=Sr(ft,2),lt=yt[0],ct=yt[1];if(lt)return[lt,ve,ct,{},i,N]}var Ye=r(),Ke=PN(Ye,{hashId:d,hashPriority:se,layer:ae?x:void 0,path:c.join("-"),transformers:fe,linters:re}),tt=Sr(Ke,2),ht=tt[0],vt=tt[1],At=kv(ht),Pt=nL(Te,At);return[At,ve,Pt,vt,i,N]},function(Ct,ft){var yt=Sr(Ct,3),lt=yt[2];(ft||q)&&MS&&g_(lt,{mark:cl})},function(Ct){var ft=Sr(Ct,4),yt=ft[0];ft[1];var lt=ft[2],ct=ft[3];if(pe&&yt!==eL){var Ye={mark:cl,prepend:ae?!1:"queue",attachTo:ce,priority:N},Ke=typeof T=="function"?T():T;Ke&&(Ye.csp={nonce:Ke});var tt=[],ht=[];Object.keys(ct).forEach(function(At){At.startsWith("@layer")?tt.push(At):ht.push(At)}),tt.forEach(function(At){bc(kv(ct[At]),"_layer-".concat(At),Ft(Ft({},Ye),{},{prepend:!0}))});var vt=bc(yt,lt,Ye);vt[Mu]=ee.instanceId,vt.setAttribute(xp,ve),ht.forEach(function(At){bc(kv(ct[At]),"_effect-".concat(At),Ye)})}}),Ne=Sr(Ee,3),Xe=Ne[0],Fe=Ne[1],Je=Ne[2];return function(Ct){var ft;if(!ue||pe||!X)ft=$.createElement(AN,null);else{var yt;ft=$.createElement("style",Po({},(yt={},Et(yt,xp,Fe),Et(yt,cl,Je),yt),{dangerouslySetInnerHTML:{__html:Xe}}))}return $.createElement($.Fragment,null,ft,Ct)}}var RN=function(r,a,c){var d=Sr(r,6),x=d[0],T=d[1],i=d[2],L=d[3],N=d[4],U=d[5],q=c||{},X=q.plain;if(N)return null;var se=x,ce={"data-rc-order":"prependQueue","data-rc-priority":"".concat(U)};return se=u1(x,T,i,ce,X),L&&Object.keys(L).forEach(function(ue){if(!a[ue]){a[ue]=!0;var fe=kv(L[ue]),re=u1(fe,T,"_effect-".concat(ue),ce,X);ue.startsWith("@layer")?se=re+se:se+=re}}),[U,i,se]},oL="cssVar",zN=function(r,a){var c=r.key,d=r.prefix,x=r.unitless,T=r.ignore,i=r.token,L=r.scope,N=L===void 0?"":L,U=$.useContext(K1),q=U.cache.instanceId,X=U.container,se=i._tokenKey,ce=[].concat(zr(r.path),[c,N,se]),ue=EE(oL,ce,function(){var fe=a(),re=Hz(fe,c,{prefix:d,unitless:x,ignore:T,scope:N}),ee=Sr(re,2),ae=ee[0],ve=ee[1],Te=nL(ce,ve);return[ae,ve,Te,c]},function(fe){var re=Sr(fe,3),ee=re[2];MS&&g_(ee,{mark:cl})},function(fe){var re=Sr(fe,3),ee=re[1],ae=re[2];if(ee){var ve=bc(ee,ae,{mark:cl,prepend:"queue",attachTo:X,priority:-999});ve[Mu]=q,ve.setAttribute(xp,c)}});return ue},LN=function(r,a,c){var d=Sr(r,4),x=d[1],T=d[2],i=d[3],L=c||{},N=L.plain;if(!x)return null;var U=-999,q={"data-rc-order":"prependQueue","data-rc-priority":"".concat(U)},X=u1(x,i,T,q,N);return[U,T,X]},wg;wg={},Et(wg,iL,RN),Et(wg,qz,aN),Et(wg,oL,LN);var _a=function(){function e(r,a){Ao(this,e),Et(this,"name",void 0),Et(this,"style",void 0),Et(this,"_keyframe",!0),this.name=r,this.style=a}return Ro(e,[{key:"getName",value:function(){var a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return a?"".concat(a,"-").concat(this.name):this.name}}]),e}();function zf(e){return e.notSplit=!0,e}zf(["borderTop","borderBottom"]),zf(["borderTop"]),zf(["borderBottom"]),zf(["borderLeft","borderRight"]),zf(["borderLeft"]),zf(["borderRight"]);var kN=$.createContext({});const ME=kN;function DN(e){return Nz(e)||Dz(e)||xE(e)||jz()}function bs(e,r){for(var a=e,c=0;c<r.length;c+=1){if(a==null)return;a=a[r[c]]}return a}function aL(e,r,a,c){if(!r.length)return a;var d=DN(r),x=d[0],T=d.slice(1),i;return!e&&typeof x=="number"?i=[]:Array.isArray(e)?i=zr(e):i=Ft({},e),c&&a===void 0&&T.length===1?delete i[x][T[0]]:i[x]=aL(i[x],T,a,c),i}function _s(e,r,a){var c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return r.length&&c&&a===void 0&&!bs(e,r.slice(0,-1))?e:aL(e,r,a,c)}function ON(e){return ln(e)==="object"&&e!==null&&Object.getPrototypeOf(e)===Object.prototype}function i5(e){return Array.isArray(e)?[]:{}}var FN=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function ep(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];var c=i5(r[0]);return r.forEach(function(d){function x(T,i){var L=new Set(i),N=bs(d,T),U=Array.isArray(N);if(U||ON(N)){if(!L.has(N)){L.add(N);var q=bs(c,T);U?c=_s(c,T,[]):(!q||ln(q)!=="object")&&(c=_s(c,T,i5(N))),FN(N).forEach(function(X){x([].concat(zr(T),[X]),L)})}}else c=_s(c,T,N)}x([])}),c}function BN(){}const NN=$.createContext({}),IE=()=>{const e=()=>{};return e.deprecated=BN,e},sL=$.createContext(void 0);var jN={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"},$N={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0},VN=Ft(Ft({},$N),{},{locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",dateFormat:"M/D/YYYY",dateTimeFormat:"M/D/YYYY HH:mm:ss",previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"});const UN={placeholder:"Select time",rangePlaceholder:["Start time","End time"]},lL=UN,GN={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},VN),timePickerLocale:Object.assign({},lL)},o5=GN,Ha="${label} is not a valid ${type}",HN={locale:"en",Pagination:jN,DatePicker:o5,TimePicker:lL,Calendar:o5,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",deselectAll:"Deselect all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand",collapse:"Collapse"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:Ha,method:Ha,array:Ha,object:Ha,number:Ha,date:Ha,boolean:Ha,integer:Ha,float:Ha,regexp:Ha,email:Ha,url:Ha,hex:Ha},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh",scanned:"Scanned"},ColorPicker:{presetEmpty:"Empty",transparent:"Transparent",singleColor:"Single",gradientColor:"Gradient"}},rd=HN;Object.assign({},rd.Modal);let Dv=[];const a5=()=>Dv.reduce((e,r)=>Object.assign(Object.assign({},e),r),rd.Modal);function WN(e){if(e){const r=Object.assign({},e);return Dv.push(r),a5(),()=>{Dv=Dv.filter(a=>a!==r),a5()}}Object.assign({},rd.Modal)}const qN=$.createContext(void 0),PE=qN,ZN=(e,r)=>{const a=$.useContext(PE),c=$.useMemo(()=>{var x;const T=r||rd[e],i=(x=a==null?void 0:a[e])!==null&&x!==void 0?x:{};return Object.assign(Object.assign({},typeof T=="function"?T():T),i||{})},[e,r,a]),d=$.useMemo(()=>{const x=a==null?void 0:a.locale;return a!=null&&a.exist&&!x?rd.locale:x},[a]);return[c,d]},XN=ZN,YN="internalMark",KN=e=>{const{locale:r={},children:a,_ANT_MARK__:c}=e;$.useEffect(()=>WN(r==null?void 0:r.Modal),[r]);const d=$.useMemo(()=>Object.assign(Object.assign({},r),{exist:!0}),[r]);return $.createElement(PE.Provider,{value:d},a)},JN=KN;function Go(e,r){QN(e)&&(e="100%");var a=e9(e);return e=r===360?e:Math.min(r,Math.max(0,parseFloat(e))),a&&(e=parseInt(String(e*r),10)/100),Math.abs(e-r)<1e-6?1:(r===360?e=(e<0?e%r+r:e%r)/parseFloat(String(r)):e=e%r/parseFloat(String(r)),e)}function nv(e){return Math.min(1,Math.max(0,e))}function QN(e){return typeof e=="string"&&e.indexOf(".")!==-1&&parseFloat(e)===1}function e9(e){return typeof e=="string"&&e.indexOf("%")!==-1}function cL(e){return e=parseFloat(e),(isNaN(e)||e<0||e>1)&&(e=1),e}function iv(e){return e<=1?"".concat(Number(e)*100,"%"):e}function Uh(e){return e.length===1?"0"+e:String(e)}function t9(e,r,a){return{r:Go(e,255)*255,g:Go(r,255)*255,b:Go(a,255)*255}}function s5(e,r,a){e=Go(e,255),r=Go(r,255),a=Go(a,255);var c=Math.max(e,r,a),d=Math.min(e,r,a),x=0,T=0,i=(c+d)/2;if(c===d)T=0,x=0;else{var L=c-d;switch(T=i>.5?L/(2-c-d):L/(c+d),c){case e:x=(r-a)/L+(r<a?6:0);break;case r:x=(a-e)/L+2;break;case a:x=(e-r)/L+4;break}x/=6}return{h:x,s:T,l:i}}function Xw(e,r,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?e+(r-e)*(6*a):a<1/2?r:a<2/3?e+(r-e)*(2/3-a)*6:e}function r9(e,r,a){var c,d,x;if(e=Go(e,360),r=Go(r,100),a=Go(a,100),r===0)d=a,x=a,c=a;else{var T=a<.5?a*(1+r):a+r-a*r,i=2*a-T;c=Xw(i,T,e+1/3),d=Xw(i,T,e),x=Xw(i,T,e-1/3)}return{r:c*255,g:d*255,b:x*255}}function RS(e,r,a){e=Go(e,255),r=Go(r,255),a=Go(a,255);var c=Math.max(e,r,a),d=Math.min(e,r,a),x=0,T=c,i=c-d,L=c===0?0:i/c;if(c===d)x=0;else{switch(c){case e:x=(r-a)/i+(r<a?6:0);break;case r:x=(a-e)/i+2;break;case a:x=(e-r)/i+4;break}x/=6}return{h:x,s:L,v:T}}function n9(e,r,a){e=Go(e,360)*6,r=Go(r,100),a=Go(a,100);var c=Math.floor(e),d=e-c,x=a*(1-r),T=a*(1-d*r),i=a*(1-(1-d)*r),L=c%6,N=[a,T,x,x,i,a][L],U=[i,a,a,T,x,x][L],q=[x,x,i,a,a,T][L];return{r:N*255,g:U*255,b:q*255}}function zS(e,r,a,c){var d=[Uh(Math.round(e).toString(16)),Uh(Math.round(r).toString(16)),Uh(Math.round(a).toString(16))];return c&&d[0].startsWith(d[0].charAt(1))&&d[1].startsWith(d[1].charAt(1))&&d[2].startsWith(d[2].charAt(1))?d[0].charAt(0)+d[1].charAt(0)+d[2].charAt(0):d.join("")}function i9(e,r,a,c,d){var x=[Uh(Math.round(e).toString(16)),Uh(Math.round(r).toString(16)),Uh(Math.round(a).toString(16)),Uh(o9(c))];return d&&x[0].startsWith(x[0].charAt(1))&&x[1].startsWith(x[1].charAt(1))&&x[2].startsWith(x[2].charAt(1))&&x[3].startsWith(x[3].charAt(1))?x[0].charAt(0)+x[1].charAt(0)+x[2].charAt(0)+x[3].charAt(0):x.join("")}function o9(e){return Math.round(parseFloat(e)*255).toString(16)}function l5(e){return Za(e)/255}function Za(e){return parseInt(e,16)}function a9(e){return{r:e>>16,g:(e&65280)>>8,b:e&255}}var LS={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function $f(e){var r={r:0,g:0,b:0},a=1,c=null,d=null,x=null,T=!1,i=!1;return typeof e=="string"&&(e=c9(e)),typeof e=="object"&&(mc(e.r)&&mc(e.g)&&mc(e.b)?(r=t9(e.r,e.g,e.b),T=!0,i=String(e.r).substr(-1)==="%"?"prgb":"rgb"):mc(e.h)&&mc(e.s)&&mc(e.v)?(c=iv(e.s),d=iv(e.v),r=n9(e.h,c,d),T=!0,i="hsv"):mc(e.h)&&mc(e.s)&&mc(e.l)&&(c=iv(e.s),x=iv(e.l),r=r9(e.h,c,x),T=!0,i="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(a=e.a)),a=cL(a),{ok:T,format:e.format||i,r:Math.min(255,Math.max(r.r,0)),g:Math.min(255,Math.max(r.g,0)),b:Math.min(255,Math.max(r.b,0)),a}}var s9="[-\\+]?\\d+%?",l9="[-\\+]?\\d*\\.\\d+%?",Pu="(?:".concat(l9,")|(?:").concat(s9,")"),Yw="[\\s|\\(]+(".concat(Pu,")[,|\\s]+(").concat(Pu,")[,|\\s]+(").concat(Pu,")\\s*\\)?"),Kw="[\\s|\\(]+(".concat(Pu,")[,|\\s]+(").concat(Pu,")[,|\\s]+(").concat(Pu,")[,|\\s]+(").concat(Pu,")\\s*\\)?"),el={CSS_UNIT:new RegExp(Pu),rgb:new RegExp("rgb"+Yw),rgba:new RegExp("rgba"+Kw),hsl:new RegExp("hsl"+Yw),hsla:new RegExp("hsla"+Kw),hsv:new RegExp("hsv"+Yw),hsva:new RegExp("hsva"+Kw),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function c9(e){if(e=e.trim().toLowerCase(),e.length===0)return!1;var r=!1;if(LS[e])e=LS[e],r=!0;else if(e==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var a=el.rgb.exec(e);return a?{r:a[1],g:a[2],b:a[3]}:(a=el.rgba.exec(e),a?{r:a[1],g:a[2],b:a[3],a:a[4]}:(a=el.hsl.exec(e),a?{h:a[1],s:a[2],l:a[3]}:(a=el.hsla.exec(e),a?{h:a[1],s:a[2],l:a[3],a:a[4]}:(a=el.hsv.exec(e),a?{h:a[1],s:a[2],v:a[3]}:(a=el.hsva.exec(e),a?{h:a[1],s:a[2],v:a[3],a:a[4]}:(a=el.hex8.exec(e),a?{r:Za(a[1]),g:Za(a[2]),b:Za(a[3]),a:l5(a[4]),format:r?"name":"hex8"}:(a=el.hex6.exec(e),a?{r:Za(a[1]),g:Za(a[2]),b:Za(a[3]),format:r?"name":"hex"}:(a=el.hex4.exec(e),a?{r:Za(a[1]+a[1]),g:Za(a[2]+a[2]),b:Za(a[3]+a[3]),a:l5(a[4]+a[4]),format:r?"name":"hex8"}:(a=el.hex3.exec(e),a?{r:Za(a[1]+a[1]),g:Za(a[2]+a[2]),b:Za(a[3]+a[3]),format:r?"name":"hex"}:!1)))))))))}function mc(e){return!!el.CSS_UNIT.exec(String(e))}var Vo=function(){function e(r,a){r===void 0&&(r=""),a===void 0&&(a={});var c;if(r instanceof e)return r;typeof r=="number"&&(r=a9(r)),this.originalInput=r;var d=$f(r);this.originalInput=r,this.r=d.r,this.g=d.g,this.b=d.b,this.a=d.a,this.roundA=Math.round(100*this.a)/100,this.format=(c=a.format)!==null&&c!==void 0?c:d.format,this.gradientType=a.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=d.ok}return e.prototype.isDark=function(){return this.getBrightness()<128},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var r=this.toRgb();return(r.r*299+r.g*587+r.b*114)/1e3},e.prototype.getLuminance=function(){var r=this.toRgb(),a,c,d,x=r.r/255,T=r.g/255,i=r.b/255;return x<=.03928?a=x/12.92:a=Math.pow((x+.055)/1.055,2.4),T<=.03928?c=T/12.92:c=Math.pow((T+.055)/1.055,2.4),i<=.03928?d=i/12.92:d=Math.pow((i+.055)/1.055,2.4),.2126*a+.7152*c+.0722*d},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(r){return this.a=cL(r),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){var r=this.toHsl().s;return r===0},e.prototype.toHsv=function(){var r=RS(this.r,this.g,this.b);return{h:r.h*360,s:r.s,v:r.v,a:this.a}},e.prototype.toHsvString=function(){var r=RS(this.r,this.g,this.b),a=Math.round(r.h*360),c=Math.round(r.s*100),d=Math.round(r.v*100);return this.a===1?"hsv(".concat(a,", ").concat(c,"%, ").concat(d,"%)"):"hsva(".concat(a,", ").concat(c,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var r=s5(this.r,this.g,this.b);return{h:r.h*360,s:r.s,l:r.l,a:this.a}},e.prototype.toHslString=function(){var r=s5(this.r,this.g,this.b),a=Math.round(r.h*360),c=Math.round(r.s*100),d=Math.round(r.l*100);return this.a===1?"hsl(".concat(a,", ").concat(c,"%, ").concat(d,"%)"):"hsla(".concat(a,", ").concat(c,"%, ").concat(d,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(r){return r===void 0&&(r=!1),zS(this.r,this.g,this.b,r)},e.prototype.toHexString=function(r){return r===void 0&&(r=!1),"#"+this.toHex(r)},e.prototype.toHex8=function(r){return r===void 0&&(r=!1),i9(this.r,this.g,this.b,this.a,r)},e.prototype.toHex8String=function(r){return r===void 0&&(r=!1),"#"+this.toHex8(r)},e.prototype.toHexShortString=function(r){return r===void 0&&(r=!1),this.a===1?this.toHexString(r):this.toHex8String(r)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var r=Math.round(this.r),a=Math.round(this.g),c=Math.round(this.b);return this.a===1?"rgb(".concat(r,", ").concat(a,", ").concat(c,")"):"rgba(".concat(r,", ").concat(a,", ").concat(c,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var r=function(a){return"".concat(Math.round(Go(a,255)*100),"%")};return{r:r(this.r),g:r(this.g),b:r(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var r=function(a){return Math.round(Go(a,255)*100)};return this.a===1?"rgb(".concat(r(this.r),"%, ").concat(r(this.g),"%, ").concat(r(this.b),"%)"):"rgba(".concat(r(this.r),"%, ").concat(r(this.g),"%, ").concat(r(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var r="#"+zS(this.r,this.g,this.b,!1),a=0,c=Object.entries(LS);a<c.length;a++){var d=c[a],x=d[0],T=d[1];if(r===T)return x}return!1},e.prototype.toString=function(r){var a=!!r;r=r??this.format;var c=!1,d=this.a<1&&this.a>=0,x=!a&&d&&(r.startsWith("hex")||r==="name");return x?r==="name"&&this.a===0?this.toName():this.toRgbString():(r==="rgb"&&(c=this.toRgbString()),r==="prgb"&&(c=this.toPercentageRgbString()),(r==="hex"||r==="hex6")&&(c=this.toHexString()),r==="hex3"&&(c=this.toHexString(!0)),r==="hex4"&&(c=this.toHex8String(!0)),r==="hex8"&&(c=this.toHex8String()),r==="name"&&(c=this.toName()),r==="hsl"&&(c=this.toHslString()),r==="hsv"&&(c=this.toHsvString()),c||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(r){r===void 0&&(r=10);var a=this.toHsl();return a.l+=r/100,a.l=nv(a.l),new e(a)},e.prototype.brighten=function(r){r===void 0&&(r=10);var a=this.toRgb();return a.r=Math.max(0,Math.min(255,a.r-Math.round(255*-(r/100)))),a.g=Math.max(0,Math.min(255,a.g-Math.round(255*-(r/100)))),a.b=Math.max(0,Math.min(255,a.b-Math.round(255*-(r/100)))),new e(a)},e.prototype.darken=function(r){r===void 0&&(r=10);var a=this.toHsl();return a.l-=r/100,a.l=nv(a.l),new e(a)},e.prototype.tint=function(r){return r===void 0&&(r=10),this.mix("white",r)},e.prototype.shade=function(r){return r===void 0&&(r=10),this.mix("black",r)},e.prototype.desaturate=function(r){r===void 0&&(r=10);var a=this.toHsl();return a.s-=r/100,a.s=nv(a.s),new e(a)},e.prototype.saturate=function(r){r===void 0&&(r=10);var a=this.toHsl();return a.s+=r/100,a.s=nv(a.s),new e(a)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(r){var a=this.toHsl(),c=(a.h+r)%360;return a.h=c<0?360+c:c,new e(a)},e.prototype.mix=function(r,a){a===void 0&&(a=50);var c=this.toRgb(),d=new e(r).toRgb(),x=a/100,T={r:(d.r-c.r)*x+c.r,g:(d.g-c.g)*x+c.g,b:(d.b-c.b)*x+c.b,a:(d.a-c.a)*x+c.a};return new e(T)},e.prototype.analogous=function(r,a){r===void 0&&(r=6),a===void 0&&(a=30);var c=this.toHsl(),d=360/a,x=[this];for(c.h=(c.h-(d*r>>1)+720)%360;--r;)c.h=(c.h+d)%360,x.push(new e(c));return x},e.prototype.complement=function(){var r=this.toHsl();return r.h=(r.h+180)%360,new e(r)},e.prototype.monochromatic=function(r){r===void 0&&(r=6);for(var a=this.toHsv(),c=a.h,d=a.s,x=a.v,T=[],i=1/r;r--;)T.push(new e({h:c,s:d,v:x})),x=(x+i)%1;return T},e.prototype.splitcomplement=function(){var r=this.toHsl(),a=r.h;return[this,new e({h:(a+72)%360,s:r.s,l:r.l}),new e({h:(a+216)%360,s:r.s,l:r.l})]},e.prototype.onBackground=function(r){var a=this.toRgb(),c=new e(r).toRgb(),d=a.a+c.a*(1-a.a);return new e({r:(a.r*a.a+c.r*c.a*(1-a.a))/d,g:(a.g*a.a+c.g*c.a*(1-a.a))/d,b:(a.b*a.a+c.b*c.a*(1-a.a))/d,a:d})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(r){for(var a=this.toHsl(),c=a.h,d=[this],x=360/r,T=1;T<r;T++)d.push(new e({h:(c+T*x)%360,s:a.s,l:a.l}));return d},e.prototype.equals=function(r){return this.toRgbString()===new e(r).toRgbString()},e}(),ov=2,c5=.16,u9=.05,h9=.05,d9=.15,uL=5,hL=4,f9=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function u5(e){var r=e.r,a=e.g,c=e.b,d=RS(r,a,c);return{h:d.h*360,s:d.s,v:d.v}}function av(e){var r=e.r,a=e.g,c=e.b;return"#".concat(zS(r,a,c,!1))}function p9(e,r,a){var c=a/100,d={r:(r.r-e.r)*c+e.r,g:(r.g-e.g)*c+e.g,b:(r.b-e.b)*c+e.b};return d}function h5(e,r,a){var c;return Math.round(e.h)>=60&&Math.round(e.h)<=240?c=a?Math.round(e.h)-ov*r:Math.round(e.h)+ov*r:c=a?Math.round(e.h)+ov*r:Math.round(e.h)-ov*r,c<0?c+=360:c>=360&&(c-=360),c}function d5(e,r,a){if(e.h===0&&e.s===0)return e.s;var c;return a?c=e.s-c5*r:r===hL?c=e.s+c5:c=e.s+u9*r,c>1&&(c=1),a&&r===uL&&c>.1&&(c=.1),c<.06&&(c=.06),Number(c.toFixed(2))}function f5(e,r,a){var c;return a?c=e.v+h9*r:c=e.v-d9*r,c>1&&(c=1),Number(c.toFixed(2))}function nd(e){for(var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=[],c=$f(e),d=uL;d>0;d-=1){var x=u5(c),T=av($f({h:h5(x,d,!0),s:d5(x,d,!0),v:f5(x,d,!0)}));a.push(T)}a.push(av(c));for(var i=1;i<=hL;i+=1){var L=u5(c),N=av($f({h:h5(L,i),s:d5(L,i),v:f5(L,i)}));a.push(N)}return r.theme==="dark"?f9.map(function(U){var q=U.index,X=U.opacity,se=av(p9($f(r.backgroundColor||"#141414"),$f(a[q]),X*100));return se}):a}var Jw={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},kS=["#fff1f0","#ffccc7","#ffa39e","#ff7875","#ff4d4f","#f5222d","#cf1322","#a8071a","#820014","#5c0011"];kS.primary=kS[5];var DS=["#fff2e8","#ffd8bf","#ffbb96","#ff9c6e","#ff7a45","#fa541c","#d4380d","#ad2102","#871400","#610b00"];DS.primary=DS[5];var OS=["#fff7e6","#ffe7ba","#ffd591","#ffc069","#ffa940","#fa8c16","#d46b08","#ad4e00","#873800","#612500"];OS.primary=OS[5];var FS=["#fffbe6","#fff1b8","#ffe58f","#ffd666","#ffc53d","#faad14","#d48806","#ad6800","#874d00","#613400"];FS.primary=FS[5];var BS=["#feffe6","#ffffb8","#fffb8f","#fff566","#ffec3d","#fadb14","#d4b106","#ad8b00","#876800","#614700"];BS.primary=BS[5];var NS=["#fcffe6","#f4ffb8","#eaff8f","#d3f261","#bae637","#a0d911","#7cb305","#5b8c00","#3f6600","#254000"];NS.primary=NS[5];var jS=["#f6ffed","#d9f7be","#b7eb8f","#95de64","#73d13d","#52c41a","#389e0d","#237804","#135200","#092b00"];jS.primary=jS[5];var $S=["#e6fffb","#b5f5ec","#87e8de","#5cdbd3","#36cfc9","#13c2c2","#08979c","#006d75","#00474f","#002329"];$S.primary=$S[5];var h1=["#e6f4ff","#bae0ff","#91caff","#69b1ff","#4096ff","#1677ff","#0958d9","#003eb3","#002c8c","#001d66"];h1.primary=h1[5];var VS=["#f0f5ff","#d6e4ff","#adc6ff","#85a5ff","#597ef7","#2f54eb","#1d39c4","#10239e","#061178","#030852"];VS.primary=VS[5];var US=["#f9f0ff","#efdbff","#d3adf7","#b37feb","#9254de","#722ed1","#531dab","#391085","#22075e","#120338"];US.primary=US[5];var GS=["#fff0f6","#ffd6e7","#ffadd2","#ff85c0","#f759ab","#eb2f96","#c41d7f","#9e1068","#780650","#520339"];GS.primary=GS[5];var HS=["#a6a6a6","#999999","#8c8c8c","#808080","#737373","#666666","#404040","#1a1a1a","#000000","#000000"];HS.primary=HS[5];var Qw={red:kS,volcano:DS,orange:OS,gold:FS,yellow:BS,lime:NS,green:jS,cyan:$S,blue:h1,geekblue:VS,purple:US,magenta:GS,grey:HS};const AE={blue:"#1677FF",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#EB2F96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},Sp=Object.assign(Object.assign({},AE),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0});function dL(e,r){let{generateColorPalettes:a,generateNeutralColorPalettes:c}=r;const{colorSuccess:d,colorWarning:x,colorError:T,colorInfo:i,colorPrimary:L,colorBgBase:N,colorTextBase:U}=e,q=a(L),X=a(d),se=a(x),ce=a(T),ue=a(i),fe=c(N,U),re=e.colorLink||e.colorInfo,ee=a(re),ae=new Vo(ce[1]).mix(new Vo(ce[3]),50).toHexString();return Object.assign(Object.assign({},fe),{colorPrimaryBg:q[1],colorPrimaryBgHover:q[2],colorPrimaryBorder:q[3],colorPrimaryBorderHover:q[4],colorPrimaryHover:q[5],colorPrimary:q[6],colorPrimaryActive:q[7],colorPrimaryTextHover:q[8],colorPrimaryText:q[9],colorPrimaryTextActive:q[10],colorSuccessBg:X[1],colorSuccessBgHover:X[2],colorSuccessBorder:X[3],colorSuccessBorderHover:X[4],colorSuccessHover:X[4],colorSuccess:X[6],colorSuccessActive:X[7],colorSuccessTextHover:X[8],colorSuccessText:X[9],colorSuccessTextActive:X[10],colorErrorBg:ce[1],colorErrorBgHover:ce[2],colorErrorBgFilledHover:ae,colorErrorBgActive:ce[3],colorErrorBorder:ce[3],colorErrorBorderHover:ce[4],colorErrorHover:ce[5],colorError:ce[6],colorErrorActive:ce[7],colorErrorTextHover:ce[8],colorErrorText:ce[9],colorErrorTextActive:ce[10],colorWarningBg:se[1],colorWarningBgHover:se[2],colorWarningBorder:se[3],colorWarningBorderHover:se[4],colorWarningHover:se[4],colorWarning:se[6],colorWarningActive:se[7],colorWarningTextHover:se[8],colorWarningText:se[9],colorWarningTextActive:se[10],colorInfoBg:ue[1],colorInfoBgHover:ue[2],colorInfoBorder:ue[3],colorInfoBorderHover:ue[4],colorInfoHover:ue[4],colorInfo:ue[6],colorInfoActive:ue[7],colorInfoTextHover:ue[8],colorInfoText:ue[9],colorInfoTextActive:ue[10],colorLinkHover:ee[4],colorLink:ee[6],colorLinkActive:ee[7],colorBgMask:new Vo("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}const m9=e=>{let r=e,a=e,c=e,d=e;return e<6&&e>=5?r=e+1:e<16&&e>=6?r=e+2:e>=16&&(r=16),e<7&&e>=5?a=4:e<8&&e>=7?a=5:e<14&&e>=8?a=6:e<16&&e>=14?a=7:e>=16&&(a=8),e<6&&e>=2?c=1:e>=6&&(c=2),e>4&&e<8?d=4:e>=8&&(d=6),{borderRadius:e,borderRadiusXS:c,borderRadiusSM:a,borderRadiusLG:r,borderRadiusOuter:d}},g9=m9;function _9(e){const{motionUnit:r,motionBase:a,borderRadius:c,lineWidth:d}=e;return Object.assign({motionDurationFast:`${(a+r).toFixed(1)}s`,motionDurationMid:`${(a+r*2).toFixed(1)}s`,motionDurationSlow:`${(a+r*3).toFixed(1)}s`,lineWidthBold:d+1},g9(c))}const y9=e=>{const{controlHeight:r}=e;return{controlHeightSM:r*.75,controlHeightXS:r*.5,controlHeightLG:r*1.25}},fL=y9;function Ov(e){return(e+8)/e}function v9(e){const r=new Array(10).fill(null).map((a,c)=>{const d=c-1,x=e*Math.pow(Math.E,d/5),T=c>1?Math.floor(x):Math.ceil(x);return Math.floor(T/2)*2});return r[1]=e,r.map(a=>({size:a,lineHeight:Ov(a)}))}const x9=e=>{const r=v9(e),a=r.map(U=>U.size),c=r.map(U=>U.lineHeight),d=a[1],x=a[0],T=a[2],i=c[1],L=c[0],N=c[2];return{fontSizeSM:x,fontSize:d,fontSizeLG:T,fontSizeXL:a[3],fontSizeHeading1:a[6],fontSizeHeading2:a[5],fontSizeHeading3:a[4],fontSizeHeading4:a[3],fontSizeHeading5:a[2],lineHeight:i,lineHeightLG:N,lineHeightSM:L,fontHeight:Math.round(i*d),fontHeightLG:Math.round(N*T),fontHeightSM:Math.round(L*x),lineHeightHeading1:c[6],lineHeightHeading2:c[5],lineHeightHeading3:c[4],lineHeightHeading4:c[3],lineHeightHeading5:c[2]}},pL=x9;function b9(e){const{sizeUnit:r,sizeStep:a}=e;return{sizeXXL:r*(a+8),sizeXL:r*(a+4),sizeLG:r*(a+2),sizeMD:r*(a+1),sizeMS:r*a,size:r*a,sizeSM:r*(a-1),sizeXS:r*(a-2),sizeXXS:r*(a-3)}}const fs=(e,r)=>new Vo(e).setAlpha(r).toRgbString(),Sg=(e,r)=>new Vo(e).darken(r).toHexString(),w9=e=>{const r=nd(e);return{1:r[0],2:r[1],3:r[2],4:r[3],5:r[4],6:r[5],7:r[6],8:r[4],9:r[5],10:r[6]}},S9=(e,r)=>{const a=e||"#fff",c=r||"#000";return{colorBgBase:a,colorTextBase:c,colorText:fs(c,.88),colorTextSecondary:fs(c,.65),colorTextTertiary:fs(c,.45),colorTextQuaternary:fs(c,.25),colorFill:fs(c,.15),colorFillSecondary:fs(c,.06),colorFillTertiary:fs(c,.04),colorFillQuaternary:fs(c,.02),colorBgSolid:fs(c,1),colorBgSolidHover:fs(c,.75),colorBgSolidActive:fs(c,.95),colorBgLayout:Sg(a,4),colorBgContainer:Sg(a,0),colorBgElevated:Sg(a,0),colorBgSpotlight:fs(c,.85),colorBgBlur:"transparent",colorBorder:Sg(a,15),colorBorderSecondary:Sg(a,6)}};function F_(e){Jw.pink=Jw.magenta,Qw.pink=Qw.magenta;const r=Object.keys(AE).map(a=>{const c=e[a]===Jw[a]?Qw[a]:nd(e[a]);return new Array(10).fill(1).reduce((d,x,T)=>(d[`${a}-${T+1}`]=c[T],d[`${a}${T+1}`]=c[T],d),{})}).reduce((a,c)=>(a=Object.assign(Object.assign({},a),c),a),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),r),dL(e,{generateColorPalettes:w9,generateNeutralColorPalettes:S9})),pL(e.fontSize)),b9(e)),fL(e)),_9(e))}const mL=__(F_),x_={token:Sp,override:{override:Sp},hashed:!0},RE=sn.createContext(x_),b_="ant",zE="anticon",E9=(e,r)=>r||(e?`${b_}-${e}`:b_),Yn=$.createContext({getPrefixCls:E9,iconPrefixCls:zE}),T9=`-ant-${Date.now()}-${Math.random()}`;function C9(e,r){const a={},c=(T,i)=>{let L=T.clone();return L=(i==null?void 0:i(L))||L,L.toRgbString()},d=(T,i)=>{const L=new Vo(T),N=nd(L.toRgbString());a[`${i}-color`]=c(L),a[`${i}-color-disabled`]=N[1],a[`${i}-color-hover`]=N[4],a[`${i}-color-active`]=N[6],a[`${i}-color-outline`]=L.clone().setAlpha(.2).toRgbString(),a[`${i}-color-deprecated-bg`]=N[0],a[`${i}-color-deprecated-border`]=N[2]};if(r.primaryColor){d(r.primaryColor,"primary");const T=new Vo(r.primaryColor),i=nd(T.toRgbString());i.forEach((N,U)=>{a[`primary-${U+1}`]=N}),a["primary-color-deprecated-l-35"]=c(T,N=>N.lighten(35)),a["primary-color-deprecated-l-20"]=c(T,N=>N.lighten(20)),a["primary-color-deprecated-t-20"]=c(T,N=>N.tint(20)),a["primary-color-deprecated-t-50"]=c(T,N=>N.tint(50)),a["primary-color-deprecated-f-12"]=c(T,N=>N.setAlpha(N.getAlpha()*.12));const L=new Vo(i[0]);a["primary-color-active-deprecated-f-30"]=c(L,N=>N.setAlpha(N.getAlpha()*.3)),a["primary-color-active-deprecated-d-02"]=c(L,N=>N.darken(2))}return r.successColor&&d(r.successColor,"success"),r.warningColor&&d(r.warningColor,"warning"),r.errorColor&&d(r.errorColor,"error"),r.infoColor&&d(r.infoColor,"info"),`
  :root {
    ${Object.keys(a).map(T=>`--${e}-${T}: ${a[T]};`).join(`
`)}
  }
  `.trim()}function M9(e,r){const a=C9(e,r);ns()&&bc(a,`${T9}-dynamic-theme`)}const WS=$.createContext(!1),gL=e=>{let{children:r,disabled:a}=e;const c=$.useContext(WS);return $.createElement(WS.Provider,{value:a??c},r)},B_=WS,qS=$.createContext(void 0),I9=e=>{let{children:r,size:a}=e;const c=$.useContext(qS);return $.createElement(qS.Provider,{value:a||c},r)},N_=qS;function P9(){const e=$.useContext(B_),r=$.useContext(N_);return{componentDisabled:e,componentSize:r}}var _L=Ro(function e(){Ao(this,e)}),yL="CALC_UNIT",A9=new RegExp(yL,"g");function e2(e){return typeof e=="number"?"".concat(e).concat(yL):e}var R9=function(e){Hu(a,e);var r=Wu(a);function a(c,d){var x;Ao(this,a),x=r.call(this),Et(Sn(x),"result",""),Et(Sn(x),"unitlessCssVar",void 0),Et(Sn(x),"lowPriority",void 0);var T=ln(c);return x.unitlessCssVar=d,c instanceof a?x.result="(".concat(c.result,")"):T==="number"?x.result=e2(c):T==="string"&&(x.result=c),x}return Ro(a,[{key:"add",value:function(d){return d instanceof a?this.result="".concat(this.result," + ").concat(d.getResult()):(typeof d=="number"||typeof d=="string")&&(this.result="".concat(this.result," + ").concat(e2(d))),this.lowPriority=!0,this}},{key:"sub",value:function(d){return d instanceof a?this.result="".concat(this.result," - ").concat(d.getResult()):(typeof d=="number"||typeof d=="string")&&(this.result="".concat(this.result," - ").concat(e2(d))),this.lowPriority=!0,this}},{key:"mul",value:function(d){return this.lowPriority&&(this.result="(".concat(this.result,")")),d instanceof a?this.result="".concat(this.result," * ").concat(d.getResult(!0)):(typeof d=="number"||typeof d=="string")&&(this.result="".concat(this.result," * ").concat(d)),this.lowPriority=!1,this}},{key:"div",value:function(d){return this.lowPriority&&(this.result="(".concat(this.result,")")),d instanceof a?this.result="".concat(this.result," / ").concat(d.getResult(!0)):(typeof d=="number"||typeof d=="string")&&(this.result="".concat(this.result," / ").concat(d)),this.lowPriority=!1,this}},{key:"getResult",value:function(d){return this.lowPriority||d?"(".concat(this.result,")"):this.result}},{key:"equal",value:function(d){var x=this,T=d||{},i=T.unit,L=!0;return typeof i=="boolean"?L=i:Array.from(this.unitlessCssVar).some(function(N){return x.result.includes(N)})&&(L=!1),this.result=this.result.replace(A9,L?"px":""),typeof this.lowPriority<"u"?"calc(".concat(this.result,")"):this.result}}]),a}(_L),z9=function(e){Hu(a,e);var r=Wu(a);function a(c){var d;return Ao(this,a),d=r.call(this),Et(Sn(d),"result",0),c instanceof a?d.result=c.result:typeof c=="number"&&(d.result=c),d}return Ro(a,[{key:"add",value:function(d){return d instanceof a?this.result+=d.result:typeof d=="number"&&(this.result+=d),this}},{key:"sub",value:function(d){return d instanceof a?this.result-=d.result:typeof d=="number"&&(this.result-=d),this}},{key:"mul",value:function(d){return d instanceof a?this.result*=d.result:typeof d=="number"&&(this.result*=d),this}},{key:"div",value:function(d){return d instanceof a?this.result/=d.result:typeof d=="number"&&(this.result/=d),this}},{key:"equal",value:function(){return this.result}}]),a}(_L),L9=function(r,a){var c=r==="css"?R9:z9;return function(d){return new c(d,a)}},p5=function(r,a){return"".concat([a,r.replace(/([A-Z]+)([A-Z][a-z]+)/g,"$1-$2").replace(/([a-z])([A-Z])/g,"$1-$2")].filter(Boolean).join("-"))};function Ka(e){var r=$.useRef();r.current=e;var a=$.useCallback(function(){for(var c,d=arguments.length,x=new Array(d),T=0;T<d;T++)x[T]=arguments[T];return(c=r.current)===null||c===void 0?void 0:c.call.apply(c,[r].concat(x))},[]);return a}function Ep(e){var r=$.useRef(!1),a=$.useState(e),c=Sr(a,2),d=c[0],x=c[1];$.useEffect(function(){return r.current=!1,function(){r.current=!0}},[]);function T(i,L){L&&r.current||x(i)}return[d,T]}function t2(e){return e!==void 0}function LE(e,r){var a=r||{},c=a.defaultValue,d=a.value,x=a.onChange,T=a.postState,i=Ep(function(){return t2(d)?d:t2(c)?typeof c=="function"?c():c:typeof e=="function"?e():e}),L=Sr(i,2),N=L[0],U=L[1],q=d!==void 0?d:N,X=T?T(q):q,se=Ka(x),ce=Ep([q]),ue=Sr(ce,2),fe=ue[0],re=ue[1];JI(function(){var ae=fe[0];N!==ae&&se(N,ae)},[fe]),JI(function(){t2(d)||U(d)},[d]);var ee=Ka(function(ae,ve){U(ae,ve),re([q],ve)});return[X,ee]}function m5(e,r,a,c){var d=Ft({},r[e]);if(c!=null&&c.deprecatedTokens){var x=c.deprecatedTokens;x.forEach(function(i){var L=Sr(i,2),N=L[0],U=L[1];if(d!=null&&d[N]||d!=null&&d[U]){var q;(q=d[U])!==null&&q!==void 0||(d[U]=d==null?void 0:d[N])}})}var T=Ft(Ft({},a),d);return Object.keys(T).forEach(function(i){T[i]===r[i]&&delete T[i]}),T}var vL=typeof CSSINJS_STATISTIC<"u",ZS=!0;function Wo(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];if(!vL)return Object.assign.apply(Object,[{}].concat(r));ZS=!1;var c={};return r.forEach(function(d){if(ln(d)==="object"){var x=Object.keys(d);x.forEach(function(T){Object.defineProperty(c,T,{configurable:!0,enumerable:!0,get:function(){return d[T]}})})}}),ZS=!0,c}var g5={};function k9(){}var D9=function(r){var a,c=r,d=k9;return vL&&typeof Proxy<"u"&&(a=new Set,c=new Proxy(r,{get:function(T,i){if(ZS){var L;(L=a)===null||L===void 0||L.add(i)}return T[i]}}),d=function(T,i){var L;g5[T]={global:Array.from(a),component:Ft(Ft({},(L=g5[T])===null||L===void 0?void 0:L.component),i)}}),{token:c,keys:a,flush:d}};function _5(e,r,a){if(typeof a=="function"){var c;return a(Wo(r,(c=r[e])!==null&&c!==void 0?c:{}))}return a??{}}function O9(e){return e==="js"?{max:Math.max,min:Math.min}:{max:function(){for(var a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];return"max(".concat(c.map(function(x){return fn(x)}).join(","),")")},min:function(){for(var a=arguments.length,c=new Array(a),d=0;d<a;d++)c[d]=arguments[d];return"min(".concat(c.map(function(x){return fn(x)}).join(","),")")}}}var F9=1e3*60*10,B9=function(){function e(){Ao(this,e),Et(this,"map",new Map),Et(this,"objectIDMap",new WeakMap),Et(this,"nextID",0),Et(this,"lastAccessBeat",new Map),Et(this,"accessBeat",0)}return Ro(e,[{key:"set",value:function(a,c){this.clear();var d=this.getCompositeKey(a);this.map.set(d,c),this.lastAccessBeat.set(d,Date.now())}},{key:"get",value:function(a){var c=this.getCompositeKey(a),d=this.map.get(c);return this.lastAccessBeat.set(c,Date.now()),this.accessBeat+=1,d}},{key:"getCompositeKey",value:function(a){var c=this,d=a.map(function(x){return x&&ln(x)==="object"?"obj_".concat(c.getObjectID(x)):"".concat(ln(x),"_").concat(x)});return d.join("|")}},{key:"getObjectID",value:function(a){if(this.objectIDMap.has(a))return this.objectIDMap.get(a);var c=this.nextID;return this.objectIDMap.set(a,c),this.nextID+=1,c}},{key:"clear",value:function(){var a=this;if(this.accessBeat>1e4){var c=Date.now();this.lastAccessBeat.forEach(function(d,x){c-d>F9&&(a.map.delete(x),a.lastAccessBeat.delete(x))}),this.accessBeat=0}}}]),e}(),y5=new B9;function N9(e,r){return sn.useMemo(function(){var a=y5.get(r);if(a)return a;var c=e();return y5.set(r,c),c},r)}var j9=function(){return{}};function $9(e){var r=e.useCSP,a=r===void 0?j9:r,c=e.useToken,d=e.usePrefix,x=e.getResetStyles,T=e.getCommonStyle,i=e.getCompUnitless;function L(X,se,ce,ue){var fe=Array.isArray(X)?X[0]:X;function re(Ne){return"".concat(String(fe)).concat(Ne.slice(0,1).toUpperCase()).concat(Ne.slice(1))}var ee=(ue==null?void 0:ue.unitless)||{},ae=typeof i=="function"?i(X):{},ve=Ft(Ft({},ae),{},Et({},re("zIndexPopup"),!0));Object.keys(ee).forEach(function(Ne){ve[re(Ne)]=ee[Ne]});var Te=Ft(Ft({},ue),{},{unitless:ve,prefixToken:re}),pe=U(X,se,ce,Te),Ee=N(fe,ce,Te);return function(Ne){var Xe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Ne,Fe=pe(Ne,Xe),Je=Sr(Fe,2),Ct=Je[1],ft=Ee(Xe),yt=Sr(ft,2),lt=yt[0],ct=yt[1];return[lt,Ct,ct]}}function N(X,se,ce){var ue=ce.unitless,fe=ce.injectStyle,re=fe===void 0?!0:fe,ee=ce.prefixToken,ae=ce.ignore,ve=function(Ee){var Ne=Ee.rootCls,Xe=Ee.cssVar,Fe=Xe===void 0?{}:Xe,Je=c(),Ct=Je.realToken;return zN({path:[X],prefix:Fe.prefix,key:Fe.key,unitless:ue,ignore:ae,token:Ct,scope:Ne},function(){var ft=_5(X,Ct,se),yt=m5(X,Ct,ft,{deprecatedTokens:ce==null?void 0:ce.deprecatedTokens});return Object.keys(ft).forEach(function(lt){yt[ee(lt)]=yt[lt],delete yt[lt]}),yt}),null},Te=function(Ee){var Ne=c(),Xe=Ne.cssVar;return[function(Fe){return re&&Xe?sn.createElement(sn.Fragment,null,sn.createElement(ve,{rootCls:Ee,cssVar:Xe,component:X}),Fe):Fe},Xe==null?void 0:Xe.key]};return Te}function U(X,se,ce){var ue=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},fe=Array.isArray(X)?X:[X,X],re=Sr(fe,1),ee=re[0],ae=fe.join("-"),ve=e.layer||{name:"antd"};return function(Te){var pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Te,Ee=c(),Ne=Ee.theme,Xe=Ee.realToken,Fe=Ee.hashId,Je=Ee.token,Ct=Ee.cssVar,ft=d(),yt=ft.rootPrefixCls,lt=ft.iconPrefixCls,ct=a(),Ye=Ct?"css":"js",Ke=N9(function(){var qt=new Set;return Ct&&Object.keys(ue.unitless||{}).forEach(function(or){qt.add(Av(or,Ct.prefix)),qt.add(Av(or,p5(ee,Ct.prefix)))}),L9(Ye,qt)},[Ye,ee,Ct==null?void 0:Ct.prefix]),tt=O9(Ye),ht=tt.max,vt=tt.min,At={theme:Ne,token:Je,hashId:Fe,nonce:function(){return ct.nonce},clientOnly:ue.clientOnly,layer:ve,order:ue.order||-999};typeof x=="function"&&AS(Ft(Ft({},At),{},{clientOnly:!1,path:["Shared",yt]}),function(){return x(Je,{prefix:{rootPrefixCls:yt,iconPrefixCls:lt},csp:ct})});var Pt=AS(Ft(Ft({},At),{},{path:[ae,Te,lt]}),function(){if(ue.injectStyle===!1)return[];var qt=D9(Je),or=qt.token,cr=qt.flush,Qt=_5(ee,Xe,ce),qr=".".concat(Te),yr=m5(ee,Xe,Qt,{deprecatedTokens:ue.deprecatedTokens});Ct&&Qt&&ln(Qt)==="object"&&Object.keys(Qt).forEach(function(pn){Qt[pn]="var(".concat(Av(pn,p5(ee,Ct.prefix)),")")});var Ae=Wo(or,{componentCls:qr,prefixCls:Te,iconCls:".".concat(lt),antCls:".".concat(yt),calc:Ke,max:ht,min:vt},Ct?Qt:yr),Lr=se(Ae,{hashId:Fe,prefixCls:Te,rootPrefixCls:yt,iconPrefixCls:lt});cr(ee,yr);var $r=typeof T=="function"?T(Ae,Te,pe,ue.resetFont):null;return[ue.resetStyle===!1?null:$r,Lr]});return[Pt,Fe]}}function q(X,se,ce){var ue=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},fe=U(X,se,ce,Ft({resetStyle:!1,order:-998},ue)),re=function(ae){var ve=ae.prefixCls,Te=ae.rootCls,pe=Te===void 0?ve:Te;return fe(ve,pe),null};return re}return{genStyleHooks:L,genSubStyleComponent:q,genComponentStyleHook:U}}const d1=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"],V9="5.22.5";function r2(e){return e>=0&&e<=255}function sv(e,r){const{r:a,g:c,b:d,a:x}=new Vo(e).toRgb();if(x<1)return e;const{r:T,g:i,b:L}=new Vo(r).toRgb();for(let N=.01;N<=1;N+=.01){const U=Math.round((a-T*(1-N))/N),q=Math.round((c-i*(1-N))/N),X=Math.round((d-L*(1-N))/N);if(r2(U)&&r2(q)&&r2(X))return new Vo({r:U,g:q,b:X,a:Math.round(N*100)/100}).toRgbString()}return new Vo({r:a,g:c,b:d,a:1}).toRgbString()}var U9=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};function kE(e){const{override:r}=e,a=U9(e,["override"]),c=Object.assign({},r);Object.keys(Sp).forEach(X=>{delete c[X]});const d=Object.assign(Object.assign({},a),c),x=480,T=576,i=768,L=992,N=1200,U=1600;if(d.motion===!1){const X="0s";d.motionDurationFast=X,d.motionDurationMid=X,d.motionDurationSlow=X}return Object.assign(Object.assign(Object.assign({},d),{colorFillContent:d.colorFillSecondary,colorFillContentHover:d.colorFill,colorFillAlter:d.colorFillQuaternary,colorBgContainerDisabled:d.colorFillTertiary,colorBorderBg:d.colorBgContainer,colorSplit:sv(d.colorBorderSecondary,d.colorBgContainer),colorTextPlaceholder:d.colorTextQuaternary,colorTextDisabled:d.colorTextQuaternary,colorTextHeading:d.colorText,colorTextLabel:d.colorTextSecondary,colorTextDescription:d.colorTextTertiary,colorTextLightSolid:d.colorWhite,colorHighlight:d.colorError,colorBgTextHover:d.colorFillSecondary,colorBgTextActive:d.colorFill,colorIcon:d.colorTextTertiary,colorIconHover:d.colorText,colorErrorOutline:sv(d.colorErrorBg,d.colorBgContainer),colorWarningOutline:sv(d.colorWarningBg,d.colorBgContainer),fontSizeIcon:d.fontSizeSM,lineWidthFocus:d.lineWidth*3,lineWidth:d.lineWidth,controlOutlineWidth:d.lineWidth*2,controlInteractiveSize:d.controlHeight/2,controlItemBgHover:d.colorFillTertiary,controlItemBgActive:d.colorPrimaryBg,controlItemBgActiveHover:d.colorPrimaryBgHover,controlItemBgActiveDisabled:d.colorFill,controlTmpOutline:d.colorFillQuaternary,controlOutline:sv(d.colorPrimaryBg,d.colorBgContainer),lineType:d.lineType,borderRadius:d.borderRadius,borderRadiusXS:d.borderRadiusXS,borderRadiusSM:d.borderRadiusSM,borderRadiusLG:d.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:d.sizeXXS,paddingXS:d.sizeXS,paddingSM:d.sizeSM,padding:d.size,paddingMD:d.sizeMD,paddingLG:d.sizeLG,paddingXL:d.sizeXL,paddingContentHorizontalLG:d.sizeLG,paddingContentVerticalLG:d.sizeMS,paddingContentHorizontal:d.sizeMS,paddingContentVertical:d.sizeSM,paddingContentHorizontalSM:d.size,paddingContentVerticalSM:d.sizeXS,marginXXS:d.sizeXXS,marginXS:d.sizeXS,marginSM:d.sizeSM,margin:d.size,marginMD:d.sizeMD,marginLG:d.sizeLG,marginXL:d.sizeXL,marginXXL:d.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:x,screenXSMin:x,screenXSMax:T-1,screenSM:T,screenSMMin:T,screenSMMax:i-1,screenMD:i,screenMDMin:i,screenMDMax:L-1,screenLG:L,screenLGMin:L,screenLGMax:N-1,screenXL:N,screenXLMin:N,screenXLMax:U-1,screenXXL:U,screenXXLMin:U,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new Vo("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new Vo("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new Vo("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),c)}var v5=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};const xL={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0,opacityImage:!0},G9={size:!0,sizeSM:!0,sizeLG:!0,sizeMD:!0,sizeXS:!0,sizeXXS:!0,sizeMS:!0,sizeXL:!0,sizeXXL:!0,sizeUnit:!0,sizeStep:!0,motionBase:!0,motionUnit:!0},H9={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},bL=(e,r,a)=>{const c=a.getDerivativeToken(e),{override:d}=r,x=v5(r,["override"]);let T=Object.assign(Object.assign({},c),{override:d});return T=kE(T),x&&Object.entries(x).forEach(i=>{let[L,N]=i;const{theme:U}=N,q=v5(N,["theme"]);let X=q;U&&(X=bL(Object.assign(Object.assign({},T),q),{override:q},U)),T[L]=X}),T};function $l(){const{token:e,hashed:r,theme:a,override:c,cssVar:d}=sn.useContext(RE),x=`${V9}-${r||""}`,T=a||mL,[i,L,N]=oN(T,[Sp,e],{salt:x,override:c,getComputedToken:bL,formatToken:kE,cssVar:d&&{prefix:d.prefix,key:d.key,unitless:xL,ignore:G9,preserve:H9}});return[T,N,r?L:"",i,d]}const hl=function(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return{boxSizing:"border-box",margin:0,padding:0,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,listStyle:"none",fontFamily:r?"inherit":e.fontFamily}},W9=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),q9=e=>({a:{color:e.colorLink,textDecoration:e.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:e.colorLinkHover},"&:active":{color:e.colorLinkActive},"&:active, &:hover":{textDecoration:e.linkHoverDecoration,outline:0},"&:focus":{textDecoration:e.linkFocusDecoration,outline:0},"&[disabled]":{color:e.colorTextDisabled,cursor:"not-allowed"}}}),Z9=(e,r,a,c)=>{const d=`[class^="${r}"], [class*=" ${r}"]`,x=a?`.${a}`:d,T={boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}};let i={};return c!==!1&&(i={fontFamily:e.fontFamily,fontSize:e.fontSize}),{[x]:Object.assign(Object.assign(Object.assign({},i),T),{[d]:T})}},ex=e=>({outline:`${fn(e.lineWidthFocus)} solid ${e.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"}),X9=e=>({"&:focus-visible":Object.assign({},ex(e))}),wL=e=>({[`.${e}`]:Object.assign(Object.assign({},W9()),{[`.${e} .${e}-icon`]:{display:"block"}})}),{genStyleHooks:Ms,genComponentStyleHook:Y9,genSubStyleComponent:SL}=$9({usePrefix:()=>{const{getPrefixCls:e,iconPrefixCls:r}=$.useContext(Yn);return{rootPrefixCls:e(),iconPrefixCls:r}},useToken:()=>{const[e,r,a,c,d]=$l();return{theme:e,realToken:r,hashId:a,token:c,cssVar:d}},useCSP:()=>{const{csp:e}=$.useContext(Yn);return e??{}},getResetStyles:(e,r)=>{var a;return[{"&":q9(e)},wL((a=r==null?void 0:r.prefix.iconPrefixCls)!==null&&a!==void 0?a:zE)]},getCommonStyle:Z9,getCompUnitless:()=>xL});function K9(e,r){return d1.reduce((a,c)=>{const d=e[`${c}1`],x=e[`${c}3`],T=e[`${c}6`],i=e[`${c}7`];return Object.assign(Object.assign({},a),r(c,{lightColor:d,lightBorderColor:x,darkColor:T,textColor:i}))},{})}const J9=(e,r)=>{const[a,c]=$l();return AS({theme:a,token:c,hashId:"",path:["ant-design-icons",e],nonce:()=>r==null?void 0:r.nonce,layer:{name:"antd"}},()=>[wL(e)])},Q9=J9,ej=Object.assign({},R_),{useId:x5}=ej,tj=()=>"",rj=typeof x5>"u"?tj:x5,nj=rj;function ij(e,r,a){var c;IE();const d=e||{},x=d.inherit===!1||!r?Object.assign(Object.assign({},x_),{hashed:(c=r==null?void 0:r.hashed)!==null&&c!==void 0?c:x_.hashed,cssVar:r==null?void 0:r.cssVar}):r,T=nj();return gE(()=>{var i,L;if(!e)return r;const N=Object.assign({},x.components);Object.keys(e.components||{}).forEach(X=>{N[X]=Object.assign(Object.assign({},N[X]),e.components[X])});const U=`css-var-${T.replace(/:/g,"")}`,q=((i=d.cssVar)!==null&&i!==void 0?i:x.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:a==null?void 0:a.prefixCls},typeof x.cssVar=="object"?x.cssVar:{}),typeof d.cssVar=="object"?d.cssVar:{}),{key:typeof d.cssVar=="object"&&((L=d.cssVar)===null||L===void 0?void 0:L.key)||U});return Object.assign(Object.assign(Object.assign({},x),d),{token:Object.assign(Object.assign({},x.token),d.token),components:N,cssVar:q})},[d,x],(i,L)=>i.some((N,U)=>{const q=L[U];return!TS(N,q,!0)}))}var oj=["children"],EL=$.createContext({});function aj(e){var r=e.children,a=is(e,oj);return $.createElement(EL.Provider,{value:a},r)}var sj=function(e){Hu(a,e);var r=Wu(a);function a(){return Ao(this,a),r.apply(this,arguments)}return Ro(a,[{key:"render",value:function(){return this.props.children}}]),a}($.Component);function lj(e){var r=$.useReducer(function(i){return i+1},0),a=Sr(r,2),c=a[1],d=$.useRef(e),x=Ka(function(){return d.current}),T=Ka(function(i){d.current=typeof i=="function"?i(d.current):i,c()});return[x,T]}var yu="none",lv="appear",cv="enter",uv="leave",b5="none",nl="prepare",tp="start",rp="active",DE="end",TL="prepared";function w5(e,r){var a={};return a[e.toLowerCase()]=r.toLowerCase(),a["Webkit".concat(e)]="webkit".concat(r),a["Moz".concat(e)]="moz".concat(r),a["ms".concat(e)]="MS".concat(r),a["O".concat(e)]="o".concat(r.toLowerCase()),a}function cj(e,r){var a={animationend:w5("Animation","AnimationEnd"),transitionend:w5("Transition","TransitionEnd")};return e&&("AnimationEvent"in r||delete a.animationend.animation,"TransitionEvent"in r||delete a.transitionend.transition),a}var uj=cj(ns(),typeof window<"u"?window:{}),CL={};if(ns()){var hj=document.createElement("div");CL=hj.style}var hv={};function ML(e){if(hv[e])return hv[e];var r=uj[e];if(r)for(var a=Object.keys(r),c=a.length,d=0;d<c;d+=1){var x=a[d];if(Object.prototype.hasOwnProperty.call(r,x)&&x in CL)return hv[e]=r[x],hv[e]}return""}var IL=ML("animationend"),PL=ML("transitionend"),AL=!!(IL&&PL),S5=IL||"animationend",E5=PL||"transitionend";function T5(e,r){if(!e)return null;if(ln(e)==="object"){var a=r.replace(/-\w/g,function(c){return c[1].toUpperCase()});return e[a]}return"".concat(e,"-").concat(r)}const dj=function(e){var r=$.useRef();function a(d){d&&(d.removeEventListener(E5,e),d.removeEventListener(S5,e))}function c(d){r.current&&r.current!==d&&a(r.current),d&&d!==r.current&&(d.addEventListener(E5,e),d.addEventListener(S5,e),r.current=d)}return $.useEffect(function(){return function(){a(r.current)}},[]),[c,a]};var RL=ns()?$.useLayoutEffect:$.useEffect;const fj=function(){var e=$.useRef(null);function r(){fl.cancel(e.current)}function a(c){var d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;r();var x=fl(function(){d<=1?c({isCanceled:function(){return x!==e.current}}):a(c,d-1)});e.current=x}return $.useEffect(function(){return function(){r()}},[]),[a,r]};var pj=[nl,tp,rp,DE],mj=[nl,TL],zL=!1,gj=!0;function LL(e){return e===rp||e===DE}const _j=function(e,r,a){var c=Ep(b5),d=Sr(c,2),x=d[0],T=d[1],i=fj(),L=Sr(i,2),N=L[0],U=L[1];function q(){T(nl,!0)}var X=r?mj:pj;return RL(function(){if(x!==b5&&x!==DE){var se=X.indexOf(x),ce=X[se+1],ue=a(x);ue===zL?T(ce,!0):ce&&N(function(fe){function re(){fe.isCanceled()||T(ce,!0)}ue===!0?re():Promise.resolve(ue).then(re)})}},[e,x]),$.useEffect(function(){return function(){U()}},[]),[q,x]};function yj(e,r,a,c){var d=c.motionEnter,x=d===void 0?!0:d,T=c.motionAppear,i=T===void 0?!0:T,L=c.motionLeave,N=L===void 0?!0:L,U=c.motionDeadline,q=c.motionLeaveImmediately,X=c.onAppearPrepare,se=c.onEnterPrepare,ce=c.onLeavePrepare,ue=c.onAppearStart,fe=c.onEnterStart,re=c.onLeaveStart,ee=c.onAppearActive,ae=c.onEnterActive,ve=c.onLeaveActive,Te=c.onAppearEnd,pe=c.onEnterEnd,Ee=c.onLeaveEnd,Ne=c.onVisibleChanged,Xe=Ep(),Fe=Sr(Xe,2),Je=Fe[0],Ct=Fe[1],ft=lj(yu),yt=Sr(ft,2),lt=yt[0],ct=yt[1],Ye=Ep(null),Ke=Sr(Ye,2),tt=Ke[0],ht=Ke[1],vt=lt(),At=$.useRef(!1),Pt=$.useRef(null);function qt(){return a()}var or=$.useRef(!1);function cr(){ct(yu),ht(null,!0)}var Qt=Ka(function(Xr){var hn=lt();if(hn!==yu){var fr=qt();if(!(Xr&&!Xr.deadline&&Xr.target!==fr)){var Jt=or.current,bn;hn===lv&&Jt?bn=Te==null?void 0:Te(fr,Xr):hn===cv&&Jt?bn=pe==null?void 0:pe(fr,Xr):hn===uv&&Jt&&(bn=Ee==null?void 0:Ee(fr,Xr)),Jt&&bn!==!1&&cr()}}}),qr=dj(Qt),yr=Sr(qr,1),Ae=yr[0],Lr=function(hn){switch(hn){case lv:return Et(Et(Et({},nl,X),tp,ue),rp,ee);case cv:return Et(Et(Et({},nl,se),tp,fe),rp,ae);case uv:return Et(Et(Et({},nl,ce),tp,re),rp,ve);default:return{}}},$r=$.useMemo(function(){return Lr(vt)},[vt]),pn=_j(vt,!e,function(Xr){if(Xr===nl){var hn=$r[nl];return hn?hn(qt()):zL}if(Ur in $r){var fr;ht(((fr=$r[Ur])===null||fr===void 0?void 0:fr.call($r,qt(),null))||null)}return Ur===rp&&vt!==yu&&(Ae(qt()),U>0&&(clearTimeout(Pt.current),Pt.current=setTimeout(function(){Qt({deadline:!0})},U))),Ur===TL&&cr(),gj}),wt=Sr(pn,2),Pr=wt[0],Ur=wt[1],Un=LL(Ur);or.current=Un;var ar=$.useRef(null);RL(function(){if(!(At.current&&ar.current===r)){Ct(r);var Xr=At.current;At.current=!0;var hn;!Xr&&r&&i&&(hn=lv),Xr&&r&&x&&(hn=cv),(Xr&&!r&&N||!Xr&&q&&!r&&N)&&(hn=uv);var fr=Lr(hn);hn&&(e||fr[nl])?(ct(hn),Pr()):ct(yu),ar.current=r}},[r]),$.useEffect(function(){(vt===lv&&!i||vt===cv&&!x||vt===uv&&!N)&&ct(yu)},[i,x,N]),$.useEffect(function(){return function(){At.current=!1,clearTimeout(Pt.current)}},[]);var tn=$.useRef(!1);$.useEffect(function(){Je&&(tn.current=!0),Je!==void 0&&vt===yu&&((tn.current||Je)&&(Ne==null||Ne(Je)),tn.current=!0)},[Je,vt]);var Ln=tt;return $r[nl]&&Ur===tp&&(Ln=Ft({transition:"none"},Ln)),[vt,Ur,Ln,Je??r]}function vj(e){var r=e;ln(e)==="object"&&(r=e.transitionSupport);function a(d,x){return!!(d.motionName&&r&&x!==!1)}var c=$.forwardRef(function(d,x){var T=d.visible,i=T===void 0?!0:T,L=d.removeOnLeave,N=L===void 0?!0:L,U=d.forceRender,q=d.children,X=d.motionName,se=d.leavedClassName,ce=d.eventProps,ue=$.useContext(EL),fe=ue.motion,re=a(d,fe),ee=$.useRef(),ae=$.useRef();function ve(){try{return ee.current instanceof HTMLElement?ee.current:Pv(ae.current)}catch{return null}}var Te=yj(re,i,ve,d),pe=Sr(Te,4),Ee=pe[0],Ne=pe[1],Xe=pe[2],Fe=pe[3],Je=$.useRef(Fe);Fe&&(Je.current=!0);var Ct=$.useCallback(function(Ke){ee.current=Ke,_E(x,Ke)},[x]),ft,yt=Ft(Ft({},ce),{},{visible:i});if(!q)ft=null;else if(Ee===yu)Fe?ft=q(Ft({},yt),Ct):!N&&Je.current&&se?ft=q(Ft(Ft({},yt),{},{className:se}),Ct):U||!N&&!se?ft=q(Ft(Ft({},yt),{},{style:{display:"none"}}),Ct):ft=null;else{var lt;Ne===nl?lt="prepare":LL(Ne)?lt="active":Ne===tp&&(lt="start");var ct=T5(X,"".concat(Ee,"-").concat(lt));ft=q(Ft(Ft({},yt),{},{className:Mr(T5(X,Ee),Et(Et({},ct,ct&&lt),X,typeof X=="string")),style:Xe}),Ct)}if($.isValidElement(ft)&&Ap(ft)){var Ye=O_(ft);Ye||(ft=$.cloneElement(ft,{ref:Ct}))}return $.createElement(sj,{ref:ae},ft)});return c.displayName="CSSMotion",c}const zp=vj(AL);var XS="add",YS="keep",KS="remove",n2="removed";function xj(e){var r;return e&&ln(e)==="object"&&"key"in e?r=e:r={key:e},Ft(Ft({},r),{},{key:String(r.key)})}function JS(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return e.map(xj)}function bj(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=[],c=0,d=r.length,x=JS(e),T=JS(r);x.forEach(function(N){for(var U=!1,q=c;q<d;q+=1){var X=T[q];if(X.key===N.key){c<q&&(a=a.concat(T.slice(c,q).map(function(se){return Ft(Ft({},se),{},{status:XS})})),c=q),a.push(Ft(Ft({},X),{},{status:YS})),c+=1,U=!0;break}}U||a.push(Ft(Ft({},N),{},{status:KS}))}),c<d&&(a=a.concat(T.slice(c).map(function(N){return Ft(Ft({},N),{},{status:XS})})));var i={};a.forEach(function(N){var U=N.key;i[U]=(i[U]||0)+1});var L=Object.keys(i).filter(function(N){return i[N]>1});return L.forEach(function(N){a=a.filter(function(U){var q=U.key,X=U.status;return q!==N||X!==KS}),a.forEach(function(U){U.key===N&&(U.status=YS)})}),a}var wj=["component","children","onVisibleChanged","onAllRemoved"],Sj=["status"],Ej=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function Tj(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:zp,a=function(c){Hu(x,c);var d=Wu(x);function x(){var T;Ao(this,x);for(var i=arguments.length,L=new Array(i),N=0;N<i;N++)L[N]=arguments[N];return T=d.call.apply(d,[this].concat(L)),Et(Sn(T),"state",{keyEntities:[]}),Et(Sn(T),"removeKey",function(U){T.setState(function(q){var X=q.keyEntities.map(function(se){return se.key!==U?se:Ft(Ft({},se),{},{status:n2})});return{keyEntities:X}},function(){var q=T.state.keyEntities,X=q.filter(function(se){var ce=se.status;return ce!==n2}).length;X===0&&T.props.onAllRemoved&&T.props.onAllRemoved()})}),T}return Ro(x,[{key:"render",value:function(){var i=this,L=this.state.keyEntities,N=this.props,U=N.component,q=N.children,X=N.onVisibleChanged;N.onAllRemoved;var se=is(N,wj),ce=U||$.Fragment,ue={};return Ej.forEach(function(fe){ue[fe]=se[fe],delete se[fe]}),delete se.keys,$.createElement(ce,se,L.map(function(fe,re){var ee=fe.status,ae=is(fe,Sj),ve=ee===XS||ee===YS;return $.createElement(r,Po({},ue,{key:ae.key,visible:ve,eventProps:ae,onVisibleChanged:function(pe){X==null||X(pe,{key:ae.key}),pe||i.removeKey(ae.key)}}),function(Te,pe){return q(Ft(Ft({},Te),{},{index:re}),pe)})}))}}],[{key:"getDerivedStateFromProps",value:function(i,L){var N=i.keys,U=L.keyEntities,q=JS(N),X=bj(U,q);return{keyEntities:X.filter(function(se){var ce=U.find(function(ue){var fe=ue.key;return se.key===fe});return!(ce&&ce.status===n2&&se.status===KS)})}}}]),x}($.Component);return Et(a,"defaultProps",{component:"div"}),a}const Cj=Tj(AL);function Mj(e){const{children:r}=e,[,a]=$l(),{motion:c}=a,d=$.useRef(!1);return d.current=d.current||c===!1,d.current?$.createElement(aj,{motion:c},r):r}const Ij=()=>null;var Pj=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};const Aj=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"];let kL;function Rj(){return kL||b_}function zj(e){return Object.keys(e).some(r=>r.endsWith("Color"))}const Lj=e=>{const{prefixCls:r,iconPrefixCls:a,theme:c,holderRender:d}=e;r!==void 0&&(kL=r),c&&zj(c)&&M9(Rj(),c)},kj=e=>{const{children:r,csp:a,autoInsertSpaceInButton:c,alert:d,anchor:x,form:T,locale:i,componentSize:L,direction:N,space:U,splitter:q,virtual:X,dropdownMatchSelectWidth:se,popupMatchSelectWidth:ce,popupOverflow:ue,legacyLocale:fe,parentContext:re,iconPrefixCls:ee,theme:ae,componentDisabled:ve,segmented:Te,statistic:pe,spin:Ee,calendar:Ne,carousel:Xe,cascader:Fe,collapse:Je,typography:Ct,checkbox:ft,descriptions:yt,divider:lt,drawer:ct,skeleton:Ye,steps:Ke,image:tt,layout:ht,list:vt,mentions:At,modal:Pt,progress:qt,result:or,slider:cr,breadcrumb:Qt,menu:qr,pagination:yr,input:Ae,textArea:Lr,empty:$r,badge:pn,radio:wt,rate:Pr,switch:Ur,transfer:Un,avatar:ar,message:tn,tag:Ln,table:Xr,card:hn,tabs:fr,timeline:Jt,timePicker:bn,upload:gn,notification:Kn,tree:dn,colorPicker:di,datePicker:Ui,rangePicker:Ji,flex:nn,wave:En,dropdown:Jn,warning:zo,tour:_i,floatButtonGroup:bi,variant:gr,inputNumber:Gi,treeSelect:Lo}=e,li=$.useCallback((de,xe)=>{const{prefixCls:ke}=e;if(xe)return xe;const ze=ke||re.getPrefixCls("");return de?`${ze}-${de}`:ze},[re.getPrefixCls,e.prefixCls]),Hi=ee||re.iconPrefixCls||zE,fi=a||re.csp;Q9(Hi,fi);const pi=ij(ae,re.theme,{prefixCls:li("")}),Wi={csp:fi,autoInsertSpaceInButton:c,alert:d,anchor:x,locale:i||fe,direction:N,space:U,splitter:q,virtual:X,popupMatchSelectWidth:ce??se,popupOverflow:ue,getPrefixCls:li,iconPrefixCls:Hi,theme:pi,segmented:Te,statistic:pe,spin:Ee,calendar:Ne,carousel:Xe,cascader:Fe,collapse:Je,typography:Ct,checkbox:ft,descriptions:yt,divider:lt,drawer:ct,skeleton:Ye,steps:Ke,image:tt,input:Ae,textArea:Lr,layout:ht,list:vt,mentions:At,modal:Pt,progress:qt,result:or,slider:cr,breadcrumb:Qt,menu:qr,pagination:yr,empty:$r,badge:pn,radio:wt,rate:Pr,switch:Ur,transfer:Un,avatar:ar,message:tn,tag:Ln,table:Xr,card:hn,tabs:fr,timeline:Jt,timePicker:bn,upload:gn,notification:Kn,tree:dn,colorPicker:di,datePicker:Ui,rangePicker:Ji,flex:nn,wave:En,dropdown:Jn,warning:zo,tour:_i,floatButtonGroup:bi,variant:gr,inputNumber:Gi,treeSelect:Lo},Bn=Object.assign({},re);Object.keys(Wi).forEach(de=>{Wi[de]!==void 0&&(Bn[de]=Wi[de])}),Aj.forEach(de=>{const xe=e[de];xe&&(Bn[de]=xe)}),typeof c<"u"&&(Bn.button=Object.assign({autoInsertSpace:c},Bn.button));const it=gE(()=>Bn,Bn,(de,xe)=>{const ke=Object.keys(de),ze=Object.keys(xe);return ke.length!==ze.length||ke.some(He=>de[He]!==xe[He])}),te=$.useMemo(()=>({prefixCls:Hi,csp:fi}),[Hi,fi]);let le=$.createElement($.Fragment,null,$.createElement(Ij,{dropdownMatchSelectWidth:se}),r);const K=$.useMemo(()=>{var de,xe,ke,ze;return ep(((de=rd.Form)===null||de===void 0?void 0:de.defaultValidateMessages)||{},((ke=(xe=it.locale)===null||xe===void 0?void 0:xe.Form)===null||ke===void 0?void 0:ke.defaultValidateMessages)||{},((ze=it.form)===null||ze===void 0?void 0:ze.validateMessages)||{},(T==null?void 0:T.validateMessages)||{})},[it,T==null?void 0:T.validateMessages]);Object.keys(K).length>0&&(le=$.createElement(sL.Provider,{value:K},le)),i&&(le=$.createElement(JN,{locale:i,_ANT_MARK__:YN},le)),(Hi||fi)&&(le=$.createElement(ME.Provider,{value:te},le)),L&&(le=$.createElement(I9,{size:L},le)),le=$.createElement(Mj,null,le);const he=$.useMemo(()=>{const de=pi||{},{algorithm:xe,token:ke,components:ze,cssVar:He}=de,Ue=Pj(de,["algorithm","token","components","cssVar"]),Ze=xe&&(!Array.isArray(xe)||xe.length>0)?__(xe):mL,ot={};Object.entries(ze||{}).forEach(St=>{let[Ut,tr]=St;const Gt=Object.assign({},tr);"algorithm"in Gt&&(Gt.algorithm===!0?Gt.theme=Ze:(Array.isArray(Gt.algorithm)||typeof Gt.algorithm=="function")&&(Gt.theme=__(Gt.algorithm)),delete Gt.algorithm),ot[Ut]=Gt});const pt=Object.assign(Object.assign({},Sp),ke);return Object.assign(Object.assign({},Ue),{theme:Ze,token:pt,components:ot,override:Object.assign({override:pt},ot),cssVar:He})},[pi]);return ae&&(le=$.createElement(RE.Provider,{value:he},le)),it.warning&&(le=$.createElement(NN.Provider,{value:it.warning},le)),ve!==void 0&&(le=$.createElement(gL,{disabled:ve},le)),$.createElement(Yn.Provider,{value:it},le)},Lp=e=>{const r=$.useContext(Yn),a=$.useContext(PE);return $.createElement(kj,Object.assign({parentContext:r,legacyLocale:a},e))};Lp.ConfigContext=Yn;Lp.SizeContext=N_;Lp.config=Lj;Lp.useConfig=P9;Object.defineProperty(Lp,"SizeContext",{get:()=>N_});const Dj=Lp;var Oj={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"};const Fj=Oj;function DL(e){var r;return e==null||(r=e.getRootNode)===null||r===void 0?void 0:r.call(e)}function Bj(e){return DL(e)instanceof ShadowRoot}function f1(e){return Bj(e)?DL(e):null}function Nj(e){return e.replace(/-(.)/g,function(r,a){return a.toUpperCase()})}function jj(e,r){es(e,"[@ant-design/icons] ".concat(r))}function C5(e){return ln(e)==="object"&&typeof e.name=="string"&&typeof e.theme=="string"&&(ln(e.icon)==="object"||typeof e.icon=="function")}function M5(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(e).reduce(function(r,a){var c=e[a];switch(a){case"class":r.className=c,delete r.class;break;default:delete r[a],r[Nj(a)]=c}return r},{})}function QS(e,r,a){return a?sn.createElement(e.tag,Ft(Ft({key:r},M5(e.attrs)),a),(e.children||[]).map(function(c,d){return QS(c,"".concat(r,"-").concat(e.tag,"-").concat(d))})):sn.createElement(e.tag,Ft({key:r},M5(e.attrs)),(e.children||[]).map(function(c,d){return QS(c,"".concat(r,"-").concat(e.tag,"-").concat(d))}))}function OL(e){return nd(e)[0]}function FL(e){return e?Array.isArray(e)?e:[e]:[]}var $j=`
.anticon {
  display: inline-flex;
  align-items: center;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,Vj=function(r){var a=$.useContext(ME),c=a.csp,d=a.prefixCls,x=$j;d&&(x=x.replace(/anticon/g,d)),$.useEffect(function(){var T=r.current,i=f1(T);bc(x,"@ant-design-icons",{prepend:!0,csp:c,attachTo:i})},[])},Uj=["icon","className","onClick","style","primaryColor","secondaryColor"],Wg={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function Gj(e){var r=e.primaryColor,a=e.secondaryColor;Wg.primaryColor=r,Wg.secondaryColor=a||OL(r),Wg.calculated=!!a}function Hj(){return Ft({},Wg)}var tx=function(r){var a=r.icon,c=r.className,d=r.onClick,x=r.style,T=r.primaryColor,i=r.secondaryColor,L=is(r,Uj),N=$.useRef(),U=Wg;if(T&&(U={primaryColor:T,secondaryColor:i||OL(T)}),Vj(N),jj(C5(a),"icon should be icon definiton, but got ".concat(a)),!C5(a))return null;var q=a;return q&&typeof q.icon=="function"&&(q=Ft(Ft({},q),{},{icon:q.icon(U.primaryColor,U.secondaryColor)})),QS(q.icon,"svg-".concat(q.name),Ft(Ft({className:c,onClick:d,style:x,"data-icon":q.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},L),{},{ref:N}))};tx.displayName="IconReact";tx.getTwoToneColors=Hj;tx.setTwoToneColors=Gj;const OE=tx;function BL(e){var r=FL(e),a=Sr(r,2),c=a[0],d=a[1];return OE.setTwoToneColors({primaryColor:c,secondaryColor:d})}function Wj(){var e=OE.getTwoToneColors();return e.calculated?[e.primaryColor,e.secondaryColor]:e.primaryColor}var qj=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];BL(h1.primary);var rx=$.forwardRef(function(e,r){var a=e.className,c=e.icon,d=e.spin,x=e.rotate,T=e.tabIndex,i=e.onClick,L=e.twoToneColor,N=is(e,qj),U=$.useContext(ME),q=U.prefixCls,X=q===void 0?"anticon":q,se=U.rootClassName,ce=Mr(se,X,Et(Et({},"".concat(X,"-").concat(c.name),!!c.name),"".concat(X,"-spin"),!!d||c.name==="loading"),a),ue=T;ue===void 0&&i&&(ue=-1);var fe=x?{msTransform:"rotate(".concat(x,"deg)"),transform:"rotate(".concat(x,"deg)")}:void 0,re=FL(L),ee=Sr(re,2),ae=ee[0],ve=ee[1];return $.createElement("span",Po({role:"img","aria-label":c.name},N,{ref:r,tabIndex:ue,onClick:i,className:ce}),$.createElement(OE,{icon:c,primaryColor:ae,secondaryColor:ve,style:fe}))});rx.displayName="AntdIcon";rx.getTwoToneColor=Wj;rx.setTwoToneColor=BL;const kp=rx;var Zj=function(r,a){return $.createElement(kp,Po({},r,{ref:a,icon:Fj}))},Xj=$.forwardRef(Zj);const NL=Xj;var Yj={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"};const Kj=Yj;var Jj=function(r,a){return $.createElement(kp,Po({},r,{ref:a,icon:Kj}))},Qj=$.forwardRef(Jj);const jL=Qj;var e$={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"};const t$=e$;var r$=function(r,a){return $.createElement(kp,Po({},r,{ref:a,icon:t$}))},n$=$.forwardRef(r$);const $L=n$;var i$=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,o$=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,a$="".concat(i$," ").concat(o$).split(/[\s\n]+/),s$="aria-",l$="data-";function I5(e,r){return e.indexOf(r)===0}function c$(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a;r===!1?a={aria:!0,data:!0,attr:!0}:r===!0?a={aria:!0}:a=Ft({},r);var c={};return Object.keys(e).forEach(function(d){(a.aria&&(d==="role"||I5(d,s$))||a.data&&I5(d,l$)||a.attr&&a$.includes(d))&&(c[d]=e[d])}),c}function VL(e){return e&&sn.isValidElement(e)&&e.type===sn.Fragment}const u$=(e,r,a)=>sn.isValidElement(e)?sn.cloneElement(e,typeof a=="function"?a(e.props||{}):a):r;function j_(e,r){return u$(e,e,r)}const P5=e=>typeof e=="object"&&e!=null&&e.nodeType===1,A5=(e,r)=>(!r||e!=="hidden")&&e!=="visible"&&e!=="clip",i2=(e,r)=>{if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){const a=getComputedStyle(e,null);return A5(a.overflowY,r)||A5(a.overflowX,r)||(c=>{const d=(x=>{if(!x.ownerDocument||!x.ownerDocument.defaultView)return null;try{return x.ownerDocument.defaultView.frameElement}catch{return null}})(c);return!!d&&(d.clientHeight<c.scrollHeight||d.clientWidth<c.scrollWidth)})(e)}return!1},dv=(e,r,a,c,d,x,T,i)=>x<e&&T>r||x>e&&T<r?0:x<=e&&i<=a||T>=r&&i>=a?x-e-c:T>r&&i<a||x<e&&i>a?T-r+d:0,h$=e=>{const r=e.parentElement;return r??(e.getRootNode().host||null)},R5=(e,r)=>{var a,c,d,x;if(typeof document>"u")return[];const{scrollMode:T,block:i,inline:L,boundary:N,skipOverflowHiddenElements:U}=r,q=typeof N=="function"?N:ct=>ct!==N;if(!P5(e))throw new TypeError("Invalid target");const X=document.scrollingElement||document.documentElement,se=[];let ce=e;for(;P5(ce)&&q(ce);){if(ce=h$(ce),ce===X){se.push(ce);break}ce!=null&&ce===document.body&&i2(ce)&&!i2(document.documentElement)||ce!=null&&i2(ce,U)&&se.push(ce)}const ue=(c=(a=window.visualViewport)==null?void 0:a.width)!=null?c:innerWidth,fe=(x=(d=window.visualViewport)==null?void 0:d.height)!=null?x:innerHeight,{scrollX:re,scrollY:ee}=window,{height:ae,width:ve,top:Te,right:pe,bottom:Ee,left:Ne}=e.getBoundingClientRect(),{top:Xe,right:Fe,bottom:Je,left:Ct}=(ct=>{const Ye=window.getComputedStyle(ct);return{top:parseFloat(Ye.scrollMarginTop)||0,right:parseFloat(Ye.scrollMarginRight)||0,bottom:parseFloat(Ye.scrollMarginBottom)||0,left:parseFloat(Ye.scrollMarginLeft)||0}})(e);let ft=i==="start"||i==="nearest"?Te-Xe:i==="end"?Ee+Je:Te+ae/2-Xe+Je,yt=L==="center"?Ne+ve/2-Ct+Fe:L==="end"?pe+Fe:Ne-Ct;const lt=[];for(let ct=0;ct<se.length;ct++){const Ye=se[ct],{height:Ke,width:tt,top:ht,right:vt,bottom:At,left:Pt}=Ye.getBoundingClientRect();if(T==="if-needed"&&Te>=0&&Ne>=0&&Ee<=fe&&pe<=ue&&Te>=ht&&Ee<=At&&Ne>=Pt&&pe<=vt)return lt;const qt=getComputedStyle(Ye),or=parseInt(qt.borderLeftWidth,10),cr=parseInt(qt.borderTopWidth,10),Qt=parseInt(qt.borderRightWidth,10),qr=parseInt(qt.borderBottomWidth,10);let yr=0,Ae=0;const Lr="offsetWidth"in Ye?Ye.offsetWidth-Ye.clientWidth-or-Qt:0,$r="offsetHeight"in Ye?Ye.offsetHeight-Ye.clientHeight-cr-qr:0,pn="offsetWidth"in Ye?Ye.offsetWidth===0?0:tt/Ye.offsetWidth:0,wt="offsetHeight"in Ye?Ye.offsetHeight===0?0:Ke/Ye.offsetHeight:0;if(X===Ye)yr=i==="start"?ft:i==="end"?ft-fe:i==="nearest"?dv(ee,ee+fe,fe,cr,qr,ee+ft,ee+ft+ae,ae):ft-fe/2,Ae=L==="start"?yt:L==="center"?yt-ue/2:L==="end"?yt-ue:dv(re,re+ue,ue,or,Qt,re+yt,re+yt+ve,ve),yr=Math.max(0,yr+ee),Ae=Math.max(0,Ae+re);else{yr=i==="start"?ft-ht-cr:i==="end"?ft-At+qr+$r:i==="nearest"?dv(ht,At,Ke,cr,qr+$r,ft,ft+ae,ae):ft-(ht+Ke/2)+$r/2,Ae=L==="start"?yt-Pt-or:L==="center"?yt-(Pt+tt/2)+Lr/2:L==="end"?yt-vt+Qt+Lr:dv(Pt,vt,tt,or,Qt+Lr,yt,yt+ve,ve);const{scrollLeft:Pr,scrollTop:Ur}=Ye;yr=wt===0?0:Math.max(0,Math.min(Ur+yr/wt,Ye.scrollHeight-Ke/wt+$r)),Ae=pn===0?0:Math.max(0,Math.min(Pr+Ae/pn,Ye.scrollWidth-tt/pn+Lr)),ft+=Ur-yr,yt+=Pr-Ae}lt.push({el:Ye,top:yr,left:Ae})}return lt},d$=e=>e===!1?{block:"end",inline:"nearest"}:(r=>r===Object(r)&&Object.keys(r).length!==0)(e)?e:{block:"start",inline:"nearest"};function f$(e,r){if(!e.isConnected||!(d=>{let x=d;for(;x&&x.parentNode;){if(x.parentNode===document)return!0;x=x.parentNode instanceof ShadowRoot?x.parentNode.host:x.parentNode}return!1})(e))return;const a=(d=>{const x=window.getComputedStyle(d);return{top:parseFloat(x.scrollMarginTop)||0,right:parseFloat(x.scrollMarginRight)||0,bottom:parseFloat(x.scrollMarginBottom)||0,left:parseFloat(x.scrollMarginLeft)||0}})(e);if((d=>typeof d=="object"&&typeof d.behavior=="function")(r))return r.behavior(R5(e,r));const c=typeof r=="boolean"||r==null?void 0:r.behavior;for(const{el:d,top:x,left:T}of R5(e,d$(r))){const i=x-a.top+a.bottom,L=T-a.left+a.right;d.scroll({top:i,left:L,behavior:c})}}const p$=e=>{const[,,,,r]=$l();return r?`${e}-css-var`:""},hd=p$;var m$={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"};const g$=m$;var _$=function(r,a){return $.createElement(kp,Po({},r,{ref:a,icon:g$}))},y$=$.forwardRef(_$);const FE=y$,v$=sn.createContext(void 0),UL=v$,Lh=100,GL={Modal:Lh,Drawer:Lh,Popover:Lh,Popconfirm:Lh,Tooltip:Lh,Tour:Lh,FloatButton:Lh},x$={SelectLike:50,Dropdown:50,DatePicker:50,Menu:50,ImagePreview:1};function b$(e){return e in GL}const w$=(e,r)=>{const[,a]=$l(),c=sn.useContext(UL),d=b$(e);let x;if(r!==void 0)x=[r,r];else{let T=c??0;d?T+=(c?0:a.zIndexPopupBase)+GL[e]:T+=x$[e],x=[c===void 0?r:T,T]}return x};function pa(){pa=function(){return r};var e,r={},a=Object.prototype,c=a.hasOwnProperty,d=Object.defineProperty||function(ct,Ye,Ke){ct[Ye]=Ke.value},x=typeof Symbol=="function"?Symbol:{},T=x.iterator||"@@iterator",i=x.asyncIterator||"@@asyncIterator",L=x.toStringTag||"@@toStringTag";function N(ct,Ye,Ke){return Object.defineProperty(ct,Ye,{value:Ke,enumerable:!0,configurable:!0,writable:!0}),ct[Ye]}try{N({},"")}catch{N=function(Ke,tt,ht){return Ke[tt]=ht}}function U(ct,Ye,Ke,tt){var ht=Ye&&Ye.prototype instanceof re?Ye:re,vt=Object.create(ht.prototype),At=new yt(tt||[]);return d(vt,"_invoke",{value:Fe(ct,Ke,At)}),vt}function q(ct,Ye,Ke){try{return{type:"normal",arg:ct.call(Ye,Ke)}}catch(tt){return{type:"throw",arg:tt}}}r.wrap=U;var X="suspendedStart",se="suspendedYield",ce="executing",ue="completed",fe={};function re(){}function ee(){}function ae(){}var ve={};N(ve,T,function(){return this});var Te=Object.getPrototypeOf,pe=Te&&Te(Te(lt([])));pe&&pe!==a&&c.call(pe,T)&&(ve=pe);var Ee=ae.prototype=re.prototype=Object.create(ve);function Ne(ct){["next","throw","return"].forEach(function(Ye){N(ct,Ye,function(Ke){return this._invoke(Ye,Ke)})})}function Xe(ct,Ye){function Ke(ht,vt,At,Pt){var qt=q(ct[ht],ct,vt);if(qt.type!=="throw"){var or=qt.arg,cr=or.value;return cr&&ln(cr)=="object"&&c.call(cr,"__await")?Ye.resolve(cr.__await).then(function(Qt){Ke("next",Qt,At,Pt)},function(Qt){Ke("throw",Qt,At,Pt)}):Ye.resolve(cr).then(function(Qt){or.value=Qt,At(or)},function(Qt){return Ke("throw",Qt,At,Pt)})}Pt(qt.arg)}var tt;d(this,"_invoke",{value:function(vt,At){function Pt(){return new Ye(function(qt,or){Ke(vt,At,qt,or)})}return tt=tt?tt.then(Pt,Pt):Pt()}})}function Fe(ct,Ye,Ke){var tt=X;return function(ht,vt){if(tt===ce)throw Error("Generator is already running");if(tt===ue){if(ht==="throw")throw vt;return{value:e,done:!0}}for(Ke.method=ht,Ke.arg=vt;;){var At=Ke.delegate;if(At){var Pt=Je(At,Ke);if(Pt){if(Pt===fe)continue;return Pt}}if(Ke.method==="next")Ke.sent=Ke._sent=Ke.arg;else if(Ke.method==="throw"){if(tt===X)throw tt=ue,Ke.arg;Ke.dispatchException(Ke.arg)}else Ke.method==="return"&&Ke.abrupt("return",Ke.arg);tt=ce;var qt=q(ct,Ye,Ke);if(qt.type==="normal"){if(tt=Ke.done?ue:se,qt.arg===fe)continue;return{value:qt.arg,done:Ke.done}}qt.type==="throw"&&(tt=ue,Ke.method="throw",Ke.arg=qt.arg)}}}function Je(ct,Ye){var Ke=Ye.method,tt=ct.iterator[Ke];if(tt===e)return Ye.delegate=null,Ke==="throw"&&ct.iterator.return&&(Ye.method="return",Ye.arg=e,Je(ct,Ye),Ye.method==="throw")||Ke!=="return"&&(Ye.method="throw",Ye.arg=new TypeError("The iterator does not provide a '"+Ke+"' method")),fe;var ht=q(tt,ct.iterator,Ye.arg);if(ht.type==="throw")return Ye.method="throw",Ye.arg=ht.arg,Ye.delegate=null,fe;var vt=ht.arg;return vt?vt.done?(Ye[ct.resultName]=vt.value,Ye.next=ct.nextLoc,Ye.method!=="return"&&(Ye.method="next",Ye.arg=e),Ye.delegate=null,fe):vt:(Ye.method="throw",Ye.arg=new TypeError("iterator result is not an object"),Ye.delegate=null,fe)}function Ct(ct){var Ye={tryLoc:ct[0]};1 in ct&&(Ye.catchLoc=ct[1]),2 in ct&&(Ye.finallyLoc=ct[2],Ye.afterLoc=ct[3]),this.tryEntries.push(Ye)}function ft(ct){var Ye=ct.completion||{};Ye.type="normal",delete Ye.arg,ct.completion=Ye}function yt(ct){this.tryEntries=[{tryLoc:"root"}],ct.forEach(Ct,this),this.reset(!0)}function lt(ct){if(ct||ct===""){var Ye=ct[T];if(Ye)return Ye.call(ct);if(typeof ct.next=="function")return ct;if(!isNaN(ct.length)){var Ke=-1,tt=function ht(){for(;++Ke<ct.length;)if(c.call(ct,Ke))return ht.value=ct[Ke],ht.done=!1,ht;return ht.value=e,ht.done=!0,ht};return tt.next=tt}}throw new TypeError(ln(ct)+" is not iterable")}return ee.prototype=ae,d(Ee,"constructor",{value:ae,configurable:!0}),d(ae,"constructor",{value:ee,configurable:!0}),ee.displayName=N(ae,L,"GeneratorFunction"),r.isGeneratorFunction=function(ct){var Ye=typeof ct=="function"&&ct.constructor;return!!Ye&&(Ye===ee||(Ye.displayName||Ye.name)==="GeneratorFunction")},r.mark=function(ct){return Object.setPrototypeOf?Object.setPrototypeOf(ct,ae):(ct.__proto__=ae,N(ct,L,"GeneratorFunction")),ct.prototype=Object.create(Ee),ct},r.awrap=function(ct){return{__await:ct}},Ne(Xe.prototype),N(Xe.prototype,i,function(){return this}),r.AsyncIterator=Xe,r.async=function(ct,Ye,Ke,tt,ht){ht===void 0&&(ht=Promise);var vt=new Xe(U(ct,Ye,Ke,tt),ht);return r.isGeneratorFunction(Ye)?vt:vt.next().then(function(At){return At.done?At.value:vt.next()})},Ne(Ee),N(Ee,L,"Generator"),N(Ee,T,function(){return this}),N(Ee,"toString",function(){return"[object Generator]"}),r.keys=function(ct){var Ye=Object(ct),Ke=[];for(var tt in Ye)Ke.push(tt);return Ke.reverse(),function ht(){for(;Ke.length;){var vt=Ke.pop();if(vt in Ye)return ht.value=vt,ht.done=!1,ht}return ht.done=!0,ht}},r.values=lt,yt.prototype={constructor:yt,reset:function(Ye){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(ft),!Ye)for(var Ke in this)Ke.charAt(0)==="t"&&c.call(this,Ke)&&!isNaN(+Ke.slice(1))&&(this[Ke]=e)},stop:function(){this.done=!0;var Ye=this.tryEntries[0].completion;if(Ye.type==="throw")throw Ye.arg;return this.rval},dispatchException:function(Ye){if(this.done)throw Ye;var Ke=this;function tt(or,cr){return At.type="throw",At.arg=Ye,Ke.next=or,cr&&(Ke.method="next",Ke.arg=e),!!cr}for(var ht=this.tryEntries.length-1;ht>=0;--ht){var vt=this.tryEntries[ht],At=vt.completion;if(vt.tryLoc==="root")return tt("end");if(vt.tryLoc<=this.prev){var Pt=c.call(vt,"catchLoc"),qt=c.call(vt,"finallyLoc");if(Pt&&qt){if(this.prev<vt.catchLoc)return tt(vt.catchLoc,!0);if(this.prev<vt.finallyLoc)return tt(vt.finallyLoc)}else if(Pt){if(this.prev<vt.catchLoc)return tt(vt.catchLoc,!0)}else{if(!qt)throw Error("try statement without catch or finally");if(this.prev<vt.finallyLoc)return tt(vt.finallyLoc)}}}},abrupt:function(Ye,Ke){for(var tt=this.tryEntries.length-1;tt>=0;--tt){var ht=this.tryEntries[tt];if(ht.tryLoc<=this.prev&&c.call(ht,"finallyLoc")&&this.prev<ht.finallyLoc){var vt=ht;break}}vt&&(Ye==="break"||Ye==="continue")&&vt.tryLoc<=Ke&&Ke<=vt.finallyLoc&&(vt=null);var At=vt?vt.completion:{};return At.type=Ye,At.arg=Ke,vt?(this.method="next",this.next=vt.finallyLoc,fe):this.complete(At)},complete:function(Ye,Ke){if(Ye.type==="throw")throw Ye.arg;return Ye.type==="break"||Ye.type==="continue"?this.next=Ye.arg:Ye.type==="return"?(this.rval=this.arg=Ye.arg,this.method="return",this.next="end"):Ye.type==="normal"&&Ke&&(this.next=Ke),fe},finish:function(Ye){for(var Ke=this.tryEntries.length-1;Ke>=0;--Ke){var tt=this.tryEntries[Ke];if(tt.finallyLoc===Ye)return this.complete(tt.completion,tt.afterLoc),ft(tt),fe}},catch:function(Ye){for(var Ke=this.tryEntries.length-1;Ke>=0;--Ke){var tt=this.tryEntries[Ke];if(tt.tryLoc===Ye){var ht=tt.completion;if(ht.type==="throw"){var vt=ht.arg;ft(tt)}return vt}}throw Error("illegal catch attempt")},delegateYield:function(Ye,Ke,tt){return this.delegate={iterator:lt(Ye),resultName:Ke,nextLoc:tt},this.method==="next"&&(this.arg=e),fe}},r}function z5(e,r,a,c,d,x,T){try{var i=e[x](T),L=i.value}catch(N){return void a(N)}i.done?r(L):Promise.resolve(L).then(c,d)}function dd(e){return function(){var r=this,a=arguments;return new Promise(function(c,d){var x=e.apply(r,a);function T(L){z5(x,c,d,T,i,"next",L)}function i(L){z5(x,c,d,T,i,"throw",L)}T(void 0)})}}var $_=Ft({},Ez),S$=$_.version,E$=$_.render,T$=$_.unmountComponentAtNode,nx;try{var C$=Number((S$||"").split(".")[0]);C$>=18&&(nx=$_.createRoot)}catch{}function L5(e){var r=$_.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;r&&ln(r)==="object"&&(r.usingClientEntryPoint=e)}var p1="__rc_react_root__";function M$(e,r){L5(!0);var a=r[p1]||nx(r);L5(!1),a.render(e),r[p1]=a}function I$(e,r){E$(e,r)}function k5(e,r){if(nx){M$(e,r);return}I$(e,r)}function P$(e){return e3.apply(this,arguments)}function e3(){return e3=dd(pa().mark(function e(r){return pa().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Promise.resolve().then(function(){var d;(d=r[p1])===null||d===void 0||d.unmount(),delete r[p1]}));case 1:case"end":return c.stop()}},e)})),e3.apply(this,arguments)}function A$(e){T$(e)}function R$(e){return t3.apply(this,arguments)}function t3(){return t3=dd(pa().mark(function e(r){return pa().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(nx===void 0){c.next=2;break}return c.abrupt("return",P$(r));case 2:A$(r);case 3:case"end":return c.stop()}},e)})),t3.apply(this,arguments)}const o2=()=>({height:0,opacity:0}),D5=e=>{const{scrollHeight:r}=e;return{height:r,opacity:1}},z$=e=>({height:e?e.offsetHeight:0}),a2=(e,r)=>(r==null?void 0:r.deadline)===!0||r.propertyName==="height",L$=function(){return{motionName:`${arguments.length>0&&arguments[0]!==void 0?arguments[0]:b_}-motion-collapse`,onAppearStart:o2,onEnterStart:o2,onAppearActive:D5,onEnterActive:D5,onLeaveStart:z$,onLeaveActive:o2,onAppearEnd:a2,onEnterEnd:a2,onLeaveEnd:a2,motionDeadline:500}},k$=(e,r,a)=>a!==void 0?a:`${e}-${r}`,O5=L$,BE=function(e){if(!e)return!1;if(e instanceof Element){if(e.offsetParent)return!0;if(e.getBBox){var r=e.getBBox(),a=r.width,c=r.height;if(a||c)return!0}if(e.getBoundingClientRect){var d=e.getBoundingClientRect(),x=d.width,T=d.height;if(x||T)return!0}}return!1},D$=e=>{const{componentCls:r,colorPrimary:a}=e;return{[r]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${a})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${e.motionEaseOutCirc}`,`opacity 2s ${e.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0},"&.wave-quick":{transition:[`box-shadow ${e.motionDurationSlow} ${e.motionEaseInOut}`,`opacity ${e.motionDurationSlow} ${e.motionEaseInOut}`].join(",")}}}}},O$=Y9("Wave",e=>[D$(e)]),ix=`${b_}-wave-target`;function s2(e){return e&&e!=="#fff"&&e!=="#ffffff"&&e!=="rgb(255, 255, 255)"&&e!=="rgba(255, 255, 255, 1)"&&!/rgba\((?:\d*, ){3}0\)/.test(e)&&e!=="transparent"}function F$(e){const{borderTopColor:r,borderColor:a,backgroundColor:c}=getComputedStyle(e);return s2(r)?r:s2(a)?a:s2(c)?c:null}function l2(e){return Number.isNaN(e)?0:e}const B$=e=>{const{className:r,target:a,component:c}=e,d=$.useRef(null),[x,T]=$.useState(null),[i,L]=$.useState([]),[N,U]=$.useState(0),[q,X]=$.useState(0),[se,ce]=$.useState(0),[ue,fe]=$.useState(0),[re,ee]=$.useState(!1),ae={left:N,top:q,width:se,height:ue,borderRadius:i.map(pe=>`${pe}px`).join(" ")};x&&(ae["--wave-color"]=x);function ve(){const pe=getComputedStyle(a);T(F$(a));const Ee=pe.position==="static",{borderLeftWidth:Ne,borderTopWidth:Xe}=pe;U(Ee?a.offsetLeft:l2(-parseFloat(Ne))),X(Ee?a.offsetTop:l2(-parseFloat(Xe))),ce(a.offsetWidth),fe(a.offsetHeight);const{borderTopLeftRadius:Fe,borderTopRightRadius:Je,borderBottomLeftRadius:Ct,borderBottomRightRadius:ft}=pe;L([Fe,Je,ft,Ct].map(yt=>l2(parseFloat(yt))))}if($.useEffect(()=>{if(a){const pe=fl(()=>{ve(),ee(!0)});let Ee;return typeof ResizeObserver<"u"&&(Ee=new ResizeObserver(ve),Ee.observe(a)),()=>{fl.cancel(pe),Ee==null||Ee.disconnect()}}},[]),!re)return null;const Te=(c==="Checkbox"||c==="Radio")&&(a==null?void 0:a.classList.contains(ix));return $.createElement(zp,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(pe,Ee)=>{var Ne;if(Ee.deadline||Ee.propertyName==="opacity"){const Xe=(Ne=d.current)===null||Ne===void 0?void 0:Ne.parentElement;R$(Xe).then(()=>{Xe==null||Xe.remove()})}return!1}},(pe,Ee)=>{let{className:Ne}=pe;return $.createElement("div",{ref:cd(d,Ee),className:Mr(r,Ne,{"wave-quick":Te}),style:ae})})},N$=(e,r)=>{var a;const{component:c}=r;if(!k5||c==="Checkbox"&&!(!((a=e.querySelector("input"))===null||a===void 0)&&a.checked))return;const d=document.createElement("div");d.style.position="absolute",d.style.left="0px",d.style.top="0px",e==null||e.insertBefore(d,e==null?void 0:e.firstChild),k5($.createElement(B$,Object.assign({},r,{target:e})),d)},j$=N$,$$=(e,r,a)=>{const{wave:c}=$.useContext(Yn),[,d,x]=$l(),T=Ka(N=>{const U=e.current;if(c!=null&&c.disabled||!U)return;const q=U.querySelector(`.${ix}`)||U,{showEffect:X}=c||{};(X||j$)(q,{className:r,token:d,component:a,event:N,hashId:x})}),i=$.useRef();return N=>{fl.cancel(i.current),i.current=fl(()=>{T(N)})}},V$=$$,U$=e=>{const{children:r,disabled:a,component:c}=e,{getPrefixCls:d}=$.useContext(Yn),x=$.useRef(null),T=d("wave"),[,i]=O$(T),L=V$(x,Mr(T,i),c);if(sn.useEffect(()=>{const U=x.current;if(!U||U.nodeType!==1||a)return;const q=X=>{!BE(X.target)||!U.getAttribute||U.getAttribute("disabled")||U.disabled||U.className.includes("disabled")||U.className.includes("-leave")||L(X)};return U.addEventListener("click",q,!0),()=>{U.removeEventListener("click",q,!0)}},[a]),!sn.isValidElement(r))return r??null;const N=Ap(r)?cd(O_(r),x):x;return j_(r,{ref:N})},NE=U$,G$=e=>{const r=sn.useContext(N_);return sn.useMemo(()=>e?typeof e=="string"?e??r:e instanceof Function?e(r):r:r,[e,r])},ox=G$,H$=e=>{const{componentCls:r}=e;return{[r]:{"&-block":{display:"flex",width:"100%"},"&-vertical":{flexDirection:"column"}}}},W$=H$,q$=e=>{const{componentCls:r,antCls:a}=e;return{[r]:{display:"inline-flex","&-rtl":{direction:"rtl"},"&-vertical":{flexDirection:"column"},"&-align":{flexDirection:"column","&-center":{alignItems:"center"},"&-start":{alignItems:"flex-start"},"&-end":{alignItems:"flex-end"},"&-baseline":{alignItems:"baseline"}},[`${r}-item:empty`]:{display:"none"},[`${r}-item > ${a}-badge-not-a-wrapper:only-child`]:{display:"block"}}}},Z$=e=>{const{componentCls:r}=e;return{[r]:{"&-gap-row-small":{rowGap:e.spaceGapSmallSize},"&-gap-row-middle":{rowGap:e.spaceGapMiddleSize},"&-gap-row-large":{rowGap:e.spaceGapLargeSize},"&-gap-col-small":{columnGap:e.spaceGapSmallSize},"&-gap-col-middle":{columnGap:e.spaceGapMiddleSize},"&-gap-col-large":{columnGap:e.spaceGapLargeSize}}}},HL=Ms("Space",e=>{const r=Wo(e,{spaceGapSmallSize:e.paddingXS,spaceGapMiddleSize:e.padding,spaceGapLargeSize:e.paddingLG});return[q$(r),Z$(r),W$(r)]},()=>({}),{resetStyle:!1});var WL=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};const ax=$.createContext(null),X$=(e,r)=>{const a=$.useContext(ax),c=$.useMemo(()=>{if(!a)return"";const{compactDirection:d,isFirstItem:x,isLastItem:T}=a,i=d==="vertical"?"-vertical-":"-";return Mr(`${e}-compact${i}item`,{[`${e}-compact${i}first-item`]:x,[`${e}-compact${i}last-item`]:T,[`${e}-compact${i}item-rtl`]:r==="rtl"})},[e,r,a]);return{compactSize:a==null?void 0:a.compactSize,compactDirection:a==null?void 0:a.compactDirection,compactItemClassnames:c}},Y$=e=>{let{children:r}=e;return $.createElement(ax.Provider,{value:null},r)},K$=e=>{var{children:r}=e,a=WL(e,["children"]);return $.createElement(ax.Provider,{value:a},r)},J$=e=>{const{getPrefixCls:r,direction:a}=$.useContext(Yn),{size:c,direction:d,block:x,prefixCls:T,className:i,rootClassName:L,children:N}=e,U=WL(e,["size","direction","block","prefixCls","className","rootClassName","children"]),q=ox(ae=>c??ae),X=r("space-compact",T),[se,ce]=HL(X),ue=Mr(X,ce,{[`${X}-rtl`]:a==="rtl",[`${X}-block`]:x,[`${X}-vertical`]:d==="vertical"},i,L),fe=$.useContext(ax),re=Yh(N),ee=$.useMemo(()=>re.map((ae,ve)=>{const Te=(ae==null?void 0:ae.key)||`${X}-item-${ve}`;return $.createElement(K$,{key:Te,compactSize:q,compactDirection:d,isFirstItem:ve===0&&(!fe||(fe==null?void 0:fe.isFirstItem)),isLastItem:ve===re.length-1&&(!fe||(fe==null?void 0:fe.isLastItem))},ae)}),[c,re,fe]);return re.length===0?null:se($.createElement("div",Object.assign({className:ue},U),ee))};var Q$=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};const qL=$.createContext(void 0),eV=e=>{const{getPrefixCls:r,direction:a}=$.useContext(Yn),{prefixCls:c,size:d,className:x}=e,T=Q$(e,["prefixCls","size","className"]),i=r("btn-group",c),[,,L]=$l();let N="";switch(d){case"large":N="lg";break;case"small":N="sm";break}const U=Mr(i,{[`${i}-${N}`]:N,[`${i}-rtl`]:a==="rtl"},x,L);return $.createElement(qL.Provider,{value:d},$.createElement("div",Object.assign({},T,{className:U})))},tV=eV,F5=/^[\u4E00-\u9FA5]{2}$/,r3=F5.test.bind(F5);function B5(e){return typeof e=="string"}function c2(e){return e==="text"||e==="link"}function rV(e,r){if(e==null)return;const a=r?" ":"";return typeof e!="string"&&typeof e!="number"&&B5(e.type)&&r3(e.props.children)?j_(e,{children:e.props.children.split("").join(a)}):B5(e)?r3(e)?sn.createElement("span",null,e.split("").join(a)):sn.createElement("span",null,e):VL(e)?sn.createElement("span",null,e):e}function nV(e,r){let a=!1;const c=[];return sn.Children.forEach(e,d=>{const x=typeof d,T=x==="string"||x==="number";if(a&&T){const i=c.length-1,L=c[i];c[i]=`${L}${d}`}else c.push(d);a=T}),sn.Children.map(c,d=>rV(d,r))}const iV=$.forwardRef((e,r)=>{const{className:a,style:c,children:d,prefixCls:x}=e,T=Mr(`${x}-icon`,a);return sn.createElement("span",{ref:r,className:T,style:c},d)}),ZL=iV,N5=$.forwardRef((e,r)=>{const{prefixCls:a,className:c,style:d,iconClassName:x}=e,T=Mr(`${a}-loading-icon`,c);return sn.createElement(ZL,{prefixCls:a,className:T,style:d,ref:r},sn.createElement(FE,{className:x}))}),u2=()=>({width:0,opacity:0,transform:"scale(0)"}),h2=e=>({width:e.scrollWidth,opacity:1,transform:"scale(1)"}),oV=e=>{const{prefixCls:r,loading:a,existIcon:c,className:d,style:x}=e,T=!!a;return c?sn.createElement(N5,{prefixCls:r,className:d,style:x}):sn.createElement(zp,{visible:T,motionName:`${r}-loading-icon-motion`,motionLeave:T,removeOnLeave:!0,onAppearStart:u2,onAppearActive:h2,onEnterStart:u2,onEnterActive:h2,onLeaveStart:h2,onLeaveActive:u2},(i,L)=>{let{className:N,style:U}=i;return sn.createElement(N5,{prefixCls:r,className:d,style:Object.assign(Object.assign({},x),U),ref:L,iconClassName:N})})},aV=oV,j5=(e,r)=>({[`> span, > ${e}`]:{"&:not(:last-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineEndColor:r}}},"&:not(:first-child)":{[`&, & > ${e}`]:{"&:not(:disabled)":{borderInlineStartColor:r}}}}}),sV=e=>{const{componentCls:r,fontSize:a,lineWidth:c,groupBorderColor:d,colorErrorHover:x}=e;return{[`${r}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${r}`]:{"&:not(:last-child)":{[`&, & > ${r}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:e.calc(c).mul(-1).equal(),[`&, & > ${r}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[r]:{position:"relative",zIndex:1,"&:hover, &:focus, &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${r}-icon-only`]:{fontSize:a}},j5(`${r}-primary`,d),j5(`${r}-danger`,x)]}},lV=sV,Eo=Math.round;function d2(e,r){const a=e.replace(/^[^(]*\((.*)/,"$1").replace(/\).*/,"").match(/\d*\.?\d+%?/g)||[],c=a.map(d=>parseFloat(d));for(let d=0;d<3;d+=1)c[d]=r(c[d]||0,a[d]||"",d);return a[3]?c[3]=a[3].includes("%")?c[3]/100:c[3]:c[3]=1,c}const $5=(e,r,a)=>a===0?e:e/100;function Eg(e,r){const a=r||255;return e>a?a:e<0?0:e}class sx{constructor(r){Et(this,"isValid",!0),Et(this,"r",0),Et(this,"g",0),Et(this,"b",0),Et(this,"a",1),Et(this,"_h",void 0),Et(this,"_s",void 0),Et(this,"_l",void 0),Et(this,"_v",void 0),Et(this,"_max",void 0),Et(this,"_min",void 0),Et(this,"_brightness",void 0);function a(d){return d[0]in r&&d[1]in r&&d[2]in r}if(r)if(typeof r=="string"){let x=function(T){return d.startsWith(T)};var c=x;const d=r.trim();/^#?[A-F\d]{3,8}$/i.test(d)?this.fromHexString(d):x("rgb")?this.fromRgbString(d):x("hsl")?this.fromHslString(d):(x("hsv")||x("hsb"))&&this.fromHsvString(d)}else if(r instanceof sx)this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this._h=r._h,this._s=r._s,this._l=r._l,this._v=r._v;else if(a("rgb"))this.r=Eg(r.r),this.g=Eg(r.g),this.b=Eg(r.b),this.a=typeof r.a=="number"?Eg(r.a,1):1;else if(a("hsl"))this.fromHsl(r);else if(a("hsv"))this.fromHsv(r);else throw new Error("@ant-design/fast-color: unsupported input "+JSON.stringify(r))}setR(r){return this._sc("r",r)}setG(r){return this._sc("g",r)}setB(r){return this._sc("b",r)}setA(r){return this._sc("a",r,1)}setHue(r){const a=this.toHsv();return a.h=r,this._c(a)}getLuminance(){function r(x){const T=x/255;return T<=.03928?T/12.92:Math.pow((T+.055)/1.055,2.4)}const a=r(this.r),c=r(this.g),d=r(this.b);return .2126*a+.7152*c+.0722*d}getHue(){if(typeof this._h>"u"){const r=this.getMax()-this.getMin();r===0?this._h=0:this._h=Eo(60*(this.r===this.getMax()?(this.g-this.b)/r+(this.g<this.b?6:0):this.g===this.getMax()?(this.b-this.r)/r+2:(this.r-this.g)/r+4))}return this._h}getSaturation(){if(typeof this._s>"u"){const r=this.getMax()-this.getMin();r===0?this._s=0:this._s=r/this.getMax()}return this._s}getLightness(){return typeof this._l>"u"&&(this._l=(this.getMax()+this.getMin())/510),this._l}getValue(){return typeof this._v>"u"&&(this._v=this.getMax()/255),this._v}getBrightness(){return typeof this._brightness>"u"&&(this._brightness=(this.r*299+this.g*587+this.b*114)/1e3),this._brightness}darken(r=10){const a=this.getHue(),c=this.getSaturation();let d=this.getLightness()-r/100;return d<0&&(d=0),this._c({h:a,s:c,l:d,a:this.a})}lighten(r=10){const a=this.getHue(),c=this.getSaturation();let d=this.getLightness()+r/100;return d>1&&(d=1),this._c({h:a,s:c,l:d,a:this.a})}mix(r,a=50){const c=this._c(r),d=a/100,x=i=>(c[i]-this[i])*d+this[i],T={r:Eo(x("r")),g:Eo(x("g")),b:Eo(x("b")),a:Eo(x("a")*100)/100};return this._c(T)}tint(r=10){return this.mix({r:255,g:255,b:255,a:1},r)}shade(r=10){return this.mix({r:0,g:0,b:0,a:1},r)}onBackground(r){const a=this._c(r),c=this.a+a.a*(1-this.a),d=x=>Eo((this[x]*this.a+a[x]*a.a*(1-this.a))/c);return this._c({r:d("r"),g:d("g"),b:d("b"),a:c})}isDark(){return this.getBrightness()<128}isLight(){return this.getBrightness()>=128}equals(r){return this.r===r.r&&this.g===r.g&&this.b===r.b&&this.a===r.a}clone(){return this._c(this)}toHexString(){let r="#";const a=(this.r||0).toString(16);r+=a.length===2?a:"0"+a;const c=(this.g||0).toString(16);r+=c.length===2?c:"0"+c;const d=(this.b||0).toString(16);if(r+=d.length===2?d:"0"+d,typeof this.a=="number"&&this.a>=0&&this.a<1){const x=Eo(this.a*255).toString(16);r+=x.length===2?x:"0"+x}return r}toHsl(){return{h:this.getHue(),s:this.getSaturation(),l:this.getLightness(),a:this.a}}toHslString(){const r=this.getHue(),a=Eo(this.getSaturation()*100),c=Eo(this.getLightness()*100);return this.a!==1?`hsla(${r},${a}%,${c}%,${this.a})`:`hsl(${r},${a}%,${c}%)`}toHsv(){return{h:this.getHue(),s:this.getSaturation(),v:this.getValue(),a:this.a}}toRgb(){return{r:this.r,g:this.g,b:this.b,a:this.a}}toRgbString(){return this.a!==1?`rgba(${this.r},${this.g},${this.b},${this.a})`:`rgb(${this.r},${this.g},${this.b})`}toString(){return this.toRgbString()}_sc(r,a,c){const d=this.clone();return d[r]=Eg(a,c),d}_c(r){return new this.constructor(r)}getMax(){return typeof this._max>"u"&&(this._max=Math.max(this.r,this.g,this.b)),this._max}getMin(){return typeof this._min>"u"&&(this._min=Math.min(this.r,this.g,this.b)),this._min}fromHexString(r){const a=r.replace("#","");function c(d,x){return parseInt(a[d]+a[x||d],16)}a.length<6?(this.r=c(0),this.g=c(1),this.b=c(2),this.a=a[3]?c(3)/255:1):(this.r=c(0,1),this.g=c(2,3),this.b=c(4,5),this.a=a[6]?c(6,7)/255:1)}fromHsl({h:r,s:a,l:c,a:d}){if(this._h=r%360,this._s=a,this._l=c,this.a=typeof d=="number"?d:1,a<=0){const X=Eo(c*255);this.r=X,this.g=X,this.b=X}let x=0,T=0,i=0;const L=r/60,N=(1-Math.abs(2*c-1))*a,U=N*(1-Math.abs(L%2-1));L>=0&&L<1?(x=N,T=U):L>=1&&L<2?(x=U,T=N):L>=2&&L<3?(T=N,i=U):L>=3&&L<4?(T=U,i=N):L>=4&&L<5?(x=U,i=N):L>=5&&L<6&&(x=N,i=U);const q=c-N/2;this.r=Eo((x+q)*255),this.g=Eo((T+q)*255),this.b=Eo((i+q)*255)}fromHsv({h:r,s:a,v:c,a:d}){this._h=r%360,this._s=a,this._v=c,this.a=typeof d=="number"?d:1;const x=Eo(c*255);if(this.r=x,this.g=x,this.b=x,a<=0)return;const T=r/60,i=Math.floor(T),L=T-i,N=Eo(c*(1-a)*255),U=Eo(c*(1-a*L)*255),q=Eo(c*(1-a*(1-L))*255);switch(i){case 0:this.g=q,this.b=N;break;case 1:this.r=U,this.b=N;break;case 2:this.r=N,this.b=q;break;case 3:this.r=N,this.g=U;break;case 4:this.r=q,this.g=N;break;case 5:default:this.g=N,this.b=U;break}}fromHsvString(r){const a=d2(r,$5);this.fromHsv({h:a[0],s:a[1],v:a[2],a:a[3]})}fromHslString(r){const a=d2(r,$5);this.fromHsl({h:a[0],s:a[1],l:a[2],a:a[3]})}fromRgbString(r){const a=d2(r,(c,d)=>d.includes("%")?Eo(c/100*255):c);this.r=a[0],this.g=a[1],this.b=a[2],this.a=a[3]}}var cV=["b"],uV=["v"],f2=function(r){return Math.round(Number(r||0))},hV=function(r){if(r instanceof sx)return r;if(r&&ln(r)==="object"&&"h"in r&&"b"in r){var a=r,c=a.b,d=is(a,cV);return Ft(Ft({},d),{},{v:c})}return typeof r=="string"&&/hsb/.test(r)?r.replace(/hsb/,"hsv"):r},w_=function(e){Hu(a,e);var r=Wu(a);function a(c){return Ao(this,a),r.call(this,hV(c))}return Ro(a,[{key:"toHsbString",value:function(){var d=this.toHsb(),x=f2(d.s*100),T=f2(d.b*100),i=f2(d.h),L=d.a,N="hsb(".concat(i,", ").concat(x,"%, ").concat(T,"%)"),U="hsba(".concat(i,", ").concat(x,"%, ").concat(T,"%, ").concat(L.toFixed(L===0?0:2),")");return L===1?N:U}},{key:"toHsb",value:function(){var d=this.toHsv(),x=d.v,T=is(d,uV);return Ft(Ft({},T),{},{b:x,a:this.a})}}]),a}(sx),dV=function(r){return r instanceof w_?r:new w_(r)};dV("#1677ff");const fV=(e,r)=>(e==null?void 0:e.replace(/[^\w/]/g,"").slice(0,r?8:6))||"",pV=(e,r)=>e?fV(e,r):"";let mV=function(){function e(r){Ao(this,e);var a;if(this.cleared=!1,r instanceof e){this.metaColor=r.metaColor.clone(),this.colors=(a=r.colors)===null||a===void 0?void 0:a.map(d=>({color:new e(d.color),percent:d.percent})),this.cleared=r.cleared;return}const c=Array.isArray(r);c&&r.length?(this.colors=r.map(d=>{let{color:x,percent:T}=d;return{color:new e(x),percent:T}}),this.metaColor=new w_(this.colors[0].color.metaColor)):this.metaColor=new w_(c?"":r),(!r||c&&!this.colors)&&(this.metaColor=this.metaColor.setA(0),this.cleared=!0)}return Ro(e,[{key:"toHsb",value:function(){return this.metaColor.toHsb()}},{key:"toHsbString",value:function(){return this.metaColor.toHsbString()}},{key:"toHex",value:function(){return pV(this.toHexString(),this.metaColor.a<1)}},{key:"toHexString",value:function(){return this.metaColor.toHexString()}},{key:"toRgb",value:function(){return this.metaColor.toRgb()}},{key:"toRgbString",value:function(){return this.metaColor.toRgbString()}},{key:"isGradient",value:function(){return!!this.colors&&!this.cleared}},{key:"getColors",value:function(){return this.colors||[{color:this,percent:0}]}},{key:"toCssString",value:function(){const{colors:a}=this;return a?`linear-gradient(90deg, ${a.map(d=>`${d.color.toRgbString()} ${d.percent}%`).join(", ")})`:this.metaColor.toRgbString()}},{key:"equals",value:function(a){return!a||this.isGradient()!==a.isGradient()?!1:this.isGradient()?this.colors.length===a.colors.length&&this.colors.every((c,d)=>{const x=a.colors[d];return c.percent===x.percent&&c.color.equals(x.color)}):this.toHexString()===a.toHexString()}}])}();const gV=e=>({[e.componentCls]:{[`${e.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},
        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}},[`${e.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${e.motionDurationMid} ${e.motionEaseInOut},
        opacity ${e.motionDurationMid} ${e.motionEaseInOut} !important`}}}),_V=gV,yV=e=>({animationDuration:e,animationFillMode:"both"}),vV=e=>({animationDuration:e,animationFillMode:"both"}),xV=function(e,r,a,c){const x=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${x}${e}-enter,
      ${x}${e}-appear
    `]:Object.assign(Object.assign({},yV(c)),{animationPlayState:"paused"}),[`${x}${e}-leave`]:Object.assign(Object.assign({},vV(c)),{animationPlayState:"paused"}),[`
      ${x}${e}-enter${e}-enter-active,
      ${x}${e}-appear${e}-appear-active
    `]:{animationName:r,animationPlayState:"running"},[`${x}${e}-leave${e}-leave-active`]:{animationName:a,animationPlayState:"running",pointerEvents:"none"}}},jE=new _a("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),bV=new _a("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),V5=new _a("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),U5=new _a("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),wV=new _a("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),SV=new _a("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),EV=new _a("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),TV=new _a("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),CV=new _a("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),MV=new _a("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),IV=new _a("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),PV=new _a("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),AV={zoom:{inKeyframes:jE,outKeyframes:bV},"zoom-big":{inKeyframes:V5,outKeyframes:U5},"zoom-big-fast":{inKeyframes:V5,outKeyframes:U5},"zoom-left":{inKeyframes:EV,outKeyframes:TV},"zoom-right":{inKeyframes:CV,outKeyframes:MV},"zoom-up":{inKeyframes:wV,outKeyframes:SV},"zoom-down":{inKeyframes:IV,outKeyframes:PV}},RV=(e,r)=>{const{antCls:a}=e,c=`${a}-${r}`,{inKeyframes:d,outKeyframes:x}=AV[r];return[xV(c,d,x,r==="zoom-big-fast"?e.motionDurationFast:e.motionDurationMid),{[`
        ${c}-enter,
        ${c}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:e.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${c}-leave`]:{animationTimingFunction:e.motionEaseInOutCirc}}]},zV=(e,r)=>{const{r:a,g:c,b:d,a:x}=e.toRgb(),T=new w_(e.toRgbString()).onBackground(r).toHsv();return x<=.5?T.v>.5:a*.299+c*.587+d*.114>192},XL=e=>{const{paddingInline:r,onlyIconSize:a,paddingBlock:c}=e;return Wo(e,{buttonPaddingHorizontal:r,buttonPaddingVertical:c,buttonIconOnlyFontSize:a})},YL=e=>{var r,a,c,d,x,T;const i=(r=e.contentFontSize)!==null&&r!==void 0?r:e.fontSize,L=(a=e.contentFontSizeSM)!==null&&a!==void 0?a:e.fontSize,N=(c=e.contentFontSizeLG)!==null&&c!==void 0?c:e.fontSizeLG,U=(d=e.contentLineHeight)!==null&&d!==void 0?d:Ov(i),q=(x=e.contentLineHeightSM)!==null&&x!==void 0?x:Ov(L),X=(T=e.contentLineHeightLG)!==null&&T!==void 0?T:Ov(N),se=zV(new mV(e.colorBgSolid),"#fff")?"#000":"#fff";return{fontWeight:400,defaultShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlTmpOutline}`,primaryShadow:`0 ${e.controlOutlineWidth}px 0 ${e.controlOutline}`,dangerShadow:`0 ${e.controlOutlineWidth}px 0 ${e.colorErrorOutline}`,primaryColor:e.colorTextLightSolid,dangerColor:e.colorTextLightSolid,borderColorDisabled:e.colorBorder,defaultGhostColor:e.colorBgContainer,ghostBg:"transparent",defaultGhostBorderColor:e.colorBgContainer,paddingInline:e.paddingContentHorizontal-e.lineWidth,paddingInlineLG:e.paddingContentHorizontal-e.lineWidth,paddingInlineSM:8-e.lineWidth,onlyIconSize:e.fontSizeLG,onlyIconSizeSM:e.fontSizeLG-2,onlyIconSizeLG:e.fontSizeLG+2,groupBorderColor:e.colorPrimaryHover,linkHoverBg:"transparent",textTextColor:e.colorText,textTextHoverColor:e.colorText,textTextActiveColor:e.colorText,textHoverBg:e.colorFillTertiary,defaultColor:e.colorText,defaultBg:e.colorBgContainer,defaultBorderColor:e.colorBorder,defaultBorderColorDisabled:e.colorBorder,defaultHoverBg:e.colorBgContainer,defaultHoverColor:e.colorPrimaryHover,defaultHoverBorderColor:e.colorPrimaryHover,defaultActiveBg:e.colorBgContainer,defaultActiveColor:e.colorPrimaryActive,defaultActiveBorderColor:e.colorPrimaryActive,solidTextColor:se,contentFontSize:i,contentFontSizeSM:L,contentFontSizeLG:N,contentLineHeight:U,contentLineHeightSM:q,contentLineHeightLG:X,paddingBlock:Math.max((e.controlHeight-i*U)/2-e.lineWidth,0),paddingBlockSM:Math.max((e.controlHeightSM-L*q)/2-e.lineWidth,0),paddingBlockLG:Math.max((e.controlHeightLG-N*X)/2-e.lineWidth,0)}},LV=e=>{const{componentCls:r,iconCls:a,fontWeight:c}=e;return{[r]:{outline:"none",position:"relative",display:"inline-flex",gap:e.marginXS,alignItems:"center",justifyContent:"center",fontWeight:c,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",background:"transparent",border:`${fn(e.lineWidth)} ${e.lineType} transparent`,cursor:"pointer",transition:`all ${e.motionDurationMid} ${e.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",color:e.colorText,"&:disabled > *":{pointerEvents:"none"},[`> span, ${r}-icon`]:{display:"inline-flex"},"> a":{color:"currentColor"},"&:not(:disabled)":Object.assign({},X9(e)),[`&${r}-two-chinese-chars::first-letter`]:{letterSpacing:"0.34em"},[`&${r}-two-chinese-chars > *:not(${a})`]:{marginInlineEnd:"-0.34em",letterSpacing:"0.34em"},"&-icon-end":{flexDirection:"row-reverse"}}}},KL=(e,r,a)=>({[`&:not(:disabled):not(${e}-disabled)`]:{"&:hover":r,"&:active":a}}),kV=e=>({minWidth:e.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),DV=e=>({borderRadius:e.controlHeight,paddingInlineStart:e.calc(e.controlHeight).div(2).equal(),paddingInlineEnd:e.calc(e.controlHeight).div(2).equal()}),OV=e=>({cursor:"not-allowed",borderColor:e.borderColorDisabled,color:e.colorTextDisabled,background:e.colorBgContainerDisabled,boxShadow:"none"}),$E=(e,r,a,c,d,x,T,i)=>({[`&${e}-background-ghost`]:Object.assign(Object.assign({color:a||void 0,background:r,borderColor:c||void 0,boxShadow:"none"},KL(e,Object.assign({background:r},T),Object.assign({background:r},i))),{"&:disabled":{cursor:"not-allowed",color:d||void 0,borderColor:x||void 0}})}),FV=e=>({[`&:disabled, &${e.componentCls}-disabled`]:Object.assign({},OV(e))}),BV=e=>({[`&:disabled, &${e.componentCls}-disabled`]:{cursor:"not-allowed",color:e.colorTextDisabled}}),lx=(e,r,a,c)=>{const x=c&&["link","text"].includes(c)?BV:FV;return Object.assign(Object.assign({},x(e)),KL(e.componentCls,r,a))},VE=(e,r,a,c,d)=>({[`&${e.componentCls}-variant-solid`]:Object.assign({color:r,background:a},lx(e,c,d))}),UE=(e,r,a,c,d)=>({[`&${e.componentCls}-variant-outlined, &${e.componentCls}-variant-dashed`]:Object.assign({borderColor:r,background:a},lx(e,c,d))}),GE=e=>({[`&${e.componentCls}-variant-dashed`]:{borderStyle:"dashed"}}),HE=(e,r,a,c)=>({[`&${e.componentCls}-variant-filled`]:Object.assign({boxShadow:"none",background:r},lx(e,a,c))}),Tp=(e,r,a,c,d)=>({[`&${e.componentCls}-variant-${a}`]:Object.assign({color:r,boxShadow:"none"},lx(e,c,d,a))}),NV=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:e.defaultColor,boxShadow:e.defaultShadow},VE(e,e.solidTextColor,e.colorBgSolid,{background:e.colorBgSolidHover},{background:e.colorBgSolidActive})),GE(e)),HE(e,e.colorFillTertiary,{background:e.colorFillSecondary},{background:e.colorFill})),Tp(e,e.textTextColor,"link",{color:e.colorLinkHover,background:e.linkHoverBg},{color:e.colorLinkActive})),$E(e.componentCls,e.ghostBg,e.defaultGhostColor,e.defaultGhostBorderColor,e.colorTextDisabled,e.colorBorder)),jV=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:e.colorPrimary,boxShadow:e.primaryShadow},UE(e,e.colorPrimary,e.colorBgContainer,{color:e.colorPrimaryTextHover,borderColor:e.colorPrimaryHover,background:e.colorBgContainer},{color:e.colorPrimaryTextActive,borderColor:e.colorPrimaryActive,background:e.colorBgContainer})),GE(e)),HE(e,e.colorPrimaryBg,{background:e.colorPrimaryBgHover},{background:e.colorPrimaryBorder})),Tp(e,e.colorLink,"text",{color:e.colorPrimaryTextHover,background:e.colorPrimaryBg},{color:e.colorPrimaryTextActive,background:e.colorPrimaryBorder})),$E(e.componentCls,e.ghostBg,e.colorPrimary,e.colorPrimary,e.colorTextDisabled,e.colorBorder,{color:e.colorPrimaryHover,borderColor:e.colorPrimaryHover},{color:e.colorPrimaryActive,borderColor:e.colorPrimaryActive})),$V=e=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({color:e.colorError,boxShadow:e.dangerShadow},VE(e,e.dangerColor,e.colorError,{background:e.colorErrorHover},{background:e.colorErrorActive})),UE(e,e.colorError,e.colorBgContainer,{color:e.colorErrorHover,borderColor:e.colorErrorBorderHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),GE(e)),HE(e,e.colorErrorBg,{background:e.colorErrorBgFilledHover},{background:e.colorErrorBgActive})),Tp(e,e.colorError,"text",{color:e.colorErrorHover,background:e.colorErrorBg},{color:e.colorErrorHover,background:e.colorErrorBgActive})),Tp(e,e.colorError,"link",{color:e.colorErrorHover},{color:e.colorErrorActive})),$E(e.componentCls,e.ghostBg,e.colorError,e.colorError,e.colorTextDisabled,e.colorBorder,{color:e.colorErrorHover,borderColor:e.colorErrorHover},{color:e.colorErrorActive,borderColor:e.colorErrorActive})),VV=e=>{const{componentCls:r}=e;return{[`${r}-color-default`]:NV(e),[`${r}-color-primary`]:jV(e),[`${r}-color-dangerous`]:$V(e)}},UV=e=>Object.assign(Object.assign(Object.assign(Object.assign({},UE(e,e.defaultBorderColor,e.defaultBg,{color:e.defaultHoverColor,borderColor:e.defaultHoverBorderColor,background:e.defaultHoverBg},{color:e.defaultActiveColor,borderColor:e.defaultActiveBorderColor,background:e.defaultActiveBg})),Tp(e,e.textTextColor,"text",{color:e.textTextHoverColor,background:e.textHoverBg},{color:e.textTextActiveColor,background:e.colorBgTextActive})),VE(e,e.primaryColor,e.colorPrimary,{background:e.colorPrimaryHover,color:e.primaryColor},{background:e.colorPrimaryActive,color:e.primaryColor})),Tp(e,e.colorLink,"link",{color:e.colorLinkHover,background:e.linkHoverBg},{color:e.colorLinkActive})),WE=function(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const{componentCls:a,controlHeight:c,fontSize:d,lineHeight:x,borderRadius:T,buttonPaddingHorizontal:i,iconCls:L,buttonPaddingVertical:N,motionDurationSlow:U,motionEaseInOut:q,buttonIconOnlyFontSize:X,opacityLoading:se}=e;return[{[r]:{fontSize:d,lineHeight:x,height:c,padding:`${fn(N)} ${fn(i)}`,borderRadius:T,[`&${a}-icon-only`]:{width:c,paddingInline:0,[`&${a}-compact-item`]:{flex:"none"},[`&${a}-round`]:{width:"auto"},[L]:{fontSize:X}},[`&${a}-loading`]:{opacity:se,cursor:"default"},[`${a}-loading-icon`]:{transition:`width ${U} ${q}, opacity ${U} ${q}`}}},{[`${a}${a}-circle${r}`]:kV(e)},{[`${a}${a}-round${r}`]:DV(e)}]},GV=e=>{const r=Wo(e,{fontSize:e.contentFontSize,lineHeight:e.contentLineHeight});return WE(r,e.componentCls)},HV=e=>{const r=Wo(e,{controlHeight:e.controlHeightSM,fontSize:e.contentFontSizeSM,lineHeight:e.contentLineHeightSM,padding:e.paddingXS,buttonPaddingHorizontal:e.paddingInlineSM,buttonPaddingVertical:e.paddingBlockSM,borderRadius:e.borderRadiusSM,buttonIconOnlyFontSize:e.onlyIconSizeSM});return WE(r,`${e.componentCls}-sm`)},WV=e=>{const r=Wo(e,{controlHeight:e.controlHeightLG,fontSize:e.contentFontSizeLG,lineHeight:e.contentLineHeightLG,buttonPaddingHorizontal:e.paddingInlineLG,buttonPaddingVertical:e.paddingBlockLG,borderRadius:e.borderRadiusLG,buttonIconOnlyFontSize:e.onlyIconSizeLG});return WE(r,`${e.componentCls}-lg`)},qV=e=>{const{componentCls:r}=e;return{[r]:{[`&${r}-block`]:{width:"100%"}}}},ZV=Ms("Button",e=>{const r=XL(e);return[LV(r),GV(r),HV(r),WV(r),qV(r),VV(r),UV(r),lV(r)]},YL,{unitless:{fontWeight:!0,contentLineHeight:!0,contentLineHeightSM:!0,contentLineHeightLG:!0}});function XV(e,r,a){const{focusElCls:c,focus:d,borderElCls:x}=a,T=x?"> *":"",i=["hover",d?"focus":null,"active"].filter(Boolean).map(L=>`&:${L} ${T}`).join(",");return{[`&-item:not(${r}-last-item)`]:{marginInlineEnd:e.calc(e.lineWidth).mul(-1).equal()},"&-item":Object.assign(Object.assign({[i]:{zIndex:2}},c?{[`&${c}`]:{zIndex:2}}:{}),{[`&[disabled] ${T}`]:{zIndex:0}})}}function YV(e,r,a){const{borderElCls:c}=a,d=c?`> ${c}`:"";return{[`&-item:not(${r}-first-item):not(${r}-last-item) ${d}`]:{borderRadius:0},[`&-item:not(${r}-last-item)${r}-first-item`]:{[`& ${d}, &${e}-sm ${d}, &${e}-lg ${d}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${r}-first-item)${r}-last-item`]:{[`& ${d}, &${e}-sm ${d}, &${e}-lg ${d}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function KV(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:a}=e,c=`${a}-compact`;return{[c]:Object.assign(Object.assign({},XV(e,c,r)),YV(a,c,r))}}function JV(e,r){return{[`&-item:not(${r}-last-item)`]:{marginBottom:e.calc(e.lineWidth).mul(-1).equal()},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function QV(e,r){return{[`&-item:not(${r}-first-item):not(${r}-last-item)`]:{borderRadius:0},[`&-item${r}-first-item:not(${r}-last-item)`]:{[`&, &${e}-sm, &${e}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${r}-last-item:not(${r}-first-item)`]:{[`&, &${e}-sm, &${e}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}}function eU(e){const r=`${e.componentCls}-compact-vertical`;return{[r]:Object.assign(Object.assign({},JV(e,r)),QV(e.componentCls,r))}}const tU=e=>{const{componentCls:r,colorPrimaryHover:a,lineWidth:c,calc:d}=e,x=d(c).mul(-1).equal(),T=i=>({[`${r}-compact${i?"-vertical":""}-item${r}-primary:not([disabled])`]:{"& + &::before":{position:"absolute",top:i?x:0,insetInlineStart:i?0:x,backgroundColor:a,content:'""',width:i?"100%":c,height:i?c:"100%"}}});return Object.assign(Object.assign({},T()),T(!0))},rU=SL(["Button","compact"],e=>{const r=XL(e);return[KV(r),eU(r),tU(r)]},YL);var nU=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};function iU(e){if(typeof e=="object"&&e){let r=e==null?void 0:e.delay;return r=!Number.isNaN(r)&&typeof r=="number"?r:0,{loading:r<=0,delay:r}}return{loading:!!e,delay:0}}const oU={default:["default","outlined"],primary:["primary","solid"],dashed:["default","dashed"],link:["primary","link"],text:["default","text"]},aU=sn.forwardRef((e,r)=>{var a,c,d,x;const{loading:T=!1,prefixCls:i,color:L,variant:N,type:U,danger:q=!1,shape:X="default",size:se,styles:ce,disabled:ue,className:fe,rootClassName:re,children:ee,icon:ae,iconPosition:ve="start",ghost:Te=!1,block:pe=!1,htmlType:Ee="button",classNames:Ne,style:Xe={},autoInsertSpace:Fe,autoFocus:Je}=e,Ct=nU(e,["loading","prefixCls","color","variant","type","danger","shape","size","styles","disabled","className","rootClassName","children","icon","iconPosition","ghost","block","htmlType","classNames","style","autoInsertSpace","autoFocus"]),ft=U||"default",[yt,lt]=$.useMemo(()=>{if(L&&N)return[L,N];const nn=oU[ft]||[];return q?["danger",nn[1]]:nn},[U,L,N,q]),Ye=yt==="danger"?"dangerous":yt,{getPrefixCls:Ke,direction:tt,button:ht}=$.useContext(Yn),vt=(a=Fe??(ht==null?void 0:ht.autoInsertSpace))!==null&&a!==void 0?a:!0,At=Ke("btn",i),[Pt,qt,or]=ZV(At),cr=$.useContext(B_),Qt=ue??cr,qr=$.useContext(qL),yr=$.useMemo(()=>iU(T),[T]),[Ae,Lr]=$.useState(yr.loading),[$r,pn]=$.useState(!1),wt=$.useRef(),Pr=Z1(r,wt),Ur=$.Children.count(ee)===1&&!ae&&!c2(lt);$.useEffect(()=>{let nn=null;yr.delay>0?nn=setTimeout(()=>{nn=null,Lr(!0)},yr.delay):Lr(yr.loading);function En(){nn&&(clearTimeout(nn),nn=null)}return En},[yr]),$.useEffect(()=>{if(!wt.current||!vt)return;const nn=wt.current.textContent||"";Ur&&r3(nn)?$r||pn(!0):$r&&pn(!1)}),$.useEffect(()=>{Je&&wt.current&&wt.current.focus()},[]);const Un=sn.useCallback(nn=>{var En;if(Ae||Qt){nn.preventDefault();return}(En=e.onClick)===null||En===void 0||En.call(e,nn)},[e.onClick,Ae,Qt]),{compactSize:ar,compactItemClassnames:tn}=X$(At,tt),Ln={large:"lg",small:"sm",middle:void 0},Xr=ox(nn=>{var En,Jn;return(Jn=(En=se??ar)!==null&&En!==void 0?En:qr)!==null&&Jn!==void 0?Jn:nn}),hn=Xr&&(c=Ln[Xr])!==null&&c!==void 0?c:"",fr=Ae?"loading":ae,Jt=ud(Ct,["navigate"]),bn=Mr(At,qt,or,{[`${At}-${X}`]:X!=="default"&&X,[`${At}-${ft}`]:ft,[`${At}-dangerous`]:q,[`${At}-color-${Ye}`]:Ye,[`${At}-variant-${lt}`]:lt,[`${At}-${hn}`]:hn,[`${At}-icon-only`]:!ee&&ee!==0&&!!fr,[`${At}-background-ghost`]:Te&&!c2(lt),[`${At}-loading`]:Ae,[`${At}-two-chinese-chars`]:$r&&vt&&!Ae,[`${At}-block`]:pe,[`${At}-rtl`]:tt==="rtl",[`${At}-icon-end`]:ve==="end"},tn,fe,re,ht==null?void 0:ht.className),gn=Object.assign(Object.assign({},ht==null?void 0:ht.style),Xe),Kn=Mr(Ne==null?void 0:Ne.icon,(d=ht==null?void 0:ht.classNames)===null||d===void 0?void 0:d.icon),dn=Object.assign(Object.assign({},(ce==null?void 0:ce.icon)||{}),((x=ht==null?void 0:ht.styles)===null||x===void 0?void 0:x.icon)||{}),di=ae&&!Ae?sn.createElement(ZL,{prefixCls:At,className:Kn,style:dn},ae):sn.createElement(aV,{existIcon:!!ae,prefixCls:At,loading:Ae}),Ui=ee||ee===0?nV(ee,Ur&&vt):null;if(Jt.href!==void 0)return Pt(sn.createElement("a",Object.assign({},Jt,{className:Mr(bn,{[`${At}-disabled`]:Qt}),href:Qt?void 0:Jt.href,style:gn,onClick:Un,ref:Pr,tabIndex:Qt?-1:0}),di,Ui));let Ji=sn.createElement("button",Object.assign({},Ct,{type:Ee,className:bn,style:gn,onClick:Un,disabled:Qt,ref:Pr}),di,Ui,tn&&sn.createElement(rU,{prefixCls:At}));return c2(lt)||(Ji=sn.createElement(NE,{component:"Button",disabled:Ae},Ji)),Pt(Ji)}),qE=aU;qE.Group=tV;qE.__ANT_BUTTON=!0;const np=qE;var JL=$.createContext(null),G5=[];function sU(e,r){var a=$.useState(function(){if(!ns())return null;var ce=document.createElement("div");return ce}),c=Sr(a,1),d=c[0],x=$.useRef(!1),T=$.useContext(JL),i=$.useState(G5),L=Sr(i,2),N=L[0],U=L[1],q=T||(x.current?void 0:function(ce){U(function(ue){var fe=[ce].concat(zr(ue));return fe})});function X(){d.parentElement||document.body.appendChild(d),x.current=!0}function se(){var ce;(ce=d.parentElement)===null||ce===void 0||ce.removeChild(d),x.current=!1}return Mo(function(){return e?T?T(X):X():se(),se},[e]),Mo(function(){N.length&&(N.forEach(function(ce){return ce()}),U(G5))},[N]),[d,q]}function lU(e){var r="rc-scrollbar-measure-".concat(Math.random().toString(36).substring(7)),a=document.createElement("div");a.id=r;var c=a.style;c.position="absolute",c.left="0",c.top="0",c.width="100px",c.height="100px",c.overflow="scroll";var d,x;if(e){var T=getComputedStyle(e);c.scrollbarColor=T.scrollbarColor,c.scrollbarWidth=T.scrollbarWidth;var i=getComputedStyle(e,"::-webkit-scrollbar"),L=parseInt(i.width,10),N=parseInt(i.height,10);try{var U=L?"width: ".concat(i.width,";"):"",q=N?"height: ".concat(i.height,";"):"";bc(`
#`.concat(r,`::-webkit-scrollbar {
`).concat(U,`
`).concat(q,`
}`),r)}catch(ce){console.error(ce),d=L,x=N}}document.body.appendChild(a);var X=e&&d&&!isNaN(d)?d:a.offsetWidth-a.clientWidth,se=e&&x&&!isNaN(x)?x:a.offsetHeight-a.clientHeight;return document.body.removeChild(a),g_(r),{width:X,height:se}}function cU(e){return typeof document>"u"||!e||!(e instanceof Element)?{width:0,height:0}:lU(e)}function uU(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var hU="rc-util-locker-".concat(Date.now()),H5=0;function dU(e){var r=!!e,a=$.useState(function(){return H5+=1,"".concat(hU,"_").concat(H5)}),c=Sr(a,1),d=c[0];Mo(function(){if(r){var x=cU(document.body).width,T=uU();bc(`
html body {
  overflow-y: hidden;
  `.concat(T?"width: calc(100% - ".concat(x,"px);"):"",`
}`),d)}else g_(d);return function(){g_(d)}},[r,d])}var W5=!1;function fU(e){return typeof e=="boolean"&&(W5=e),W5}var q5=function(r){return r===!1?!1:!ns()||!r?null:typeof r=="string"?document.querySelector(r):typeof r=="function"?r():r},QL=$.forwardRef(function(e,r){var a=e.open,c=e.autoLock,d=e.getContainer;e.debug;var x=e.autoDestroy,T=x===void 0?!0:x,i=e.children,L=$.useState(a),N=Sr(L,2),U=N[0],q=N[1],X=U||a;$.useEffect(function(){(T||a)&&q(a)},[a,T]);var se=$.useState(function(){return q5(d)}),ce=Sr(se,2),ue=ce[0],fe=ce[1];$.useEffect(function(){var Je=q5(d);fe(Je??null)});var re=sU(X&&!ue),ee=Sr(re,2),ae=ee[0],ve=ee[1],Te=ue??ae;dU(c&&a&&ns()&&(Te===ae||Te===document.body));var pe=null;if(i&&Ap(i)&&r){var Ee=i;pe=Ee.ref}var Ne=Z1(pe,r);if(!X||!ns()||ue===void 0)return null;var Xe=Te===!1||fU(),Fe=i;return r&&(Fe=$.cloneElement(i,{ref:Ne})),$.createElement(JL.Provider,{value:ve},Xe?Fe:F1.createPortal(Fe,Te))});function pU(){var e=Ft({},R_);return e.useId}var Z5=0,X5=pU();const mU=X5?function(r){var a=X5();return r||a}:function(r){var a=$.useState("ssr-id"),c=Sr(a,2),d=c[0],x=c[1];return $.useEffect(function(){var T=Z5;Z5+=1,x("rc_unique_".concat(T))},[]),r||d};var Gh="RC_FORM_INTERNAL_HOOKS",ui=function(){es(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},id=$.createContext({getFieldValue:ui,getFieldsValue:ui,getFieldError:ui,getFieldWarning:ui,getFieldsError:ui,isFieldsTouched:ui,isFieldTouched:ui,isFieldValidating:ui,isFieldsValidating:ui,resetFields:ui,setFields:ui,setFieldValue:ui,setFieldsValue:ui,validateFields:ui,submit:ui,getInternalHooks:function(){return ui(),{dispatch:ui,initEntityValue:ui,registerField:ui,useSubscribe:ui,setInitialValues:ui,destroyForm:ui,setCallbacks:ui,registerWatch:ui,getFields:ui,setValidateMessages:ui,setPreserve:ui,getInitialValue:ui}}}),S_=$.createContext(null);function n3(e){return e==null?[]:Array.isArray(e)?e:[e]}function gU(e){return e&&!!e._init}function i3(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var r=JSON.parse(JSON.stringify(this));return r.clone=this.clone,r}}}var o3=i3();function _U(e){try{return Function.toString.call(e).indexOf("[native code]")!==-1}catch{return typeof e=="function"}}function yU(e,r,a){if(yE())return Reflect.construct.apply(null,arguments);var c=[null];c.push.apply(c,r);var d=new(e.bind.apply(e,c));return a&&f_(d,a.prototype),d}function a3(e){var r=typeof Map=="function"?new Map:void 0;return a3=function(c){if(c===null||!_U(c))return c;if(typeof c!="function")throw new TypeError("Super expression must either be null or a function");if(r!==void 0){if(r.has(c))return r.get(c);r.set(c,d)}function d(){return yU(c,arguments,p_(this).constructor)}return d.prototype=Object.create(c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),f_(d,c)},a3(e)}var vU=/%[sdj%]/g,xU=function(){};typeof process<"u"&&process.env;function s3(e){if(!e||!e.length)return null;var r={};return e.forEach(function(a){var c=a.field;r[c]=r[c]||[],r[c].push(a)}),r}function Qa(e){for(var r=arguments.length,a=new Array(r>1?r-1:0),c=1;c<r;c++)a[c-1]=arguments[c];var d=0,x=a.length;if(typeof e=="function")return e.apply(null,a);if(typeof e=="string"){var T=e.replace(vU,function(i){if(i==="%%")return"%";if(d>=x)return i;switch(i){case"%s":return String(a[d++]);case"%d":return Number(a[d++]);case"%j":try{return JSON.stringify(a[d++])}catch{return"[Circular]"}break;default:return i}});return T}return e}function bU(e){return e==="string"||e==="url"||e==="hex"||e==="email"||e==="date"||e==="pattern"}function vo(e,r){return!!(e==null||r==="array"&&Array.isArray(e)&&!e.length||bU(r)&&typeof e=="string"&&!e)}function wU(e,r,a){var c=[],d=0,x=e.length;function T(i){c.push.apply(c,zr(i||[])),d++,d===x&&a(c)}e.forEach(function(i){r(i,T)})}function Y5(e,r,a){var c=0,d=e.length;function x(T){if(T&&T.length){a(T);return}var i=c;c=c+1,i<d?r(e[i],x):a([])}x([])}function SU(e){var r=[];return Object.keys(e).forEach(function(a){r.push.apply(r,zr(e[a]||[]))}),r}var K5=function(e){Hu(a,e);var r=Wu(a);function a(c,d){var x;return Ao(this,a),x=r.call(this,"Async Validation Error"),Et(Sn(x),"errors",void 0),Et(Sn(x),"fields",void 0),x.errors=c,x.fields=d,x}return Ro(a)}(a3(Error));function EU(e,r,a,c,d){if(r.first){var x=new Promise(function(X,se){var ce=function(re){return c(re),re.length?se(new K5(re,s3(re))):X(d)},ue=SU(e);Y5(ue,a,ce)});return x.catch(function(X){return X}),x}var T=r.firstFields===!0?Object.keys(e):r.firstFields||[],i=Object.keys(e),L=i.length,N=0,U=[],q=new Promise(function(X,se){var ce=function(fe){if(U.push.apply(U,fe),N++,N===L)return c(U),U.length?se(new K5(U,s3(U))):X(d)};i.length||(c(U),X(d)),i.forEach(function(ue){var fe=e[ue];T.indexOf(ue)!==-1?Y5(fe,a,ce):wU(fe,a,ce)})});return q.catch(function(X){return X}),q}function TU(e){return!!(e&&e.message!==void 0)}function CU(e,r){for(var a=e,c=0;c<r.length;c++){if(a==null)return a;a=a[r[c]]}return a}function J5(e,r){return function(a){var c;return e.fullFields?c=CU(r,e.fullFields):c=r[a.field||e.fullField],TU(a)?(a.field=a.field||e.fullField,a.fieldValue=c,a):{message:typeof a=="function"?a():a,fieldValue:c,field:a.field||e.fullField}}}function Q5(e,r){if(r){for(var a in r)if(r.hasOwnProperty(a)){var c=r[a];ln(c)==="object"&&ln(e[a])==="object"?e[a]=Ft(Ft({},e[a]),c):e[a]=c}}return e}var Lf="enum",MU=function(r,a,c,d,x){r[Lf]=Array.isArray(r[Lf])?r[Lf]:[],r[Lf].indexOf(a)===-1&&d.push(Qa(x.messages[Lf],r.fullField,r[Lf].join(", ")))},IU=function(r,a,c,d,x){if(r.pattern){if(r.pattern instanceof RegExp)r.pattern.lastIndex=0,r.pattern.test(a)||d.push(Qa(x.messages.pattern.mismatch,r.fullField,a,r.pattern));else if(typeof r.pattern=="string"){var T=new RegExp(r.pattern);T.test(a)||d.push(Qa(x.messages.pattern.mismatch,r.fullField,a,r.pattern))}}},PU=function(r,a,c,d,x){var T=typeof r.len=="number",i=typeof r.min=="number",L=typeof r.max=="number",N=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,U=a,q=null,X=typeof a=="number",se=typeof a=="string",ce=Array.isArray(a);if(X?q="number":se?q="string":ce&&(q="array"),!q)return!1;ce&&(U=a.length),se&&(U=a.replace(N,"_").length),T?U!==r.len&&d.push(Qa(x.messages[q].len,r.fullField,r.len)):i&&!L&&U<r.min?d.push(Qa(x.messages[q].min,r.fullField,r.min)):L&&!i&&U>r.max?d.push(Qa(x.messages[q].max,r.fullField,r.max)):i&&L&&(U<r.min||U>r.max)&&d.push(Qa(x.messages[q].range,r.fullField,r.min,r.max))},e6=function(r,a,c,d,x,T){r.required&&(!c.hasOwnProperty(r.field)||vo(a,T||r.type))&&d.push(Qa(x.messages.required,r.fullField))},fv;const AU=function(){if(fv)return fv;var e="[a-fA-F\\d:]",r=function(pe){return pe&&pe.includeBoundaries?"(?:(?<=\\s|^)(?=".concat(e,")|(?<=").concat(e,")(?=\\s|$))"):""},a="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",c="[a-fA-F\\d]{1,4}",d=["(?:".concat(c,":){7}(?:").concat(c,"|:)"),"(?:".concat(c,":){6}(?:").concat(a,"|:").concat(c,"|:)"),"(?:".concat(c,":){5}(?::").concat(a,"|(?::").concat(c,"){1,2}|:)"),"(?:".concat(c,":){4}(?:(?::").concat(c,"){0,1}:").concat(a,"|(?::").concat(c,"){1,3}|:)"),"(?:".concat(c,":){3}(?:(?::").concat(c,"){0,2}:").concat(a,"|(?::").concat(c,"){1,4}|:)"),"(?:".concat(c,":){2}(?:(?::").concat(c,"){0,3}:").concat(a,"|(?::").concat(c,"){1,5}|:)"),"(?:".concat(c,":){1}(?:(?::").concat(c,"){0,4}:").concat(a,"|(?::").concat(c,"){1,6}|:)"),"(?::(?:(?::".concat(c,"){0,5}:").concat(a,"|(?::").concat(c,"){1,7}|:))")],x="(?:%[0-9a-zA-Z]{1,})?",T="(?:".concat(d.join("|"),")").concat(x),i=new RegExp("(?:^".concat(a,"$)|(?:^").concat(T,"$)")),L=new RegExp("^".concat(a,"$")),N=new RegExp("^".concat(T,"$")),U=function(pe){return pe&&pe.exact?i:new RegExp("(?:".concat(r(pe)).concat(a).concat(r(pe),")|(?:").concat(r(pe)).concat(T).concat(r(pe),")"),"g")};U.v4=function(Te){return Te&&Te.exact?L:new RegExp("".concat(r(Te)).concat(a).concat(r(Te)),"g")},U.v6=function(Te){return Te&&Te.exact?N:new RegExp("".concat(r(Te)).concat(T).concat(r(Te)),"g")};var q="(?:(?:[a-z]+:)?//)",X="(?:\\S+(?::\\S*)?@)?",se=U.v4().source,ce=U.v6().source,ue="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",fe="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",re="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",ee="(?::\\d{2,5})?",ae='(?:[/?#][^\\s"]*)?',ve="(?:".concat(q,"|www\\.)").concat(X,"(?:localhost|").concat(se,"|").concat(ce,"|").concat(ue).concat(fe).concat(re,")").concat(ee).concat(ae);return fv=new RegExp("(?:^".concat(ve,"$)"),"i"),fv};var eP={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},kg={integer:function(r){return kg.number(r)&&parseInt(r,10)===r},float:function(r){return kg.number(r)&&!kg.integer(r)},array:function(r){return Array.isArray(r)},regexp:function(r){if(r instanceof RegExp)return!0;try{return!!new RegExp(r)}catch{return!1}},date:function(r){return typeof r.getTime=="function"&&typeof r.getMonth=="function"&&typeof r.getYear=="function"&&!isNaN(r.getTime())},number:function(r){return isNaN(r)?!1:typeof r=="number"},object:function(r){return ln(r)==="object"&&!kg.array(r)},method:function(r){return typeof r=="function"},email:function(r){return typeof r=="string"&&r.length<=320&&!!r.match(eP.email)},url:function(r){return typeof r=="string"&&r.length<=2048&&!!r.match(AU())},hex:function(r){return typeof r=="string"&&!!r.match(eP.hex)}},RU=function(r,a,c,d,x){if(r.required&&a===void 0){e6(r,a,c,d,x);return}var T=["integer","float","array","regexp","object","method","email","number","date","url","hex"],i=r.type;T.indexOf(i)>-1?kg[i](a)||d.push(Qa(x.messages.types[i],r.fullField,r.type)):i&&ln(a)!==r.type&&d.push(Qa(x.messages.types[i],r.fullField,r.type))},zU=function(r,a,c,d,x){(/^\s+$/.test(a)||a==="")&&d.push(Qa(x.messages.whitespace,r.fullField))};const Fn={required:e6,whitespace:zU,type:RU,range:PU,enum:MU,pattern:IU};var LU=function(r,a,c,d,x){var T=[],i=r.required||!r.required&&d.hasOwnProperty(r.field);if(i){if(vo(a)&&!r.required)return c();Fn.required(r,a,d,T,x)}c(T)},kU=function(r,a,c,d,x){var T=[],i=r.required||!r.required&&d.hasOwnProperty(r.field);if(i){if(a==null&&!r.required)return c();Fn.required(r,a,d,T,x,"array"),a!=null&&(Fn.type(r,a,d,T,x),Fn.range(r,a,d,T,x))}c(T)},DU=function(r,a,c,d,x){var T=[],i=r.required||!r.required&&d.hasOwnProperty(r.field);if(i){if(vo(a)&&!r.required)return c();Fn.required(r,a,d,T,x),a!==void 0&&Fn.type(r,a,d,T,x)}c(T)},OU=function(r,a,c,d,x){var T=[],i=r.required||!r.required&&d.hasOwnProperty(r.field);if(i){if(vo(a,"date")&&!r.required)return c();if(Fn.required(r,a,d,T,x),!vo(a,"date")){var L;a instanceof Date?L=a:L=new Date(a),Fn.type(r,L,d,T,x),L&&Fn.range(r,L.getTime(),d,T,x)}}c(T)},FU="enum",BU=function(r,a,c,d,x){var T=[],i=r.required||!r.required&&d.hasOwnProperty(r.field);if(i){if(vo(a)&&!r.required)return c();Fn.required(r,a,d,T,x),a!==void 0&&Fn[FU](r,a,d,T,x)}c(T)},NU=function(r,a,c,d,x){var T=[],i=r.required||!r.required&&d.hasOwnProperty(r.field);if(i){if(vo(a)&&!r.required)return c();Fn.required(r,a,d,T,x),a!==void 0&&(Fn.type(r,a,d,T,x),Fn.range(r,a,d,T,x))}c(T)},jU=function(r,a,c,d,x){var T=[],i=r.required||!r.required&&d.hasOwnProperty(r.field);if(i){if(vo(a)&&!r.required)return c();Fn.required(r,a,d,T,x),a!==void 0&&(Fn.type(r,a,d,T,x),Fn.range(r,a,d,T,x))}c(T)},$U=function(r,a,c,d,x){var T=[],i=r.required||!r.required&&d.hasOwnProperty(r.field);if(i){if(vo(a)&&!r.required)return c();Fn.required(r,a,d,T,x),a!==void 0&&Fn.type(r,a,d,T,x)}c(T)},VU=function(r,a,c,d,x){var T=[],i=r.required||!r.required&&d.hasOwnProperty(r.field);if(i){if(a===""&&(a=void 0),vo(a)&&!r.required)return c();Fn.required(r,a,d,T,x),a!==void 0&&(Fn.type(r,a,d,T,x),Fn.range(r,a,d,T,x))}c(T)},UU=function(r,a,c,d,x){var T=[],i=r.required||!r.required&&d.hasOwnProperty(r.field);if(i){if(vo(a)&&!r.required)return c();Fn.required(r,a,d,T,x),a!==void 0&&Fn.type(r,a,d,T,x)}c(T)},GU=function(r,a,c,d,x){var T=[],i=r.required||!r.required&&d.hasOwnProperty(r.field);if(i){if(vo(a,"string")&&!r.required)return c();Fn.required(r,a,d,T,x),vo(a,"string")||Fn.pattern(r,a,d,T,x)}c(T)},HU=function(r,a,c,d,x){var T=[],i=r.required||!r.required&&d.hasOwnProperty(r.field);if(i){if(vo(a)&&!r.required)return c();Fn.required(r,a,d,T,x),vo(a)||Fn.type(r,a,d,T,x)}c(T)},WU=function(r,a,c,d,x){var T=[],i=Array.isArray(a)?"array":ln(a);Fn.required(r,a,d,T,x,i),c(T)},qU=function(r,a,c,d,x){var T=[],i=r.required||!r.required&&d.hasOwnProperty(r.field);if(i){if(vo(a,"string")&&!r.required)return c();Fn.required(r,a,d,T,x,"string"),vo(a,"string")||(Fn.type(r,a,d,T,x),Fn.range(r,a,d,T,x),Fn.pattern(r,a,d,T,x),r.whitespace===!0&&Fn.whitespace(r,a,d,T,x))}c(T)},p2=function(r,a,c,d,x){var T=r.type,i=[],L=r.required||!r.required&&d.hasOwnProperty(r.field);if(L){if(vo(a,T)&&!r.required)return c();Fn.required(r,a,d,i,x,T),vo(a,T)||Fn.type(r,a,d,i,x)}c(i)};const qg={string:qU,method:$U,number:VU,boolean:DU,regexp:HU,integer:jU,float:NU,array:kU,object:UU,enum:BU,pattern:GU,date:OU,url:p2,hex:p2,email:p2,required:WU,any:LU};var V_=function(){function e(r){Ao(this,e),Et(this,"rules",null),Et(this,"_messages",o3),this.define(r)}return Ro(e,[{key:"define",value:function(a){var c=this;if(!a)throw new Error("Cannot configure a schema with no rules");if(ln(a)!=="object"||Array.isArray(a))throw new Error("Rules must be an object");this.rules={},Object.keys(a).forEach(function(d){var x=a[d];c.rules[d]=Array.isArray(x)?x:[x]})}},{key:"messages",value:function(a){return a&&(this._messages=Q5(i3(),a)),this._messages}},{key:"validate",value:function(a){var c=this,d=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:function(){},T=a,i=d,L=x;if(typeof i=="function"&&(L=i,i={}),!this.rules||Object.keys(this.rules).length===0)return L&&L(null,T),Promise.resolve(T);function N(ce){var ue=[],fe={};function re(ae){if(Array.isArray(ae)){var ve;ue=(ve=ue).concat.apply(ve,zr(ae))}else ue.push(ae)}for(var ee=0;ee<ce.length;ee++)re(ce[ee]);ue.length?(fe=s3(ue),L(ue,fe)):L(null,T)}if(i.messages){var U=this.messages();U===o3&&(U=i3()),Q5(U,i.messages),i.messages=U}else i.messages=this.messages();var q={},X=i.keys||Object.keys(this.rules);X.forEach(function(ce){var ue=c.rules[ce],fe=T[ce];ue.forEach(function(re){var ee=re;typeof ee.transform=="function"&&(T===a&&(T=Ft({},T)),fe=T[ce]=ee.transform(fe),fe!=null&&(ee.type=ee.type||(Array.isArray(fe)?"array":ln(fe)))),typeof ee=="function"?ee={validator:ee}:ee=Ft({},ee),ee.validator=c.getValidationMethod(ee),ee.validator&&(ee.field=ce,ee.fullField=ee.fullField||ce,ee.type=c.getType(ee),q[ce]=q[ce]||[],q[ce].push({rule:ee,value:fe,source:T,field:ce}))})});var se={};return EU(q,i,function(ce,ue){var fe=ce.rule,re=(fe.type==="object"||fe.type==="array")&&(ln(fe.fields)==="object"||ln(fe.defaultField)==="object");re=re&&(fe.required||!fe.required&&ce.value),fe.field=ce.field;function ee(Ee,Ne){return Ft(Ft({},Ne),{},{fullField:"".concat(fe.fullField,".").concat(Ee),fullFields:fe.fullFields?[].concat(zr(fe.fullFields),[Ee]):[Ee]})}function ae(){var Ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],Ne=Array.isArray(Ee)?Ee:[Ee];!i.suppressWarning&&Ne.length&&e.warning("async-validator:",Ne),Ne.length&&fe.message!==void 0&&(Ne=[].concat(fe.message));var Xe=Ne.map(J5(fe,T));if(i.first&&Xe.length)return se[fe.field]=1,ue(Xe);if(!re)ue(Xe);else{if(fe.required&&!ce.value)return fe.message!==void 0?Xe=[].concat(fe.message).map(J5(fe,T)):i.error&&(Xe=[i.error(fe,Qa(i.messages.required,fe.field))]),ue(Xe);var Fe={};fe.defaultField&&Object.keys(ce.value).map(function(ft){Fe[ft]=fe.defaultField}),Fe=Ft(Ft({},Fe),ce.rule.fields);var Je={};Object.keys(Fe).forEach(function(ft){var yt=Fe[ft],lt=Array.isArray(yt)?yt:[yt];Je[ft]=lt.map(ee.bind(null,ft))});var Ct=new e(Je);Ct.messages(i.messages),ce.rule.options&&(ce.rule.options.messages=i.messages,ce.rule.options.error=i.error),Ct.validate(ce.value,ce.rule.options||i,function(ft){var yt=[];Xe&&Xe.length&&yt.push.apply(yt,zr(Xe)),ft&&ft.length&&yt.push.apply(yt,zr(ft)),ue(yt.length?yt:null)})}}var ve;if(fe.asyncValidator)ve=fe.asyncValidator(fe,ce.value,ae,ce.source,i);else if(fe.validator){try{ve=fe.validator(fe,ce.value,ae,ce.source,i)}catch(Ee){var Te,pe;(Te=(pe=console).error)===null||Te===void 0||Te.call(pe,Ee),i.suppressValidatorError||setTimeout(function(){throw Ee},0),ae(Ee.message)}ve===!0?ae():ve===!1?ae(typeof fe.message=="function"?fe.message(fe.fullField||fe.field):fe.message||"".concat(fe.fullField||fe.field," fails")):ve instanceof Array?ae(ve):ve instanceof Error&&ae(ve.message)}ve&&ve.then&&ve.then(function(){return ae()},function(Ee){return ae(Ee)})},function(ce){N(ce)},T)}},{key:"getType",value:function(a){if(a.type===void 0&&a.pattern instanceof RegExp&&(a.type="pattern"),typeof a.validator!="function"&&a.type&&!qg.hasOwnProperty(a.type))throw new Error(Qa("Unknown rule type %s",a.type));return a.type||"string"}},{key:"getValidationMethod",value:function(a){if(typeof a.validator=="function")return a.validator;var c=Object.keys(a),d=c.indexOf("message");return d!==-1&&c.splice(d,1),c.length===1&&c[0]==="required"?qg.required:qg[this.getType(a)]||void 0}}]),e}();Et(V_,"register",function(r,a){if(typeof a!="function")throw new Error("Cannot register a validator by type, validator is not a function");qg[r]=a});Et(V_,"warning",xU);Et(V_,"messages",o3);Et(V_,"validators",qg);var Wa="'${name}' is not a valid ${type}",t6={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:Wa,method:Wa,array:Wa,object:Wa,number:Wa,date:Wa,boolean:Wa,integer:Wa,float:Wa,regexp:Wa,email:Wa,url:Wa,hex:Wa},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},tP=V_;function ZU(e,r){return e.replace(/\\?\$\{\w+\}/g,function(a){if(a.startsWith("\\"))return a.slice(1);var c=a.slice(2,-1);return r[c]})}var rP="CODE_LOGIC_ERROR";function l3(e,r,a,c,d){return c3.apply(this,arguments)}function c3(){return c3=dd(pa().mark(function e(r,a,c,d,x){var T,i,L,N,U,q,X,se,ce;return pa().wrap(function(fe){for(;;)switch(fe.prev=fe.next){case 0:return T=Ft({},c),delete T.ruleIndex,tP.warning=function(){},T.validator&&(i=T.validator,T.validator=function(){try{return i.apply(void 0,arguments)}catch(re){return console.error(re),Promise.reject(rP)}}),L=null,T&&T.type==="array"&&T.defaultField&&(L=T.defaultField,delete T.defaultField),N=new tP(Et({},r,[T])),U=ep(t6,d.validateMessages),N.messages(U),q=[],fe.prev=10,fe.next=13,Promise.resolve(N.validate(Et({},r,a),Ft({},d)));case 13:fe.next=18;break;case 15:fe.prev=15,fe.t0=fe.catch(10),fe.t0.errors&&(q=fe.t0.errors.map(function(re,ee){var ae=re.message,ve=ae===rP?U.default:ae;return $.isValidElement(ve)?$.cloneElement(ve,{key:"error_".concat(ee)}):ve}));case 18:if(!(!q.length&&L)){fe.next=23;break}return fe.next=21,Promise.all(a.map(function(re,ee){return l3("".concat(r,".").concat(ee),re,L,d,x)}));case 21:return X=fe.sent,fe.abrupt("return",X.reduce(function(re,ee){return[].concat(zr(re),zr(ee))},[]));case 23:return se=Ft(Ft({},c),{},{name:r,enum:(c.enum||[]).join(", ")},x),ce=q.map(function(re){return typeof re=="string"?ZU(re,se):re}),fe.abrupt("return",ce);case 26:case"end":return fe.stop()}},e,null,[[10,15]])})),c3.apply(this,arguments)}function XU(e,r,a,c,d,x){var T=e.join("."),i=a.map(function(U,q){var X=U.validator,se=Ft(Ft({},U),{},{ruleIndex:q});return X&&(se.validator=function(ce,ue,fe){var re=!1,ee=function(){for(var Te=arguments.length,pe=new Array(Te),Ee=0;Ee<Te;Ee++)pe[Ee]=arguments[Ee];Promise.resolve().then(function(){es(!re,"Your validator function has already return a promise. `callback` will be ignored."),re||fe.apply(void 0,pe)})},ae=X(ce,ue,ee);re=ae&&typeof ae.then=="function"&&typeof ae.catch=="function",es(re,"`callback` is deprecated. Please return a promise instead."),re&&ae.then(function(){fe()}).catch(function(ve){fe(ve||" ")})}),se}).sort(function(U,q){var X=U.warningOnly,se=U.ruleIndex,ce=q.warningOnly,ue=q.ruleIndex;return!!X==!!ce?se-ue:X?1:-1}),L;if(d===!0)L=new Promise(function(){var U=dd(pa().mark(function q(X,se){var ce,ue,fe;return pa().wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:ce=0;case 1:if(!(ce<i.length)){ee.next=12;break}return ue=i[ce],ee.next=5,l3(T,r,ue,c,x);case 5:if(fe=ee.sent,!fe.length){ee.next=9;break}return se([{errors:fe,rule:ue}]),ee.abrupt("return");case 9:ce+=1,ee.next=1;break;case 12:X([]);case 13:case"end":return ee.stop()}},q)}));return function(q,X){return U.apply(this,arguments)}}());else{var N=i.map(function(U){return l3(T,r,U,c,x).then(function(q){return{errors:q,rule:U}})});L=(d?KU(N):YU(N)).then(function(U){return Promise.reject(U)})}return L.catch(function(U){return U}),L}function YU(e){return u3.apply(this,arguments)}function u3(){return u3=dd(pa().mark(function e(r){return pa().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",Promise.all(r).then(function(d){var x,T=(x=[]).concat.apply(x,zr(d));return T}));case 1:case"end":return c.stop()}},e)})),u3.apply(this,arguments)}function KU(e){return h3.apply(this,arguments)}function h3(){return h3=dd(pa().mark(function e(r){var a;return pa().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return a=0,d.abrupt("return",new Promise(function(x){r.forEach(function(T){T.then(function(i){i.errors.length&&x([i]),a+=1,a===r.length&&x([])})})}));case 2:case"end":return d.stop()}},e)})),h3.apply(this,arguments)}function Xi(e){return n3(e)}function nP(e,r){var a={};return r.forEach(function(c){var d=bs(e,c);a=_s(a,c,d)}),a}function up(e,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return e&&e.some(function(c){return r6(r,c,a)})}function r6(e,r){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return!e||!r||!a&&e.length!==r.length?!1:r.every(function(c,d){return e[d]===c})}function JU(e,r){if(e===r)return!0;if(!e&&r||e&&!r||!e||!r||ln(e)!=="object"||ln(r)!=="object")return!1;var a=Object.keys(e),c=Object.keys(r),d=new Set([].concat(a,c));return zr(d).every(function(x){var T=e[x],i=r[x];return typeof T=="function"&&typeof i=="function"?!0:T===i})}function QU(e){var r=arguments.length<=1?void 0:arguments[1];return r&&r.target&&ln(r.target)==="object"&&e in r.target?r.target[e]:r}function iP(e,r,a){var c=e.length;if(r<0||r>=c||a<0||a>=c)return e;var d=e[r],x=r-a;return x>0?[].concat(zr(e.slice(0,a)),[d],zr(e.slice(a,r)),zr(e.slice(r+1,c))):x<0?[].concat(zr(e.slice(0,r)),zr(e.slice(r+1,a+1)),[d],zr(e.slice(a+1,c))):e}var eG=["name"],ps=[];function m2(e,r,a,c,d,x){return typeof e=="function"?e(r,a,"source"in x?{source:x.source}:{}):c!==d}var ZE=function(e){Hu(a,e);var r=Wu(a);function a(c){var d;if(Ao(this,a),d=r.call(this,c),Et(Sn(d),"state",{resetCount:0}),Et(Sn(d),"cancelRegisterFunc",null),Et(Sn(d),"mounted",!1),Et(Sn(d),"touched",!1),Et(Sn(d),"dirty",!1),Et(Sn(d),"validatePromise",void 0),Et(Sn(d),"prevValidating",void 0),Et(Sn(d),"errors",ps),Et(Sn(d),"warnings",ps),Et(Sn(d),"cancelRegister",function(){var L=d.props,N=L.preserve,U=L.isListField,q=L.name;d.cancelRegisterFunc&&d.cancelRegisterFunc(U,N,Xi(q)),d.cancelRegisterFunc=null}),Et(Sn(d),"getNamePath",function(){var L=d.props,N=L.name,U=L.fieldContext,q=U.prefixName,X=q===void 0?[]:q;return N!==void 0?[].concat(zr(X),zr(N)):[]}),Et(Sn(d),"getRules",function(){var L=d.props,N=L.rules,U=N===void 0?[]:N,q=L.fieldContext;return U.map(function(X){return typeof X=="function"?X(q):X})}),Et(Sn(d),"refresh",function(){d.mounted&&d.setState(function(L){var N=L.resetCount;return{resetCount:N+1}})}),Et(Sn(d),"metaCache",null),Et(Sn(d),"triggerMetaEvent",function(L){var N=d.props.onMetaChange;if(N){var U=Ft(Ft({},d.getMeta()),{},{destroy:L});TS(d.metaCache,U)||N(U),d.metaCache=U}else d.metaCache=null}),Et(Sn(d),"onStoreChange",function(L,N,U){var q=d.props,X=q.shouldUpdate,se=q.dependencies,ce=se===void 0?[]:se,ue=q.onReset,fe=U.store,re=d.getNamePath(),ee=d.getValue(L),ae=d.getValue(fe),ve=N&&up(N,re);switch(U.type==="valueUpdate"&&U.source==="external"&&!TS(ee,ae)&&(d.touched=!0,d.dirty=!0,d.validatePromise=null,d.errors=ps,d.warnings=ps,d.triggerMetaEvent()),U.type){case"reset":if(!N||ve){d.touched=!1,d.dirty=!1,d.validatePromise=void 0,d.errors=ps,d.warnings=ps,d.triggerMetaEvent(),ue==null||ue(),d.refresh();return}break;case"remove":{if(X&&m2(X,L,fe,ee,ae,U)){d.reRender();return}break}case"setField":{var Te=U.data;if(ve){"touched"in Te&&(d.touched=Te.touched),"validating"in Te&&!("originRCField"in Te)&&(d.validatePromise=Te.validating?Promise.resolve([]):null),"errors"in Te&&(d.errors=Te.errors||ps),"warnings"in Te&&(d.warnings=Te.warnings||ps),d.dirty=!0,d.triggerMetaEvent(),d.reRender();return}else if("value"in Te&&up(N,re,!0)){d.reRender();return}if(X&&!re.length&&m2(X,L,fe,ee,ae,U)){d.reRender();return}break}case"dependenciesUpdate":{var pe=ce.map(Xi);if(pe.some(function(Ee){return up(U.relatedFields,Ee)})){d.reRender();return}break}default:if(ve||(!ce.length||re.length||X)&&m2(X,L,fe,ee,ae,U)){d.reRender();return}break}X===!0&&d.reRender()}),Et(Sn(d),"validateRules",function(L){var N=d.getNamePath(),U=d.getValue(),q=L||{},X=q.triggerName,se=q.validateOnly,ce=se===void 0?!1:se,ue=Promise.resolve().then(dd(pa().mark(function fe(){var re,ee,ae,ve,Te,pe,Ee;return pa().wrap(function(Xe){for(;;)switch(Xe.prev=Xe.next){case 0:if(d.mounted){Xe.next=2;break}return Xe.abrupt("return",[]);case 2:if(re=d.props,ee=re.validateFirst,ae=ee===void 0?!1:ee,ve=re.messageVariables,Te=re.validateDebounce,pe=d.getRules(),X&&(pe=pe.filter(function(Fe){return Fe}).filter(function(Fe){var Je=Fe.validateTrigger;if(!Je)return!0;var Ct=n3(Je);return Ct.includes(X)})),!(Te&&X)){Xe.next=10;break}return Xe.next=8,new Promise(function(Fe){setTimeout(Fe,Te)});case 8:if(d.validatePromise===ue){Xe.next=10;break}return Xe.abrupt("return",[]);case 10:return Ee=XU(N,U,pe,L,ae,ve),Ee.catch(function(Fe){return Fe}).then(function(){var Fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ps;if(d.validatePromise===ue){var Je;d.validatePromise=null;var Ct=[],ft=[];(Je=Fe.forEach)===null||Je===void 0||Je.call(Fe,function(yt){var lt=yt.rule.warningOnly,ct=yt.errors,Ye=ct===void 0?ps:ct;lt?ft.push.apply(ft,zr(Ye)):Ct.push.apply(Ct,zr(Ye))}),d.errors=Ct,d.warnings=ft,d.triggerMetaEvent(),d.reRender()}}),Xe.abrupt("return",Ee);case 13:case"end":return Xe.stop()}},fe)})));return ce||(d.validatePromise=ue,d.dirty=!0,d.errors=ps,d.warnings=ps,d.triggerMetaEvent(),d.reRender()),ue}),Et(Sn(d),"isFieldValidating",function(){return!!d.validatePromise}),Et(Sn(d),"isFieldTouched",function(){return d.touched}),Et(Sn(d),"isFieldDirty",function(){if(d.dirty||d.props.initialValue!==void 0)return!0;var L=d.props.fieldContext,N=L.getInternalHooks(Gh),U=N.getInitialValue;return U(d.getNamePath())!==void 0}),Et(Sn(d),"getErrors",function(){return d.errors}),Et(Sn(d),"getWarnings",function(){return d.warnings}),Et(Sn(d),"isListField",function(){return d.props.isListField}),Et(Sn(d),"isList",function(){return d.props.isList}),Et(Sn(d),"isPreserve",function(){return d.props.preserve}),Et(Sn(d),"getMeta",function(){d.prevValidating=d.isFieldValidating();var L={touched:d.isFieldTouched(),validating:d.prevValidating,errors:d.errors,warnings:d.warnings,name:d.getNamePath(),validated:d.validatePromise===null};return L}),Et(Sn(d),"getOnlyChild",function(L){if(typeof L=="function"){var N=d.getMeta();return Ft(Ft({},d.getOnlyChild(L(d.getControlled(),N,d.props.fieldContext))),{},{isFunction:!0})}var U=Yh(L);return U.length!==1||!$.isValidElement(U[0])?{child:U,isFunction:!1}:{child:U[0],isFunction:!1}}),Et(Sn(d),"getValue",function(L){var N=d.props.fieldContext.getFieldsValue,U=d.getNamePath();return bs(L||N(!0),U)}),Et(Sn(d),"getControlled",function(){var L=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},N=d.props,U=N.name,q=N.trigger,X=N.validateTrigger,se=N.getValueFromEvent,ce=N.normalize,ue=N.valuePropName,fe=N.getValueProps,re=N.fieldContext,ee=X!==void 0?X:re.validateTrigger,ae=d.getNamePath(),ve=re.getInternalHooks,Te=re.getFieldsValue,pe=ve(Gh),Ee=pe.dispatch,Ne=d.getValue(),Xe=fe||function(yt){return Et({},ue,yt)},Fe=L[q],Je=U!==void 0?Xe(Ne):{},Ct=Ft(Ft({},L),Je);Ct[q]=function(){d.touched=!0,d.dirty=!0,d.triggerMetaEvent();for(var yt,lt=arguments.length,ct=new Array(lt),Ye=0;Ye<lt;Ye++)ct[Ye]=arguments[Ye];se?yt=se.apply(void 0,ct):yt=QU.apply(void 0,[ue].concat(ct)),ce&&(yt=ce(yt,Ne,Te(!0))),yt!==Ne&&Ee({type:"updateValue",namePath:ae,value:yt}),Fe&&Fe.apply(void 0,ct)};var ft=n3(ee||[]);return ft.forEach(function(yt){var lt=Ct[yt];Ct[yt]=function(){lt&&lt.apply(void 0,arguments);var ct=d.props.rules;ct&&ct.length&&Ee({type:"validateField",namePath:ae,triggerName:yt})}}),Ct}),c.fieldContext){var x=c.fieldContext.getInternalHooks,T=x(Gh),i=T.initEntityValue;i(Sn(d))}return d}return Ro(a,[{key:"componentDidMount",value:function(){var d=this.props,x=d.shouldUpdate,T=d.fieldContext;if(this.mounted=!0,T){var i=T.getInternalHooks,L=i(Gh),N=L.registerField;this.cancelRegisterFunc=N(this)}x===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var d=this.state.resetCount,x=this.props.children,T=this.getOnlyChild(x),i=T.child,L=T.isFunction,N;return L?N=i:$.isValidElement(i)?N=$.cloneElement(i,this.getControlled(i.props)):(es(!i,"`children` of Field is not validate ReactElement."),N=i),$.createElement($.Fragment,{key:d},N)}}]),a}($.Component);Et(ZE,"contextType",id);Et(ZE,"defaultProps",{trigger:"onChange",valuePropName:"value"});function XE(e){var r,a=e.name,c=is(e,eG),d=$.useContext(id),x=$.useContext(S_),T=a!==void 0?Xi(a):void 0,i=(r=c.isListField)!==null&&r!==void 0?r:!!x,L="keep";return i||(L="_".concat((T||[]).join("_"))),$.createElement(ZE,Po({key:L,name:T,isListField:i},c,{fieldContext:d}))}function n6(e){var r=e.name,a=e.initialValue,c=e.children,d=e.rules,x=e.validateTrigger,T=e.isListField,i=$.useContext(id),L=$.useContext(S_),N=$.useRef({keys:[],id:0}),U=N.current,q=$.useMemo(function(){var ue=Xi(i.prefixName)||[];return[].concat(zr(ue),zr(Xi(r)))},[i.prefixName,r]),X=$.useMemo(function(){return Ft(Ft({},i),{},{prefixName:q})},[i,q]),se=$.useMemo(function(){return{getKey:function(fe){var re=q.length,ee=fe[re];return[U.keys[ee],fe.slice(re+1)]}}},[q]);if(typeof c!="function")return es(!1,"Form.List only accepts function as children."),null;var ce=function(fe,re,ee){var ae=ee.source;return ae==="internal"?!1:fe!==re};return $.createElement(S_.Provider,{value:se},$.createElement(id.Provider,{value:X},$.createElement(XE,{name:[],shouldUpdate:ce,rules:d,validateTrigger:x,initialValue:a,isList:!0,isListField:T??!!L},function(ue,fe){var re=ue.value,ee=re===void 0?[]:re,ae=ue.onChange,ve=i.getFieldValue,Te=function(){var Xe=ve(q||[]);return Xe||[]},pe={add:function(Xe,Fe){var Je=Te();Fe>=0&&Fe<=Je.length?(U.keys=[].concat(zr(U.keys.slice(0,Fe)),[U.id],zr(U.keys.slice(Fe))),ae([].concat(zr(Je.slice(0,Fe)),[Xe],zr(Je.slice(Fe))))):(U.keys=[].concat(zr(U.keys),[U.id]),ae([].concat(zr(Je),[Xe]))),U.id+=1},remove:function(Xe){var Fe=Te(),Je=new Set(Array.isArray(Xe)?Xe:[Xe]);Je.size<=0||(U.keys=U.keys.filter(function(Ct,ft){return!Je.has(ft)}),ae(Fe.filter(function(Ct,ft){return!Je.has(ft)})))},move:function(Xe,Fe){if(Xe!==Fe){var Je=Te();Xe<0||Xe>=Je.length||Fe<0||Fe>=Je.length||(U.keys=iP(U.keys,Xe,Fe),ae(iP(Je,Xe,Fe)))}}},Ee=ee||[];return Array.isArray(Ee)||(Ee=[]),c(Ee.map(function(Ne,Xe){var Fe=U.keys[Xe];return Fe===void 0&&(U.keys[Xe]=U.id,Fe=U.keys[Xe],U.id+=1),{name:Xe,key:Fe,isListField:!0}}),pe,fe)})))}function tG(e){var r=!1,a=e.length,c=[];return e.length?new Promise(function(d,x){e.forEach(function(T,i){T.catch(function(L){return r=!0,L}).then(function(L){a-=1,c[i]=L,!(a>0)&&(r&&x(c),d(c))})})}):Promise.resolve([])}var i6="__@field_split__";function g2(e){return e.map(function(r){return"".concat(ln(r),":").concat(r)}).join(i6)}var kf=function(){function e(){Ao(this,e),Et(this,"kvs",new Map)}return Ro(e,[{key:"set",value:function(a,c){this.kvs.set(g2(a),c)}},{key:"get",value:function(a){return this.kvs.get(g2(a))}},{key:"update",value:function(a,c){var d=this.get(a),x=c(d);x?this.set(a,x):this.delete(a)}},{key:"delete",value:function(a){this.kvs.delete(g2(a))}},{key:"map",value:function(a){return zr(this.kvs.entries()).map(function(c){var d=Sr(c,2),x=d[0],T=d[1],i=x.split(i6);return a({key:i.map(function(L){var N=L.match(/^([^:]*):(.*)$/),U=Sr(N,3),q=U[1],X=U[2];return q==="number"?Number(X):X}),value:T})})}},{key:"toJSON",value:function(){var a={};return this.map(function(c){var d=c.key,x=c.value;return a[d.join(".")]=x,null}),a}}]),e}(),rG=["name"],nG=Ro(function e(r){var a=this;Ao(this,e),Et(this,"formHooked",!1),Et(this,"forceRootUpdate",void 0),Et(this,"subscribable",!0),Et(this,"store",{}),Et(this,"fieldEntities",[]),Et(this,"initialValues",{}),Et(this,"callbacks",{}),Et(this,"validateMessages",null),Et(this,"preserve",null),Et(this,"lastValidatePromise",null),Et(this,"getForm",function(){return{getFieldValue:a.getFieldValue,getFieldsValue:a.getFieldsValue,getFieldError:a.getFieldError,getFieldWarning:a.getFieldWarning,getFieldsError:a.getFieldsError,isFieldsTouched:a.isFieldsTouched,isFieldTouched:a.isFieldTouched,isFieldValidating:a.isFieldValidating,isFieldsValidating:a.isFieldsValidating,resetFields:a.resetFields,setFields:a.setFields,setFieldValue:a.setFieldValue,setFieldsValue:a.setFieldsValue,validateFields:a.validateFields,submit:a.submit,_init:!0,getInternalHooks:a.getInternalHooks}}),Et(this,"getInternalHooks",function(c){return c===Gh?(a.formHooked=!0,{dispatch:a.dispatch,initEntityValue:a.initEntityValue,registerField:a.registerField,useSubscribe:a.useSubscribe,setInitialValues:a.setInitialValues,destroyForm:a.destroyForm,setCallbacks:a.setCallbacks,setValidateMessages:a.setValidateMessages,getFields:a.getFields,setPreserve:a.setPreserve,getInitialValue:a.getInitialValue,registerWatch:a.registerWatch}):(es(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)}),Et(this,"useSubscribe",function(c){a.subscribable=c}),Et(this,"prevWithoutPreserves",null),Et(this,"setInitialValues",function(c,d){if(a.initialValues=c||{},d){var x,T=ep(c,a.store);(x=a.prevWithoutPreserves)===null||x===void 0||x.map(function(i){var L=i.key;T=_s(T,L,bs(c,L))}),a.prevWithoutPreserves=null,a.updateStore(T)}}),Et(this,"destroyForm",function(c){if(c)a.updateStore({});else{var d=new kf;a.getFieldEntities(!0).forEach(function(x){a.isMergedPreserve(x.isPreserve())||d.set(x.getNamePath(),!0)}),a.prevWithoutPreserves=d}}),Et(this,"getInitialValue",function(c){var d=bs(a.initialValues,c);return c.length?ep(d):d}),Et(this,"setCallbacks",function(c){a.callbacks=c}),Et(this,"setValidateMessages",function(c){a.validateMessages=c}),Et(this,"setPreserve",function(c){a.preserve=c}),Et(this,"watchList",[]),Et(this,"registerWatch",function(c){return a.watchList.push(c),function(){a.watchList=a.watchList.filter(function(d){return d!==c})}}),Et(this,"notifyWatch",function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(a.watchList.length){var d=a.getFieldsValue(),x=a.getFieldsValue(!0);a.watchList.forEach(function(T){T(d,x,c)})}}),Et(this,"timeoutId",null),Et(this,"warningUnhooked",function(){}),Et(this,"updateStore",function(c){a.store=c}),Et(this,"getFieldEntities",function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return c?a.fieldEntities.filter(function(d){return d.getNamePath().length}):a.fieldEntities}),Et(this,"getFieldsMap",function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,d=new kf;return a.getFieldEntities(c).forEach(function(x){var T=x.getNamePath();d.set(T,x)}),d}),Et(this,"getFieldEntitiesForNamePathList",function(c){if(!c)return a.getFieldEntities(!0);var d=a.getFieldsMap(!0);return c.map(function(x){var T=Xi(x);return d.get(T)||{INVALIDATE_NAME_PATH:Xi(x)}})}),Et(this,"getFieldsValue",function(c,d){a.warningUnhooked();var x,T,i;if(c===!0||Array.isArray(c)?(x=c,T=d):c&&ln(c)==="object"&&(i=c.strict,T=c.filter),x===!0&&!T)return a.store;var L=a.getFieldEntitiesForNamePathList(Array.isArray(x)?x:null),N=[];return L.forEach(function(U){var q,X,se="INVALIDATE_NAME_PATH"in U?U.INVALIDATE_NAME_PATH:U.getNamePath();if(i){var ce,ue;if((ce=(ue=U).isList)!==null&&ce!==void 0&&ce.call(ue))return}else if(!x&&(q=(X=U).isListField)!==null&&q!==void 0&&q.call(X))return;if(!T)N.push(se);else{var fe="getMeta"in U?U.getMeta():null;T(fe)&&N.push(se)}}),nP(a.store,N.map(Xi))}),Et(this,"getFieldValue",function(c){a.warningUnhooked();var d=Xi(c);return bs(a.store,d)}),Et(this,"getFieldsError",function(c){a.warningUnhooked();var d=a.getFieldEntitiesForNamePathList(c);return d.map(function(x,T){return x&&!("INVALIDATE_NAME_PATH"in x)?{name:x.getNamePath(),errors:x.getErrors(),warnings:x.getWarnings()}:{name:Xi(c[T]),errors:[],warnings:[]}})}),Et(this,"getFieldError",function(c){a.warningUnhooked();var d=Xi(c),x=a.getFieldsError([d])[0];return x.errors}),Et(this,"getFieldWarning",function(c){a.warningUnhooked();var d=Xi(c),x=a.getFieldsError([d])[0];return x.warnings}),Et(this,"isFieldsTouched",function(){a.warningUnhooked();for(var c=arguments.length,d=new Array(c),x=0;x<c;x++)d[x]=arguments[x];var T=d[0],i=d[1],L,N=!1;d.length===0?L=null:d.length===1?Array.isArray(T)?(L=T.map(Xi),N=!1):(L=null,N=T):(L=T.map(Xi),N=i);var U=a.getFieldEntities(!0),q=function(fe){return fe.isFieldTouched()};if(!L)return N?U.every(function(ue){return q(ue)||ue.isList()}):U.some(q);var X=new kf;L.forEach(function(ue){X.set(ue,[])}),U.forEach(function(ue){var fe=ue.getNamePath();L.forEach(function(re){re.every(function(ee,ae){return fe[ae]===ee})&&X.update(re,function(ee){return[].concat(zr(ee),[ue])})})});var se=function(fe){return fe.some(q)},ce=X.map(function(ue){var fe=ue.value;return fe});return N?ce.every(se):ce.some(se)}),Et(this,"isFieldTouched",function(c){return a.warningUnhooked(),a.isFieldsTouched([c])}),Et(this,"isFieldsValidating",function(c){a.warningUnhooked();var d=a.getFieldEntities();if(!c)return d.some(function(T){return T.isFieldValidating()});var x=c.map(Xi);return d.some(function(T){var i=T.getNamePath();return up(x,i)&&T.isFieldValidating()})}),Et(this,"isFieldValidating",function(c){return a.warningUnhooked(),a.isFieldsValidating([c])}),Et(this,"resetWithFieldInitialValue",function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},d=new kf,x=a.getFieldEntities(!0);x.forEach(function(L){var N=L.props.initialValue,U=L.getNamePath();if(N!==void 0){var q=d.get(U)||new Set;q.add({entity:L,value:N}),d.set(U,q)}});var T=function(N){N.forEach(function(U){var q=U.props.initialValue;if(q!==void 0){var X=U.getNamePath(),se=a.getInitialValue(X);if(se!==void 0)es(!1,"Form already set 'initialValues' with path '".concat(X.join("."),"'. Field can not overwrite it."));else{var ce=d.get(X);if(ce&&ce.size>1)es(!1,"Multiple Field with path '".concat(X.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(ce){var ue=a.getFieldValue(X),fe=U.isListField();!fe&&(!c.skipExist||ue===void 0)&&a.updateStore(_s(a.store,X,zr(ce)[0].value))}}}})},i;c.entities?i=c.entities:c.namePathList?(i=[],c.namePathList.forEach(function(L){var N=d.get(L);if(N){var U;(U=i).push.apply(U,zr(zr(N).map(function(q){return q.entity})))}})):i=x,T(i)}),Et(this,"resetFields",function(c){a.warningUnhooked();var d=a.store;if(!c){a.updateStore(ep(a.initialValues)),a.resetWithFieldInitialValue(),a.notifyObservers(d,null,{type:"reset"}),a.notifyWatch();return}var x=c.map(Xi);x.forEach(function(T){var i=a.getInitialValue(T);a.updateStore(_s(a.store,T,i))}),a.resetWithFieldInitialValue({namePathList:x}),a.notifyObservers(d,x,{type:"reset"}),a.notifyWatch(x)}),Et(this,"setFields",function(c){a.warningUnhooked();var d=a.store,x=[];c.forEach(function(T){var i=T.name,L=is(T,rG),N=Xi(i);x.push(N),"value"in L&&a.updateStore(_s(a.store,N,L.value)),a.notifyObservers(d,[N],{type:"setField",data:T})}),a.notifyWatch(x)}),Et(this,"getFields",function(){var c=a.getFieldEntities(!0),d=c.map(function(x){var T=x.getNamePath(),i=x.getMeta(),L=Ft(Ft({},i),{},{name:T,value:a.getFieldValue(T)});return Object.defineProperty(L,"originRCField",{value:!0}),L});return d}),Et(this,"initEntityValue",function(c){var d=c.props.initialValue;if(d!==void 0){var x=c.getNamePath(),T=bs(a.store,x);T===void 0&&a.updateStore(_s(a.store,x,d))}}),Et(this,"isMergedPreserve",function(c){var d=c!==void 0?c:a.preserve;return d??!0}),Et(this,"registerField",function(c){a.fieldEntities.push(c);var d=c.getNamePath();if(a.notifyWatch([d]),c.props.initialValue!==void 0){var x=a.store;a.resetWithFieldInitialValue({entities:[c],skipExist:!0}),a.notifyObservers(x,[c.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(T,i){var L=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(a.fieldEntities=a.fieldEntities.filter(function(q){return q!==c}),!a.isMergedPreserve(i)&&(!T||L.length>1)){var N=T?void 0:a.getInitialValue(d);if(d.length&&a.getFieldValue(d)!==N&&a.fieldEntities.every(function(q){return!r6(q.getNamePath(),d)})){var U=a.store;a.updateStore(_s(U,d,N,!0)),a.notifyObservers(U,[d],{type:"remove"}),a.triggerDependenciesUpdate(U,d)}}a.notifyWatch([d])}}),Et(this,"dispatch",function(c){switch(c.type){case"updateValue":{var d=c.namePath,x=c.value;a.updateValue(d,x);break}case"validateField":{var T=c.namePath,i=c.triggerName;a.validateFields([T],{triggerName:i});break}}}),Et(this,"notifyObservers",function(c,d,x){if(a.subscribable){var T=Ft(Ft({},x),{},{store:a.getFieldsValue(!0)});a.getFieldEntities().forEach(function(i){var L=i.onStoreChange;L(c,d,T)})}else a.forceRootUpdate()}),Et(this,"triggerDependenciesUpdate",function(c,d){var x=a.getDependencyChildrenFields(d);return x.length&&a.validateFields(x),a.notifyObservers(c,x,{type:"dependenciesUpdate",relatedFields:[d].concat(zr(x))}),x}),Et(this,"updateValue",function(c,d){var x=Xi(c),T=a.store;a.updateStore(_s(a.store,x,d)),a.notifyObservers(T,[x],{type:"valueUpdate",source:"internal"}),a.notifyWatch([x]);var i=a.triggerDependenciesUpdate(T,x),L=a.callbacks.onValuesChange;if(L){var N=nP(a.store,[x]);L(N,a.getFieldsValue())}a.triggerOnFieldsChange([x].concat(zr(i)))}),Et(this,"setFieldsValue",function(c){a.warningUnhooked();var d=a.store;if(c){var x=ep(a.store,c);a.updateStore(x)}a.notifyObservers(d,null,{type:"valueUpdate",source:"external"}),a.notifyWatch()}),Et(this,"setFieldValue",function(c,d){a.setFields([{name:c,value:d,errors:[],warnings:[]}])}),Et(this,"getDependencyChildrenFields",function(c){var d=new Set,x=[],T=new kf;a.getFieldEntities().forEach(function(L){var N=L.props.dependencies;(N||[]).forEach(function(U){var q=Xi(U);T.update(q,function(){var X=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return X.add(L),X})})});var i=function L(N){var U=T.get(N)||new Set;U.forEach(function(q){if(!d.has(q)){d.add(q);var X=q.getNamePath();q.isFieldDirty()&&X.length&&(x.push(X),L(X))}})};return i(c),x}),Et(this,"triggerOnFieldsChange",function(c,d){var x=a.callbacks.onFieldsChange;if(x){var T=a.getFields();if(d){var i=new kf;d.forEach(function(N){var U=N.name,q=N.errors;i.set(U,q)}),T.forEach(function(N){N.errors=i.get(N.name)||N.errors})}var L=T.filter(function(N){var U=N.name;return up(c,U)});L.length&&x(L,T)}}),Et(this,"validateFields",function(c,d){a.warningUnhooked();var x,T;Array.isArray(c)||typeof c=="string"||typeof d=="string"?(x=c,T=d):T=c;var i=!!x,L=i?x.map(Xi):[],N=[],U=String(Date.now()),q=new Set,X=T||{},se=X.recursive,ce=X.dirty;a.getFieldEntities(!0).forEach(function(ee){if(i||L.push(ee.getNamePath()),!(!ee.props.rules||!ee.props.rules.length)&&!(ce&&!ee.isFieldDirty())){var ae=ee.getNamePath();if(q.add(ae.join(U)),!i||up(L,ae,se)){var ve=ee.validateRules(Ft({validateMessages:Ft(Ft({},t6),a.validateMessages)},T));N.push(ve.then(function(){return{name:ae,errors:[],warnings:[]}}).catch(function(Te){var pe,Ee=[],Ne=[];return(pe=Te.forEach)===null||pe===void 0||pe.call(Te,function(Xe){var Fe=Xe.rule.warningOnly,Je=Xe.errors;Fe?Ne.push.apply(Ne,zr(Je)):Ee.push.apply(Ee,zr(Je))}),Ee.length?Promise.reject({name:ae,errors:Ee,warnings:Ne}):{name:ae,errors:Ee,warnings:Ne}}))}}});var ue=tG(N);a.lastValidatePromise=ue,ue.catch(function(ee){return ee}).then(function(ee){var ae=ee.map(function(ve){var Te=ve.name;return Te});a.notifyObservers(a.store,ae,{type:"validateFinish"}),a.triggerOnFieldsChange(ae,ee)});var fe=ue.then(function(){return a.lastValidatePromise===ue?Promise.resolve(a.getFieldsValue(L)):Promise.reject([])}).catch(function(ee){var ae=ee.filter(function(ve){return ve&&ve.errors.length});return Promise.reject({values:a.getFieldsValue(L),errorFields:ae,outOfDate:a.lastValidatePromise!==ue})});fe.catch(function(ee){return ee});var re=L.filter(function(ee){return q.has(ee.join(U))});return a.triggerOnFieldsChange(re),fe}),Et(this,"submit",function(){a.warningUnhooked(),a.validateFields().then(function(c){var d=a.callbacks.onFinish;if(d)try{d(c)}catch(x){console.error(x)}}).catch(function(c){var d=a.callbacks.onFinishFailed;d&&d(c)})}),this.forceRootUpdate=r});function YE(e){var r=$.useRef(),a=$.useState({}),c=Sr(a,2),d=c[1];if(!r.current)if(e)r.current=e;else{var x=function(){d({})},T=new nG(x);r.current=T.getForm()}return[r.current]}var d3=$.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),o6=function(r){var a=r.validateMessages,c=r.onFormChange,d=r.onFormFinish,x=r.children,T=$.useContext(d3),i=$.useRef({});return $.createElement(d3.Provider,{value:Ft(Ft({},T),{},{validateMessages:Ft(Ft({},T.validateMessages),a),triggerFormChange:function(N,U){c&&c(N,{changedFields:U,forms:i.current}),T.triggerFormChange(N,U)},triggerFormFinish:function(N,U){d&&d(N,{values:U,forms:i.current}),T.triggerFormFinish(N,U)},registerForm:function(N,U){N&&(i.current=Ft(Ft({},i.current),{},Et({},N,U))),T.registerForm(N,U)},unregisterForm:function(N){var U=Ft({},i.current);delete U[N],i.current=U,T.unregisterForm(N)}})},x)},iG=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed","clearOnDestroy"],oG=function(r,a){var c=r.name,d=r.initialValues,x=r.fields,T=r.form,i=r.preserve,L=r.children,N=r.component,U=N===void 0?"form":N,q=r.validateMessages,X=r.validateTrigger,se=X===void 0?"onChange":X,ce=r.onValuesChange,ue=r.onFieldsChange,fe=r.onFinish,re=r.onFinishFailed,ee=r.clearOnDestroy,ae=is(r,iG),ve=$.useRef(null),Te=$.useContext(d3),pe=YE(T),Ee=Sr(pe,1),Ne=Ee[0],Xe=Ne.getInternalHooks(Gh),Fe=Xe.useSubscribe,Je=Xe.setInitialValues,Ct=Xe.setCallbacks,ft=Xe.setValidateMessages,yt=Xe.setPreserve,lt=Xe.destroyForm;$.useImperativeHandle(a,function(){return Ft(Ft({},Ne),{},{nativeElement:ve.current})}),$.useEffect(function(){return Te.registerForm(c,Ne),function(){Te.unregisterForm(c)}},[Te,Ne,c]),ft(Ft(Ft({},Te.validateMessages),q)),Ct({onValuesChange:ce,onFieldsChange:function(qt){if(Te.triggerFormChange(c,qt),ue){for(var or=arguments.length,cr=new Array(or>1?or-1:0),Qt=1;Qt<or;Qt++)cr[Qt-1]=arguments[Qt];ue.apply(void 0,[qt].concat(cr))}},onFinish:function(qt){Te.triggerFormFinish(c,qt),fe&&fe(qt)},onFinishFailed:re}),yt(i);var ct=$.useRef(null);Je(d,!ct.current),ct.current||(ct.current=!0),$.useEffect(function(){return function(){return lt(ee)}},[]);var Ye,Ke=typeof L=="function";if(Ke){var tt=Ne.getFieldsValue(!0);Ye=L(tt,Ne)}else Ye=L;Fe(!Ke);var ht=$.useRef();$.useEffect(function(){JU(ht.current||[],x||[])||Ne.setFields(x||[]),ht.current=x},[x,Ne]);var vt=$.useMemo(function(){return Ft(Ft({},Ne),{},{validateTrigger:se})},[Ne,se]),At=$.createElement(S_.Provider,{value:null},$.createElement(id.Provider,{value:vt},Ye));return U===!1?At:$.createElement(U,Po({},ae,{ref:ve,onSubmit:function(qt){qt.preventDefault(),qt.stopPropagation(),Ne.submit()},onReset:function(qt){var or;qt.preventDefault(),Ne.resetFields(),(or=ae.onReset)===null||or===void 0||or.call(ae,qt)}}),At)};function oP(e){try{return JSON.stringify(e)}catch{return Math.random()}}function a6(){for(var e=arguments.length,r=new Array(e),a=0;a<e;a++)r[a]=arguments[a];var c=r[0],d=r[1],x=d===void 0?{}:d,T=gU(x)?{form:x}:x,i=T.form,L=$.useState(),N=Sr(L,2),U=N[0],q=N[1],X=$.useMemo(function(){return oP(U)},[U]),se=$.useRef(X);se.current=X;var ce=$.useContext(id),ue=i||ce,fe=ue&&ue._init,re=Xi(c),ee=$.useRef(re);return ee.current=re,$.useEffect(function(){if(fe){var ae=ue.getFieldsValue,ve=ue.getInternalHooks,Te=ve(Gh),pe=Te.registerWatch,Ee=function(Je,Ct){var ft=T.preserve?Ct:Je;return typeof c=="function"?c(ft):bs(ft,ee.current)},Ne=pe(function(Fe,Je){var Ct=Ee(Fe,Je),ft=oP(Ct);se.current!==ft&&(se.current=ft,q(Ct))}),Xe=Ee(ae(),ae(!0));return U!==Xe&&q(Xe),Ne}},[fe]),U}var aG=$.forwardRef(oG),Dp=aG;Dp.FormProvider=o6;Dp.Field=XE;Dp.List=n6;Dp.useForm=YE;Dp.useWatch=a6;const Mc=$.createContext({labelAlign:"right",vertical:!1,itemRef:()=>{}}),s6=$.createContext(null),l6=e=>{const r=ud(e,["prefixCls"]);return $.createElement(o6,Object.assign({},r))},KE=$.createContext({prefixCls:""}),$u=$.createContext({}),sG=e=>{let{children:r,status:a,override:c}=e;const d=$.useContext($u),x=$.useMemo(()=>{const T=Object.assign({},d);return c&&delete T.isFormItemInput,a&&(delete T.status,delete T.hasFeedback,delete T.feedbackIcon),T},[a,c,d]);return $.createElement($u.Provider,{value:x},r)},lG=$.createContext(void 0),cG=e=>{const{space:r,form:a,children:c}=e;if(c==null)return null;let d=c;return a&&(d=sn.createElement(sG,{override:!0,status:!0},d)),r&&(d=sn.createElement(Y$,null,d)),d},uG=cG,hG=e=>{const{prefixCls:r,className:a,style:c,size:d,shape:x}=e,T=Mr({[`${r}-lg`]:d==="large",[`${r}-sm`]:d==="small"}),i=Mr({[`${r}-circle`]:x==="circle",[`${r}-square`]:x==="square",[`${r}-round`]:x==="round"}),L=$.useMemo(()=>typeof d=="number"?{width:d,height:d,lineHeight:`${d}px`}:{},[d]);return $.createElement("span",{className:Mr(r,T,i,a),style:Object.assign(Object.assign({},L),c)})},cx=hG,dG=new _a("ant-skeleton-loading",{"0%":{backgroundPosition:"100% 50%"},"100%":{backgroundPosition:"0 50%"}}),ux=e=>({height:e,lineHeight:fn(e)}),hp=e=>Object.assign({width:e},ux(e)),fG=e=>({background:e.skeletonLoadingBackground,backgroundSize:"400% 100%",animationName:dG,animationDuration:e.skeletonLoadingMotionDuration,animationTimingFunction:"ease",animationIterationCount:"infinite"}),_2=(e,r)=>Object.assign({width:r(e).mul(5).equal(),minWidth:r(e).mul(5).equal()},ux(e)),pG=e=>{const{skeletonAvatarCls:r,gradientFromColor:a,controlHeight:c,controlHeightLG:d,controlHeightSM:x}=e;return{[r]:Object.assign({display:"inline-block",verticalAlign:"top",background:a},hp(c)),[`${r}${r}-circle`]:{borderRadius:"50%"},[`${r}${r}-lg`]:Object.assign({},hp(d)),[`${r}${r}-sm`]:Object.assign({},hp(x))}},mG=e=>{const{controlHeight:r,borderRadiusSM:a,skeletonInputCls:c,controlHeightLG:d,controlHeightSM:x,gradientFromColor:T,calc:i}=e;return{[c]:Object.assign({display:"inline-block",verticalAlign:"top",background:T,borderRadius:a},_2(r,i)),[`${c}-lg`]:Object.assign({},_2(d,i)),[`${c}-sm`]:Object.assign({},_2(x,i))}},aP=e=>Object.assign({width:e},ux(e)),gG=e=>{const{skeletonImageCls:r,imageSizeBase:a,gradientFromColor:c,borderRadiusSM:d,calc:x}=e;return{[r]:Object.assign(Object.assign({display:"inline-flex",alignItems:"center",justifyContent:"center",verticalAlign:"middle",background:c,borderRadius:d},aP(x(a).mul(2).equal())),{[`${r}-path`]:{fill:"#bfbfbf"},[`${r}-svg`]:Object.assign(Object.assign({},aP(a)),{maxWidth:x(a).mul(4).equal(),maxHeight:x(a).mul(4).equal()}),[`${r}-svg${r}-svg-circle`]:{borderRadius:"50%"}}),[`${r}${r}-circle`]:{borderRadius:"50%"}}},y2=(e,r,a)=>{const{skeletonButtonCls:c}=e;return{[`${a}${c}-circle`]:{width:r,minWidth:r,borderRadius:"50%"},[`${a}${c}-round`]:{borderRadius:r}}},v2=(e,r)=>Object.assign({width:r(e).mul(2).equal(),minWidth:r(e).mul(2).equal()},ux(e)),_G=e=>{const{borderRadiusSM:r,skeletonButtonCls:a,controlHeight:c,controlHeightLG:d,controlHeightSM:x,gradientFromColor:T,calc:i}=e;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({[a]:Object.assign({display:"inline-block",verticalAlign:"top",background:T,borderRadius:r,width:i(c).mul(2).equal(),minWidth:i(c).mul(2).equal()},v2(c,i))},y2(e,c,a)),{[`${a}-lg`]:Object.assign({},v2(d,i))}),y2(e,d,`${a}-lg`)),{[`${a}-sm`]:Object.assign({},v2(x,i))}),y2(e,x,`${a}-sm`))},yG=e=>{const{componentCls:r,skeletonAvatarCls:a,skeletonTitleCls:c,skeletonParagraphCls:d,skeletonButtonCls:x,skeletonInputCls:T,skeletonImageCls:i,controlHeight:L,controlHeightLG:N,controlHeightSM:U,gradientFromColor:q,padding:X,marginSM:se,borderRadius:ce,titleHeight:ue,blockRadius:fe,paragraphLiHeight:re,controlHeightXS:ee,paragraphMarginTop:ae}=e;return{[r]:{display:"table",width:"100%",[`${r}-header`]:{display:"table-cell",paddingInlineEnd:X,verticalAlign:"top",[a]:Object.assign({display:"inline-block",verticalAlign:"top",background:q},hp(L)),[`${a}-circle`]:{borderRadius:"50%"},[`${a}-lg`]:Object.assign({},hp(N)),[`${a}-sm`]:Object.assign({},hp(U))},[`${r}-content`]:{display:"table-cell",width:"100%",verticalAlign:"top",[c]:{width:"100%",height:ue,background:q,borderRadius:fe,[`+ ${d}`]:{marginBlockStart:U}},[d]:{padding:0,"> li":{width:"100%",height:re,listStyle:"none",background:q,borderRadius:fe,"+ li":{marginBlockStart:ee}}},[`${d}> li:last-child:not(:first-child):not(:nth-child(2))`]:{width:"61%"}},[`&-round ${r}-content`]:{[`${c}, ${d} > li`]:{borderRadius:ce}}},[`${r}-with-avatar ${r}-content`]:{[c]:{marginBlockStart:se,[`+ ${d}`]:{marginBlockStart:ae}}},[`${r}${r}-element`]:Object.assign(Object.assign(Object.assign(Object.assign({display:"inline-block",width:"auto"},_G(e)),pG(e)),mG(e)),gG(e)),[`${r}${r}-block`]:{width:"100%",[x]:{width:"100%"},[T]:{width:"100%"}},[`${r}${r}-active`]:{[`
        ${c},
        ${d} > li,
        ${a},
        ${x},
        ${T},
        ${i}
      `]:Object.assign({},fG(e))}}},vG=e=>{const{colorFillContent:r,colorFill:a}=e,c=r,d=a;return{color:c,colorGradientEnd:d,gradientFromColor:c,gradientToColor:d,titleHeight:e.controlHeight/2,blockRadius:e.borderRadiusSM,paragraphMarginTop:e.marginLG+e.marginXXS,paragraphLiHeight:e.controlHeight/2}},Op=Ms("Skeleton",e=>{const{componentCls:r,calc:a}=e,c=Wo(e,{skeletonAvatarCls:`${r}-avatar`,skeletonTitleCls:`${r}-title`,skeletonParagraphCls:`${r}-paragraph`,skeletonButtonCls:`${r}-button`,skeletonInputCls:`${r}-input`,skeletonImageCls:`${r}-image`,imageSizeBase:a(e.controlHeight).mul(1.5).equal(),borderRadius:100,skeletonLoadingBackground:`linear-gradient(90deg, ${e.gradientFromColor} 25%, ${e.gradientToColor} 37%, ${e.gradientFromColor} 63%)`,skeletonLoadingMotionDuration:"1.4s"});return[yG(c)]},vG,{deprecatedTokens:[["color","gradientFromColor"],["colorGradientEnd","gradientToColor"]]}),xG=e=>{const{prefixCls:r,className:a,rootClassName:c,active:d,shape:x="circle",size:T="default"}=e,{getPrefixCls:i}=$.useContext(Yn),L=i("skeleton",r),[N,U,q]=Op(L),X=ud(e,["prefixCls","className"]),se=Mr(L,`${L}-element`,{[`${L}-active`]:d},a,c,U,q);return N($.createElement("div",{className:se},$.createElement(cx,Object.assign({prefixCls:`${L}-avatar`,shape:x,size:T},X))))},bG=xG,wG=e=>{const{prefixCls:r,className:a,rootClassName:c,active:d,block:x=!1,size:T="default"}=e,{getPrefixCls:i}=$.useContext(Yn),L=i("skeleton",r),[N,U,q]=Op(L),X=ud(e,["prefixCls"]),se=Mr(L,`${L}-element`,{[`${L}-active`]:d,[`${L}-block`]:x},a,c,U,q);return N($.createElement("div",{className:se},$.createElement(cx,Object.assign({prefixCls:`${L}-button`,size:T},X))))},SG=wG,EG="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",TG=e=>{const{prefixCls:r,className:a,rootClassName:c,style:d,active:x}=e,{getPrefixCls:T}=$.useContext(Yn),i=T("skeleton",r),[L,N,U]=Op(i),q=Mr(i,`${i}-element`,{[`${i}-active`]:x},a,c,N,U);return L($.createElement("div",{className:q},$.createElement("div",{className:Mr(`${i}-image`,a),style:d},$.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:`${i}-image-svg`},$.createElement("title",null,"Image placeholder"),$.createElement("path",{d:EG,className:`${i}-image-path`})))))},CG=TG,MG=e=>{const{prefixCls:r,className:a,rootClassName:c,active:d,block:x,size:T="default"}=e,{getPrefixCls:i}=$.useContext(Yn),L=i("skeleton",r),[N,U,q]=Op(L),X=ud(e,["prefixCls"]),se=Mr(L,`${L}-element`,{[`${L}-active`]:d,[`${L}-block`]:x},a,c,U,q);return N($.createElement("div",{className:se},$.createElement(cx,Object.assign({prefixCls:`${L}-input`,size:T},X))))},IG=MG,PG=e=>{const{prefixCls:r,className:a,rootClassName:c,style:d,active:x,children:T}=e,{getPrefixCls:i}=$.useContext(Yn),L=i("skeleton",r),[N,U,q]=Op(L),X=Mr(L,`${L}-element`,{[`${L}-active`]:x},U,a,c,q);return N($.createElement("div",{className:X},$.createElement("div",{className:Mr(`${L}-image`,a),style:d},T)))},AG=PG,RG=(e,r)=>{const{width:a,rows:c=2}=r;if(Array.isArray(a))return a[e];if(c-1===e)return a},zG=e=>{const{prefixCls:r,className:a,style:c,rows:d}=e,x=zr(new Array(d)).map((T,i)=>$.createElement("li",{key:i,style:{width:RG(i,e)}}));return $.createElement("ul",{className:Mr(r,a),style:c},x)},LG=zG,kG=e=>{let{prefixCls:r,className:a,width:c,style:d}=e;return $.createElement("h3",{className:Mr(r,a),style:Object.assign({width:c},d)})},DG=kG;function x2(e){return e&&typeof e=="object"?e:{}}function OG(e,r){return e&&!r?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function FG(e,r){return!e&&r?{width:"38%"}:e&&r?{width:"50%"}:{}}function BG(e,r){const a={};return(!e||!r)&&(a.width="61%"),!e&&r?a.rows=3:a.rows=2,a}const Fp=e=>{const{prefixCls:r,loading:a,className:c,rootClassName:d,style:x,children:T,avatar:i=!1,title:L=!0,paragraph:N=!0,active:U,round:q}=e,{getPrefixCls:X,direction:se,skeleton:ce}=$.useContext(Yn),ue=X("skeleton",r),[fe,re,ee]=Op(ue);if(a||!("loading"in e)){const ae=!!i,ve=!!L,Te=!!N;let pe;if(ae){const Xe=Object.assign(Object.assign({prefixCls:`${ue}-avatar`},OG(ve,Te)),x2(i));pe=$.createElement("div",{className:`${ue}-header`},$.createElement(cx,Object.assign({},Xe)))}let Ee;if(ve||Te){let Xe;if(ve){const Je=Object.assign(Object.assign({prefixCls:`${ue}-title`},FG(ae,Te)),x2(L));Xe=$.createElement(DG,Object.assign({},Je))}let Fe;if(Te){const Je=Object.assign(Object.assign({prefixCls:`${ue}-paragraph`},BG(ae,ve)),x2(N));Fe=$.createElement(LG,Object.assign({},Je))}Ee=$.createElement("div",{className:`${ue}-content`},Xe,Fe)}const Ne=Mr(ue,{[`${ue}-with-avatar`]:ae,[`${ue}-active`]:U,[`${ue}-rtl`]:se==="rtl",[`${ue}-round`]:q},ce==null?void 0:ce.className,c,d,re,ee);return fe($.createElement("div",{className:Ne,style:Object.assign(Object.assign({},ce==null?void 0:ce.style),x)},pe,Ee))}return T??null};Fp.Button=SG;Fp.Avatar=bG;Fp.Input=IG;Fp.Image=CG;Fp.Node=AG;const sP=Fp,NG=function(){if(typeof navigator>"u"||typeof window>"u")return!1;var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e==null?void 0:e.substr(0,4))};function jG(e){var r=e.prefixCls,a=e.align,c=e.arrow,d=e.arrowPos,x=c||{},T=x.className,i=x.content,L=d.x,N=L===void 0?0:L,U=d.y,q=U===void 0?0:U,X=$.useRef();if(!a||!a.points)return null;var se={position:"absolute"};if(a.autoArrow!==!1){var ce=a.points[0],ue=a.points[1],fe=ce[0],re=ce[1],ee=ue[0],ae=ue[1];fe===ee||!["t","b"].includes(fe)?se.top=q:fe==="t"?se.top=0:se.bottom=0,re===ae||!["l","r"].includes(re)?se.left=N:re==="l"?se.left=0:se.right=0}return $.createElement("div",{ref:X,className:Mr("".concat(r,"-arrow"),T),style:se},i)}function $G(e){var r=e.prefixCls,a=e.open,c=e.zIndex,d=e.mask,x=e.motion;return d?$.createElement(zp,Po({},x,{motionAppear:!0,visible:a,removeOnLeave:!0}),function(T){var i=T.className;return $.createElement("div",{style:{zIndex:c},className:Mr("".concat(r,"-mask"),i)})}):null}var VG=$.memo(function(e){var r=e.children;return r},function(e,r){return r.cache}),UG=$.forwardRef(function(e,r){var a=e.popup,c=e.className,d=e.prefixCls,x=e.style,T=e.target,i=e.onVisibleChanged,L=e.open,N=e.keepDom,U=e.fresh,q=e.onClick,X=e.mask,se=e.arrow,ce=e.arrowPos,ue=e.align,fe=e.motion,re=e.maskMotion,ee=e.forceRender,ae=e.getPopupContainer,ve=e.autoDestroy,Te=e.portal,pe=e.zIndex,Ee=e.onMouseEnter,Ne=e.onMouseLeave,Xe=e.onPointerEnter,Fe=e.onPointerDownCapture,Je=e.ready,Ct=e.offsetX,ft=e.offsetY,yt=e.offsetR,lt=e.offsetB,ct=e.onAlign,Ye=e.onPrepare,Ke=e.stretch,tt=e.targetWidth,ht=e.targetHeight,vt=typeof a=="function"?a():a,At=L||N,Pt=(ae==null?void 0:ae.length)>0,qt=$.useState(!ae||!Pt),or=Sr(qt,2),cr=or[0],Qt=or[1];if(Mo(function(){!cr&&Pt&&T&&Qt(!0)},[cr,Pt,T]),!cr)return null;var qr="auto",yr={left:"-1000vw",top:"-1000vh",right:qr,bottom:qr};if(Je||!L){var Ae,Lr=ue.points,$r=ue.dynamicInset||((Ae=ue._experimental)===null||Ae===void 0?void 0:Ae.dynamicInset),pn=$r&&Lr[0][1]==="r",wt=$r&&Lr[0][0]==="b";pn?(yr.right=yt,yr.left=qr):(yr.left=Ct,yr.right=qr),wt?(yr.bottom=lt,yr.top=qr):(yr.top=ft,yr.bottom=qr)}var Pr={};return Ke&&(Ke.includes("height")&&ht?Pr.height=ht:Ke.includes("minHeight")&&ht&&(Pr.minHeight=ht),Ke.includes("width")&&tt?Pr.width=tt:Ke.includes("minWidth")&&tt&&(Pr.minWidth=tt)),L||(Pr.pointerEvents="none"),$.createElement(Te,{open:ee||At,getContainer:ae&&function(){return ae(T)},autoDestroy:ve},$.createElement($G,{prefixCls:d,open:L,zIndex:pe,mask:X,motion:re}),$.createElement(vE,{onResize:ct,disabled:!L},function(Ur){return $.createElement(zp,Po({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:ee,leavedClassName:"".concat(d,"-hidden")},fe,{onAppearPrepare:Ye,onEnterPrepare:Ye,visible:L,onVisibleChanged:function(ar){var tn;fe==null||(tn=fe.onVisibleChanged)===null||tn===void 0||tn.call(fe,ar),i(ar)}}),function(Un,ar){var tn=Un.className,Ln=Un.style,Xr=Mr(d,tn,c);return $.createElement("div",{ref:cd(Ur,r,ar),className:Xr,style:Ft(Ft(Ft(Ft({"--arrow-x":"".concat(ce.x||0,"px"),"--arrow-y":"".concat(ce.y||0,"px")},yr),Pr),Ln),{},{boxSizing:"border-box",zIndex:pe},x),onMouseEnter:Ee,onMouseLeave:Ne,onPointerEnter:Xe,onClick:q,onPointerDownCapture:Fe},se&&$.createElement(jG,{prefixCls:d,arrow:se,arrowPos:ce,align:ue}),$.createElement(VG,{cache:!L&&!U},vt))})}))}),GG=$.forwardRef(function(e,r){var a=e.children,c=e.getTriggerDOMNode,d=Ap(a),x=$.useCallback(function(i){_E(r,c?c(i):i)},[c]),T=Z1(x,O_(a));return d?$.cloneElement(a,{ref:T}):a}),lP=$.createContext(null);function cP(e){return e?Array.isArray(e)?e:[e]:[]}function HG(e,r,a,c){return $.useMemo(function(){var d=cP(a??r),x=cP(c??r),T=new Set(d),i=new Set(x);return e&&(T.has("hover")&&(T.delete("hover"),T.add("click")),i.has("hover")&&(i.delete("hover"),i.add("click"))),[T,i]},[e,r,a,c])}function WG(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],a=arguments.length>2?arguments[2]:void 0;return a?e[0]===r[0]:e[0]===r[0]&&e[1]===r[1]}function qG(e,r,a,c){for(var d=a.points,x=Object.keys(e),T=0;T<x.length;T+=1){var i,L=x[T];if(WG((i=e[L])===null||i===void 0?void 0:i.points,d,c))return"".concat(r,"-placement-").concat(L)}return""}function uP(e,r,a,c){return r||(a?{motionName:"".concat(e,"-").concat(a)}:c?{motionName:c}:null)}function U_(e){return e.ownerDocument.defaultView}function f3(e){for(var r=[],a=e==null?void 0:e.parentElement,c=["hidden","scroll","clip","auto"];a;){var d=U_(a).getComputedStyle(a),x=d.overflowX,T=d.overflowY,i=d.overflow;[x,T,i].some(function(L){return c.includes(L)})&&r.push(a),a=a.parentElement}return r}function E_(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return Number.isNaN(e)?r:e}function Tg(e){return E_(parseFloat(e),0)}function hP(e,r){var a=Ft({},e);return(r||[]).forEach(function(c){if(!(c instanceof HTMLBodyElement||c instanceof HTMLHtmlElement)){var d=U_(c).getComputedStyle(c),x=d.overflow,T=d.overflowClipMargin,i=d.borderTopWidth,L=d.borderBottomWidth,N=d.borderLeftWidth,U=d.borderRightWidth,q=c.getBoundingClientRect(),X=c.offsetHeight,se=c.clientHeight,ce=c.offsetWidth,ue=c.clientWidth,fe=Tg(i),re=Tg(L),ee=Tg(N),ae=Tg(U),ve=E_(Math.round(q.width/ce*1e3)/1e3),Te=E_(Math.round(q.height/X*1e3)/1e3),pe=(ce-ue-ee-ae)*ve,Ee=(X-se-fe-re)*Te,Ne=fe*Te,Xe=re*Te,Fe=ee*ve,Je=ae*ve,Ct=0,ft=0;if(x==="clip"){var yt=Tg(T);Ct=yt*ve,ft=yt*Te}var lt=q.x+Fe-Ct,ct=q.y+Ne-ft,Ye=lt+q.width+2*Ct-Fe-Je-pe,Ke=ct+q.height+2*ft-Ne-Xe-Ee;a.left=Math.max(a.left,lt),a.top=Math.max(a.top,ct),a.right=Math.min(a.right,Ye),a.bottom=Math.min(a.bottom,Ke)}}),a}function dP(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,a="".concat(r),c=a.match(/^(.*)\%$/);return c?e*(parseFloat(c[1])/100):parseFloat(a)}function fP(e,r){var a=r||[],c=Sr(a,2),d=c[0],x=c[1];return[dP(e.width,d),dP(e.height,x)]}function pP(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return[e[0],e[1]]}function Df(e,r){var a=r[0],c=r[1],d,x;return a==="t"?x=e.y:a==="b"?x=e.y+e.height:x=e.y+e.height/2,c==="l"?d=e.x:c==="r"?d=e.x+e.width:d=e.x+e.width/2,{x:d,y:x}}function _u(e,r){var a={t:"b",b:"t",l:"r",r:"l"};return e.map(function(c,d){return d===r?a[c]||"c":c}).join("")}function ZG(e,r,a,c,d,x,T){var i=$.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:d[c]||{}}),L=Sr(i,2),N=L[0],U=L[1],q=$.useRef(0),X=$.useMemo(function(){return r?f3(r):[]},[r]),se=$.useRef({}),ce=function(){se.current={}};e||ce();var ue=Ka(function(){if(r&&a&&e){let Rr=function(ur,va){var Hr=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Jt,Ls=qt.x+ur,co=qt.y+va,Wl=Ls+pn,_r=co+$r,Mt=Math.max(Ls,Hr.left),xr=Math.max(co,Hr.top),br=Math.min(Wl,Hr.right),_n=Math.min(_r,Hr.bottom);return Math.max(0,(br-Mt)*(_n-xr))},gl=function(){Ut=qt.y+le,tr=Ut+$r,Gt=qt.x+te,Xt=Gt+pn};var Gl=Rr,Hl=gl,ee,ae,ve,Te,pe=r,Ee=pe.ownerDocument,Ne=U_(pe),Xe=Ne.getComputedStyle(pe),Fe=Xe.width,Je=Xe.height,Ct=Xe.position,ft=pe.style.left,yt=pe.style.top,lt=pe.style.right,ct=pe.style.bottom,Ye=pe.style.overflow,Ke=Ft(Ft({},d[c]),x),tt=Ee.createElement("div");(ee=pe.parentElement)===null||ee===void 0||ee.appendChild(tt),tt.style.left="".concat(pe.offsetLeft,"px"),tt.style.top="".concat(pe.offsetTop,"px"),tt.style.position=Ct,tt.style.height="".concat(pe.offsetHeight,"px"),tt.style.width="".concat(pe.offsetWidth,"px"),pe.style.left="0",pe.style.top="0",pe.style.right="auto",pe.style.bottom="auto",pe.style.overflow="hidden";var ht;if(Array.isArray(a))ht={x:a[0],y:a[1],width:0,height:0};else{var vt,At,Pt=a.getBoundingClientRect();Pt.x=(vt=Pt.x)!==null&&vt!==void 0?vt:Pt.left,Pt.y=(At=Pt.y)!==null&&At!==void 0?At:Pt.top,ht={x:Pt.x,y:Pt.y,width:Pt.width,height:Pt.height}}var qt=pe.getBoundingClientRect();qt.x=(ae=qt.x)!==null&&ae!==void 0?ae:qt.left,qt.y=(ve=qt.y)!==null&&ve!==void 0?ve:qt.top;var or=Ee.documentElement,cr=or.clientWidth,Qt=or.clientHeight,qr=or.scrollWidth,yr=or.scrollHeight,Ae=or.scrollTop,Lr=or.scrollLeft,$r=qt.height,pn=qt.width,wt=ht.height,Pr=ht.width,Ur={left:0,top:0,right:cr,bottom:Qt},Un={left:-Lr,top:-Ae,right:qr-Lr,bottom:yr-Ae},ar=Ke.htmlRegion,tn="visible",Ln="visibleFirst";ar!=="scroll"&&ar!==Ln&&(ar=tn);var Xr=ar===Ln,hn=hP(Un,X),fr=hP(Ur,X),Jt=ar===tn?fr:hn,bn=Xr?fr:Jt;pe.style.left="auto",pe.style.top="auto",pe.style.right="0",pe.style.bottom="0";var gn=pe.getBoundingClientRect();pe.style.left=ft,pe.style.top=yt,pe.style.right=lt,pe.style.bottom=ct,pe.style.overflow=Ye,(Te=pe.parentElement)===null||Te===void 0||Te.removeChild(tt);var Kn=E_(Math.round(pn/parseFloat(Fe)*1e3)/1e3),dn=E_(Math.round($r/parseFloat(Je)*1e3)/1e3);if(Kn===0||dn===0||d_(a)&&!BE(a))return;var di=Ke.offset,Ui=Ke.targetOffset,Ji=fP(qt,di),nn=Sr(Ji,2),En=nn[0],Jn=nn[1],zo=fP(ht,Ui),_i=Sr(zo,2),bi=_i[0],gr=_i[1];ht.x-=bi,ht.y-=gr;var Gi=Ke.points||[],Lo=Sr(Gi,2),li=Lo[0],Hi=Lo[1],fi=pP(Hi),pi=pP(li),Wi=Df(ht,fi),Bn=Df(qt,pi),it=Ft({},Ke),te=Wi.x-Bn.x+En,le=Wi.y-Bn.y+Jn,K=Rr(te,le),he=Rr(te,le,fr),de=Df(ht,["t","l"]),xe=Df(qt,["t","l"]),ke=Df(ht,["b","r"]),ze=Df(qt,["b","r"]),He=Ke.overflow||{},Ue=He.adjustX,Ze=He.adjustY,ot=He.shiftX,pt=He.shiftY,St=function(va){return typeof va=="boolean"?va:va>=0},Ut,tr,Gt,Xt;gl();var vr=St(Ze),Nr=pi[0]===fi[0];if(vr&&pi[0]==="t"&&(tr>bn.bottom||se.current.bt)){var dr=le;Nr?dr-=$r-wt:dr=de.y-ze.y-Jn;var Vr=Rr(te,dr),Gr=Rr(te,dr,fr);Vr>K||Vr===K&&(!Xr||Gr>=he)?(se.current.bt=!0,le=dr,Jn=-Jn,it.points=[_u(pi,0),_u(fi,0)]):se.current.bt=!1}if(vr&&pi[0]==="b"&&(Ut<bn.top||se.current.tb)){var In=le;Nr?In+=$r-wt:In=ke.y-xe.y-Jn;var ii=Rr(te,In),$n=Rr(te,In,fr);ii>K||ii===K&&(!Xr||$n>=he)?(se.current.tb=!0,le=In,Jn=-Jn,it.points=[_u(pi,0),_u(fi,0)]):se.current.tb=!1}var Qn=St(Ue),so=pi[1]===fi[1];if(Qn&&pi[1]==="l"&&(Xt>bn.right||se.current.rl)){var Yr=te;so?Yr-=pn-Pr:Yr=de.x-ze.x-En;var Gn=Rr(Yr,le),Qi=Rr(Yr,le,fr);Gn>K||Gn===K&&(!Xr||Qi>=he)?(se.current.rl=!0,te=Yr,En=-En,it.points=[_u(pi,1),_u(fi,1)]):se.current.rl=!1}if(Qn&&pi[1]==="r"&&(Gt<bn.left||se.current.lr)){var wi=te;so?wi+=pn-Pr:wi=ke.x-xe.x-En;var Zn=Rr(wi,le),eo=Rr(wi,le,fr);Zn>K||Zn===K&&(!Xr||eo>=he)?(se.current.lr=!0,te=wi,En=-En,it.points=[_u(pi,1),_u(fi,1)]):se.current.lr=!1}gl();var Si=ot===!0?0:ot;typeof Si=="number"&&(Gt<fr.left&&(te-=Gt-fr.left-En,ht.x+Pr<fr.left+Si&&(te+=ht.x-fr.left+Pr-Si)),Xt>fr.right&&(te-=Xt-fr.right-En,ht.x>fr.right-Si&&(te+=ht.x-fr.right+Si)));var zi=pt===!0?0:pt;typeof zi=="number"&&(Ut<fr.top&&(le-=Ut-fr.top-Jn,ht.y+wt<fr.top+zi&&(le+=ht.y-fr.top+wt-zi)),tr>fr.bottom&&(le-=tr-fr.bottom-Jn,ht.y>fr.bottom-zi&&(le+=ht.y-fr.bottom+zi)));var ss=qt.x+te,Is=ss+pn,ko=qt.y+le,Ps=ko+$r,As=ht.x,Ul=As+Pr,qi=ht.y,Do=qi+wt,xo=Math.max(ss,As),Oo=Math.min(Is,Ul),qo=(xo+Oo)/2,pl=qo-ss,Rs=Math.max(ko,qi),la=Math.min(Ps,Do),ya=(Rs+la)/2,ml=ya-ko;T==null||T(r,it);var zs=gn.right-qt.x-(te+qt.width),lo=gn.bottom-qt.y-(le+qt.height);Kn===1&&(te=Math.round(te),zs=Math.round(zs)),dn===1&&(le=Math.round(le),lo=Math.round(lo));var bo={ready:!0,offsetX:te/Kn,offsetY:le/dn,offsetR:zs/Kn,offsetB:lo/dn,arrowX:pl/Kn,arrowY:ml/dn,scaleX:Kn,scaleY:dn,align:it};U(bo)}}),fe=function(){q.current+=1;var ae=q.current;Promise.resolve().then(function(){q.current===ae&&ue()})},re=function(){U(function(ae){return Ft(Ft({},ae),{},{ready:!1})})};return Mo(re,[c]),Mo(function(){e||re()},[e]),[N.ready,N.offsetX,N.offsetY,N.offsetR,N.offsetB,N.arrowX,N.arrowY,N.scaleX,N.scaleY,N.align,fe]}function XG(e,r,a,c,d){Mo(function(){if(e&&r&&a){let X=function(){c(),d()};var q=X,x=r,T=a,i=f3(x),L=f3(T),N=U_(T),U=new Set([N].concat(zr(i),zr(L)));return U.forEach(function(se){se.addEventListener("scroll",X,{passive:!0})}),N.addEventListener("resize",X,{passive:!0}),c(),function(){U.forEach(function(se){se.removeEventListener("scroll",X),N.removeEventListener("resize",X)})}}},[e,r,a])}function YG(e,r,a,c,d,x,T,i){var L=$.useRef(e);L.current=e;var N=$.useRef(!1);$.useEffect(function(){if(r&&c&&(!d||x)){var q=function(){N.current=!1},X=function(fe){var re;L.current&&!T(((re=fe.composedPath)===null||re===void 0||(re=re.call(fe))===null||re===void 0?void 0:re[0])||fe.target)&&!N.current&&i(!1)},se=U_(c);se.addEventListener("pointerdown",q,!0),se.addEventListener("mousedown",X,!0),se.addEventListener("contextmenu",X,!0);var ce=f1(a);return ce&&(ce.addEventListener("mousedown",X,!0),ce.addEventListener("contextmenu",X,!0)),function(){se.removeEventListener("pointerdown",q,!0),se.removeEventListener("mousedown",X,!0),se.removeEventListener("contextmenu",X,!0),ce&&(ce.removeEventListener("mousedown",X,!0),ce.removeEventListener("contextmenu",X,!0))}}},[r,a,c,d,x]);function U(){N.current=!0}return U}var KG=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","fresh","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];function JG(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:QL,r=$.forwardRef(function(a,c){var d=a.prefixCls,x=d===void 0?"rc-trigger-popup":d,T=a.children,i=a.action,L=i===void 0?"hover":i,N=a.showAction,U=a.hideAction,q=a.popupVisible,X=a.defaultPopupVisible,se=a.onPopupVisibleChange,ce=a.afterPopupVisibleChange,ue=a.mouseEnterDelay,fe=a.mouseLeaveDelay,re=fe===void 0?.1:fe,ee=a.focusDelay,ae=a.blurDelay,ve=a.mask,Te=a.maskClosable,pe=Te===void 0?!0:Te,Ee=a.getPopupContainer,Ne=a.forceRender,Xe=a.autoDestroy,Fe=a.destroyPopupOnHide,Je=a.popup,Ct=a.popupClassName,ft=a.popupStyle,yt=a.popupPlacement,lt=a.builtinPlacements,ct=lt===void 0?{}:lt,Ye=a.popupAlign,Ke=a.zIndex,tt=a.stretch,ht=a.getPopupClassNameFromAlign,vt=a.fresh,At=a.alignPoint,Pt=a.onPopupClick,qt=a.onPopupAlign,or=a.arrow,cr=a.popupMotion,Qt=a.maskMotion,qr=a.popupTransitionName,yr=a.popupAnimation,Ae=a.maskTransitionName,Lr=a.maskAnimation,$r=a.className,pn=a.getTriggerDOMNode,wt=is(a,KG),Pr=Xe||Fe||!1,Ur=$.useState(!1),Un=Sr(Ur,2),ar=Un[0],tn=Un[1];Mo(function(){tn(NG())},[]);var Ln=$.useRef({}),Xr=$.useContext(lP),hn=$.useMemo(function(){return{registerSubPopup:function(Mt,xr){Ln.current[Mt]=xr,Xr==null||Xr.registerSubPopup(Mt,xr)}}},[Xr]),fr=mU(),Jt=$.useState(null),bn=Sr(Jt,2),gn=bn[0],Kn=bn[1],dn=$.useRef(null),di=Ka(function(_r){dn.current=_r,d_(_r)&&gn!==_r&&Kn(_r),Xr==null||Xr.registerSubPopup(fr,_r)}),Ui=$.useState(null),Ji=Sr(Ui,2),nn=Ji[0],En=Ji[1],Jn=$.useRef(null),zo=Ka(function(_r){d_(_r)&&nn!==_r&&(En(_r),Jn.current=_r)}),_i=$.Children.only(T),bi=(_i==null?void 0:_i.props)||{},gr={},Gi=Ka(function(_r){var Mt,xr,br=nn;return(br==null?void 0:br.contains(_r))||((Mt=f1(br))===null||Mt===void 0?void 0:Mt.host)===_r||_r===br||(gn==null?void 0:gn.contains(_r))||((xr=f1(gn))===null||xr===void 0?void 0:xr.host)===_r||_r===gn||Object.values(Ln.current).some(function(_n){return(_n==null?void 0:_n.contains(_r))||_r===_n})}),Lo=uP(x,cr,yr,qr),li=uP(x,Qt,Lr,Ae),Hi=$.useState(X||!1),fi=Sr(Hi,2),pi=fi[0],Wi=fi[1],Bn=q??pi,it=Ka(function(_r){q===void 0&&Wi(_r)});Mo(function(){Wi(q||!1)},[q]);var te=$.useRef(Bn);te.current=Bn;var le=$.useRef([]);le.current=[];var K=Ka(function(_r){var Mt;it(_r),((Mt=le.current[le.current.length-1])!==null&&Mt!==void 0?Mt:Bn)!==_r&&(le.current.push(_r),se==null||se(_r))}),he=$.useRef(),de=function(){clearTimeout(he.current)},xe=function(Mt){var xr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;de(),xr===0?K(Mt):he.current=setTimeout(function(){K(Mt)},xr*1e3)};$.useEffect(function(){return de},[]);var ke=$.useState(!1),ze=Sr(ke,2),He=ze[0],Ue=ze[1];Mo(function(_r){(!_r||Bn)&&Ue(!0)},[Bn]);var Ze=$.useState(null),ot=Sr(Ze,2),pt=ot[0],St=ot[1],Ut=$.useState(null),tr=Sr(Ut,2),Gt=tr[0],Xt=tr[1],vr=function(Mt){Xt([Mt.clientX,Mt.clientY])},Nr=ZG(Bn,gn,At&&Gt!==null?Gt:nn,yt,ct,Ye,qt),dr=Sr(Nr,11),Vr=dr[0],Gr=dr[1],In=dr[2],ii=dr[3],$n=dr[4],Qn=dr[5],so=dr[6],Yr=dr[7],Gn=dr[8],Qi=dr[9],wi=dr[10],Zn=HG(ar,L,N,U),eo=Sr(Zn,2),Si=eo[0],zi=eo[1],ss=Si.has("click"),Is=zi.has("click")||zi.has("contextMenu"),ko=Ka(function(){He||wi()}),Ps=function(){te.current&&At&&Is&&xe(!1)};XG(Bn,nn,gn,ko,Ps),Mo(function(){ko()},[Gt,yt]),Mo(function(){Bn&&!(ct!=null&&ct[yt])&&ko()},[JSON.stringify(Ye)]);var As=$.useMemo(function(){var _r=qG(ct,x,Qi,At);return Mr(_r,ht==null?void 0:ht(Qi))},[Qi,ht,ct,x,At]);$.useImperativeHandle(c,function(){return{nativeElement:Jn.current,popupElement:dn.current,forceAlign:ko}});var Ul=$.useState(0),qi=Sr(Ul,2),Do=qi[0],xo=qi[1],Oo=$.useState(0),qo=Sr(Oo,2),pl=qo[0],Rs=qo[1],la=function(){if(tt&&nn){var Mt=nn.getBoundingClientRect();xo(Mt.width),Rs(Mt.height)}},ya=function(){la(),ko()},ml=function(Mt){Ue(!1),wi(),ce==null||ce(Mt)},zs=function(){return new Promise(function(Mt){la(),St(function(){return Mt})})};Mo(function(){pt&&(wi(),pt(),St(null))},[pt]);function lo(_r,Mt,xr,br){gr[_r]=function(_n){var xa;br==null||br(_n),xe(Mt,xr);for(var Wr=arguments.length,ql=new Array(Wr>1?Wr-1:0),Zo=1;Zo<Wr;Zo++)ql[Zo-1]=arguments[Zo];(xa=bi[_r])===null||xa===void 0||xa.call.apply(xa,[bi,_n].concat(ql))}}(ss||Is)&&(gr.onClick=function(_r){var Mt;te.current&&Is?xe(!1):!te.current&&ss&&(vr(_r),xe(!0));for(var xr=arguments.length,br=new Array(xr>1?xr-1:0),_n=1;_n<xr;_n++)br[_n-1]=arguments[_n];(Mt=bi.onClick)===null||Mt===void 0||Mt.call.apply(Mt,[bi,_r].concat(br))});var bo=YG(Bn,Is,nn,gn,ve,pe,Gi,xe),Gl=Si.has("hover"),Hl=zi.has("hover"),Rr,gl;Gl&&(lo("onMouseEnter",!0,ue,function(_r){vr(_r)}),lo("onPointerEnter",!0,ue,function(_r){vr(_r)}),Rr=function(Mt){(Bn||He)&&gn!==null&&gn!==void 0&&gn.contains(Mt.target)&&xe(!0,ue)},At&&(gr.onMouseMove=function(_r){var Mt;(Mt=bi.onMouseMove)===null||Mt===void 0||Mt.call(bi,_r)})),Hl&&(lo("onMouseLeave",!1,re),lo("onPointerLeave",!1,re),gl=function(){xe(!1,re)}),Si.has("focus")&&lo("onFocus",!0,ee),zi.has("focus")&&lo("onBlur",!1,ae),Si.has("contextMenu")&&(gr.onContextMenu=function(_r){var Mt;te.current&&zi.has("contextMenu")?xe(!1):(vr(_r),xe(!0)),_r.preventDefault();for(var xr=arguments.length,br=new Array(xr>1?xr-1:0),_n=1;_n<xr;_n++)br[_n-1]=arguments[_n];(Mt=bi.onContextMenu)===null||Mt===void 0||Mt.call.apply(Mt,[bi,_r].concat(br))}),$r&&(gr.className=Mr(bi.className,$r));var ur=Ft(Ft({},bi),gr),va={},Hr=["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"];Hr.forEach(function(_r){wt[_r]&&(va[_r]=function(){for(var Mt,xr=arguments.length,br=new Array(xr),_n=0;_n<xr;_n++)br[_n]=arguments[_n];(Mt=ur[_r])===null||Mt===void 0||Mt.call.apply(Mt,[ur].concat(br)),wt[_r].apply(wt,br)})});var Ls=$.cloneElement(_i,Ft(Ft({},ur),va)),co={x:Qn,y:so},Wl=or?Ft({},or!==!0?or:{}):null;return $.createElement($.Fragment,null,$.createElement(vE,{disabled:!Bn,ref:zo,onResize:ya},$.createElement(GG,{getTriggerDOMNode:pn},Ls)),$.createElement(lP.Provider,{value:hn},$.createElement(UG,{portal:e,ref:di,prefixCls:x,popup:Je,className:Mr(Ct,As),style:ft,target:nn,onMouseEnter:Rr,onMouseLeave:gl,onPointerEnter:Rr,zIndex:Ke,open:Bn,keepDom:He,fresh:vt,onClick:Pt,onPointerDownCapture:bo,mask:ve,motion:Lo,maskMotion:li,onVisibleChanged:ml,onPrepare:zs,forceRender:Ne,autoDestroy:Pr,getPopupContainer:Ee,align:Qi,arrow:Wl,arrowPos:co,ready:Vr,offsetX:Gr,offsetY:In,offsetR:ii,offsetB:$n,onAlign:ko,stretch:tt,targetWidth:Do/Yr,targetHeight:pl/Gn})))});return r}const QG=JG(QL),T_=["xxl","xl","lg","md","sm","xs"],eH=e=>({xs:`(max-width: ${e.screenXSMax}px)`,sm:`(min-width: ${e.screenSM}px)`,md:`(min-width: ${e.screenMD}px)`,lg:`(min-width: ${e.screenLG}px)`,xl:`(min-width: ${e.screenXL}px)`,xxl:`(min-width: ${e.screenXXL}px)`}),tH=e=>{const r=e,a=[].concat(T_).reverse();return a.forEach((c,d)=>{const x=c.toUpperCase(),T=`screen${x}Min`,i=`screen${x}`;if(!(r[T]<=r[i]))throw new Error(`${T}<=${i} fails : !(${r[T]}<=${r[i]})`);if(d<a.length-1){const L=`screen${x}Max`;if(!(r[i]<=r[L]))throw new Error(`${i}<=${L} fails : !(${r[i]}<=${r[L]})`);const U=`screen${a[d+1].toUpperCase()}Min`;if(!(r[L]<=r[U]))throw new Error(`${L}<=${U} fails : !(${r[L]}<=${r[U]})`)}}),e};function rH(){const[,e]=$l(),r=eH(tH(e));return sn.useMemo(()=>{const a=new Map;let c=-1,d={};return{matchHandlers:{},dispatch(x){return d=x,a.forEach(T=>T(d)),a.size>=1},subscribe(x){return a.size||this.register(),c+=1,a.set(c,x),x(d),c},unsubscribe(x){a.delete(x),a.size||this.unregister()},unregister(){Object.keys(r).forEach(x=>{const T=r[x],i=this.matchHandlers[T];i==null||i.mql.removeListener(i==null?void 0:i.listener)}),a.clear()},register(){Object.keys(r).forEach(x=>{const T=r[x],i=N=>{let{matches:U}=N;this.dispatch(Object.assign(Object.assign({},d),{[x]:U}))},L=window.matchMedia(T);L.addListener(i),this.matchHandlers[T]={mql:L,listener:i},i(L)})},responsiveMap:r}},[e])}function c6(e){var r=e.children,a=e.prefixCls,c=e.id,d=e.overlayInnerStyle,x=e.className,T=e.style;return $.createElement("div",{className:Mr("".concat(a,"-content"),x),style:T},$.createElement("div",{className:"".concat(a,"-inner"),id:c,role:"tooltip",style:d},typeof r=="function"?r():r))}var Of={shiftX:64,adjustY:1},Ff={adjustX:1,shiftY:!0},ms=[0,0],nH={left:{points:["cr","cl"],overflow:Ff,offset:[-4,0],targetOffset:ms},right:{points:["cl","cr"],overflow:Ff,offset:[4,0],targetOffset:ms},top:{points:["bc","tc"],overflow:Of,offset:[0,-4],targetOffset:ms},bottom:{points:["tc","bc"],overflow:Of,offset:[0,4],targetOffset:ms},topLeft:{points:["bl","tl"],overflow:Of,offset:[0,-4],targetOffset:ms},leftTop:{points:["tr","tl"],overflow:Ff,offset:[-4,0],targetOffset:ms},topRight:{points:["br","tr"],overflow:Of,offset:[0,-4],targetOffset:ms},rightTop:{points:["tl","tr"],overflow:Ff,offset:[4,0],targetOffset:ms},bottomRight:{points:["tr","br"],overflow:Of,offset:[0,4],targetOffset:ms},rightBottom:{points:["bl","br"],overflow:Ff,offset:[4,0],targetOffset:ms},bottomLeft:{points:["tl","bl"],overflow:Of,offset:[0,4],targetOffset:ms},leftBottom:{points:["br","bl"],overflow:Ff,offset:[-4,0],targetOffset:ms}},iH=["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","motion","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer","overlayInnerStyle","arrowContent","overlay","id","showArrow"],oH=function(r,a){var c=r.overlayClassName,d=r.trigger,x=d===void 0?["hover"]:d,T=r.mouseEnterDelay,i=T===void 0?0:T,L=r.mouseLeaveDelay,N=L===void 0?.1:L,U=r.overlayStyle,q=r.prefixCls,X=q===void 0?"rc-tooltip":q,se=r.children,ce=r.onVisibleChange,ue=r.afterVisibleChange,fe=r.transitionName,re=r.animation,ee=r.motion,ae=r.placement,ve=ae===void 0?"right":ae,Te=r.align,pe=Te===void 0?{}:Te,Ee=r.destroyTooltipOnHide,Ne=Ee===void 0?!1:Ee,Xe=r.defaultVisible,Fe=r.getTooltipContainer,Je=r.overlayInnerStyle;r.arrowContent;var Ct=r.overlay,ft=r.id,yt=r.showArrow,lt=yt===void 0?!0:yt,ct=is(r,iH),Ye=$.useRef(null);$.useImperativeHandle(a,function(){return Ye.current});var Ke=Ft({},ct);"visible"in r&&(Ke.popupVisible=r.visible);var tt=function(){return $.createElement(c6,{key:"content",prefixCls:X,id:ft,overlayInnerStyle:Je},Ct)};return $.createElement(QG,Po({popupClassName:c,prefixCls:X,popup:tt,action:x,builtinPlacements:nH,popupPlacement:ve,ref:Ye,popupAlign:pe,getPopupContainer:Fe,onPopupVisibleChange:ce,afterPopupVisibleChange:ue,popupTransitionName:fe,popupAnimation:re,popupMotion:ee,defaultPopupVisible:Xe,autoDestroy:Ne,mouseLeaveDelay:N,popupStyle:U,mouseEnterDelay:i,arrow:lt},Ke),se)};const aH=$.forwardRef(oH);function sH(e){const{sizePopupArrow:r,borderRadiusXS:a,borderRadiusOuter:c}=e,d=r/2,x=0,T=d,i=c*1/Math.sqrt(2),L=d-c*(1-1/Math.sqrt(2)),N=d-a*(1/Math.sqrt(2)),U=c*(Math.sqrt(2)-1)+a*(1/Math.sqrt(2)),q=2*d-N,X=U,se=2*d-i,ce=L,ue=2*d-x,fe=T,re=d*Math.sqrt(2)+c*(Math.sqrt(2)-2),ee=c*(Math.sqrt(2)-1),ae=`polygon(${ee}px 100%, 50% ${ee}px, ${2*d-ee}px 100%, ${ee}px 100%)`,ve=`path('M ${x} ${T} A ${c} ${c} 0 0 0 ${i} ${L} L ${N} ${U} A ${a} ${a} 0 0 1 ${q} ${X} L ${se} ${ce} A ${c} ${c} 0 0 0 ${ue} ${fe} Z')`;return{arrowShadowWidth:re,arrowPath:ve,arrowPolygon:ae}}const lH=(e,r,a)=>{const{sizePopupArrow:c,arrowPolygon:d,arrowPath:x,arrowShadowWidth:T,borderRadiusXS:i,calc:L}=e;return{pointerEvents:"none",width:c,height:c,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:c,height:L(c).div(2).equal(),background:r,clipPath:{_multi_value_:!0,value:[d,x]},content:'""'},"&::after":{content:'""',position:"absolute",width:T,height:T,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${fn(i)} 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:a,zIndex:0,background:"transparent"}}},u6=8;function h6(e){const{contentRadius:r,limitVerticalRadius:a}=e,c=r>12?r+2:12;return{arrowOffsetHorizontal:c,arrowOffsetVertical:a?u6:c}}function pv(e,r){return e?r:{}}function cH(e,r,a){const{componentCls:c,boxShadowPopoverArrow:d,arrowOffsetVertical:x,arrowOffsetHorizontal:T}=e,{arrowDistance:i=0,arrowPlacement:L={left:!0,right:!0,top:!0,bottom:!0}}=a||{};return{[c]:Object.assign(Object.assign(Object.assign(Object.assign({[`${c}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},lH(e,r,d)),{"&:before":{background:r}})]},pv(!!L.top,{[[`&-placement-top > ${c}-arrow`,`&-placement-topLeft > ${c}-arrow`,`&-placement-topRight > ${c}-arrow`].join(",")]:{bottom:i,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top > ${c}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},"&-placement-topLeft":{"--arrow-offset-horizontal":T,[`> ${c}-arrow`]:{left:{_skip_check_:!0,value:T}}},"&-placement-topRight":{"--arrow-offset-horizontal":`calc(100% - ${fn(T)})`,[`> ${c}-arrow`]:{right:{_skip_check_:!0,value:T}}}})),pv(!!L.bottom,{[[`&-placement-bottom > ${c}-arrow`,`&-placement-bottomLeft > ${c}-arrow`,`&-placement-bottomRight > ${c}-arrow`].join(",")]:{top:i,transform:"translateY(-100%)"},[`&-placement-bottom > ${c}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},"&-placement-bottomLeft":{"--arrow-offset-horizontal":T,[`> ${c}-arrow`]:{left:{_skip_check_:!0,value:T}}},"&-placement-bottomRight":{"--arrow-offset-horizontal":`calc(100% - ${fn(T)})`,[`> ${c}-arrow`]:{right:{_skip_check_:!0,value:T}}}})),pv(!!L.left,{[[`&-placement-left > ${c}-arrow`,`&-placement-leftTop > ${c}-arrow`,`&-placement-leftBottom > ${c}-arrow`].join(",")]:{right:{_skip_check_:!0,value:i},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left > ${c}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop > ${c}-arrow`]:{top:x},[`&-placement-leftBottom > ${c}-arrow`]:{bottom:x}})),pv(!!L.right,{[[`&-placement-right > ${c}-arrow`,`&-placement-rightTop > ${c}-arrow`,`&-placement-rightBottom > ${c}-arrow`].join(",")]:{left:{_skip_check_:!0,value:i},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right > ${c}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop > ${c}-arrow`]:{top:x},[`&-placement-rightBottom > ${c}-arrow`]:{bottom:x}}))}}function uH(e,r,a,c){if(c===!1)return{adjustX:!1,adjustY:!1};const d=c&&typeof c=="object"?c:{},x={};switch(e){case"top":case"bottom":x.shiftX=r.arrowOffsetHorizontal*2+a,x.shiftY=!0,x.adjustY=!0;break;case"left":case"right":x.shiftY=r.arrowOffsetVertical*2+a,x.shiftX=!0,x.adjustX=!0;break}const T=Object.assign(Object.assign({},x),d);return T.shiftX||(T.adjustX=!0),T.shiftY||(T.adjustY=!0),T}const mP={left:{points:["cr","cl"]},right:{points:["cl","cr"]},top:{points:["bc","tc"]},bottom:{points:["tc","bc"]},topLeft:{points:["bl","tl"]},leftTop:{points:["tr","tl"]},topRight:{points:["br","tr"]},rightTop:{points:["tl","tr"]},bottomRight:{points:["tr","br"]},rightBottom:{points:["bl","br"]},bottomLeft:{points:["tl","bl"]},leftBottom:{points:["br","bl"]}},hH={topLeft:{points:["bl","tc"]},leftTop:{points:["tr","cl"]},topRight:{points:["br","tc"]},rightTop:{points:["tl","cr"]},bottomRight:{points:["tr","bc"]},rightBottom:{points:["bl","cr"]},bottomLeft:{points:["tl","bc"]},leftBottom:{points:["br","cl"]}},dH=new Set(["topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]);function fH(e){const{arrowWidth:r,autoAdjustOverflow:a,arrowPointAtCenter:c,offset:d,borderRadius:x,visibleFirst:T}=e,i=r/2,L={};return Object.keys(mP).forEach(N=>{const U=c&&hH[N]||mP[N],q=Object.assign(Object.assign({},U),{offset:[0,0],dynamicInset:!0});switch(L[N]=q,dH.has(N)&&(q.autoArrow=!1),N){case"top":case"topLeft":case"topRight":q.offset[1]=-i-d;break;case"bottom":case"bottomLeft":case"bottomRight":q.offset[1]=i+d;break;case"left":case"leftTop":case"leftBottom":q.offset[0]=-i-d;break;case"right":case"rightTop":case"rightBottom":q.offset[0]=i+d;break}const X=h6({contentRadius:x,limitVerticalRadius:!0});if(c)switch(N){case"topLeft":case"bottomLeft":q.offset[0]=-X.arrowOffsetHorizontal-i;break;case"topRight":case"bottomRight":q.offset[0]=X.arrowOffsetHorizontal+i;break;case"leftTop":case"rightTop":q.offset[1]=-X.arrowOffsetHorizontal*2+i;break;case"leftBottom":case"rightBottom":q.offset[1]=X.arrowOffsetHorizontal*2-i;break}q.overflow=uH(N,X,r,a),T&&(q.htmlRegion="visibleFirst")}),L}const pH=e=>{const{calc:r,componentCls:a,tooltipMaxWidth:c,tooltipColor:d,tooltipBg:x,tooltipBorderRadius:T,zIndexPopup:i,controlHeight:L,boxShadowSecondary:N,paddingSM:U,paddingXS:q,arrowOffsetHorizontal:X,sizePopupArrow:se}=e,ce=r(T).add(se).add(X).equal(),ue=r(T).mul(2).add(se).equal();return[{[a]:Object.assign(Object.assign(Object.assign(Object.assign({},hl(e)),{position:"absolute",zIndex:i,display:"block",width:"max-content",maxWidth:c,visibility:"visible","--valid-offset-x":"var(--arrow-offset-horizontal, var(--arrow-x))",transformOrigin:["var(--valid-offset-x, 50%)","var(--arrow-y, 50%)"].join(" "),"&-hidden":{display:"none"},"--antd-arrow-background-color":x,[`${a}-inner`]:{minWidth:ue,minHeight:L,padding:`${fn(e.calc(U).div(2).equal())} ${fn(q)}`,color:d,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:x,borderRadius:T,boxShadow:N,boxSizing:"border-box"},[["&-placement-topLeft","&-placement-topRight","&-placement-bottomLeft","&-placement-bottomRight"].join(",")]:{minWidth:ce},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${a}-inner`]:{borderRadius:e.min(T,u6)}},[`${a}-content`]:{position:"relative"}}),K9(e,(fe,re)=>{let{darkColor:ee}=re;return{[`&${a}-${fe}`]:{[`${a}-inner`]:{backgroundColor:ee},[`${a}-arrow`]:{"--antd-arrow-background-color":ee}}}})),{"&-rtl":{direction:"rtl"}})},cH(e,"var(--antd-arrow-background-color)"),{[`${a}-pure`]:{position:"relative",maxWidth:"none",margin:e.sizePopupArrow}}]},mH=e=>Object.assign(Object.assign({zIndexPopup:e.zIndexPopupBase+70},h6({contentRadius:e.borderRadius,limitVerticalRadius:!0})),sH(Wo(e,{borderRadiusOuter:Math.min(e.borderRadiusOuter,4)}))),d6=function(e){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Ms("Tooltip",c=>{const{borderRadius:d,colorTextLightSolid:x,colorBgSpotlight:T}=c,i=Wo(c,{tooltipMaxWidth:250,tooltipColor:x,tooltipBorderRadius:d,tooltipBg:T});return[pH(i),RV(c,"zoom-big-fast")]},mH,{resetStyle:!1,injectStyle:r})(e)},gH=d1.map(e=>`${e}-inverse`);function _H(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?[].concat(zr(gH),zr(d1)).includes(e):d1.includes(e)}function f6(e,r){const a=_H(r),c=Mr({[`${e}-${r}`]:r&&a}),d={},x={};return r&&!a&&(d.background=r,x["--antd-arrow-background-color"]=r),{className:c,overlayStyle:d,arrowStyle:x}}const yH=e=>{const{prefixCls:r,className:a,placement:c="top",title:d,color:x,overlayInnerStyle:T}=e,{getPrefixCls:i}=$.useContext(Yn),L=i("tooltip",r),[N,U,q]=d6(L),X=f6(L,x),se=X.arrowStyle,ce=Object.assign(Object.assign({},T),X.overlayStyle),ue=Mr(U,q,L,`${L}-pure`,`${L}-placement-${c}`,a,X.className);return N($.createElement("div",{className:ue,style:se},$.createElement("div",{className:`${L}-arrow`}),$.createElement(c6,Object.assign({},e,{className:U,prefixCls:L,overlayInnerStyle:ce}),d)))},vH=yH;var xH=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};const bH=$.forwardRef((e,r)=>{var a,c;const{prefixCls:d,openClassName:x,getTooltipContainer:T,overlayClassName:i,color:L,overlayInnerStyle:N,children:U,afterOpenChange:q,afterVisibleChange:X,destroyTooltipOnHide:se,arrow:ce=!0,title:ue,overlay:fe,builtinPlacements:re,arrowPointAtCenter:ee=!1,autoAdjustOverflow:ae=!0}=e,ve=!!ce,[,Te]=$l(),{getPopupContainer:pe,getPrefixCls:Ee,direction:Ne}=$.useContext(Yn),Xe=IE(),Fe=$.useRef(null),Je=()=>{var fr;(fr=Fe.current)===null||fr===void 0||fr.forceAlign()};$.useImperativeHandle(r,()=>{var fr;return{forceAlign:Je,forcePopupAlign:()=>{Xe.deprecated(!1,"forcePopupAlign","forceAlign"),Je()},nativeElement:(fr=Fe.current)===null||fr===void 0?void 0:fr.nativeElement}});const[Ct,ft]=LE(!1,{value:(a=e.open)!==null&&a!==void 0?a:e.visible,defaultValue:(c=e.defaultOpen)!==null&&c!==void 0?c:e.defaultVisible}),yt=!ue&&!fe&&ue!==0,lt=fr=>{var Jt,bn;ft(yt?!1:fr),yt||((Jt=e.onOpenChange)===null||Jt===void 0||Jt.call(e,fr),(bn=e.onVisibleChange)===null||bn===void 0||bn.call(e,fr))},ct=$.useMemo(()=>{var fr,Jt;let bn=ee;return typeof ce=="object"&&(bn=(Jt=(fr=ce.pointAtCenter)!==null&&fr!==void 0?fr:ce.arrowPointAtCenter)!==null&&Jt!==void 0?Jt:ee),re||fH({arrowPointAtCenter:bn,autoAdjustOverflow:ae,arrowWidth:ve?Te.sizePopupArrow:0,borderRadius:Te.borderRadius,offset:Te.marginXXS,visibleFirst:!0})},[ee,ce,re,Te]),Ye=$.useMemo(()=>ue===0?ue:fe||ue||"",[fe,ue]),Ke=$.createElement(uG,{space:!0},typeof Ye=="function"?Ye():Ye),{getPopupContainer:tt,placement:ht="top",mouseEnterDelay:vt=.1,mouseLeaveDelay:At=.1,overlayStyle:Pt,rootClassName:qt}=e,or=xH(e,["getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName"]),cr=Ee("tooltip",d),Qt=Ee(),qr=e["data-popover-inject"];let yr=Ct;!("open"in e)&&!("visible"in e)&&yt&&(yr=!1);const Ae=$.isValidElement(U)&&!VL(U)?U:$.createElement("span",null,U),Lr=Ae.props,$r=!Lr.className||typeof Lr.className=="string"?Mr(Lr.className,x||`${cr}-open`):Lr.className,[pn,wt,Pr]=d6(cr,!qr),Ur=f6(cr,L),Un=Ur.arrowStyle,ar=Object.assign(Object.assign({},N),Ur.overlayStyle),tn=Mr(i,{[`${cr}-rtl`]:Ne==="rtl"},Ur.className,qt,wt,Pr),[Ln,Xr]=w$("Tooltip",or.zIndex),hn=$.createElement(aH,Object.assign({},or,{zIndex:Ln,showArrow:ve,placement:ht,mouseEnterDelay:vt,mouseLeaveDelay:At,prefixCls:cr,overlayClassName:tn,overlayStyle:Object.assign(Object.assign({},Un),Pt),getTooltipContainer:tt||T||pe,ref:Fe,builtinPlacements:ct,overlay:Ke,visible:yr,onVisibleChange:lt,afterVisibleChange:q??X,overlayInnerStyle:ar,arrowContent:$.createElement("span",{className:`${cr}-arrow-content`}),motion:{motionName:k$(Qt,"zoom-big-fast",e.transitionName),motionDeadline:1e3},destroyTooltipOnHide:!!se}),yr?j_(Ae,{className:$r}):Ae);return pn($.createElement(UL.Provider,{value:Xr},hn))}),p6=bH;p6._InternalPanelDoNotUseOrYouWillBeFired=vH;const wH=p6,m6=$.createContext(null),SH=m6.Provider,g6=$.createContext(null),EH=g6.Provider;var TH=["prefixCls","className","style","checked","disabled","defaultChecked","type","title","onChange"],_6=$.forwardRef(function(e,r){var a=e.prefixCls,c=a===void 0?"rc-checkbox":a,d=e.className,x=e.style,T=e.checked,i=e.disabled,L=e.defaultChecked,N=L===void 0?!1:L,U=e.type,q=U===void 0?"checkbox":U,X=e.title,se=e.onChange,ce=is(e,TH),ue=$.useRef(null),fe=$.useRef(null),re=LE(N,{value:T}),ee=Sr(re,2),ae=ee[0],ve=ee[1];$.useImperativeHandle(r,function(){return{focus:function(Ne){var Xe;(Xe=ue.current)===null||Xe===void 0||Xe.focus(Ne)},blur:function(){var Ne;(Ne=ue.current)===null||Ne===void 0||Ne.blur()},input:ue.current,nativeElement:fe.current}});var Te=Mr(c,d,Et(Et({},"".concat(c,"-checked"),ae),"".concat(c,"-disabled"),i)),pe=function(Ne){i||("checked"in e||ve(Ne.target.checked),se==null||se({target:Ft(Ft({},e),{},{type:q,checked:Ne.target.checked}),stopPropagation:function(){Ne.stopPropagation()},preventDefault:function(){Ne.preventDefault()},nativeEvent:Ne.nativeEvent}))};return $.createElement("span",{className:Te,title:X,style:x,ref:fe},$.createElement("input",Po({},ce,{className:"".concat(c,"-input"),ref:ue,onChange:pe,disabled:i,checked:!!ae,type:q})),$.createElement("span",{className:"".concat(c,"-inner")}))});function y6(e){const r=sn.useRef(null),a=()=>{fl.cancel(r.current),r.current=null};return[()=>{a(),r.current=fl(()=>{r.current=null})},x=>{r.current&&(x.stopPropagation(),a()),e==null||e(x)}]}const CH=e=>{const{componentCls:r,antCls:a}=e,c=`${r}-group`;return{[c]:Object.assign(Object.assign({},hl(e)),{display:"inline-block",fontSize:0,[`&${c}-rtl`]:{direction:"rtl"},[`&${c}-block`]:{display:"flex"},[`${a}-badge ${a}-badge-count`]:{zIndex:1},[`> ${a}-badge:not(:first-child) > ${a}-button-wrapper`]:{borderInlineStart:"none"}})}},MH=e=>{const{componentCls:r,wrapperMarginInlineEnd:a,colorPrimary:c,radioSize:d,motionDurationSlow:x,motionDurationMid:T,motionEaseInOutCirc:i,colorBgContainer:L,colorBorder:N,lineWidth:U,colorBgContainerDisabled:q,colorTextDisabled:X,paddingXS:se,dotColorDisabled:ce,lineType:ue,radioColor:fe,radioBgColor:re,calc:ee}=e,ae=`${r}-inner`,ve=4,Te=ee(d).sub(ee(ve).mul(2)),pe=ee(1).mul(d).equal({unit:!0});return{[`${r}-wrapper`]:Object.assign(Object.assign({},hl(e)),{display:"inline-flex",alignItems:"baseline",marginInlineStart:0,marginInlineEnd:a,cursor:"pointer",[`&${r}-wrapper-rtl`]:{direction:"rtl"},"&-disabled":{cursor:"not-allowed",color:e.colorTextDisabled},"&::after":{display:"inline-block",width:0,overflow:"hidden",content:'"\\a0"'},"&-block":{flex:1,justifyContent:"center"},[`${r}-checked::after`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:"100%",height:"100%",border:`${fn(U)} ${ue} ${c}`,borderRadius:"50%",visibility:"hidden",opacity:0,content:'""'},[r]:Object.assign(Object.assign({},hl(e)),{position:"relative",display:"inline-block",outline:"none",cursor:"pointer",alignSelf:"center",borderRadius:"50%"}),[`${r}-wrapper:hover &,
        &:hover ${ae}`]:{borderColor:c},[`${r}-input:focus-visible + ${ae}`]:Object.assign({},ex(e)),[`${r}:hover::after, ${r}-wrapper:hover &::after`]:{visibility:"visible"},[`${r}-inner`]:{"&::after":{boxSizing:"border-box",position:"absolute",insetBlockStart:"50%",insetInlineStart:"50%",display:"block",width:pe,height:pe,marginBlockStart:ee(1).mul(d).div(-2).equal({unit:!0}),marginInlineStart:ee(1).mul(d).div(-2).equal({unit:!0}),backgroundColor:fe,borderBlockStart:0,borderInlineStart:0,borderRadius:pe,transform:"scale(0)",opacity:0,transition:`all ${x} ${i}`,content:'""'},boxSizing:"border-box",position:"relative",insetBlockStart:0,insetInlineStart:0,display:"block",width:pe,height:pe,backgroundColor:L,borderColor:N,borderStyle:"solid",borderWidth:U,borderRadius:"50%",transition:`all ${T}`},[`${r}-input`]:{position:"absolute",inset:0,zIndex:1,cursor:"pointer",opacity:0},[`${r}-checked`]:{[ae]:{borderColor:c,backgroundColor:re,"&::after":{transform:`scale(${e.calc(e.dotSize).div(d).equal()})`,opacity:1,transition:`all ${x} ${i}`}}},[`${r}-disabled`]:{cursor:"not-allowed",[ae]:{backgroundColor:q,borderColor:N,cursor:"not-allowed","&::after":{backgroundColor:ce}},[`${r}-input`]:{cursor:"not-allowed"},[`${r}-disabled + span`]:{color:X,cursor:"not-allowed"},[`&${r}-checked`]:{[ae]:{"&::after":{transform:`scale(${ee(Te).div(d).equal()})`}}}},[`span${r} + *`]:{paddingInlineStart:se,paddingInlineEnd:se}})}},IH=e=>{const{buttonColor:r,controlHeight:a,componentCls:c,lineWidth:d,lineType:x,colorBorder:T,motionDurationSlow:i,motionDurationMid:L,buttonPaddingInline:N,fontSize:U,buttonBg:q,fontSizeLG:X,controlHeightLG:se,controlHeightSM:ce,paddingXS:ue,borderRadius:fe,borderRadiusSM:re,borderRadiusLG:ee,buttonCheckedBg:ae,buttonSolidCheckedColor:ve,colorTextDisabled:Te,colorBgContainerDisabled:pe,buttonCheckedBgDisabled:Ee,buttonCheckedColorDisabled:Ne,colorPrimary:Xe,colorPrimaryHover:Fe,colorPrimaryActive:Je,buttonSolidCheckedBg:Ct,buttonSolidCheckedHoverBg:ft,buttonSolidCheckedActiveBg:yt,calc:lt}=e;return{[`${c}-button-wrapper`]:{position:"relative",display:"inline-block",height:a,margin:0,paddingInline:N,paddingBlock:0,color:r,fontSize:U,lineHeight:fn(lt(a).sub(lt(d).mul(2)).equal()),background:q,border:`${fn(d)} ${x} ${T}`,borderBlockStartWidth:lt(d).add(.02).equal(),borderInlineStartWidth:0,borderInlineEndWidth:d,cursor:"pointer",transition:[`color ${L}`,`background ${L}`,`box-shadow ${L}`].join(","),a:{color:r},[`> ${c}-button`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,zIndex:-1,width:"100%",height:"100%"},"&:not(:first-child)":{"&::before":{position:"absolute",insetBlockStart:lt(d).mul(-1).equal(),insetInlineStart:lt(d).mul(-1).equal(),display:"block",boxSizing:"content-box",width:1,height:"100%",paddingBlock:d,paddingInline:0,backgroundColor:T,transition:`background-color ${i}`,content:'""'}},"&:first-child":{borderInlineStart:`${fn(d)} ${x} ${T}`,borderStartStartRadius:fe,borderEndStartRadius:fe},"&:last-child":{borderStartEndRadius:fe,borderEndEndRadius:fe},"&:first-child:last-child":{borderRadius:fe},[`${c}-group-large &`]:{height:se,fontSize:X,lineHeight:fn(lt(se).sub(lt(d).mul(2)).equal()),"&:first-child":{borderStartStartRadius:ee,borderEndStartRadius:ee},"&:last-child":{borderStartEndRadius:ee,borderEndEndRadius:ee}},[`${c}-group-small &`]:{height:ce,paddingInline:lt(ue).sub(d).equal(),paddingBlock:0,lineHeight:fn(lt(ce).sub(lt(d).mul(2)).equal()),"&:first-child":{borderStartStartRadius:re,borderEndStartRadius:re},"&:last-child":{borderStartEndRadius:re,borderEndEndRadius:re}},"&:hover":{position:"relative",color:Xe},"&:has(:focus-visible)":Object.assign({},ex(e)),[`${c}-inner, input[type='checkbox'], input[type='radio']`]:{width:0,height:0,opacity:0,pointerEvents:"none"},[`&-checked:not(${c}-button-wrapper-disabled)`]:{zIndex:1,color:Xe,background:ae,borderColor:Xe,"&::before":{backgroundColor:Xe},"&:first-child":{borderColor:Xe},"&:hover":{color:Fe,borderColor:Fe,"&::before":{backgroundColor:Fe}},"&:active":{color:Je,borderColor:Je,"&::before":{backgroundColor:Je}}},[`${c}-group-solid &-checked:not(${c}-button-wrapper-disabled)`]:{color:ve,background:Ct,borderColor:Ct,"&:hover":{color:ve,background:ft,borderColor:ft},"&:active":{color:ve,background:yt,borderColor:yt}},"&-disabled":{color:Te,backgroundColor:pe,borderColor:T,cursor:"not-allowed","&:first-child, &:hover":{color:Te,backgroundColor:pe,borderColor:T}},[`&-disabled${c}-button-wrapper-checked`]:{color:Ne,backgroundColor:Ee,borderColor:T,boxShadow:"none"},"&-block":{flex:1,textAlign:"center"}}}},PH=e=>{const{wireframe:r,padding:a,marginXS:c,lineWidth:d,fontSizeLG:x,colorText:T,colorBgContainer:i,colorTextDisabled:L,controlItemBgActiveDisabled:N,colorTextLightSolid:U,colorPrimary:q,colorPrimaryHover:X,colorPrimaryActive:se,colorWhite:ce}=e,ue=4,fe=x,re=r?fe-ue*2:fe-(ue+d)*2;return{radioSize:fe,dotSize:re,dotColorDisabled:L,buttonSolidCheckedColor:U,buttonSolidCheckedBg:q,buttonSolidCheckedHoverBg:X,buttonSolidCheckedActiveBg:se,buttonBg:i,buttonCheckedBg:i,buttonColor:T,buttonCheckedBgDisabled:N,buttonCheckedColorDisabled:L,buttonPaddingInline:a-d,wrapperMarginInlineEnd:c,radioColor:r?q:ce,radioBgColor:r?i:q}},v6=Ms("Radio",e=>{const{controlOutline:r,controlOutlineWidth:a}=e,c=`0 0 0 ${fn(a)} ${r}`,x=Wo(e,{radioFocusShadow:c,radioButtonFocusShadow:c});return[CH(x),MH(x),IH(x)]},PH,{unitless:{radioSize:!0,dotSize:!0}});var AH=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};const RH=(e,r)=>{var a,c;const d=$.useContext(m6),x=$.useContext(g6),{getPrefixCls:T,direction:i,radio:L}=$.useContext(Yn),N=$.useRef(null),U=cd(r,N),{isFormItemInput:q}=$.useContext($u),X=ct=>{var Ye,Ke;(Ye=e.onChange)===null||Ye===void 0||Ye.call(e,ct),(Ke=d==null?void 0:d.onChange)===null||Ke===void 0||Ke.call(d,ct)},{prefixCls:se,className:ce,rootClassName:ue,children:fe,style:re,title:ee}=e,ae=AH(e,["prefixCls","className","rootClassName","children","style","title"]),ve=T("radio",se),Te=((d==null?void 0:d.optionType)||x)==="button",pe=Te?`${ve}-button`:ve,Ee=hd(ve),[Ne,Xe,Fe]=v6(ve,Ee),Je=Object.assign({},ae),Ct=$.useContext(B_);d&&(Je.name=d.name,Je.onChange=X,Je.checked=e.value===d.value,Je.disabled=(a=Je.disabled)!==null&&a!==void 0?a:d.disabled),Je.disabled=(c=Je.disabled)!==null&&c!==void 0?c:Ct;const ft=Mr(`${pe}-wrapper`,{[`${pe}-wrapper-checked`]:Je.checked,[`${pe}-wrapper-disabled`]:Je.disabled,[`${pe}-wrapper-rtl`]:i==="rtl",[`${pe}-wrapper-in-form-item`]:q,[`${pe}-wrapper-block`]:!!(d!=null&&d.block)},L==null?void 0:L.className,ce,ue,Xe,Fe,Ee),[yt,lt]=y6(Je.onClick);return Ne($.createElement(NE,{component:"Radio",disabled:Je.disabled},$.createElement("label",{className:ft,style:Object.assign(Object.assign({},L==null?void 0:L.style),re),onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,title:ee,onClick:yt},$.createElement(_6,Object.assign({},Je,{className:Mr(Je.className,{[ix]:!Te}),type:"radio",prefixCls:pe,ref:U,onClick:lt})),fe!==void 0?$.createElement("span",null,fe):null)))},zH=$.forwardRef(RH),m1=zH,LH=$.forwardRef((e,r)=>{const{getPrefixCls:a,direction:c}=$.useContext(Yn),{prefixCls:d,className:x,rootClassName:T,options:i,buttonStyle:L="outline",disabled:N,children:U,size:q,style:X,id:se,optionType:ce,name:ue,defaultValue:fe,value:re,block:ee=!1,onChange:ae,onMouseEnter:ve,onMouseLeave:Te,onFocus:pe,onBlur:Ee}=e,[Ne,Xe]=LE(fe,{value:re}),Fe=$.useCallback(vt=>{const At=Ne,Pt=vt.target.value;"value"in e||Xe(Pt),Pt!==At&&(ae==null||ae(vt))},[Ne,Xe,ae]),Je=a("radio",d),Ct=`${Je}-group`,ft=hd(Je),[yt,lt,ct]=v6(Je,ft);let Ye=U;i&&i.length>0&&(Ye=i.map(vt=>typeof vt=="string"||typeof vt=="number"?$.createElement(m1,{key:vt.toString(),prefixCls:Je,disabled:N,value:vt,checked:Ne===vt},vt):$.createElement(m1,{key:`radio-group-value-options-${vt.value}`,prefixCls:Je,disabled:vt.disabled||N,value:vt.value,checked:Ne===vt.value,title:vt.title,style:vt.style,id:vt.id,required:vt.required},vt.label)));const Ke=ox(q),tt=Mr(Ct,`${Ct}-${L}`,{[`${Ct}-${Ke}`]:Ke,[`${Ct}-rtl`]:c==="rtl",[`${Ct}-block`]:ee},x,T,lt,ct,ft),ht=$.useMemo(()=>({onChange:Fe,value:Ne,disabled:N,name:ue,optionType:ce,block:ee}),[Fe,Ne,N,ue,ce,ee]);return yt($.createElement("div",Object.assign({},c$(e,{aria:!0,data:!0}),{className:tt,style:X,onMouseEnter:ve,onMouseLeave:Te,onFocus:pe,onBlur:Ee,id:se,ref:r}),$.createElement(SH,{value:ht},Ye)))}),kH=$.memo(LH);var DH=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};const OH=(e,r)=>{const{getPrefixCls:a}=$.useContext(Yn),{prefixCls:c}=e,d=DH(e,["prefixCls"]),x=a("radio",c);return $.createElement(EH,{value:"button"},$.createElement(m1,Object.assign({prefixCls:x},d,{type:"radio",ref:r})))},FH=$.forwardRef(OH),hx=m1;hx.Button=FH;hx.Group=kH;hx.__ANT_RADIO=!0;const cn=hx;function BH(e,r,a){var c=a||{},d=c.noTrailing,x=d===void 0?!1:d,T=c.noLeading,i=T===void 0?!1:T,L=c.debounceMode,N=L===void 0?void 0:L,U,q=!1,X=0;function se(){U&&clearTimeout(U)}function ce(fe){var re=fe||{},ee=re.upcomingOnly,ae=ee===void 0?!1:ee;se(),q=!ae}function ue(){for(var fe=arguments.length,re=new Array(fe),ee=0;ee<fe;ee++)re[ee]=arguments[ee];var ae=this,ve=Date.now()-X;if(q)return;function Te(){X=Date.now(),r.apply(ae,re)}function pe(){U=void 0}!i&&N&&!U&&Te(),se(),N===void 0&&ve>e?i?(X=Date.now(),x||(U=setTimeout(N?pe:Te,e))):Te():x!==!0&&(U=setTimeout(N?pe:Te,N===void 0?e-ve:e))}return ue.cancel=ce,ue}function NH(e,r,a){var c=a||{},d=c.atBegin,x=d===void 0?!1:d;return BH(e,r,{debounceMode:x!==!1})}const jH=e=>{const{checkboxCls:r}=e,a=`${r}-wrapper`;return[{[`${r}-group`]:Object.assign(Object.assign({},hl(e)),{display:"inline-flex",flexWrap:"wrap",columnGap:e.marginXS,[`> ${e.antCls}-row`]:{flex:1}}),[a]:Object.assign(Object.assign({},hl(e)),{display:"inline-flex",alignItems:"baseline",cursor:"pointer","&:after":{display:"inline-block",width:0,overflow:"hidden",content:"'\\a0'"},[`& + ${a}`]:{marginInlineStart:0},[`&${a}-in-form-item`]:{'input[type="checkbox"]':{width:14,height:14}}}),[r]:Object.assign(Object.assign({},hl(e)),{position:"relative",whiteSpace:"nowrap",lineHeight:1,cursor:"pointer",borderRadius:e.borderRadiusSM,alignSelf:"center",[`${r}-input`]:{position:"absolute",inset:0,zIndex:1,cursor:"pointer",opacity:0,margin:0,[`&:focus-visible + ${r}-inner`]:Object.assign({},ex(e))},[`${r}-inner`]:{boxSizing:"border-box",display:"block",width:e.checkboxSize,height:e.checkboxSize,direction:"ltr",backgroundColor:e.colorBgContainer,border:`${fn(e.lineWidth)} ${e.lineType} ${e.colorBorder}`,borderRadius:e.borderRadiusSM,borderCollapse:"separate",transition:`all ${e.motionDurationSlow}`,"&:after":{boxSizing:"border-box",position:"absolute",top:"50%",insetInlineStart:"25%",display:"table",width:e.calc(e.checkboxSize).div(14).mul(5).equal(),height:e.calc(e.checkboxSize).div(14).mul(8).equal(),border:`${fn(e.lineWidthBold)} solid ${e.colorWhite}`,borderTop:0,borderInlineStart:0,transform:"rotate(45deg) scale(0) translate(-50%,-50%)",opacity:0,content:'""',transition:`all ${e.motionDurationFast} ${e.motionEaseInBack}, opacity ${e.motionDurationFast}`}},"& + span":{paddingInlineStart:e.paddingXS,paddingInlineEnd:e.paddingXS}})},{[`
        ${a}:not(${a}-disabled),
        ${r}:not(${r}-disabled)
      `]:{[`&:hover ${r}-inner`]:{borderColor:e.colorPrimary}},[`${a}:not(${a}-disabled)`]:{[`&:hover ${r}-checked:not(${r}-disabled) ${r}-inner`]:{backgroundColor:e.colorPrimaryHover,borderColor:"transparent"},[`&:hover ${r}-checked:not(${r}-disabled):after`]:{borderColor:e.colorPrimaryHover}}},{[`${r}-checked`]:{[`${r}-inner`]:{backgroundColor:e.colorPrimary,borderColor:e.colorPrimary,"&:after":{opacity:1,transform:"rotate(45deg) scale(1) translate(-50%,-50%)",transition:`all ${e.motionDurationMid} ${e.motionEaseOutBack} ${e.motionDurationFast}`}}},[`
        ${a}-checked:not(${a}-disabled),
        ${r}-checked:not(${r}-disabled)
      `]:{[`&:hover ${r}-inner`]:{backgroundColor:e.colorPrimaryHover,borderColor:"transparent"}}},{[r]:{"&-indeterminate":{[`${r}-inner`]:{backgroundColor:`${e.colorBgContainer} !important`,borderColor:`${e.colorBorder} !important`,"&:after":{top:"50%",insetInlineStart:"50%",width:e.calc(e.fontSizeLG).div(2).equal(),height:e.calc(e.fontSizeLG).div(2).equal(),backgroundColor:e.colorPrimary,border:0,transform:"translate(-50%, -50%) scale(1)",opacity:1,content:'""'}},[`&:hover ${r}-inner`]:{backgroundColor:`${e.colorBgContainer} !important`,borderColor:`${e.colorPrimary} !important`}}}},{[`${a}-disabled`]:{cursor:"not-allowed"},[`${r}-disabled`]:{[`&, ${r}-input`]:{cursor:"not-allowed",pointerEvents:"none"},[`${r}-inner`]:{background:e.colorBgContainerDisabled,borderColor:e.colorBorder,"&:after":{borderColor:e.colorTextDisabled}},"&:after":{display:"none"},"& + span":{color:e.colorTextDisabled},[`&${r}-indeterminate ${r}-inner::after`]:{background:e.colorTextDisabled}}}]};function $H(e,r){const a=Wo(r,{checkboxCls:`.${e}`,checkboxSize:r.controlInteractiveSize});return[jH(a)]}const x6=Ms("Checkbox",(e,r)=>{let{prefixCls:a}=r;return[$H(a,e)]}),VH=sn.createContext(null),b6=VH;var UH=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};const GH=(e,r)=>{var a;const{prefixCls:c,className:d,rootClassName:x,children:T,indeterminate:i=!1,style:L,onMouseEnter:N,onMouseLeave:U,skipGroup:q=!1,disabled:X}=e,se=UH(e,["prefixCls","className","rootClassName","children","indeterminate","style","onMouseEnter","onMouseLeave","skipGroup","disabled"]),{getPrefixCls:ce,direction:ue,checkbox:fe}=$.useContext(Yn),re=$.useContext(b6),{isFormItemInput:ee}=$.useContext($u),ae=$.useContext(B_),ve=(a=(re==null?void 0:re.disabled)||X)!==null&&a!==void 0?a:ae,Te=$.useRef(se.value),pe=$.useRef(null),Ee=cd(r,pe);$.useEffect(()=>{re==null||re.registerValue(se.value)},[]),$.useEffect(()=>{if(!q)return se.value!==Te.current&&(re==null||re.cancelValue(Te.current),re==null||re.registerValue(se.value),Te.current=se.value),()=>re==null?void 0:re.cancelValue(se.value)},[se.value]),$.useEffect(()=>{var Ke;!((Ke=pe.current)===null||Ke===void 0)&&Ke.input&&(pe.current.input.indeterminate=i)},[i]);const Ne=ce("checkbox",c),Xe=hd(Ne),[Fe,Je,Ct]=x6(Ne,Xe),ft=Object.assign({},se);re&&!q&&(ft.onChange=function(){se.onChange&&se.onChange.apply(se,arguments),re.toggleOption&&re.toggleOption({label:T,value:se.value})},ft.name=re.name,ft.checked=re.value.includes(se.value));const yt=Mr(`${Ne}-wrapper`,{[`${Ne}-rtl`]:ue==="rtl",[`${Ne}-wrapper-checked`]:ft.checked,[`${Ne}-wrapper-disabled`]:ve,[`${Ne}-wrapper-in-form-item`]:ee},fe==null?void 0:fe.className,d,x,Ct,Xe,Je),lt=Mr({[`${Ne}-indeterminate`]:i},ix,Je),[ct,Ye]=y6(ft.onClick);return Fe($.createElement(NE,{component:"Checkbox",disabled:ve},$.createElement("label",{className:yt,style:Object.assign(Object.assign({},fe==null?void 0:fe.style),L),onMouseEnter:N,onMouseLeave:U,onClick:ct},$.createElement(_6,Object.assign({},ft,{onClick:Ye,prefixCls:Ne,className:lt,disabled:ve,ref:Ee})),T!==void 0&&$.createElement("span",null,T))))},HH=$.forwardRef(GH),w6=HH;var WH=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};const qH=$.forwardRef((e,r)=>{const{defaultValue:a,children:c,options:d=[],prefixCls:x,className:T,rootClassName:i,style:L,onChange:N}=e,U=WH(e,["defaultValue","children","options","prefixCls","className","rootClassName","style","onChange"]),{getPrefixCls:q,direction:X}=$.useContext(Yn),[se,ce]=$.useState(U.value||a||[]),[ue,fe]=$.useState([]);$.useEffect(()=>{"value"in U&&ce(U.value||[])},[U.value]);const re=$.useMemo(()=>d.map(lt=>typeof lt=="string"||typeof lt=="number"?{label:lt,value:lt}:lt),[d]),ee=lt=>{fe(ct=>ct.filter(Ye=>Ye!==lt))},ae=lt=>{fe(ct=>[].concat(zr(ct),[lt]))},ve=lt=>{const ct=se.indexOf(lt.value),Ye=zr(se);ct===-1?Ye.push(lt.value):Ye.splice(ct,1),"value"in U||ce(Ye),N==null||N(Ye.filter(Ke=>ue.includes(Ke)).sort((Ke,tt)=>{const ht=re.findIndex(At=>At.value===Ke),vt=re.findIndex(At=>At.value===tt);return ht-vt}))},Te=q("checkbox",x),pe=`${Te}-group`,Ee=hd(Te),[Ne,Xe,Fe]=x6(Te,Ee),Je=ud(U,["value","disabled"]),Ct=d.length?re.map(lt=>$.createElement(w6,{prefixCls:Te,key:lt.value.toString(),disabled:"disabled"in lt?lt.disabled:U.disabled,value:lt.value,checked:se.includes(lt.value),onChange:lt.onChange,className:`${pe}-item`,style:lt.style,title:lt.title,id:lt.id,required:lt.required},lt.label)):c,ft={toggleOption:ve,value:se,disabled:U.disabled,name:U.name,registerValue:ae,cancelValue:ee},yt=Mr(pe,{[`${pe}-rtl`]:X==="rtl"},T,i,Fe,Ee,Xe);return Ne($.createElement("div",Object.assign({className:yt,style:L},Je,{ref:r}),$.createElement(b6.Provider,{value:ft},Ct)))}),ZH=qH,JE=w6;JE.Group=ZH;JE.__ANT_CHECKBOX=!0;const XH=JE,YH=$.createContext({}),S6=YH,KH=e=>{const{componentCls:r}=e;return{[r]:{display:"flex",flexFlow:"row wrap",minWidth:0,"&::before, &::after":{display:"flex"},"&-no-wrap":{flexWrap:"nowrap"},"&-start":{justifyContent:"flex-start"},"&-center":{justifyContent:"center"},"&-end":{justifyContent:"flex-end"},"&-space-between":{justifyContent:"space-between"},"&-space-around":{justifyContent:"space-around"},"&-space-evenly":{justifyContent:"space-evenly"},"&-top":{alignItems:"flex-start"},"&-middle":{alignItems:"center"},"&-bottom":{alignItems:"flex-end"}}}},JH=e=>{const{componentCls:r}=e;return{[r]:{position:"relative",maxWidth:"100%",minHeight:1}}},QH=(e,r)=>{const{prefixCls:a,componentCls:c,gridColumns:d}=e,x={};for(let T=d;T>=0;T--)T===0?(x[`${c}${r}-${T}`]={display:"none"},x[`${c}-push-${T}`]={insetInlineStart:"auto"},x[`${c}-pull-${T}`]={insetInlineEnd:"auto"},x[`${c}${r}-push-${T}`]={insetInlineStart:"auto"},x[`${c}${r}-pull-${T}`]={insetInlineEnd:"auto"},x[`${c}${r}-offset-${T}`]={marginInlineStart:0},x[`${c}${r}-order-${T}`]={order:0}):(x[`${c}${r}-${T}`]=[{"--ant-display":"block",display:"block"},{display:"var(--ant-display)",flex:`0 0 ${T/d*100}%`,maxWidth:`${T/d*100}%`}],x[`${c}${r}-push-${T}`]={insetInlineStart:`${T/d*100}%`},x[`${c}${r}-pull-${T}`]={insetInlineEnd:`${T/d*100}%`},x[`${c}${r}-offset-${T}`]={marginInlineStart:`${T/d*100}%`},x[`${c}${r}-order-${T}`]={order:T});return x[`${c}${r}-flex`]={flex:`var(--${a}${r}-flex)`},x},p3=(e,r)=>QH(e,r),eW=(e,r,a)=>({[`@media (min-width: ${fn(r)})`]:Object.assign({},p3(e,a))}),tW=()=>({}),rW=()=>({}),nW=Ms("Grid",KH,tW),iW=Ms("Grid",e=>{const r=Wo(e,{gridColumns:24}),a={"-sm":r.screenSMMin,"-md":r.screenMDMin,"-lg":r.screenLGMin,"-xl":r.screenXLMin,"-xxl":r.screenXXLMin};return[JH(r),p3(r,""),p3(r,"-xs"),Object.keys(a).map(c=>eW(r,a[c],c)).reduce((c,d)=>Object.assign(Object.assign({},c),d),{})]},rW);var oW=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};function gP(e){return typeof e=="number"?`${e} ${e} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(e)?`0 0 ${e}`:e}const aW=["xs","sm","md","lg","xl","xxl"],sW=$.forwardRef((e,r)=>{const{getPrefixCls:a,direction:c}=$.useContext(Yn),{gutter:d,wrap:x}=$.useContext(S6),{prefixCls:T,span:i,order:L,offset:N,push:U,pull:q,className:X,children:se,flex:ce,style:ue}=e,fe=oW(e,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),re=a("col",T),[ee,ae,ve]=iW(re),Te={};let pe={};aW.forEach(Xe=>{let Fe={};const Je=e[Xe];typeof Je=="number"?Fe.span=Je:typeof Je=="object"&&(Fe=Je||{}),delete fe[Xe],pe=Object.assign(Object.assign({},pe),{[`${re}-${Xe}-${Fe.span}`]:Fe.span!==void 0,[`${re}-${Xe}-order-${Fe.order}`]:Fe.order||Fe.order===0,[`${re}-${Xe}-offset-${Fe.offset}`]:Fe.offset||Fe.offset===0,[`${re}-${Xe}-push-${Fe.push}`]:Fe.push||Fe.push===0,[`${re}-${Xe}-pull-${Fe.pull}`]:Fe.pull||Fe.pull===0,[`${re}-rtl`]:c==="rtl"}),Fe.flex&&(pe[`${re}-${Xe}-flex`]=!0,Te[`--${re}-${Xe}-flex`]=gP(Fe.flex))});const Ee=Mr(re,{[`${re}-${i}`]:i!==void 0,[`${re}-order-${L}`]:L,[`${re}-offset-${N}`]:N,[`${re}-push-${U}`]:U,[`${re}-pull-${q}`]:q},X,pe,ae,ve),Ne={};if(d&&d[0]>0){const Xe=d[0]/2;Ne.paddingLeft=Xe,Ne.paddingRight=Xe}return ce&&(Ne.flex=gP(ce),x===!1&&!Ne.minWidth&&(Ne.minWidth=0)),ee($.createElement("div",Object.assign({},fe,{style:Object.assign(Object.assign(Object.assign({},Ne),ue),Te),className:Ee,ref:r}),se))}),E6=sW;var lW=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};function _P(e,r){const[a,c]=$.useState(typeof e=="string"?e:""),d=()=>{if(typeof e=="string"&&c(e),typeof e=="object")for(let x=0;x<T_.length;x++){const T=T_[x];if(!r[T])continue;const i=e[T];if(i!==void 0){c(i);return}}};return $.useEffect(()=>{d()},[JSON.stringify(e),r]),a}const cW=$.forwardRef((e,r)=>{const{prefixCls:a,justify:c,align:d,className:x,style:T,children:i,gutter:L=0,wrap:N}=e,U=lW(e,["prefixCls","justify","align","className","style","children","gutter","wrap"]),{getPrefixCls:q,direction:X}=$.useContext(Yn),[se,ce]=$.useState({xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0}),[ue,fe]=$.useState({xs:!1,sm:!1,md:!1,lg:!1,xl:!1,xxl:!1}),re=_P(d,ue),ee=_P(c,ue),ae=$.useRef(L),ve=rH();$.useEffect(()=>{const Ye=ve.subscribe(Ke=>{fe(Ke);const tt=ae.current||0;(!Array.isArray(tt)&&typeof tt=="object"||Array.isArray(tt)&&(typeof tt[0]=="object"||typeof tt[1]=="object"))&&ce(Ke)});return()=>ve.unsubscribe(Ye)},[]);const Te=()=>{const Ye=[void 0,void 0];return(Array.isArray(L)?L:[L,void 0]).forEach((tt,ht)=>{if(typeof tt=="object")for(let vt=0;vt<T_.length;vt++){const At=T_[vt];if(se[At]&&tt[At]!==void 0){Ye[ht]=tt[At];break}}else Ye[ht]=tt}),Ye},pe=q("row",a),[Ee,Ne,Xe]=nW(pe),Fe=Te(),Je=Mr(pe,{[`${pe}-no-wrap`]:N===!1,[`${pe}-${ee}`]:ee,[`${pe}-${re}`]:re,[`${pe}-rtl`]:X==="rtl"},x,Ne,Xe),Ct={},ft=Fe[0]!=null&&Fe[0]>0?Fe[0]/-2:void 0;ft&&(Ct.marginLeft=ft,Ct.marginRight=ft);const[yt,lt]=Fe;Ct.rowGap=lt;const ct=$.useMemo(()=>({gutter:[yt,lt],wrap:N}),[yt,lt,N]);return Ee($.createElement(S6.Provider,{value:ct},$.createElement("div",Object.assign({},U,{className:Je,style:Object.assign(Object.assign({},Ct),T),ref:r}),i)))}),uW=cW,hW=e=>{const{componentCls:r,sizePaddingEdgeHorizontal:a,colorSplit:c,lineWidth:d,textPaddingInline:x,orientationMargin:T,verticalMarginInline:i}=e;return{[r]:Object.assign(Object.assign({},hl(e)),{borderBlockStart:`${fn(d)} solid ${c}`,"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",marginInline:i,marginBlock:0,verticalAlign:"middle",borderTop:0,borderInlineStart:`${fn(d)} solid ${c}`},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:`${fn(e.dividerHorizontalGutterMargin)} 0`},[`&-horizontal${r}-with-text`]:{display:"flex",alignItems:"center",margin:`${fn(e.dividerHorizontalWithTextGutterMargin)} 0`,color:e.colorTextHeading,fontWeight:500,fontSize:e.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:`0 ${c}`,"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:`${fn(d)} solid transparent`,borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}},[`&-horizontal${r}-with-text-left`]:{"&::before":{width:`calc(${T} * 100%)`},"&::after":{width:`calc(100% - ${T} * 100%)`}},[`&-horizontal${r}-with-text-right`]:{"&::before":{width:`calc(100% - ${T} * 100%)`},"&::after":{width:`calc(${T} * 100%)`}},[`${r}-inner-text`]:{display:"inline-block",paddingBlock:0,paddingInline:x},"&-dashed":{background:"none",borderColor:c,borderStyle:"dashed",borderWidth:`${fn(d)} 0 0`},[`&-horizontal${r}-with-text${r}-dashed`]:{"&::before, &::after":{borderStyle:"dashed none none"}},[`&-vertical${r}-dashed`]:{borderInlineStartWidth:d,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},"&-dotted":{background:"none",borderColor:c,borderStyle:"dotted",borderWidth:`${fn(d)} 0 0`},[`&-horizontal${r}-with-text${r}-dotted`]:{"&::before, &::after":{borderStyle:"dotted none none"}},[`&-vertical${r}-dotted`]:{borderInlineStartWidth:d,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},[`&-plain${r}-with-text`]:{color:e.colorText,fontWeight:"normal",fontSize:e.fontSize},[`&-horizontal${r}-with-text-left${r}-no-default-orientation-margin-left`]:{"&::before":{width:0},"&::after":{width:"100%"},[`${r}-inner-text`]:{paddingInlineStart:a}},[`&-horizontal${r}-with-text-right${r}-no-default-orientation-margin-right`]:{"&::before":{width:"100%"},"&::after":{width:0},[`${r}-inner-text`]:{paddingInlineEnd:a}}})}},dW=e=>({textPaddingInline:"1em",orientationMargin:.05,verticalMarginInline:e.marginXS}),fW=Ms("Divider",e=>{const r=Wo(e,{dividerHorizontalWithTextGutterMargin:e.margin,dividerHorizontalGutterMargin:e.marginLG,sizePaddingEdgeHorizontal:0});return[hW(r)]},dW,{unitless:{orientationMargin:!0}});var pW=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};const mW=e=>{const{getPrefixCls:r,direction:a,divider:c}=$.useContext(Yn),{prefixCls:d,type:x="horizontal",orientation:T="center",orientationMargin:i,className:L,rootClassName:N,children:U,dashed:q,variant:X="solid",plain:se,style:ce}=e,ue=pW(e,["prefixCls","type","orientation","orientationMargin","className","rootClassName","children","dashed","variant","plain","style"]),fe=r("divider",d),[re,ee,ae]=fW(fe),ve=!!U,Te=T==="left"&&i!=null,pe=T==="right"&&i!=null,Ee=Mr(fe,c==null?void 0:c.className,ee,ae,`${fe}-${x}`,{[`${fe}-with-text`]:ve,[`${fe}-with-text-${T}`]:ve,[`${fe}-dashed`]:!!q,[`${fe}-${X}`]:X!=="solid",[`${fe}-plain`]:!!se,[`${fe}-rtl`]:a==="rtl",[`${fe}-no-default-orientation-margin-left`]:Te,[`${fe}-no-default-orientation-margin-right`]:pe},L,N),Ne=$.useMemo(()=>typeof i=="number"?i:/^\d+$/.test(i)?Number(i):i,[i]),Xe=Object.assign(Object.assign({},Te&&{marginLeft:Ne}),pe&&{marginRight:Ne});return re($.createElement("div",Object.assign({className:Ee,style:Object.assign(Object.assign({},c==null?void 0:c.style),ce)},ue,{role:"separator"}),U&&x!=="vertical"&&$.createElement("span",{className:`${fe}-inner-text`,style:Xe},U)))},QE=mW;function yP(e){return["small","middle","large"].includes(e)}function vP(e){return e?typeof e=="number"&&!Number.isNaN(e):!1}const T6=sn.createContext({latestIndex:0}),gW=T6.Provider,_W=e=>{let{className:r,index:a,children:c,split:d,style:x}=e;const{latestIndex:T}=$.useContext(T6);return c==null?null:$.createElement($.Fragment,null,$.createElement("div",{className:r,style:x},c),a<T&&d&&$.createElement("span",{className:`${r}-split`},d))},yW=_W;var vW=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};const xW=$.forwardRef((e,r)=>{var a,c,d;const{getPrefixCls:x,space:T,direction:i}=$.useContext(Yn),{size:L=(a=T==null?void 0:T.size)!==null&&a!==void 0?a:"small",align:N,className:U,rootClassName:q,children:X,direction:se="horizontal",prefixCls:ce,split:ue,style:fe,wrap:re=!1,classNames:ee,styles:ae}=e,ve=vW(e,["size","align","className","rootClassName","children","direction","prefixCls","split","style","wrap","classNames","styles"]),[Te,pe]=Array.isArray(L)?L:[L,L],Ee=yP(pe),Ne=yP(Te),Xe=vP(pe),Fe=vP(Te),Je=Yh(X,{keepEmpty:!0}),Ct=N===void 0&&se==="horizontal"?"center":N,ft=x("space",ce),[yt,lt,ct]=HL(ft),Ye=Mr(ft,T==null?void 0:T.className,lt,`${ft}-${se}`,{[`${ft}-rtl`]:i==="rtl",[`${ft}-align-${Ct}`]:Ct,[`${ft}-gap-row-${pe}`]:Ee,[`${ft}-gap-col-${Te}`]:Ne},U,q,ct),Ke=Mr(`${ft}-item`,(c=ee==null?void 0:ee.item)!==null&&c!==void 0?c:(d=T==null?void 0:T.classNames)===null||d===void 0?void 0:d.item);let tt=0;const ht=Je.map((Pt,qt)=>{var or,cr;Pt!=null&&(tt=qt);const Qt=(Pt==null?void 0:Pt.key)||`${Ke}-${qt}`;return $.createElement(yW,{className:Ke,key:Qt,index:qt,split:ue,style:(or=ae==null?void 0:ae.item)!==null&&or!==void 0?or:(cr=T==null?void 0:T.styles)===null||cr===void 0?void 0:cr.item},Pt)}),vt=$.useMemo(()=>({latestIndex:tt}),[tt]);if(Je.length===0)return null;const At={};return re&&(At.flexWrap="wrap"),!Ne&&Fe&&(At.columnGap=Te),!Ee&&Xe&&(At.rowGap=pe),yt($.createElement("div",Object.assign({ref:r,className:Ye,style:Object.assign(Object.assign(Object.assign({},At),T==null?void 0:T.style),fe)},ve),$.createElement(gW,{value:vt},ht)))}),C6=xW;C6.Compact=J$;const xP=C6;function g1(e){const[r,a]=$.useState(e);return $.useEffect(()=>{const c=setTimeout(()=>{a(e)},e.length?0:10);return()=>{clearTimeout(c)}},[e]),r}const bW=e=>{const{componentCls:r}=e,a=`${r}-show-help`,c=`${r}-show-help-item`;return{[a]:{transition:`opacity ${e.motionDurationFast} ${e.motionEaseInOut}`,"&-appear, &-enter":{opacity:0,"&-active":{opacity:1}},"&-leave":{opacity:1,"&-active":{opacity:0}},[c]:{overflow:"hidden",transition:`height ${e.motionDurationFast} ${e.motionEaseInOut},
                     opacity ${e.motionDurationFast} ${e.motionEaseInOut},
                     transform ${e.motionDurationFast} ${e.motionEaseInOut} !important`,[`&${c}-appear, &${c}-enter`]:{transform:"translateY(-5px)",opacity:0,"&-active":{transform:"translateY(0)",opacity:1}},[`&${c}-leave-active`]:{transform:"translateY(-5px)"}}}}},wW=bW,SW=e=>({legend:{display:"block",width:"100%",marginBottom:e.marginLG,padding:0,color:e.colorTextDescription,fontSize:e.fontSizeLG,lineHeight:"inherit",border:0,borderBottom:`${fn(e.lineWidth)} ${e.lineType} ${e.colorBorder}`},'input[type="search"]':{boxSizing:"border-box"},'input[type="radio"], input[type="checkbox"]':{lineHeight:"normal"},'input[type="file"]':{display:"block"},'input[type="range"]':{display:"block",width:"100%"},"select[multiple], select[size]":{height:"auto"},"input[type='file']:focus,\n  input[type='radio']:focus,\n  input[type='checkbox']:focus":{outline:0,boxShadow:`0 0 0 ${fn(e.controlOutlineWidth)} ${e.controlOutline}`},output:{display:"block",paddingTop:15,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight}}),bP=(e,r)=>{const{formItemCls:a}=e;return{[a]:{[`${a}-label > label`]:{height:r},[`${a}-control-input`]:{minHeight:r}}}},EW=e=>{const{componentCls:r}=e;return{[e.componentCls]:Object.assign(Object.assign(Object.assign({},hl(e)),SW(e)),{[`${r}-text`]:{display:"inline-block",paddingInlineEnd:e.paddingSM},"&-small":Object.assign({},bP(e,e.controlHeightSM)),"&-large":Object.assign({},bP(e,e.controlHeightLG))})}},TW=e=>{const{formItemCls:r,iconCls:a,componentCls:c,rootPrefixCls:d,antCls:x,labelRequiredMarkColor:T,labelColor:i,labelFontSize:L,labelHeight:N,labelColonMarginInlineStart:U,labelColonMarginInlineEnd:q,itemMarginBottom:X}=e;return{[r]:Object.assign(Object.assign({},hl(e)),{marginBottom:X,verticalAlign:"top","&-with-help":{transition:"none"},[`&-hidden,
        &-hidden${x}-row`]:{display:"none"},"&-has-warning":{[`${r}-split`]:{color:e.colorError}},"&-has-error":{[`${r}-split`]:{color:e.colorWarning}},[`${r}-label`]:{flexGrow:0,overflow:"hidden",whiteSpace:"nowrap",textAlign:"end",verticalAlign:"middle","&-left":{textAlign:"start"},"&-wrap":{overflow:"unset",lineHeight:e.lineHeight,whiteSpace:"unset"},"> label":{position:"relative",display:"inline-flex",alignItems:"center",maxWidth:"100%",height:N,color:i,fontSize:L,[`> ${a}`]:{fontSize:e.fontSize,verticalAlign:"top"},[`&${r}-required:not(${r}-required-mark-optional)::before`]:{display:"inline-block",marginInlineEnd:e.marginXXS,color:T,fontSize:e.fontSize,fontFamily:"SimSun, sans-serif",lineHeight:1,content:'"*"',[`${c}-hide-required-mark &`]:{display:"none"}},[`${r}-optional`]:{display:"inline-block",marginInlineStart:e.marginXXS,color:e.colorTextDescription,[`${c}-hide-required-mark &`]:{display:"none"}},[`${r}-tooltip`]:{color:e.colorTextDescription,cursor:"help",writingMode:"horizontal-tb",marginInlineStart:e.marginXXS},"&::after":{content:'":"',position:"relative",marginBlock:0,marginInlineStart:U,marginInlineEnd:q},[`&${r}-no-colon::after`]:{content:'"\\a0"'}}},[`${r}-control`]:{"--ant-display":"flex",flexDirection:"column",flexGrow:1,[`&:first-child:not([class^="'${d}-col-'"]):not([class*="' ${d}-col-'"])`]:{width:"100%"},"&-input":{position:"relative",display:"flex",alignItems:"center",minHeight:e.controlHeight,"&-content":{flex:"auto",maxWidth:"100%"}}},[r]:{"&-additional":{display:"flex",flexDirection:"column"},"&-explain, &-extra":{clear:"both",color:e.colorTextDescription,fontSize:e.fontSize,lineHeight:e.lineHeight},"&-explain-connected":{width:"100%"},"&-extra":{minHeight:e.controlHeightSM,transition:`color ${e.motionDurationMid} ${e.motionEaseOut}`},"&-explain":{"&-error":{color:e.colorError},"&-warning":{color:e.colorWarning}}},[`&-with-help ${r}-explain`]:{height:"auto",opacity:1},[`${r}-feedback-icon`]:{fontSize:e.fontSize,textAlign:"center",visibility:"visible",animationName:jE,animationDuration:e.motionDurationMid,animationTimingFunction:e.motionEaseOutBack,pointerEvents:"none","&-success":{color:e.colorSuccess},"&-error":{color:e.colorError},"&-warning":{color:e.colorWarning},"&-validating":{color:e.colorPrimary}}})}},wP=(e,r)=>{const{formItemCls:a}=e;return{[`${r}-horizontal`]:{[`${a}-label`]:{flexGrow:0},[`${a}-control`]:{flex:"1 1 0",minWidth:0},[`${a}-label[class$='-24'], ${a}-label[class*='-24 ']`]:{[`& + ${a}-control`]:{minWidth:"unset"}}}}},CW=e=>{const{componentCls:r,formItemCls:a,inlineItemMarginBottom:c}=e;return{[`${r}-inline`]:{display:"flex",flexWrap:"wrap",[a]:{flex:"none",marginInlineEnd:e.margin,marginBottom:c,"&-row":{flexWrap:"nowrap"},[`> ${a}-label,
        > ${a}-control`]:{display:"inline-block",verticalAlign:"top"},[`> ${a}-label`]:{flex:"none"},[`${r}-text`]:{display:"inline-block"},[`${a}-has-feedback`]:{display:"inline-block"}}}}},al=e=>({padding:e.verticalLabelPadding,margin:e.verticalLabelMargin,whiteSpace:"initial",textAlign:"start","> label":{margin:0,"&::after":{visibility:"hidden"}}}),M6=e=>{const{componentCls:r,formItemCls:a,rootPrefixCls:c}=e;return{[`${a} ${a}-label`]:al(e),[`${r}:not(${r}-inline)`]:{[a]:{flexWrap:"wrap",[`${a}-label, ${a}-control`]:{[`&:not([class*=" ${c}-col-xs"])`]:{flex:"0 0 100%",maxWidth:"100%"}}}}}},MW=e=>{const{componentCls:r,formItemCls:a,antCls:c}=e;return{[`${r}-vertical`]:{[`${a}:not(${a}-horizontal)`]:{[`${a}-row`]:{flexDirection:"column"},[`${a}-label > label`]:{height:"auto"},[`${a}-control`]:{width:"100%"},[`${a}-label,
        ${c}-col-24${a}-label,
        ${c}-col-xl-24${a}-label`]:al(e)}},[`@media (max-width: ${fn(e.screenXSMax)})`]:[M6(e),{[r]:{[`${a}:not(${a}-horizontal)`]:{[`${c}-col-xs-24${a}-label`]:al(e)}}}],[`@media (max-width: ${fn(e.screenSMMax)})`]:{[r]:{[`${a}:not(${a}-horizontal)`]:{[`${c}-col-sm-24${a}-label`]:al(e)}}},[`@media (max-width: ${fn(e.screenMDMax)})`]:{[r]:{[`${a}:not(${a}-horizontal)`]:{[`${c}-col-md-24${a}-label`]:al(e)}}},[`@media (max-width: ${fn(e.screenLGMax)})`]:{[r]:{[`${a}:not(${a}-horizontal)`]:{[`${c}-col-lg-24${a}-label`]:al(e)}}}}},IW=e=>{const{formItemCls:r,antCls:a}=e;return{[`${r}-vertical`]:{[`${r}-row`]:{flexDirection:"column"},[`${r}-label > label`]:{height:"auto"},[`${r}-control`]:{width:"100%"}},[`${r}-vertical ${r}-label,
      ${a}-col-24${r}-label,
      ${a}-col-xl-24${r}-label`]:al(e),[`@media (max-width: ${fn(e.screenXSMax)})`]:[M6(e),{[r]:{[`${a}-col-xs-24${r}-label`]:al(e)}}],[`@media (max-width: ${fn(e.screenSMMax)})`]:{[r]:{[`${a}-col-sm-24${r}-label`]:al(e)}},[`@media (max-width: ${fn(e.screenMDMax)})`]:{[r]:{[`${a}-col-md-24${r}-label`]:al(e)}},[`@media (max-width: ${fn(e.screenLGMax)})`]:{[r]:{[`${a}-col-lg-24${r}-label`]:al(e)}}}},PW=e=>({labelRequiredMarkColor:e.colorError,labelColor:e.colorTextHeading,labelFontSize:e.fontSize,labelHeight:e.controlHeight,labelColonMarginInlineStart:e.marginXXS/2,labelColonMarginInlineEnd:e.marginXS,itemMarginBottom:e.marginLG,verticalLabelPadding:`0 0 ${e.paddingXS}px`,verticalLabelMargin:0,inlineItemMarginBottom:0}),I6=(e,r)=>Wo(e,{formItemCls:`${e.componentCls}-item`,rootPrefixCls:r}),eT=Ms("Form",(e,r)=>{let{rootPrefixCls:a}=r;const c=I6(e,a);return[EW(c),TW(c),wW(c),wP(c,c.componentCls),wP(c,c.formItemCls),CW(c),MW(c),IW(c),_V(c),jE]},PW,{order:-1e3}),SP=[];function b2(e,r,a){let c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{key:typeof e=="string"?e:`${r}-${c}`,error:e,errorStatus:a}}const AW=e=>{let{help:r,helpStatus:a,errors:c=SP,warnings:d=SP,className:x,fieldId:T,onVisibleChanged:i}=e;const{prefixCls:L}=$.useContext(KE),N=`${L}-item-explain`,U=hd(L),[q,X,se]=eT(L,U),ce=$.useMemo(()=>O5(L),[L]),ue=g1(c),fe=g1(d),re=$.useMemo(()=>r!=null?[b2(r,"help",a)]:[].concat(zr(ue.map((ve,Te)=>b2(ve,"error","error",Te))),zr(fe.map((ve,Te)=>b2(ve,"warning","warning",Te)))),[r,a,ue,fe]),ee=$.useMemo(()=>{const ve={};return re.forEach(Te=>{let{key:pe}=Te;ve[pe]=(ve[pe]||0)+1}),re.map((Te,pe)=>Object.assign(Object.assign({},Te),{key:ve[Te.key]>1?`${Te.key}-fallback-${pe}`:Te.key}))},[re]),ae={};return T&&(ae.id=`${T}_help`),q($.createElement(zp,{motionDeadline:ce.motionDeadline,motionName:`${L}-show-help`,visible:!!ee.length,onVisibleChanged:i},ve=>{const{className:Te,style:pe}=ve;return $.createElement("div",Object.assign({},ae,{className:Mr(N,Te,se,U,x,X),style:pe,role:"alert"}),$.createElement(Cj,Object.assign({keys:ee},O5(L),{motionName:`${L}-show-help-item`,component:!1}),Ee=>{const{key:Ne,error:Xe,errorStatus:Fe,className:Je,style:Ct}=Ee;return $.createElement("div",{key:Ne,className:Mr(Je,{[`${N}-${Fe}`]:Fe}),style:Ct},Xe)}))}))},P6=AW,RW=["parentNode"],zW="form_item";function Zg(e){return e===void 0||e===!1?[]:Array.isArray(e)?e:[e]}function A6(e,r){if(!e.length)return;const a=e.join("_");return r?`${r}_${a}`:RW.includes(a)?`${zW}_${a}`:a}function R6(e,r,a,c,d,x){let T=c;return x!==void 0?T=x:a.validating?T="validating":e.length?T="error":r.length?T="warning":(a.touched||d&&a.validated)&&(T="success"),T}function EP(e){return Zg(e).join("_")}function TP(e,r){const a=r.getFieldInstance(e),c=Tz(a);if(c)return c;const d=A6(Zg(e),r.__INTERNAL__.name);if(d)return document.getElementById(d)}function z6(e){const[r]=YE(),a=$.useRef({}),c=$.useMemo(()=>e??Object.assign(Object.assign({},r),{__INTERNAL__:{itemRef:d=>x=>{const T=EP(d);x?a.current[T]=x:delete a.current[T]}},scrollToField:function(d){let x=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const T=TP(d,c);T&&f$(T,Object.assign({scrollMode:"if-needed",block:"nearest"},x))},focusField:d=>{var x;const T=TP(d,c);T&&((x=T.focus)===null||x===void 0||x.call(T))},getFieldInstance:d=>{const x=EP(d);return a.current[x]}}),[e,r]);return[c]}var LW=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};const kW=(e,r)=>{const a=$.useContext(B_),{getPrefixCls:c,direction:d,form:x}=$.useContext(Yn),{prefixCls:T,className:i,rootClassName:L,size:N,disabled:U=a,form:q,colon:X,labelAlign:se,labelWrap:ce,labelCol:ue,wrapperCol:fe,hideRequiredMark:re,layout:ee="horizontal",scrollToFirstError:ae,requiredMark:ve,onFinishFailed:Te,name:pe,style:Ee,feedbackIcons:Ne,variant:Xe}=e,Fe=LW(e,["prefixCls","className","rootClassName","size","disabled","form","colon","labelAlign","labelWrap","labelCol","wrapperCol","hideRequiredMark","layout","scrollToFirstError","requiredMark","onFinishFailed","name","style","feedbackIcons","variant"]),Je=ox(N),Ct=$.useContext(sL),ft=$.useMemo(()=>ve!==void 0?ve:re?!1:x&&x.requiredMark!==void 0?x.requiredMark:!0,[re,ve,x]),yt=X??(x==null?void 0:x.colon),lt=c("form",T),ct=hd(lt),[Ye,Ke,tt]=eT(lt,ct),ht=Mr(lt,`${lt}-${ee}`,{[`${lt}-hide-required-mark`]:ft===!1,[`${lt}-rtl`]:d==="rtl",[`${lt}-${Je}`]:Je},tt,ct,Ke,x==null?void 0:x.className,i,L),[vt]=z6(q),{__INTERNAL__:At}=vt;At.name=pe;const Pt=$.useMemo(()=>({name:pe,labelAlign:se,labelCol:ue,labelWrap:ce,wrapperCol:fe,vertical:ee==="vertical",colon:yt,requiredMark:ft,itemRef:At.itemRef,form:vt,feedbackIcons:Ne}),[pe,se,ue,fe,ee,yt,ft,vt,Ne]),qt=$.useRef(null);$.useImperativeHandle(r,()=>{var Qt;return Object.assign(Object.assign({},vt),{nativeElement:(Qt=qt.current)===null||Qt===void 0?void 0:Qt.nativeElement})});const or=(Qt,qr)=>{if(Qt){let yr={block:"nearest"};typeof Qt=="object"&&(yr=Object.assign(Object.assign({},yr),Qt)),vt.scrollToField(qr,yr),yr.focus&&vt.focusField(qr)}},cr=Qt=>{if(Te==null||Te(Qt),Qt.errorFields.length){const qr=Qt.errorFields[0].name;if(ae!==void 0){or(ae,qr);return}x&&x.scrollToFirstError!==void 0&&or(x.scrollToFirstError,qr)}};return Ye($.createElement(lG.Provider,{value:Xe},$.createElement(gL,{disabled:U},$.createElement(N_.Provider,{value:Je},$.createElement(l6,{validateMessages:Ct},$.createElement(Mc.Provider,{value:Pt},$.createElement(Dp,Object.assign({id:pe},Fe,{name:pe,onFinishFailed:cr,form:vt,ref:qt,style:Object.assign(Object.assign({},x==null?void 0:x.style),Ee),className:ht}))))))))},DW=$.forwardRef(kW),OW=DW;function FW(e){if(typeof e=="function")return e;const r=Yh(e);return r.length<=1?r[0]:r}const L6=()=>{const{status:e,errors:r=[],warnings:a=[]}=$.useContext($u);return{status:e,errors:r,warnings:a}};L6.Context=$u;const BW=L6;function NW(e){const[r,a]=$.useState(e),c=$.useRef(null),d=$.useRef([]),x=$.useRef(!1);$.useEffect(()=>(x.current=!1,()=>{x.current=!0,fl.cancel(c.current),c.current=null}),[]);function T(i){x.current||(c.current===null&&(d.current=[],c.current=fl(()=>{c.current=null,a(L=>{let N=L;return d.current.forEach(U=>{N=U(N)}),N})})),d.current.push(i))}return[r,T]}function jW(){const{itemRef:e}=$.useContext(Mc),r=$.useRef({});function a(c,d){const x=d&&typeof d=="object"&&O_(d),T=c.join("_");return(r.current.name!==T||r.current.originRef!==x)&&(r.current.name=T,r.current.originRef=x,r.current.ref=cd(e(c),x)),r.current.ref}return a}const $W=e=>{const{formItemCls:r}=e;return{"@media screen and (-ms-high-contrast: active), (-ms-high-contrast: none)":{[`${r}-control`]:{display:"flex"}}}},VW=SL(["Form","item-item"],(e,r)=>{let{rootPrefixCls:a}=r;const c=I6(e,a);return[$W(c)]});var UW=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};const GW=24,HW=e=>{const{prefixCls:r,status:a,labelCol:c,wrapperCol:d,children:x,errors:T,warnings:i,_internalItemRender:L,extra:N,help:U,fieldId:q,marginBottom:X,onErrorVisibleChanged:se,label:ce}=e,ue=`${r}-item`,fe=$.useContext(Mc),re=$.useMemo(()=>{let yt=Object.assign({},d||fe.wrapperCol||{});return ce===null&&!c&&!d&&fe.labelCol&&[void 0,"xs","sm","md","lg","xl","xxl"].forEach(ct=>{const Ye=ct?[ct]:[],Ke=bs(fe.labelCol,Ye),tt=typeof Ke=="object"?Ke:{},ht=bs(yt,Ye),vt=typeof ht=="object"?ht:{};"span"in tt&&!("offset"in vt)&&tt.span<GW&&(yt=_s(yt,[].concat(Ye,["offset"]),tt.span))}),yt},[d,fe]),ee=Mr(`${ue}-control`,re.className),ae=$.useMemo(()=>UW(fe,["labelCol","wrapperCol"]),[fe]),ve=$.useRef(null),[Te,pe]=$.useState(0);Mo(()=>{N&&ve.current?pe(ve.current.clientHeight):pe(0)},[N]);const Ee=$.createElement("div",{className:`${ue}-control-input`},$.createElement("div",{className:`${ue}-control-input-content`},x)),Ne=$.useMemo(()=>({prefixCls:r,status:a}),[r,a]),Xe=X!==null||T.length||i.length?$.createElement(KE.Provider,{value:Ne},$.createElement(P6,{fieldId:q,errors:T,warnings:i,help:U,helpStatus:a,className:`${ue}-explain-connected`,onVisibleChanged:se})):null,Fe={};q&&(Fe.id=`${q}_extra`);const Je=N?$.createElement("div",Object.assign({},Fe,{className:`${ue}-extra`,ref:ve}),N):null,Ct=Xe||Je?$.createElement("div",{className:`${ue}-additional`,style:X?{minHeight:X+Te}:{}},Xe,Je):null,ft=L&&L.mark==="pro_table_render"&&L.render?L.render(e,{input:Ee,errorList:Xe,extra:Je}):$.createElement($.Fragment,null,Ee,Ct);return $.createElement(Mc.Provider,{value:ae},$.createElement(E6,Object.assign({},re,{className:ee}),ft),$.createElement(VW,{prefixCls:r}))},WW=HW;var qW={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"};const ZW=qW;var XW=function(r,a){return $.createElement(kp,Po({},r,{ref:a,icon:ZW}))},YW=$.forwardRef(XW);const KW=YW;var JW=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};function QW(e){return e?typeof e=="object"&&!$.isValidElement(e)?e:{title:e}:null}const eq=e=>{let{prefixCls:r,label:a,htmlFor:c,labelCol:d,labelAlign:x,colon:T,required:i,requiredMark:L,tooltip:N,vertical:U}=e;var q;const[X]=XN("Form"),{labelAlign:se,labelCol:ce,labelWrap:ue,colon:fe}=$.useContext(Mc);if(!a)return null;const re=d||ce||{},ee=x||se,ae=`${r}-item-label`,ve=Mr(ae,ee==="left"&&`${ae}-left`,re.className,{[`${ae}-wrap`]:!!ue});let Te=a;const pe=T===!0||fe!==!1&&T!==!1;pe&&!U&&typeof a=="string"&&a.trim()&&(Te=a.replace(/[:|：]\s*$/,""));const Ne=QW(N);if(Ne){const{icon:Ct=$.createElement(KW,null)}=Ne,ft=JW(Ne,["icon"]),yt=$.createElement(wH,Object.assign({},ft),$.cloneElement(Ct,{className:`${r}-item-tooltip`,title:"",onClick:lt=>{lt.preventDefault()},tabIndex:null}));Te=$.createElement($.Fragment,null,Te,yt)}const Xe=L==="optional",Fe=typeof L=="function";Fe?Te=L(Te,{required:!!i}):Xe&&!i&&(Te=$.createElement($.Fragment,null,Te,$.createElement("span",{className:`${r}-item-optional`,title:""},(X==null?void 0:X.optional)||((q=rd.Form)===null||q===void 0?void 0:q.optional))));const Je=Mr({[`${r}-item-required`]:i,[`${r}-item-required-mark-optional`]:Xe||Fe,[`${r}-item-no-colon`]:!pe});return $.createElement(E6,Object.assign({},re,{className:ve}),$.createElement("label",{htmlFor:c,className:Je,title:typeof a=="string"?a:""},Te))},tq=eq,rq={success:NL,warning:$L,error:jL,validating:FE};function k6(e){let{children:r,errors:a,warnings:c,hasFeedback:d,validateStatus:x,prefixCls:T,meta:i,noStyle:L}=e;const N=`${T}-item`,{feedbackIcons:U}=$.useContext(Mc),q=R6(a,c,i,null,!!d,x),{isFormItemInput:X,status:se,hasFeedback:ce,feedbackIcon:ue}=$.useContext($u),fe=$.useMemo(()=>{var re;let ee;if(d){const ve=d!==!0&&d.icons||U,Te=q&&((re=ve==null?void 0:ve({status:q,errors:a,warnings:c}))===null||re===void 0?void 0:re[q]),pe=q&&rq[q];ee=Te!==!1&&pe?$.createElement("span",{className:Mr(`${N}-feedback-icon`,`${N}-feedback-icon-${q}`)},Te||$.createElement(pe,null)):null}const ae={status:q||"",errors:a,warnings:c,hasFeedback:!!d,feedbackIcon:ee,isFormItemInput:!0};return L&&(ae.status=(q??se)||"",ae.isFormItemInput=X,ae.hasFeedback=!!(d??ce),ae.feedbackIcon=d!==void 0?ae.feedbackIcon:ue),ae},[q,d,L,X,se]);return $.createElement($u.Provider,{value:fe},r)}var nq=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};function iq(e){const{prefixCls:r,className:a,rootClassName:c,style:d,help:x,errors:T,warnings:i,validateStatus:L,meta:N,hasFeedback:U,hidden:q,children:X,fieldId:se,required:ce,isRequired:ue,onSubItemMetaChange:fe,layout:re}=e,ee=nq(e,["prefixCls","className","rootClassName","style","help","errors","warnings","validateStatus","meta","hasFeedback","hidden","children","fieldId","required","isRequired","onSubItemMetaChange","layout"]),ae=`${r}-item`,{requiredMark:ve,vertical:Te}=$.useContext(Mc),pe=Te||re==="vertical",Ee=$.useRef(null),Ne=g1(T),Xe=g1(i),Fe=x!=null,Je=!!(Fe||T.length||i.length),Ct=!!Ee.current&&BE(Ee.current),[ft,yt]=$.useState(null);Mo(()=>{if(Je&&Ee.current){const tt=getComputedStyle(Ee.current);yt(parseInt(tt.marginBottom,10))}},[Je,Ct]);const lt=tt=>{tt||yt(null)},Ye=function(){let tt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const ht=tt?Ne:N.errors,vt=tt?Xe:N.warnings;return R6(ht,vt,N,"",!!U,L)}(),Ke=Mr(ae,a,c,{[`${ae}-with-help`]:Fe||Ne.length||Xe.length,[`${ae}-has-feedback`]:Ye&&U,[`${ae}-has-success`]:Ye==="success",[`${ae}-has-warning`]:Ye==="warning",[`${ae}-has-error`]:Ye==="error",[`${ae}-is-validating`]:Ye==="validating",[`${ae}-hidden`]:q,[`${ae}-${re}`]:re});return $.createElement("div",{className:Ke,style:d,ref:Ee},$.createElement(uW,Object.assign({className:`${ae}-row`},ud(ee,["_internalItemRender","colon","dependencies","extra","fieldKey","getValueFromEvent","getValueProps","htmlFor","id","initialValue","isListField","label","labelAlign","labelCol","labelWrap","messageVariables","name","normalize","noStyle","preserve","requiredMark","rules","shouldUpdate","trigger","tooltip","validateFirst","validateTrigger","valuePropName","wrapperCol","validateDebounce"])),$.createElement(tq,Object.assign({htmlFor:se},e,{requiredMark:ve,required:ce??ue,prefixCls:r,vertical:pe})),$.createElement(WW,Object.assign({},e,N,{errors:Ne,warnings:Xe,prefixCls:r,status:Ye,help:x,marginBottom:ft,onErrorVisibleChanged:lt}),$.createElement(s6.Provider,{value:fe},$.createElement(k6,{prefixCls:r,meta:N,errors:N.errors,warnings:N.warnings,hasFeedback:U,validateStatus:Ye},X)))),!!ft&&$.createElement("div",{className:`${ae}-margin-offset`,style:{marginBottom:-ft}}))}const oq="__SPLIT__";function aq(e,r){const a=Object.keys(e),c=Object.keys(r);return a.length===c.length&&a.every(d=>{const x=e[d],T=r[d];return x===T||typeof x=="function"||typeof T=="function"})}const sq=$.memo(e=>{let{children:r}=e;return r},(e,r)=>aq(e.control,r.control)&&e.update===r.update&&e.childProps.length===r.childProps.length&&e.childProps.every((a,c)=>a===r.childProps[c]));function CP(){return{errors:[],warnings:[],touched:!1,validating:!1,name:[],validated:!1}}function lq(e){const{name:r,noStyle:a,className:c,dependencies:d,prefixCls:x,shouldUpdate:T,rules:i,children:L,required:N,label:U,messageVariables:q,trigger:X="onChange",validateTrigger:se,hidden:ce,help:ue,layout:fe}=e,{getPrefixCls:re}=$.useContext(Yn),{name:ee}=$.useContext(Mc),ae=FW(L),ve=typeof ae=="function",Te=$.useContext(s6),{validateTrigger:pe}=$.useContext(id),Ee=se!==void 0?se:pe,Ne=r!=null,Xe=re("form",x),Fe=hd(Xe),[Je,Ct,ft]=eT(Xe,Fe);IE();const yt=$.useContext(S_),lt=$.useRef(),[ct,Ye]=NW({}),[Ke,tt]=Ep(()=>CP()),ht=Qt=>{const qr=yt==null?void 0:yt.getKey(Qt.name);if(tt(Qt.destroy?CP():Qt,!0),a&&ue!==!1&&Te){let yr=Qt.name;if(Qt.destroy)yr=lt.current||yr;else if(qr!==void 0){const[Ae,Lr]=qr;yr=[Ae].concat(zr(Lr)),lt.current=yr}Te(Qt,yr)}},vt=(Qt,qr)=>{Ye(yr=>{const Ae=Object.assign({},yr),$r=[].concat(zr(Qt.name.slice(0,-1)),zr(qr)).join(oq);return Qt.destroy?delete Ae[$r]:Ae[$r]=Qt,Ae})},[At,Pt]=$.useMemo(()=>{const Qt=zr(Ke.errors),qr=zr(Ke.warnings);return Object.values(ct).forEach(yr=>{Qt.push.apply(Qt,zr(yr.errors||[])),qr.push.apply(qr,zr(yr.warnings||[]))}),[Qt,qr]},[ct,Ke.errors,Ke.warnings]),qt=jW();function or(Qt,qr,yr){return a&&!ce?$.createElement(k6,{prefixCls:Xe,hasFeedback:e.hasFeedback,validateStatus:e.validateStatus,meta:Ke,errors:At,warnings:Pt,noStyle:!0},Qt):$.createElement(iq,Object.assign({key:"row"},e,{className:Mr(c,ft,Fe,Ct),prefixCls:Xe,fieldId:qr,isRequired:yr,errors:At,warnings:Pt,meta:Ke,onSubItemMetaChange:vt,layout:fe}),Qt)}if(!Ne&&!ve&&!d)return Je(or(ae));let cr={};return typeof U=="string"?cr.label=U:r&&(cr.label=String(r)),q&&(cr=Object.assign(Object.assign({},cr),q)),Je($.createElement(XE,Object.assign({},e,{messageVariables:cr,trigger:X,validateTrigger:Ee,onMetaChange:ht}),(Qt,qr,yr)=>{const Ae=Zg(r).length&&qr?qr.name:[],Lr=A6(Ae,ee),$r=N!==void 0?N:!!(i!=null&&i.some(Pr=>{if(Pr&&typeof Pr=="object"&&Pr.required&&!Pr.warningOnly)return!0;if(typeof Pr=="function"){const Ur=Pr(yr);return(Ur==null?void 0:Ur.required)&&!(Ur!=null&&Ur.warningOnly)}return!1})),pn=Object.assign({},Qt);let wt=null;if(Array.isArray(ae)&&Ne)wt=ae;else if(!(ve&&(!(T||d)||Ne))){if(!(d&&!ve&&!Ne))if($.isValidElement(ae)){const Pr=Object.assign(Object.assign({},ae.props),pn);if(Pr.id||(Pr.id=Lr),ue||At.length>0||Pt.length>0||e.extra){const ar=[];(ue||At.length>0)&&ar.push(`${Lr}_help`),e.extra&&ar.push(`${Lr}_extra`),Pr["aria-describedby"]=ar.join(" ")}At.length>0&&(Pr["aria-invalid"]="true"),$r&&(Pr["aria-required"]="true"),Ap(ae)&&(Pr.ref=qt(Ae,ae)),new Set([].concat(zr(Zg(X)),zr(Zg(Ee)))).forEach(ar=>{Pr[ar]=function(){for(var tn,Ln,Xr,hn,fr,Jt=arguments.length,bn=new Array(Jt),gn=0;gn<Jt;gn++)bn[gn]=arguments[gn];(Xr=pn[ar])===null||Xr===void 0||(tn=Xr).call.apply(tn,[pn].concat(bn)),(fr=(hn=ae.props)[ar])===null||fr===void 0||(Ln=fr).call.apply(Ln,[hn].concat(bn))}});const Un=[Pr["aria-required"],Pr["aria-invalid"],Pr["aria-describedby"]];wt=$.createElement(sq,{control:pn,update:ae,childProps:Un},j_(ae,Pr))}else ve&&(T||d)&&!Ne?wt=ae(yr):wt=ae}return or(wt,Lr,$r)}))}const D6=lq;D6.useStatus=BW;const cq=D6;var uq=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};const hq=e=>{var{prefixCls:r,children:a}=e,c=uq(e,["prefixCls","children"]);const{getPrefixCls:d}=$.useContext(Yn),x=d("form",r),T=$.useMemo(()=>({prefixCls:x,status:"error"}),[x]);return $.createElement(n6,Object.assign({},c),(i,L,N)=>$.createElement(KE.Provider,{value:T},a(i.map(U=>Object.assign(Object.assign({},U),{fieldKey:U.key})),L,{errors:N.errors,warnings:N.warnings})))},dq=hq;function fq(){const{form:e}=$.useContext(Mc);return e}const Pc=OW;Pc.Item=cq;Pc.List=dq;Pc.ErrorList=P6;Pc.useForm=z6;Pc.useFormInstance=fq;Pc.useWatch=a6;Pc.Provider=l6;Pc.create=()=>{};const To=Pc,_1=100,O6=_1/5,F6=_1/2-O6/2,w2=F6*2*Math.PI,MP=50,IP=e=>{const{dotClassName:r,style:a,hasCircleCls:c}=e;return $.createElement("circle",{className:Mr(`${r}-circle`,{[`${r}-circle-bg`]:c}),r:F6,cx:MP,cy:MP,strokeWidth:O6,style:a})},pq=e=>{let{percent:r,prefixCls:a}=e;const c=`${a}-dot`,d=`${c}-holder`,x=`${d}-hidden`,[T,i]=$.useState(!1);Mo(()=>{r!==0&&i(!0)},[r!==0]);const L=Math.max(Math.min(r,100),0);if(!T)return null;const N={strokeDashoffset:`${w2/4}`,strokeDasharray:`${w2*L/100} ${w2*(100-L)/100}`};return $.createElement("span",{className:Mr(d,`${c}-progress`,L<=0&&x)},$.createElement("svg",{viewBox:`0 0 ${_1} ${_1}`,role:"progressbar","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":L},$.createElement(IP,{dotClassName:c,hasCircleCls:!0}),$.createElement(IP,{dotClassName:c,style:N})))},mq=pq;function gq(e){const{prefixCls:r,percent:a=0}=e,c=`${r}-dot`,d=`${c}-holder`,x=`${d}-hidden`;return $.createElement($.Fragment,null,$.createElement("span",{className:Mr(d,a>0&&x)},$.createElement("span",{className:Mr(c,`${r}-dot-spin`)},[1,2,3,4].map(T=>$.createElement("i",{className:`${r}-dot-item`,key:T})))),$.createElement(mq,{prefixCls:r,percent:a}))}function _q(e){const{prefixCls:r,indicator:a,percent:c}=e,d=`${r}-dot`;return a&&$.isValidElement(a)?j_(a,{className:Mr(a.props.className,d),percent:c}):$.createElement(gq,{prefixCls:r,percent:c})}const yq=new _a("antSpinMove",{to:{opacity:1}}),vq=new _a("antRotate",{to:{transform:"rotate(405deg)"}}),xq=e=>{const{componentCls:r,calc:a}=e;return{[r]:Object.assign(Object.assign({},hl(e)),{position:"absolute",display:"none",color:e.colorPrimary,fontSize:0,textAlign:"center",verticalAlign:"middle",opacity:0,transition:`transform ${e.motionDurationSlow} ${e.motionEaseInOutCirc}`,"&-spinning":{position:"relative",display:"inline-block",opacity:1},[`${r}-text`]:{fontSize:e.fontSize,paddingTop:a(a(e.dotSize).sub(e.fontSize)).div(2).add(2).equal()},"&-fullscreen":{position:"fixed",width:"100vw",height:"100vh",backgroundColor:e.colorBgMask,zIndex:e.zIndexPopupBase,inset:0,display:"flex",alignItems:"center",flexDirection:"column",justifyContent:"center",opacity:0,visibility:"hidden",transition:`all ${e.motionDurationMid}`,"&-show":{opacity:1,visibility:"visible"},[r]:{[`${r}-dot-holder`]:{color:e.colorWhite},[`${r}-text`]:{color:e.colorTextLightSolid}}},"&-nested-loading":{position:"relative",[`> div > ${r}`]:{position:"absolute",top:0,insetInlineStart:0,zIndex:4,display:"block",width:"100%",height:"100%",maxHeight:e.contentHeight,[`${r}-dot`]:{position:"absolute",top:"50%",insetInlineStart:"50%",margin:a(e.dotSize).mul(-1).div(2).equal()},[`${r}-text`]:{position:"absolute",top:"50%",width:"100%",textShadow:`0 1px 2px ${e.colorBgContainer}`},[`&${r}-show-text ${r}-dot`]:{marginTop:a(e.dotSize).div(2).mul(-1).sub(10).equal()},"&-sm":{[`${r}-dot`]:{margin:a(e.dotSizeSM).mul(-1).div(2).equal()},[`${r}-text`]:{paddingTop:a(a(e.dotSizeSM).sub(e.fontSize)).div(2).add(2).equal()},[`&${r}-show-text ${r}-dot`]:{marginTop:a(e.dotSizeSM).div(2).mul(-1).sub(10).equal()}},"&-lg":{[`${r}-dot`]:{margin:a(e.dotSizeLG).mul(-1).div(2).equal()},[`${r}-text`]:{paddingTop:a(a(e.dotSizeLG).sub(e.fontSize)).div(2).add(2).equal()},[`&${r}-show-text ${r}-dot`]:{marginTop:a(e.dotSizeLG).div(2).mul(-1).sub(10).equal()}}},[`${r}-container`]:{position:"relative",transition:`opacity ${e.motionDurationSlow}`,"&::after":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:10,width:"100%",height:"100%",background:e.colorBgContainer,opacity:0,transition:`all ${e.motionDurationSlow}`,content:'""',pointerEvents:"none"}},[`${r}-blur`]:{clear:"both",opacity:.5,userSelect:"none",pointerEvents:"none","&::after":{opacity:.4,pointerEvents:"auto"}}},"&-tip":{color:e.spinDotDefault},[`${r}-dot-holder`]:{width:"1em",height:"1em",fontSize:e.dotSize,display:"inline-block",transition:`transform ${e.motionDurationSlow} ease, opacity ${e.motionDurationSlow} ease`,transformOrigin:"50% 50%",lineHeight:1,color:e.colorPrimary,"&-hidden":{transform:"scale(0.3)",opacity:0}},[`${r}-dot-progress`]:{position:"absolute",top:"50%",transform:"translate(-50%, -50%)",insetInlineStart:"50%"},[`${r}-dot`]:{position:"relative",display:"inline-block",fontSize:e.dotSize,width:"1em",height:"1em","&-item":{position:"absolute",display:"block",width:a(e.dotSize).sub(a(e.marginXXS).div(2)).div(2).equal(),height:a(e.dotSize).sub(a(e.marginXXS).div(2)).div(2).equal(),background:"currentColor",borderRadius:"100%",transform:"scale(0.75)",transformOrigin:"50% 50%",opacity:.3,animationName:yq,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDirection:"alternate","&:nth-child(1)":{top:0,insetInlineStart:0,animationDelay:"0s"},"&:nth-child(2)":{top:0,insetInlineEnd:0,animationDelay:"0.4s"},"&:nth-child(3)":{insetInlineEnd:0,bottom:0,animationDelay:"0.8s"},"&:nth-child(4)":{bottom:0,insetInlineStart:0,animationDelay:"1.2s"}},"&-spin":{transform:"rotate(45deg)",animationName:vq,animationDuration:"1.2s",animationIterationCount:"infinite",animationTimingFunction:"linear"},"&-circle":{strokeLinecap:"round",transition:["stroke-dashoffset","stroke-dasharray","stroke","stroke-width","opacity"].map(c=>`${c} ${e.motionDurationSlow} ease`).join(","),fillOpacity:0,stroke:"currentcolor"},"&-circle-bg":{stroke:e.colorFillSecondary}},[`&-sm ${r}-dot`]:{"&, &-holder":{fontSize:e.dotSizeSM}},[`&-sm ${r}-dot-holder`]:{i:{width:a(a(e.dotSizeSM).sub(a(e.marginXXS).div(2))).div(2).equal(),height:a(a(e.dotSizeSM).sub(a(e.marginXXS).div(2))).div(2).equal()}},[`&-lg ${r}-dot`]:{"&, &-holder":{fontSize:e.dotSizeLG}},[`&-lg ${r}-dot-holder`]:{i:{width:a(a(e.dotSizeLG).sub(e.marginXXS)).div(2).equal(),height:a(a(e.dotSizeLG).sub(e.marginXXS)).div(2).equal()}},[`&${r}-show-text ${r}-text`]:{display:"block"}})}},bq=e=>{const{controlHeightLG:r,controlHeight:a}=e;return{contentHeight:400,dotSize:r/2,dotSizeSM:r*.35,dotSizeLG:a}},wq=Ms("Spin",e=>{const r=Wo(e,{spinDotDefault:e.colorTextDescription});return[xq(r)]},bq),Sq=200,PP=[[30,.05],[70,.03],[96,.01]];function Eq(e,r){const[a,c]=$.useState(0),d=$.useRef(),x=r==="auto";return $.useEffect(()=>(x&&e&&(c(0),d.current=setInterval(()=>{c(T=>{const i=100-T;for(let L=0;L<PP.length;L+=1){const[N,U]=PP[L];if(T<=N)return T+i*U}return T})},Sq)),()=>{clearInterval(d.current)}),[x,e]),x?a:r}var Tq=globalThis&&globalThis.__rest||function(e,r){var a={};for(var c in e)Object.prototype.hasOwnProperty.call(e,c)&&r.indexOf(c)<0&&(a[c]=e[c]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var d=0,c=Object.getOwnPropertySymbols(e);d<c.length;d++)r.indexOf(c[d])<0&&Object.prototype.propertyIsEnumerable.call(e,c[d])&&(a[c[d]]=e[c[d]]);return a};let B6;function Cq(e,r){return!!e&&!!r&&!isNaN(Number(r))}const N6=e=>{var r;const{prefixCls:a,spinning:c=!0,delay:d=0,className:x,rootClassName:T,size:i="default",tip:L,wrapperClassName:N,style:U,children:q,fullscreen:X=!1,indicator:se,percent:ce}=e,ue=Tq(e,["prefixCls","spinning","delay","className","rootClassName","size","tip","wrapperClassName","style","children","fullscreen","indicator","percent"]),{getPrefixCls:fe,direction:re,spin:ee}=$.useContext(Yn),ae=fe("spin",a),[ve,Te,pe]=wq(ae),[Ee,Ne]=$.useState(()=>c&&!Cq(c,d)),Xe=Eq(Ee,ce);$.useEffect(()=>{if(c){const ct=NH(d,()=>{Ne(!0)});return ct(),()=>{var Ye;(Ye=ct==null?void 0:ct.cancel)===null||Ye===void 0||Ye.call(ct)}}Ne(!1)},[d,c]);const Fe=$.useMemo(()=>typeof q<"u"&&!X,[q,X]),Je=Mr(ae,ee==null?void 0:ee.className,{[`${ae}-sm`]:i==="small",[`${ae}-lg`]:i==="large",[`${ae}-spinning`]:Ee,[`${ae}-show-text`]:!!L,[`${ae}-rtl`]:re==="rtl"},x,!X&&T,Te,pe),Ct=Mr(`${ae}-container`,{[`${ae}-blur`]:Ee}),ft=(r=se??(ee==null?void 0:ee.indicator))!==null&&r!==void 0?r:B6,yt=Object.assign(Object.assign({},ee==null?void 0:ee.style),U),lt=$.createElement("div",Object.assign({},ue,{style:yt,className:Je,"aria-live":"polite","aria-busy":Ee}),$.createElement(_q,{prefixCls:ae,indicator:ft,percent:Xe}),L&&(Fe||X)?$.createElement("div",{className:`${ae}-text`},L):null);return ve(Fe?$.createElement("div",Object.assign({},ue,{className:Mr(`${ae}-nested-loading`,N,Te,pe)}),Ee&&$.createElement("div",{key:"loading"},lt),$.createElement("div",{className:Ct,key:"container"},q)):X?$.createElement("div",{className:Mr(`${ae}-fullscreen`,{[`${ae}-fullscreen-show`]:Ee},T,Te,pe)},lt):lt)};N6.setDefaultIndicator=e=>{B6=e};const Mq=N6;var Iq={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M955.7 856l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zM480 416c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v184c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V416zm32 352a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"warning",theme:"filled"};const Pq=Iq;var Aq=function(r,a){return $.createElement(kp,Po({},r,{ref:a,icon:Pq}))},Rq=$.forwardRef(Aq);const zq=Rq,Lq=()=>$.createElement("svg",{width:"252",height:"294"},$.createElement("title",null,"No Found"),$.createElement("defs",null,$.createElement("path",{d:"M0 .387h251.772v251.772H0z"})),$.createElement("g",{fill:"none",fillRule:"evenodd"},$.createElement("g",{transform:"translate(0 .012)"},$.createElement("mask",{fill:"#fff"}),$.createElement("path",{d:"M0 127.32v-2.095C0 56.279 55.892.387 124.838.387h2.096c68.946 0 124.838 55.892 124.838 124.838v2.096c0 68.946-55.892 124.838-124.838 124.838h-2.096C55.892 252.16 0 196.267 0 127.321",fill:"#E4EBF7",mask:"url(#b)"})),$.createElement("path",{d:"M39.755 130.84a8.276 8.276 0 1 1-16.468-1.66 8.276 8.276 0 0 1 16.468 1.66",fill:"#FFF"}),$.createElement("path",{d:"M36.975 134.297l10.482 5.943M48.373 146.508l-12.648 10.788",stroke:"#FFF",strokeWidth:"2"}),$.createElement("path",{d:"M39.875 159.352a5.667 5.667 0 1 1-11.277-1.136 5.667 5.667 0 0 1 11.277 1.136M57.588 143.247a5.708 5.708 0 1 1-11.358-1.145 5.708 5.708 0 0 1 11.358 1.145M99.018 26.875l29.82-.014a4.587 4.587 0 1 0-.003-9.175l-29.82.013a4.587 4.587 0 1 0 .003 9.176M110.424 45.211l29.82-.013a4.588 4.588 0 0 0-.004-9.175l-29.82.013a4.587 4.587 0 1 0 .004 9.175",fill:"#FFF"}),$.createElement("path",{d:"M112.798 26.861v-.002l15.784-.006a4.588 4.588 0 1 0 .003 9.175l-15.783.007v-.002a4.586 4.586 0 0 0-.004-9.172M184.523 135.668c-.553 5.485-5.447 9.483-10.931 8.93-5.485-.553-9.483-5.448-8.93-10.932.552-5.485 5.447-9.483 10.932-8.93 5.485.553 9.483 5.447 8.93 10.932",fill:"#FFF"}),$.createElement("path",{d:"M179.26 141.75l12.64 7.167M193.006 156.477l-15.255 13.011",stroke:"#FFF",strokeWidth:"2"}),$.createElement("path",{d:"M184.668 170.057a6.835 6.835 0 1 1-13.6-1.372 6.835 6.835 0 0 1 13.6 1.372M203.34 153.325a6.885 6.885 0 1 1-13.7-1.382 6.885 6.885 0 0 1 13.7 1.382",fill:"#FFF"}),$.createElement("path",{d:"M151.931 192.324a2.222 2.222 0 1 1-4.444 0 2.222 2.222 0 0 1 4.444 0zM225.27 116.056a2.222 2.222 0 1 1-4.445 0 2.222 2.222 0 0 1 4.444 0zM216.38 151.08a2.223 2.223 0 1 1-4.446-.001 2.223 2.223 0 0 1 4.446 0zM176.917 107.636a2.223 2.223 0 1 1-4.445 0 2.223 2.223 0 0 1 4.445 0zM195.291 92.165a2.223 2.223 0 1 1-4.445 0 2.223 2.223 0 0 1 4.445 0zM202.058 180.711a2.223 2.223 0 1 1-4.446 0 2.223 2.223 0 0 1 4.446 0z",stroke:"#FFF",strokeWidth:"2"}),$.createElement("path",{stroke:"#FFF",strokeWidth:"2",d:"M214.404 153.302l-1.912 20.184-10.928 5.99M173.661 174.792l-6.356 9.814h-11.36l-4.508 6.484M174.941 125.168v-15.804M220.824 117.25l-12.84 7.901-15.31-7.902V94.39"}),$.createElement("path",{d:"M166.588 65.936h-3.951a4.756 4.756 0 0 1-4.743-4.742 4.756 4.756 0 0 1 4.743-4.743h3.951a4.756 4.756 0 0 1 4.743 4.743 4.756 4.756 0 0 1-4.743 4.742",fill:"#FFF"}),$.createElement("path",{d:"M174.823 30.03c0-16.281 13.198-29.48 29.48-29.48 16.28 0 29.48 13.199 29.48 29.48 0 16.28-13.2 29.48-29.48 29.48-16.282 0-29.48-13.2-29.48-29.48",fill:"#1677ff"}),$.createElement("path",{d:"M205.952 38.387c.5.5.785 1.142.785 1.928s-.286 1.465-.785 1.964c-.572.5-1.214.75-2 .75-.785 0-1.429-.285-1.929-.785-.572-.5-.82-1.143-.82-1.929s.248-1.428.82-1.928c.5-.5 1.144-.75 1.93-.75.785 0 1.462.25 1.999.75m4.285-19.463c1.428 1.249 2.143 2.963 2.143 5.142 0 1.712-.427 3.13-1.219 4.25-.067.096-.137.18-.218.265-.416.429-1.41 1.346-2.956 2.699a5.07 5.07 0 0 0-1.428 1.75 5.207 5.207 0 0 0-.536 2.357v.5h-4.107v-.5c0-1.357.215-2.536.714-3.5.464-.964 1.857-2.464 4.178-4.536l.43-.5c.643-.785.964-1.643.964-2.535 0-1.18-.358-2.108-1-2.785-.678-.68-1.643-1.001-2.858-1.001-1.536 0-2.642.464-3.357 1.43-.37.5-.621 1.135-.76 1.904a1.999 1.999 0 0 1-1.971 1.63h-.004c-1.277 0-2.257-1.183-1.98-2.43.337-1.518 1.02-2.78 2.073-3.784 1.536-1.5 3.607-2.25 6.25-2.25 2.32 0 4.214.607 5.642 1.894",fill:"#FFF"}),$.createElement("path",{d:"M52.04 76.131s21.81 5.36 27.307 15.945c5.575 10.74-6.352 9.26-15.73 4.935-10.86-5.008-24.7-11.822-11.577-20.88",fill:"#FFB594"}),$.createElement("path",{d:"M90.483 67.504l-.449 2.893c-.753.49-4.748-2.663-4.748-2.663l-1.645.748-1.346-5.684s6.815-4.589 8.917-5.018c2.452-.501 9.884.94 10.7 2.278 0 0 1.32.486-2.227.69-3.548.203-5.043.447-6.79 3.132-1.747 2.686-2.412 3.624-2.412 3.624",fill:"#FFC6A0"}),$.createElement("path",{d:"M128.055 111.367c-2.627-7.724-6.15-13.18-8.917-15.478-3.5-2.906-9.34-2.225-11.366-4.187-1.27-1.231-3.215-1.197-3.215-1.197s-14.98-3.158-16.828-3.479c-2.37-.41-2.124-.714-6.054-1.405-1.57-1.907-2.917-1.122-2.917-1.122l-7.11-1.383c-.853-1.472-2.423-1.023-2.423-1.023l-2.468-.897c-1.645 9.976-7.74 13.796-7.74 13.796 1.795 1.122 15.703 8.3 15.703 8.3l5.107 37.11s-3.321 5.694 1.346 9.109c0 0 19.883-3.743 34.921-.329 0 0 3.047-2.546.972-8.806.523-3.01 1.394-8.263 1.736-11.622.385.772 2.019 1.918 3.14 3.477 0 0 9.407-7.365 11.052-14.012-.832-.723-1.598-1.585-2.267-2.453-.567-.736-.358-2.056-.765-2.717-.669-1.084-1.804-1.378-1.907-1.682",fill:"#FFF"}),$.createElement("path",{d:"M101.09 289.998s4.295 2.041 7.354 1.021c2.821-.94 4.53.668 7.08 1.178 2.55.51 6.874 1.1 11.686-1.26-.103-5.51-6.889-3.98-11.96-6.713-2.563-1.38-3.784-4.722-3.598-8.799h-9.402s-1.392 10.52-1.16 14.573",fill:"#CBD1D1"}),$.createElement("path",{d:"M101.067 289.826s2.428 1.271 6.759.653c3.058-.437 3.712.481 7.423 1.031 3.712.55 10.724-.069 11.823-.894.413 1.1-.343 2.063-.343 2.063s-1.512.603-4.812.824c-2.03.136-5.8.291-7.607-.503-1.787-1.375-5.247-1.903-5.728-.241-3.918.95-7.355-.286-7.355-.286l-.16-2.647z",fill:"#2B0849"}),$.createElement("path",{d:"M108.341 276.044h3.094s-.103 6.702 4.536 8.558c-4.64.618-8.558-2.303-7.63-8.558",fill:"#A4AABA"}),$.createElement("path",{d:"M57.542 272.401s-2.107 7.416-4.485 12.306c-1.798 3.695-4.225 7.492 5.465 7.492 6.648 0 8.953-.48 7.423-6.599-1.53-6.12.266-13.199.266-13.199h-8.669z",fill:"#CBD1D1"}),$.createElement("path",{d:"M51.476 289.793s2.097 1.169 6.633 1.169c6.083 0 8.249-1.65 8.249-1.65s.602 1.114-.619 2.165c-.993.855-3.597 1.591-7.39 1.546-4.145-.048-5.832-.566-6.736-1.168-.825-.55-.687-1.58-.137-2.062",fill:"#2B0849"}),$.createElement("path",{d:"M58.419 274.304s.033 1.519-.314 2.93c-.349 1.42-1.078 3.104-1.13 4.139-.058 1.151 4.537 1.58 5.155.034.62-1.547 1.294-6.427 1.913-7.252.619-.825-4.903-2.119-5.624.15",fill:"#A4AABA"}),$.createElement("path",{d:"M99.66 278.514l13.378.092s1.298-54.52 1.853-64.403c.554-9.882 3.776-43.364 1.002-63.128l-12.547-.644-22.849.78s-.434 3.966-1.195 9.976c-.063.496-.682.843-.749 1.365-.075.585.423 1.354.32 1.966-2.364 14.08-6.377 33.104-8.744 46.677-.116.666-1.234 1.009-1.458 2.691-.04.302.211 1.525.112 1.795-6.873 18.744-10.949 47.842-14.277 61.885l14.607-.014s2.197-8.57 4.03-16.97c2.811-12.886 23.111-85.01 23.111-85.01l3.016-.521 1.043 46.35s-.224 1.234.337 2.02c.56.785-.56 1.123-.392 2.244l.392 1.794s-.449 7.178-.898 11.89c-.448 4.71-.092 39.165-.092 39.165",fill:"#7BB2F9"}),$.createElement("path",{d:"M76.085 221.626c1.153.094 4.038-2.019 6.955-4.935M106.36 225.142s2.774-1.11 6.103-3.883",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M107.275 222.1s2.773-1.11 6.102-3.884",stroke:"#648BD8",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M74.74 224.767s2.622-.591 6.505-3.365M86.03 151.634c-.27 3.106.3 8.525-4.336 9.123M103.625 149.88s.11 14.012-1.293 15.065c-2.219 1.664-2.99 1.944-2.99 1.944M99.79 150.438s.035 12.88-1.196 24.377M93.673 175.911s7.212-1.664 9.431-1.664M74.31 205.861a212.013 212.013 0 0 1-.979 4.56s-1.458 1.832-1.009 3.776c.449 1.944-.947 2.045-4.985 15.355-1.696 5.59-4.49 18.591-6.348 27.597l-.231 1.12M75.689 197.807a320.934 320.934 0 0 1-.882 4.754M82.591 152.233L81.395 162.7s-1.097.15-.5 2.244c.113 1.346-2.674 15.775-5.18 30.43M56.12 274.418h13.31",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M116.241 148.22s-17.047-3.104-35.893.2c.158 2.514-.003 4.15-.003 4.15s14.687-2.818 35.67-.312c.252-2.355.226-4.038.226-4.038",fill:"#192064"}),$.createElement("path",{d:"M106.322 151.165l.003-4.911a.81.81 0 0 0-.778-.815c-2.44-.091-5.066-.108-7.836-.014a.818.818 0 0 0-.789.815l-.003 4.906a.81.81 0 0 0 .831.813c2.385-.06 4.973-.064 7.73.017a.815.815 0 0 0 .842-.81",fill:"#FFF"}),$.createElement("path",{d:"M105.207 150.233l.002-3.076a.642.642 0 0 0-.619-.646 94.321 94.321 0 0 0-5.866-.01.65.65 0 0 0-.63.647v3.072a.64.64 0 0 0 .654.644 121.12 121.12 0 0 1 5.794.011c.362.01.665-.28.665-.642",fill:"#192064"}),$.createElement("path",{d:"M100.263 275.415h12.338M101.436 270.53c.006 3.387.042 5.79.111 6.506M101.451 264.548a915.75 915.75 0 0 0-.015 4.337M100.986 174.965l.898 44.642s.673 1.57-.225 2.692c-.897 1.122 2.468.673.898 2.243-1.57 1.57.897 1.122 0 3.365-.596 1.489-.994 21.1-1.096 35.146",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M46.876 83.427s-.516 6.045 7.223 5.552c11.2-.712 9.218-9.345 31.54-21.655-.786-2.708-2.447-4.744-2.447-4.744s-11.068 3.11-22.584 8.046c-6.766 2.9-13.395 6.352-13.732 12.801M104.46 91.057l.941-5.372-8.884-11.43-5.037 5.372-1.74 7.834a.321.321 0 0 0 .108.32c.965.8 6.5 5.013 14.347 3.544a.332.332 0 0 0 .264-.268",fill:"#FFC6A0"}),$.createElement("path",{d:"M93.942 79.387s-4.533-2.853-2.432-6.855c1.623-3.09 4.513 1.133 4.513 1.133s.52-3.642 3.121-3.642c.52-1.04 1.561-4.162 1.561-4.162s11.445 2.601 13.526 3.121c0 5.203-2.304 19.424-7.84 19.861-8.892.703-12.449-9.456-12.449-9.456",fill:"#FFC6A0"}),$.createElement("path",{d:"M113.874 73.446c2.601-2.081 3.47-9.722 3.47-9.722s-2.479-.49-6.64-2.05c-4.683-2.081-12.798-4.747-17.48.976-9.668 3.223-2.05 19.823-2.05 19.823l2.713-3.021s-3.935-3.287-2.08-6.243c2.17-3.462 3.92 1.073 3.92 1.073s.637-2.387 3.581-3.342c.355-.71 1.036-2.674 1.432-3.85a1.073 1.073 0 0 1 1.263-.704c2.4.558 8.677 2.019 11.356 2.662.522.125.871.615.82 1.15l-.305 3.248z",fill:"#520038"}),$.createElement("path",{d:"M104.977 76.064c-.103.61-.582 1.038-1.07.956-.489-.083-.801-.644-.698-1.254.103-.61.582-1.038 1.07-.956.488.082.8.644.698 1.254M112.132 77.694c-.103.61-.582 1.038-1.07.956-.488-.083-.8-.644-.698-1.254.103-.61.582-1.038 1.07-.956.488.082.8.643.698 1.254",fill:"#552950"}),$.createElement("path",{stroke:"#DB836E",strokeWidth:"1.118",strokeLinecap:"round",strokeLinejoin:"round",d:"M110.13 74.84l-.896 1.61-.298 4.357h-2.228"}),$.createElement("path",{d:"M110.846 74.481s1.79-.716 2.506.537",stroke:"#5C2552",strokeWidth:"1.118",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M92.386 74.282s.477-1.114 1.113-.716c.637.398 1.274 1.433.558 1.99-.717.556.159 1.67.159 1.67",stroke:"#DB836E",strokeWidth:"1.118",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M103.287 72.93s1.83 1.113 4.137.954",stroke:"#5C2552",strokeWidth:"1.118",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M103.685 81.762s2.227 1.193 4.376 1.193M104.64 84.308s.954.398 1.511.318M94.693 81.205s2.308 7.4 10.424 7.639",stroke:"#DB836E",strokeWidth:"1.118",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M81.45 89.384s.45 5.647-4.935 12.787M69 82.654s-.726 9.282-8.204 14.206",stroke:"#E4EBF7",strokeWidth:"1.101",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M129.405 122.865s-5.272 7.403-9.422 10.768",stroke:"#E4EBF7",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M119.306 107.329s.452 4.366-2.127 32.062",stroke:"#E4EBF7",strokeWidth:"1.101",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M150.028 151.232h-49.837a1.01 1.01 0 0 1-1.01-1.01v-31.688c0-.557.452-1.01 1.01-1.01h49.837c.558 0 1.01.453 1.01 1.01v31.688a1.01 1.01 0 0 1-1.01 1.01",fill:"#F2D7AD"}),$.createElement("path",{d:"M150.29 151.232h-19.863v-33.707h20.784v32.786a.92.92 0 0 1-.92.92",fill:"#F4D19D"}),$.createElement("path",{d:"M123.554 127.896H92.917a.518.518 0 0 1-.425-.816l6.38-9.113c.193-.277.51-.442.85-.442h31.092l-7.26 10.371z",fill:"#F2D7AD"}),$.createElement("path",{fill:"#CC9B6E",d:"M123.689 128.447H99.25v-.519h24.169l7.183-10.26.424.298z"}),$.createElement("path",{d:"M158.298 127.896h-18.669a2.073 2.073 0 0 1-1.659-.83l-7.156-9.541h19.965c.49 0 .95.23 1.244.622l6.69 8.92a.519.519 0 0 1-.415.83",fill:"#F4D19D"}),$.createElement("path",{fill:"#CC9B6E",d:"M157.847 128.479h-19.384l-7.857-10.475.415-.31 7.7 10.266h19.126zM130.554 150.685l-.032-8.177.519-.002.032 8.177z"}),$.createElement("path",{fill:"#CC9B6E",d:"M130.511 139.783l-.08-21.414.519-.002.08 21.414zM111.876 140.932l-.498-.143 1.479-5.167.498.143zM108.437 141.06l-2.679-2.935 2.665-3.434.41.318-2.397 3.089 2.384 2.612zM116.607 141.06l-.383-.35 2.383-2.612-2.397-3.089.41-.318 2.665 3.434z"}),$.createElement("path",{d:"M154.316 131.892l-3.114-1.96.038 3.514-1.043.092c-1.682.115-3.634.23-4.789.23-1.902 0-2.693 2.258 2.23 2.648l-2.645-.596s-2.168 1.317.504 2.3c0 0-1.58 1.217.561 2.58-.584 3.504 5.247 4.058 7.122 3.59 1.876-.47 4.233-2.359 4.487-5.16.28-3.085-.89-5.432-3.35-7.238",fill:"#FFC6A0"}),$.createElement("path",{d:"M153.686 133.577s-6.522.47-8.36.372c-1.836-.098-1.904 2.19 2.359 2.264 3.739.15 5.451-.044 5.451-.044",stroke:"#DB836E",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M145.16 135.877c-1.85 1.346.561 2.355.561 2.355s3.478.898 6.73.617",stroke:"#DB836E",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M151.89 141.71s-6.28.111-6.73-2.132c-.223-1.346.45-1.402.45-1.402M146.114 140.868s-1.103 3.16 5.44 3.533M151.202 129.932v3.477M52.838 89.286c3.533-.337 8.423-1.248 13.582-7.754",stroke:"#DB836E",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M168.567 248.318a6.647 6.647 0 0 1-6.647-6.647v-66.466a6.647 6.647 0 1 1 13.294 0v66.466a6.647 6.647 0 0 1-6.647 6.647",fill:"#5BA02E"}),$.createElement("path",{d:"M176.543 247.653a6.647 6.647 0 0 1-6.646-6.647v-33.232a6.647 6.647 0 1 1 13.293 0v33.232a6.647 6.647 0 0 1-6.647 6.647",fill:"#92C110"}),$.createElement("path",{d:"M186.443 293.613H158.92a3.187 3.187 0 0 1-3.187-3.187v-46.134a3.187 3.187 0 0 1 3.187-3.187h27.524a3.187 3.187 0 0 1 3.187 3.187v46.134a3.187 3.187 0 0 1-3.187 3.187",fill:"#F2D7AD"}),$.createElement("path",{d:"M88.979 89.48s7.776 5.384 16.6 2.842",stroke:"#E4EBF7",strokeWidth:"1.101",strokeLinecap:"round",strokeLinejoin:"round"}))),kq=Lq,Dq=()=>$.createElement("svg",{width:"254",height:"294"},$.createElement("title",null,"Server Error"),$.createElement("defs",null,$.createElement("path",{d:"M0 .335h253.49v253.49H0z"}),$.createElement("path",{d:"M0 293.665h253.49V.401H0z"})),$.createElement("g",{fill:"none",fillRule:"evenodd"},$.createElement("g",{transform:"translate(0 .067)"},$.createElement("mask",{fill:"#fff"}),$.createElement("path",{d:"M0 128.134v-2.11C0 56.608 56.273.334 125.69.334h2.11c69.416 0 125.69 56.274 125.69 125.69v2.11c0 69.417-56.274 125.69-125.69 125.69h-2.11C56.273 253.824 0 197.551 0 128.134",fill:"#E4EBF7",mask:"url(#b)"})),$.createElement("path",{d:"M39.989 132.108a8.332 8.332 0 1 1-16.581-1.671 8.332 8.332 0 0 1 16.58 1.671",fill:"#FFF"}),$.createElement("path",{d:"M37.19 135.59l10.553 5.983M48.665 147.884l-12.734 10.861",stroke:"#FFF",strokeWidth:"2"}),$.createElement("path",{d:"M40.11 160.816a5.706 5.706 0 1 1-11.354-1.145 5.706 5.706 0 0 1 11.354 1.145M57.943 144.6a5.747 5.747 0 1 1-11.436-1.152 5.747 5.747 0 0 1 11.436 1.153M99.656 27.434l30.024-.013a4.619 4.619 0 1 0-.004-9.238l-30.024.013a4.62 4.62 0 0 0 .004 9.238M111.14 45.896l30.023-.013a4.62 4.62 0 1 0-.004-9.238l-30.024.013a4.619 4.619 0 1 0 .004 9.238",fill:"#FFF"}),$.createElement("path",{d:"M113.53 27.421v-.002l15.89-.007a4.619 4.619 0 1 0 .005 9.238l-15.892.007v-.002a4.618 4.618 0 0 0-.004-9.234M150.167 70.091h-3.979a4.789 4.789 0 0 1-4.774-4.775 4.788 4.788 0 0 1 4.774-4.774h3.979a4.789 4.789 0 0 1 4.775 4.774 4.789 4.789 0 0 1-4.775 4.775",fill:"#FFF"}),$.createElement("path",{d:"M171.687 30.234c0-16.392 13.289-29.68 29.681-29.68 16.392 0 29.68 13.288 29.68 29.68 0 16.393-13.288 29.681-29.68 29.681s-29.68-13.288-29.68-29.68",fill:"#FF603B"}),$.createElement("path",{d:"M203.557 19.435l-.676 15.035a1.514 1.514 0 0 1-3.026 0l-.675-15.035a2.19 2.19 0 1 1 4.377 0m-.264 19.378c.513.477.77 1.1.77 1.87s-.257 1.393-.77 1.907c-.55.476-1.21.733-1.943.733a2.545 2.545 0 0 1-1.87-.77c-.55-.514-.806-1.136-.806-1.87 0-.77.256-1.393.806-1.87.513-.513 1.137-.733 1.87-.733.77 0 1.43.22 1.943.733",fill:"#FFF"}),$.createElement("path",{d:"M119.3 133.275c4.426-.598 3.612-1.204 4.079-4.778.675-5.18-3.108-16.935-8.262-25.118-1.088-10.72-12.598-11.24-12.598-11.24s4.312 4.895 4.196 16.199c1.398 5.243.804 14.45.804 14.45s5.255 11.369 11.78 10.487",fill:"#FFB594"}),$.createElement("path",{d:"M100.944 91.61s1.463-.583 3.211.582c8.08 1.398 10.368 6.706 11.3 11.368 1.864 1.282 1.864 2.33 1.864 3.496.365.777 1.515 3.03 1.515 3.03s-7.225 1.748-10.954 6.758c-1.399-6.41-6.936-25.235-6.936-25.235",fill:"#FFF"}),$.createElement("path",{d:"M94.008 90.5l1.019-5.815-9.23-11.874-5.233 5.581-2.593 9.863s8.39 5.128 16.037 2.246",fill:"#FFB594"}),$.createElement("path",{d:"M82.931 78.216s-4.557-2.868-2.445-6.892c1.632-3.107 4.537 1.139 4.537 1.139s.524-3.662 3.139-3.662c.523-1.046 1.569-4.184 1.569-4.184s11.507 2.615 13.6 3.138c-.001 5.23-2.317 19.529-7.884 19.969-8.94.706-12.516-9.508-12.516-9.508",fill:"#FFC6A0"}),$.createElement("path",{d:"M102.971 72.243c2.616-2.093 3.489-9.775 3.489-9.775s-2.492-.492-6.676-2.062c-4.708-2.092-12.867-4.771-17.575.982-9.54 4.41-2.062 19.93-2.062 19.93l2.729-3.037s-3.956-3.304-2.092-6.277c2.183-3.48 3.943 1.08 3.943 1.08s.64-2.4 3.6-3.36c.356-.714 1.04-2.69 1.44-3.872a1.08 1.08 0 0 1 1.27-.707c2.41.56 8.723 2.03 11.417 2.676.524.126.876.619.825 1.156l-.308 3.266z",fill:"#520038"}),$.createElement("path",{d:"M101.22 76.514c-.104.613-.585 1.044-1.076.96-.49-.082-.805-.646-.702-1.26.104-.613.585-1.044 1.076-.961.491.083.805.647.702 1.26M94.26 75.074c-.104.613-.585 1.044-1.076.96-.49-.082-.805-.646-.702-1.26.104-.613.585-1.044 1.076-.96.491.082.805.646.702 1.26",fill:"#552950"}),$.createElement("path",{stroke:"#DB836E",strokeWidth:"1.063",strokeLinecap:"round",strokeLinejoin:"round",d:"M99.206 73.644l-.9 1.62-.3 4.38h-2.24"}),$.createElement("path",{d:"M99.926 73.284s1.8-.72 2.52.54",stroke:"#5C2552",strokeWidth:"1.117",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M81.367 73.084s.48-1.12 1.12-.72c.64.4 1.28 1.44.56 2s.16 1.68.16 1.68",stroke:"#DB836E",strokeWidth:"1.117",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M92.326 71.724s1.84 1.12 4.16.96",stroke:"#5C2552",strokeWidth:"1.117",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M92.726 80.604s2.24 1.2 4.4 1.2M93.686 83.164s.96.4 1.52.32M83.687 80.044s1.786 6.547 9.262 7.954",stroke:"#DB836E",strokeWidth:"1.063",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M95.548 91.663s-1.068 2.821-8.298 2.105c-7.23-.717-10.29-5.044-10.29-5.044",stroke:"#E4EBF7",strokeWidth:"1.136",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M78.126 87.478s6.526 4.972 16.47 2.486c0 0 9.577 1.02 11.536 5.322 5.36 11.77.543 36.835 0 39.962 3.496 4.055-.466 8.483-.466 8.483-15.624-3.548-35.81-.6-35.81-.6-4.849-3.546-1.223-9.044-1.223-9.044L62.38 110.32c-2.485-15.227.833-19.803 3.549-20.743 3.03-1.049 8.04-1.282 8.04-1.282.496-.058 1.08-.076 1.37-.233 2.36-1.282 2.787-.583 2.787-.583",fill:"#FFF"}),$.createElement("path",{d:"M65.828 89.81s-6.875.465-7.59 8.156c-.466 8.857 3.03 10.954 3.03 10.954s6.075 22.102 16.796 22.957c8.39-2.176 4.758-6.702 4.661-11.42-.233-11.304-7.108-16.897-7.108-16.897s-4.212-13.75-9.789-13.75",fill:"#FFC6A0"}),$.createElement("path",{d:"M71.716 124.225s.855 11.264 9.828 6.486c4.765-2.536 7.581-13.828 9.789-22.568 1.456-5.768 2.58-12.197 2.58-12.197l-4.973-1.709s-2.408 5.516-7.769 12.275c-4.335 5.467-9.144 11.11-9.455 17.713",fill:"#FFC6A0"}),$.createElement("path",{d:"M108.463 105.191s1.747 2.724-2.331 30.535c2.376 2.216 1.053 6.012-.233 7.51",stroke:"#E4EBF7",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M123.262 131.527s-.427 2.732-11.77 1.981c-15.187-1.006-25.326-3.25-25.326-3.25l.933-5.8s.723.215 9.71-.068c11.887-.373 18.714-6.07 24.964-1.022 4.039 3.263 1.489 8.16 1.489 8.16",fill:"#FFC6A0"}),$.createElement("path",{d:"M70.24 90.974s-5.593-4.739-11.054 2.68c-3.318 7.223.517 15.284 2.664 19.578-.31 3.729 2.33 4.311 2.33 4.311s.108.895 1.516 2.68c4.078-7.03 6.72-9.166 13.711-12.546-.328-.656-1.877-3.265-1.825-3.767.175-1.69-1.282-2.623-1.282-2.623s-.286-.156-1.165-2.738c-.788-2.313-2.036-5.177-4.895-7.575",fill:"#FFF"}),$.createElement("path",{d:"M90.232 288.027s4.855 2.308 8.313 1.155c3.188-1.063 5.12.755 8.002 1.331 2.881.577 7.769 1.243 13.207-1.424-.117-6.228-7.786-4.499-13.518-7.588-2.895-1.56-4.276-5.336-4.066-9.944H91.544s-1.573 11.89-1.312 16.47",fill:"#CBD1D1"}),$.createElement("path",{d:"M90.207 287.833s2.745 1.437 7.639.738c3.456-.494 3.223.66 7.418 1.282 4.195.621 13.092-.194 14.334-1.126.466 1.242-.388 2.33-.388 2.33s-1.709.682-5.438.932c-2.295.154-8.098.276-10.14-.621-2.02-1.554-4.894-1.515-6.06-.234-4.427 1.075-7.184-.31-7.184-.31l-.181-2.991z",fill:"#2B0849"}),$.createElement("path",{d:"M98.429 272.257h3.496s-.117 7.574 5.127 9.671c-5.244.7-9.672-2.602-8.623-9.671",fill:"#A4AABA"}),$.createElement("path",{d:"M44.425 272.046s-2.208 7.774-4.702 12.899c-1.884 3.874-4.428 7.854 5.729 7.854 6.97 0 9.385-.503 7.782-6.917-1.604-6.415.279-13.836.279-13.836h-9.088z",fill:"#CBD1D1"}),$.createElement("path",{d:"M38.066 290.277s2.198 1.225 6.954 1.225c6.376 0 8.646-1.73 8.646-1.73s.63 1.168-.649 2.27c-1.04.897-3.77 1.668-7.745 1.621-4.347-.05-6.115-.593-7.062-1.224-.864-.577-.72-1.657-.144-2.162",fill:"#2B0849"}),$.createElement("path",{d:"M45.344 274.041s.035 1.592-.329 3.07c-.365 1.49-1.13 3.255-1.184 4.34-.061 1.206 4.755 1.657 5.403.036.65-1.622 1.357-6.737 2.006-7.602.648-.865-5.14-2.222-5.896.156",fill:"#A4AABA"}),$.createElement("path",{d:"M89.476 277.57l13.899.095s1.349-56.643 1.925-66.909c.576-10.267 3.923-45.052 1.042-65.585l-13.037-.669-23.737.81s-.452 4.12-1.243 10.365c-.065.515-.708.874-.777 1.417-.078.608.439 1.407.332 2.044-2.455 14.627-5.797 32.736-8.256 46.837-.121.693-1.282 1.048-1.515 2.796-.042.314.22 1.584.116 1.865-7.14 19.473-12.202 52.601-15.66 67.19l15.176-.015s2.282-10.145 4.185-18.871c2.922-13.389 24.012-88.32 24.012-88.32l3.133-.954-.158 48.568s-.233 1.282.35 2.098c.583.815-.581 1.167-.408 2.331l.408 1.864s-.466 7.458-.932 12.352c-.467 4.895 1.145 40.69 1.145 40.69",fill:"#7BB2F9"}),$.createElement("path",{d:"M64.57 218.881c1.197.099 4.195-2.097 7.225-5.127M96.024 222.534s2.881-1.152 6.34-4.034",stroke:"#648BD8",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M96.973 219.373s2.882-1.153 6.34-4.034",stroke:"#648BD8",strokeWidth:"1.032",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M63.172 222.144s2.724-.614 6.759-3.496M74.903 146.166c-.281 3.226.31 8.856-4.506 9.478M93.182 144.344s.115 14.557-1.344 15.65c-2.305 1.73-3.107 2.02-3.107 2.02M89.197 144.923s.269 13.144-1.01 25.088M83.525 170.71s6.81-1.051 9.116-1.051M46.026 270.045l-.892 4.538M46.937 263.289l-.815 4.157M62.725 202.503c-.33 1.618-.102 1.904-.449 3.438 0 0-2.756 1.903-2.29 3.923.466 2.02-.31 3.424-4.505 17.252-1.762 5.807-4.233 18.922-6.165 28.278-.03.144-.521 2.646-1.14 5.8M64.158 194.136c-.295 1.658-.6 3.31-.917 4.938M71.33 146.787l-1.244 10.877s-1.14.155-.519 2.33c.117 1.399-2.778 16.39-5.382 31.615M44.242 273.727H58.07",stroke:"#648BD8",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M106.18 142.117c-3.028-.489-18.825-2.744-36.219.2a.625.625 0 0 0-.518.644c.063 1.307.044 2.343.015 2.995a.617.617 0 0 0 .716.636c3.303-.534 17.037-2.412 35.664-.266.347.04.66-.214.692-.56.124-1.347.16-2.425.17-3.029a.616.616 0 0 0-.52-.62",fill:"#192064"}),$.createElement("path",{d:"M96.398 145.264l.003-5.102a.843.843 0 0 0-.809-.847 114.104 114.104 0 0 0-8.141-.014.85.85 0 0 0-.82.847l-.003 5.097c0 .476.388.857.864.845 2.478-.064 5.166-.067 8.03.017a.848.848 0 0 0 .876-.843",fill:"#FFF"}),$.createElement("path",{d:"M95.239 144.296l.002-3.195a.667.667 0 0 0-.643-.672c-1.9-.061-3.941-.073-6.094-.01a.675.675 0 0 0-.654.672l-.002 3.192c0 .376.305.677.68.669 1.859-.042 3.874-.043 6.02.012.376.01.69-.291.691-.668",fill:"#192064"}),$.createElement("path",{d:"M90.102 273.522h12.819M91.216 269.761c.006 3.519-.072 5.55 0 6.292M90.923 263.474c-.009 1.599-.016 2.558-.016 4.505M90.44 170.404l.932 46.38s.7 1.631-.233 2.796c-.932 1.166 2.564.7.932 2.33-1.63 1.633.933 1.166 0 3.497-.618 1.546-1.031 21.921-1.138 36.513",stroke:"#648BD8",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M73.736 98.665l2.214 4.312s2.098.816 1.865 2.68l.816 2.214M64.297 116.611c.233-.932 2.176-7.147 12.585-10.488M77.598 90.042s7.691 6.137 16.547 2.72",stroke:"#E4EBF7",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M91.974 86.954s5.476-.816 7.574-4.545c1.297-.345.72 2.212-.33 3.671-.7.971-1.01 1.554-1.01 1.554s.194.31.155.816c-.053.697-.175.653-.272 1.048-.081.335.108.657 0 1.049-.046.17-.198.5-.382.878-.12.249-.072.687-.2.948-.231.469-1.562 1.87-2.622 2.855-3.826 3.554-5.018 1.644-6.001-.408-.894-1.865-.661-5.127-.874-6.875-.35-2.914-2.622-3.03-1.923-4.429.343-.685 2.87.69 3.263 1.748.757 2.04 2.952 1.807 2.622 1.69",fill:"#FFC6A0"}),$.createElement("path",{d:"M99.8 82.429c-.465.077-.35.272-.97 1.243-.622.971-4.817 2.932-6.39 3.224-2.589.48-2.278-1.56-4.254-2.855-1.69-1.107-3.562-.638-1.398 1.398.99.932.932 1.107 1.398 3.205.335 1.506-.64 3.67.7 5.593",stroke:"#DB836E",strokeWidth:".774",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M79.543 108.673c-2.1 2.926-4.266 6.175-5.557 8.762",stroke:"#E59788",strokeWidth:".774",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M87.72 124.768s-2.098-1.942-5.127-2.719c-3.03-.777-3.574-.155-5.516.078-1.942.233-3.885-.932-3.652.7.233 1.63 5.05 1.01 5.206 2.097.155 1.087-6.37 2.796-8.313 2.175-.777.777.466 1.864 2.02 2.175.233 1.554 2.253 1.554 2.253 1.554s.699 1.01 2.641 1.088c2.486 1.32 8.934-.7 10.954-1.554 2.02-.855-.466-5.594-.466-5.594",fill:"#FFC6A0"}),$.createElement("path",{d:"M73.425 122.826s.66 1.127 3.167 1.418c2.315.27 2.563.583 2.563.583s-2.545 2.894-9.07 2.272M72.416 129.274s3.826.097 4.933-.718M74.98 130.75s1.961.136 3.36-.505M77.232 131.916s1.748.019 2.914-.505M73.328 122.321s-.595-1.032 1.262-.427c1.671.544 2.833.055 5.128.155 1.389.061 3.067-.297 3.982.15 1.606.784 3.632 2.181 3.632 2.181s10.526 1.204 19.033-1.127M78.864 108.104s-8.39 2.758-13.168 12.12",stroke:"#E59788",strokeWidth:".774",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M109.278 112.533s3.38-3.613 7.575-4.662",stroke:"#E4EBF7",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M107.375 123.006s9.697-2.745 11.445-.88",stroke:"#E59788",strokeWidth:".774",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M194.605 83.656l3.971-3.886M187.166 90.933l3.736-3.655M191.752 84.207l-4.462-4.56M198.453 91.057l-4.133-4.225M129.256 163.074l3.718-3.718M122.291 170.039l3.498-3.498M126.561 163.626l-4.27-4.27M132.975 170.039l-3.955-3.955",stroke:"#BFCDDD",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M190.156 211.779h-1.604a4.023 4.023 0 0 1-4.011-4.011V175.68a4.023 4.023 0 0 1 4.01-4.01h1.605a4.023 4.023 0 0 1 4.011 4.01v32.088a4.023 4.023 0 0 1-4.01 4.01",fill:"#A3B4C6"}),$.createElement("path",{d:"M237.824 212.977a4.813 4.813 0 0 1-4.813 4.813h-86.636a4.813 4.813 0 0 1 0-9.626h86.636a4.813 4.813 0 0 1 4.813 4.813",fill:"#A3B4C6"}),$.createElement("mask",{fill:"#fff"}),$.createElement("path",{fill:"#A3B4C6",mask:"url(#d)",d:"M154.098 190.096h70.513v-84.617h-70.513z"}),$.createElement("path",{d:"M224.928 190.096H153.78a3.219 3.219 0 0 1-3.208-3.209V167.92a3.219 3.219 0 0 1 3.208-3.21h71.148a3.219 3.219 0 0 1 3.209 3.21v18.967a3.219 3.219 0 0 1-3.21 3.209M224.928 130.832H153.78a3.218 3.218 0 0 1-3.208-3.208v-18.968a3.219 3.219 0 0 1 3.208-3.209h71.148a3.219 3.219 0 0 1 3.209 3.21v18.967a3.218 3.218 0 0 1-3.21 3.208",fill:"#BFCDDD",mask:"url(#d)"}),$.createElement("path",{d:"M159.563 120.546a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M166.98 120.546a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M174.397 120.546a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M222.539 120.546h-22.461a.802.802 0 0 1-.802-.802v-3.208c0-.443.359-.803.802-.803h22.46c.444 0 .803.36.803.803v3.208c0 .443-.36.802-.802.802",fill:"#FFF",mask:"url(#d)"}),$.createElement("path",{d:"M224.928 160.464H153.78a3.218 3.218 0 0 1-3.208-3.209v-18.967a3.219 3.219 0 0 1 3.208-3.209h71.148a3.219 3.219 0 0 1 3.209 3.209v18.967a3.218 3.218 0 0 1-3.21 3.209",fill:"#BFCDDD",mask:"url(#d)"}),$.createElement("path",{d:"M173.455 130.832h49.301M164.984 130.832h6.089M155.952 130.832h6.75M173.837 160.613h49.3M165.365 160.613h6.089M155.57 160.613h6.751",stroke:"#7C90A5",strokeWidth:"1.124",strokeLinecap:"round",strokeLinejoin:"round",mask:"url(#d)"}),$.createElement("path",{d:"M159.563 151.038a2.407 2.407 0 1 1 0-4.814 2.407 2.407 0 0 1 0 4.814M166.98 151.038a2.407 2.407 0 1 1 0-4.814 2.407 2.407 0 0 1 0 4.814M174.397 151.038a2.407 2.407 0 1 1 .001-4.814 2.407 2.407 0 0 1 0 4.814M222.539 151.038h-22.461a.802.802 0 0 1-.802-.802v-3.209c0-.443.359-.802.802-.802h22.46c.444 0 .803.36.803.802v3.209c0 .443-.36.802-.802.802M159.563 179.987a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M166.98 179.987a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M174.397 179.987a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M222.539 179.987h-22.461a.802.802 0 0 1-.802-.802v-3.209c0-.443.359-.802.802-.802h22.46c.444 0 .803.36.803.802v3.209c0 .443-.36.802-.802.802",fill:"#FFF",mask:"url(#d)"}),$.createElement("path",{d:"M203.04 221.108h-27.372a2.413 2.413 0 0 1-2.406-2.407v-11.448a2.414 2.414 0 0 1 2.406-2.407h27.372a2.414 2.414 0 0 1 2.407 2.407V218.7a2.413 2.413 0 0 1-2.407 2.407",fill:"#BFCDDD",mask:"url(#d)"}),$.createElement("path",{d:"M177.259 207.217v11.52M201.05 207.217v11.52",stroke:"#A3B4C6",strokeWidth:"1.124",strokeLinecap:"round",strokeLinejoin:"round",mask:"url(#d)"}),$.createElement("path",{d:"M162.873 267.894a9.422 9.422 0 0 1-9.422-9.422v-14.82a9.423 9.423 0 0 1 18.845 0v14.82a9.423 9.423 0 0 1-9.423 9.422",fill:"#5BA02E",mask:"url(#d)"}),$.createElement("path",{d:"M171.22 267.83a9.422 9.422 0 0 1-9.422-9.423v-3.438a9.423 9.423 0 0 1 18.845 0v3.438a9.423 9.423 0 0 1-9.422 9.423",fill:"#92C110",mask:"url(#d)"}),$.createElement("path",{d:"M181.31 293.666h-27.712a3.209 3.209 0 0 1-3.209-3.21V269.79a3.209 3.209 0 0 1 3.209-3.21h27.711a3.209 3.209 0 0 1 3.209 3.21v20.668a3.209 3.209 0 0 1-3.209 3.209",fill:"#F2D7AD",mask:"url(#d)"}))),Oq=Dq,Fq=e=>{const{componentCls:r,lineHeightHeading3:a,iconCls:c,padding:d,paddingXL:x,paddingXS:T,paddingLG:i,marginXS:L,lineHeight:N}=e;return{[r]:{padding:`${fn(e.calc(i).mul(2).equal())} ${fn(x)}`,"&-rtl":{direction:"rtl"}},[`${r} ${r}-image`]:{width:e.imageWidth,height:e.imageHeight,margin:"auto"},[`${r} ${r}-icon`]:{marginBottom:i,textAlign:"center",[`& > ${c}`]:{fontSize:e.iconFontSize}},[`${r} ${r}-title`]:{color:e.colorTextHeading,fontSize:e.titleFontSize,lineHeight:a,marginBlock:L,textAlign:"center"},[`${r} ${r}-subtitle`]:{color:e.colorTextDescription,fontSize:e.subtitleFontSize,lineHeight:N,textAlign:"center"},[`${r} ${r}-content`]:{marginTop:i,padding:`${fn(i)} ${fn(e.calc(d).mul(2.5).equal())}`,backgroundColor:e.colorFillAlter},[`${r} ${r}-extra`]:{margin:e.extraMargin,textAlign:"center","& > *":{marginInlineEnd:T,"&:last-child":{marginInlineEnd:0}}}}},Bq=e=>{const{componentCls:r,iconCls:a}=e;return{[`${r}-success ${r}-icon > ${a}`]:{color:e.resultSuccessIconColor},[`${r}-error ${r}-icon > ${a}`]:{color:e.resultErrorIconColor},[`${r}-info ${r}-icon > ${a}`]:{color:e.resultInfoIconColor},[`${r}-warning ${r}-icon > ${a}`]:{color:e.resultWarningIconColor}}},Nq=e=>[Fq(e),Bq(e)],jq=e=>Nq(e),$q=e=>({titleFontSize:e.fontSizeHeading3,subtitleFontSize:e.fontSize,iconFontSize:e.fontSizeHeading3*3,extraMargin:`${e.paddingLG}px 0 0 0`}),Vq=Ms("Result",e=>{const r=e.colorInfo,a=e.colorError,c=e.colorSuccess,d=e.colorWarning,x=Wo(e,{resultInfoIconColor:r,resultErrorIconColor:a,resultSuccessIconColor:c,resultWarningIconColor:d,imageWidth:250,imageHeight:295});return[jq(x)]},$q),Uq=()=>$.createElement("svg",{width:"251",height:"294"},$.createElement("title",null,"Unauthorized"),$.createElement("g",{fill:"none",fillRule:"evenodd"},$.createElement("path",{d:"M0 129.023v-2.084C0 58.364 55.591 2.774 124.165 2.774h2.085c68.574 0 124.165 55.59 124.165 124.165v2.084c0 68.575-55.59 124.166-124.165 124.166h-2.085C55.591 253.189 0 197.598 0 129.023",fill:"#E4EBF7"}),$.createElement("path",{d:"M41.417 132.92a8.231 8.231 0 1 1-16.38-1.65 8.231 8.231 0 0 1 16.38 1.65",fill:"#FFF"}),$.createElement("path",{d:"M38.652 136.36l10.425 5.91M49.989 148.505l-12.58 10.73",stroke:"#FFF",strokeWidth:"2"}),$.createElement("path",{d:"M41.536 161.28a5.636 5.636 0 1 1-11.216-1.13 5.636 5.636 0 0 1 11.216 1.13M59.154 145.261a5.677 5.677 0 1 1-11.297-1.138 5.677 5.677 0 0 1 11.297 1.138M100.36 29.516l29.66-.013a4.562 4.562 0 1 0-.004-9.126l-29.66.013a4.563 4.563 0 0 0 .005 9.126M111.705 47.754l29.659-.013a4.563 4.563 0 1 0-.004-9.126l-29.66.013a4.563 4.563 0 1 0 .005 9.126",fill:"#FFF"}),$.createElement("path",{d:"M114.066 29.503V29.5l15.698-.007a4.563 4.563 0 1 0 .004 9.126l-15.698.007v-.002a4.562 4.562 0 0 0-.004-9.122M185.405 137.723c-.55 5.455-5.418 9.432-10.873 8.882-5.456-.55-9.432-5.418-8.882-10.873.55-5.455 5.418-9.432 10.873-8.882 5.455.55 9.432 5.418 8.882 10.873",fill:"#FFF"}),$.createElement("path",{d:"M180.17 143.772l12.572 7.129M193.841 158.42L178.67 171.36",stroke:"#FFF",strokeWidth:"2"}),$.createElement("path",{d:"M185.55 171.926a6.798 6.798 0 1 1-13.528-1.363 6.798 6.798 0 0 1 13.527 1.363M204.12 155.285a6.848 6.848 0 1 1-13.627-1.375 6.848 6.848 0 0 1 13.626 1.375",fill:"#FFF"}),$.createElement("path",{d:"M152.988 194.074a2.21 2.21 0 1 1-4.42 0 2.21 2.21 0 0 1 4.42 0zM225.931 118.217a2.21 2.21 0 1 1-4.421 0 2.21 2.21 0 0 1 4.421 0zM217.09 153.051a2.21 2.21 0 1 1-4.421 0 2.21 2.21 0 0 1 4.42 0zM177.84 109.842a2.21 2.21 0 1 1-4.422 0 2.21 2.21 0 0 1 4.421 0zM196.114 94.454a2.21 2.21 0 1 1-4.421 0 2.21 2.21 0 0 1 4.421 0zM202.844 182.523a2.21 2.21 0 1 1-4.42 0 2.21 2.21 0 0 1 4.42 0z",stroke:"#FFF",strokeWidth:"2"}),$.createElement("path",{stroke:"#FFF",strokeWidth:"2",d:"M215.125 155.262l-1.902 20.075-10.87 5.958M174.601 176.636l-6.322 9.761H156.98l-4.484 6.449M175.874 127.28V111.56M221.51 119.404l-12.77 7.859-15.228-7.86V96.668"}),$.createElement("path",{d:"M180.68 29.32C180.68 13.128 193.806 0 210 0c16.193 0 29.32 13.127 29.32 29.32 0 16.194-13.127 29.322-29.32 29.322-16.193 0-29.32-13.128-29.32-29.321",fill:"#A26EF4"}),$.createElement("path",{d:"M221.45 41.706l-21.563-.125a1.744 1.744 0 0 1-1.734-1.754l.071-12.23a1.744 1.744 0 0 1 1.754-1.734l21.562.125c.964.006 1.74.791 1.735 1.755l-.071 12.229a1.744 1.744 0 0 1-1.754 1.734",fill:"#FFF"}),$.createElement("path",{d:"M215.106 29.192c-.015 2.577-2.049 4.654-4.543 4.64-2.494-.014-4.504-2.115-4.489-4.693l.04-6.925c.016-2.577 2.05-4.654 4.543-4.64 2.494.015 4.504 2.116 4.49 4.693l-.04 6.925zm-4.53-14.074a6.877 6.877 0 0 0-6.916 6.837l-.043 7.368a6.877 6.877 0 0 0 13.754.08l.042-7.368a6.878 6.878 0 0 0-6.837-6.917zM167.566 68.367h-3.93a4.73 4.73 0 0 1-4.717-4.717 4.73 4.73 0 0 1 4.717-4.717h3.93a4.73 4.73 0 0 1 4.717 4.717 4.73 4.73 0 0 1-4.717 4.717",fill:"#FFF"}),$.createElement("path",{d:"M168.214 248.838a6.611 6.611 0 0 1-6.61-6.611v-66.108a6.611 6.611 0 0 1 13.221 0v66.108a6.611 6.611 0 0 1-6.61 6.61",fill:"#5BA02E"}),$.createElement("path",{d:"M176.147 248.176a6.611 6.611 0 0 1-6.61-6.61v-33.054a6.611 6.611 0 1 1 13.221 0v33.053a6.611 6.611 0 0 1-6.61 6.611",fill:"#92C110"}),$.createElement("path",{d:"M185.994 293.89h-27.376a3.17 3.17 0 0 1-3.17-3.17v-45.887a3.17 3.17 0 0 1 3.17-3.17h27.376a3.17 3.17 0 0 1 3.17 3.17v45.886a3.17 3.17 0 0 1-3.17 3.17",fill:"#F2D7AD"}),$.createElement("path",{d:"M81.972 147.673s6.377-.927 17.566-1.28c11.729-.371 17.57 1.086 17.57 1.086s3.697-3.855.968-8.424c1.278-12.077 5.982-32.827.335-48.273-1.116-1.339-3.743-1.512-7.536-.62-1.337.315-7.147-.149-7.983-.1l-15.311-.347s-3.487-.17-8.035-.508c-1.512-.113-4.227-1.683-5.458-.338-.406.443-2.425 5.669-1.97 16.077l8.635 35.642s-3.141 3.61 1.219 7.085",fill:"#FFF"}),$.createElement("path",{d:"M75.768 73.325l-.9-6.397 11.982-6.52s7.302-.118 8.038 1.205c.737 1.324-5.616.993-5.616.993s-1.836 1.388-2.615 2.5c-1.654 2.363-.986 6.471-8.318 5.986-1.708.284-2.57 2.233-2.57 2.233",fill:"#FFC6A0"}),$.createElement("path",{d:"M52.44 77.672s14.217 9.406 24.973 14.444c1.061.497-2.094 16.183-11.892 11.811-7.436-3.318-20.162-8.44-21.482-14.496-.71-3.258 2.543-7.643 8.401-11.76M141.862 80.113s-6.693 2.999-13.844 6.876c-3.894 2.11-10.137 4.704-12.33 7.988-6.224 9.314 3.536 11.22 12.947 7.503 6.71-2.651 28.999-12.127 13.227-22.367",fill:"#FFB594"}),$.createElement("path",{d:"M76.166 66.36l3.06 3.881s-2.783 2.67-6.31 5.747c-7.103 6.195-12.803 14.296-15.995 16.44-3.966 2.662-9.754 3.314-12.177-.118-3.553-5.032.464-14.628 31.422-25.95",fill:"#FFC6A0"}),$.createElement("path",{d:"M64.674 85.116s-2.34 8.413-8.912 14.447c.652.548 18.586 10.51 22.144 10.056 5.238-.669 6.417-18.968 1.145-20.531-.702-.208-5.901-1.286-8.853-2.167-.87-.26-1.611-1.71-3.545-.936l-1.98-.869zM128.362 85.826s5.318 1.956 7.325 13.734c-.546.274-17.55 12.35-21.829 7.805-6.534-6.94-.766-17.393 4.275-18.61 4.646-1.121 5.03-1.37 10.23-2.929",fill:"#FFF"}),$.createElement("path",{d:"M78.18 94.656s.911 7.41-4.914 13.078",stroke:"#E4EBF7",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M87.397 94.68s3.124 2.572 10.263 2.572c7.14 0 9.074-3.437 9.074-3.437",stroke:"#E4EBF7",strokeWidth:".932",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M117.184 68.639l-6.781-6.177s-5.355-4.314-9.223-.893c-3.867 3.422 4.463 2.083 5.653 4.165 1.19 2.082.848 1.143-2.083.446-5.603-1.331-2.082.893 2.975 5.355 2.091 1.845 6.992.955 6.992.955l2.467-3.851z",fill:"#FFC6A0"}),$.createElement("path",{d:"M105.282 91.315l-.297-10.937-15.918-.027-.53 10.45c-.026.403.17.788.515.999 2.049 1.251 9.387 5.093 15.799.424.287-.21.443-.554.431-.91",fill:"#FFB594"}),$.createElement("path",{d:"M107.573 74.24c.817-1.147.982-9.118 1.015-11.928a1.046 1.046 0 0 0-.965-1.055l-4.62-.365c-7.71-1.044-17.071.624-18.253 6.346-5.482 5.813-.421 13.244-.421 13.244s1.963 3.566 4.305 6.791c.756 1.041.398-3.731 3.04-5.929 5.524-4.594 15.899-7.103 15.899-7.103",fill:"#5C2552"}),$.createElement("path",{d:"M88.426 83.206s2.685 6.202 11.602 6.522c7.82.28 8.973-7.008 7.434-17.505l-.909-5.483c-6.118-2.897-15.478.54-15.478.54s-.576 2.044-.19 5.504c-2.276 2.066-1.824 5.618-1.824 5.618s-.905-1.922-1.98-2.321c-.86-.32-1.897.089-2.322 1.98-1.04 4.632 3.667 5.145 3.667 5.145",fill:"#FFC6A0"}),$.createElement("path",{stroke:"#DB836E",strokeWidth:"1.145",strokeLinecap:"round",strokeLinejoin:"round",d:"M100.843 77.099l1.701-.928-1.015-4.324.674-1.406"}),$.createElement("path",{d:"M105.546 74.092c-.022.713-.452 1.279-.96 1.263-.51-.016-.904-.607-.882-1.32.021-.713.452-1.278.96-1.263.51.016.904.607.882 1.32M97.592 74.349c-.022.713-.452 1.278-.961 1.263-.509-.016-.904-.607-.882-1.32.022-.713.452-1.279.961-1.263.51.016.904.606.882 1.32",fill:"#552950"}),$.createElement("path",{d:"M91.132 86.786s5.269 4.957 12.679 2.327",stroke:"#DB836E",strokeWidth:"1.145",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M99.776 81.903s-3.592.232-1.44-2.79c1.59-1.496 4.897-.46 4.897-.46s1.156 3.906-3.457 3.25",fill:"#DB836E"}),$.createElement("path",{d:"M102.88 70.6s2.483.84 3.402.715M93.883 71.975s2.492-1.144 4.778-1.073",stroke:"#5C2552",strokeWidth:"1.526",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M86.32 77.374s.961.879 1.458 2.106c-.377.48-1.033 1.152-.236 1.809M99.337 83.719s1.911.151 2.509-.254",stroke:"#DB836E",strokeWidth:"1.145",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M87.782 115.821l15.73-3.012M100.165 115.821l10.04-2.008",stroke:"#E4EBF7",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M66.508 86.763s-1.598 8.83-6.697 14.078",stroke:"#E4EBF7",strokeWidth:"1.114",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M128.31 87.934s3.013 4.121 4.06 11.785",stroke:"#E4EBF7",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M64.09 84.816s-6.03 9.912-13.607 9.903",stroke:"#DB836E",strokeWidth:".795",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M112.366 65.909l-.142 5.32s5.993 4.472 11.945 9.202c4.482 3.562 8.888 7.455 10.985 8.662 4.804 2.766 8.9 3.355 11.076 1.808 4.071-2.894 4.373-9.878-8.136-15.263-4.271-1.838-16.144-6.36-25.728-9.73",fill:"#FFC6A0"}),$.createElement("path",{d:"M130.532 85.488s4.588 5.757 11.619 6.214",stroke:"#DB836E",strokeWidth:".75",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M121.708 105.73s-.393 8.564-1.34 13.612",stroke:"#E4EBF7",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M115.784 161.512s-3.57-1.488-2.678-7.14",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M101.52 290.246s4.326 2.057 7.408 1.03c2.842-.948 4.564.673 7.132 1.186 2.57.514 6.925 1.108 11.772-1.269-.104-5.551-6.939-4.01-12.048-6.763-2.582-1.39-3.812-4.757-3.625-8.863h-9.471s-1.402 10.596-1.169 14.68",fill:"#CBD1D1"}),$.createElement("path",{d:"M101.496 290.073s2.447 1.281 6.809.658c3.081-.44 3.74.485 7.479 1.039 3.739.554 10.802-.07 11.91-.9.415 1.108-.347 2.077-.347 2.077s-1.523.608-4.847.831c-2.045.137-5.843.293-7.663-.507-1.8-1.385-5.286-1.917-5.77-.243-3.947.958-7.41-.288-7.41-.288l-.16-2.667z",fill:"#2B0849"}),$.createElement("path",{d:"M108.824 276.19h3.116s-.103 6.751 4.57 8.62c-4.673.624-8.62-2.32-7.686-8.62",fill:"#A4AABA"}),$.createElement("path",{d:"M57.65 272.52s-2.122 7.47-4.518 12.396c-1.811 3.724-4.255 7.548 5.505 7.548 6.698 0 9.02-.483 7.479-6.648-1.541-6.164.268-13.296.268-13.296H57.65z",fill:"#CBD1D1"}),$.createElement("path",{d:"M51.54 290.04s2.111 1.178 6.682 1.178c6.128 0 8.31-1.662 8.31-1.662s.605 1.122-.624 2.18c-1 .862-3.624 1.603-7.444 1.559-4.177-.049-5.876-.57-6.786-1.177-.831-.554-.692-1.593-.138-2.078",fill:"#2B0849"}),$.createElement("path",{d:"M58.533 274.438s.034 1.529-.315 2.95c-.352 1.431-1.087 3.127-1.139 4.17-.058 1.16 4.57 1.592 5.194.035.623-1.559 1.303-6.475 1.927-7.306.622-.831-4.94-2.135-5.667.15",fill:"#A4AABA"}),$.createElement("path",{d:"M100.885 277.015l13.306.092s1.291-54.228 1.843-64.056c.552-9.828 3.756-43.13.997-62.788l-12.48-.64-22.725.776s-.433 3.944-1.19 9.921c-.062.493-.677.838-.744 1.358-.075.582.42 1.347.318 1.956-2.35 14.003-6.343 32.926-8.697 46.425-.116.663-1.227 1.004-1.45 2.677-.04.3.21 1.516.112 1.785-6.836 18.643-10.89 47.584-14.2 61.551l14.528-.014s2.185-8.524 4.008-16.878c2.796-12.817 22.987-84.553 22.987-84.553l3-.517 1.037 46.1s-.223 1.228.334 2.008c.558.782-.556 1.117-.39 2.233l.39 1.784s-.446 7.14-.892 11.826c-.446 4.685-.092 38.954-.092 38.954",fill:"#7BB2F9"}),$.createElement("path",{d:"M77.438 220.434c1.146.094 4.016-2.008 6.916-4.91M107.55 223.931s2.758-1.103 6.069-3.862",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M108.459 220.905s2.759-1.104 6.07-3.863",stroke:"#648BD8",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M76.099 223.557s2.608-.587 6.47-3.346M87.33 150.82c-.27 3.088.297 8.478-4.315 9.073M104.829 149.075s.11 13.936-1.286 14.983c-2.207 1.655-2.975 1.934-2.975 1.934M101.014 149.63s.035 12.81-1.19 24.245M94.93 174.965s7.174-1.655 9.38-1.655M75.671 204.754c-.316 1.55-.64 3.067-.973 4.535 0 0-1.45 1.822-1.003 3.756.446 1.934-.943 2.034-4.96 15.273-1.686 5.559-4.464 18.49-6.313 27.447-.078.38-4.018 18.06-4.093 18.423M77.043 196.743a313.269 313.269 0 0 1-.877 4.729M83.908 151.414l-1.19 10.413s-1.091.148-.496 2.23c.111 1.34-2.66 15.692-5.153 30.267M57.58 272.94h13.238",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),$.createElement("path",{d:"M117.377 147.423s-16.955-3.087-35.7.199c.157 2.501-.002 4.128-.002 4.128s14.607-2.802 35.476-.31c.251-2.342.226-4.017.226-4.017",fill:"#192064"}),$.createElement("path",{d:"M107.511 150.353l.004-4.885a.807.807 0 0 0-.774-.81c-2.428-.092-5.04-.108-7.795-.014a.814.814 0 0 0-.784.81l-.003 4.88c0 .456.371.82.827.808a140.76 140.76 0 0 1 7.688.017.81.81 0 0 0 .837-.806",fill:"#FFF"}),$.createElement("path",{d:"M106.402 149.426l.002-3.06a.64.64 0 0 0-.616-.643 94.135 94.135 0 0 0-5.834-.009.647.647 0 0 0-.626.643l-.001 3.056c0 .36.291.648.651.64 1.78-.04 3.708-.041 5.762.012.36.009.662-.279.662-.64",fill:"#192064"}),$.createElement("path",{d:"M101.485 273.933h12.272M102.652 269.075c.006 3.368.04 5.759.11 6.47M102.667 263.125c-.009 1.53-.015 2.98-.016 4.313M102.204 174.024l.893 44.402s.669 1.561-.224 2.677c-.892 1.116 2.455.67.893 2.231-1.562 1.562.893 1.116 0 3.347-.592 1.48-.988 20.987-1.09 34.956",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}))),Gq=Uq,Hq={success:NL,error:jL,info:$L,warning:zq},G_={404:kq,500:Oq,403:Gq},Wq=Object.keys(G_),qq=e=>{let{prefixCls:r,icon:a,status:c}=e;const d=Mr(`${r}-icon`);if(Wq.includes(`${c}`)){const T=G_[c];return $.createElement("div",{className:`${d} ${r}-image`},$.createElement(T,null))}const x=$.createElement(Hq[c]);return a===null||a===!1?null:$.createElement("div",{className:d},a||x)},Zq=e=>{let{prefixCls:r,extra:a}=e;return a?$.createElement("div",{className:`${r}-extra`},a):null},dx=e=>{let{prefixCls:r,className:a,rootClassName:c,subTitle:d,title:x,style:T,children:i,status:L="info",icon:N,extra:U}=e;const{getPrefixCls:q,direction:X,result:se}=$.useContext(Yn),ce=q("result",r),[ue,fe,re]=Vq(ce),ee=Mr(ce,`${ce}-${L}`,a,se==null?void 0:se.className,c,{[`${ce}-rtl`]:X==="rtl"},fe,re),ae=Object.assign(Object.assign({},se==null?void 0:se.style),T);return ue($.createElement("div",{className:ee,style:ae},$.createElement(qq,{prefixCls:ce,status:L,icon:N}),$.createElement("div",{className:`${ce}-title`},x),d&&$.createElement("div",{className:`${ce}-subtitle`},d),$.createElement(Zq,{prefixCls:ce,extra:U}),i&&$.createElement("div",{className:`${ce}-content`},i)))};dx.PRESENTED_IMAGE_403=G_[403];dx.PRESENTED_IMAGE_404=G_[404];dx.PRESENTED_IMAGE_500=G_[500];const j6=dx,Xq=e=>{const r=e!=null&&e.algorithm?__(e.algorithm):__(F_),a=Object.assign(Object.assign({},Sp),e==null?void 0:e.token);return Wz(a,{override:e==null?void 0:e.token},r,kE)},Yq=Xq;function Kq(e){const{sizeUnit:r,sizeStep:a}=e,c=a-2;return{sizeXXL:r*(c+10),sizeXL:r*(c+6),sizeLG:r*(c+2),sizeMD:r*(c+2),sizeMS:r*(c+1),size:r*c,sizeSM:r*c,sizeXS:r*(c-1),sizeXXS:r*(c-1)}}const Jq=(e,r)=>{const a=r??F_(e),c=a.fontSizeSM,d=a.controlHeight-4;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},a),Kq(r??e)),pL(c)),{controlHeight:d}),fL(Object.assign(Object.assign({},a),{controlHeight:d})))},Qq=Jq,gs=(e,r)=>new Vo(e).setAlpha(r).toRgbString(),Bf=(e,r)=>new Vo(e).lighten(r).toHexString(),eZ=e=>{const r=nd(e,{theme:"dark"});return{1:r[0],2:r[1],3:r[2],4:r[3],5:r[6],6:r[5],7:r[4],8:r[6],9:r[5],10:r[4]}},tZ=(e,r)=>{const a=e||"#000",c=r||"#fff";return{colorBgBase:a,colorTextBase:c,colorText:gs(c,.85),colorTextSecondary:gs(c,.65),colorTextTertiary:gs(c,.45),colorTextQuaternary:gs(c,.25),colorFill:gs(c,.18),colorFillSecondary:gs(c,.12),colorFillTertiary:gs(c,.08),colorFillQuaternary:gs(c,.04),colorBgSolid:gs(c,.95),colorBgSolidHover:gs(c,1),colorBgSolidActive:gs(c,.9),colorBgElevated:Bf(a,12),colorBgContainer:Bf(a,8),colorBgLayout:Bf(a,0),colorBgSpotlight:Bf(a,26),colorBgBlur:gs(c,.04),colorBorder:Bf(a,26),colorBorderSecondary:Bf(a,19)}},rZ=(e,r)=>{const a=Object.keys(AE).map(d=>{const x=nd(e[d],{theme:"dark"});return new Array(10).fill(1).reduce((T,i,L)=>(T[`${d}-${L+1}`]=x[L],T[`${d}${L+1}`]=x[L],T),{})}).reduce((d,x)=>(d=Object.assign(Object.assign({},d),x),d),{}),c=r??F_(e);return Object.assign(Object.assign(Object.assign({},c),a),dL(e,{generateColorPalettes:eZ,generateNeutralColorPalettes:tZ}))},nZ=rZ;function iZ(){const[e,r,a]=$l();return{theme:e,token:r,hashId:a}}const oZ={defaultSeed:x_.token,useToken:iZ,defaultAlgorithm:F_,darkAlgorithm:nZ,compactAlgorithm:Qq,getDesignToken:Yq,defaultConfig:x_,_internalContext:RE};var tT={},$6={exports:{}};(function(e){function r(a){return a&&a.__esModule?a:{default:a}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})($6);var fx=$6.exports,px={};Object.defineProperty(px,"__esModule",{value:!0});px.default=void 0;var aZ={items_per_page:"条/页",jump_to:"跳至",jump_to_confirm:"确定",page:"页",prev_page:"上一页",next_page:"下一页",prev_5:"向前 5 页",next_5:"向后 5 页",prev_3:"向前 3 页",next_3:"向后 3 页",page_size:"页码"};px.default=aZ;var mx={},H_={},gx={},V6={exports:{}},U6={exports:{}},G6={exports:{}},H6={exports:{}};(function(e){function r(a){"@babel/helpers - typeof";return e.exports=r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(c){return typeof c}:function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},e.exports.__esModule=!0,e.exports.default=e.exports,r(a)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(H6);var W6=H6.exports,q6={exports:{}};(function(e){var r=W6.default;function a(c,d){if(r(c)!="object"||!c)return c;var x=c[Symbol.toPrimitive];if(x!==void 0){var T=x.call(c,d||"default");if(r(T)!="object")return T;throw new TypeError("@@toPrimitive must return a primitive value.")}return(d==="string"?String:Number)(c)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(q6);var sZ=q6.exports;(function(e){var r=W6.default,a=sZ;function c(d){var x=a(d,"string");return r(x)=="symbol"?x:x+""}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports})(G6);var lZ=G6.exports;(function(e){var r=lZ;function a(c,d,x){return(d=r(d))in c?Object.defineProperty(c,d,{value:x,enumerable:!0,configurable:!0,writable:!0}):c[d]=x,c}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(U6);var cZ=U6.exports;(function(e){var r=cZ;function a(d,x){var T=Object.keys(d);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(d);x&&(i=i.filter(function(L){return Object.getOwnPropertyDescriptor(d,L).enumerable})),T.push.apply(T,i)}return T}function c(d){for(var x=1;x<arguments.length;x++){var T=arguments[x]!=null?arguments[x]:{};x%2?a(Object(T),!0).forEach(function(i){r(d,i,T[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(T)):a(Object(T)).forEach(function(i){Object.defineProperty(d,i,Object.getOwnPropertyDescriptor(T,i))})}return d}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports})(V6);var uZ=V6.exports,_x={};Object.defineProperty(_x,"__esModule",{value:!0});_x.commonLocale=void 0;_x.commonLocale={yearFormat:"YYYY",dayFormat:"D",cellMeridiemFormat:"A",monthBeforeYear:!0};var hZ=fx.default;Object.defineProperty(gx,"__esModule",{value:!0});gx.default=void 0;var AP=hZ(uZ),dZ=_x,fZ=(0,AP.default)((0,AP.default)({},dZ.commonLocale),{},{locale:"zh_CN",today:"今天",now:"此刻",backToToday:"返回今天",ok:"确定",timeSelect:"选择时间",dateSelect:"选择日期",weekSelect:"选择周",clear:"清除",month:"月",year:"年",previousMonth:"上个月 (翻页上键)",nextMonth:"下个月 (翻页下键)",monthSelect:"选择月份",yearSelect:"选择年份",decadeSelect:"选择年代",previousYear:"上一年 (Control键加左方向键)",nextYear:"下一年 (Control键加右方向键)",previousDecade:"上一年代",nextDecade:"下一年代",previousCentury:"上一世纪",nextCentury:"下一世纪",yearFormat:"YYYY年",cellDateFormat:"D",monthBeforeYear:!1});gx.default=fZ;var W_={};Object.defineProperty(W_,"__esModule",{value:!0});W_.default=void 0;const pZ={placeholder:"请选择时间",rangePlaceholder:["开始时间","结束时间"]};W_.default=pZ;var Z6=fx.default;Object.defineProperty(H_,"__esModule",{value:!0});H_.default=void 0;var mZ=Z6(gx),gZ=Z6(W_);const X6={lang:Object.assign({placeholder:"请选择日期",yearPlaceholder:"请选择年份",quarterPlaceholder:"请选择季度",monthPlaceholder:"请选择月份",weekPlaceholder:"请选择周",rangePlaceholder:["开始日期","结束日期"],rangeYearPlaceholder:["开始年份","结束年份"],rangeMonthPlaceholder:["开始月份","结束月份"],rangeQuarterPlaceholder:["开始季度","结束季度"],rangeWeekPlaceholder:["开始周","结束周"]},mZ.default),timePickerLocale:Object.assign({},gZ.default)};X6.lang.ok="确定";H_.default=X6;var _Z=fx.default;Object.defineProperty(mx,"__esModule",{value:!0});mx.default=void 0;var yZ=_Z(H_);mx.default=yZ.default;var yx=fx.default;Object.defineProperty(tT,"__esModule",{value:!0});var Y6=tT.default=void 0,vZ=yx(px),xZ=yx(mx),bZ=yx(H_),wZ=yx(W_);const qa="${label}不是一个有效的${type}",SZ={locale:"zh-cn",Pagination:vZ.default,DatePicker:bZ.default,TimePicker:wZ.default,Calendar:xZ.default,global:{placeholder:"请选择"},Table:{filterTitle:"筛选",filterConfirm:"确定",filterReset:"重置",filterEmptyText:"无筛选项",filterCheckall:"全选",filterSearchPlaceholder:"在筛选项中搜索",emptyText:"暂无数据",selectAll:"全选当页",selectInvert:"反选当页",selectNone:"清空所有",selectionAll:"全选所有",sortTitle:"排序",expand:"展开行",collapse:"关闭行",triggerDesc:"点击降序",triggerAsc:"点击升序",cancelSort:"取消排序"},Modal:{okText:"确定",cancelText:"取消",justOkText:"知道了"},Tour:{Next:"下一步",Previous:"上一步",Finish:"结束导览"},Popconfirm:{cancelText:"取消",okText:"确定"},Transfer:{titles:["",""],searchPlaceholder:"请输入搜索内容",itemUnit:"项",itemsUnit:"项",remove:"删除",selectCurrent:"全选当页",removeCurrent:"删除当页",selectAll:"全选所有",deselectAll:"取消全选",removeAll:"删除全部",selectInvert:"反选当页"},Upload:{uploading:"文件上传中",removeFile:"删除文件",uploadError:"上传错误",previewFile:"预览文件",downloadFile:"下载文件"},Empty:{description:"暂无数据"},Icon:{icon:"图标"},Text:{edit:"编辑",copy:"复制",copied:"复制成功",expand:"展开",collapse:"收起"},Form:{optional:"（可选）",defaultValidateMessages:{default:"字段验证错误${label}",required:"请输入${label}",enum:"${label}必须是其中一个[${enum}]",whitespace:"${label}不能为空字符",date:{format:"${label}日期格式无效",parse:"${label}不能转换为日期",invalid:"${label}是一个无效日期"},types:{string:qa,method:qa,array:qa,object:qa,number:qa,date:qa,boolean:qa,integer:qa,float:qa,regexp:qa,email:qa,url:qa,hex:qa},string:{len:"${label}须为${len}个字符",min:"${label}最少${min}个字符",max:"${label}最多${max}个字符",range:"${label}须在${min}-${max}字符之间"},number:{len:"${label}必须等于${len}",min:"${label}最小值为${min}",max:"${label}最大值为${max}",range:"${label}须在${min}-${max}之间"},array:{len:"须为${len}个${label}",min:"最少${min}个${label}",max:"最多${max}个${label}",range:"${label}数量须在${min}-${max}之间"},pattern:{mismatch:"${label}与模式不匹配${pattern}"}}},Image:{preview:"预览"},QRCode:{expired:"二维码过期",refresh:"点击刷新",scanned:"已扫描"},ColorPicker:{presetEmpty:"暂无",transparent:"无色",singleColor:"单色",gradientColor:"渐变色"}};Y6=tT.default=SZ;var m3={},RP=F1;m3.createRoot=RP.createRoot,m3.hydrateRoot=RP.hydrateRoot;const EZ="mapbox-gl-v3-demo",TZ="Mapbox GL JS v3 示例",CZ="0.1.0",MZ="huangli",IZ={commit:"git-cz",dev:"vite",build:"tsc && vite build",preview:"vite preview",genlog:"conventional-changelog -p angular -i CHANGELOG.md -s",release:"standard-version && git push --follow-tags",lint:"eslint src --fix --ext .ts,.tsx,.vue,.js,.jsx",prettier:"prettier --write ."},PZ={"@ant-design/icons":"^5.5.2","@naivemap/mapbox-gl-naive-map":"^0.2.0",ahooks:"^3.7.8",antd:"^5.8.2",axios:"^1.4.0",dayjs:"^1.11.9","mapbox-gl":"^3.9.0",react:"^18.2.0","react-dom":"^18.2.0","react-router-dom":"^6.14.2",zustand:"^4.4.1"},AZ={"@commitlint/cli":"^17.6.7","@commitlint/config-conventional":"^17.6.7","@types/react":"^18.2.19","@types/react-dom":"^18.2.7","@typescript-eslint/eslint-plugin":"^6.3.0","@typescript-eslint/parser":"^6.3.0","@vitejs/plugin-react":"^4.0.4","@vitejs/plugin-react-swc":"^3.3.2",autoprefixer:"^10.4.14",commitizen:"^4.3.0",consola:"^3.2.3","conventional-changelog-cli":"^3.0.0",eslint:"^8.46.0","eslint-config-prettier":"^9.0.0","eslint-plugin-react":"^7.33.1","eslint-plugin-react-hooks":"^4.6.0","git-cz":"^4.9.0",husky:"^8.0.3",less:"^4.2.0","lint-staged":"^13.2.3",postcss:"^8.4.27","rollup-plugin-external-globals":"^0.8.0","standard-version":"^9.5.0",tailwindcss:"^3.3.3",typescript:"^5.1.6",vite:"^4.4.9","vite-plugin-html":"^3.2.0"},RZ={commitizen:{path:"git-cz"}},zZ={name:EZ,description:TZ,private:!0,version:CZ,author:MZ,scripts:IZ,dependencies:PZ,devDependencies:AZ,config:RZ,"lint-staged":{"src/**/*.{ts,vue}":["yarn prettier","yarn lint"]}};/**
 * @remix-run/router v1.21.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Ai(){return Ai=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(e[c]=a[c])}return e},Ai.apply(this,arguments)}var Yi;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Yi||(Yi={}));const zP="popstate";function LZ(e){e===void 0&&(e={});function r(d,x){let{pathname:T="/",search:i="",hash:L=""}=Vl(d.location.hash.substr(1));return!T.startsWith("/")&&!T.startsWith(".")&&(T="/"+T),C_("",{pathname:T,search:i,hash:L},x.state&&x.state.usr||null,x.state&&x.state.key||"default")}function a(d,x){let T=d.document.querySelector("base"),i="";if(T&&T.getAttribute("href")){let L=d.location.href,N=L.indexOf("#");i=N===-1?L:L.slice(0,N)}return i+"#"+(typeof x=="string"?x:ad(x))}function c(d,x){od(d.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(x)+")")}return DZ(r,a,c,e)}function Rn(e,r){if(e===!1||e===null||typeof e>"u")throw new Error(r)}function od(e,r){if(!e){typeof console<"u"&&console.warn(r);try{throw new Error(r)}catch{}}}function kZ(){return Math.random().toString(36).substr(2,8)}function LP(e,r){return{usr:e.state,key:e.key,idx:r}}function C_(e,r,a,c){return a===void 0&&(a=null),Ai({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof r=="string"?Vl(r):r,{state:a,key:r&&r.key||c||kZ()})}function ad(e){let{pathname:r="/",search:a="",hash:c=""}=e;return a&&a!=="?"&&(r+=a.charAt(0)==="?"?a:"?"+a),c&&c!=="#"&&(r+=c.charAt(0)==="#"?c:"#"+c),r}function Vl(e){let r={};if(e){let a=e.indexOf("#");a>=0&&(r.hash=e.substr(a),e=e.substr(0,a));let c=e.indexOf("?");c>=0&&(r.search=e.substr(c),e=e.substr(0,c)),e&&(r.pathname=e)}return r}function DZ(e,r,a,c){c===void 0&&(c={});let{window:d=document.defaultView,v5Compat:x=!1}=c,T=d.history,i=Yi.Pop,L=null,N=U();N==null&&(N=0,T.replaceState(Ai({},T.state,{idx:N}),""));function U(){return(T.state||{idx:null}).idx}function q(){i=Yi.Pop;let fe=U(),re=fe==null?null:fe-N;N=fe,L&&L({action:i,location:ue.location,delta:re})}function X(fe,re){i=Yi.Push;let ee=C_(ue.location,fe,re);a&&a(ee,fe),N=U()+1;let ae=LP(ee,N),ve=ue.createHref(ee);try{T.pushState(ae,"",ve)}catch(Te){if(Te instanceof DOMException&&Te.name==="DataCloneError")throw Te;d.location.assign(ve)}x&&L&&L({action:i,location:ue.location,delta:1})}function se(fe,re){i=Yi.Replace;let ee=C_(ue.location,fe,re);a&&a(ee,fe),N=U();let ae=LP(ee,N),ve=ue.createHref(ee);T.replaceState(ae,"",ve),x&&L&&L({action:i,location:ue.location,delta:0})}function ce(fe){let re=d.location.origin!=="null"?d.location.origin:d.location.href,ee=typeof fe=="string"?fe:ad(fe);return ee=ee.replace(/ $/,"%20"),Rn(re,"No window.location.(origin|href) available to create URL for href: "+ee),new URL(ee,re)}let ue={get action(){return i},get location(){return e(d,T)},listen(fe){if(L)throw new Error("A history only accepts one active listener");return d.addEventListener(zP,q),L=fe,()=>{d.removeEventListener(zP,q),L=null}},createHref(fe){return r(d,fe)},createURL:ce,encodeLocation(fe){let re=ce(fe);return{pathname:re.pathname,search:re.search,hash:re.hash}},push:X,replace:se,go(fe){return T.go(fe)}};return ue}var hi;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(hi||(hi={}));const OZ=new Set(["lazy","caseSensitive","path","id","index","children"]);function FZ(e){return e.index===!0}function y1(e,r,a,c){return a===void 0&&(a=[]),c===void 0&&(c={}),e.map((d,x)=>{let T=[...a,String(x)],i=typeof d.id=="string"?d.id:T.join("-");if(Rn(d.index!==!0||!d.children,"Cannot specify children on an index route"),Rn(!c[i],'Found a route id collision on id "'+i+`".  Route id's must be globally unique within Data Router usages`),FZ(d)){let L=Ai({},d,r(d),{id:i});return c[i]=L,L}else{let L=Ai({},d,r(d),{id:i,children:void 0});return c[i]=L,d.children&&(L.children=y1(d.children,r,T,c)),L}})}function Bh(e,r,a){return a===void 0&&(a="/"),Fv(e,r,a,!1)}function Fv(e,r,a,c){let d=typeof r=="string"?Vl(r):r,x=Bp(d.pathname||"/",a);if(x==null)return null;let T=K6(e);NZ(T);let i=null;for(let L=0;i==null&&L<T.length;++L){let N=YZ(x);i=ZZ(T[L],N,c)}return i}function BZ(e,r){let{route:a,pathname:c,params:d}=e;return{id:a.id,pathname:c,params:d,data:r[a.id],handle:a.handle}}function K6(e,r,a,c){r===void 0&&(r=[]),a===void 0&&(a=[]),c===void 0&&(c="");let d=(x,T,i)=>{let L={relativePath:i===void 0?x.path||"":i,caseSensitive:x.caseSensitive===!0,childrenIndex:T,route:x};L.relativePath.startsWith("/")&&(Rn(L.relativePath.startsWith(c),'Absolute route path "'+L.relativePath+'" nested under path '+('"'+c+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),L.relativePath=L.relativePath.slice(c.length));let N=wc([c,L.relativePath]),U=a.concat(L);x.children&&x.children.length>0&&(Rn(x.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+N+'".')),K6(x.children,r,U,N)),!(x.path==null&&!x.index)&&r.push({path:N,score:WZ(N,x.index),routesMeta:U})};return e.forEach((x,T)=>{var i;if(x.path===""||!((i=x.path)!=null&&i.includes("?")))d(x,T);else for(let L of J6(x.path))d(x,T,L)}),r}function J6(e){let r=e.split("/");if(r.length===0)return[];let[a,...c]=r,d=a.endsWith("?"),x=a.replace(/\?$/,"");if(c.length===0)return d?[x,""]:[x];let T=J6(c.join("/")),i=[];return i.push(...T.map(L=>L===""?x:[x,L].join("/"))),d&&i.push(...T),i.map(L=>e.startsWith("/")&&L===""?"/":L)}function NZ(e){e.sort((r,a)=>r.score!==a.score?a.score-r.score:qZ(r.routesMeta.map(c=>c.childrenIndex),a.routesMeta.map(c=>c.childrenIndex)))}const jZ=/^:[\w-]+$/,$Z=3,VZ=2,UZ=1,GZ=10,HZ=-2,kP=e=>e==="*";function WZ(e,r){let a=e.split("/"),c=a.length;return a.some(kP)&&(c+=HZ),r&&(c+=VZ),a.filter(d=>!kP(d)).reduce((d,x)=>d+(jZ.test(x)?$Z:x===""?UZ:GZ),c)}function qZ(e,r){return e.length===r.length&&e.slice(0,-1).every((c,d)=>c===r[d])?e[e.length-1]-r[r.length-1]:0}function ZZ(e,r,a){a===void 0&&(a=!1);let{routesMeta:c}=e,d={},x="/",T=[];for(let i=0;i<c.length;++i){let L=c[i],N=i===c.length-1,U=x==="/"?r:r.slice(x.length)||"/",q=DP({path:L.relativePath,caseSensitive:L.caseSensitive,end:N},U),X=L.route;if(!q&&N&&a&&!c[c.length-1].route.index&&(q=DP({path:L.relativePath,caseSensitive:L.caseSensitive,end:!1},U)),!q)return null;Object.assign(d,q.params),T.push({params:d,pathname:wc([x,q.pathname]),pathnameBase:QZ(wc([x,q.pathnameBase])),route:X}),q.pathnameBase!=="/"&&(x=wc([x,q.pathnameBase]))}return T}function DP(e,r){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[a,c]=XZ(e.path,e.caseSensitive,e.end),d=r.match(a);if(!d)return null;let x=d[0],T=x.replace(/(.)\/+$/,"$1"),i=d.slice(1);return{params:c.reduce((N,U,q)=>{let{paramName:X,isOptional:se}=U;if(X==="*"){let ue=i[q]||"";T=x.slice(0,x.length-ue.length).replace(/(.)\/+$/,"$1")}const ce=i[q];return se&&!ce?N[X]=void 0:N[X]=(ce||"").replace(/%2F/g,"/"),N},{}),pathname:x,pathnameBase:T,pattern:e}}function XZ(e,r,a){r===void 0&&(r=!1),a===void 0&&(a=!0),od(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let c=[],d="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(T,i,L)=>(c.push({paramName:i,isOptional:L!=null}),L?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(c.push({paramName:"*"}),d+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?d+="\\/*$":e!==""&&e!=="/"&&(d+="(?:(?=\\/|$))"),[new RegExp(d,r?void 0:"i"),c]}function YZ(e){try{return e.split("/").map(r=>decodeURIComponent(r).replace(/\//g,"%2F")).join("/")}catch(r){return od(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+r+").")),e}}function Bp(e,r){if(r==="/")return e;if(!e.toLowerCase().startsWith(r.toLowerCase()))return null;let a=r.endsWith("/")?r.length-1:r.length,c=e.charAt(a);return c&&c!=="/"?null:e.slice(a)||"/"}function KZ(e,r){r===void 0&&(r="/");let{pathname:a,search:c="",hash:d=""}=typeof e=="string"?Vl(e):e;return{pathname:a?a.startsWith("/")?a:JZ(a,r):r,search:eX(c),hash:tX(d)}}function JZ(e,r){let a=r.replace(/\/+$/,"").split("/");return e.split("/").forEach(d=>{d===".."?a.length>1&&a.pop():d!=="."&&a.push(d)}),a.length>1?a.join("/"):"/"}function S2(e,r,a,c){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+r+"` field ["+JSON.stringify(c)+"].  Please separate it out to the ")+("`to."+a+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Q6(e){return e.filter((r,a)=>a===0||r.route.path&&r.route.path.length>0)}function rT(e,r){let a=Q6(e);return r?a.map((c,d)=>d===a.length-1?c.pathname:c.pathnameBase):a.map(c=>c.pathnameBase)}function nT(e,r,a,c){c===void 0&&(c=!1);let d;typeof e=="string"?d=Vl(e):(d=Ai({},e),Rn(!d.pathname||!d.pathname.includes("?"),S2("?","pathname","search",d)),Rn(!d.pathname||!d.pathname.includes("#"),S2("#","pathname","hash",d)),Rn(!d.search||!d.search.includes("#"),S2("#","search","hash",d)));let x=e===""||d.pathname==="",T=x?"/":d.pathname,i;if(T==null)i=a;else{let q=r.length-1;if(!c&&T.startsWith("..")){let X=T.split("/");for(;X[0]==="..";)X.shift(),q-=1;d.pathname=X.join("/")}i=q>=0?r[q]:"/"}let L=KZ(d,i),N=T&&T!=="/"&&T.endsWith("/"),U=(x||T===".")&&a.endsWith("/");return!L.pathname.endsWith("/")&&(N||U)&&(L.pathname+="/"),L}const wc=e=>e.join("/").replace(/\/\/+/g,"/"),QZ=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),eX=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,tX=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;class v1{constructor(r,a,c,d){d===void 0&&(d=!1),this.status=r,this.statusText=a||"",this.internal=d,c instanceof Error?(this.data=c.toString(),this.error=c):this.data=c}}function vx(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const ek=["post","put","patch","delete"],rX=new Set(ek),nX=["get",...ek],iX=new Set(nX),oX=new Set([301,302,303,307,308]),aX=new Set([307,308]),E2={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},sX={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Cg={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},iT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,lX=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),tk="remix-router-transitions";function cX(e){const r=e.window?e.window:typeof window<"u"?window:void 0,a=typeof r<"u"&&typeof r.document<"u"&&typeof r.document.createElement<"u",c=!a;Rn(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let d;if(e.mapRouteProperties)d=e.mapRouteProperties;else if(e.detectErrorBoundary){let K=e.detectErrorBoundary;d=he=>({hasErrorBoundary:K(he)})}else d=lX;let x={},T=y1(e.routes,d,void 0,x),i,L=e.basename||"/",N=e.dataStrategy||fX,U=e.patchRoutesOnNavigation,q=Ai({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},e.future),X=null,se=new Set,ce=null,ue=null,fe=null,re=e.hydrationData!=null,ee=Bh(T,e.history.location,L),ae=null;if(ee==null&&!U){let K=Ia(404,{pathname:e.history.location.pathname}),{matches:he,route:de}=WP(T);ee=he,ae={[de.id]:K}}ee&&!e.hydrationData&&Bn(ee,T,e.history.location.pathname).active&&(ee=null);let ve;if(ee)if(ee.some(K=>K.route.lazy))ve=!1;else if(!ee.some(K=>K.route.loader))ve=!0;else if(q.v7_partialHydration){let K=e.hydrationData?e.hydrationData.loaderData:null,he=e.hydrationData?e.hydrationData.errors:null;if(he){let de=ee.findIndex(xe=>he[xe.route.id]!==void 0);ve=ee.slice(0,de+1).every(xe=>!_3(xe.route,K,he))}else ve=ee.every(de=>!_3(de.route,K,he))}else ve=e.hydrationData!=null;else if(ve=!1,ee=[],q.v7_partialHydration){let K=Bn(null,T,e.history.location.pathname);K.active&&K.matches&&(ee=K.matches)}let Te,pe={historyAction:e.history.action,location:e.history.location,matches:ee,initialized:ve,navigation:E2,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||ae,fetchers:new Map,blockers:new Map},Ee=Yi.Pop,Ne=!1,Xe,Fe=!1,Je=new Map,Ct=null,ft=!1,yt=!1,lt=[],ct=new Set,Ye=new Map,Ke=0,tt=-1,ht=new Map,vt=new Set,At=new Map,Pt=new Map,qt=new Set,or=new Map,cr=new Map,Qt;function qr(){if(X=e.history.listen(K=>{let{action:he,location:de,delta:xe}=K;if(Qt){Qt(),Qt=void 0;return}od(cr.size===0||xe!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let ke=Gi({currentLocation:pe.location,nextLocation:de,historyAction:he});if(ke&&xe!=null){let ze=new Promise(He=>{Qt=He});e.history.go(xe*-1),gr(ke,{state:"blocked",location:de,proceed(){gr(ke,{state:"proceeding",proceed:void 0,reset:void 0,location:de}),ze.then(()=>e.history.go(xe))},reset(){let He=new Map(pe.blockers);He.set(ke,Cg),Lr({blockers:He})}});return}return Pr(he,de)}),a){MX(r,Je);let K=()=>IX(r,Je);r.addEventListener("pagehide",K),Ct=()=>r.removeEventListener("pagehide",K)}return pe.initialized||Pr(Yi.Pop,pe.location,{initialHydration:!0}),Te}function yr(){X&&X(),Ct&&Ct(),se.clear(),Xe&&Xe.abort(),pe.fetchers.forEach((K,he)=>Ui(he)),pe.blockers.forEach((K,he)=>bi(he))}function Ae(K){return se.add(K),()=>se.delete(K)}function Lr(K,he){he===void 0&&(he={}),pe=Ai({},pe,K);let de=[],xe=[];q.v7_fetcherPersist&&pe.fetchers.forEach((ke,ze)=>{ke.state==="idle"&&(qt.has(ze)?xe.push(ze):de.push(ze))}),[...se].forEach(ke=>ke(pe,{deletedFetchers:xe,viewTransitionOpts:he.viewTransitionOpts,flushSync:he.flushSync===!0})),q.v7_fetcherPersist&&(de.forEach(ke=>pe.fetchers.delete(ke)),xe.forEach(ke=>Ui(ke)))}function $r(K,he,de){var xe,ke;let{flushSync:ze}=de===void 0?{}:de,He=pe.actionData!=null&&pe.navigation.formMethod!=null&&il(pe.navigation.formMethod)&&pe.navigation.state==="loading"&&((xe=K.state)==null?void 0:xe._isRedirect)!==!0,Ue;he.actionData?Object.keys(he.actionData).length>0?Ue=he.actionData:Ue=null:He?Ue=pe.actionData:Ue=null;let Ze=he.loaderData?GP(pe.loaderData,he.loaderData,he.matches||[],he.errors):pe.loaderData,ot=pe.blockers;ot.size>0&&(ot=new Map(ot),ot.forEach((Ut,tr)=>ot.set(tr,Cg)));let pt=Ne===!0||pe.navigation.formMethod!=null&&il(pe.navigation.formMethod)&&((ke=K.state)==null?void 0:ke._isRedirect)!==!0;i&&(T=i,i=void 0),ft||Ee===Yi.Pop||(Ee===Yi.Push?e.history.push(K,K.state):Ee===Yi.Replace&&e.history.replace(K,K.state));let St;if(Ee===Yi.Pop){let Ut=Je.get(pe.location.pathname);Ut&&Ut.has(K.pathname)?St={currentLocation:pe.location,nextLocation:K}:Je.has(K.pathname)&&(St={currentLocation:K,nextLocation:pe.location})}else if(Fe){let Ut=Je.get(pe.location.pathname);Ut?Ut.add(K.pathname):(Ut=new Set([K.pathname]),Je.set(pe.location.pathname,Ut)),St={currentLocation:pe.location,nextLocation:K}}Lr(Ai({},he,{actionData:Ue,loaderData:Ze,historyAction:Ee,location:K,initialized:!0,navigation:E2,revalidation:"idle",restoreScrollPosition:Wi(K,he.matches||pe.matches),preventScrollReset:pt,blockers:ot}),{viewTransitionOpts:St,flushSync:ze===!0}),Ee=Yi.Pop,Ne=!1,Fe=!1,ft=!1,yt=!1,lt=[]}async function pn(K,he){if(typeof K=="number"){e.history.go(K);return}let de=g3(pe.location,pe.matches,L,q.v7_prependBasename,K,q.v7_relativeSplatPath,he==null?void 0:he.fromRouteId,he==null?void 0:he.relative),{path:xe,submission:ke,error:ze}=OP(q.v7_normalizeFormMethod,!1,de,he),He=pe.location,Ue=C_(pe.location,xe,he&&he.state);Ue=Ai({},Ue,e.history.encodeLocation(Ue));let Ze=he&&he.replace!=null?he.replace:void 0,ot=Yi.Push;Ze===!0?ot=Yi.Replace:Ze===!1||ke!=null&&il(ke.formMethod)&&ke.formAction===pe.location.pathname+pe.location.search&&(ot=Yi.Replace);let pt=he&&"preventScrollReset"in he?he.preventScrollReset===!0:void 0,St=(he&&he.flushSync)===!0,Ut=Gi({currentLocation:He,nextLocation:Ue,historyAction:ot});if(Ut){gr(Ut,{state:"blocked",location:Ue,proceed(){gr(Ut,{state:"proceeding",proceed:void 0,reset:void 0,location:Ue}),pn(K,he)},reset(){let tr=new Map(pe.blockers);tr.set(Ut,Cg),Lr({blockers:tr})}});return}return await Pr(ot,Ue,{submission:ke,pendingError:ze,preventScrollReset:pt,replace:he&&he.replace,enableViewTransition:he&&he.viewTransition,flushSync:St})}function wt(){if(gn(),Lr({revalidation:"loading"}),pe.navigation.state!=="submitting"){if(pe.navigation.state==="idle"){Pr(pe.historyAction,pe.location,{startUninterruptedRevalidation:!0});return}Pr(Ee||pe.historyAction,pe.navigation.location,{overrideNavigation:pe.navigation,enableViewTransition:Fe===!0})}}async function Pr(K,he,de){Xe&&Xe.abort(),Xe=null,Ee=K,ft=(de&&de.startUninterruptedRevalidation)===!0,pi(pe.location,pe.matches),Ne=(de&&de.preventScrollReset)===!0,Fe=(de&&de.enableViewTransition)===!0;let xe=i||T,ke=de&&de.overrideNavigation,ze=Bh(xe,he,L),He=(de&&de.flushSync)===!0,Ue=Bn(ze,xe,he.pathname);if(Ue.active&&Ue.matches&&(ze=Ue.matches),!ze){let{error:Gt,notFoundMatches:Xt,route:vr}=Lo(he.pathname);$r(he,{matches:Xt,loaderData:{},errors:{[vr.id]:Gt}},{flushSync:He});return}if(pe.initialized&&!yt&&vX(pe.location,he)&&!(de&&de.submission&&il(de.submission.formMethod))){$r(he,{matches:ze},{flushSync:He});return}Xe=new AbortController;let Ze=Nf(e.history,he,Xe.signal,de&&de.submission),ot;if(de&&de.pendingError)ot=[Nh(ze).route.id,{type:hi.error,error:de.pendingError}];else if(de&&de.submission&&il(de.submission.formMethod)){let Gt=await Ur(Ze,he,de.submission,ze,Ue.active,{replace:de.replace,flushSync:He});if(Gt.shortCircuited)return;if(Gt.pendingActionResult){let[Xt,vr]=Gt.pendingActionResult;if(Ya(vr)&&vx(vr.error)&&vr.error.status===404){Xe=null,$r(he,{matches:Gt.matches,loaderData:{},errors:{[Xt]:vr.error}});return}}ze=Gt.matches||ze,ot=Gt.pendingActionResult,ke=T2(he,de.submission),He=!1,Ue.active=!1,Ze=Nf(e.history,Ze.url,Ze.signal)}let{shortCircuited:pt,matches:St,loaderData:Ut,errors:tr}=await Un(Ze,he,ze,Ue.active,ke,de&&de.submission,de&&de.fetcherSubmission,de&&de.replace,de&&de.initialHydration===!0,He,ot);pt||(Xe=null,$r(he,Ai({matches:St||ze},HP(ot),{loaderData:Ut,errors:tr})))}async function Ur(K,he,de,xe,ke,ze){ze===void 0&&(ze={}),gn();let He=TX(he,de);if(Lr({navigation:He},{flushSync:ze.flushSync===!0}),ke){let ot=await it(xe,he.pathname,K.signal);if(ot.type==="aborted")return{shortCircuited:!0};if(ot.type==="error"){let pt=Nh(ot.partialMatches).route.id;return{matches:ot.partialMatches,pendingActionResult:[pt,{type:hi.error,error:ot.error}]}}else if(ot.matches)xe=ot.matches;else{let{notFoundMatches:pt,error:St,route:Ut}=Lo(he.pathname);return{matches:pt,pendingActionResult:[Ut.id,{type:hi.error,error:St}]}}}let Ue,Ze=Dg(xe,he);if(!Ze.route.action&&!Ze.route.lazy)Ue={type:hi.error,error:Ia(405,{method:K.method,pathname:he.pathname,routeId:Ze.route.id})};else if(Ue=(await Jt("action",pe,K,[Ze],xe,null))[Ze.route.id],K.signal.aborted)return{shortCircuited:!0};if(Hh(Ue)){let ot;return ze&&ze.replace!=null?ot=ze.replace:ot=$P(Ue.response.headers.get("Location"),new URL(K.url),L)===pe.location.pathname+pe.location.search,await fr(K,Ue,!0,{submission:de,replace:ot}),{shortCircuited:!0}}if(Au(Ue))throw Ia(400,{type:"defer-action"});if(Ya(Ue)){let ot=Nh(xe,Ze.route.id);return(ze&&ze.replace)!==!0&&(Ee=Yi.Push),{matches:xe,pendingActionResult:[ot.route.id,Ue]}}return{matches:xe,pendingActionResult:[Ze.route.id,Ue]}}async function Un(K,he,de,xe,ke,ze,He,Ue,Ze,ot,pt){let St=ke||T2(he,ze),Ut=ze||He||ZP(St),tr=!ft&&(!q.v7_partialHydration||!Ze);if(xe){if(tr){let Gn=ar(pt);Lr(Ai({navigation:St},Gn!==void 0?{actionData:Gn}:{}),{flushSync:ot})}let Yr=await it(de,he.pathname,K.signal);if(Yr.type==="aborted")return{shortCircuited:!0};if(Yr.type==="error"){let Gn=Nh(Yr.partialMatches).route.id;return{matches:Yr.partialMatches,loaderData:{},errors:{[Gn]:Yr.error}}}else if(Yr.matches)de=Yr.matches;else{let{error:Gn,notFoundMatches:Qi,route:wi}=Lo(he.pathname);return{matches:Qi,loaderData:{},errors:{[wi.id]:Gn}}}}let Gt=i||T,[Xt,vr]=BP(e.history,pe,de,Ut,he,q.v7_partialHydration&&Ze===!0,q.v7_skipActionErrorRevalidation,yt,lt,ct,qt,At,vt,Gt,L,pt);if(li(Yr=>!(de&&de.some(Gn=>Gn.route.id===Yr))||Xt&&Xt.some(Gn=>Gn.route.id===Yr)),tt=++Ke,Xt.length===0&&vr.length===0){let Yr=Jn();return $r(he,Ai({matches:de,loaderData:{},errors:pt&&Ya(pt[1])?{[pt[0]]:pt[1].error}:null},HP(pt),Yr?{fetchers:new Map(pe.fetchers)}:{}),{flushSync:ot}),{shortCircuited:!0}}if(tr){let Yr={};if(!xe){Yr.navigation=St;let Gn=ar(pt);Gn!==void 0&&(Yr.actionData=Gn)}vr.length>0&&(Yr.fetchers=tn(vr)),Lr(Yr,{flushSync:ot})}vr.forEach(Yr=>{nn(Yr.key),Yr.controller&&Ye.set(Yr.key,Yr.controller)});let Nr=()=>vr.forEach(Yr=>nn(Yr.key));Xe&&Xe.signal.addEventListener("abort",Nr);let{loaderResults:dr,fetcherResults:Vr}=await bn(pe,de,Xt,vr,K);if(K.signal.aborted)return{shortCircuited:!0};Xe&&Xe.signal.removeEventListener("abort",Nr),vr.forEach(Yr=>Ye.delete(Yr.key));let Gr=mv(dr);if(Gr)return await fr(K,Gr.result,!0,{replace:Ue}),{shortCircuited:!0};if(Gr=mv(Vr),Gr)return vt.add(Gr.key),await fr(K,Gr.result,!0,{replace:Ue}),{shortCircuited:!0};let{loaderData:In,errors:ii}=UP(pe,de,dr,pt,vr,Vr,or);or.forEach((Yr,Gn)=>{Yr.subscribe(Qi=>{(Qi||Yr.done)&&or.delete(Gn)})}),q.v7_partialHydration&&Ze&&pe.errors&&(ii=Ai({},pe.errors,ii));let $n=Jn(),Qn=zo(tt),so=$n||Qn||vr.length>0;return Ai({matches:de,loaderData:In,errors:ii},so?{fetchers:new Map(pe.fetchers)}:{})}function ar(K){if(K&&!Ya(K[1]))return{[K[0]]:K[1].data};if(pe.actionData)return Object.keys(pe.actionData).length===0?null:pe.actionData}function tn(K){return K.forEach(he=>{let de=pe.fetchers.get(he.key),xe=Mg(void 0,de?de.data:void 0);pe.fetchers.set(he.key,xe)}),new Map(pe.fetchers)}function Ln(K,he,de,xe){if(c)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");nn(K);let ke=(xe&&xe.flushSync)===!0,ze=i||T,He=g3(pe.location,pe.matches,L,q.v7_prependBasename,de,q.v7_relativeSplatPath,he,xe==null?void 0:xe.relative),Ue=Bh(ze,He,L),Ze=Bn(Ue,ze,He);if(Ze.active&&Ze.matches&&(Ue=Ze.matches),!Ue){dn(K,he,Ia(404,{pathname:He}),{flushSync:ke});return}let{path:ot,submission:pt,error:St}=OP(q.v7_normalizeFormMethod,!0,He,xe);if(St){dn(K,he,St,{flushSync:ke});return}let Ut=Dg(Ue,ot),tr=(xe&&xe.preventScrollReset)===!0;if(pt&&il(pt.formMethod)){Xr(K,he,ot,Ut,Ue,Ze.active,ke,tr,pt);return}At.set(K,{routeId:he,path:ot}),hn(K,he,ot,Ut,Ue,Ze.active,ke,tr,pt)}async function Xr(K,he,de,xe,ke,ze,He,Ue,Ze){gn(),At.delete(K);function ot(Zn){if(!Zn.route.action&&!Zn.route.lazy){let eo=Ia(405,{method:Ze.formMethod,pathname:de,routeId:he});return dn(K,he,eo,{flushSync:He}),!0}return!1}if(!ze&&ot(xe))return;let pt=pe.fetchers.get(K);Kn(K,CX(Ze,pt),{flushSync:He});let St=new AbortController,Ut=Nf(e.history,de,St.signal,Ze);if(ze){let Zn=await it(ke,de,Ut.signal);if(Zn.type==="aborted")return;if(Zn.type==="error"){dn(K,he,Zn.error,{flushSync:He});return}else if(Zn.matches){if(ke=Zn.matches,xe=Dg(ke,de),ot(xe))return}else{dn(K,he,Ia(404,{pathname:de}),{flushSync:He});return}}Ye.set(K,St);let tr=Ke,Xt=(await Jt("action",pe,Ut,[xe],ke,K))[xe.route.id];if(Ut.signal.aborted){Ye.get(K)===St&&Ye.delete(K);return}if(q.v7_fetcherPersist&&qt.has(K)){if(Hh(Xt)||Ya(Xt)){Kn(K,vu(void 0));return}}else{if(Hh(Xt))if(Ye.delete(K),tt>tr){Kn(K,vu(void 0));return}else return vt.add(K),Kn(K,Mg(Ze)),fr(Ut,Xt,!1,{fetcherSubmission:Ze,preventScrollReset:Ue});if(Ya(Xt)){dn(K,he,Xt.error);return}}if(Au(Xt))throw Ia(400,{type:"defer-action"});let vr=pe.navigation.location||pe.location,Nr=Nf(e.history,vr,St.signal),dr=i||T,Vr=pe.navigation.state!=="idle"?Bh(dr,pe.navigation.location,L):pe.matches;Rn(Vr,"Didn't find any matches after fetcher action");let Gr=++Ke;ht.set(K,Gr);let In=Mg(Ze,Xt.data);pe.fetchers.set(K,In);let[ii,$n]=BP(e.history,pe,Vr,Ze,vr,!1,q.v7_skipActionErrorRevalidation,yt,lt,ct,qt,At,vt,dr,L,[xe.route.id,Xt]);$n.filter(Zn=>Zn.key!==K).forEach(Zn=>{let eo=Zn.key,Si=pe.fetchers.get(eo),zi=Mg(void 0,Si?Si.data:void 0);pe.fetchers.set(eo,zi),nn(eo),Zn.controller&&Ye.set(eo,Zn.controller)}),Lr({fetchers:new Map(pe.fetchers)});let Qn=()=>$n.forEach(Zn=>nn(Zn.key));St.signal.addEventListener("abort",Qn);let{loaderResults:so,fetcherResults:Yr}=await bn(pe,Vr,ii,$n,Nr);if(St.signal.aborted)return;St.signal.removeEventListener("abort",Qn),ht.delete(K),Ye.delete(K),$n.forEach(Zn=>Ye.delete(Zn.key));let Gn=mv(so);if(Gn)return fr(Nr,Gn.result,!1,{preventScrollReset:Ue});if(Gn=mv(Yr),Gn)return vt.add(Gn.key),fr(Nr,Gn.result,!1,{preventScrollReset:Ue});let{loaderData:Qi,errors:wi}=UP(pe,Vr,so,void 0,$n,Yr,or);if(pe.fetchers.has(K)){let Zn=vu(Xt.data);pe.fetchers.set(K,Zn)}zo(Gr),pe.navigation.state==="loading"&&Gr>tt?(Rn(Ee,"Expected pending action"),Xe&&Xe.abort(),$r(pe.navigation.location,{matches:Vr,loaderData:Qi,errors:wi,fetchers:new Map(pe.fetchers)})):(Lr({errors:wi,loaderData:GP(pe.loaderData,Qi,Vr,wi),fetchers:new Map(pe.fetchers)}),yt=!1)}async function hn(K,he,de,xe,ke,ze,He,Ue,Ze){let ot=pe.fetchers.get(K);Kn(K,Mg(Ze,ot?ot.data:void 0),{flushSync:He});let pt=new AbortController,St=Nf(e.history,de,pt.signal);if(ze){let Xt=await it(ke,de,St.signal);if(Xt.type==="aborted")return;if(Xt.type==="error"){dn(K,he,Xt.error,{flushSync:He});return}else if(Xt.matches)ke=Xt.matches,xe=Dg(ke,de);else{dn(K,he,Ia(404,{pathname:de}),{flushSync:He});return}}Ye.set(K,pt);let Ut=Ke,Gt=(await Jt("loader",pe,St,[xe],ke,K))[xe.route.id];if(Au(Gt)&&(Gt=await oT(Gt,St.signal,!0)||Gt),Ye.get(K)===pt&&Ye.delete(K),!St.signal.aborted){if(qt.has(K)){Kn(K,vu(void 0));return}if(Hh(Gt))if(tt>Ut){Kn(K,vu(void 0));return}else{vt.add(K),await fr(St,Gt,!1,{preventScrollReset:Ue});return}if(Ya(Gt)){dn(K,he,Gt.error);return}Rn(!Au(Gt),"Unhandled fetcher deferred data"),Kn(K,vu(Gt.data))}}async function fr(K,he,de,xe){let{submission:ke,fetcherSubmission:ze,preventScrollReset:He,replace:Ue}=xe===void 0?{}:xe;he.response.headers.has("X-Remix-Revalidate")&&(yt=!0);let Ze=he.response.headers.get("Location");Rn(Ze,"Expected a Location header on the redirect Response"),Ze=$P(Ze,new URL(K.url),L);let ot=C_(pe.location,Ze,{_isRedirect:!0});if(a){let Xt=!1;if(he.response.headers.has("X-Remix-Reload-Document"))Xt=!0;else if(iT.test(Ze)){const vr=e.history.createURL(Ze);Xt=vr.origin!==r.location.origin||Bp(vr.pathname,L)==null}if(Xt){Ue?r.location.replace(Ze):r.location.assign(Ze);return}}Xe=null;let pt=Ue===!0||he.response.headers.has("X-Remix-Replace")?Yi.Replace:Yi.Push,{formMethod:St,formAction:Ut,formEncType:tr}=pe.navigation;!ke&&!ze&&St&&Ut&&tr&&(ke=ZP(pe.navigation));let Gt=ke||ze;if(aX.has(he.response.status)&&Gt&&il(Gt.formMethod))await Pr(pt,ot,{submission:Ai({},Gt,{formAction:Ze}),preventScrollReset:He||Ne,enableViewTransition:de?Fe:void 0});else{let Xt=T2(ot,ke);await Pr(pt,ot,{overrideNavigation:Xt,fetcherSubmission:ze,preventScrollReset:He||Ne,enableViewTransition:de?Fe:void 0})}}async function Jt(K,he,de,xe,ke,ze){let He,Ue={};try{He=await pX(N,K,he,de,xe,ke,ze,x,d)}catch(Ze){return xe.forEach(ot=>{Ue[ot.route.id]={type:hi.error,error:Ze}}),Ue}for(let[Ze,ot]of Object.entries(He))if(xX(ot)){let pt=ot.result;Ue[Ze]={type:hi.redirect,response:_X(pt,de,Ze,ke,L,q.v7_relativeSplatPath)}}else Ue[Ze]=await gX(ot);return Ue}async function bn(K,he,de,xe,ke){let ze=K.matches,He=Jt("loader",K,ke,de,he,null),Ue=Promise.all(xe.map(async pt=>{if(pt.matches&&pt.match&&pt.controller){let Ut=(await Jt("loader",K,Nf(e.history,pt.path,pt.controller.signal),[pt.match],pt.matches,pt.key))[pt.match.route.id];return{[pt.key]:Ut}}else return Promise.resolve({[pt.key]:{type:hi.error,error:Ia(404,{pathname:pt.path})}})})),Ze=await He,ot=(await Ue).reduce((pt,St)=>Object.assign(pt,St),{});return await Promise.all([SX(he,Ze,ke.signal,ze,K.loaderData),EX(he,ot,xe)]),{loaderResults:Ze,fetcherResults:ot}}function gn(){yt=!0,lt.push(...li()),At.forEach((K,he)=>{Ye.has(he)&&ct.add(he),nn(he)})}function Kn(K,he,de){de===void 0&&(de={}),pe.fetchers.set(K,he),Lr({fetchers:new Map(pe.fetchers)},{flushSync:(de&&de.flushSync)===!0})}function dn(K,he,de,xe){xe===void 0&&(xe={});let ke=Nh(pe.matches,he);Ui(K),Lr({errors:{[ke.route.id]:de},fetchers:new Map(pe.fetchers)},{flushSync:(xe&&xe.flushSync)===!0})}function di(K){return q.v7_fetcherPersist&&(Pt.set(K,(Pt.get(K)||0)+1),qt.has(K)&&qt.delete(K)),pe.fetchers.get(K)||sX}function Ui(K){let he=pe.fetchers.get(K);Ye.has(K)&&!(he&&he.state==="loading"&&ht.has(K))&&nn(K),At.delete(K),ht.delete(K),vt.delete(K),qt.delete(K),ct.delete(K),pe.fetchers.delete(K)}function Ji(K){if(q.v7_fetcherPersist){let he=(Pt.get(K)||0)-1;he<=0?(Pt.delete(K),qt.add(K)):Pt.set(K,he)}else Ui(K);Lr({fetchers:new Map(pe.fetchers)})}function nn(K){let he=Ye.get(K);he&&(he.abort(),Ye.delete(K))}function En(K){for(let he of K){let de=di(he),xe=vu(de.data);pe.fetchers.set(he,xe)}}function Jn(){let K=[],he=!1;for(let de of vt){let xe=pe.fetchers.get(de);Rn(xe,"Expected fetcher: "+de),xe.state==="loading"&&(vt.delete(de),K.push(de),he=!0)}return En(K),he}function zo(K){let he=[];for(let[de,xe]of ht)if(xe<K){let ke=pe.fetchers.get(de);Rn(ke,"Expected fetcher: "+de),ke.state==="loading"&&(nn(de),ht.delete(de),he.push(de))}return En(he),he.length>0}function _i(K,he){let de=pe.blockers.get(K)||Cg;return cr.get(K)!==he&&cr.set(K,he),de}function bi(K){pe.blockers.delete(K),cr.delete(K)}function gr(K,he){let de=pe.blockers.get(K)||Cg;Rn(de.state==="unblocked"&&he.state==="blocked"||de.state==="blocked"&&he.state==="blocked"||de.state==="blocked"&&he.state==="proceeding"||de.state==="blocked"&&he.state==="unblocked"||de.state==="proceeding"&&he.state==="unblocked","Invalid blocker state transition: "+de.state+" -> "+he.state);let xe=new Map(pe.blockers);xe.set(K,he),Lr({blockers:xe})}function Gi(K){let{currentLocation:he,nextLocation:de,historyAction:xe}=K;if(cr.size===0)return;cr.size>1&&od(!1,"A router only supports one blocker at a time");let ke=Array.from(cr.entries()),[ze,He]=ke[ke.length-1],Ue=pe.blockers.get(ze);if(!(Ue&&Ue.state==="proceeding")&&He({currentLocation:he,nextLocation:de,historyAction:xe}))return ze}function Lo(K){let he=Ia(404,{pathname:K}),de=i||T,{matches:xe,route:ke}=WP(de);return li(),{notFoundMatches:xe,route:ke,error:he}}function li(K){let he=[];return or.forEach((de,xe)=>{(!K||K(xe))&&(de.cancel(),he.push(xe),or.delete(xe))}),he}function Hi(K,he,de){if(ce=K,fe=he,ue=de||null,!re&&pe.navigation===E2){re=!0;let xe=Wi(pe.location,pe.matches);xe!=null&&Lr({restoreScrollPosition:xe})}return()=>{ce=null,fe=null,ue=null}}function fi(K,he){return ue&&ue(K,he.map(xe=>BZ(xe,pe.loaderData)))||K.key}function pi(K,he){if(ce&&fe){let de=fi(K,he);ce[de]=fe()}}function Wi(K,he){if(ce){let de=fi(K,he),xe=ce[de];if(typeof xe=="number")return xe}return null}function Bn(K,he,de){if(U)if(K){if(Object.keys(K[0].params).length>0)return{active:!0,matches:Fv(he,de,L,!0)}}else return{active:!0,matches:Fv(he,de,L,!0)||[]};return{active:!1,matches:null}}async function it(K,he,de){if(!U)return{type:"success",matches:K};let xe=K;for(;;){let ke=i==null,ze=i||T,He=x;try{await U({path:he,matches:xe,patch:(ot,pt)=>{de.aborted||jP(ot,pt,ze,He,d)}})}catch(ot){return{type:"error",error:ot,partialMatches:xe}}finally{ke&&!de.aborted&&(T=[...T])}if(de.aborted)return{type:"aborted"};let Ue=Bh(ze,he,L);if(Ue)return{type:"success",matches:Ue};let Ze=Fv(ze,he,L,!0);if(!Ze||xe.length===Ze.length&&xe.every((ot,pt)=>ot.route.id===Ze[pt].route.id))return{type:"success",matches:null};xe=Ze}}function te(K){x={},i=y1(K,d,void 0,x)}function le(K,he){let de=i==null;jP(K,he,i||T,x,d),de&&(T=[...T],Lr({}))}return Te={get basename(){return L},get future(){return q},get state(){return pe},get routes(){return T},get window(){return r},initialize:qr,subscribe:Ae,enableScrollRestoration:Hi,navigate:pn,fetch:Ln,revalidate:wt,createHref:K=>e.history.createHref(K),encodeLocation:K=>e.history.encodeLocation(K),getFetcher:di,deleteFetcher:Ji,dispose:yr,getBlocker:_i,deleteBlocker:bi,patchRoutes:le,_internalFetchControllers:Ye,_internalActiveDeferreds:or,_internalSetRoutes:te},Te}function uX(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function g3(e,r,a,c,d,x,T,i){let L,N;if(T){L=[];for(let q of r)if(L.push(q),q.route.id===T){N=q;break}}else L=r,N=r[r.length-1];let U=nT(d||".",rT(L,x),Bp(e.pathname,a)||e.pathname,i==="path");if(d==null&&(U.search=e.search,U.hash=e.hash),(d==null||d===""||d===".")&&N){let q=aT(U.search);if(N.route.index&&!q)U.search=U.search?U.search.replace(/^\?/,"?index&"):"?index";else if(!N.route.index&&q){let X=new URLSearchParams(U.search),se=X.getAll("index");X.delete("index"),se.filter(ue=>ue).forEach(ue=>X.append("index",ue));let ce=X.toString();U.search=ce?"?"+ce:""}}return c&&a!=="/"&&(U.pathname=U.pathname==="/"?a:wc([a,U.pathname])),ad(U)}function OP(e,r,a,c){if(!c||!uX(c))return{path:a};if(c.formMethod&&!wX(c.formMethod))return{path:a,error:Ia(405,{method:c.formMethod})};let d=()=>({path:a,error:Ia(400,{type:"invalid-body"})}),x=c.formMethod||"get",T=e?x.toUpperCase():x.toLowerCase(),i=ik(a);if(c.body!==void 0){if(c.formEncType==="text/plain"){if(!il(T))return d();let X=typeof c.body=="string"?c.body:c.body instanceof FormData||c.body instanceof URLSearchParams?Array.from(c.body.entries()).reduce((se,ce)=>{let[ue,fe]=ce;return""+se+ue+"="+fe+`
`},""):String(c.body);return{path:a,submission:{formMethod:T,formAction:i,formEncType:c.formEncType,formData:void 0,json:void 0,text:X}}}else if(c.formEncType==="application/json"){if(!il(T))return d();try{let X=typeof c.body=="string"?JSON.parse(c.body):c.body;return{path:a,submission:{formMethod:T,formAction:i,formEncType:c.formEncType,formData:void 0,json:X,text:void 0}}}catch{return d()}}}Rn(typeof FormData=="function","FormData is not available in this environment");let L,N;if(c.formData)L=y3(c.formData),N=c.formData;else if(c.body instanceof FormData)L=y3(c.body),N=c.body;else if(c.body instanceof URLSearchParams)L=c.body,N=VP(L);else if(c.body==null)L=new URLSearchParams,N=new FormData;else try{L=new URLSearchParams(c.body),N=VP(L)}catch{return d()}let U={formMethod:T,formAction:i,formEncType:c&&c.formEncType||"application/x-www-form-urlencoded",formData:N,json:void 0,text:void 0};if(il(U.formMethod))return{path:a,submission:U};let q=Vl(a);return r&&q.search&&aT(q.search)&&L.append("index",""),q.search="?"+L,{path:ad(q),submission:U}}function FP(e,r,a){a===void 0&&(a=!1);let c=e.findIndex(d=>d.route.id===r);return c>=0?e.slice(0,a?c+1:c):e}function BP(e,r,a,c,d,x,T,i,L,N,U,q,X,se,ce,ue){let fe=ue?Ya(ue[1])?ue[1].error:ue[1].data:void 0,re=e.createURL(r.location),ee=e.createURL(d),ae=a;x&&r.errors?ae=FP(a,Object.keys(r.errors)[0],!0):ue&&Ya(ue[1])&&(ae=FP(a,ue[0]));let ve=ue?ue[1].statusCode:void 0,Te=T&&ve&&ve>=400,pe=ae.filter((Ne,Xe)=>{let{route:Fe}=Ne;if(Fe.lazy)return!0;if(Fe.loader==null)return!1;if(x)return _3(Fe,r.loaderData,r.errors);if(hX(r.loaderData,r.matches[Xe],Ne)||L.some(ft=>ft===Ne.route.id))return!0;let Je=r.matches[Xe],Ct=Ne;return NP(Ne,Ai({currentUrl:re,currentParams:Je.params,nextUrl:ee,nextParams:Ct.params},c,{actionResult:fe,actionStatus:ve,defaultShouldRevalidate:Te?!1:i||re.pathname+re.search===ee.pathname+ee.search||re.search!==ee.search||rk(Je,Ct)}))}),Ee=[];return q.forEach((Ne,Xe)=>{if(x||!a.some(yt=>yt.route.id===Ne.routeId)||U.has(Xe))return;let Fe=Bh(se,Ne.path,ce);if(!Fe){Ee.push({key:Xe,routeId:Ne.routeId,path:Ne.path,matches:null,match:null,controller:null});return}let Je=r.fetchers.get(Xe),Ct=Dg(Fe,Ne.path),ft=!1;X.has(Xe)?ft=!1:N.has(Xe)?(N.delete(Xe),ft=!0):Je&&Je.state!=="idle"&&Je.data===void 0?ft=i:ft=NP(Ct,Ai({currentUrl:re,currentParams:r.matches[r.matches.length-1].params,nextUrl:ee,nextParams:a[a.length-1].params},c,{actionResult:fe,actionStatus:ve,defaultShouldRevalidate:Te?!1:i})),ft&&Ee.push({key:Xe,routeId:Ne.routeId,path:Ne.path,matches:Fe,match:Ct,controller:new AbortController})}),[pe,Ee]}function _3(e,r,a){if(e.lazy)return!0;if(!e.loader)return!1;let c=r!=null&&r[e.id]!==void 0,d=a!=null&&a[e.id]!==void 0;return!c&&d?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!c&&!d}function hX(e,r,a){let c=!r||a.route.id!==r.route.id,d=e[a.route.id]===void 0;return c||d}function rk(e,r){let a=e.route.path;return e.pathname!==r.pathname||a!=null&&a.endsWith("*")&&e.params["*"]!==r.params["*"]}function NP(e,r){if(e.route.shouldRevalidate){let a=e.route.shouldRevalidate(r);if(typeof a=="boolean")return a}return r.defaultShouldRevalidate}function jP(e,r,a,c,d){var x;let T;if(e){let N=c[e];Rn(N,"No route found to patch children into: routeId = "+e),N.children||(N.children=[]),T=N.children}else T=a;let i=r.filter(N=>!T.some(U=>nk(N,U))),L=y1(i,d,[e||"_","patch",String(((x=T)==null?void 0:x.length)||"0")],c);T.push(...L)}function nk(e,r){return"id"in e&&"id"in r&&e.id===r.id?!0:e.index===r.index&&e.path===r.path&&e.caseSensitive===r.caseSensitive?(!e.children||e.children.length===0)&&(!r.children||r.children.length===0)?!0:e.children.every((a,c)=>{var d;return(d=r.children)==null?void 0:d.some(x=>nk(a,x))}):!1}async function dX(e,r,a){if(!e.lazy)return;let c=await e.lazy();if(!e.lazy)return;let d=a[e.id];Rn(d,"No route found in manifest");let x={};for(let T in c){let L=d[T]!==void 0&&T!=="hasErrorBoundary";od(!L,'Route "'+d.id+'" has a static property "'+T+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+T+'" will be ignored.')),!L&&!OZ.has(T)&&(x[T]=c[T])}Object.assign(d,x),Object.assign(d,Ai({},r(d),{lazy:void 0}))}async function fX(e){let{matches:r}=e,a=r.filter(d=>d.shouldLoad);return(await Promise.all(a.map(d=>d.resolve()))).reduce((d,x,T)=>Object.assign(d,{[a[T].route.id]:x}),{})}async function pX(e,r,a,c,d,x,T,i,L,N){let U=x.map(se=>se.route.lazy?dX(se.route,L,i):void 0),q=x.map((se,ce)=>{let ue=U[ce],fe=d.some(ee=>ee.route.id===se.route.id);return Ai({},se,{shouldLoad:fe,resolve:async ee=>(ee&&c.method==="GET"&&(se.route.lazy||se.route.loader)&&(fe=!0),fe?mX(r,c,se,ue,ee,N):Promise.resolve({type:hi.data,result:void 0}))})}),X=await e({matches:q,request:c,params:x[0].params,fetcherKey:T,context:N});try{await Promise.all(U)}catch{}return X}async function mX(e,r,a,c,d,x){let T,i,L=N=>{let U,q=new Promise((ce,ue)=>U=ue);i=()=>U(),r.signal.addEventListener("abort",i);let X=ce=>typeof N!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+e+'" [routeId: '+a.route.id+"]"))):N({request:r,params:a.params,context:x},...ce!==void 0?[ce]:[]),se=(async()=>{try{return{type:"data",result:await(d?d(ue=>X(ue)):X())}}catch(ce){return{type:"error",result:ce}}})();return Promise.race([se,q])};try{let N=a.route[e];if(c)if(N){let U,[q]=await Promise.all([L(N).catch(X=>{U=X}),c]);if(U!==void 0)throw U;T=q}else if(await c,N=a.route[e],N)T=await L(N);else if(e==="action"){let U=new URL(r.url),q=U.pathname+U.search;throw Ia(405,{method:r.method,pathname:q,routeId:a.route.id})}else return{type:hi.data,result:void 0};else if(N)T=await L(N);else{let U=new URL(r.url),q=U.pathname+U.search;throw Ia(404,{pathname:q})}Rn(T.result!==void 0,"You defined "+(e==="action"?"an action":"a loader")+" for route "+('"'+a.route.id+"\" but didn't return anything from your `"+e+"` ")+"function. Please return a value or `null`.")}catch(N){return{type:hi.error,result:N}}finally{i&&r.signal.removeEventListener("abort",i)}return T}async function gX(e){let{result:r,type:a}=e;if(ok(r)){let N;try{let U=r.headers.get("Content-Type");U&&/\bapplication\/json\b/.test(U)?r.body==null?N=null:N=await r.json():N=await r.text()}catch(U){return{type:hi.error,error:U}}return a===hi.error?{type:hi.error,error:new v1(r.status,r.statusText,N),statusCode:r.status,headers:r.headers}:{type:hi.data,data:N,statusCode:r.status,headers:r.headers}}if(a===hi.error){if(qP(r)){var c;if(r.data instanceof Error){var d;return{type:hi.error,error:r.data,statusCode:(d=r.init)==null?void 0:d.status}}r=new v1(((c=r.init)==null?void 0:c.status)||500,void 0,r.data)}return{type:hi.error,error:r,statusCode:vx(r)?r.status:void 0}}if(bX(r)){var x,T;return{type:hi.deferred,deferredData:r,statusCode:(x=r.init)==null?void 0:x.status,headers:((T=r.init)==null?void 0:T.headers)&&new Headers(r.init.headers)}}if(qP(r)){var i,L;return{type:hi.data,data:r.data,statusCode:(i=r.init)==null?void 0:i.status,headers:(L=r.init)!=null&&L.headers?new Headers(r.init.headers):void 0}}return{type:hi.data,data:r}}function _X(e,r,a,c,d,x){let T=e.headers.get("Location");if(Rn(T,"Redirects returned/thrown from loaders/actions must have a Location header"),!iT.test(T)){let i=c.slice(0,c.findIndex(L=>L.route.id===a)+1);T=g3(new URL(r.url),i,d,!0,T,x),e.headers.set("Location",T)}return e}function $P(e,r,a){if(iT.test(e)){let c=e,d=c.startsWith("//")?new URL(r.protocol+c):new URL(c),x=Bp(d.pathname,a)!=null;if(d.origin===r.origin&&x)return d.pathname+d.search+d.hash}return e}function Nf(e,r,a,c){let d=e.createURL(ik(r)).toString(),x={signal:a};if(c&&il(c.formMethod)){let{formMethod:T,formEncType:i}=c;x.method=T.toUpperCase(),i==="application/json"?(x.headers=new Headers({"Content-Type":i}),x.body=JSON.stringify(c.json)):i==="text/plain"?x.body=c.text:i==="application/x-www-form-urlencoded"&&c.formData?x.body=y3(c.formData):x.body=c.formData}return new Request(d,x)}function y3(e){let r=new URLSearchParams;for(let[a,c]of e.entries())r.append(a,typeof c=="string"?c:c.name);return r}function VP(e){let r=new FormData;for(let[a,c]of e.entries())r.append(a,c);return r}function yX(e,r,a,c,d){let x={},T=null,i,L=!1,N={},U=a&&Ya(a[1])?a[1].error:void 0;return e.forEach(q=>{if(!(q.route.id in r))return;let X=q.route.id,se=r[X];if(Rn(!Hh(se),"Cannot handle redirect results in processLoaderData"),Ya(se)){let ce=se.error;if(U!==void 0&&(ce=U,U=void 0),T=T||{},d)T[X]=ce;else{let ue=Nh(e,X);T[ue.route.id]==null&&(T[ue.route.id]=ce)}x[X]=void 0,L||(L=!0,i=vx(se.error)?se.error.status:500),se.headers&&(N[X]=se.headers)}else Au(se)?(c.set(X,se.deferredData),x[X]=se.deferredData.data,se.statusCode!=null&&se.statusCode!==200&&!L&&(i=se.statusCode),se.headers&&(N[X]=se.headers)):(x[X]=se.data,se.statusCode&&se.statusCode!==200&&!L&&(i=se.statusCode),se.headers&&(N[X]=se.headers))}),U!==void 0&&a&&(T={[a[0]]:U},x[a[0]]=void 0),{loaderData:x,errors:T,statusCode:i||200,loaderHeaders:N}}function UP(e,r,a,c,d,x,T){let{loaderData:i,errors:L}=yX(r,a,c,T,!1);return d.forEach(N=>{let{key:U,match:q,controller:X}=N,se=x[U];if(Rn(se,"Did not find corresponding fetcher result"),!(X&&X.signal.aborted))if(Ya(se)){let ce=Nh(e.matches,q==null?void 0:q.route.id);L&&L[ce.route.id]||(L=Ai({},L,{[ce.route.id]:se.error})),e.fetchers.delete(U)}else if(Hh(se))Rn(!1,"Unhandled fetcher revalidation redirect");else if(Au(se))Rn(!1,"Unhandled fetcher deferred data");else{let ce=vu(se.data);e.fetchers.set(U,ce)}}),{loaderData:i,errors:L}}function GP(e,r,a,c){let d=Ai({},r);for(let x of a){let T=x.route.id;if(r.hasOwnProperty(T)?r[T]!==void 0&&(d[T]=r[T]):e[T]!==void 0&&x.route.loader&&(d[T]=e[T]),c&&c.hasOwnProperty(T))break}return d}function HP(e){return e?Ya(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function Nh(e,r){return(r?e.slice(0,e.findIndex(c=>c.route.id===r)+1):[...e]).reverse().find(c=>c.route.hasErrorBoundary===!0)||e[0]}function WP(e){let r=e.length===1?e[0]:e.find(a=>a.index||!a.path||a.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:r}],route:r}}function Ia(e,r){let{pathname:a,routeId:c,method:d,type:x,message:T}=r===void 0?{}:r,i="Unknown Server Error",L="Unknown @remix-run/router error";return e===400?(i="Bad Request",d&&a&&c?L="You made a "+d+' request to "'+a+'" but '+('did not provide a `loader` for route "'+c+'", ')+"so there is no way to handle the request.":x==="defer-action"?L="defer() is not supported in actions":x==="invalid-body"&&(L="Unable to encode submission body")):e===403?(i="Forbidden",L='Route "'+c+'" does not match URL "'+a+'"'):e===404?(i="Not Found",L='No route matches URL "'+a+'"'):e===405&&(i="Method Not Allowed",d&&a&&c?L="You made a "+d.toUpperCase()+' request to "'+a+'" but '+('did not provide an `action` for route "'+c+'", ')+"so there is no way to handle the request.":d&&(L='Invalid request method "'+d.toUpperCase()+'"')),new v1(e||500,i,new Error(L),!0)}function mv(e){let r=Object.entries(e);for(let a=r.length-1;a>=0;a--){let[c,d]=r[a];if(Hh(d))return{key:c,result:d}}}function ik(e){let r=typeof e=="string"?Vl(e):e;return ad(Ai({},r,{hash:""}))}function vX(e,r){return e.pathname!==r.pathname||e.search!==r.search?!1:e.hash===""?r.hash!=="":e.hash===r.hash?!0:r.hash!==""}function xX(e){return ok(e.result)&&oX.has(e.result.status)}function Au(e){return e.type===hi.deferred}function Ya(e){return e.type===hi.error}function Hh(e){return(e&&e.type)===hi.redirect}function qP(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function bX(e){let r=e;return r&&typeof r=="object"&&typeof r.data=="object"&&typeof r.subscribe=="function"&&typeof r.cancel=="function"&&typeof r.resolveData=="function"}function ok(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function wX(e){return iX.has(e.toLowerCase())}function il(e){return rX.has(e.toLowerCase())}async function SX(e,r,a,c,d){let x=Object.entries(r);for(let T=0;T<x.length;T++){let[i,L]=x[T],N=e.find(X=>(X==null?void 0:X.route.id)===i);if(!N)continue;let U=c.find(X=>X.route.id===N.route.id),q=U!=null&&!rk(U,N)&&(d&&d[N.route.id])!==void 0;Au(L)&&q&&await oT(L,a,!1).then(X=>{X&&(r[i]=X)})}}async function EX(e,r,a){for(let c=0;c<a.length;c++){let{key:d,routeId:x,controller:T}=a[c],i=r[d];e.find(N=>(N==null?void 0:N.route.id)===x)&&Au(i)&&(Rn(T,"Expected an AbortController for revalidating fetcher deferred result"),await oT(i,T.signal,!0).then(N=>{N&&(r[d]=N)}))}}async function oT(e,r,a){if(a===void 0&&(a=!1),!await e.deferredData.resolveData(r)){if(a)try{return{type:hi.data,data:e.deferredData.unwrappedData}}catch(d){return{type:hi.error,error:d}}return{type:hi.data,data:e.deferredData.data}}}function aT(e){return new URLSearchParams(e).getAll("index").some(r=>r==="")}function Dg(e,r){let a=typeof r=="string"?Vl(r).search:r.search;if(e[e.length-1].route.index&&aT(a||""))return e[e.length-1];let c=Q6(e);return c[c.length-1]}function ZP(e){let{formMethod:r,formAction:a,formEncType:c,text:d,formData:x,json:T}=e;if(!(!r||!a||!c)){if(d!=null)return{formMethod:r,formAction:a,formEncType:c,formData:void 0,json:void 0,text:d};if(x!=null)return{formMethod:r,formAction:a,formEncType:c,formData:x,json:void 0,text:void 0};if(T!==void 0)return{formMethod:r,formAction:a,formEncType:c,formData:void 0,json:T,text:void 0}}}function T2(e,r){return r?{state:"loading",location:e,formMethod:r.formMethod,formAction:r.formAction,formEncType:r.formEncType,formData:r.formData,json:r.json,text:r.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function TX(e,r){return{state:"submitting",location:e,formMethod:r.formMethod,formAction:r.formAction,formEncType:r.formEncType,formData:r.formData,json:r.json,text:r.text}}function Mg(e,r){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:r}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:r}}function CX(e,r){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:r?r.data:void 0}}function vu(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function MX(e,r){try{let a=e.sessionStorage.getItem(tk);if(a){let c=JSON.parse(a);for(let[d,x]of Object.entries(c||{}))x&&Array.isArray(x)&&r.set(d,new Set(x||[]))}}catch{}}function IX(e,r){if(r.size>0){let a={};for(let[c,d]of r)a[c]=[...d];try{e.sessionStorage.setItem(tk,JSON.stringify(a))}catch(c){od(!1,"Failed to save applied view transitions in sessionStorage ("+c+").")}}}/**
 * React Router v6.28.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function M_(){return M_=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(e[c]=a[c])}return e},M_.apply(this,arguments)}const xx=$.createContext(null),ak=$.createContext(null),fd=$.createContext(null),bx=$.createContext(null),qu=$.createContext({outlet:null,matches:[],isDataRoute:!1}),sk=$.createContext(null);function PX(e,r){let{relative:a}=r===void 0?{}:r;q_()||Rn(!1);let{basename:c,navigator:d}=$.useContext(fd),{hash:x,pathname:T,search:i}=ck(e,{relative:a}),L=T;return c!=="/"&&(L=T==="/"?c:wc([c,T])),d.createHref({pathname:L,search:i,hash:x})}function q_(){return $.useContext(bx)!=null}function wx(){return q_()||Rn(!1),$.useContext(bx).location}function lk(e){$.useContext(fd).static||$.useLayoutEffect(e)}function sT(){let{isDataRoute:e}=$.useContext(qu);return e?VX():AX()}function AX(){q_()||Rn(!1);let e=$.useContext(xx),{basename:r,future:a,navigator:c}=$.useContext(fd),{matches:d}=$.useContext(qu),{pathname:x}=wx(),T=JSON.stringify(rT(d,a.v7_relativeSplatPath)),i=$.useRef(!1);return lk(()=>{i.current=!0}),$.useCallback(function(N,U){if(U===void 0&&(U={}),!i.current)return;if(typeof N=="number"){c.go(N);return}let q=nT(N,JSON.parse(T),x,U.relative==="path");e==null&&r!=="/"&&(q.pathname=q.pathname==="/"?r:wc([r,q.pathname])),(U.replace?c.replace:c.push)(q,U.state,U)},[r,c,T,x,e])}const RX=$.createContext(null);function zX(e){let r=$.useContext(qu).outlet;return r&&$.createElement(RX.Provider,{value:e},r)}function ck(e,r){let{relative:a}=r===void 0?{}:r,{future:c}=$.useContext(fd),{matches:d}=$.useContext(qu),{pathname:x}=wx(),T=JSON.stringify(rT(d,c.v7_relativeSplatPath));return $.useMemo(()=>nT(e,JSON.parse(T),x,a==="path"),[e,T,x,a])}function LX(e,r,a,c){q_()||Rn(!1);let{navigator:d}=$.useContext(fd),{matches:x}=$.useContext(qu),T=x[x.length-1],i=T?T.params:{};T&&T.pathname;let L=T?T.pathnameBase:"/";T&&T.route;let N=wx(),U;if(r){var q;let fe=typeof r=="string"?Vl(r):r;L==="/"||(q=fe.pathname)!=null&&q.startsWith(L)||Rn(!1),U=fe}else U=N;let X=U.pathname||"/",se=X;if(L!=="/"){let fe=L.replace(/^\//,"").split("/");se="/"+X.replace(/^\//,"").split("/").slice(fe.length).join("/")}let ce=Bh(e,{pathname:se}),ue=BX(ce&&ce.map(fe=>Object.assign({},fe,{params:Object.assign({},i,fe.params),pathname:wc([L,d.encodeLocation?d.encodeLocation(fe.pathname).pathname:fe.pathname]),pathnameBase:fe.pathnameBase==="/"?L:wc([L,d.encodeLocation?d.encodeLocation(fe.pathnameBase).pathname:fe.pathnameBase])})),x,a,c);return r&&ue?$.createElement(bx.Provider,{value:{location:M_({pathname:"/",search:"",hash:"",state:null,key:"default"},U),navigationType:Yi.Pop}},ue):ue}function kX(){let e=dk(),r=vx(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),a=e instanceof Error?e.stack:null,d={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},x=null;return $.createElement($.Fragment,null,$.createElement("h2",null,"Unexpected Application Error!"),$.createElement("h3",{style:{fontStyle:"italic"}},r),a?$.createElement("pre",{style:d},a):null,x)}const DX=$.createElement(kX,null);class OX extends $.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,a){return a.location!==r.location||a.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:a.error,location:a.location,revalidation:r.revalidation||a.revalidation}}componentDidCatch(r,a){console.error("React Router caught the following error during render",r,a)}render(){return this.state.error!==void 0?$.createElement(qu.Provider,{value:this.props.routeContext},$.createElement(sk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function FX(e){let{routeContext:r,match:a,children:c}=e,d=$.useContext(xx);return d&&d.static&&d.staticContext&&(a.route.errorElement||a.route.ErrorBoundary)&&(d.staticContext._deepestRenderedBoundaryId=a.route.id),$.createElement(qu.Provider,{value:r},c)}function BX(e,r,a,c){var d;if(r===void 0&&(r=[]),a===void 0&&(a=null),c===void 0&&(c=null),e==null){var x;if(!a)return null;if(a.errors)e=a.matches;else if((x=c)!=null&&x.v7_partialHydration&&r.length===0&&!a.initialized&&a.matches.length>0)e=a.matches;else return null}let T=e,i=(d=a)==null?void 0:d.errors;if(i!=null){let U=T.findIndex(q=>q.route.id&&(i==null?void 0:i[q.route.id])!==void 0);U>=0||Rn(!1),T=T.slice(0,Math.min(T.length,U+1))}let L=!1,N=-1;if(a&&c&&c.v7_partialHydration)for(let U=0;U<T.length;U++){let q=T[U];if((q.route.HydrateFallback||q.route.hydrateFallbackElement)&&(N=U),q.route.id){let{loaderData:X,errors:se}=a,ce=q.route.loader&&X[q.route.id]===void 0&&(!se||se[q.route.id]===void 0);if(q.route.lazy||ce){L=!0,N>=0?T=T.slice(0,N+1):T=[T[0]];break}}}return T.reduceRight((U,q,X)=>{let se,ce=!1,ue=null,fe=null;a&&(se=i&&q.route.id?i[q.route.id]:void 0,ue=q.route.errorElement||DX,L&&(N<0&&X===0?(UX("route-fallback",!1),ce=!0,fe=null):N===X&&(ce=!0,fe=q.route.hydrateFallbackElement||null)));let re=r.concat(T.slice(0,X+1)),ee=()=>{let ae;return se?ae=ue:ce?ae=fe:q.route.Component?ae=$.createElement(q.route.Component,null):q.route.element?ae=q.route.element:ae=U,$.createElement(FX,{match:q,routeContext:{outlet:U,matches:re,isDataRoute:a!=null},children:ae})};return a&&(q.route.ErrorBoundary||q.route.errorElement||X===0)?$.createElement(OX,{location:a.location,revalidation:a.revalidation,component:ue,error:se,children:ee(),routeContext:{outlet:null,matches:re,isDataRoute:!0}}):ee()},null)}var uk=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(uk||{}),x1=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(x1||{});function NX(e){let r=$.useContext(xx);return r||Rn(!1),r}function jX(e){let r=$.useContext(ak);return r||Rn(!1),r}function $X(e){let r=$.useContext(qu);return r||Rn(!1),r}function hk(e){let r=$X(),a=r.matches[r.matches.length-1];return a.route.id||Rn(!1),a.route.id}function dk(){var e;let r=$.useContext(sk),a=jX(x1.UseRouteError),c=hk(x1.UseRouteError);return r!==void 0?r:(e=a.errors)==null?void 0:e[c]}function VX(){let{router:e}=NX(uk.UseNavigateStable),r=hk(x1.UseNavigateStable),a=$.useRef(!1);return lk(()=>{a.current=!0}),$.useCallback(function(d,x){x===void 0&&(x={}),a.current&&(typeof d=="number"?e.navigate(d):e.navigate(d,M_({fromRouteId:r},x)))},[e,r])}const XP={};function UX(e,r,a){!r&&!XP[e]&&(XP[e]=!0)}const YP={};function GX(e,r){YP[r]||(YP[r]=!0,console.warn(r))}const jf=(e,r,a)=>GX(e,"⚠️ React Router Future Flag Warning: "+r+". "+("You can use the `"+e+"` future flag to opt-in early. ")+("For more information, see "+a+"."));function HX(e,r){(e==null?void 0:e.v7_startTransition)===void 0&&jf("v7_startTransition","React Router will begin wrapping state updates in `React.startTransition` in v7","https://reactrouter.com/v6/upgrading/future#v7_starttransition"),(e==null?void 0:e.v7_relativeSplatPath)===void 0&&(!r||!r.v7_relativeSplatPath)&&jf("v7_relativeSplatPath","Relative route resolution within Splat routes is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_relativesplatpath"),r&&(r.v7_fetcherPersist===void 0&&jf("v7_fetcherPersist","The persistence behavior of fetchers is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_fetcherpersist"),r.v7_normalizeFormMethod===void 0&&jf("v7_normalizeFormMethod","Casing of `formMethod` fields is being normalized to uppercase in v7","https://reactrouter.com/v6/upgrading/future#v7_normalizeformmethod"),r.v7_partialHydration===void 0&&jf("v7_partialHydration","`RouterProvider` hydration behavior is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_partialhydration"),r.v7_skipActionErrorRevalidation===void 0&&jf("v7_skipActionErrorRevalidation","The revalidation behavior after 4xx/5xx `action` responses is changing in v7","https://reactrouter.com/v6/upgrading/future#v7_skipactionerrorrevalidation"))}function WX(e){return zX(e.context)}function qX(e){let{basename:r="/",children:a=null,location:c,navigationType:d=Yi.Pop,navigator:x,static:T=!1,future:i}=e;q_()&&Rn(!1);let L=r.replace(/^\/*/,"/"),N=$.useMemo(()=>({basename:L,navigator:x,static:T,future:M_({v7_relativeSplatPath:!1},i)}),[L,i,x,T]);typeof c=="string"&&(c=Vl(c));let{pathname:U="/",search:q="",hash:X="",state:se=null,key:ce="default"}=c,ue=$.useMemo(()=>{let fe=Bp(U,L);return fe==null?null:{location:{pathname:fe,search:q,hash:X,state:se,key:ce},navigationType:d}},[L,U,q,X,se,ce,d]);return ue==null?null:$.createElement(fd.Provider,{value:N},$.createElement(bx.Provider,{children:a,value:ue}))}new Promise(()=>{});function ZX(e){let r={hasErrorBoundary:e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&Object.assign(r,{element:$.createElement(e.Component),Component:void 0}),e.HydrateFallback&&Object.assign(r,{hydrateFallbackElement:$.createElement(e.HydrateFallback),HydrateFallback:void 0}),e.ErrorBoundary&&Object.assign(r,{errorElement:$.createElement(e.ErrorBoundary),ErrorBoundary:void 0}),r}/**
 * React Router DOM v6.28.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function I_(){return I_=Object.assign?Object.assign.bind():function(e){for(var r=1;r<arguments.length;r++){var a=arguments[r];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&(e[c]=a[c])}return e},I_.apply(this,arguments)}function XX(e,r){if(e==null)return{};var a={},c=Object.keys(e),d,x;for(x=0;x<c.length;x++)d=c[x],!(r.indexOf(d)>=0)&&(a[d]=e[d]);return a}function YX(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function KX(e,r){return e.button===0&&(!r||r==="_self")&&!YX(e)}const JX=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],QX="6";try{window.__reactRouterVersion=QX}catch{}function eY(e,r){return cX({basename:r==null?void 0:r.basename,future:I_({},r==null?void 0:r.future,{v7_prependBasename:!0}),history:LZ({window:r==null?void 0:r.window}),hydrationData:(r==null?void 0:r.hydrationData)||tY(),routes:e,mapRouteProperties:ZX,dataStrategy:r==null?void 0:r.dataStrategy,patchRoutesOnNavigation:r==null?void 0:r.patchRoutesOnNavigation,window:r==null?void 0:r.window}).initialize()}function tY(){var e;let r=(e=window)==null?void 0:e.__staticRouterHydrationData;return r&&r.errors&&(r=I_({},r,{errors:rY(r.errors)})),r}function rY(e){if(!e)return null;let r=Object.entries(e),a={};for(let[c,d]of r)if(d&&d.__type==="RouteErrorResponse")a[c]=new v1(d.status,d.statusText,d.data,d.internal===!0);else if(d&&d.__type==="Error"){if(d.__subType){let x=window[d.__subType];if(typeof x=="function")try{let T=new x(d.message);T.stack="",a[c]=T}catch{}}if(a[c]==null){let x=new Error(d.message);x.stack="",a[c]=x}}else a[c]=d;return a}const nY=$.createContext({isTransitioning:!1}),iY=$.createContext(new Map),oY="startTransition",KP=R_[oY],aY="flushSync",JP=Ez[aY];function sY(e){KP?KP(e):e()}function Ig(e){JP?JP(e):e()}class lY{constructor(){this.status="pending",this.promise=new Promise((r,a)=>{this.resolve=c=>{this.status==="pending"&&(this.status="resolved",r(c))},this.reject=c=>{this.status==="pending"&&(this.status="rejected",a(c))}})}}function cY(e){let{fallbackElement:r,router:a,future:c}=e,[d,x]=$.useState(a.state),[T,i]=$.useState(),[L,N]=$.useState({isTransitioning:!1}),[U,q]=$.useState(),[X,se]=$.useState(),[ce,ue]=$.useState(),fe=$.useRef(new Map),{v7_startTransition:re}=c||{},ee=$.useCallback(Ne=>{re?sY(Ne):Ne()},[re]),ae=$.useCallback((Ne,Xe)=>{let{deletedFetchers:Fe,flushSync:Je,viewTransitionOpts:Ct}=Xe;Fe.forEach(yt=>fe.current.delete(yt)),Ne.fetchers.forEach((yt,lt)=>{yt.data!==void 0&&fe.current.set(lt,yt.data)});let ft=a.window==null||a.window.document==null||typeof a.window.document.startViewTransition!="function";if(!Ct||ft){Je?Ig(()=>x(Ne)):ee(()=>x(Ne));return}if(Je){Ig(()=>{X&&(U&&U.resolve(),X.skipTransition()),N({isTransitioning:!0,flushSync:!0,currentLocation:Ct.currentLocation,nextLocation:Ct.nextLocation})});let yt=a.window.document.startViewTransition(()=>{Ig(()=>x(Ne))});yt.finished.finally(()=>{Ig(()=>{q(void 0),se(void 0),i(void 0),N({isTransitioning:!1})})}),Ig(()=>se(yt));return}X?(U&&U.resolve(),X.skipTransition(),ue({state:Ne,currentLocation:Ct.currentLocation,nextLocation:Ct.nextLocation})):(i(Ne),N({isTransitioning:!0,flushSync:!1,currentLocation:Ct.currentLocation,nextLocation:Ct.nextLocation}))},[a.window,X,U,fe,ee]);$.useLayoutEffect(()=>a.subscribe(ae),[a,ae]),$.useEffect(()=>{L.isTransitioning&&!L.flushSync&&q(new lY)},[L]),$.useEffect(()=>{if(U&&T&&a.window){let Ne=T,Xe=U.promise,Fe=a.window.document.startViewTransition(async()=>{ee(()=>x(Ne)),await Xe});Fe.finished.finally(()=>{q(void 0),se(void 0),i(void 0),N({isTransitioning:!1})}),se(Fe)}},[ee,T,U,a.window]),$.useEffect(()=>{U&&T&&d.location.key===T.location.key&&U.resolve()},[U,X,d.location,T]),$.useEffect(()=>{!L.isTransitioning&&ce&&(i(ce.state),N({isTransitioning:!0,flushSync:!1,currentLocation:ce.currentLocation,nextLocation:ce.nextLocation}),ue(void 0))},[L.isTransitioning,ce]),$.useEffect(()=>{},[]);let ve=$.useMemo(()=>({createHref:a.createHref,encodeLocation:a.encodeLocation,go:Ne=>a.navigate(Ne),push:(Ne,Xe,Fe)=>a.navigate(Ne,{state:Xe,preventScrollReset:Fe==null?void 0:Fe.preventScrollReset}),replace:(Ne,Xe,Fe)=>a.navigate(Ne,{replace:!0,state:Xe,preventScrollReset:Fe==null?void 0:Fe.preventScrollReset})}),[a]),Te=a.basename||"/",pe=$.useMemo(()=>({router:a,navigator:ve,static:!1,basename:Te}),[a,ve,Te]),Ee=$.useMemo(()=>({v7_relativeSplatPath:a.future.v7_relativeSplatPath}),[a.future.v7_relativeSplatPath]);return $.useEffect(()=>HX(c,a.future),[c,a.future]),$.createElement($.Fragment,null,$.createElement(xx.Provider,{value:pe},$.createElement(ak.Provider,{value:d},$.createElement(iY.Provider,{value:fe.current},$.createElement(nY.Provider,{value:L},$.createElement(qX,{basename:Te,location:d.location,navigationType:d.historyAction,navigator:ve,future:Ee},d.initialized||a.future.v7_partialHydration?$.createElement(uY,{routes:a.routes,future:a.future,state:d}):r))))),null)}const uY=$.memo(hY);function hY(e){let{routes:r,future:a,state:c}=e;return LX(r,void 0,c,a)}const dY=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",fY=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,pY=$.forwardRef(function(r,a){let{onClick:c,relative:d,reloadDocument:x,replace:T,state:i,target:L,to:N,preventScrollReset:U,viewTransition:q}=r,X=XX(r,JX),{basename:se}=$.useContext(fd),ce,ue=!1;if(typeof N=="string"&&fY.test(N)&&(ce=N,dY))try{let ae=new URL(window.location.href),ve=N.startsWith("//")?new URL(ae.protocol+N):new URL(N),Te=Bp(ve.pathname,se);ve.origin===ae.origin&&Te!=null?N=Te+ve.search+ve.hash:ue=!0}catch{}let fe=PX(N,{relative:d}),re=mY(N,{replace:T,state:i,target:L,preventScrollReset:U,relative:d,viewTransition:q});function ee(ae){c&&c(ae),ae.defaultPrevented||re(ae)}return $.createElement("a",I_({},X,{href:ce||fe,onClick:ue||x?c:ee,ref:a,target:L}))});var QP;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(QP||(QP={}));var eA;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(eA||(eA={}));function mY(e,r){let{target:a,replace:c,state:d,preventScrollReset:x,relative:T,viewTransition:i}=r===void 0?{}:r,L=sT(),N=wx(),U=ck(e,{relative:T});return $.useCallback(q=>{if(KX(q,a)){q.preventDefault();let X=c!==void 0?c:ad(N)===ad(U);L(e,{replace:X,state:d,preventScrollReset:x,relative:T,viewTransition:i})}},[N,L,U,c,d,a,e,x,T,i])}const gY=()=>Wt.jsx("div",{className:"w-full h-full fixed bg-[#2c3e50] flex flex-col justify-center",children:Wt.jsxs("div",{className:"container mx-auto",children:[Wt.jsx("div",{className:"spinner h-10 text-center text-sm mx-auto mt-5 mb-3",children:new Array(5).fill("").map((e,r)=>Wt.jsx("div",{style:{animation:"stretchdelay 1.2s infinite ease-in-out",animationDelay:`${-1.1+r*.1}s`},className:"bg-[#647eff] h-full w-[6px] inline-block mr-[3px]"},r))}),Wt.jsx("div",{style:{WebkitTextFillColor:"transparent"},className:"text-center text-lg bg-clip-text bg-gradient-to-r from-[#42d392] to-[#647eff] font-bold",children:"数据加载中"}),Wt.jsxs("div",{className:"py-12",children:[Wt.jsx(sP,{active:!0}),Wt.jsx(sP,{active:!0})]})]})});function _Y(){const e=sT(),r=dk();return console.error(r),Wt.jsx(j6,{status:"500",title:"500",subTitle:"对不起，服务器发生了错误。",extra:Wt.jsx(np,{type:"primary",onClick:()=>e("/"),children:"返回首页"})})}const yY=()=>{const e=sT();return Wt.jsx(j6,{status:"404",title:"404",subTitle:"对不起，您访问的页面不存在。",extra:Wt.jsx(np,{type:"primary",onClick:()=>e("/"),children:"返回首页"})})};var fk={exports:{}};(function(e,r){(function(a,c){e.exports=c()})(yF,function(){var a,c,d;function x(i,L){if(!a)a=L;else if(!c)c=L;else{var N="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+a+")(sharedChunk); ("+c+")(sharedChunk); self.onerror = null;",U={};a(U),d=L(U),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([N],{type:"text/javascript"})))}}x(["exports"],function(i){function L(l){return l&&l.__esModule&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l}var N,U={},q={};function X(){if(N)return q;N=1,Object.defineProperty(q,"__esModule",{value:!0}),q.setMatrixArrayType=function(m){q.ARRAY_TYPE=t=m},q.toRadian=function(m){return m*u},q.equals=function(m,h){return Math.abs(m-h)<=l*Math.max(1,Math.abs(m),Math.abs(h))},q.RANDOM=q.ARRAY_TYPE=q.EPSILON=void 0;var l=1e-6;q.EPSILON=l;var t=typeof Float32Array<"u"?Float32Array:Array;q.ARRAY_TYPE=t;var o=Math.random;q.RANDOM=o;var u=Math.PI/180;return Math.hypot||(Math.hypot=function(){for(var m=0,h=arguments.length;h--;)m+=arguments[h]*arguments[h];return Math.sqrt(m)}),q}var se,ce={};function ue(){if(se)return ce;function l(h){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},l(h)}se=1,Object.defineProperty(ce,"__esModule",{value:!0}),ce.create=function(){var h=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0),h[0]=1,h[3]=1,h},ce.clone=function(h){var g=new t.ARRAY_TYPE(4);return g[0]=h[0],g[1]=h[1],g[2]=h[2],g[3]=h[3],g},ce.copy=function(h,g){return h[0]=g[0],h[1]=g[1],h[2]=g[2],h[3]=g[3],h},ce.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h},ce.fromValues=function(h,g,b,E){var A=new t.ARRAY_TYPE(4);return A[0]=h,A[1]=g,A[2]=b,A[3]=E,A},ce.set=function(h,g,b,E,A){return h[0]=g,h[1]=b,h[2]=E,h[3]=A,h},ce.transpose=function(h,g){if(h===g){var b=g[1];h[1]=g[2],h[2]=b}else h[0]=g[0],h[1]=g[2],h[2]=g[1],h[3]=g[3];return h},ce.invert=function(h,g){var b=g[0],E=g[1],A=g[2],v=g[3],C=b*v-A*E;return C?(h[0]=v*(C=1/C),h[1]=-E*C,h[2]=-A*C,h[3]=b*C,h):null},ce.adjoint=function(h,g){var b=g[0];return h[0]=g[3],h[1]=-g[1],h[2]=-g[2],h[3]=b,h},ce.determinant=function(h){return h[0]*h[3]-h[2]*h[1]},ce.multiply=u,ce.rotate=function(h,g,b){var E=g[0],A=g[1],v=g[2],C=g[3],I=Math.sin(b),S=Math.cos(b);return h[0]=E*S+v*I,h[1]=A*S+C*I,h[2]=E*-I+v*S,h[3]=A*-I+C*S,h},ce.scale=function(h,g,b){var E=g[1],A=g[2],v=g[3],C=b[0],I=b[1];return h[0]=g[0]*C,h[1]=E*C,h[2]=A*I,h[3]=v*I,h},ce.fromRotation=function(h,g){var b=Math.sin(g),E=Math.cos(g);return h[0]=E,h[1]=b,h[2]=-b,h[3]=E,h},ce.fromScaling=function(h,g){return h[0]=g[0],h[1]=0,h[2]=0,h[3]=g[1],h},ce.str=function(h){return"mat2("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+")"},ce.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3])},ce.LDU=function(h,g,b,E){return h[2]=E[2]/E[0],b[0]=E[0],b[1]=E[1],b[3]=E[3]-h[2]*b[1],[h,g,b]},ce.add=function(h,g,b){return h[0]=g[0]+b[0],h[1]=g[1]+b[1],h[2]=g[2]+b[2],h[3]=g[3]+b[3],h},ce.subtract=m,ce.exactEquals=function(h,g){return h[0]===g[0]&&h[1]===g[1]&&h[2]===g[2]&&h[3]===g[3]},ce.equals=function(h,g){var b=h[0],E=h[1],A=h[2],v=h[3],C=g[0],I=g[1],S=g[2],M=g[3];return Math.abs(b-C)<=t.EPSILON*Math.max(1,Math.abs(b),Math.abs(C))&&Math.abs(E-I)<=t.EPSILON*Math.max(1,Math.abs(E),Math.abs(I))&&Math.abs(A-S)<=t.EPSILON*Math.max(1,Math.abs(A),Math.abs(S))&&Math.abs(v-M)<=t.EPSILON*Math.max(1,Math.abs(v),Math.abs(M))},ce.multiplyScalar=function(h,g,b){return h[0]=g[0]*b,h[1]=g[1]*b,h[2]=g[2]*b,h[3]=g[3]*b,h},ce.multiplyScalarAndAdd=function(h,g,b,E){return h[0]=g[0]+b[0]*E,h[1]=g[1]+b[1]*E,h[2]=g[2]+b[2]*E,h[3]=g[3]+b[3]*E,h},ce.sub=ce.mul=void 0;var t=function(h,g){if(h&&h.__esModule)return h;if(h===null||l(h)!=="object"&&typeof h!="function")return{default:h};var b=o(void 0);if(b&&b.has(h))return b.get(h);var E={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in h)if(v!=="default"&&Object.prototype.hasOwnProperty.call(h,v)){var C=A?Object.getOwnPropertyDescriptor(h,v):null;C&&(C.get||C.set)?Object.defineProperty(E,v,C):E[v]=h[v]}return E.default=h,b&&b.set(h,E),E}(X());function o(h){if(typeof WeakMap!="function")return null;var g=new WeakMap,b=new WeakMap;return(o=function(E){return E?b:g})(h)}function u(h,g,b){var E=g[0],A=g[1],v=g[2],C=g[3],I=b[0],S=b[1],M=b[2],R=b[3];return h[0]=E*I+v*S,h[1]=A*I+C*S,h[2]=E*M+v*R,h[3]=A*M+C*R,h}function m(h,g,b){return h[0]=g[0]-b[0],h[1]=g[1]-b[1],h[2]=g[2]-b[2],h[3]=g[3]-b[3],h}return ce.mul=u,ce.sub=m,ce}var fe,re={};function ee(){if(fe)return re;function l(h){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},l(h)}fe=1,Object.defineProperty(re,"__esModule",{value:!0}),re.create=function(){var h=new t.ARRAY_TYPE(6);return t.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[4]=0,h[5]=0),h[0]=1,h[3]=1,h},re.clone=function(h){var g=new t.ARRAY_TYPE(6);return g[0]=h[0],g[1]=h[1],g[2]=h[2],g[3]=h[3],g[4]=h[4],g[5]=h[5],g},re.copy=function(h,g){return h[0]=g[0],h[1]=g[1],h[2]=g[2],h[3]=g[3],h[4]=g[4],h[5]=g[5],h},re.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=0,h[5]=0,h},re.fromValues=function(h,g,b,E,A,v){var C=new t.ARRAY_TYPE(6);return C[0]=h,C[1]=g,C[2]=b,C[3]=E,C[4]=A,C[5]=v,C},re.set=function(h,g,b,E,A,v,C){return h[0]=g,h[1]=b,h[2]=E,h[3]=A,h[4]=v,h[5]=C,h},re.invert=function(h,g){var b=g[0],E=g[1],A=g[2],v=g[3],C=g[4],I=g[5],S=b*v-E*A;return S?(h[0]=v*(S=1/S),h[1]=-E*S,h[2]=-A*S,h[3]=b*S,h[4]=(A*I-v*C)*S,h[5]=(E*C-b*I)*S,h):null},re.determinant=function(h){return h[0]*h[3]-h[1]*h[2]},re.multiply=u,re.rotate=function(h,g,b){var E=g[0],A=g[1],v=g[2],C=g[3],I=g[4],S=g[5],M=Math.sin(b),R=Math.cos(b);return h[0]=E*R+v*M,h[1]=A*R+C*M,h[2]=E*-M+v*R,h[3]=A*-M+C*R,h[4]=I,h[5]=S,h},re.scale=function(h,g,b){var E=g[1],A=g[2],v=g[3],C=g[4],I=g[5],S=b[0],M=b[1];return h[0]=g[0]*S,h[1]=E*S,h[2]=A*M,h[3]=v*M,h[4]=C,h[5]=I,h},re.translate=function(h,g,b){var E=g[0],A=g[1],v=g[2],C=g[3],I=g[4],S=g[5],M=b[0],R=b[1];return h[0]=E,h[1]=A,h[2]=v,h[3]=C,h[4]=E*M+v*R+I,h[5]=A*M+C*R+S,h},re.fromRotation=function(h,g){var b=Math.sin(g),E=Math.cos(g);return h[0]=E,h[1]=b,h[2]=-b,h[3]=E,h[4]=0,h[5]=0,h},re.fromScaling=function(h,g){return h[0]=g[0],h[1]=0,h[2]=0,h[3]=g[1],h[4]=0,h[5]=0,h},re.fromTranslation=function(h,g){return h[0]=1,h[1]=0,h[2]=0,h[3]=1,h[4]=g[0],h[5]=g[1],h},re.str=function(h){return"mat2d("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+")"},re.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],1)},re.add=function(h,g,b){return h[0]=g[0]+b[0],h[1]=g[1]+b[1],h[2]=g[2]+b[2],h[3]=g[3]+b[3],h[4]=g[4]+b[4],h[5]=g[5]+b[5],h},re.subtract=m,re.multiplyScalar=function(h,g,b){return h[0]=g[0]*b,h[1]=g[1]*b,h[2]=g[2]*b,h[3]=g[3]*b,h[4]=g[4]*b,h[5]=g[5]*b,h},re.multiplyScalarAndAdd=function(h,g,b,E){return h[0]=g[0]+b[0]*E,h[1]=g[1]+b[1]*E,h[2]=g[2]+b[2]*E,h[3]=g[3]+b[3]*E,h[4]=g[4]+b[4]*E,h[5]=g[5]+b[5]*E,h},re.exactEquals=function(h,g){return h[0]===g[0]&&h[1]===g[1]&&h[2]===g[2]&&h[3]===g[3]&&h[4]===g[4]&&h[5]===g[5]},re.equals=function(h,g){var b=h[0],E=h[1],A=h[2],v=h[3],C=h[4],I=h[5],S=g[0],M=g[1],R=g[2],O=g[3],F=g[4],H=g[5];return Math.abs(b-S)<=t.EPSILON*Math.max(1,Math.abs(b),Math.abs(S))&&Math.abs(E-M)<=t.EPSILON*Math.max(1,Math.abs(E),Math.abs(M))&&Math.abs(A-R)<=t.EPSILON*Math.max(1,Math.abs(A),Math.abs(R))&&Math.abs(v-O)<=t.EPSILON*Math.max(1,Math.abs(v),Math.abs(O))&&Math.abs(C-F)<=t.EPSILON*Math.max(1,Math.abs(C),Math.abs(F))&&Math.abs(I-H)<=t.EPSILON*Math.max(1,Math.abs(I),Math.abs(H))},re.sub=re.mul=void 0;var t=function(h,g){if(h&&h.__esModule)return h;if(h===null||l(h)!=="object"&&typeof h!="function")return{default:h};var b=o(void 0);if(b&&b.has(h))return b.get(h);var E={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in h)if(v!=="default"&&Object.prototype.hasOwnProperty.call(h,v)){var C=A?Object.getOwnPropertyDescriptor(h,v):null;C&&(C.get||C.set)?Object.defineProperty(E,v,C):E[v]=h[v]}return E.default=h,b&&b.set(h,E),E}(X());function o(h){if(typeof WeakMap!="function")return null;var g=new WeakMap,b=new WeakMap;return(o=function(E){return E?b:g})(h)}function u(h,g,b){var E=g[0],A=g[1],v=g[2],C=g[3],I=g[4],S=g[5],M=b[0],R=b[1],O=b[2],F=b[3],H=b[4],W=b[5];return h[0]=E*M+v*R,h[1]=A*M+C*R,h[2]=E*O+v*F,h[3]=A*O+C*F,h[4]=E*H+v*W+I,h[5]=A*H+C*W+S,h}function m(h,g,b){return h[0]=g[0]-b[0],h[1]=g[1]-b[1],h[2]=g[2]-b[2],h[3]=g[3]-b[3],h[4]=g[4]-b[4],h[5]=g[5]-b[5],h}return re.mul=u,re.sub=m,re}var ae,ve={};function Te(){if(ae)return ve;function l(h){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(g){return typeof g}:function(g){return g&&typeof Symbol=="function"&&g.constructor===Symbol&&g!==Symbol.prototype?"symbol":typeof g},l(h)}ae=1,Object.defineProperty(ve,"__esModule",{value:!0}),ve.create=function(){var h=new t.ARRAY_TYPE(9);return t.ARRAY_TYPE!=Float32Array&&(h[1]=0,h[2]=0,h[3]=0,h[5]=0,h[6]=0,h[7]=0),h[0]=1,h[4]=1,h[8]=1,h},ve.fromMat4=function(h,g){return h[0]=g[0],h[1]=g[1],h[2]=g[2],h[3]=g[4],h[4]=g[5],h[5]=g[6],h[6]=g[8],h[7]=g[9],h[8]=g[10],h},ve.clone=function(h){var g=new t.ARRAY_TYPE(9);return g[0]=h[0],g[1]=h[1],g[2]=h[2],g[3]=h[3],g[4]=h[4],g[5]=h[5],g[6]=h[6],g[7]=h[7],g[8]=h[8],g},ve.copy=function(h,g){return h[0]=g[0],h[1]=g[1],h[2]=g[2],h[3]=g[3],h[4]=g[4],h[5]=g[5],h[6]=g[6],h[7]=g[7],h[8]=g[8],h},ve.fromValues=function(h,g,b,E,A,v,C,I,S){var M=new t.ARRAY_TYPE(9);return M[0]=h,M[1]=g,M[2]=b,M[3]=E,M[4]=A,M[5]=v,M[6]=C,M[7]=I,M[8]=S,M},ve.set=function(h,g,b,E,A,v,C,I,S,M){return h[0]=g,h[1]=b,h[2]=E,h[3]=A,h[4]=v,h[5]=C,h[6]=I,h[7]=S,h[8]=M,h},ve.identity=function(h){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},ve.transpose=function(h,g){if(h===g){var b=g[1],E=g[2],A=g[5];h[1]=g[3],h[2]=g[6],h[3]=b,h[5]=g[7],h[6]=E,h[7]=A}else h[0]=g[0],h[1]=g[3],h[2]=g[6],h[3]=g[1],h[4]=g[4],h[5]=g[7],h[6]=g[2],h[7]=g[5],h[8]=g[8];return h},ve.invert=function(h,g){var b=g[0],E=g[1],A=g[2],v=g[3],C=g[4],I=g[5],S=g[6],M=g[7],R=g[8],O=R*C-I*M,F=-R*v+I*S,H=M*v-C*S,W=b*O+E*F+A*H;return W?(h[0]=O*(W=1/W),h[1]=(-R*E+A*M)*W,h[2]=(I*E-A*C)*W,h[3]=F*W,h[4]=(R*b-A*S)*W,h[5]=(-I*b+A*v)*W,h[6]=H*W,h[7]=(-M*b+E*S)*W,h[8]=(C*b-E*v)*W,h):null},ve.adjoint=function(h,g){var b=g[0],E=g[1],A=g[2],v=g[3],C=g[4],I=g[5],S=g[6],M=g[7],R=g[8];return h[0]=C*R-I*M,h[1]=A*M-E*R,h[2]=E*I-A*C,h[3]=I*S-v*R,h[4]=b*R-A*S,h[5]=A*v-b*I,h[6]=v*M-C*S,h[7]=E*S-b*M,h[8]=b*C-E*v,h},ve.determinant=function(h){var g=h[3],b=h[4],E=h[5],A=h[6],v=h[7],C=h[8];return h[0]*(C*b-E*v)+h[1]*(-C*g+E*A)+h[2]*(v*g-b*A)},ve.multiply=u,ve.translate=function(h,g,b){var E=g[0],A=g[1],v=g[2],C=g[3],I=g[4],S=g[5],M=g[6],R=g[7],O=g[8],F=b[0],H=b[1];return h[0]=E,h[1]=A,h[2]=v,h[3]=C,h[4]=I,h[5]=S,h[6]=F*E+H*C+M,h[7]=F*A+H*I+R,h[8]=F*v+H*S+O,h},ve.rotate=function(h,g,b){var E=g[0],A=g[1],v=g[2],C=g[3],I=g[4],S=g[5],M=g[6],R=g[7],O=g[8],F=Math.sin(b),H=Math.cos(b);return h[0]=H*E+F*C,h[1]=H*A+F*I,h[2]=H*v+F*S,h[3]=H*C-F*E,h[4]=H*I-F*A,h[5]=H*S-F*v,h[6]=M,h[7]=R,h[8]=O,h},ve.scale=function(h,g,b){var E=b[0],A=b[1];return h[0]=E*g[0],h[1]=E*g[1],h[2]=E*g[2],h[3]=A*g[3],h[4]=A*g[4],h[5]=A*g[5],h[6]=g[6],h[7]=g[7],h[8]=g[8],h},ve.fromTranslation=function(h,g){return h[0]=1,h[1]=0,h[2]=0,h[3]=0,h[4]=1,h[5]=0,h[6]=g[0],h[7]=g[1],h[8]=1,h},ve.fromRotation=function(h,g){var b=Math.sin(g),E=Math.cos(g);return h[0]=E,h[1]=b,h[2]=0,h[3]=-b,h[4]=E,h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},ve.fromScaling=function(h,g){return h[0]=g[0],h[1]=0,h[2]=0,h[3]=0,h[4]=g[1],h[5]=0,h[6]=0,h[7]=0,h[8]=1,h},ve.fromMat2d=function(h,g){return h[0]=g[0],h[1]=g[1],h[2]=0,h[3]=g[2],h[4]=g[3],h[5]=0,h[6]=g[4],h[7]=g[5],h[8]=1,h},ve.fromQuat=function(h,g){var b=g[0],E=g[1],A=g[2],v=g[3],C=b+b,I=E+E,S=A+A,M=b*C,R=E*C,O=E*I,F=A*C,H=A*I,W=A*S,V=v*C,Z=v*I,Y=v*S;return h[0]=1-O-W,h[3]=R-Y,h[6]=F+Z,h[1]=R+Y,h[4]=1-M-W,h[7]=H-V,h[2]=F-Z,h[5]=H+V,h[8]=1-M-O,h},ve.normalFromMat4=function(h,g){var b=g[0],E=g[1],A=g[2],v=g[3],C=g[4],I=g[5],S=g[6],M=g[7],R=g[8],O=g[9],F=g[10],H=g[11],W=g[12],V=g[13],Z=g[14],Y=g[15],ne=b*I-E*C,ye=b*S-A*C,_e=b*M-v*C,ge=E*S-A*I,Re=E*M-v*I,we=A*M-v*S,Le=R*V-O*W,Be=R*Z-F*W,Oe=R*Y-H*W,Ve=O*Z-F*V,We=O*Y-H*V,Qe=F*Y-H*Z,Ge=ne*Qe-ye*We+_e*Ve+ge*Oe-Re*Be+we*Le;return Ge?(h[0]=(I*Qe-S*We+M*Ve)*(Ge=1/Ge),h[1]=(S*Oe-C*Qe-M*Be)*Ge,h[2]=(C*We-I*Oe+M*Le)*Ge,h[3]=(A*We-E*Qe-v*Ve)*Ge,h[4]=(b*Qe-A*Oe+v*Be)*Ge,h[5]=(E*Oe-b*We-v*Le)*Ge,h[6]=(V*we-Z*Re+Y*ge)*Ge,h[7]=(Z*_e-W*we-Y*ye)*Ge,h[8]=(W*Re-V*_e+Y*ne)*Ge,h):null},ve.projection=function(h,g,b){return h[0]=2/g,h[1]=0,h[2]=0,h[3]=0,h[4]=-2/b,h[5]=0,h[6]=-1,h[7]=1,h[8]=1,h},ve.str=function(h){return"mat3("+h[0]+", "+h[1]+", "+h[2]+", "+h[3]+", "+h[4]+", "+h[5]+", "+h[6]+", "+h[7]+", "+h[8]+")"},ve.frob=function(h){return Math.hypot(h[0],h[1],h[2],h[3],h[4],h[5],h[6],h[7],h[8])},ve.add=function(h,g,b){return h[0]=g[0]+b[0],h[1]=g[1]+b[1],h[2]=g[2]+b[2],h[3]=g[3]+b[3],h[4]=g[4]+b[4],h[5]=g[5]+b[5],h[6]=g[6]+b[6],h[7]=g[7]+b[7],h[8]=g[8]+b[8],h},ve.subtract=m,ve.multiplyScalar=function(h,g,b){return h[0]=g[0]*b,h[1]=g[1]*b,h[2]=g[2]*b,h[3]=g[3]*b,h[4]=g[4]*b,h[5]=g[5]*b,h[6]=g[6]*b,h[7]=g[7]*b,h[8]=g[8]*b,h},ve.multiplyScalarAndAdd=function(h,g,b,E){return h[0]=g[0]+b[0]*E,h[1]=g[1]+b[1]*E,h[2]=g[2]+b[2]*E,h[3]=g[3]+b[3]*E,h[4]=g[4]+b[4]*E,h[5]=g[5]+b[5]*E,h[6]=g[6]+b[6]*E,h[7]=g[7]+b[7]*E,h[8]=g[8]+b[8]*E,h},ve.exactEquals=function(h,g){return h[0]===g[0]&&h[1]===g[1]&&h[2]===g[2]&&h[3]===g[3]&&h[4]===g[4]&&h[5]===g[5]&&h[6]===g[6]&&h[7]===g[7]&&h[8]===g[8]},ve.equals=function(h,g){var b=h[0],E=h[1],A=h[2],v=h[3],C=h[4],I=h[5],S=h[6],M=h[7],R=h[8],O=g[0],F=g[1],H=g[2],W=g[3],V=g[4],Z=g[5],Y=g[6],ne=g[7],ye=g[8];return Math.abs(b-O)<=t.EPSILON*Math.max(1,Math.abs(b),Math.abs(O))&&Math.abs(E-F)<=t.EPSILON*Math.max(1,Math.abs(E),Math.abs(F))&&Math.abs(A-H)<=t.EPSILON*Math.max(1,Math.abs(A),Math.abs(H))&&Math.abs(v-W)<=t.EPSILON*Math.max(1,Math.abs(v),Math.abs(W))&&Math.abs(C-V)<=t.EPSILON*Math.max(1,Math.abs(C),Math.abs(V))&&Math.abs(I-Z)<=t.EPSILON*Math.max(1,Math.abs(I),Math.abs(Z))&&Math.abs(S-Y)<=t.EPSILON*Math.max(1,Math.abs(S),Math.abs(Y))&&Math.abs(M-ne)<=t.EPSILON*Math.max(1,Math.abs(M),Math.abs(ne))&&Math.abs(R-ye)<=t.EPSILON*Math.max(1,Math.abs(R),Math.abs(ye))},ve.sub=ve.mul=void 0;var t=function(h,g){if(h&&h.__esModule)return h;if(h===null||l(h)!=="object"&&typeof h!="function")return{default:h};var b=o(void 0);if(b&&b.has(h))return b.get(h);var E={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var v in h)if(v!=="default"&&Object.prototype.hasOwnProperty.call(h,v)){var C=A?Object.getOwnPropertyDescriptor(h,v):null;C&&(C.get||C.set)?Object.defineProperty(E,v,C):E[v]=h[v]}return E.default=h,b&&b.set(h,E),E}(X());function o(h){if(typeof WeakMap!="function")return null;var g=new WeakMap,b=new WeakMap;return(o=function(E){return E?b:g})(h)}function u(h,g,b){var E=g[0],A=g[1],v=g[2],C=g[3],I=g[4],S=g[5],M=g[6],R=g[7],O=g[8],F=b[0],H=b[1],W=b[2],V=b[3],Z=b[4],Y=b[5],ne=b[6],ye=b[7],_e=b[8];return h[0]=F*E+H*C+W*M,h[1]=F*A+H*I+W*R,h[2]=F*v+H*S+W*O,h[3]=V*E+Z*C+Y*M,h[4]=V*A+Z*I+Y*R,h[5]=V*v+Z*S+Y*O,h[6]=ne*E+ye*C+_e*M,h[7]=ne*A+ye*I+_e*R,h[8]=ne*v+ye*S+_e*O,h}function m(h,g,b){return h[0]=g[0]-b[0],h[1]=g[1]-b[1],h[2]=g[2]-b[2],h[3]=g[3]-b[3],h[4]=g[4]-b[4],h[5]=g[5]-b[5],h[6]=g[6]-b[6],h[7]=g[7]-b[7],h[8]=g[8]-b[8],h}return ve.mul=u,ve.sub=m,ve}var pe,Ee={};function Ne(){if(pe)return Ee;function l(v){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(C){return typeof C}:function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},l(v)}pe=1,Object.defineProperty(Ee,"__esModule",{value:!0}),Ee.create=function(){var v=new t.ARRAY_TYPE(16);return t.ARRAY_TYPE!=Float32Array&&(v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=0,v[12]=0,v[13]=0,v[14]=0),v[0]=1,v[5]=1,v[10]=1,v[15]=1,v},Ee.clone=function(v){var C=new t.ARRAY_TYPE(16);return C[0]=v[0],C[1]=v[1],C[2]=v[2],C[3]=v[3],C[4]=v[4],C[5]=v[5],C[6]=v[6],C[7]=v[7],C[8]=v[8],C[9]=v[9],C[10]=v[10],C[11]=v[11],C[12]=v[12],C[13]=v[13],C[14]=v[14],C[15]=v[15],C},Ee.copy=function(v,C){return v[0]=C[0],v[1]=C[1],v[2]=C[2],v[3]=C[3],v[4]=C[4],v[5]=C[5],v[6]=C[6],v[7]=C[7],v[8]=C[8],v[9]=C[9],v[10]=C[10],v[11]=C[11],v[12]=C[12],v[13]=C[13],v[14]=C[14],v[15]=C[15],v},Ee.fromValues=function(v,C,I,S,M,R,O,F,H,W,V,Z,Y,ne,ye,_e){var ge=new t.ARRAY_TYPE(16);return ge[0]=v,ge[1]=C,ge[2]=I,ge[3]=S,ge[4]=M,ge[5]=R,ge[6]=O,ge[7]=F,ge[8]=H,ge[9]=W,ge[10]=V,ge[11]=Z,ge[12]=Y,ge[13]=ne,ge[14]=ye,ge[15]=_e,ge},Ee.set=function(v,C,I,S,M,R,O,F,H,W,V,Z,Y,ne,ye,_e,ge){return v[0]=C,v[1]=I,v[2]=S,v[3]=M,v[4]=R,v[5]=O,v[6]=F,v[7]=H,v[8]=W,v[9]=V,v[10]=Z,v[11]=Y,v[12]=ne,v[13]=ye,v[14]=_e,v[15]=ge,v},Ee.identity=u,Ee.transpose=function(v,C){if(v===C){var I=C[1],S=C[2],M=C[3],R=C[6],O=C[7],F=C[11];v[1]=C[4],v[2]=C[8],v[3]=C[12],v[4]=I,v[6]=C[9],v[7]=C[13],v[8]=S,v[9]=R,v[11]=C[14],v[12]=M,v[13]=O,v[14]=F}else v[0]=C[0],v[1]=C[4],v[2]=C[8],v[3]=C[12],v[4]=C[1],v[5]=C[5],v[6]=C[9],v[7]=C[13],v[8]=C[2],v[9]=C[6],v[10]=C[10],v[11]=C[14],v[12]=C[3],v[13]=C[7],v[14]=C[11],v[15]=C[15];return v},Ee.invert=function(v,C){var I=C[0],S=C[1],M=C[2],R=C[3],O=C[4],F=C[5],H=C[6],W=C[7],V=C[8],Z=C[9],Y=C[10],ne=C[11],ye=C[12],_e=C[13],ge=C[14],Re=C[15],we=I*F-S*O,Le=I*H-M*O,Be=I*W-R*O,Oe=S*H-M*F,Ve=S*W-R*F,We=M*W-R*H,Qe=V*_e-Z*ye,Ge=V*ge-Y*ye,ut=V*Re-ne*ye,It=Z*ge-Y*_e,dt=Z*Re-ne*_e,Dt=Y*Re-ne*ge,kt=we*Dt-Le*dt+Be*It+Oe*ut-Ve*Ge+We*Qe;return kt?(v[0]=(F*Dt-H*dt+W*It)*(kt=1/kt),v[1]=(M*dt-S*Dt-R*It)*kt,v[2]=(_e*We-ge*Ve+Re*Oe)*kt,v[3]=(Y*Ve-Z*We-ne*Oe)*kt,v[4]=(H*ut-O*Dt-W*Ge)*kt,v[5]=(I*Dt-M*ut+R*Ge)*kt,v[6]=(ge*Be-ye*We-Re*Le)*kt,v[7]=(V*We-Y*Be+ne*Le)*kt,v[8]=(O*dt-F*ut+W*Qe)*kt,v[9]=(S*ut-I*dt-R*Qe)*kt,v[10]=(ye*Ve-_e*Be+Re*we)*kt,v[11]=(Z*Be-V*Ve-ne*we)*kt,v[12]=(F*Ge-O*It-H*Qe)*kt,v[13]=(I*It-S*Ge+M*Qe)*kt,v[14]=(_e*Le-ye*Oe-ge*we)*kt,v[15]=(V*Oe-Z*Le+Y*we)*kt,v):null},Ee.adjoint=function(v,C){var I=C[0],S=C[1],M=C[2],R=C[3],O=C[4],F=C[5],H=C[6],W=C[7],V=C[8],Z=C[9],Y=C[10],ne=C[11],ye=C[12],_e=C[13],ge=C[14],Re=C[15];return v[0]=F*(Y*Re-ne*ge)-Z*(H*Re-W*ge)+_e*(H*ne-W*Y),v[1]=-(S*(Y*Re-ne*ge)-Z*(M*Re-R*ge)+_e*(M*ne-R*Y)),v[2]=S*(H*Re-W*ge)-F*(M*Re-R*ge)+_e*(M*W-R*H),v[3]=-(S*(H*ne-W*Y)-F*(M*ne-R*Y)+Z*(M*W-R*H)),v[4]=-(O*(Y*Re-ne*ge)-V*(H*Re-W*ge)+ye*(H*ne-W*Y)),v[5]=I*(Y*Re-ne*ge)-V*(M*Re-R*ge)+ye*(M*ne-R*Y),v[6]=-(I*(H*Re-W*ge)-O*(M*Re-R*ge)+ye*(M*W-R*H)),v[7]=I*(H*ne-W*Y)-O*(M*ne-R*Y)+V*(M*W-R*H),v[8]=O*(Z*Re-ne*_e)-V*(F*Re-W*_e)+ye*(F*ne-W*Z),v[9]=-(I*(Z*Re-ne*_e)-V*(S*Re-R*_e)+ye*(S*ne-R*Z)),v[10]=I*(F*Re-W*_e)-O*(S*Re-R*_e)+ye*(S*W-R*F),v[11]=-(I*(F*ne-W*Z)-O*(S*ne-R*Z)+V*(S*W-R*F)),v[12]=-(O*(Z*ge-Y*_e)-V*(F*ge-H*_e)+ye*(F*Y-H*Z)),v[13]=I*(Z*ge-Y*_e)-V*(S*ge-M*_e)+ye*(S*Y-M*Z),v[14]=-(I*(F*ge-H*_e)-O*(S*ge-M*_e)+ye*(S*H-M*F)),v[15]=I*(F*Y-H*Z)-O*(S*Y-M*Z)+V*(S*H-M*F),v},Ee.determinant=function(v){var C=v[0],I=v[1],S=v[2],M=v[3],R=v[4],O=v[5],F=v[6],H=v[7],W=v[8],V=v[9],Z=v[10],Y=v[11],ne=v[12],ye=v[13],_e=v[14],ge=v[15];return(C*O-I*R)*(Z*ge-Y*_e)-(C*F-S*R)*(V*ge-Y*ye)+(C*H-M*R)*(V*_e-Z*ye)+(I*F-S*O)*(W*ge-Y*ne)-(I*H-M*O)*(W*_e-Z*ne)+(S*H-M*F)*(W*ye-V*ne)},Ee.multiply=m,Ee.translate=function(v,C,I){var S,M,R,O,F,H,W,V,Z,Y,ne,ye,_e=I[0],ge=I[1],Re=I[2];return C===v?(v[12]=C[0]*_e+C[4]*ge+C[8]*Re+C[12],v[13]=C[1]*_e+C[5]*ge+C[9]*Re+C[13],v[14]=C[2]*_e+C[6]*ge+C[10]*Re+C[14],v[15]=C[3]*_e+C[7]*ge+C[11]*Re+C[15]):(M=C[1],R=C[2],O=C[3],F=C[4],H=C[5],W=C[6],V=C[7],Z=C[8],Y=C[9],ne=C[10],ye=C[11],v[0]=S=C[0],v[1]=M,v[2]=R,v[3]=O,v[4]=F,v[5]=H,v[6]=W,v[7]=V,v[8]=Z,v[9]=Y,v[10]=ne,v[11]=ye,v[12]=S*_e+F*ge+Z*Re+C[12],v[13]=M*_e+H*ge+Y*Re+C[13],v[14]=R*_e+W*ge+ne*Re+C[14],v[15]=O*_e+V*ge+ye*Re+C[15]),v},Ee.scale=function(v,C,I){var S=I[0],M=I[1],R=I[2];return v[0]=C[0]*S,v[1]=C[1]*S,v[2]=C[2]*S,v[3]=C[3]*S,v[4]=C[4]*M,v[5]=C[5]*M,v[6]=C[6]*M,v[7]=C[7]*M,v[8]=C[8]*R,v[9]=C[9]*R,v[10]=C[10]*R,v[11]=C[11]*R,v[12]=C[12],v[13]=C[13],v[14]=C[14],v[15]=C[15],v},Ee.rotate=function(v,C,I,S){var M,R,O,F,H,W,V,Z,Y,ne,ye,_e,ge,Re,we,Le,Be,Oe,Ve,We,Qe,Ge,ut,It,dt=S[0],Dt=S[1],kt=S[2],$t=Math.hypot(dt,Dt,kt);return $t<t.EPSILON?null:(dt*=$t=1/$t,Dt*=$t,kt*=$t,M=Math.sin(I),R=Math.cos(I),H=C[1],W=C[2],V=C[3],Y=C[5],ne=C[6],ye=C[7],ge=C[9],Re=C[10],we=C[11],Le=dt*dt*(O=1-R)+R,Ve=dt*Dt*O-kt*M,We=Dt*Dt*O+R,Qe=kt*Dt*O+dt*M,Ge=dt*kt*O+Dt*M,ut=Dt*kt*O-dt*M,It=kt*kt*O+R,v[0]=(F=C[0])*Le+(Z=C[4])*(Be=Dt*dt*O+kt*M)+(_e=C[8])*(Oe=kt*dt*O-Dt*M),v[1]=H*Le+Y*Be+ge*Oe,v[2]=W*Le+ne*Be+Re*Oe,v[3]=V*Le+ye*Be+we*Oe,v[4]=F*Ve+Z*We+_e*Qe,v[5]=H*Ve+Y*We+ge*Qe,v[6]=W*Ve+ne*We+Re*Qe,v[7]=V*Ve+ye*We+we*Qe,v[8]=F*Ge+Z*ut+_e*It,v[9]=H*Ge+Y*ut+ge*It,v[10]=W*Ge+ne*ut+Re*It,v[11]=V*Ge+ye*ut+we*It,C!==v&&(v[12]=C[12],v[13]=C[13],v[14]=C[14],v[15]=C[15]),v)},Ee.rotateX=function(v,C,I){var S=Math.sin(I),M=Math.cos(I),R=C[4],O=C[5],F=C[6],H=C[7],W=C[8],V=C[9],Z=C[10],Y=C[11];return C!==v&&(v[0]=C[0],v[1]=C[1],v[2]=C[2],v[3]=C[3],v[12]=C[12],v[13]=C[13],v[14]=C[14],v[15]=C[15]),v[4]=R*M+W*S,v[5]=O*M+V*S,v[6]=F*M+Z*S,v[7]=H*M+Y*S,v[8]=W*M-R*S,v[9]=V*M-O*S,v[10]=Z*M-F*S,v[11]=Y*M-H*S,v},Ee.rotateY=function(v,C,I){var S=Math.sin(I),M=Math.cos(I),R=C[0],O=C[1],F=C[2],H=C[3],W=C[8],V=C[9],Z=C[10],Y=C[11];return C!==v&&(v[4]=C[4],v[5]=C[5],v[6]=C[6],v[7]=C[7],v[12]=C[12],v[13]=C[13],v[14]=C[14],v[15]=C[15]),v[0]=R*M-W*S,v[1]=O*M-V*S,v[2]=F*M-Z*S,v[3]=H*M-Y*S,v[8]=R*S+W*M,v[9]=O*S+V*M,v[10]=F*S+Z*M,v[11]=H*S+Y*M,v},Ee.rotateZ=function(v,C,I){var S=Math.sin(I),M=Math.cos(I),R=C[0],O=C[1],F=C[2],H=C[3],W=C[4],V=C[5],Z=C[6],Y=C[7];return C!==v&&(v[8]=C[8],v[9]=C[9],v[10]=C[10],v[11]=C[11],v[12]=C[12],v[13]=C[13],v[14]=C[14],v[15]=C[15]),v[0]=R*M+W*S,v[1]=O*M+V*S,v[2]=F*M+Z*S,v[3]=H*M+Y*S,v[4]=W*M-R*S,v[5]=V*M-O*S,v[6]=Z*M-F*S,v[7]=Y*M-H*S,v},Ee.fromTranslation=function(v,C){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=C[0],v[13]=C[1],v[14]=C[2],v[15]=1,v},Ee.fromScaling=function(v,C){return v[0]=C[0],v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=C[1],v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=C[2],v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},Ee.fromRotation=function(v,C,I){var S,M,R,O=I[0],F=I[1],H=I[2],W=Math.hypot(O,F,H);return W<t.EPSILON?null:(O*=W=1/W,F*=W,H*=W,S=Math.sin(C),M=Math.cos(C),v[0]=O*O*(R=1-M)+M,v[1]=F*O*R+H*S,v[2]=H*O*R-F*S,v[3]=0,v[4]=O*F*R-H*S,v[5]=F*F*R+M,v[6]=H*F*R+O*S,v[7]=0,v[8]=O*H*R+F*S,v[9]=F*H*R-O*S,v[10]=H*H*R+M,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v)},Ee.fromXRotation=function(v,C){var I=Math.sin(C),S=Math.cos(C);return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=S,v[6]=I,v[7]=0,v[8]=0,v[9]=-I,v[10]=S,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},Ee.fromYRotation=function(v,C){var I=Math.sin(C),S=Math.cos(C);return v[0]=S,v[1]=0,v[2]=-I,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=I,v[9]=0,v[10]=S,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},Ee.fromZRotation=function(v,C){var I=Math.sin(C),S=Math.cos(C);return v[0]=S,v[1]=I,v[2]=0,v[3]=0,v[4]=-I,v[5]=S,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},Ee.fromRotationTranslation=h,Ee.fromQuat2=function(v,C){var I=new t.ARRAY_TYPE(3),S=-C[0],M=-C[1],R=-C[2],O=C[3],F=C[4],H=C[5],W=C[6],V=C[7],Z=S*S+M*M+R*R+O*O;return Z>0?(I[0]=2*(F*O+V*S+H*R-W*M)/Z,I[1]=2*(H*O+V*M+W*S-F*R)/Z,I[2]=2*(W*O+V*R+F*M-H*S)/Z):(I[0]=2*(F*O+V*S+H*R-W*M),I[1]=2*(H*O+V*M+W*S-F*R),I[2]=2*(W*O+V*R+F*M-H*S)),h(v,C,I),v},Ee.getTranslation=function(v,C){return v[0]=C[12],v[1]=C[13],v[2]=C[14],v},Ee.getScaling=g,Ee.getRotation=function(v,C){var I=new t.ARRAY_TYPE(3);g(I,C);var S=1/I[0],M=1/I[1],R=1/I[2],O=C[0]*S,F=C[1]*M,H=C[2]*R,W=C[4]*S,V=C[5]*M,Z=C[6]*R,Y=C[8]*S,ne=C[9]*M,ye=C[10]*R,_e=O+V+ye,ge=0;return _e>0?(ge=2*Math.sqrt(_e+1),v[3]=.25*ge,v[0]=(Z-ne)/ge,v[1]=(Y-H)/ge,v[2]=(F-W)/ge):O>V&&O>ye?(ge=2*Math.sqrt(1+O-V-ye),v[3]=(Z-ne)/ge,v[0]=.25*ge,v[1]=(F+W)/ge,v[2]=(Y+H)/ge):V>ye?(ge=2*Math.sqrt(1+V-O-ye),v[3]=(Y-H)/ge,v[0]=(F+W)/ge,v[1]=.25*ge,v[2]=(Z+ne)/ge):(ge=2*Math.sqrt(1+ye-O-V),v[3]=(F-W)/ge,v[0]=(Y+H)/ge,v[1]=(Z+ne)/ge,v[2]=.25*ge),v},Ee.fromRotationTranslationScale=function(v,C,I,S){var M=C[0],R=C[1],O=C[2],F=C[3],H=M+M,W=R+R,V=O+O,Z=M*H,Y=M*W,ne=M*V,ye=R*W,_e=R*V,ge=O*V,Re=F*H,we=F*W,Le=F*V,Be=S[0],Oe=S[1],Ve=S[2];return v[0]=(1-(ye+ge))*Be,v[1]=(Y+Le)*Be,v[2]=(ne-we)*Be,v[3]=0,v[4]=(Y-Le)*Oe,v[5]=(1-(Z+ge))*Oe,v[6]=(_e+Re)*Oe,v[7]=0,v[8]=(ne+we)*Ve,v[9]=(_e-Re)*Ve,v[10]=(1-(Z+ye))*Ve,v[11]=0,v[12]=I[0],v[13]=I[1],v[14]=I[2],v[15]=1,v},Ee.fromRotationTranslationScaleOrigin=function(v,C,I,S,M){var R=C[0],O=C[1],F=C[2],H=C[3],W=R+R,V=O+O,Z=F+F,Y=R*W,ne=R*V,ye=R*Z,_e=O*V,ge=O*Z,Re=F*Z,we=H*W,Le=H*V,Be=H*Z,Oe=S[0],Ve=S[1],We=S[2],Qe=M[0],Ge=M[1],ut=M[2],It=(1-(_e+Re))*Oe,dt=(ne+Be)*Oe,Dt=(ye-Le)*Oe,kt=(ne-Be)*Ve,$t=(1-(Y+Re))*Ve,_t=(ge+we)*Ve,er=(ye+Le)*We,Ot=(ge-we)*We,Kt=(1-(Y+_e))*We;return v[0]=It,v[1]=dt,v[2]=Dt,v[3]=0,v[4]=kt,v[5]=$t,v[6]=_t,v[7]=0,v[8]=er,v[9]=Ot,v[10]=Kt,v[11]=0,v[12]=I[0]+Qe-(It*Qe+kt*Ge+er*ut),v[13]=I[1]+Ge-(dt*Qe+$t*Ge+Ot*ut),v[14]=I[2]+ut-(Dt*Qe+_t*Ge+Kt*ut),v[15]=1,v},Ee.fromQuat=function(v,C){var I=C[0],S=C[1],M=C[2],R=C[3],O=I+I,F=S+S,H=M+M,W=I*O,V=S*O,Z=S*F,Y=M*O,ne=M*F,ye=M*H,_e=R*O,ge=R*F,Re=R*H;return v[0]=1-Z-ye,v[1]=V+Re,v[2]=Y-ge,v[3]=0,v[4]=V-Re,v[5]=1-W-ye,v[6]=ne+_e,v[7]=0,v[8]=Y+ge,v[9]=ne-_e,v[10]=1-W-Z,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v},Ee.frustum=function(v,C,I,S,M,R,O){var F=1/(I-C),H=1/(M-S),W=1/(R-O);return v[0]=2*R*F,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=2*R*H,v[6]=0,v[7]=0,v[8]=(I+C)*F,v[9]=(M+S)*H,v[10]=(O+R)*W,v[11]=-1,v[12]=0,v[13]=0,v[14]=O*R*2*W,v[15]=0,v},Ee.perspectiveNO=b,Ee.perspectiveZO=function(v,C,I,S,M){var R,O=1/Math.tan(C/2);return v[0]=O/I,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=O,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=-1,v[12]=0,v[13]=0,v[15]=0,M!=null&&M!==1/0?(v[10]=M*(R=1/(S-M)),v[14]=M*S*R):(v[10]=-1,v[14]=-S),v},Ee.perspectiveFromFieldOfView=function(v,C,I,S){var M=Math.tan(C.upDegrees*Math.PI/180),R=Math.tan(C.downDegrees*Math.PI/180),O=Math.tan(C.leftDegrees*Math.PI/180),F=Math.tan(C.rightDegrees*Math.PI/180),H=2/(O+F),W=2/(M+R);return v[0]=H,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=W,v[6]=0,v[7]=0,v[8]=-(O-F)*H*.5,v[9]=(M-R)*W*.5,v[10]=S/(I-S),v[11]=-1,v[12]=0,v[13]=0,v[14]=S*I/(I-S),v[15]=0,v},Ee.orthoNO=E,Ee.orthoZO=function(v,C,I,S,M,R,O){var F=1/(C-I),H=1/(S-M),W=1/(R-O);return v[0]=-2*F,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=-2*H,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=W,v[11]=0,v[12]=(C+I)*F,v[13]=(M+S)*H,v[14]=R*W,v[15]=1,v},Ee.lookAt=function(v,C,I,S){var M,R,O,F,H,W,V,Z,Y,ne,ye=C[0],_e=C[1],ge=C[2],Re=S[0],we=S[1],Le=S[2],Be=I[0],Oe=I[1],Ve=I[2];return Math.abs(ye-Be)<t.EPSILON&&Math.abs(_e-Oe)<t.EPSILON&&Math.abs(ge-Ve)<t.EPSILON?u(v):(V=ye-Be,Z=_e-Oe,Y=ge-Ve,M=we*(Y*=ne=1/Math.hypot(V,Z,Y))-Le*(Z*=ne),R=Le*(V*=ne)-Re*Y,O=Re*Z-we*V,(ne=Math.hypot(M,R,O))?(M*=ne=1/ne,R*=ne,O*=ne):(M=0,R=0,O=0),F=Z*O-Y*R,H=Y*M-V*O,W=V*R-Z*M,(ne=Math.hypot(F,H,W))?(F*=ne=1/ne,H*=ne,W*=ne):(F=0,H=0,W=0),v[0]=M,v[1]=F,v[2]=V,v[3]=0,v[4]=R,v[5]=H,v[6]=Z,v[7]=0,v[8]=O,v[9]=W,v[10]=Y,v[11]=0,v[12]=-(M*ye+R*_e+O*ge),v[13]=-(F*ye+H*_e+W*ge),v[14]=-(V*ye+Z*_e+Y*ge),v[15]=1,v)},Ee.targetTo=function(v,C,I,S){var M=C[0],R=C[1],O=C[2],F=S[0],H=S[1],W=S[2],V=M-I[0],Z=R-I[1],Y=O-I[2],ne=V*V+Z*Z+Y*Y;ne>0&&(V*=ne=1/Math.sqrt(ne),Z*=ne,Y*=ne);var ye=H*Y-W*Z,_e=W*V-F*Y,ge=F*Z-H*V;return(ne=ye*ye+_e*_e+ge*ge)>0&&(ye*=ne=1/Math.sqrt(ne),_e*=ne,ge*=ne),v[0]=ye,v[1]=_e,v[2]=ge,v[3]=0,v[4]=Z*ge-Y*_e,v[5]=Y*ye-V*ge,v[6]=V*_e-Z*ye,v[7]=0,v[8]=V,v[9]=Z,v[10]=Y,v[11]=0,v[12]=M,v[13]=R,v[14]=O,v[15]=1,v},Ee.str=function(v){return"mat4("+v[0]+", "+v[1]+", "+v[2]+", "+v[3]+", "+v[4]+", "+v[5]+", "+v[6]+", "+v[7]+", "+v[8]+", "+v[9]+", "+v[10]+", "+v[11]+", "+v[12]+", "+v[13]+", "+v[14]+", "+v[15]+")"},Ee.frob=function(v){return Math.hypot(v[0],v[1],v[2],v[3],v[4],v[5],v[6],v[7],v[8],v[9],v[10],v[11],v[12],v[13],v[14],v[15])},Ee.add=function(v,C,I){return v[0]=C[0]+I[0],v[1]=C[1]+I[1],v[2]=C[2]+I[2],v[3]=C[3]+I[3],v[4]=C[4]+I[4],v[5]=C[5]+I[5],v[6]=C[6]+I[6],v[7]=C[7]+I[7],v[8]=C[8]+I[8],v[9]=C[9]+I[9],v[10]=C[10]+I[10],v[11]=C[11]+I[11],v[12]=C[12]+I[12],v[13]=C[13]+I[13],v[14]=C[14]+I[14],v[15]=C[15]+I[15],v},Ee.subtract=A,Ee.multiplyScalar=function(v,C,I){return v[0]=C[0]*I,v[1]=C[1]*I,v[2]=C[2]*I,v[3]=C[3]*I,v[4]=C[4]*I,v[5]=C[5]*I,v[6]=C[6]*I,v[7]=C[7]*I,v[8]=C[8]*I,v[9]=C[9]*I,v[10]=C[10]*I,v[11]=C[11]*I,v[12]=C[12]*I,v[13]=C[13]*I,v[14]=C[14]*I,v[15]=C[15]*I,v},Ee.multiplyScalarAndAdd=function(v,C,I,S){return v[0]=C[0]+I[0]*S,v[1]=C[1]+I[1]*S,v[2]=C[2]+I[2]*S,v[3]=C[3]+I[3]*S,v[4]=C[4]+I[4]*S,v[5]=C[5]+I[5]*S,v[6]=C[6]+I[6]*S,v[7]=C[7]+I[7]*S,v[8]=C[8]+I[8]*S,v[9]=C[9]+I[9]*S,v[10]=C[10]+I[10]*S,v[11]=C[11]+I[11]*S,v[12]=C[12]+I[12]*S,v[13]=C[13]+I[13]*S,v[14]=C[14]+I[14]*S,v[15]=C[15]+I[15]*S,v},Ee.exactEquals=function(v,C){return v[0]===C[0]&&v[1]===C[1]&&v[2]===C[2]&&v[3]===C[3]&&v[4]===C[4]&&v[5]===C[5]&&v[6]===C[6]&&v[7]===C[7]&&v[8]===C[8]&&v[9]===C[9]&&v[10]===C[10]&&v[11]===C[11]&&v[12]===C[12]&&v[13]===C[13]&&v[14]===C[14]&&v[15]===C[15]},Ee.equals=function(v,C){var I=v[0],S=v[1],M=v[2],R=v[3],O=v[4],F=v[5],H=v[6],W=v[7],V=v[8],Z=v[9],Y=v[10],ne=v[11],ye=v[12],_e=v[13],ge=v[14],Re=v[15],we=C[0],Le=C[1],Be=C[2],Oe=C[3],Ve=C[4],We=C[5],Qe=C[6],Ge=C[7],ut=C[8],It=C[9],dt=C[10],Dt=C[11],kt=C[12],$t=C[13],_t=C[14],er=C[15];return Math.abs(I-we)<=t.EPSILON*Math.max(1,Math.abs(I),Math.abs(we))&&Math.abs(S-Le)<=t.EPSILON*Math.max(1,Math.abs(S),Math.abs(Le))&&Math.abs(M-Be)<=t.EPSILON*Math.max(1,Math.abs(M),Math.abs(Be))&&Math.abs(R-Oe)<=t.EPSILON*Math.max(1,Math.abs(R),Math.abs(Oe))&&Math.abs(O-Ve)<=t.EPSILON*Math.max(1,Math.abs(O),Math.abs(Ve))&&Math.abs(F-We)<=t.EPSILON*Math.max(1,Math.abs(F),Math.abs(We))&&Math.abs(H-Qe)<=t.EPSILON*Math.max(1,Math.abs(H),Math.abs(Qe))&&Math.abs(W-Ge)<=t.EPSILON*Math.max(1,Math.abs(W),Math.abs(Ge))&&Math.abs(V-ut)<=t.EPSILON*Math.max(1,Math.abs(V),Math.abs(ut))&&Math.abs(Z-It)<=t.EPSILON*Math.max(1,Math.abs(Z),Math.abs(It))&&Math.abs(Y-dt)<=t.EPSILON*Math.max(1,Math.abs(Y),Math.abs(dt))&&Math.abs(ne-Dt)<=t.EPSILON*Math.max(1,Math.abs(ne),Math.abs(Dt))&&Math.abs(ye-kt)<=t.EPSILON*Math.max(1,Math.abs(ye),Math.abs(kt))&&Math.abs(_e-$t)<=t.EPSILON*Math.max(1,Math.abs(_e),Math.abs($t))&&Math.abs(ge-_t)<=t.EPSILON*Math.max(1,Math.abs(ge),Math.abs(_t))&&Math.abs(Re-er)<=t.EPSILON*Math.max(1,Math.abs(Re),Math.abs(er))},Ee.sub=Ee.mul=Ee.ortho=Ee.perspective=void 0;var t=function(v,C){if(v&&v.__esModule)return v;if(v===null||l(v)!=="object"&&typeof v!="function")return{default:v};var I=o(void 0);if(I&&I.has(v))return I.get(v);var S={},M=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var R in v)if(R!=="default"&&Object.prototype.hasOwnProperty.call(v,R)){var O=M?Object.getOwnPropertyDescriptor(v,R):null;O&&(O.get||O.set)?Object.defineProperty(S,R,O):S[R]=v[R]}return S.default=v,I&&I.set(v,S),S}(X());function o(v){if(typeof WeakMap!="function")return null;var C=new WeakMap,I=new WeakMap;return(o=function(S){return S?I:C})(v)}function u(v){return v[0]=1,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=1,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=1,v[11]=0,v[12]=0,v[13]=0,v[14]=0,v[15]=1,v}function m(v,C,I){var S=C[0],M=C[1],R=C[2],O=C[3],F=C[4],H=C[5],W=C[6],V=C[7],Z=C[8],Y=C[9],ne=C[10],ye=C[11],_e=C[12],ge=C[13],Re=C[14],we=C[15],Le=I[0],Be=I[1],Oe=I[2],Ve=I[3];return v[0]=Le*S+Be*F+Oe*Z+Ve*_e,v[1]=Le*M+Be*H+Oe*Y+Ve*ge,v[2]=Le*R+Be*W+Oe*ne+Ve*Re,v[3]=Le*O+Be*V+Oe*ye+Ve*we,v[4]=(Le=I[4])*S+(Be=I[5])*F+(Oe=I[6])*Z+(Ve=I[7])*_e,v[5]=Le*M+Be*H+Oe*Y+Ve*ge,v[6]=Le*R+Be*W+Oe*ne+Ve*Re,v[7]=Le*O+Be*V+Oe*ye+Ve*we,v[8]=(Le=I[8])*S+(Be=I[9])*F+(Oe=I[10])*Z+(Ve=I[11])*_e,v[9]=Le*M+Be*H+Oe*Y+Ve*ge,v[10]=Le*R+Be*W+Oe*ne+Ve*Re,v[11]=Le*O+Be*V+Oe*ye+Ve*we,v[12]=(Le=I[12])*S+(Be=I[13])*F+(Oe=I[14])*Z+(Ve=I[15])*_e,v[13]=Le*M+Be*H+Oe*Y+Ve*ge,v[14]=Le*R+Be*W+Oe*ne+Ve*Re,v[15]=Le*O+Be*V+Oe*ye+Ve*we,v}function h(v,C,I){var S=C[0],M=C[1],R=C[2],O=C[3],F=S+S,H=M+M,W=R+R,V=S*F,Z=S*H,Y=S*W,ne=M*H,ye=M*W,_e=R*W,ge=O*F,Re=O*H,we=O*W;return v[0]=1-(ne+_e),v[1]=Z+we,v[2]=Y-Re,v[3]=0,v[4]=Z-we,v[5]=1-(V+_e),v[6]=ye+ge,v[7]=0,v[8]=Y+Re,v[9]=ye-ge,v[10]=1-(V+ne),v[11]=0,v[12]=I[0],v[13]=I[1],v[14]=I[2],v[15]=1,v}function g(v,C){var I=C[4],S=C[5],M=C[6],R=C[8],O=C[9],F=C[10];return v[0]=Math.hypot(C[0],C[1],C[2]),v[1]=Math.hypot(I,S,M),v[2]=Math.hypot(R,O,F),v}function b(v,C,I,S,M){var R,O=1/Math.tan(C/2);return v[0]=O/I,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=O,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[11]=-1,v[12]=0,v[13]=0,v[15]=0,M!=null&&M!==1/0?(v[10]=(M+S)*(R=1/(S-M)),v[14]=2*M*S*R):(v[10]=-1,v[14]=-2*S),v}function E(v,C,I,S,M,R,O){var F=1/(C-I),H=1/(S-M),W=1/(R-O);return v[0]=-2*F,v[1]=0,v[2]=0,v[3]=0,v[4]=0,v[5]=-2*H,v[6]=0,v[7]=0,v[8]=0,v[9]=0,v[10]=2*W,v[11]=0,v[12]=(C+I)*F,v[13]=(M+S)*H,v[14]=(O+R)*W,v[15]=1,v}function A(v,C,I){return v[0]=C[0]-I[0],v[1]=C[1]-I[1],v[2]=C[2]-I[2],v[3]=C[3]-I[3],v[4]=C[4]-I[4],v[5]=C[5]-I[5],v[6]=C[6]-I[6],v[7]=C[7]-I[7],v[8]=C[8]-I[8],v[9]=C[9]-I[9],v[10]=C[10]-I[10],v[11]=C[11]-I[11],v[12]=C[12]-I[12],v[13]=C[13]-I[13],v[14]=C[14]-I[14],v[15]=C[15]-I[15],v}return Ee.perspective=b,Ee.ortho=E,Ee.mul=m,Ee.sub=A,Ee}var Xe,Fe={},Je={};function Ct(){if(Xe)return Je;function l(M){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(R){return typeof R}:function(R){return R&&typeof Symbol=="function"&&R.constructor===Symbol&&R!==Symbol.prototype?"symbol":typeof R},l(M)}Xe=1,Object.defineProperty(Je,"__esModule",{value:!0}),Je.create=u,Je.clone=function(M){var R=new t.ARRAY_TYPE(3);return R[0]=M[0],R[1]=M[1],R[2]=M[2],R},Je.length=m,Je.fromValues=function(M,R,O){var F=new t.ARRAY_TYPE(3);return F[0]=M,F[1]=R,F[2]=O,F},Je.copy=function(M,R){return M[0]=R[0],M[1]=R[1],M[2]=R[2],M},Je.set=function(M,R,O,F){return M[0]=R,M[1]=O,M[2]=F,M},Je.add=function(M,R,O){return M[0]=R[0]+O[0],M[1]=R[1]+O[1],M[2]=R[2]+O[2],M},Je.subtract=h,Je.multiply=g,Je.divide=b,Je.ceil=function(M,R){return M[0]=Math.ceil(R[0]),M[1]=Math.ceil(R[1]),M[2]=Math.ceil(R[2]),M},Je.floor=function(M,R){return M[0]=Math.floor(R[0]),M[1]=Math.floor(R[1]),M[2]=Math.floor(R[2]),M},Je.min=function(M,R,O){return M[0]=Math.min(R[0],O[0]),M[1]=Math.min(R[1],O[1]),M[2]=Math.min(R[2],O[2]),M},Je.max=function(M,R,O){return M[0]=Math.max(R[0],O[0]),M[1]=Math.max(R[1],O[1]),M[2]=Math.max(R[2],O[2]),M},Je.round=function(M,R){return M[0]=Math.round(R[0]),M[1]=Math.round(R[1]),M[2]=Math.round(R[2]),M},Je.scale=function(M,R,O){return M[0]=R[0]*O,M[1]=R[1]*O,M[2]=R[2]*O,M},Je.scaleAndAdd=function(M,R,O,F){return M[0]=R[0]+O[0]*F,M[1]=R[1]+O[1]*F,M[2]=R[2]+O[2]*F,M},Je.distance=E,Je.squaredDistance=A,Je.squaredLength=v,Je.negate=function(M,R){return M[0]=-R[0],M[1]=-R[1],M[2]=-R[2],M},Je.inverse=function(M,R){return M[0]=1/R[0],M[1]=1/R[1],M[2]=1/R[2],M},Je.normalize=function(M,R){var O=R[0],F=R[1],H=R[2],W=O*O+F*F+H*H;return W>0&&(W=1/Math.sqrt(W)),M[0]=R[0]*W,M[1]=R[1]*W,M[2]=R[2]*W,M},Je.dot=C,Je.cross=function(M,R,O){var F=R[0],H=R[1],W=R[2],V=O[0],Z=O[1],Y=O[2];return M[0]=H*Y-W*Z,M[1]=W*V-F*Y,M[2]=F*Z-H*V,M},Je.lerp=function(M,R,O,F){var H=R[0],W=R[1],V=R[2];return M[0]=H+F*(O[0]-H),M[1]=W+F*(O[1]-W),M[2]=V+F*(O[2]-V),M},Je.hermite=function(M,R,O,F,H,W){var V=W*W,Z=V*(2*W-3)+1,Y=V*(W-2)+W,ne=V*(W-1),ye=V*(3-2*W);return M[0]=R[0]*Z+O[0]*Y+F[0]*ne+H[0]*ye,M[1]=R[1]*Z+O[1]*Y+F[1]*ne+H[1]*ye,M[2]=R[2]*Z+O[2]*Y+F[2]*ne+H[2]*ye,M},Je.bezier=function(M,R,O,F,H,W){var V=1-W,Z=V*V,Y=W*W,ne=Z*V,ye=3*W*Z,_e=3*Y*V,ge=Y*W;return M[0]=R[0]*ne+O[0]*ye+F[0]*_e+H[0]*ge,M[1]=R[1]*ne+O[1]*ye+F[1]*_e+H[1]*ge,M[2]=R[2]*ne+O[2]*ye+F[2]*_e+H[2]*ge,M},Je.random=function(M,R){R=R||1;var O=2*t.RANDOM()*Math.PI,F=2*t.RANDOM()-1,H=Math.sqrt(1-F*F)*R;return M[0]=Math.cos(O)*H,M[1]=Math.sin(O)*H,M[2]=F*R,M},Je.transformMat4=function(M,R,O){var F=R[0],H=R[1],W=R[2],V=O[3]*F+O[7]*H+O[11]*W+O[15];return M[0]=(O[0]*F+O[4]*H+O[8]*W+O[12])/(V=V||1),M[1]=(O[1]*F+O[5]*H+O[9]*W+O[13])/V,M[2]=(O[2]*F+O[6]*H+O[10]*W+O[14])/V,M},Je.transformMat3=function(M,R,O){var F=R[0],H=R[1],W=R[2];return M[0]=F*O[0]+H*O[3]+W*O[6],M[1]=F*O[1]+H*O[4]+W*O[7],M[2]=F*O[2]+H*O[5]+W*O[8],M},Je.transformQuat=function(M,R,O){var F=O[0],H=O[1],W=O[2],V=R[0],Z=R[1],Y=R[2],ne=H*Y-W*Z,ye=W*V-F*Y,_e=F*Z-H*V,ge=H*_e-W*ye,Re=W*ne-F*_e,we=F*ye-H*ne,Le=2*O[3];return ye*=Le,_e*=Le,Re*=2,we*=2,M[0]=V+(ne*=Le)+(ge*=2),M[1]=Z+ye+Re,M[2]=Y+_e+we,M},Je.rotateX=function(M,R,O,F){var H=[],W=[];return H[0]=R[0]-O[0],H[1]=R[1]-O[1],H[2]=R[2]-O[2],W[0]=H[0],W[1]=H[1]*Math.cos(F)-H[2]*Math.sin(F),W[2]=H[1]*Math.sin(F)+H[2]*Math.cos(F),M[0]=W[0]+O[0],M[1]=W[1]+O[1],M[2]=W[2]+O[2],M},Je.rotateY=function(M,R,O,F){var H=[],W=[];return H[0]=R[0]-O[0],H[1]=R[1]-O[1],H[2]=R[2]-O[2],W[0]=H[2]*Math.sin(F)+H[0]*Math.cos(F),W[1]=H[1],W[2]=H[2]*Math.cos(F)-H[0]*Math.sin(F),M[0]=W[0]+O[0],M[1]=W[1]+O[1],M[2]=W[2]+O[2],M},Je.rotateZ=function(M,R,O,F){var H=[],W=[];return H[0]=R[0]-O[0],H[1]=R[1]-O[1],H[2]=R[2]-O[2],W[0]=H[0]*Math.cos(F)-H[1]*Math.sin(F),W[1]=H[0]*Math.sin(F)+H[1]*Math.cos(F),W[2]=H[2],M[0]=W[0]+O[0],M[1]=W[1]+O[1],M[2]=W[2]+O[2],M},Je.angle=function(M,R){var O=M[0],F=M[1],H=M[2],W=R[0],V=R[1],Z=R[2],Y=Math.sqrt(O*O+F*F+H*H)*Math.sqrt(W*W+V*V+Z*Z),ne=Y&&C(M,R)/Y;return Math.acos(Math.min(Math.max(ne,-1),1))},Je.zero=function(M){return M[0]=0,M[1]=0,M[2]=0,M},Je.str=function(M){return"vec3("+M[0]+", "+M[1]+", "+M[2]+")"},Je.exactEquals=function(M,R){return M[0]===R[0]&&M[1]===R[1]&&M[2]===R[2]},Je.equals=function(M,R){var O=M[0],F=M[1],H=M[2],W=R[0],V=R[1],Z=R[2];return Math.abs(O-W)<=t.EPSILON*Math.max(1,Math.abs(O),Math.abs(W))&&Math.abs(F-V)<=t.EPSILON*Math.max(1,Math.abs(F),Math.abs(V))&&Math.abs(H-Z)<=t.EPSILON*Math.max(1,Math.abs(H),Math.abs(Z))},Je.forEach=Je.sqrLen=Je.len=Je.sqrDist=Je.dist=Je.div=Je.mul=Je.sub=void 0;var t=function(M,R){if(M&&M.__esModule)return M;if(M===null||l(M)!=="object"&&typeof M!="function")return{default:M};var O=o(void 0);if(O&&O.has(M))return O.get(M);var F={},H=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var W in M)if(W!=="default"&&Object.prototype.hasOwnProperty.call(M,W)){var V=H?Object.getOwnPropertyDescriptor(M,W):null;V&&(V.get||V.set)?Object.defineProperty(F,W,V):F[W]=M[W]}return F.default=M,O&&O.set(M,F),F}(X());function o(M){if(typeof WeakMap!="function")return null;var R=new WeakMap,O=new WeakMap;return(o=function(F){return F?O:R})(M)}function u(){var M=new t.ARRAY_TYPE(3);return t.ARRAY_TYPE!=Float32Array&&(M[0]=0,M[1]=0,M[2]=0),M}function m(M){return Math.hypot(M[0],M[1],M[2])}function h(M,R,O){return M[0]=R[0]-O[0],M[1]=R[1]-O[1],M[2]=R[2]-O[2],M}function g(M,R,O){return M[0]=R[0]*O[0],M[1]=R[1]*O[1],M[2]=R[2]*O[2],M}function b(M,R,O){return M[0]=R[0]/O[0],M[1]=R[1]/O[1],M[2]=R[2]/O[2],M}function E(M,R){return Math.hypot(R[0]-M[0],R[1]-M[1],R[2]-M[2])}function A(M,R){var O=R[0]-M[0],F=R[1]-M[1],H=R[2]-M[2];return O*O+F*F+H*H}function v(M){var R=M[0],O=M[1],F=M[2];return R*R+O*O+F*F}function C(M,R){return M[0]*R[0]+M[1]*R[1]+M[2]*R[2]}Je.sub=h,Je.mul=g,Je.div=b,Je.dist=E,Je.sqrDist=A,Je.len=m,Je.sqrLen=v;var I,S=(I=u(),function(M,R,O,F,H,W){var V,Z;for(R||(R=3),O||(O=0),Z=F?Math.min(F*R+O,M.length):M.length,V=O;V<Z;V+=R)I[0]=M[V],I[1]=M[V+1],I[2]=M[V+2],H(I,I,W),M[V]=I[0],M[V+1]=I[1],M[V+2]=I[2];return M});return Je.forEach=S,Je}var ft,yt,lt={};function ct(){if(ft)return lt;function l(S){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},l(S)}ft=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.create=u,lt.clone=function(S){var M=new t.ARRAY_TYPE(4);return M[0]=S[0],M[1]=S[1],M[2]=S[2],M[3]=S[3],M},lt.fromValues=function(S,M,R,O){var F=new t.ARRAY_TYPE(4);return F[0]=S,F[1]=M,F[2]=R,F[3]=O,F},lt.copy=function(S,M){return S[0]=M[0],S[1]=M[1],S[2]=M[2],S[3]=M[3],S},lt.set=function(S,M,R,O,F){return S[0]=M,S[1]=R,S[2]=O,S[3]=F,S},lt.add=function(S,M,R){return S[0]=M[0]+R[0],S[1]=M[1]+R[1],S[2]=M[2]+R[2],S[3]=M[3]+R[3],S},lt.subtract=m,lt.multiply=h,lt.divide=g,lt.ceil=function(S,M){return S[0]=Math.ceil(M[0]),S[1]=Math.ceil(M[1]),S[2]=Math.ceil(M[2]),S[3]=Math.ceil(M[3]),S},lt.floor=function(S,M){return S[0]=Math.floor(M[0]),S[1]=Math.floor(M[1]),S[2]=Math.floor(M[2]),S[3]=Math.floor(M[3]),S},lt.min=function(S,M,R){return S[0]=Math.min(M[0],R[0]),S[1]=Math.min(M[1],R[1]),S[2]=Math.min(M[2],R[2]),S[3]=Math.min(M[3],R[3]),S},lt.max=function(S,M,R){return S[0]=Math.max(M[0],R[0]),S[1]=Math.max(M[1],R[1]),S[2]=Math.max(M[2],R[2]),S[3]=Math.max(M[3],R[3]),S},lt.round=function(S,M){return S[0]=Math.round(M[0]),S[1]=Math.round(M[1]),S[2]=Math.round(M[2]),S[3]=Math.round(M[3]),S},lt.scale=function(S,M,R){return S[0]=M[0]*R,S[1]=M[1]*R,S[2]=M[2]*R,S[3]=M[3]*R,S},lt.scaleAndAdd=function(S,M,R,O){return S[0]=M[0]+R[0]*O,S[1]=M[1]+R[1]*O,S[2]=M[2]+R[2]*O,S[3]=M[3]+R[3]*O,S},lt.distance=b,lt.squaredDistance=E,lt.length=A,lt.squaredLength=v,lt.negate=function(S,M){return S[0]=-M[0],S[1]=-M[1],S[2]=-M[2],S[3]=-M[3],S},lt.inverse=function(S,M){return S[0]=1/M[0],S[1]=1/M[1],S[2]=1/M[2],S[3]=1/M[3],S},lt.normalize=function(S,M){var R=M[0],O=M[1],F=M[2],H=M[3],W=R*R+O*O+F*F+H*H;return W>0&&(W=1/Math.sqrt(W)),S[0]=R*W,S[1]=O*W,S[2]=F*W,S[3]=H*W,S},lt.dot=function(S,M){return S[0]*M[0]+S[1]*M[1]+S[2]*M[2]+S[3]*M[3]},lt.cross=function(S,M,R,O){var F=R[0]*O[1]-R[1]*O[0],H=R[0]*O[2]-R[2]*O[0],W=R[0]*O[3]-R[3]*O[0],V=R[1]*O[2]-R[2]*O[1],Z=R[1]*O[3]-R[3]*O[1],Y=R[2]*O[3]-R[3]*O[2],ne=M[0],ye=M[1],_e=M[2],ge=M[3];return S[0]=ye*Y-_e*Z+ge*V,S[1]=-ne*Y+_e*W-ge*H,S[2]=ne*Z-ye*W+ge*F,S[3]=-ne*V+ye*H-_e*F,S},lt.lerp=function(S,M,R,O){var F=M[0],H=M[1],W=M[2],V=M[3];return S[0]=F+O*(R[0]-F),S[1]=H+O*(R[1]-H),S[2]=W+O*(R[2]-W),S[3]=V+O*(R[3]-V),S},lt.random=function(S,M){var R,O,F,H,W,V;M=M||1;do W=(R=2*t.RANDOM()-1)*R+(O=2*t.RANDOM()-1)*O;while(W>=1);do V=(F=2*t.RANDOM()-1)*F+(H=2*t.RANDOM()-1)*H;while(V>=1);var Z=Math.sqrt((1-W)/V);return S[0]=M*R,S[1]=M*O,S[2]=M*F*Z,S[3]=M*H*Z,S},lt.transformMat4=function(S,M,R){var O=M[0],F=M[1],H=M[2],W=M[3];return S[0]=R[0]*O+R[4]*F+R[8]*H+R[12]*W,S[1]=R[1]*O+R[5]*F+R[9]*H+R[13]*W,S[2]=R[2]*O+R[6]*F+R[10]*H+R[14]*W,S[3]=R[3]*O+R[7]*F+R[11]*H+R[15]*W,S},lt.transformQuat=function(S,M,R){var O=M[0],F=M[1],H=M[2],W=R[0],V=R[1],Z=R[2],Y=R[3],ne=Y*O+V*H-Z*F,ye=Y*F+Z*O-W*H,_e=Y*H+W*F-V*O,ge=-W*O-V*F-Z*H;return S[0]=ne*Y+ge*-W+ye*-Z-_e*-V,S[1]=ye*Y+ge*-V+_e*-W-ne*-Z,S[2]=_e*Y+ge*-Z+ne*-V-ye*-W,S[3]=M[3],S},lt.zero=function(S){return S[0]=0,S[1]=0,S[2]=0,S[3]=0,S},lt.str=function(S){return"vec4("+S[0]+", "+S[1]+", "+S[2]+", "+S[3]+")"},lt.exactEquals=function(S,M){return S[0]===M[0]&&S[1]===M[1]&&S[2]===M[2]&&S[3]===M[3]},lt.equals=function(S,M){var R=S[0],O=S[1],F=S[2],H=S[3],W=M[0],V=M[1],Z=M[2],Y=M[3];return Math.abs(R-W)<=t.EPSILON*Math.max(1,Math.abs(R),Math.abs(W))&&Math.abs(O-V)<=t.EPSILON*Math.max(1,Math.abs(O),Math.abs(V))&&Math.abs(F-Z)<=t.EPSILON*Math.max(1,Math.abs(F),Math.abs(Z))&&Math.abs(H-Y)<=t.EPSILON*Math.max(1,Math.abs(H),Math.abs(Y))},lt.forEach=lt.sqrLen=lt.len=lt.sqrDist=lt.dist=lt.div=lt.mul=lt.sub=void 0;var t=function(S,M){if(S&&S.__esModule)return S;if(S===null||l(S)!=="object"&&typeof S!="function")return{default:S};var R=o(void 0);if(R&&R.has(S))return R.get(S);var O={},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var H in S)if(H!=="default"&&Object.prototype.hasOwnProperty.call(S,H)){var W=F?Object.getOwnPropertyDescriptor(S,H):null;W&&(W.get||W.set)?Object.defineProperty(O,H,W):O[H]=S[H]}return O.default=S,R&&R.set(S,O),O}(X());function o(S){if(typeof WeakMap!="function")return null;var M=new WeakMap,R=new WeakMap;return(o=function(O){return O?R:M})(S)}function u(){var S=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(S[0]=0,S[1]=0,S[2]=0,S[3]=0),S}function m(S,M,R){return S[0]=M[0]-R[0],S[1]=M[1]-R[1],S[2]=M[2]-R[2],S[3]=M[3]-R[3],S}function h(S,M,R){return S[0]=M[0]*R[0],S[1]=M[1]*R[1],S[2]=M[2]*R[2],S[3]=M[3]*R[3],S}function g(S,M,R){return S[0]=M[0]/R[0],S[1]=M[1]/R[1],S[2]=M[2]/R[2],S[3]=M[3]/R[3],S}function b(S,M){return Math.hypot(M[0]-S[0],M[1]-S[1],M[2]-S[2],M[3]-S[3])}function E(S,M){var R=M[0]-S[0],O=M[1]-S[1],F=M[2]-S[2],H=M[3]-S[3];return R*R+O*O+F*F+H*H}function A(S){return Math.hypot(S[0],S[1],S[2],S[3])}function v(S){var M=S[0],R=S[1],O=S[2],F=S[3];return M*M+R*R+O*O+F*F}lt.sub=m,lt.mul=h,lt.div=g,lt.dist=b,lt.sqrDist=E,lt.len=A,lt.sqrLen=v;var C,I=(C=u(),function(S,M,R,O,F,H){var W,V;for(M||(M=4),R||(R=0),V=O?Math.min(O*M+R,S.length):S.length,W=R;W<V;W+=M)C[0]=S[W],C[1]=S[W+1],C[2]=S[W+2],C[3]=S[W+3],F(C,C,H),S[W]=C[0],S[W+1]=C[1],S[W+2]=C[2],S[W+3]=C[3];return S});return lt.forEach=I,lt}function Ye(){if(yt)return Fe;function l(we){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Le){return typeof Le}:function(Le){return Le&&typeof Symbol=="function"&&Le.constructor===Symbol&&Le!==Symbol.prototype?"symbol":typeof Le},l(we)}yt=1,Object.defineProperty(Fe,"__esModule",{value:!0}),Fe.create=b,Fe.identity=function(we){return we[0]=0,we[1]=0,we[2]=0,we[3]=1,we},Fe.setAxisAngle=E,Fe.getAxisAngle=function(we,Le){var Be=2*Math.acos(Le[3]),Oe=Math.sin(Be/2);return Oe>t.EPSILON?(we[0]=Le[0]/Oe,we[1]=Le[1]/Oe,we[2]=Le[2]/Oe):(we[0]=1,we[1]=0,we[2]=0),Be},Fe.getAngle=function(we,Le){var Be=R(we,Le);return Math.acos(2*Be*Be-1)},Fe.multiply=A,Fe.rotateX=function(we,Le,Be){Be*=.5;var Oe=Le[0],Ve=Le[1],We=Le[2],Qe=Le[3],Ge=Math.sin(Be),ut=Math.cos(Be);return we[0]=Oe*ut+Qe*Ge,we[1]=Ve*ut+We*Ge,we[2]=We*ut-Ve*Ge,we[3]=Qe*ut-Oe*Ge,we},Fe.rotateY=function(we,Le,Be){Be*=.5;var Oe=Le[0],Ve=Le[1],We=Le[2],Qe=Le[3],Ge=Math.sin(Be),ut=Math.cos(Be);return we[0]=Oe*ut-We*Ge,we[1]=Ve*ut+Qe*Ge,we[2]=We*ut+Oe*Ge,we[3]=Qe*ut-Ve*Ge,we},Fe.rotateZ=function(we,Le,Be){Be*=.5;var Oe=Le[0],Ve=Le[1],We=Le[2],Qe=Le[3],Ge=Math.sin(Be),ut=Math.cos(Be);return we[0]=Oe*ut+Ve*Ge,we[1]=Ve*ut-Oe*Ge,we[2]=We*ut+Qe*Ge,we[3]=Qe*ut-We*Ge,we},Fe.calculateW=function(we,Le){var Be=Le[0],Oe=Le[1],Ve=Le[2];return we[0]=Be,we[1]=Oe,we[2]=Ve,we[3]=Math.sqrt(Math.abs(1-Be*Be-Oe*Oe-Ve*Ve)),we},Fe.exp=v,Fe.ln=C,Fe.pow=function(we,Le,Be){return C(we,Le),M(we,we,Be),v(we,we),we},Fe.slerp=I,Fe.random=function(we){var Le=t.RANDOM(),Be=t.RANDOM(),Oe=t.RANDOM(),Ve=Math.sqrt(1-Le),We=Math.sqrt(Le);return we[0]=Ve*Math.sin(2*Math.PI*Be),we[1]=Ve*Math.cos(2*Math.PI*Be),we[2]=We*Math.sin(2*Math.PI*Oe),we[3]=We*Math.cos(2*Math.PI*Oe),we},Fe.invert=function(we,Le){var Be=Le[0],Oe=Le[1],Ve=Le[2],We=Le[3],Qe=Be*Be+Oe*Oe+Ve*Ve+We*We,Ge=Qe?1/Qe:0;return we[0]=-Be*Ge,we[1]=-Oe*Ge,we[2]=-Ve*Ge,we[3]=We*Ge,we},Fe.conjugate=function(we,Le){return we[0]=-Le[0],we[1]=-Le[1],we[2]=-Le[2],we[3]=Le[3],we},Fe.fromMat3=S,Fe.fromEuler=function(we,Le,Be,Oe){var Ve=.5*Math.PI/180;Le*=Ve,Be*=Ve,Oe*=Ve;var We=Math.sin(Le),Qe=Math.cos(Le),Ge=Math.sin(Be),ut=Math.cos(Be),It=Math.sin(Oe),dt=Math.cos(Oe);return we[0]=We*ut*dt-Qe*Ge*It,we[1]=Qe*Ge*dt+We*ut*It,we[2]=Qe*ut*It-We*Ge*dt,we[3]=Qe*ut*dt+We*Ge*It,we},Fe.str=function(we){return"quat("+we[0]+", "+we[1]+", "+we[2]+", "+we[3]+")"},Fe.setAxes=Fe.sqlerp=Fe.rotationTo=Fe.equals=Fe.exactEquals=Fe.normalize=Fe.sqrLen=Fe.squaredLength=Fe.len=Fe.length=Fe.lerp=Fe.dot=Fe.scale=Fe.mul=Fe.add=Fe.set=Fe.copy=Fe.fromValues=Fe.clone=void 0;var t=g(X()),o=g(Te()),u=g(Ct()),m=g(ct());function h(we){if(typeof WeakMap!="function")return null;var Le=new WeakMap,Be=new WeakMap;return(h=function(Oe){return Oe?Be:Le})(we)}function g(we,Le){if(we&&we.__esModule)return we;if(we===null||l(we)!=="object"&&typeof we!="function")return{default:we};var Be=h(Le);if(Be&&Be.has(we))return Be.get(we);var Oe={},Ve=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var We in we)if(We!=="default"&&Object.prototype.hasOwnProperty.call(we,We)){var Qe=Ve?Object.getOwnPropertyDescriptor(we,We):null;Qe&&(Qe.get||Qe.set)?Object.defineProperty(Oe,We,Qe):Oe[We]=we[We]}return Oe.default=we,Be&&Be.set(we,Oe),Oe}function b(){var we=new t.ARRAY_TYPE(4);return t.ARRAY_TYPE!=Float32Array&&(we[0]=0,we[1]=0,we[2]=0),we[3]=1,we}function E(we,Le,Be){Be*=.5;var Oe=Math.sin(Be);return we[0]=Oe*Le[0],we[1]=Oe*Le[1],we[2]=Oe*Le[2],we[3]=Math.cos(Be),we}function A(we,Le,Be){var Oe=Le[0],Ve=Le[1],We=Le[2],Qe=Le[3],Ge=Be[0],ut=Be[1],It=Be[2],dt=Be[3];return we[0]=Oe*dt+Qe*Ge+Ve*It-We*ut,we[1]=Ve*dt+Qe*ut+We*Ge-Oe*It,we[2]=We*dt+Qe*It+Oe*ut-Ve*Ge,we[3]=Qe*dt-Oe*Ge-Ve*ut-We*It,we}function v(we,Le){var Be=Le[0],Oe=Le[1],Ve=Le[2],We=Le[3],Qe=Math.sqrt(Be*Be+Oe*Oe+Ve*Ve),Ge=Math.exp(We),ut=Qe>0?Ge*Math.sin(Qe)/Qe:0;return we[0]=Be*ut,we[1]=Oe*ut,we[2]=Ve*ut,we[3]=Ge*Math.cos(Qe),we}function C(we,Le){var Be=Le[0],Oe=Le[1],Ve=Le[2],We=Le[3],Qe=Math.sqrt(Be*Be+Oe*Oe+Ve*Ve),Ge=Qe>0?Math.atan2(Qe,We)/Qe:0;return we[0]=Be*Ge,we[1]=Oe*Ge,we[2]=Ve*Ge,we[3]=.5*Math.log(Be*Be+Oe*Oe+Ve*Ve+We*We),we}function I(we,Le,Be,Oe){var Ve,We,Qe,Ge,ut,It=Le[0],dt=Le[1],Dt=Le[2],kt=Le[3],$t=Be[0],_t=Be[1],er=Be[2],Ot=Be[3];return(We=It*$t+dt*_t+Dt*er+kt*Ot)<0&&(We=-We,$t=-$t,_t=-_t,er=-er,Ot=-Ot),1-We>t.EPSILON?(Ve=Math.acos(We),Qe=Math.sin(Ve),Ge=Math.sin((1-Oe)*Ve)/Qe,ut=Math.sin(Oe*Ve)/Qe):(Ge=1-Oe,ut=Oe),we[0]=Ge*It+ut*$t,we[1]=Ge*dt+ut*_t,we[2]=Ge*Dt+ut*er,we[3]=Ge*kt+ut*Ot,we}function S(we,Le){var Be,Oe=Le[0]+Le[4]+Le[8];if(Oe>0)Be=Math.sqrt(Oe+1),we[3]=.5*Be,we[0]=(Le[5]-Le[7])*(Be=.5/Be),we[1]=(Le[6]-Le[2])*Be,we[2]=(Le[1]-Le[3])*Be;else{var Ve=0;Le[4]>Le[0]&&(Ve=1),Le[8]>Le[3*Ve+Ve]&&(Ve=2);var We=(Ve+1)%3,Qe=(Ve+2)%3;Be=Math.sqrt(Le[3*Ve+Ve]-Le[3*We+We]-Le[3*Qe+Qe]+1),we[Ve]=.5*Be,we[3]=(Le[3*We+Qe]-Le[3*Qe+We])*(Be=.5/Be),we[We]=(Le[3*We+Ve]+Le[3*Ve+We])*Be,we[Qe]=(Le[3*Qe+Ve]+Le[3*Ve+Qe])*Be}return we}Fe.clone=m.clone,Fe.fromValues=m.fromValues,Fe.copy=m.copy,Fe.set=m.set,Fe.add=m.add,Fe.mul=A;var M=m.scale;Fe.scale=M;var R=m.dot;Fe.dot=R,Fe.lerp=m.lerp;var O=m.length;Fe.length=O,Fe.len=O;var F=m.squaredLength;Fe.squaredLength=F,Fe.sqrLen=F;var H=m.normalize;Fe.normalize=H,Fe.exactEquals=m.exactEquals,Fe.equals=m.equals;var W,V,Z,Y=(W=u.create(),V=u.fromValues(1,0,0),Z=u.fromValues(0,1,0),function(we,Le,Be){var Oe=u.dot(Le,Be);return Oe<-.999999?(u.cross(W,V,Le),u.len(W)<1e-6&&u.cross(W,Z,Le),u.normalize(W,W),E(we,W,Math.PI),we):Oe>.999999?(we[0]=0,we[1]=0,we[2]=0,we[3]=1,we):(u.cross(W,Le,Be),we[0]=W[0],we[1]=W[1],we[2]=W[2],we[3]=1+Oe,H(we,we))});Fe.rotationTo=Y;var ne,ye,_e=(ne=b(),ye=b(),function(we,Le,Be,Oe,Ve,We){return I(ne,Le,Ve,We),I(ye,Be,Oe,We),I(we,ne,ye,2*We*(1-We)),we});Fe.sqlerp=_e;var ge,Re=(ge=o.create(),function(we,Le,Be,Oe){return ge[0]=Be[0],ge[3]=Be[1],ge[6]=Be[2],ge[1]=Oe[0],ge[4]=Oe[1],ge[7]=Oe[2],ge[2]=-Le[0],ge[5]=-Le[1],ge[8]=-Le[2],H(we,S(we,ge))});return Fe.setAxes=Re,Fe}var Ke,tt={};function ht(){if(Ke)return tt;function l(I){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(S){return typeof S}:function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S},l(I)}Ke=1,Object.defineProperty(tt,"__esModule",{value:!0}),tt.create=function(){var I=new t.ARRAY_TYPE(8);return t.ARRAY_TYPE!=Float32Array&&(I[0]=0,I[1]=0,I[2]=0,I[4]=0,I[5]=0,I[6]=0,I[7]=0),I[3]=1,I},tt.clone=function(I){var S=new t.ARRAY_TYPE(8);return S[0]=I[0],S[1]=I[1],S[2]=I[2],S[3]=I[3],S[4]=I[4],S[5]=I[5],S[6]=I[6],S[7]=I[7],S},tt.fromValues=function(I,S,M,R,O,F,H,W){var V=new t.ARRAY_TYPE(8);return V[0]=I,V[1]=S,V[2]=M,V[3]=R,V[4]=O,V[5]=F,V[6]=H,V[7]=W,V},tt.fromRotationTranslationValues=function(I,S,M,R,O,F,H){var W=new t.ARRAY_TYPE(8);W[0]=I,W[1]=S,W[2]=M,W[3]=R;var V=.5*O,Z=.5*F,Y=.5*H;return W[4]=V*R+Z*M-Y*S,W[5]=Z*R+Y*I-V*M,W[6]=Y*R+V*S-Z*I,W[7]=-V*I-Z*S-Y*M,W},tt.fromRotationTranslation=g,tt.fromTranslation=function(I,S){return I[0]=0,I[1]=0,I[2]=0,I[3]=1,I[4]=.5*S[0],I[5]=.5*S[1],I[6]=.5*S[2],I[7]=0,I},tt.fromRotation=function(I,S){return I[0]=S[0],I[1]=S[1],I[2]=S[2],I[3]=S[3],I[4]=0,I[5]=0,I[6]=0,I[7]=0,I},tt.fromMat4=function(I,S){var M=o.create();u.getRotation(M,S);var R=new t.ARRAY_TYPE(3);return u.getTranslation(R,S),g(I,M,R),I},tt.copy=b,tt.identity=function(I){return I[0]=0,I[1]=0,I[2]=0,I[3]=1,I[4]=0,I[5]=0,I[6]=0,I[7]=0,I},tt.set=function(I,S,M,R,O,F,H,W,V){return I[0]=S,I[1]=M,I[2]=R,I[3]=O,I[4]=F,I[5]=H,I[6]=W,I[7]=V,I},tt.getDual=function(I,S){return I[0]=S[4],I[1]=S[5],I[2]=S[6],I[3]=S[7],I},tt.setDual=function(I,S){return I[4]=S[0],I[5]=S[1],I[6]=S[2],I[7]=S[3],I},tt.getTranslation=function(I,S){var M=S[4],R=S[5],O=S[6],F=S[7],H=-S[0],W=-S[1],V=-S[2],Z=S[3];return I[0]=2*(M*Z+F*H+R*V-O*W),I[1]=2*(R*Z+F*W+O*H-M*V),I[2]=2*(O*Z+F*V+M*W-R*H),I},tt.translate=function(I,S,M){var R=S[0],O=S[1],F=S[2],H=S[3],W=.5*M[0],V=.5*M[1],Z=.5*M[2],Y=S[4],ne=S[5],ye=S[6],_e=S[7];return I[0]=R,I[1]=O,I[2]=F,I[3]=H,I[4]=H*W+O*Z-F*V+Y,I[5]=H*V+F*W-R*Z+ne,I[6]=H*Z+R*V-O*W+ye,I[7]=-R*W-O*V-F*Z+_e,I},tt.rotateX=function(I,S,M){var R=-S[0],O=-S[1],F=-S[2],H=S[3],W=S[4],V=S[5],Z=S[6],Y=S[7],ne=W*H+Y*R+V*F-Z*O,ye=V*H+Y*O+Z*R-W*F,_e=Z*H+Y*F+W*O-V*R,ge=Y*H-W*R-V*O-Z*F;return o.rotateX(I,S,M),I[4]=ne*(H=I[3])+ge*(R=I[0])+ye*(F=I[2])-_e*(O=I[1]),I[5]=ye*H+ge*O+_e*R-ne*F,I[6]=_e*H+ge*F+ne*O-ye*R,I[7]=ge*H-ne*R-ye*O-_e*F,I},tt.rotateY=function(I,S,M){var R=-S[0],O=-S[1],F=-S[2],H=S[3],W=S[4],V=S[5],Z=S[6],Y=S[7],ne=W*H+Y*R+V*F-Z*O,ye=V*H+Y*O+Z*R-W*F,_e=Z*H+Y*F+W*O-V*R,ge=Y*H-W*R-V*O-Z*F;return o.rotateY(I,S,M),I[4]=ne*(H=I[3])+ge*(R=I[0])+ye*(F=I[2])-_e*(O=I[1]),I[5]=ye*H+ge*O+_e*R-ne*F,I[6]=_e*H+ge*F+ne*O-ye*R,I[7]=ge*H-ne*R-ye*O-_e*F,I},tt.rotateZ=function(I,S,M){var R=-S[0],O=-S[1],F=-S[2],H=S[3],W=S[4],V=S[5],Z=S[6],Y=S[7],ne=W*H+Y*R+V*F-Z*O,ye=V*H+Y*O+Z*R-W*F,_e=Z*H+Y*F+W*O-V*R,ge=Y*H-W*R-V*O-Z*F;return o.rotateZ(I,S,M),I[4]=ne*(H=I[3])+ge*(R=I[0])+ye*(F=I[2])-_e*(O=I[1]),I[5]=ye*H+ge*O+_e*R-ne*F,I[6]=_e*H+ge*F+ne*O-ye*R,I[7]=ge*H-ne*R-ye*O-_e*F,I},tt.rotateByQuatAppend=function(I,S,M){var R=M[0],O=M[1],F=M[2],H=M[3],W=S[0],V=S[1],Z=S[2],Y=S[3];return I[0]=W*H+Y*R+V*F-Z*O,I[1]=V*H+Y*O+Z*R-W*F,I[2]=Z*H+Y*F+W*O-V*R,I[3]=Y*H-W*R-V*O-Z*F,I[4]=(W=S[4])*H+(Y=S[7])*R+(V=S[5])*F-(Z=S[6])*O,I[5]=V*H+Y*O+Z*R-W*F,I[6]=Z*H+Y*F+W*O-V*R,I[7]=Y*H-W*R-V*O-Z*F,I},tt.rotateByQuatPrepend=function(I,S,M){var R=S[0],O=S[1],F=S[2],H=S[3],W=M[0],V=M[1],Z=M[2],Y=M[3];return I[0]=R*Y+H*W+O*Z-F*V,I[1]=O*Y+H*V+F*W-R*Z,I[2]=F*Y+H*Z+R*V-O*W,I[3]=H*Y-R*W-O*V-F*Z,I[4]=R*(Y=M[7])+H*(W=M[4])+O*(Z=M[6])-F*(V=M[5]),I[5]=O*Y+H*V+F*W-R*Z,I[6]=F*Y+H*Z+R*V-O*W,I[7]=H*Y-R*W-O*V-F*Z,I},tt.rotateAroundAxis=function(I,S,M,R){if(Math.abs(R)<t.EPSILON)return b(I,S);var O=Math.hypot(M[0],M[1],M[2]);R*=.5;var F=Math.sin(R),H=F*M[0]/O,W=F*M[1]/O,V=F*M[2]/O,Z=Math.cos(R),Y=S[0],ne=S[1],ye=S[2],_e=S[3];I[0]=Y*Z+_e*H+ne*V-ye*W,I[1]=ne*Z+_e*W+ye*H-Y*V,I[2]=ye*Z+_e*V+Y*W-ne*H,I[3]=_e*Z-Y*H-ne*W-ye*V;var ge=S[4],Re=S[5],we=S[6],Le=S[7];return I[4]=ge*Z+Le*H+Re*V-we*W,I[5]=Re*Z+Le*W+we*H-ge*V,I[6]=we*Z+Le*V+ge*W-Re*H,I[7]=Le*Z-ge*H-Re*W-we*V,I},tt.add=function(I,S,M){return I[0]=S[0]+M[0],I[1]=S[1]+M[1],I[2]=S[2]+M[2],I[3]=S[3]+M[3],I[4]=S[4]+M[4],I[5]=S[5]+M[5],I[6]=S[6]+M[6],I[7]=S[7]+M[7],I},tt.multiply=E,tt.scale=function(I,S,M){return I[0]=S[0]*M,I[1]=S[1]*M,I[2]=S[2]*M,I[3]=S[3]*M,I[4]=S[4]*M,I[5]=S[5]*M,I[6]=S[6]*M,I[7]=S[7]*M,I},tt.lerp=function(I,S,M,R){var O=1-R;return A(S,M)<0&&(R=-R),I[0]=S[0]*O+M[0]*R,I[1]=S[1]*O+M[1]*R,I[2]=S[2]*O+M[2]*R,I[3]=S[3]*O+M[3]*R,I[4]=S[4]*O+M[4]*R,I[5]=S[5]*O+M[5]*R,I[6]=S[6]*O+M[6]*R,I[7]=S[7]*O+M[7]*R,I},tt.invert=function(I,S){var M=C(S);return I[0]=-S[0]/M,I[1]=-S[1]/M,I[2]=-S[2]/M,I[3]=S[3]/M,I[4]=-S[4]/M,I[5]=-S[5]/M,I[6]=-S[6]/M,I[7]=S[7]/M,I},tt.conjugate=function(I,S){return I[0]=-S[0],I[1]=-S[1],I[2]=-S[2],I[3]=S[3],I[4]=-S[4],I[5]=-S[5],I[6]=-S[6],I[7]=S[7],I},tt.normalize=function(I,S){var M=C(S);if(M>0){M=Math.sqrt(M);var R=S[0]/M,O=S[1]/M,F=S[2]/M,H=S[3]/M,W=S[4],V=S[5],Z=S[6],Y=S[7],ne=R*W+O*V+F*Z+H*Y;I[0]=R,I[1]=O,I[2]=F,I[3]=H,I[4]=(W-R*ne)/M,I[5]=(V-O*ne)/M,I[6]=(Z-F*ne)/M,I[7]=(Y-H*ne)/M}return I},tt.str=function(I){return"quat2("+I[0]+", "+I[1]+", "+I[2]+", "+I[3]+", "+I[4]+", "+I[5]+", "+I[6]+", "+I[7]+")"},tt.exactEquals=function(I,S){return I[0]===S[0]&&I[1]===S[1]&&I[2]===S[2]&&I[3]===S[3]&&I[4]===S[4]&&I[5]===S[5]&&I[6]===S[6]&&I[7]===S[7]},tt.equals=function(I,S){var M=I[0],R=I[1],O=I[2],F=I[3],H=I[4],W=I[5],V=I[6],Z=I[7],Y=S[0],ne=S[1],ye=S[2],_e=S[3],ge=S[4],Re=S[5],we=S[6],Le=S[7];return Math.abs(M-Y)<=t.EPSILON*Math.max(1,Math.abs(M),Math.abs(Y))&&Math.abs(R-ne)<=t.EPSILON*Math.max(1,Math.abs(R),Math.abs(ne))&&Math.abs(O-ye)<=t.EPSILON*Math.max(1,Math.abs(O),Math.abs(ye))&&Math.abs(F-_e)<=t.EPSILON*Math.max(1,Math.abs(F),Math.abs(_e))&&Math.abs(H-ge)<=t.EPSILON*Math.max(1,Math.abs(H),Math.abs(ge))&&Math.abs(W-Re)<=t.EPSILON*Math.max(1,Math.abs(W),Math.abs(Re))&&Math.abs(V-we)<=t.EPSILON*Math.max(1,Math.abs(V),Math.abs(we))&&Math.abs(Z-Le)<=t.EPSILON*Math.max(1,Math.abs(Z),Math.abs(Le))},tt.sqrLen=tt.squaredLength=tt.len=tt.length=tt.dot=tt.mul=tt.setReal=tt.getReal=void 0;var t=h(X()),o=h(Ye()),u=h(Ne());function m(I){if(typeof WeakMap!="function")return null;var S=new WeakMap,M=new WeakMap;return(m=function(R){return R?M:S})(I)}function h(I,S){if(I&&I.__esModule)return I;if(I===null||l(I)!=="object"&&typeof I!="function")return{default:I};var M=m(S);if(M&&M.has(I))return M.get(I);var R={},O=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var F in I)if(F!=="default"&&Object.prototype.hasOwnProperty.call(I,F)){var H=O?Object.getOwnPropertyDescriptor(I,F):null;H&&(H.get||H.set)?Object.defineProperty(R,F,H):R[F]=I[F]}return R.default=I,M&&M.set(I,R),R}function g(I,S,M){var R=.5*M[0],O=.5*M[1],F=.5*M[2],H=S[0],W=S[1],V=S[2],Z=S[3];return I[0]=H,I[1]=W,I[2]=V,I[3]=Z,I[4]=R*Z+O*V-F*W,I[5]=O*Z+F*H-R*V,I[6]=F*Z+R*W-O*H,I[7]=-R*H-O*W-F*V,I}function b(I,S){return I[0]=S[0],I[1]=S[1],I[2]=S[2],I[3]=S[3],I[4]=S[4],I[5]=S[5],I[6]=S[6],I[7]=S[7],I}function E(I,S,M){var R=S[0],O=S[1],F=S[2],H=S[3],W=M[4],V=M[5],Z=M[6],Y=M[7],ne=S[4],ye=S[5],_e=S[6],ge=S[7],Re=M[0],we=M[1],Le=M[2],Be=M[3];return I[0]=R*Be+H*Re+O*Le-F*we,I[1]=O*Be+H*we+F*Re-R*Le,I[2]=F*Be+H*Le+R*we-O*Re,I[3]=H*Be-R*Re-O*we-F*Le,I[4]=R*Y+H*W+O*Z-F*V+ne*Be+ge*Re+ye*Le-_e*we,I[5]=O*Y+H*V+F*W-R*Z+ye*Be+ge*we+_e*Re-ne*Le,I[6]=F*Y+H*Z+R*V-O*W+_e*Be+ge*Le+ne*we-ye*Re,I[7]=H*Y-R*W-O*V-F*Z+ge*Be-ne*Re-ye*we-_e*Le,I}tt.getReal=o.copy,tt.setReal=o.copy,tt.mul=E;var A=o.dot;tt.dot=A;var v=o.length;tt.length=v,tt.len=v;var C=o.squaredLength;return tt.squaredLength=C,tt.sqrLen=C,tt}var vt,At,Pt={};function qt(){if(vt)return Pt;function l(S){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},l(S)}vt=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.create=u,Pt.clone=function(S){var M=new t.ARRAY_TYPE(2);return M[0]=S[0],M[1]=S[1],M},Pt.fromValues=function(S,M){var R=new t.ARRAY_TYPE(2);return R[0]=S,R[1]=M,R},Pt.copy=function(S,M){return S[0]=M[0],S[1]=M[1],S},Pt.set=function(S,M,R){return S[0]=M,S[1]=R,S},Pt.add=function(S,M,R){return S[0]=M[0]+R[0],S[1]=M[1]+R[1],S},Pt.subtract=m,Pt.multiply=h,Pt.divide=g,Pt.ceil=function(S,M){return S[0]=Math.ceil(M[0]),S[1]=Math.ceil(M[1]),S},Pt.floor=function(S,M){return S[0]=Math.floor(M[0]),S[1]=Math.floor(M[1]),S},Pt.min=function(S,M,R){return S[0]=Math.min(M[0],R[0]),S[1]=Math.min(M[1],R[1]),S},Pt.max=function(S,M,R){return S[0]=Math.max(M[0],R[0]),S[1]=Math.max(M[1],R[1]),S},Pt.round=function(S,M){return S[0]=Math.round(M[0]),S[1]=Math.round(M[1]),S},Pt.scale=function(S,M,R){return S[0]=M[0]*R,S[1]=M[1]*R,S},Pt.scaleAndAdd=function(S,M,R,O){return S[0]=M[0]+R[0]*O,S[1]=M[1]+R[1]*O,S},Pt.distance=b,Pt.squaredDistance=E,Pt.length=A,Pt.squaredLength=v,Pt.negate=function(S,M){return S[0]=-M[0],S[1]=-M[1],S},Pt.inverse=function(S,M){return S[0]=1/M[0],S[1]=1/M[1],S},Pt.normalize=function(S,M){var R=M[0],O=M[1],F=R*R+O*O;return F>0&&(F=1/Math.sqrt(F)),S[0]=M[0]*F,S[1]=M[1]*F,S},Pt.dot=function(S,M){return S[0]*M[0]+S[1]*M[1]},Pt.cross=function(S,M,R){var O=M[0]*R[1]-M[1]*R[0];return S[0]=S[1]=0,S[2]=O,S},Pt.lerp=function(S,M,R,O){var F=M[0],H=M[1];return S[0]=F+O*(R[0]-F),S[1]=H+O*(R[1]-H),S},Pt.random=function(S,M){M=M||1;var R=2*t.RANDOM()*Math.PI;return S[0]=Math.cos(R)*M,S[1]=Math.sin(R)*M,S},Pt.transformMat2=function(S,M,R){var O=M[0],F=M[1];return S[0]=R[0]*O+R[2]*F,S[1]=R[1]*O+R[3]*F,S},Pt.transformMat2d=function(S,M,R){var O=M[0],F=M[1];return S[0]=R[0]*O+R[2]*F+R[4],S[1]=R[1]*O+R[3]*F+R[5],S},Pt.transformMat3=function(S,M,R){var O=M[0],F=M[1];return S[0]=R[0]*O+R[3]*F+R[6],S[1]=R[1]*O+R[4]*F+R[7],S},Pt.transformMat4=function(S,M,R){var O=M[0],F=M[1];return S[0]=R[0]*O+R[4]*F+R[12],S[1]=R[1]*O+R[5]*F+R[13],S},Pt.rotate=function(S,M,R,O){var F=M[0]-R[0],H=M[1]-R[1],W=Math.sin(O),V=Math.cos(O);return S[0]=F*V-H*W+R[0],S[1]=F*W+H*V+R[1],S},Pt.angle=function(S,M){var R=S[0],O=S[1],F=M[0],H=M[1],W=Math.sqrt(R*R+O*O)*Math.sqrt(F*F+H*H);return Math.acos(Math.min(Math.max(W&&(R*F+O*H)/W,-1),1))},Pt.zero=function(S){return S[0]=0,S[1]=0,S},Pt.str=function(S){return"vec2("+S[0]+", "+S[1]+")"},Pt.exactEquals=function(S,M){return S[0]===M[0]&&S[1]===M[1]},Pt.equals=function(S,M){var R=S[0],O=S[1],F=M[0],H=M[1];return Math.abs(R-F)<=t.EPSILON*Math.max(1,Math.abs(R),Math.abs(F))&&Math.abs(O-H)<=t.EPSILON*Math.max(1,Math.abs(O),Math.abs(H))},Pt.forEach=Pt.sqrLen=Pt.sqrDist=Pt.dist=Pt.div=Pt.mul=Pt.sub=Pt.len=void 0;var t=function(S,M){if(S&&S.__esModule)return S;if(S===null||l(S)!=="object"&&typeof S!="function")return{default:S};var R=o(void 0);if(R&&R.has(S))return R.get(S);var O={},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var H in S)if(H!=="default"&&Object.prototype.hasOwnProperty.call(S,H)){var W=F?Object.getOwnPropertyDescriptor(S,H):null;W&&(W.get||W.set)?Object.defineProperty(O,H,W):O[H]=S[H]}return O.default=S,R&&R.set(S,O),O}(X());function o(S){if(typeof WeakMap!="function")return null;var M=new WeakMap,R=new WeakMap;return(o=function(O){return O?R:M})(S)}function u(){var S=new t.ARRAY_TYPE(2);return t.ARRAY_TYPE!=Float32Array&&(S[0]=0,S[1]=0),S}function m(S,M,R){return S[0]=M[0]-R[0],S[1]=M[1]-R[1],S}function h(S,M,R){return S[0]=M[0]*R[0],S[1]=M[1]*R[1],S}function g(S,M,R){return S[0]=M[0]/R[0],S[1]=M[1]/R[1],S}function b(S,M){return Math.hypot(M[0]-S[0],M[1]-S[1])}function E(S,M){var R=M[0]-S[0],O=M[1]-S[1];return R*R+O*O}function A(S){return Math.hypot(S[0],S[1])}function v(S){var M=S[0],R=S[1];return M*M+R*R}Pt.len=A,Pt.sub=m,Pt.mul=h,Pt.div=g,Pt.dist=b,Pt.sqrDist=E,Pt.sqrLen=v;var C,I=(C=u(),function(S,M,R,O,F,H){var W,V;for(M||(M=2),R||(R=0),V=O?Math.min(O*M+R,S.length):S.length,W=R;W<V;W+=M)C[0]=S[W],C[1]=S[W+1],F(C,C,H),S[W]=C[0],S[W+1]=C[1];return S});return Pt.forEach=I,Pt}function or(){if(At)return U;function l(S){return l=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(M){return typeof M}:function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},l(S)}At=1,Object.defineProperty(U,"__esModule",{value:!0}),U.vec4=U.vec3=U.vec2=U.quat2=U.quat=U.mat4=U.mat3=U.mat2d=U.mat2=U.glMatrix=void 0;var t=I(X());U.glMatrix=t;var o=I(ue());U.mat2=o;var u=I(ee());U.mat2d=u;var m=I(Te());U.mat3=m;var h=I(Ne());U.mat4=h;var g=I(Ye());U.quat=g;var b=I(ht());U.quat2=b;var E=I(qt());U.vec2=E;var A=I(Ct());U.vec3=A;var v=I(ct());function C(S){if(typeof WeakMap!="function")return null;var M=new WeakMap,R=new WeakMap;return(C=function(O){return O?R:M})(S)}function I(S,M){if(S&&S.__esModule)return S;if(S===null||l(S)!=="object"&&typeof S!="function")return{default:S};var R=C(M);if(R&&R.has(S))return R.get(S);var O={},F=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var H in S)if(H!=="default"&&Object.prototype.hasOwnProperty.call(S,H)){var W=F?Object.getOwnPropertyDescriptor(S,H):null;W&&(W.get||W.set)?Object.defineProperty(O,H,W):O[H]=S[H]}return O.default=S,R&&R.set(S,O),O}return U.vec4=v,U}var cr,Qt,qr,yr,Ae=or(),Lr=function(){if(Qt)return cr;function l(t,o,u,m){this.cx=3*t,this.bx=3*(u-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*o,this.by=3*(m-o)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=o,this.p2x=u,this.p2y=m}return Qt=1,cr=l,l.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,o){if(o===void 0&&(o=1e-6),t<0)return 0;if(t>1)return 1;for(var u=t,m=0;m<8;m++){var h=this.sampleCurveX(u)-t;if(Math.abs(h)<o)return u;var g=this.sampleCurveDerivativeX(u);if(Math.abs(g)<1e-6)break;u-=h/g}var b=0,E=1;for(u=t,m=0;m<20&&(h=this.sampleCurveX(u),!(Math.abs(h-t)<o));m++)t>h?b=u:E=u,u=.5*(E-b)+b;return u},solve:function(t,o){return this.sampleCurveY(this.solveCurveX(t,o))}},cr}(),$r=L(Lr);function pn(){if(yr)return qr;function l(t,o){this.x=t,this.y=o}return yr=1,qr=l,l.prototype={clone:function(){return new l(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,o){return this.clone()._rotateAround(t,o)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var o=t.x-this.x,u=t.y-this.y;return o*o+u*u},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,o){return Math.atan2(this.x*o-this.y*t,this.x*t+this.y*o)},_matMult:function(t){var o=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=o,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var o=Math.cos(t),u=Math.sin(t),m=u*this.x+o*this.y;return this.x=o*this.x-u*this.y,this.y=m,this},_rotateAround:function(t,o){var u=Math.cos(t),m=Math.sin(t),h=o.y+m*(this.x-o.x)+u*(this.y-o.y);return this.x=o.x+u*(this.x-o.x)-m*(this.y-o.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},l.convert=function(t){return t instanceof l?t:Array.isArray(t)?new l(t[0],t[1]):t},qr}var wt=L(pn());function Pr(l,t){if(Array.isArray(l)){if(!Array.isArray(t)||l.length!==t.length)return!1;for(let o=0;o<l.length;o++)if(!Pr(l[o],t[o]))return!1;return!0}if(typeof l=="object"&&l!==null&&t!==null){if(typeof t!="object"||Object.keys(l).length!==Object.keys(t).length)return!1;for(const o in l)if(!Pr(l[o],t[o]))return!1;return!0}return l===t}const Ur=Math.PI/180,Un=180/Math.PI;function ar(l){return l*Ur}function tn(l){return l*Un}const Ln=[[0,0],[1,0],[1,1],[0,1]];function Xr(l){if(l<=0)return 0;if(l>=1)return 1;const t=l*l,o=t*l;return 4*(l<.5?o:3*(l-t)+o-.75)}function hn(l,t,o,u){const m=new $r(l,t,o,u);return function(h){return m.solve(h)}}const fr=hn(.25,.1,.25,1);function Jt(l,t,o){return Math.min(o,Math.max(t,l))}function bn(l,t,o){return(o=Jt((o-l)/(t-l),0,1))*o*(3-2*o)}function gn(l,t,o){const u=o-t,m=((l-t)%u+u)%u+t;return m===t?o:m}function Kn(l,t,o){if(!l.length)return o(null,[]);let u=l.length;const m=new Array(l.length);let h=null;l.forEach((g,b)=>{t(g,(E,A)=>{E&&(h=E),m[b]=A,--u==0&&o(h,m)})})}function dn(l,...t){for(const o of t)for(const u in o)l[u]=o[u];return l}let di=1;function Ui(){return di++}function Ji(l){return l<=1?1:Math.pow(2,Math.ceil(Math.log(l)/Math.LN2))}function nn(l,t){l.forEach(o=>{t[o]&&(t[o]=t[o].bind(t))})}function En(l,t){return l.indexOf(t,l.length-t.length)!==-1}function Jn(l,t,o){const u={};for(const m in l)u[m]=t.call(this,l[m],m,l);return u}function zo(l,t,o){const u={};for(const m in l)t.call(this,l[m],m,l)&&(u[m]=l[m]);return u}function _i(l){return Array.isArray(l)?l.map(_i):typeof l=="object"&&l?Jn(l,_i):l}const bi={};function gr(l){bi[l]||(typeof console<"u"&&console.warn(l),bi[l]=!0)}function Gi(l,t,o){return(o.y-l.y)*(t.x-l.x)>(t.y-l.y)*(o.x-l.x)}function Lo(l){let t=0;for(let o,u,m=0,h=l.length,g=h-1;m<h;g=m++)o=l[m],u=l[g],t+=(u.x-o.x)*(o.y+u.y);return t}function li([l,t,o]){const u=ar(t+90),m=ar(o);return{x:l*Math.cos(u)*Math.sin(m),y:l*Math.sin(u)*Math.sin(m),z:l*Math.cos(m),azimuthal:t,polar:o}}function Hi(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function fi(l){const t={};if(l.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,u,m,h)=>{const g=m||h;return t[u]=!g||g.toLowerCase(),""}),t["max-age"]){const o=parseInt(t["max-age"],10);isNaN(o)?delete t["max-age"]:t["max-age"]=o}return t}let pi=null;function Wi(l,t){return[l[4*t],l[4*t+1],l[4*t+2],l[4*t+3]]}function Bn(l,t,o,u){for(;t<o;){const m=t+o>>1;l[m]<u?t=m+1:o=m}return t}function it(l,t,o,u){for(;t<o;){const m=t+o>>1;l[m]<=u?t=m+1:o=m}return t}function te(l){return l>0?1/(1.001-l):1+l}function le(l){return l>0?1-1/(1.001-l):-l}const K={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!K.API_URL)return null;try{const l=new URL(K.API_URL);return l.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":l.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function he(l){return K.API_URL_REGEX.test(l)}function de(l){return K.API_SPRITE_REGEX.test(l)}let xe,ke,ze,He,Ue,Ze;function ot(){return xe==null&&(xe=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),xe}const pt={now:()=>He!==void 0?He:performance.now(),setNow(l){He=l},restoreNow(){He=void 0},frame(l){const t=requestAnimationFrame(l);return{cancel:()=>cancelAnimationFrame(t)}},getImageData(l,t=0){const{width:o,height:u}=l;Ue||(Ue=document.createElement("canvas"));const m=Ue.getContext("2d",{willReadFrequently:!0});if(!m)throw new Error("failed to create canvas 2d context");return(o>Ue.width||u>Ue.height)&&(Ue.width=o,Ue.height=u),m.clearRect(-t,-t,o+2*t,u+2*t),m.drawImage(l,0,0,o,u),m.getImageData(-t,-t,o+2*t,u+2*t)},resolveURL:l=>(ke||(ke=document.createElement("a")),ke.href=l,ke.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(ze==null&&(ze=window.matchMedia("(prefers-reduced-motion: reduce)")),ze.matches)},hasCanvasFingerprintNoise(){if(Ze!==void 0)return Ze;if(!ot())return Ze=!1,!1;const l=new OffscreenCanvas(85,1),t=l.getContext("2d",{willReadFrequently:!0});let o=0;for(let m=0;m<l.width;++m)t.fillStyle=`rgba(${o++},${o++},${o++}, 255)`,t.fillRect(m,0,1,1);const u=t.getImageData(0,0,l.width,l.height);o=0;for(let m=0;m<u.data.length;++m)if(m%4!=3&&o++!==u.data[m])return Ze=!0,!0;return Ze=!1,!1}};function St(l,t){const o=l.indexOf("?");if(o<0)return`${l}?${new URLSearchParams(t).toString()}`;const u=new URLSearchParams(l.slice(o));for(const m in t)u.set(m,t[m]);return`${l.slice(0,o)}?${u.toString()}`}function Ut(l,t={persistentParams:[]}){const o=l.indexOf("?");if(o<0)return l;const u=new URLSearchParams,m=new URLSearchParams(l.slice(o));for(const g of t.persistentParams){const b=m.get(g);b&&u.set(g,b)}const h=u.toString();return`${l.slice(0,o)}${h.length>0?`?${h}`:""}`}const tr="mapbox-tiles";let Gt=500,Xt=50;const vr=["language","worldview","jobid"];let Nr,dr;function Vr(){try{return caches}catch{}}function Gr(){const l=Vr();l&&Nr==null&&(Nr=l.open(tr))}let In=1/0;const ii={supported:!1,testSupport:function(l){!so&&Qn&&(Yr?Qi(l):$n=l)}};let $n,Qn,so=!1,Yr=!1;const Gn=typeof self<"u"?self:{};function Qi(l){const t=l.createTexture();l.bindTexture(l.TEXTURE_2D,t);try{if(l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,Qn),l.isContextLost())return;ii.supported=!0}catch{}l.deleteTexture(t),so=!0}Gn.document&&(Qn=Gn.document.createElement("img"),Qn.onload=function(){$n&&Qi($n),$n=null,Yr=!0},Qn.onerror=function(){so=!0,$n=null},Qn.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const wi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(wi);class Zn extends Error{constructor(t,o,u){o===401&&he(u)&&(t+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(t),this.status=o,this.url=u}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const eo=Hi()?()=>self.worker&&self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,Si=function(l,t){if(!(/^file:/.test(o=l.url)||/^file:/.test(eo())&&!/^\w+:/.test(o))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(u,m){const h=new AbortController,g=new Request(u.url,{method:u.method||"GET",body:u.body,credentials:u.credentials,headers:u.headers,referrer:eo(),referrerPolicy:u.referrerPolicy,signal:h.signal});let b=!1,E=!1;const A=(v=g.url).indexOf("sku=")>0&&he(v);var v;u.type==="json"&&g.headers.set("Accept","application/json");const C=(S,M,R)=>{if(E)return;if(S&&S.message!=="SecurityError"&&gr(S.toString()),M&&R)return I(M);const O=Date.now();fetch(g).then(F=>{if(F.ok){const H=A?F.clone():null;return I(F,H,O)}return m(new Zn(F.statusText,F.status,u.url))}).catch(F=>{F.name!=="AbortError"&&m(new Error(`${F.message} ${u.url}`))})},I=(S,M,R)=>{(u.type==="arrayBuffer"?S.arrayBuffer():u.type==="json"?S.json():S.text()).then(O=>{E||(M&&R&&function(F,H,W){if(Gr(),Nr==null)return;const V=fi(H.headers.get("Cache-Control")||"");if(V["no-store"])return;const Z={status:H.status,statusText:H.statusText,headers:new Headers};H.headers.forEach((ye,_e)=>Z.headers.set(_e,ye)),V["max-age"]&&Z.headers.set("Expires",new Date(W+1e3*V["max-age"]).toUTCString());const Y=Z.headers.get("Expires");if(!Y||new Date(Y).getTime()-W<42e4)return;let ne=Ut(F.url,{persistentParams:vr});if(H.status===206){const ye=F.headers.get("Range");if(!ye)return;Z.status=200,ne=St(ne,{range:ye})}(function(ye,_e){if(dr===void 0)try{new Response(new ReadableStream),dr=!0}catch{dr=!1}dr?_e(ye.body):ye.blob().then(_e)})(H,ye=>{const _e=new Response((ge=H.status)!==200&&ge!==404&&[101,103,204,205,304].includes(ge)?null:ye,Z);var ge;Gr(),Nr!=null&&Nr.then(Re=>Re.put(ne,_e)).catch(Re=>gr(Re.message))})}(g,M,R),b=!0,m(null,O,S.headers.get("Cache-Control"),S.headers.get("Expires")))}).catch(O=>{E||m(new Error(O.message))})};return A?function(S,M){if(Gr(),Nr==null)return M(null);Nr.then(R=>{let O=Ut(S.url,{persistentParams:vr});const F=S.headers.get("Range");F&&(O=St(O,{range:F})),R.match(O).then(H=>{const W=function(V){if(!V)return!1;const Z=new Date(V.headers.get("Expires")||0),Y=fi(V.headers.get("Cache-Control")||"");return Z>Date.now()&&!Y["no-cache"]}(H);R.delete(O),W&&R.put(O,H.clone()),M(null,H,W)}).catch(M)}).catch(M)}(g,C):C(null,null),{cancel:()=>{E=!0,b||h.abort()}}}(l,t);if(Hi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",l,t,void 0,!0)}var o;return function(u,m){const h=new XMLHttpRequest;h.open(u.method||"GET",u.url,!0),u.type==="arrayBuffer"&&(h.responseType="arraybuffer");for(const g in u.headers)h.setRequestHeader(g,u.headers[g]);return u.type==="json"&&(h.responseType="text",h.setRequestHeader("Accept","application/json")),h.withCredentials=u.credentials==="include",h.onerror=()=>{m(new Error(h.statusText))},h.onload=()=>{if((h.status>=200&&h.status<300||h.status===0)&&h.response!==null){let g=h.response;if(u.type==="json")try{g=JSON.parse(h.response)}catch(b){return m(b)}m(null,g,h.getResponseHeader("Cache-Control"),h.getResponseHeader("Expires"))}else m(new Zn(h.statusText,h.status,u.url))},h.send(u.body),{cancel:()=>h.abort()}}(l,t)},zi=function(l,t){return Si(dn(l,{type:"arrayBuffer"}),t)};function ss(l){const t=document.createElement("a");return t.href=l,t.protocol===location.protocol&&t.host===location.host}const Is="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ko,Ps;ko=[],Ps=0;const As=function(l,t){if(ii.supported&&(l.headers||(l.headers={}),l.headers.accept="image/webp,*/*"),Ps>=K.MAX_PARALLEL_IMAGE_REQUESTS){const h={requestParameters:l,callback:t,cancelled:!1,cancel(){this.cancelled=!0}};return ko.push(h),h}Ps++;let o=!1;const u=()=>{if(!o)for(o=!0,Ps--;ko.length&&Ps<K.MAX_PARALLEL_IMAGE_REQUESTS;){const h=ko.shift(),{requestParameters:g,callback:b,cancelled:E}=h;E||(h.cancel=As(g,b).cancel)}},m=zi(l,(h,g,b,E)=>{u(),h?t(h):g&&(self.createImageBitmap?function(A,v){const C=new Blob([new Uint8Array(A)],{type:"image/png"});createImageBitmap(C).then(I=>{v(null,I)}).catch(I=>{v(new Error(`Could not load image because of ${I.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(g,(A,v)=>t(A,v,b,E)):function(A,v){const C=new Image;C.onload=()=>{v(null,C),URL.revokeObjectURL(C.src),C.onload=null,requestAnimationFrame(()=>{C.src=Is})},C.onerror=()=>v(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const I=new Blob([new Uint8Array(A)],{type:"image/png"});C.src=A.byteLength?URL.createObjectURL(I):Is}(g,(A,v)=>t(A,v,b,E)))});return{cancel:()=>{m.cancel(),u()}}};var Ul,qi,Do,xo={exports:{}},Oo={exports:{}},qo={exports:{}},pl=function(){if(Do)return xo.exports;Do=1;var l=(Ul||(Ul=1,Oo.exports=function(o,u){var m,h,g,b,E,A,v,C;for(h=o.length-(m=3&o.length),g=u,E=3432918353,A=461845907,C=0;C<h;)v=255&o.charCodeAt(C)|(255&o.charCodeAt(++C))<<8|(255&o.charCodeAt(++C))<<16|(255&o.charCodeAt(++C))<<24,++C,g=27492+(65535&(b=5*(65535&(g=(g^=v=(65535&(v=(v=(65535&v)*E+(((v>>>16)*E&65535)<<16)&4294967295)<<15|v>>>17))*A+(((v>>>16)*A&65535)<<16)&4294967295)<<13|g>>>19))+((5*(g>>>16)&65535)<<16)&4294967295))+((58964+(b>>>16)&65535)<<16);switch(v=0,m){case 3:v^=(255&o.charCodeAt(C+2))<<16;case 2:v^=(255&o.charCodeAt(C+1))<<8;case 1:g^=v=(65535&(v=(v=(65535&(v^=255&o.charCodeAt(C)))*E+(((v>>>16)*E&65535)<<16)&4294967295)<<15|v>>>17))*A+(((v>>>16)*A&65535)<<16)&4294967295}return g^=o.length,g=2246822507*(65535&(g^=g>>>16))+((2246822507*(g>>>16)&65535)<<16)&4294967295,g=3266489909*(65535&(g^=g>>>13))+((3266489909*(g>>>16)&65535)<<16)&4294967295,(g^=g>>>16)>>>0}),Oo.exports),t=(qi||(qi=1,qo.exports=function(o,u){for(var m,h=o.length,g=u^h,b=0;h>=4;)m=1540483477*(65535&(m=255&o.charCodeAt(b)|(255&o.charCodeAt(++b))<<8|(255&o.charCodeAt(++b))<<16|(255&o.charCodeAt(++b))<<24))+((1540483477*(m>>>16)&65535)<<16),g=1540483477*(65535&g)+((1540483477*(g>>>16)&65535)<<16)^(m=1540483477*(65535&(m^=m>>>24))+((1540483477*(m>>>16)&65535)<<16)),h-=4,++b;switch(h){case 3:g^=(255&o.charCodeAt(b+2))<<16;case 2:g^=(255&o.charCodeAt(b+1))<<8;case 1:g=1540483477*(65535&(g^=255&o.charCodeAt(b)))+((1540483477*(g>>>16)&65535)<<16)}return g=1540483477*(65535&(g^=g>>>13))+((1540483477*(g>>>16)&65535)<<16),(g^=g>>>15)>>>0}),qo.exports);return xo.exports=l,xo.exports.murmur3=l,xo.exports.murmur2=t,xo.exports}(),Rs=L(pl);class la{constructor(t,...o){dn(this,o[0]||{}),this.type=t}}class ya extends la{constructor(t,o={}){super("error",dn({error:t},o))}}function ml(l,t,o){o[l]&&o[l].indexOf(t)!==-1||(o[l]=o[l]||[],o[l].push(t))}function zs(l,t,o){if(o&&o[l]){const u=o[l].indexOf(t);u!==-1&&o[l].splice(u,1)}}class lo{on(t,o){return this._listeners=this._listeners||{},ml(t,o,this._listeners),this}off(t,o){return zs(t,o,this._listeners),zs(t,o,this._oneTimeListeners),this}once(t,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},ml(t,o,this._oneTimeListeners),this):new Promise(u=>this.once(t,u))}fire(t,o){const u=typeof t=="string"?new la(t,o):t,m=u.type;if(this.listens(m)){u.target=this;const h=this._listeners&&this._listeners[m]?this._listeners[m].slice():[];for(const E of h)E.call(this,u);const g=this._oneTimeListeners&&this._oneTimeListeners[m]?this._oneTimeListeners[m].slice():[];for(const E of g)zs(m,E,this._oneTimeListeners),E.call(this,u);const b=this._eventedParent;b&&(dn(u,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),b.fire(u))}else u instanceof ya&&console.error(u.error);return this}listens(t){return!!(this._listeners&&this._listeners[t]&&this._listeners[t].length>0||this._oneTimeListeners&&this._oneTimeListeners[t]&&this._oneTimeListeners[t].length>0||this._eventedParent&&this._eventedParent.listens(t))}setEventedParent(t,o){return this._eventedParent=t,this._eventedParentData=o,this}}var bo,Gl={},Hl=function(){if(bo)return Gl;bo=1;var l={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function t(h){return(h=Math.round(h))<0?0:h>255?255:h}function o(h){return t(h[h.length-1]==="%"?parseFloat(h)/100*255:parseInt(h))}function u(h){return(g=h[h.length-1]==="%"?parseFloat(h)/100:parseFloat(h))<0?0:g>1?1:g;var g}function m(h,g,b){return b<0?b+=1:b>1&&(b-=1),6*b<1?h+(g-h)*b*6:2*b<1?g:3*b<2?h+(g-h)*(2/3-b)*6:h}try{Gl.parseCSSColor=function(h){var g,b=h.replace(/ /g,"").toLowerCase();if(b in l)return l[b].slice();if(b[0]==="#")return b.length===4?(g=parseInt(b.substr(1),16))>=0&&g<=4095?[(3840&g)>>4|(3840&g)>>8,240&g|(240&g)>>4,15&g|(15&g)<<4,1]:null:b.length===7&&(g=parseInt(b.substr(1),16))>=0&&g<=16777215?[(16711680&g)>>16,(65280&g)>>8,255&g,1]:null;var E=b.indexOf("("),A=b.indexOf(")");if(E!==-1&&A+1===b.length){var v=b.substr(0,E),C=b.substr(E+1,A-(E+1)).split(","),I=1;switch(v){case"rgba":if(C.length!==4)return null;I=u(C.pop());case"rgb":return C.length!==3?null:[o(C[0]),o(C[1]),o(C[2]),I];case"hsla":if(C.length!==4)return null;I=u(C.pop());case"hsl":if(C.length!==3)return null;var S=(parseFloat(C[0])%360+360)%360/360,M=u(C[1]),R=u(C[2]),O=R<=.5?R*(M+1):R+M-R*M,F=2*R-O;return[t(255*m(F,O,S+1/3)),t(255*m(F,O,S)),t(255*m(F,O,S-1/3)),I];default:return null}}return null}}catch{}return Gl}();class Rr{constructor(t,o,u,m=1){this.r=t,this.g=o,this.b=u,this.a=m}static parse(t){if(!t)return;if(t instanceof Rr)return t;if(typeof t!="string")return;const o=Hl.parseCSSColor(t);return o?new Rr(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toStringPremultipliedAlpha(){const[t,o,u,m]=this.a===0?[0,0,0,0]:[255*this.r/this.a,255*this.g/this.a,255*this.b/this.a,this.a];return`rgba(${Math.round(t)},${Math.round(o)},${Math.round(u)},${m})`}toString(){const[t,o,u,m]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*t)},${Math.round(255*o)},${Math.round(255*u)},${m})`}toRenderColor(t){const{r:o,g:u,b:m,a:h}=this;return new gl(t,o,u,m,h)}clone(){return new Rr(this.r,this.g,this.b,this.a)}}class gl{constructor(t,o,u,m,h){if(t){const g=t.image.height,b=g*g;o=h===0?0:o/h*(g-1),u=h===0?0:u/h*(g-1),m=h===0?0:m/h*(g-1);const E=Math.floor(o),A=Math.floor(u),v=Math.floor(m),C=Math.ceil(o),I=Math.ceil(u),S=Math.ceil(m),M=o-E,R=u-A,O=m-v,F=t.image.data,H=4*(E+A*b+v*g),W=4*(E+A*b+S*g),V=4*(E+I*b+v*g),Z=4*(E+I*b+S*g),Y=4*(C+A*b+v*g),ne=4*(C+A*b+S*g),ye=4*(C+I*b+v*g),_e=4*(C+I*b+S*g);if(H<0||_e>=F.length)throw new Error("out of range");this.r=ur(ur(ur(F[H],F[W],O),ur(F[V],F[Z],O),R),ur(ur(F[Y],F[ne],O),ur(F[ye],F[_e],O),R),M)/255*h,this.g=ur(ur(ur(F[H+1],F[W+1],O),ur(F[V+1],F[Z+1],O),R),ur(ur(F[Y+1],F[ne+1],O),ur(F[ye+1],F[_e+1],O),R),M)/255*h,this.b=ur(ur(ur(F[H+2],F[W+2],O),ur(F[V+2],F[Z+2],O),R),ur(ur(F[Y+2],F[ne+2],O),ur(F[ye+2],F[_e+2],O),R),M)/255*h,this.a=h}else this.r=o,this.g=u,this.b=m,this.a=h}toArray(){const{r:t,g:o,b:u,a:m}=this;return m===0?[0,0,0,0]:[255*t/m,255*o/m,255*u/m,m]}toHslaArray(){if(this.a===0)return[0,0,0,0];const{r:t,g:o,b:u,a:m}=this,h=Math.min(Math.max(t/m,0),1),g=Math.min(Math.max(o/m,0),1),b=Math.min(Math.max(u/m,0),1),E=Math.min(h,g,b),A=Math.max(h,g,b),v=(E+A)/2;if(E===A)return[0,0,100*v,m];const C=A-E,I=v>.5?C/(2-A-E):C/(A+E);let S=0;return A===h?S=(g-b)/C+(g<b?6:0):A===g?S=(b-h)/C+2:A===b&&(S=(h-g)/C+4),S*=60,[Math.min(Math.max(S,0),360),Math.min(Math.max(100*I,0),100),Math.min(Math.max(100*v,0),100),m]}toArray01(){const{r:t,g:o,b:u,a:m}=this;return m===0?[0,0,0,0]:[t/m,o/m,u/m,m]}toArray01Scaled(t){const{r:o,g:u,b:m,a:h}=this;return h===0?[0,0,0]:[o/h*t,u/h*t,m/h*t]}toArray01PremultipliedAlpha(){const{r:t,g:o,b:u,a:m}=this;return[t,o,u,m]}toArray01Linear(){const{r:t,g:o,b:u,a:m}=this;return m===0?[0,0,0,0]:[Math.pow(t/m,2.2),Math.pow(o/m,2.2),Math.pow(u/m,2.2),m]}}function ur(l,t,o){return l*(1-o)+t*o}function va(l,t,o){return l.map((u,m)=>ur(u,t[m],o))}Rr.black=new Rr(0,0,0,1),Rr.white=new Rr(1,1,1,1),Rr.transparent=new Rr(0,0,0,0),Rr.red=new Rr(1,0,0,1),Rr.blue=new Rr(0,0,1,1);var Hr=Object.freeze({__proto__:null,array:va,color:function(l,t,o){return new Rr(ur(l.r,t.r,o),ur(l.g,t.g,o),ur(l.b,t.b,o),ur(l.a,t.a,o))},number:ur});function Ls(l,...t){for(const o of t)for(const u in o)l[u]=o[u];return l}class co extends Error{constructor(t,o){super(o),this.message=o,this.key=t}}class Wl{constructor(t,o=[]){this.parent=t,this.bindings={};for(const[u,m]of o)this.bindings[u]=m}concat(t){return new Wl(this,t)}get(t){if(this.bindings[t])return this.bindings[t];if(this.parent)return this.parent.get(t);throw new Error(`${t} not found in scope.`)}has(t){return!!this.bindings[t]||!!this.parent&&this.parent.has(t)}}const _r={kind:"null"},Mt={kind:"number"},xr={kind:"string"},br={kind:"boolean"},_n={kind:"color"},xa={kind:"object"},Wr={kind:"value"},ql={kind:"collator"},Zo={kind:"formatted"},Zl={kind:"resolvedImage"};function uo(l,t){return{kind:"array",itemType:l,N:t}}function kn(l){if(l.kind==="array"){const t=kn(l.itemType);return typeof l.N=="number"?`array<${t}, ${l.N}>`:l.itemType.kind==="value"?"array":`array<${t}>`}return l.kind}const Z_=[_r,Mt,xr,br,_n,Zo,xa,uo(Wr),Zl];function Zu(l,t){if(t.kind==="error")return null;if(l.kind==="array"){if(t.kind==="array"&&(t.N===0&&t.itemType.kind==="value"||!Zu(l.itemType,t.itemType))&&(typeof l.N!="number"||l.N===t.N))return null}else{if(l.kind===t.kind)return null;if(l.kind==="value"){for(const o of Z_)if(!Zu(o,t))return null}}return`Expected ${kn(l)} but found ${kn(t)} instead.`}function pd(l,t){return t.some(o=>o.kind===l.kind)}function Ac(l,t){return t.some(o=>o==="null"?l===null:o==="array"?Array.isArray(l):o==="object"?l&&!Array.isArray(l)&&typeof l=="object":o===typeof l)}class md{constructor(t,o,u){this.sensitivity=t?o?"variant":"case":o?"accent":"base",this.locale=u,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(t,o){return this.collator.compare(t,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Xu{constructor(t,o,u,m,h){this.text=t.normalize?t.normalize():t,this.image=o,this.scale=u,this.fontStack=m,this.textColor=h}}class ho{constructor(t){this.sections=t}static fromString(t){return new ho([new Xu(t,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(t=>t.text.length!==0||t.image&&t.image.namePrimary)}static factory(t){return t instanceof ho?t:ho.fromString(t)}toString(){return this.sections.length===0?"":this.sections.map(t=>t.text).join("")}serialize(){const t=["format"];for(const o of this.sections){if(o.image){t.push(["image",o.image.namePrimary]);continue}t.push(o.text);const u={};o.fontStack&&(u["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(u["font-scale"]=o.scale),o.textColor&&(u["text-color"]=["rgba"].concat(o.textColor.toRenderColor(null).toArray())),t.push(u)}return t}}class Xl{constructor(t,o){if(this.id=t,this.options=o||{params:{}},this.options.transform){const{a:u,b:m,c:h,d:g,e:b,f:E}=this.options.transform;this.options.transform=new DOMMatrix([u,m,h,g,b,E])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}static deserializeFromString(t){const o=JSON.parse(t),{a:u,b:m,c:h,d:g,e:b,f:E}=o.options.transform;return new DOMMatrix([u,m,h,g,b,E]),new Xl(o.id,o.options)}scaleSelf(t){return this.options.transform=this.options.transform.scale(t),this}serialize(){const t={id:this.id};this.options&&(t.options=this.options);const{a:o,b:u,c:m,d:h,e:g,f:b}=this.options.transform;return t.options.transform={a:o,b:u,c:m,d:h,e:g,f:b},JSON.stringify(t)}}class Li{constructor(t){this.namePrimary=t.namePrimary,t.nameSecondary&&(this.nameSecondary=t.nameSecondary),t.optionsPrimary&&(this.optionsPrimary=t.optionsPrimary),t.optionsSecondary&&(this.optionsSecondary=t.optionsSecondary),this.available=t.available}toString(){return this.namePrimary&&this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}getPrimary(){return new Xl(this.namePrimary,{params:this.optionsPrimary&&this.optionsPrimary.params||{}})}getSerializedPrimary(){return this.getPrimary().serialize()}getSecondary(){return this.nameSecondary?new Xl(this.nameSecondary,{params:this.optionsSecondary&&this.optionsSecondary.params||{}}):null}static from(t){return typeof t=="string"?Li.build(t):t}static build(t,o,u,m){return t?new Li({namePrimary:t,nameSecondary:o,optionsPrimary:u,optionsSecondary:m,available:!1}):null}}function Yl(l,t,o,u){return typeof l=="number"&&l>=0&&l<=255&&typeof t=="number"&&t>=0&&t<=255&&typeof o=="number"&&o>=0&&o<=255?u===void 0||typeof u=="number"&&u>=0&&u<=1?null:`Invalid rgba value [${[l,t,o,u].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof u=="number"?[l,t,o,u]:[l,t,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Kl(l){if(l===null||typeof l=="string"||typeof l=="boolean"||typeof l=="number"||l instanceof Rr||l instanceof md||l instanceof ho||l instanceof Li)return!0;if(Array.isArray(l)){for(const t of l)if(!Kl(t))return!1;return!0}if(typeof l=="object"){for(const t in l)if(!Kl(l[t]))return!1;return!0}return!1}function Hn(l){if(l===null)return _r;if(typeof l=="string")return xr;if(typeof l=="boolean")return br;if(typeof l=="number")return Mt;if(l instanceof Rr)return _n;if(l instanceof md)return ql;if(l instanceof ho)return Zo;if(l instanceof Li)return Zl;if(Array.isArray(l)){const t=l.length;let o;for(const u of l){const m=Hn(u);if(o){if(o===m)continue;o=Wr;break}o=m}return uo(o||Wr,t)}return xa}function ka(l){const t=typeof l;return l===null?"":t==="string"||t==="number"||t==="boolean"?String(l):l instanceof Rr?l.toStringPremultipliedAlpha():l instanceof ho||l instanceof Li?l.toString():JSON.stringify(l)}class ba{constructor(t,o){this.type=t,this.value=o}static parse(t,o){if(t.length!==2)return o.error(`'literal' expression requires exactly one argument, but found ${t.length-1} instead.`);if(!Kl(t[1]))return o.error("invalid value");const u=t[1];let m=Hn(u);const h=o.expectedType;return m.kind!=="array"||m.N!==0||!h||h.kind!=="array"||typeof h.N=="number"&&h.N!==0||(m=h),new ba(m,u)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Rr?["rgba"].concat(this.value.toRenderColor(null).toArray()):this.value instanceof ho?this.value.serialize():this.value}}class yi{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}}const Yu={string:xr,number:Mt,boolean:br,object:xa};class wa{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");let u,m=1;const h=t[0];if(h==="array"){let b,E;if(t.length>2){const A=t[1];if(typeof A!="string"||!(A in Yu)||A==="object")return o.error('The item type argument of "array" must be one of string, number, boolean',1);b=Yu[A],m++}else b=Wr;if(t.length>3){if(t[2]!==null&&(typeof t[2]!="number"||t[2]<0||t[2]!==Math.floor(t[2])))return o.error('The length argument to "array" must be a positive integer literal',2);E=t[2],m++}u=uo(b,E)}else u=Yu[h];const g=[];for(;m<t.length;m++){const b=o.parse(t[m],m,Wr);if(!b)return null;g.push(b)}return new wa(u,g)}evaluate(t){for(let o=0;o<this.args.length;o++){const u=this.args[o].evaluate(t);if(!Zu(this.type,Hn(u)))return u;if(o===this.args.length-1)throw new yi(`The expression ${JSON.stringify(this.args[o].serialize())} evaluated to ${kn(Hn(u))} but was expected to be of type ${kn(this.type)}.`)}return null}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=this.type,o=[t.kind];if(t.kind==="array"){const u=t.itemType;if(u.kind==="string"||u.kind==="number"||u.kind==="boolean"){o.push(u.kind);const m=t.N;(typeof m=="number"||this.args.length>1)&&o.push(m)}}return o.concat(this.args.map(u=>u.serialize()))}}class ks{constructor(t){this.type=Zo,this.sections=t}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const u=t[1];if(!Array.isArray(u)&&typeof u=="object")return o.error("First argument must be an image or text section.");const m=[];let h=!1;for(let g=1;g<=t.length-1;++g){const b=t[g];if(h&&typeof b=="object"&&!Array.isArray(b)){h=!1;let E=null;if(b["font-scale"]&&(E=o.parseObjectValue(b["font-scale"],g,"font-scale",Mt),!E))return null;let A=null;if(b["text-font"]&&(A=o.parseObjectValue(b["text-font"],g,"text-font",uo(xr)),!A))return null;let v=null;if(b["text-color"]&&(v=o.parseObjectValue(b["text-color"],g,"text-color",_n),!v))return null;const C=m[m.length-1];C.scale=E,C.font=A,C.textColor=v}else{const E=o.parse(t[g],g,Wr);if(!E)return null;const A=E.type.kind;if(A!=="string"&&A!=="value"&&A!=="null"&&A!=="resolvedImage")return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");h=!0,m.push({content:E,scale:null,font:null,textColor:null})}}return new ks(m)}evaluate(t){return new ho(this.sections.map(o=>{const u=o.content.evaluate(t);return Hn(u)===Zl?new Xu("",u,null,null,null):new Xu(ka(u),null,o.scale?o.scale.evaluate(t):null,o.font?o.font.evaluate(t).join(","):null,o.textColor?o.textColor.evaluate(t):null)}))}eachChild(t){for(const o of this.sections)t(o.content),o.scale&&t(o.scale),o.font&&t(o.font),o.textColor&&t(o.textColor)}outputDefined(){return!1}serialize(){const t=["format"];for(const o of this.sections){t.push(o.content.serialize());const u={};o.scale&&(u["font-scale"]=o.scale.serialize()),o.font&&(u["text-font"]=o.font.serialize()),o.textColor&&(u["text-color"]=o.textColor.serialize()),t.push(u)}return t}}class Rc{constructor(t,o,u,m){this._imageWarnHistory={},this.type=Zl,this.inputPrimary=t,this.inputSecondary=o,this.inputPrimaryParams=u,this.inputSecondaryParams=m}static parse(t,o){if(t.length<2)return o.error("Expected two or more arguments.");let u=1;const m=[];function h(){if(u<t.length){const b=o.parse(t[u],u++,xr);return b?(m.push({image:b,options:void 0}),!0):(o.error(m.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function g(){if(u<t.length){if(typeof(b=t[u])=="string"||Bd(b))return!0;const E=t[u].params,A=o.concat(u);if(!E)return u++,!0;if(typeof E!="object"||E.constructor!==Object)return A.error('Image options "params" should be an object'),!1;const v={},C=A.concat(void 0,"params");for(const I in E){if(!I)return C.error("Image parameter name should be non-empty"),!1;const S=C.concat(void 0,I).parse(E[I],void 0,_n,void 0,{typeAnnotation:"coerce"});if(!S)return!1;v[I]=S}return m[m.length-1].options=v,u++,!0}var b;return!0}for(let b=0;b<2;b++)if(!h()||!g())return;return new Rc(m[0].image,m[1]?m[1].image:void 0,m[0].options,m[1]?m[1].options:void 0)}evaluateParams(t,o){const u={};if(o){for(const m in o)if(o[m])try{const h=o[m].evaluate(t),g=`Ignoring image parameter "${m}" with semi-transparent color ${h.toString()}`;if(h.a!==1){this._imageWarnHistory[g]||(console.warn(g),this._imageWarnHistory[g]=!0);continue}u[m]=h}catch{continue}if(Object.keys(u).length!==0)return{params:u}}}evaluate(t){const o=Li.build(this.inputPrimary.evaluate(t),this.inputSecondary?this.inputSecondary.evaluate(t):void 0,this.inputPrimaryParams?this.evaluateParams(t,this.inputPrimaryParams):void 0,this.inputSecondaryParams?this.evaluateParams(t,this.inputSecondaryParams):void 0);return o&&t.availableImages&&(o.available=t.availableImages.indexOf(o.namePrimary)>-1,o.nameSecondary&&o.available&&t.availableImages&&(o.available=t.availableImages.indexOf(o.nameSecondary)>-1)),o}eachChild(t){if(t(this.inputPrimary),this.inputPrimaryParams)for(const o in this.inputPrimaryParams)this.inputPrimaryParams[o]&&t(this.inputPrimaryParams[o]);if(this.inputSecondary&&(t(this.inputSecondary),this.inputSecondaryParams))for(const o in this.inputSecondaryParams)this.inputSecondaryParams[o]&&t(this.inputSecondaryParams[o])}outputDefined(){return!1}serializeParams(t){const o={};if(t){for(const u in t)t[u]&&(o[u]=t[u].serialize());return{params:o}}}serialize(){const t=["image",this.inputPrimary.serialize()];return this.inputPrimaryParams&&t.push(this.serializeParams(this.inputPrimaryParams)),this.inputSecondary&&(t.push(this.inputSecondary.serialize()),this.inputSecondaryParams&&t.push(this.serializeParams(this.inputSecondaryParams))),t}}function Jl(l){return l instanceof Number?"number":l instanceof String?"string":l instanceof Boolean?"boolean":Array.isArray(l)?"array":l===null?"null":typeof l}const Ex={"to-boolean":br,"to-color":_n,"to-number":Mt,"to-string":xr};class Ds{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expected at least one argument.");const u=t[0],m=[];let h=_r;if(u==="to-array"){if(!Array.isArray(t[1]))return null;const g=t[1].length;if(o.expectedType){if(o.expectedType.kind!=="array")return o.error(`Expected ${o.expectedType.kind} but found array.`);h=uo(o.expectedType.itemType,g)}else{if(!(g>0&&Kl(t[1][0])))return null;h=uo(Hn(t[1][0]),g)}for(let b=0;b<g;b++){const E=t[1][b];let A;if(Jl(E)==="array")A=o.parse(E,void 0,h.itemType);else{const v=Jl(E);if(v!==h.itemType.kind)return o.error(`Expected ${h.itemType.kind} but found ${v}.`);A=o.registry.literal.parse(["literal",E===void 0?null:E],o)}if(!A)return null;m.push(A)}}else{if((u==="to-boolean"||u==="to-string")&&t.length!==2)return o.error("Expected one argument.");h=Ex[u];for(let g=1;g<t.length;g++){const b=o.parse(t[g],g,Wr);if(!b)return null;m.push(b)}}return new Ds(h,m)}evaluate(t){if(this.type.kind==="boolean")return!!this.args[0].evaluate(t);if(this.type.kind==="color"){let o,u;for(const m of this.args){if(o=m.evaluate(t),u=null,o instanceof Rr)return o;if(typeof o=="string"){const h=t.parseColor(o);if(h)return h}else if(Array.isArray(o)&&(u=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Yl(o[0],o[1],o[2],o[3]),!u))return new Rr(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new yi(u||`Could not parse color from value '${typeof o=="string"?o:String(JSON.stringify(o))}'`)}if(this.type.kind==="number"){let o=null;for(const u of this.args){if(o=u.evaluate(t),o===null)return 0;const m=Number(o);if(!isNaN(m))return m}throw new yi(`Could not convert ${JSON.stringify(o)} to number.`)}return this.type.kind==="formatted"?ho.fromString(ka(this.args[0].evaluate(t))):this.type.kind==="resolvedImage"?Li.build(ka(this.args[0].evaluate(t))):this.type.kind==="array"?this.args.map(o=>o.evaluate(t)):ka(this.args[0].evaluate(t))}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){if(this.type.kind==="formatted")return new ks([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new Rc(this.args[0]).serialize();const t=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(o=>{t.push(o.serialize())}),t}}const X_=["Unknown","Point","LineString","Polygon"];class gd{constructor(t,o){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=t,this.options=o}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?X_[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(t){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,o=this.featureDistanceData.scale,{x:u,y:m}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(u*o-t[0])+this.featureDistanceData.bearing[1]*(m*o-t[1])}return 0}parseColor(t){let o=this._parseColorCache[t];return o||(o=this._parseColorCache[t]=Rr.parse(t)),o}getConfig(t){return this.options?this.options.get(t):null}}class Xo{constructor(t,o,u,m,h){this.name=t,this.type=o,this._evaluate=u,this.args=m,this._overloadIndex=h}evaluate(t){if(!this._evaluate){const o=Xo.definitions[this.name];this._evaluate=Array.isArray(o)?o[2]:o.overloads[this._overloadIndex][1]}return this._evaluate(t,this.args)}eachChild(t){this.args.forEach(t)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(t=>t.serialize()))}static parse(t,o){const u=t[0],m=Xo.definitions[u];if(!m)return o.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0);const h=Array.isArray(m)?m[0]:m.type,g=Array.isArray(m)?[[m[1],m[2]]]:m.overloads,b=[];let E=null,A=-1;for(const[v,C]of g){if(Array.isArray(v)&&v.length!==t.length-1)continue;b.push(v),A++,E=new Wp(o.registry,o.path,null,o.scope,void 0,o._scope,o.options);const I=[];let S=!1;for(let M=1;M<t.length;M++){const R=t[M],O=Array.isArray(v)?v[M-1]:v.type,F=E.parse(R,1+I.length,O);if(!F){S=!0;break}I.push(F)}if(!S)if(Array.isArray(v)&&v.length!==I.length)E.error(`Expected ${v.length} arguments, but found ${I.length} instead.`);else{for(let M=0;M<I.length;M++){const R=Array.isArray(v)?v[M]:v.type,O=I[M];E.concat(M+1).checkSubtype(R,O.type)}if(E.errors.length===0)return new Xo(u,h,C,I,A)}}if(b.length===1)o.errors.push(...E.errors);else{const v=(b.length?b:g.map(([I])=>I)).map(_d).join(" | "),C=[];for(let I=1;I<t.length;I++){const S=o.parse(t[I],1+C.length);if(!S)return null;C.push(kn(S.type))}o.error(`Expected arguments of type ${v}, but found (${C.join(", ")}) instead.`)}return null}static register(t,o){Xo.definitions=o;for(const u in o)t[u]=Xo}}function _d(l){return Array.isArray(l)?`(${l.map(kn).join(", ")})`:`(${kn(l.type)}...)`}class yd{constructor(t,o,u){this.type=ql,this.locale=u,this.caseSensitive=t,this.diacriticSensitive=o}static parse(t,o){if(t.length!==2)return o.error("Expected one argument.");const u=t[1];if(typeof u!="object"||Array.isArray(u))return o.error("Collator options argument must be an object.");const m=u["case-sensitive"]===void 0?o.parse(!1,1,br):o.parseObjectValue(u["case-sensitive"],1,"case-sensitive",br);if(!m)return null;const h=u["diacritic-sensitive"]===void 0?o.parse(!1,1,br):o.parseObjectValue(u["diacritic-sensitive"],1,"diacritic-sensitive",br);if(!h)return null;let g=null;return u.locale&&(g=o.parseObjectValue(u.locale,1,"locale",xr),!g)?null:new yd(m,h,g)}evaluate(t){return new md(this.caseSensitive.evaluate(t),this.diacriticSensitive.evaluate(t),this.locale?this.locale.evaluate(t):null)}eachChild(t){t(this.caseSensitive),t(this.diacriticSensitive),this.locale&&t(this.locale)}outputDefined(){return!1}serialize(){const t={};return t["case-sensitive"]=this.caseSensitive.serialize(),t["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(t.locale=this.locale.serialize()),["collator",t]}}function Y_(l,t,o=0,u=l.length-1,m=Tx){for(;u>o;){if(u-o>600){const E=u-o+1,A=t-o+1,v=Math.log(E),C=.5*Math.exp(2*v/3),I=.5*Math.sqrt(v*C*(E-C)/E)*(A-E/2<0?-1:1);Y_(l,t,Math.max(o,Math.floor(t-A*C/E+I)),Math.min(u,Math.floor(t+(E-A)*C/E+I)),m)}const h=l[t];let g=o,b=u;for(Ku(l,o,t),m(l[u],h)>0&&Ku(l,o,u);g<b;){for(Ku(l,g,b),g++,b--;m(l[g],h)<0;)g++;for(;m(l[b],h)>0;)b--}m(l[o],h)===0?Ku(l,o,b):(b++,Ku(l,b,u)),b<=t&&(o=b+1),t<=b&&(u=b-1)}}function Ku(l,t,o){const u=l[t];l[t]=l[o],l[o]=u}function Tx(l,t){return l<t?-1:l>t?1:0}function Cx(l){let t=0;for(let o,u,m=0,h=l.length,g=h-1;m<h;g=m++)o=l[m],u=l[g],t+=(u.x-o.x)*(o.y+u.y);return t}function Ju(l,t){l[0]=Math.min(l[0],t[0]),l[1]=Math.min(l[1],t[1]),l[2]=Math.max(l[2],t[0]),l[3]=Math.max(l[3],t[1])}function Qu(l,t){return!(l[0]<=t[0]||l[2]>=t[2]||l[1]<=t[1]||l[3]>=t[3])}function K_(l,t,o){const u=l[0]-t[0],m=l[1]-t[1],h=l[0]-o[0],g=l[1]-o[1];return u*g-h*m==0&&u*h<=0&&m*g<=0}function Da(l,t,o=!1){let u=!1;for(let b=0,E=t.length;b<E;b++){const A=t[b];for(let v=0,C=A.length,I=C-1;v<C;I=v++){const S=A[I],M=A[v];if(K_(l,S,M))return o;(h=S)[1]>(m=l)[1]!=(g=M)[1]>m[1]&&m[0]<(g[0]-h[0])*(m[1]-h[1])/(g[1]-h[1])+h[0]&&(u=!u)}}var m,h,g;return u}function J_(l,t,o,u){const m=u[0]-o[0],h=u[1]-o[1],g=(l[0]-o[0])*h-m*(l[1]-o[1]),b=(t[0]-o[0])*h-m*(t[1]-o[1]);return g>0&&b<0||g<0&&b>0}function vd(l,t,o,u){return(m=[u[0]-o[0],u[1]-o[1]])[0]*(h=[t[0]-l[0],t[1]-l[1]])[1]-m[1]*h[0]!=0&&!(!J_(l,t,o,u)||!J_(o,u,l,t));var m,h}const ls=8192;function Mx(l,t){const o=(180+l[0])/360,u=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l[1]*Math.PI/360)))/360,m=Math.pow(2,t.z);return[Math.round(o*m*ls),Math.round(u*m*ls)]}function Ix(l,t){for(let o=0;o<t.length;o++)if(Da(l,t[o]))return!0;return!1}function Px(l,t,o){for(const u of o)for(let m=0,h=u.length,g=h-1;m<h;g=m++)if(vd(l,t,u[g],u[m]))return!0;return!1}function Q_(l,t){for(let o=0;o<l.length;++o)if(!Da(l[o],t))return!1;for(let o=0;o<l.length-1;++o)if(Px(l[o],l[o+1],t))return!1;return!0}function zc(l,t){for(let o=0;o<t.length;o++)if(Q_(l,t[o]))return!0;return!1}function Br(l,t,o){const u=[];for(let m=0;m<l.length;m++){const h=[];for(let g=0;g<l[m].length;g++){const b=Mx(l[m][g],o);Ju(t,b),h.push(b)}u.push(h)}return u}function ir(l,t,o){const u=[];for(let m=0;m<l.length;m++){const h=Br(l[m],t,o);u.push(h)}return u}function xd(l,t,o,u){if(l[0]<o[0]||l[0]>o[2]){const m=.5*u;let h=l[0]-o[0]>m?-u:o[0]-l[0]>m?u:0;h===0&&(h=l[0]-o[2]>m?-u:o[2]-l[0]>m?u:0),l[0]+=h}Ju(t,l)}function Cr(l,t,o,u){const m=Math.pow(2,u.z)*ls,h=[u.x*ls,u.y*ls],g=[];if(!l)return g;for(const b of l)for(const E of b){const A=[E.x+h[0],E.y+h[1]];xd(A,t,o,m),g.push(A)}return g}function bd(l,t,o,u){const m=Math.pow(2,u.z)*ls,h=[u.x*ls,u.y*ls],g=[];if(!l)return g;for(const E of l){const A=[];for(const v of E){const C=[v.x+h[0],v.y+h[1]];Ju(t,C),A.push(C)}g.push(A)}if(t[2]-t[0]<=m/2){(b=t)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const E of g)for(const A of E)xd(A,t,o,m)}var b;return g}class Os{constructor(t,o){this.type=br,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'within' expression requires exactly one argument, but found ${t.length-1} instead.`);if(Kl(t[1])){const u=t[1];if(u.type==="FeatureCollection")for(let m=0;m<u.features.length;++m){const h=u.features[m].geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Os(u,u.features[m].geometry)}else if(u.type==="Feature"){const m=u.geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Os(u,u.geometry)}else if(u.type==="Polygon"||u.type==="MultiPolygon")return new Os(u,u)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(t){if(t.geometry()!=null&&t.canonicalID()!=null){if(t.geometryType()==="Point")return function(o,u){const m=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],g=o.canonicalID();if(!g)return!1;if(u.type==="Polygon"){const b=Br(u.coordinates,h,g),E=Cr(o.geometry(),m,h,g);if(!Qu(m,h))return!1;for(const A of E)if(!Da(A,b))return!1}if(u.type==="MultiPolygon"){const b=ir(u.coordinates,h,g),E=Cr(o.geometry(),m,h,g);if(!Qu(m,h))return!1;for(const A of E)if(!Ix(A,b))return!1}return!0}(t,this.geometries);if(t.geometryType()==="LineString")return function(o,u){const m=[1/0,1/0,-1/0,-1/0],h=[1/0,1/0,-1/0,-1/0],g=o.canonicalID();if(!g)return!1;if(u.type==="Polygon"){const b=Br(u.coordinates,h,g),E=bd(o.geometry(),m,h,g);if(!Qu(m,h))return!1;for(const A of E)if(!Q_(A,b))return!1}if(u.type==="MultiPolygon"){const b=ir(u.coordinates,h,g),E=bd(o.geometry(),m,h,g);if(!Qu(m,h))return!1;for(const A of E)if(!zc(A,b))return!1}return!0}(t,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const mr={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},jp=1/298.257223563,wd=jp*(2-jp),Lc=Math.PI/180;class kc{static fromTile(t,o,u){const m=Math.PI*(1-2*(t+.5)/Math.pow(2,o)),h=Math.atan(.5*(Math.exp(m)-Math.exp(-m)))/Lc;return new kc(h,u)}static get units(){return mr}constructor(t,o){if(t===void 0)throw new Error("No latitude given.");if(o&&!mr[o])throw new Error(`Unknown unit ${o}. Use one of: ${Object.keys(mr).join(", ")}`);const u=6378.137*Lc*(o?mr[o]:1),m=Math.cos(t*Lc),h=1/(1-wd*(1-m*m)),g=Math.sqrt(h);this.kx=u*g*m,this.ky=u*g*h*(1-wd)}distance(t,o){const u=Yo(t[0]-o[0])*this.kx,m=(t[1]-o[1])*this.ky;return Math.sqrt(u*u+m*m)}bearing(t,o){const u=Yo(o[0]-t[0])*this.kx;return Math.atan2(u,(o[1]-t[1])*this.ky)/Lc}destination(t,o,u){const m=u*Lc;return this.offset(t,Math.sin(m)*o,Math.cos(m)*o)}offset(t,o,u){return[t[0]+o/this.kx,t[1]+u/this.ky]}lineDistance(t){let o=0;for(let u=0;u<t.length-1;u++)o+=this.distance(t[u],t[u+1]);return o}area(t){let o=0;for(let u=0;u<t.length;u++){const m=t[u];for(let h=0,g=m.length,b=g-1;h<g;b=h++)o+=Yo(m[h][0]-m[b][0])*(m[h][1]+m[b][1])*(u?-1:1)}return Math.abs(o)/2*this.kx*this.ky}along(t,o){let u=0;if(o<=0)return t[0];for(let m=0;m<t.length-1;m++){const h=t[m],g=t[m+1],b=this.distance(h,g);if(u+=b,u>o)return to(h,g,(o-(u-b))/b)}return t[t.length-1]}pointToSegmentDistance(t,o,u){let[m,h]=o,g=Yo(u[0]-m)*this.kx,b=(u[1]-h)*this.ky;if(g!==0||b!==0){const E=(Yo(t[0]-m)*this.kx*g+(t[1]-h)*this.ky*b)/(g*g+b*b);E>1?(m=u[0],h=u[1]):E>0&&(m+=g/this.kx*E,h+=b/this.ky*E)}return g=Yo(t[0]-m)*this.kx,b=(t[1]-h)*this.ky,Math.sqrt(g*g+b*b)}pointOnLine(t,o){let u=1/0,m=t[0][0],h=t[0][1],g=0,b=0;for(let E=0;E<t.length-1;E++){let A=t[E][0],v=t[E][1],C=Yo(t[E+1][0]-A)*this.kx,I=(t[E+1][1]-v)*this.ky,S=0;C===0&&I===0||(S=(Yo(o[0]-A)*this.kx*C+(o[1]-v)*this.ky*I)/(C*C+I*I),S>1?(A=t[E+1][0],v=t[E+1][1]):S>0&&(A+=C/this.kx*S,v+=I/this.ky*S)),C=Yo(o[0]-A)*this.kx,I=(o[1]-v)*this.ky;const M=C*C+I*I;M<u&&(u=M,m=A,h=v,g=E,b=S)}return{point:[m,h],index:g,t:Math.max(0,Math.min(1,b))}}lineSlice(t,o,u){let m=this.pointOnLine(u,t),h=this.pointOnLine(u,o);if(m.index>h.index||m.index===h.index&&m.t>h.t){const A=m;m=h,h=A}const g=[m.point],b=m.index+1,E=h.index;!eh(u[b],g[0])&&b<=E&&g.push(u[b]);for(let A=b+1;A<=E;A++)g.push(u[A]);return eh(u[E],h.point)||g.push(h.point),g}lineSliceAlong(t,o,u){let m=0;const h=[];for(let g=0;g<u.length-1;g++){const b=u[g],E=u[g+1],A=this.distance(b,E);if(m+=A,m>t&&h.length===0&&h.push(to(b,E,(t-(m-A))/A)),m>=o)return h.push(to(b,E,(o-(m-A))/A)),h;m>t&&h.push(E)}return h}bufferPoint(t,o){const u=o/this.ky,m=o/this.kx;return[t[0]-m,t[1]-u,t[0]+m,t[1]+u]}bufferBBox(t,o){const u=o/this.ky,m=o/this.kx;return[t[0]-m,t[1]-u,t[2]+m,t[3]+u]}insideBBox(t,o){return Yo(t[0]-o[0])>=0&&Yo(t[0]-o[2])<=0&&t[1]>=o[1]&&t[1]<=o[3]}}function eh(l,t){return l[0]===t[0]&&l[1]===t[1]}function to(l,t,o){const u=Yo(t[0]-l[0]);return[l[0]+u*o,l[1]+(t[1]-l[1])*o]}function Yo(l){for(;l<-180;)l+=360;for(;l>180;)l-=360;return l}class Sd{constructor(t=[],o=(u,m)=>u<m?-1:u>m?1:0){if(this.data=t,this.length=this.data.length,this.compare=o,this.length>0)for(let u=(this.length>>1)-1;u>=0;u--)this._down(u)}push(t){this.data.push(t),this._up(this.length++)}pop(){if(this.length===0)return;const t=this.data[0],o=this.data.pop();return--this.length>0&&(this.data[0]=o,this._down(0)),t}peek(){return this.data[0]}_up(t){const{data:o,compare:u}=this,m=o[t];for(;t>0;){const h=t-1>>1,g=o[h];if(u(m,g)>=0)break;o[t]=g,t=h}o[t]=m}_down(t){const{data:o,compare:u}=this,m=this.length>>1,h=o[t];for(;t<m;){let g=1+(t<<1);const b=g+1;if(b<this.length&&u(o[b],o[g])<0&&(g=b),u(o[g],h)>=0)break;o[t]=o[g],t=g}o[t]=h}}var Nt=8192;function Ed(l,t){return t.dist-l.dist}const Fs=100,ro=50;function e0(l){const t=[1/0,1/0,-1/0,-1/0];if(t.length!==l.length)return!1;for(let o=0;o<t.length;o++)if(t[o]!==l[o])return!1;return!0}function Td(l){return l[1]-l[0]+1}function Bs(l,t){const o=l[1]>=l[0]&&l[1]<t;return o||console.warn("Distance Expression: Index is out of range"),o}function Dc(l,t){if(l[0]>l[1])return[null,null];const o=Td(l);if(t){if(o===2)return[l,null];const u=Math.floor(o/2);return[[l[0],l[0]+u],[l[0]+u,l[1]]]}{if(o===1)return[l,null];const u=Math.floor(o/2)-1;return[[l[0],l[0]+u],[l[0]+u+1,l[1]]]}}function _l(l,t){const o=[1/0,1/0,-1/0,-1/0];if(!Bs(t,l.length))return o;for(let u=t[0];u<=t[1];++u)Ju(o,l[u]);return o}function Oc(l){const t=[1/0,1/0,-1/0,-1/0];for(let o=0;o<l.length;++o)for(let u=0;u<l[o].length;++u)Ju(t,l[o][u]);return t}function Fc(l,t,o){if(e0(l)||e0(t))return NaN;let u=0,m=0;return l[2]<t[0]&&(u=t[0]-l[2]),l[0]>t[2]&&(u=l[0]-t[2]),l[1]>t[3]&&(m=l[1]-t[3]),l[3]<t[1]&&(m=t[1]-l[3]),o.distance([0,0],[u,m])}function Ax(l){return 360*l-180}function Rx(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function $p(l,t){const o=Math.pow(2,t.z),u=(l.y/Nt+t.y)/o;return[Ax((l.x/Nt+t.x)/o),Rx(u)]}function t0(l,t){const o=[];for(let u=0;u<l.length;++u)o.push($p(l[u],t));return o}function r0(l,t,o){const u=o.pointOnLine(t,l).point;return o.distance(l,u)}function n0(l,t,o,u,m){const h=o.slice(u[0],u[1]+1);let g=1/0;for(let b=t[0];b<=t[1];++b)if((g=Math.min(g,r0(l[b],h,m)))===0)return 0;return g}function Ns(l,t,o,u,m){const h=Math.min(m.pointToSegmentDistance(l,o,u),m.pointToSegmentDistance(t,o,u)),g=Math.min(m.pointToSegmentDistance(o,l,t),m.pointToSegmentDistance(u,l,t));return Math.min(h,g)}function zx(l,t,o,u,m){if(!Bs(t,l.length)||!Bs(u,o.length))return NaN;let h=1/0;for(let g=t[0];g<t[1];++g)for(let b=u[0];b<u[1];++b){if(vd(l[g],l[g+1],o[b],o[b+1]))return 0;h=Math.min(h,Ns(l[g],l[g+1],o[b],o[b+1],m))}return h}function Lx(l,t,o,u,m){if(!Bs(t,l.length)||!Bs(u,o.length))return NaN;let h=1/0;for(let g=t[0];g<=t[1];++g)for(let b=u[0];b<=u[1];++b)if((h=Math.min(h,m.distance(l[g],o[b])))===0)return h;return h}function Vp(l,t,o){if(Da(l,t,!0))return 0;let u=1/0;for(const m of t){const h=m.length;if(h<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(m[0]!==m[h-1]&&(u=Math.min(u,o.pointToSegmentDistance(l,m[h-1],m[0])))===0||(u=Math.min(u,r0(l,m,o)))===0)return u}return u}function i0(l,t,o,u){if(!Bs(t,l.length))return NaN;for(let h=t[0];h<=t[1];++h)if(Da(l[h],o,!0))return 0;let m=1/0;for(let h=t[0];h<t[1];++h)for(const g of o)for(let b=0,E=g.length,A=E-1;b<E;A=b++){if(vd(l[h],l[h+1],g[A],g[b]))return 0;m=Math.min(m,Ns(l[h],l[h+1],g[A],g[b],u))}return m}function Up(l,t){for(const o of l)for(let u=0;u<=o.length-1;++u)if(Da(o[u],t,!0))return!0;return!1}function Oa(l,t,o,u=1/0){const m=Oc(l),h=Oc(t);if(u!==1/0&&Fc(m,h,o)>=u)return u;if(Qu(m,h)){if(Up(l,t))return 0}else if(Up(t,l))return 0;let g=u;for(const b of l)for(let E=0,A=b.length,v=A-1;E<A;v=E++)for(const C of t)for(let I=0,S=C.length,M=S-1;I<S;M=I++){if(vd(b[v],b[E],C[M],C[I]))return 0;g=Math.min(g,Ns(b[v],b[E],C[M],C[I],o))}return g}function th(l,t,o,u,m,h,g){if(h===null||g===null)return;const b=Fc(_l(u,h),_l(m,g),o);b<t&&l.push({dist:b,range1:h,range2:g})}function o0(l,t,o,u,m=1/0){let h=Math.min(u.distance(l[0],o[0][0]),m);if(h===0)return h;const g=new Sd([{dist:0,range1:[0,l.length-1],range2:[0,0]}],Ed),b=t?ro:Fs,E=Oc(o);for(;g.length;){const A=g.pop();if(A.dist>=h)continue;const v=A.range1;if(Td(v)<=b){if(!Bs(v,l.length))return NaN;if(t){const C=i0(l,v,o,u);if((h=Math.min(h,C))===0)return h}else for(let C=v[0];C<=v[1];++C){const I=Vp(l[C],o,u);if((h=Math.min(h,I))===0)return h}}else{const C=Dc(v,t);if(C[0]!==null){const I=Fc(_l(l,C[0]),E,u);I<h&&g.push({dist:I,range1:C[0],range2:[0,0]})}if(C[1]!==null){const I=Fc(_l(l,C[1]),E,u);I<h&&g.push({dist:I,range1:C[1],range2:[0,0]})}}}return h}function Gp(l,t,o,u,m,h=1/0){let g=Math.min(h,m.distance(l[0],o[0]));if(g===0)return g;const b=new Sd([{dist:0,range1:[0,l.length-1],range2:[0,o.length-1]}],Ed),E=t?ro:Fs,A=u?ro:Fs;for(;b.length;){const v=b.pop();if(v.dist>=g)continue;const C=v.range1,I=v.range2;if(Td(C)<=E&&Td(I)<=A){if(!Bs(C,l.length)||!Bs(I,o.length))return NaN;if(t&&u?g=Math.min(g,zx(l,C,o,I,m)):t||u?t&&!u?g=Math.min(g,n0(o,I,l,C,m)):!t&&u&&(g=Math.min(g,n0(l,C,o,I,m))):g=Math.min(g,Lx(l,C,o,I,m)),g===0)return g}else{const S=Dc(C,t),M=Dc(I,u);th(b,g,m,l,o,S[0],M[0]),th(b,g,m,l,o,S[0],M[1]),th(b,g,m,l,o,S[1],M[0]),th(b,g,m,l,o,S[1],M[1])}}return g}function Cd(l,t,o,u,m=1/0){let h=m;const g=_l(l,[0,l.length-1]);for(const b of o)if(!(h!==1/0&&Fc(g,_l(b,[0,b.length-1]),u)>=h)&&(h=Math.min(h,Gp(l,t,b,!0,u,h)),h===0))return h;return h}function rh(l,t,o,u,m=1/0){let h=m;const g=_l(l,[0,l.length-1]);for(const b of o){if(h!==1/0&&Fc(g,Oc(b),u)>=h)continue;const E=o0(l,t,b,u,h);if(isNaN(E))return E;if((h=Math.min(h,E))===0)return h}return h}function Md(l){return l==="Point"||l==="MultiPoint"||l==="LineString"||l==="MultiLineString"||l==="Polygon"||l==="MultiPolygon"}class yl{constructor(t,o){this.type=Mt,this.geojson=t,this.geometries=o}static parse(t,o){if(t.length!==2)return o.error(`'distance' expression requires either one argument, but found ' ${t.length-1} instead.`);if(Kl(t[1])){const u=t[1];if(u.type==="FeatureCollection"){for(let m=0;m<u.features.length;++m)if(Md(u.features[m].geometry.type))return new yl(u,u.features[m].geometry)}else if(u.type==="Feature"){if(Md(u.geometry.type))return new yl(u,u.geometry)}else if(Md(u.type))return new yl(u,u)}return o.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(t){const o=t.geometry(),u=t.canonicalID();if(o!=null&&u!=null){if(t.geometryType()==="Point")return function(m,h,g){const b=[];for(const A of m)for(const v of A)b.push($p(v,h));const E=new kc(b[0][1],"meters");return g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString"?Gp(b,!1,g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",E):g.type==="MultiLineString"?Cd(b,!1,g.coordinates,E):g.type==="Polygon"||g.type==="MultiPolygon"?rh(b,!1,g.type==="Polygon"?[g.coordinates]:g.coordinates,E):null}(o,u,this.geometries);if(t.geometryType()==="LineString")return function(m,h,g){const b=[];for(const A of m){const v=[];for(const C of A)v.push($p(C,h));b.push(v)}const E=new kc(b[0][0][1],"meters");if(g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString")return Cd(g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",b,E);if(g.type==="MultiLineString"){let A=1/0;for(let v=0;v<g.coordinates.length;v++){const C=Cd(g.coordinates[v],!0,b,E,A);if(isNaN(C))return C;if((A=Math.min(A,C))===0)return A}return A}if(g.type==="Polygon"||g.type==="MultiPolygon"){let A=1/0;for(let v=0;v<b.length;v++){const C=rh(b[v],!0,g.type==="Polygon"?[g.coordinates]:g.coordinates,E,A);if(isNaN(C))return C;if((A=Math.min(A,C))===0)return A}return A}return null}(o,u,this.geometries);if(t.geometryType()==="Polygon")return function(m,h,g){const b=[];for(const A of function(v,C){const I=v.length;if(I<=1)return[v];const S=[];let M,R;for(let O=0;O<I;O++){const F=Cx(v[O]);F!==0&&(v[O].area=Math.abs(F),R===void 0&&(R=F<0),R===F<0?(M&&S.push(M),M=[v[O]]):M.push(v[O]))}return M&&S.push(M),S}(m)){const v=[];for(let C=0;C<A.length;++C)v.push(t0(A[C],h));b.push(v)}const E=new kc(b[0][0][0][1],"meters");if(g.type==="Point"||g.type==="MultiPoint"||g.type==="LineString")return rh(g.type==="Point"?[g.coordinates]:g.coordinates,g.type==="LineString",b,E);if(g.type==="MultiLineString"){let A=1/0;for(let v=0;v<g.coordinates.length;v++){const C=rh(g.coordinates[v],!0,b,E,A);if(isNaN(C))return C;if((A=Math.min(A,C))===0)return A}return A}return g.type==="Polygon"||g.type==="MultiPolygon"?function(A,v,C){let I=1/0;for(const S of A)for(const M of v){const R=Oa(S,M,C,I);if(isNaN(R))return R;if((I=Math.min(I,R))===0)return I}return I}(g.type==="Polygon"?[g.coordinates]:g.coordinates,b,E):null}(o,u,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Id(l,t){switch(l){case"string":return ka(t);case"number":return+t;case"boolean":return!!t;case"color":return Rr.parse(t);case"formatted":return ho.fromString(ka(t));case"resolvedImage":return Li.build(ka(t))}return t}function Hp(l,t,o,u){return u!==void 0&&(l=u*Math.round(l/u)),t!==void 0&&l<t&&(l=t),o!==void 0&&l>o&&(l=o),l}class Ql{constructor(t,o,u){this.type=t,this.key=o,this.scope=u}static parse(t,o){let u=o.expectedType;if(u==null&&(u=Wr),t.length<2||t.length>3)return o.error("Invalid number of arguments for 'config' expression.");const m=o.parse(t[1],1);if(!(m instanceof ba))return o.error("Key name of 'config' expression must be a string literal.");if(t.length>=3){const h=o.parse(t[2],2);return h instanceof ba?new Ql(u,ka(m.value),ka(h.value)):o.error("Scope of 'config' expression must be a string literal.")}return new Ql(u,ka(m.value))}evaluate(t){const o=[this.key,this.scope,t.scope].filter(Boolean).join(""),u=t.getConfig(o);if(!u)return null;const{type:m,value:h,values:g,minValue:b,maxValue:E,stepValue:A}=u,v=u.default.evaluate(t);let C=v;if(h){const I=t.scope;t.scope=(I||"").split("").slice(1).join(""),C=h.evaluate(t),t.scope=I}return m&&(C=Id(m,C)),C===void 0||b===void 0&&E===void 0&&A===void 0||(typeof C=="number"?C=Hp(C,b,E,A):Array.isArray(C)&&(C=C.map(I=>typeof I=="number"?Hp(I,b,E,A):I))),h!==void 0&&C!==void 0&&g&&!g.includes(C)&&(C=v,m&&(C=Id(m,C))),(m&&m!==this.type||C!==void 0&&Hn(C)!==this.type)&&(C=Id(this.type.kind,C)),C}eachChild(){}outputDefined(){return!1}serialize(){const t=["config",this.key];return this.scope&&t.concat(this.key),t}}function Bc(l){if(l instanceof Xo&&(l.name==="get"&&l.args.length===1||l.name==="feature-state"||l.name==="has"&&l.args.length===1||l.name==="properties"||l.name==="geometry-type"||l.name==="id"||/^filter-/.test(l.name))||l instanceof Os||l instanceof yl)return!1;let t=!0;return l.eachChild(o=>{t&&!Bc(o)&&(t=!1)}),t}function ec(l){if(l instanceof Xo&&l.name==="feature-state")return!1;let t=!0;return l.eachChild(o=>{t&&!ec(o)&&(t=!1)}),t}function tc(l){if(l instanceof Ql)return new Set([l.key]);let t=new Set;return l.eachChild(o=>{t=new Set([...t,...tc(o)])}),t}function js(l,t){if(l instanceof Xo&&t.indexOf(l.name)>=0)return!1;let o=!0;return l.eachChild(u=>{o&&!js(u,t)&&(o=!1)}),o}class nh{constructor(t,o){this.type=o.type,this.name=t,this.boundExpression=o}static parse(t,o){if(t.length!==2||typeof t[1]!="string")return o.error("'var' expression requires exactly one string literal argument.");const u=t[1];return o.scope.has(u)?new nh(u,o.scope.get(u)):o.error(`Unknown variable "${u}". Make sure "${u}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(t){return this.boundExpression.evaluate(t)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Pd{constructor(t,o=[],u,m=new Wl,h=[],g,b){this.registry=t,this.path=o,this.key=o.map(E=>typeof E=="string"?`['${E}']`:`[${E}]`).join(""),this.scope=m,this.errors=h,this.expectedType=u,this._scope=g,this.options=b}parse(t,o,u,m,h={}){return o||u?this.concat(o,null,u,m)._parse(t,h):this._parse(t,h)}parseObjectValue(t,o,u,m,h,g={}){return this.concat(o,u,m,h)._parse(t,g)}_parse(t,o){function u(m,h,g){return g==="assert"?new wa(h,[m]):g==="coerce"?new Ds(h,[m]):m}if(t!==null&&typeof t!="string"&&typeof t!="boolean"&&typeof t!="number"||(t=["literal",t]),Array.isArray(t)){if(t.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const m=typeof t[0]=="string"?this.registry[t[0]]:void 0;if(m){let h=m.parse(t,this);if(!h)return null;if(this.expectedType){const g=this.expectedType,b=h.type;if(g.kind!=="string"&&g.kind!=="number"&&g.kind!=="boolean"&&g.kind!=="object"&&g.kind!=="array"||b.kind!=="value")if(g.kind!=="color"&&g.kind!=="formatted"&&g.kind!=="resolvedImage"||b.kind!=="value"&&b.kind!=="string"){if(this.checkSubtype(g,b))return null}else h=u(h,g,o.typeAnnotation||"coerce");else h=u(h,g,o.typeAnnotation||"assert")}if(!(h instanceof ba)&&h.type.kind!=="resolvedImage"&&vl(h)){const g=new gd(this._scope,this.options);try{h=new ba(h.type,h.evaluate(g))}catch(b){return this.error(b.message),null}}return h}return Ds.parse(["to-array",t],this)}return this.error(t===void 0?"'undefined' value invalid. Use null instead.":typeof t=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof t} instead.`)}concat(t,o,u,m){let h=typeof t=="number"?this.path.concat(t):this.path;h=typeof o=="string"?h.concat(o):h;const g=m?this.scope.concat(m):this.scope;return new Pd(this.registry,h,u||null,g,this.errors,this._scope,this.options)}error(t,...o){const u=`${this.key}${o.map(m=>`[${m}]`).join("")}`;this.errors.push(new co(u,t))}checkSubtype(t,o){const u=Zu(t,o);return u&&this.error(u),u}}var Wp=Pd;function vl(l){if(l instanceof nh)return vl(l.boundExpression);if(l instanceof Xo&&l.name==="error"||l instanceof yd||l instanceof Os||l instanceof yl||l instanceof Ql)return!1;const t=l instanceof Ds||l instanceof wa;let o=!0;return l.eachChild(u=>{o=t?o&&vl(u):o&&u instanceof ba}),!!o&&Bc(l)&&js(l,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function Kr(l,t){const o=l.length-1;let u,m,h=0,g=o,b=0;for(;h<=g;)if(b=Math.floor((h+g)/2),u=l[b],m=l[b+1],u<=t){if(b===o||t<m)return b;h=b+1}else{if(!(u>t))throw new yi("Input is not a number.");g=b-1}return 0}class ih{constructor(t,o,u){this.type=t,this.input=o,this.labels=[],this.outputs=[];for(const[m,h]of u)this.labels.push(m),this.outputs.push(h)}static parse(t,o){if(t.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if((t.length-1)%2!=0)return o.error("Expected an even number of arguments.");const u=o.parse(t[1],1,Mt);if(!u)return null;const m=[];let h=null;o.expectedType&&o.expectedType.kind!=="value"&&(h=o.expectedType);for(let g=1;g<t.length;g+=2){const b=g===1?-1/0:t[g],E=t[g+1],A=g,v=g+1;if(typeof b!="number")return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(m.length&&m[m.length-1][0]>=b)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const C=o.parse(E,v,h);if(!C)return null;h=h||C.type,m.push([b,C])}return new ih(h,u,m)}evaluate(t){const o=this.labels,u=this.outputs;if(o.length===1)return u[0].evaluate(t);const m=this.input.evaluate(t);if(m<=o[0])return u[0].evaluate(t);const h=o.length;return m>=o[h-1]?u[h-1].evaluate(t):u[Kr(o,m)].evaluate(t)}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){const t=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&t.push(this.labels[o]),t.push(this.outputs[o].serialize());return t}}const a0=.95047,s0=1.08883,qp=4/29,Nc=6/29,Nn=3*Nc*Nc,kx=Nc*Nc*Nc,Dx=Math.PI/180,Ox=180/Math.PI;function Zp(l){return l>kx?Math.pow(l,1/3):l/Nn+qp}function Xp(l){return l>Nc?l*l*l:Nn*(l-qp)}function Yp(l){return 255*(l<=.0031308?12.92*l:1.055*Math.pow(l,1/2.4)-.055)}function Kp(l){return(l/=255)<=.04045?l/12.92:Math.pow((l+.055)/1.055,2.4)}function l0(l){const t=Kp(l.r),o=Kp(l.g),u=Kp(l.b),m=Zp((.4124564*t+.3575761*o+.1804375*u)/a0),h=Zp((.2126729*t+.7151522*o+.072175*u)/1);return{l:116*h-16,a:500*(m-h),b:200*(h-Zp((.0193339*t+.119192*o+.9503041*u)/s0)),alpha:l.a}}function c0(l){let t=(l.l+16)/116,o=isNaN(l.a)?t:t+l.a/500,u=isNaN(l.b)?t:t-l.b/200;return t=1*Xp(t),o=a0*Xp(o),u=s0*Xp(u),new Rr(Yp(3.2404542*o-1.5371385*t-.4985314*u),Yp(-.969266*o+1.8760108*t+.041556*u),Yp(.0556434*o-.2040259*t+1.0572252*u),l.alpha)}function Fx(l,t,o){const u=t-l;return l+o*(u>180||u<-180?u-360*Math.round(u/360):u)}const oh={forward:l0,reverse:c0,interpolate:function(l,t,o){return{l:ur(l.l,t.l,o),a:ur(l.a,t.a,o),b:ur(l.b,t.b,o),alpha:ur(l.alpha,t.alpha,o)}}},ah={forward:function(l){const{l:t,a:o,b:u}=l0(l),m=Math.atan2(u,o)*Ox;return{h:m<0?m+360:m,c:Math.sqrt(o*o+u*u),l:t,alpha:l.a}},reverse:function(l){const t=l.h*Dx,o=l.c;return c0({l:l.l,a:Math.cos(t)*o,b:Math.sin(t)*o,alpha:l.alpha})},interpolate:function(l,t,o){return{h:Fx(l.h,t.h,o),c:ur(l.c,t.c,o),l:ur(l.l,t.l,o),alpha:ur(l.alpha,t.alpha,o)}}};var u0=Object.freeze({__proto__:null,hcl:ah,lab:oh});class Ko{constructor(t,o,u,m,h,g){this.type=t,this.operator=o,this.interpolation=u,this.input=m,this.dynamicStops=h,this.labels=[],this.outputs=[];for(const[b,E]of g)this.labels.push(b),this.outputs.push(E)}static interpolationFactor(t,o,u,m){let h=0;if(t.name==="exponential")h=Jp(o,t.base,u,m);else if(t.name==="linear")h=Jp(o,1,u,m);else if(t.name==="cubic-bezier"){const g=t.controlPoints;h=new $r(g[0],g[1],g[2],g[3]).solve(Jp(o,1,u,m))}return h}static parse(t,o){let[u,m,h,...g]=t;if(!Array.isArray(m)||m.length===0)return o.error("Expected an interpolation type expression.",1);if(m[0]==="linear")m={name:"linear"};else if(m[0]==="exponential"){const A=m[1];if(typeof A!="number")return o.error("Exponential interpolation requires a numeric base.",1,1);m={name:"exponential",base:A}}else{if(m[0]!=="cubic-bezier")return o.error(`Unknown interpolation type ${String(m[0])}`,1,0);{const A=m.slice(1);if(A.length!==4||A.some(v=>typeof v!="number"||v<0||v>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);m={name:"cubic-bezier",controlPoints:A}}}if(t.length-1<3)return o.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length-1>3&&(t.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(h=o.parse(h,2,Mt),!h)return null;const b=[];let E=null;if(u==="interpolate-hcl"||u==="interpolate-lab"?E=_n:o.expectedType&&o.expectedType.kind!=="value"&&(E=o.expectedType),t.length-1==3){const A=o.parse(g[0],3,Wr);return A?new Ko(E,u,m,h,A,b):null}for(let A=0;A<g.length;A+=2){const v=g[A],C=g[A+1],I=A+3,S=A+4;if(typeof v!="number")return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(b.length&&b[b.length-1][0]>=v)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',I);const M=o.parse(C,S,E);if(!M)return null;E=E||M.type,b.push([v,M])}return E.kind==="number"||E.kind==="color"||E.kind==="array"&&E.itemType.kind==="number"&&typeof E.N=="number"?new Ko(E,u,m,h,null,b):o.error(`Type ${kn(E)} is not interpolatable.`)}evaluate(t){let o=this.labels,u=this.outputs;if(this.dynamicStops){const v=this.dynamicStops.evaluate(t);if(v.length%2!=0)throw new yi("Expected an even number of arguments.");o=[],u=[];for(let C=0;C<v.length;C+=2){const I=v[C],S=new ba(Mt,v[C+1]);if(typeof I!="number")throw new yi('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.');if(o.length&&o[o.length-1]>=I)throw new yi('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.');o.push(I),u.push(S)}if(o.length===0)throw new yi("Expected at least one input/output pair.")}if(o.length===1)return u[0].evaluate(t);const m=this.input.evaluate(t);if(m<=o[0])return u[0].evaluate(t);const h=o.length;if(m>=o[h-1])return u[h-1].evaluate(t);const g=Kr(o,m),b=Ko.interpolationFactor(this.interpolation,m,o[g],o[g+1]),E=u[g].evaluate(t),A=u[g+1].evaluate(t);return this.operator==="interpolate"?Hr[this.type.kind.toLowerCase()](E,A,b):this.operator==="interpolate-hcl"?ah.reverse(ah.interpolate(ah.forward(E),ah.forward(A),b)):oh.reverse(oh.interpolate(oh.forward(E),oh.forward(A),b))}eachChild(t){t(this.input);for(const o of this.outputs)t(o)}outputDefined(){return this.outputs.every(t=>t.outputDefined())}serialize(){let t;t=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const o=[this.operator,t,this.input.serialize()];if(this.dynamicStops)o.push(this.dynamicStops.serialize());else for(let u=0;u<this.labels.length;u++)o.push(this.labels[u],this.outputs[u].serialize());return o}}function Jp(l,t,o,u){const m=u-o,h=l-o;return m===0?0:t===1?h/m:(Math.pow(t,h)-1)/(Math.pow(t,m)-1)}class Ad{constructor(t,o){this.type=t,this.args=o}static parse(t,o){if(t.length<2)return o.error("Expectected at least one argument.");let u=null;const m=o.expectedType;m&&m.kind!=="value"&&(u=m);const h=[];for(const b of t.slice(1)){const E=o.parse(b,1+h.length,u,void 0,{typeAnnotation:"omit"});if(!E)return null;u=u||E.type,h.push(E)}const g=m&&h.some(b=>Zu(m,b.type));return new Ad(g?Wr:u,h)}evaluate(t){let o,u=null,m=0;for(const h of this.args){if(m++,u=h.evaluate(t),u&&u instanceof Li&&!u.available&&(o||(o=u),u=null,m===this.args.length))return o;if(u!==null)break}return u}eachChild(t){this.args.forEach(t)}outputDefined(){return this.args.every(t=>t.outputDefined())}serialize(){const t=["coalesce"];return this.eachChild(o=>{t.push(o.serialize())}),t}}class Rd{constructor(t,o){this.type=o.type,this.bindings=[].concat(t),this.result=o}evaluate(t){return this.result.evaluate(t)}eachChild(t){for(const o of this.bindings)t(o[1]);t(this.result)}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found ${t.length-1} instead.`);const u=[];for(let h=1;h<t.length-1;h+=2){const g=t[h];if(typeof g!="string")return o.error(`Expected string, but found ${typeof g} instead.`,h);if(/[^a-zA-Z0-9_]/.test(g))return o.error("Variable names must contain only alphanumeric characters or '_'.",h);const b=o.parse(t[h+1],h+1);if(!b)return null;u.push([g,b])}const m=o.parse(t[t.length-1],t.length-1,o.expectedType,u);return m?new Rd(u,m):null}outputDefined(){return this.result.outputDefined()}serialize(){const t=["let"];for(const[o,u]of this.bindings)t.push(o,u.serialize());return t.push(this.result.serialize()),t}}class Qp{constructor(t,o,u){this.type=t,this.index=o,this.input=u}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=o.parse(t[1],1,Mt),m=o.parse(t[2],2,uo(o.expectedType||Wr));return u&&m?new Qp(m.type.itemType,u,m):null}evaluate(t){const o=this.index.evaluate(t),u=this.input.evaluate(t);if(o<0)throw new yi(`Array index out of bounds: ${o} < 0.`);if(o>u.length-1)throw new yi(`Array index out of bounds: ${o} > ${u.length-1}.`);if(o===Math.floor(o))return u[o];const m=Math.floor(o),h=Math.ceil(o),g=u[m],b=u[h];if(typeof g!="number"||typeof b!="number")throw new yi(`Cannot interpolate between non-number values at index ${o}.`);const E=o-m;return g*(1-E)+b*E}eachChild(t){t(this.index),t(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class em{constructor(t,o){this.type=br,this.needle=t,this.haystack=o}static parse(t,o){if(t.length!==3)return o.error(`Expected 2 arguments, but found ${t.length-1} instead.`);const u=o.parse(t[1],1,Wr),m=o.parse(t[2],2,Wr);return u&&m?pd(u.type,[br,xr,Mt,_r,Wr])?new em(u,m):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${kn(u.type)} instead`):null}evaluate(t){const o=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(u==null)return!1;if(!Ac(o,["boolean","string","number","null"]))throw new yi(`Expected first argument to be of type boolean, string, number or null, but found ${kn(Hn(o))} instead.`);if(!Ac(u,["string","array"]))throw new yi(`Expected second argument to be of type array or string, but found ${kn(Hn(u))} instead.`);return u.indexOf(o)>=0}eachChild(t){t(this.needle),t(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class zd{constructor(t,o,u){this.type=Mt,this.needle=t,this.haystack=o,this.fromIndex=u}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const u=o.parse(t[1],1,Wr),m=o.parse(t[2],2,Wr);if(!u||!m)return null;if(!pd(u.type,[br,xr,Mt,_r,Wr]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${kn(u.type)} instead`);if(t.length===4){const h=o.parse(t[3],3,Mt);return h?new zd(u,m,h):null}return new zd(u,m)}evaluate(t){const o=this.needle.evaluate(t),u=this.haystack.evaluate(t);if(!Ac(o,["boolean","string","number","null"]))throw new yi(`Expected first argument to be of type boolean, string, number or null, but found ${kn(Hn(o))} instead.`);if(!Ac(u,["string","array"]))throw new yi(`Expected second argument to be of type array or string, but found ${kn(Hn(u))} instead.`);if(this.fromIndex){const m=this.fromIndex.evaluate(t);return u.indexOf(o,m)}return u.indexOf(o)}eachChild(t){t(this.needle),t(this.haystack),this.fromIndex&&t(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const t=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),t]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class tm{constructor(t,o,u,m,h,g){this.inputType=t,this.type=o,this.input=u,this.cases=m,this.outputs=h,this.otherwise=g}static parse(t,o){if(t.length<5)return o.error(`Expected at least 4 arguments, but found only ${t.length-1}.`);if(t.length%2!=1)return o.error("Expected an even number of arguments.");let u,m;o.expectedType&&o.expectedType.kind!=="value"&&(m=o.expectedType);const h={},g=[];for(let A=2;A<t.length-1;A+=2){let v=t[A];const C=t[A+1];Array.isArray(v)||(v=[v]);const I=o.concat(A);if(v.length===0)return I.error("Expected at least one branch label.");for(const M of v){if(typeof M!="number"&&typeof M!="string")return I.error("Branch labels must be numbers or strings.");if(typeof M=="number"&&Math.abs(M)>Number.MAX_SAFE_INTEGER)return I.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof M=="number"&&Math.floor(M)!==M)return I.error("Numeric branch labels must be integer values.");if(u){if(I.checkSubtype(u,Hn(M)))return null}else u=Hn(M);if(h[String(M)]!==void 0)return I.error("Branch labels must be unique.");h[String(M)]=g.length}const S=o.parse(C,A,m);if(!S)return null;m=m||S.type,g.push(S)}const b=o.parse(t[1],1,Wr);if(!b)return null;const E=o.parse(t[t.length-1],t.length-1,m);return E?b.type.kind!=="value"&&o.concat(1).checkSubtype(u,b.type)?null:new tm(u,m,b,h,g,E):null}evaluate(t){const o=this.input.evaluate(t);return(Hn(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(t)}eachChild(t){t(this.input),this.outputs.forEach(t),t(this.otherwise)}outputDefined(){return this.outputs.every(t=>t.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),u=[],m={};for(const g of o){const b=m[this.cases[g]];b===void 0?(m[this.cases[g]]=u.length,u.push([this.cases[g],[g]])):u[b][1].push(g)}const h=g=>this.inputType.kind==="number"?Number(g):g;for(const[g,b]of u)t.push(b.length===1?h(b[0]):b.map(h)),t.push(this.outputs[g].serialize());return t.push(this.otherwise.serialize()),t}}class rm{constructor(t,o,u){this.type=t,this.branches=o,this.otherwise=u}static parse(t,o){if(t.length<4)return o.error(`Expected at least 3 arguments, but found only ${t.length-1}.`);if(t.length%2!=0)return o.error("Expected an odd number of arguments.");let u;o.expectedType&&o.expectedType.kind!=="value"&&(u=o.expectedType);const m=[];for(let g=1;g<t.length-1;g+=2){const b=o.parse(t[g],g,br);if(!b)return null;const E=o.parse(t[g+1],g+1,u);if(!E)return null;m.push([b,E]),u=u||E.type}const h=o.parse(t[t.length-1],t.length-1,u);return h?new rm(u,m,h):null}evaluate(t){for(const[o,u]of this.branches)if(o.evaluate(t))return u.evaluate(t);return this.otherwise.evaluate(t)}eachChild(t){for(const[o,u]of this.branches)t(o),t(u);t(this.otherwise)}outputDefined(){return this.branches.every(([t,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const t=["case"];return this.eachChild(o=>{t.push(o.serialize())}),t}}class Ld{constructor(t,o,u,m){this.type=t,this.input=o,this.beginIndex=u,this.endIndex=m}static parse(t,o){if(t.length<=2||t.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${t.length-1} instead.`);const u=o.parse(t[1],1,Wr),m=o.parse(t[2],2,Mt);if(!u||!m)return null;if(!pd(u.type,[uo(Wr),xr,Wr]))return o.error(`Expected first argument to be of type array or string, but found ${kn(u.type)} instead`);if(t.length===4){const h=o.parse(t[3],3,Mt);return h?new Ld(u.type,u,m,h):null}return new Ld(u.type,u,m)}evaluate(t){const o=this.input.evaluate(t),u=this.beginIndex.evaluate(t);if(!Ac(o,["string","array"]))throw new yi(`Expected first argument to be of type array or string, but found ${kn(Hn(o))} instead.`);if(this.endIndex){const m=this.endIndex.evaluate(t);return o.slice(u,m)}return o.slice(u)}eachChild(t){t(this.input),t(this.beginIndex),this.endIndex&&t(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const t=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),t]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function h0(l,t){return l==="=="||l==="!="?t.kind==="boolean"||t.kind==="string"||t.kind==="number"||t.kind==="null"||t.kind==="value":t.kind==="string"||t.kind==="number"||t.kind==="value"}function d0(l,t,o,u){return u.compare(t,o)===0}function jc(l,t,o){const u=l!=="=="&&l!=="!=";return class pk{constructor(h,g,b){this.type=br,this.lhs=h,this.rhs=g,this.collator=b,this.hasUntypedArgument=h.type.kind==="value"||g.type.kind==="value"}static parse(h,g){if(h.length!==3&&h.length!==4)return g.error("Expected two or three arguments.");const b=h[0];let E=g.parse(h[1],1,Wr);if(!E)return null;if(!h0(b,E.type))return g.concat(1).error(`"${b}" comparisons are not supported for type '${kn(E.type)}'.`);let A=g.parse(h[2],2,Wr);if(!A)return null;if(!h0(b,A.type))return g.concat(2).error(`"${b}" comparisons are not supported for type '${kn(A.type)}'.`);if(E.type.kind!==A.type.kind&&E.type.kind!=="value"&&A.type.kind!=="value")return g.error(`Cannot compare types '${kn(E.type)}' and '${kn(A.type)}'.`);u&&(E.type.kind==="value"&&A.type.kind!=="value"?E=new wa(A.type,[E]):E.type.kind!=="value"&&A.type.kind==="value"&&(A=new wa(E.type,[A])));let v=null;if(h.length===4){if(E.type.kind!=="string"&&A.type.kind!=="string"&&E.type.kind!=="value"&&A.type.kind!=="value")return g.error("Cannot use collator to compare non-string types.");if(v=g.parse(h[3],3,ql),!v)return null}return new pk(E,A,v)}evaluate(h){const g=this.lhs.evaluate(h),b=this.rhs.evaluate(h);if(u&&this.hasUntypedArgument){const E=Hn(g),A=Hn(b);if(E.kind!==A.kind||E.kind!=="string"&&E.kind!=="number")throw new yi(`Expected arguments for "${l}" to be (string, string) or (number, number), but found (${E.kind}, ${A.kind}) instead.`)}if(this.collator&&!u&&this.hasUntypedArgument){const E=Hn(g),A=Hn(b);if(E.kind!=="string"||A.kind!=="string")return t(h,g,b)}return this.collator?o(h,g,b,this.collator.evaluate(h)):t(h,g,b)}eachChild(h){h(this.lhs),h(this.rhs),this.collator&&h(this.collator)}outputDefined(){return!0}serialize(){const h=[l];return this.eachChild(g=>{h.push(g.serialize())}),h}}}const Bx=jc("==",function(l,t,o){return t===o},d0),Nx=jc("!=",function(l,t,o){return t!==o},function(l,t,o,u){return!d0(0,t,o,u)}),jx=jc("<",function(l,t,o){return t<o},function(l,t,o,u){return u.compare(t,o)<0}),$x=jc(">",function(l,t,o){return t>o},function(l,t,o,u){return u.compare(t,o)>0}),Vx=jc("<=",function(l,t,o){return t<=o},function(l,t,o,u){return u.compare(t,o)<=0}),nm=jc(">=",function(l,t,o){return t>=o},function(l,t,o,u){return u.compare(t,o)>=0});class im{constructor(t,o,u,m,h,g){this.type=xr,this.number=t,this.locale=o,this.currency=u,this.unit=m,this.minFractionDigits=h,this.maxFractionDigits=g}static parse(t,o){if(t.length!==3)return o.error("Expected two arguments.");const u=o.parse(t[1],1,Mt);if(!u)return null;const m=t[2];if(typeof m!="object"||Array.isArray(m))return o.error("NumberFormat options argument must be an object.");let h=null;if(m.locale&&(h=o.parseObjectValue(m.locale,2,"locale",xr),!h))return null;let g=null;if(m.currency&&(g=o.parseObjectValue(m.currency,2,"currency",xr),!g))return null;let b=null;if(m.unit&&(b=o.parseObjectValue(m.unit,2,"unit",xr),!b))return null;let E=null;if(m["min-fraction-digits"]&&(E=o.parseObjectValue(m["min-fraction-digits"],2,"min-fraction-digits",Mt),!E))return null;let A=null;return m["max-fraction-digits"]&&(A=o.parseObjectValue(m["max-fraction-digits"],2,"max-fraction-digits",Mt),!A)?null:new im(u,h,g,b,E,A)}evaluate(t){return new Intl.NumberFormat(this.locale?this.locale.evaluate(t):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(t):void 0,unit:this.unit?this.unit.evaluate(t):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(t):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(t):void 0}).format(this.number.evaluate(t))}eachChild(t){t(this.number),this.locale&&t(this.locale),this.currency&&t(this.currency),this.unit&&t(this.unit),this.minFractionDigits&&t(this.minFractionDigits),this.maxFractionDigits&&t(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const t={};return this.locale&&(t.locale=this.locale.serialize()),this.currency&&(t.currency=this.currency.serialize()),this.unit&&(t.unit=this.unit.serialize()),this.minFractionDigits&&(t["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(t["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),t]}}class kd{constructor(t){this.type=Mt,this.input=t}static parse(t,o){if(t.length!==2)return o.error(`Expected 1 argument, but found ${t.length-1} instead.`);const u=o.parse(t[1],1);return u?u.type.kind!=="array"&&u.type.kind!=="string"&&u.type.kind!=="value"?o.error(`Expected argument of type string or array, but found ${kn(u.type)} instead.`):new kd(u):null}evaluate(t){const o=this.input.evaluate(t);if(typeof o=="string"||Array.isArray(o))return o.length;throw new yi(`Expected value to be of type string or array, but found ${kn(Hn(o))} instead.`)}eachChild(t){t(this.input)}outputDefined(){return!1}serialize(){const t=["length"];return this.eachChild(o=>{t.push(o.serialize())}),t}}function f0(l){return function(){l=1831565813+(l|=0)|0;let t=Math.imul(l^l>>>15,1|l);return t=t+Math.imul(t^t>>>7,61|t)^t,((t^t>>>14)>>>0)/4294967296}}const $c={"==":Bx,"!=":Nx,">":$x,"<":jx,">=":nm,"<=":Vx,array:wa,at:Qp,boolean:wa,case:rm,coalesce:Ad,collator:yd,format:ks,image:Rc,in:em,"index-of":zd,interpolate:Ko,"interpolate-hcl":Ko,"interpolate-lab":Ko,length:kd,let:Rd,literal:ba,match:tm,number:wa,"number-format":im,object:wa,slice:Ld,step:ih,string:wa,"to-boolean":Ds,"to-color":Ds,"to-number":Ds,"to-string":Ds,var:nh,within:Os,distance:yl,config:Ql};function p0(l,[t,o,u,m]){t=t.evaluate(l),o=o.evaluate(l),u=u.evaluate(l);const h=m?m.evaluate(l):1,g=Yl(t,o,u,h);if(g)throw new yi(g);return new Rr(t/255*h,o/255*h,u/255*h,h)}function om(l,[t,o,u,m]){t=t.evaluate(l),o=o.evaluate(l),u=u.evaluate(l);const h=m?m.evaluate(l):1,g=function(A,v,C,I){return typeof A=="number"&&A>=0&&A<=360?typeof v=="number"&&v>=0&&v<=100&&typeof C=="number"&&C>=0&&C<=100?I===void 0||typeof I=="number"&&I>=0&&I<=1?null:`Invalid hsla value [${[A,v,C,I].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof I=="number"?[A,v,C,I]:[A,v,C]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof I=="number"?[A,v,C,I]:[A,v,C]).join(", ")}]: 'h' must be between 0 and 360.`}(t,o,u,h);if(g)throw new yi(g);const b=`hsla(${t}, ${o}%, ${u}%, ${h})`,E=Rr.parse(b);if(!E)throw new yi(`Failed to parse HSLA color: ${b}`);return E}function am(l,t){return l in t}function xl(l,t){const o=t[l];return o===void 0?null:o}function bl(l){return{type:l}}function sm(l){return{result:"success",value:l}}function wl(l){return{result:"error",value:l}}function sh(l,t){return!!l&&!!l.parameters&&l.parameters.indexOf(t)>-1}function Vc(l){return l["property-type"]==="data-driven"}function m0(l){return sh(l.expression,"measure-light")}function g0(l){return sh(l.expression,"zoom")}function Dd(l){return!!l.expression&&l.expression.interpolated}function Od(l){return typeof l=="object"&&l!==null&&!Array.isArray(l)}function Ux(l){return l}function _0(l,t){const o=t.type==="color",u=l.stops&&typeof l.stops[0][0]=="object",m=u||!(u||l.property!==void 0),h=l.type||(Dd(t)?"exponential":"interval");if(o&&((l=Ls({},l)).stops&&(l.stops=l.stops.map(A=>[A[0],Rr.parse(A[1])])),l.default=Rr.parse(l.default?l.default:t.default)),l.colorSpace&&l.colorSpace!=="rgb"&&!u0[l.colorSpace])throw new Error(`Unknown color space: ${l.colorSpace}`);let g,b,E;if(h==="exponential")g=ch;else if(h==="interval")g=v0;else if(h==="categorical"){g=y0,b=Object.create(null);for(const A of l.stops)b[A[0]]=A[1];E=typeof l.stops[0][0]}else{if(h!=="identity")throw new Error(`Unknown function type "${h}"`);g=Gx}if(u){const A={},v=[];for(let S=0;S<l.stops.length;S++){const M=l.stops[S],R=M[0].zoom;A[R]===void 0&&(A[R]={zoom:R,type:l.type,property:l.property,default:l.default,stops:[]},v.push(R)),A[R].stops.push([M[0].value,M[1]])}const C=[];for(const S of v)C.push([A[S].zoom,_0(A[S],t)]);const I={name:"linear"};return{kind:"composite",interpolationType:I,interpolationFactor:Ko.interpolationFactor.bind(void 0,I),zoomStops:C.map(S=>S[0]),evaluate:({zoom:S},M)=>ch({stops:C,base:l.base},t,S).evaluate(S,M)}}if(m){const A=h==="exponential"?{name:"exponential",base:l.base!==void 0?l.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:Ko.interpolationFactor.bind(void 0,A),zoomStops:l.stops.map(v=>v[0]),evaluate:({zoom:v})=>g(l,t,v,b,E)}}return{kind:"source",evaluate(A,v){const C=v&&v.properties?v.properties[l.property]:void 0;return C===void 0?lh(l.default,t.default):g(l,t,C,b,E)}}}function lh(l,t,o){return l!==void 0?l:t!==void 0?t:o!==void 0?o:void 0}function y0(l,t,o,u,m){return lh(typeof o===m?u[o]:void 0,l.default,t.default)}function v0(l,t,o){if(Jl(o)!=="number")return lh(l.default,t.default);const u=l.stops.length;if(u===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[u-1][0])return l.stops[u-1][1];const m=Kr(l.stops.map(h=>h[0]),o);return l.stops[m][1]}function ch(l,t,o){const u=l.base!==void 0?l.base:1;if(Jl(o)!=="number")return lh(l.default,t.default);const m=l.stops.length;if(m===1||o<=l.stops[0][0])return l.stops[0][1];if(o>=l.stops[m-1][0])return l.stops[m-1][1];const h=Kr(l.stops.map(v=>v[0]),o),g=function(v,C,I,S){const M=S-I,R=v-I;return M===0?0:C===1?R/M:(Math.pow(C,R)-1)/(Math.pow(C,M)-1)}(o,u,l.stops[h][0],l.stops[h+1][0]),b=l.stops[h][1],E=l.stops[h+1][1];let A=Hr[t.type]||Ux;if(l.colorSpace&&l.colorSpace!=="rgb"){const v=u0[l.colorSpace];A=(C,I)=>v.reverse(v.interpolate(v.forward(C),v.forward(I),g))}return typeof b.evaluate=="function"?{evaluate(...v){const C=b.evaluate.apply(void 0,v),I=E.evaluate.apply(void 0,v);if(C!==void 0&&I!==void 0)return A(C,I,g)}}:A(b,E,g)}function Gx(l,t,o){return t.type==="color"?o=Rr.parse(o):t.type==="formatted"?o=ho.fromString(o.toString()):t.type==="resolvedImage"?o=Li.build(o.toString()):Jl(o)===t.type||t.type==="enum"&&t.values[o]||(o=void 0),lh(o,l.default,t.default)}Xo.register($c,{error:[{kind:"error"},[xr],(l,[t])=>{throw new yi(t.evaluate(l))}],typeof:[xr,[Wr],(l,[t])=>kn(Hn(t.evaluate(l)))],"to-rgba":[uo(Mt,4),[_n],(l,[t])=>t.evaluate(l).toRenderColor(null).toArray()],"to-hsla":[uo(Mt,4),[_n],(l,[t])=>t.evaluate(l).toRenderColor(null).toHslaArray()],rgb:[_n,[Mt,Mt,Mt],p0],rgba:[_n,[Mt,Mt,Mt,Mt],p0],hsl:[_n,[Mt,Mt,Mt],om],hsla:[_n,[Mt,Mt,Mt,Mt],om],has:{type:br,overloads:[[[xr],(l,[t])=>am(t.evaluate(l),l.properties())],[[xr,xa],(l,[t,o])=>am(t.evaluate(l),o.evaluate(l))]]},get:{type:Wr,overloads:[[[xr],(l,[t])=>xl(t.evaluate(l),l.properties())],[[xr,xa],(l,[t,o])=>xl(t.evaluate(l),o.evaluate(l))]]},"feature-state":[Wr,[xr],(l,[t])=>xl(t.evaluate(l),l.featureState||{})],properties:[xa,[],l=>l.properties()],"geometry-type":[xr,[],l=>l.geometryType()],id:[Wr,[],l=>l.id()],zoom:[Mt,[],l=>l.globals.zoom],pitch:[Mt,[],l=>l.globals.pitch||0],"distance-from-center":[Mt,[],l=>l.distanceFromCenter()],"measure-light":[Mt,[xr],(l,[t])=>l.measureLight(t.evaluate(l))],"heatmap-density":[Mt,[],l=>l.globals.heatmapDensity||0],"line-progress":[Mt,[],l=>l.globals.lineProgress||0],"raster-value":[Mt,[],l=>l.globals.rasterValue||0],"raster-particle-speed":[Mt,[],l=>l.globals.rasterParticleSpeed||0],"sky-radial-progress":[Mt,[],l=>l.globals.skyRadialProgress||0],accumulated:[Wr,[],l=>l.globals.accumulated===void 0?null:l.globals.accumulated],"+":[Mt,bl(Mt),(l,t)=>{let o=0;for(const u of t)o+=u.evaluate(l);return o}],"*":[Mt,bl(Mt),(l,t)=>{let o=1;for(const u of t)o*=u.evaluate(l);return o}],"-":{type:Mt,overloads:[[[Mt,Mt],(l,[t,o])=>t.evaluate(l)-o.evaluate(l)],[[Mt],(l,[t])=>-t.evaluate(l)]]},"/":[Mt,[Mt,Mt],(l,[t,o])=>t.evaluate(l)/o.evaluate(l)],"%":[Mt,[Mt,Mt],(l,[t,o])=>t.evaluate(l)%o.evaluate(l)],ln2:[Mt,[],()=>Math.LN2],pi:[Mt,[],()=>Math.PI],e:[Mt,[],()=>Math.E],"^":[Mt,[Mt,Mt],(l,[t,o])=>Math.pow(t.evaluate(l),o.evaluate(l))],sqrt:[Mt,[Mt],(l,[t])=>Math.sqrt(t.evaluate(l))],log10:[Mt,[Mt],(l,[t])=>Math.log(t.evaluate(l))/Math.LN10],ln:[Mt,[Mt],(l,[t])=>Math.log(t.evaluate(l))],log2:[Mt,[Mt],(l,[t])=>Math.log(t.evaluate(l))/Math.LN2],sin:[Mt,[Mt],(l,[t])=>Math.sin(t.evaluate(l))],cos:[Mt,[Mt],(l,[t])=>Math.cos(t.evaluate(l))],tan:[Mt,[Mt],(l,[t])=>Math.tan(t.evaluate(l))],asin:[Mt,[Mt],(l,[t])=>Math.asin(t.evaluate(l))],acos:[Mt,[Mt],(l,[t])=>Math.acos(t.evaluate(l))],atan:[Mt,[Mt],(l,[t])=>Math.atan(t.evaluate(l))],min:[Mt,bl(Mt),(l,t)=>Math.min(...t.map(o=>o.evaluate(l)))],max:[Mt,bl(Mt),(l,t)=>Math.max(...t.map(o=>o.evaluate(l)))],abs:[Mt,[Mt],(l,[t])=>Math.abs(t.evaluate(l))],round:[Mt,[Mt],(l,[t])=>{const o=t.evaluate(l);return o<0?-Math.round(-o):Math.round(o)}],floor:[Mt,[Mt],(l,[t])=>Math.floor(t.evaluate(l))],ceil:[Mt,[Mt],(l,[t])=>Math.ceil(t.evaluate(l))],"filter-==":[br,[xr,Wr],(l,[t,o])=>l.properties()[t.value]===o.value],"filter-id-==":[br,[Wr],(l,[t])=>l.id()===t.value],"filter-type-==":[br,[xr],(l,[t])=>l.geometryType()===t.value],"filter-<":[br,[xr,Wr],(l,[t,o])=>{const u=l.properties()[t.value],m=o.value;return typeof u==typeof m&&u<m}],"filter-id-<":[br,[Wr],(l,[t])=>{const o=l.id(),u=t.value;return typeof o==typeof u&&o<u}],"filter->":[br,[xr,Wr],(l,[t,o])=>{const u=l.properties()[t.value],m=o.value;return typeof u==typeof m&&u>m}],"filter-id->":[br,[Wr],(l,[t])=>{const o=l.id(),u=t.value;return typeof o==typeof u&&o>u}],"filter-<=":[br,[xr,Wr],(l,[t,o])=>{const u=l.properties()[t.value],m=o.value;return typeof u==typeof m&&u<=m}],"filter-id-<=":[br,[Wr],(l,[t])=>{const o=l.id(),u=t.value;return typeof o==typeof u&&o<=u}],"filter->=":[br,[xr,Wr],(l,[t,o])=>{const u=l.properties()[t.value],m=o.value;return typeof u==typeof m&&u>=m}],"filter-id->=":[br,[Wr],(l,[t])=>{const o=l.id(),u=t.value;return typeof o==typeof u&&o>=u}],"filter-has":[br,[Wr],(l,[t])=>t.value in l.properties()],"filter-has-id":[br,[],l=>l.id()!==null&&l.id()!==void 0],"filter-type-in":[br,[uo(xr)],(l,[t])=>t.value.indexOf(l.geometryType())>=0],"filter-id-in":[br,[uo(Wr)],(l,[t])=>t.value.indexOf(l.id())>=0],"filter-in-small":[br,[xr,uo(Wr)],(l,[t,o])=>o.value.indexOf(l.properties()[t.value])>=0],"filter-in-large":[br,[xr,uo(Wr)],(l,[t,o])=>function(u,m,h,g){for(;h<=g;){const b=h+g>>1;if(m[b]===u)return!0;m[b]>u?g=b-1:h=b+1}return!1}(l.properties()[t.value],o.value,0,o.value.length-1)],all:{type:br,overloads:[[[br,br],(l,[t,o])=>t.evaluate(l)&&o.evaluate(l)],[bl(br),(l,t)=>{for(const o of t)if(!o.evaluate(l))return!1;return!0}]]},any:{type:br,overloads:[[[br,br],(l,[t,o])=>t.evaluate(l)||o.evaluate(l)],[bl(br),(l,t)=>{for(const o of t)if(o.evaluate(l))return!0;return!1}]]},"!":[br,[br],(l,[t])=>!t.evaluate(l)],"is-supported-script":[br,[xr],(l,[t])=>{const o=l.globals&&l.globals.isSupportedScript;return!o||o(t.evaluate(l))}],upcase:[xr,[xr],(l,[t])=>t.evaluate(l).toUpperCase()],downcase:[xr,[xr],(l,[t])=>t.evaluate(l).toLowerCase()],concat:[xr,bl(Wr),(l,t)=>t.map(o=>ka(o.evaluate(l))).join("")],"resolved-locale":[xr,[ql],(l,[t])=>t.evaluate(l).resolvedLocale()],random:[Mt,[Mt,Mt,Wr],(l,t)=>{const[o,u,m]=t.map(g=>g.evaluate(l));if(o>u||o===u)return o;let h;if(typeof m=="string")h=function(g){let b=0;if(g.length===0)return b;for(let E=0;E<g.length;E++)b=(b<<5)-b+g.charCodeAt(E),b|=0;return b}(m);else{if(typeof m!="number")throw new yi(`Invalid seed input: ${m}`);h=m}return o+f0(h)()*(u-o)}]});class Fd{constructor(t,o,u,m){this.expression=t,this._warningHistory={},this._evaluator=new gd(u,m),this._defaultValue=o?function(h){return h.type==="color"&&(Od(h.default)||Array.isArray(h.default))?new Rr(0,0,0,0):h.type==="color"?Rr.parse(h.default)||null:h.default===void 0?null:h.default}(o):null,this._enumValues=o&&o.type==="enum"?o.values:null,this.configDependencies=tc(t)}evaluateWithoutErrorHandling(t,o,u,m,h,g,b,E){return this._evaluator.globals=t,this._evaluator.feature=o,this._evaluator.featureState=u,this._evaluator.canonical=m||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=g,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(t,o,u,m,h,g,b,E){this._evaluator.globals=t,this._evaluator.feature=o||null,this._evaluator.featureState=u||null,this._evaluator.canonical=m||null,this._evaluator.availableImages=h||null,this._evaluator.formattedSection=g||null,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=E||null;try{const A=this.expression.evaluate(this._evaluator);if(A==null||typeof A=="number"&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new yi(`Expected value to be one of ${Object.keys(this._enumValues).map(v=>JSON.stringify(v)).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${A.message}`)),this._defaultValue}}}function Bd(l){return Array.isArray(l)&&l.length>0&&typeof l[0]=="string"&&l[0]in $c}function uh(l,t,o,u){const m=new Wp($c,[],t?function(g){const b={color:_n,string:xr,number:Mt,enum:xr,boolean:br,formatted:Zo,resolvedImage:Zl};return g.type==="array"?uo(b[g.value]||Wr,g.length):b[g.type]}(t):void 0,void 0,void 0,o,u),h=m.parse(l,void 0,void 0,void 0,t&&t.type==="string"?{typeAnnotation:"coerce"}:void 0);return h?sm(new Fd(h,t,o,u)):wl(m.errors)}class Nd{constructor(t,o,u,m){this.kind=t,this._styleExpression=o,this.isLightConstant=u,this.isLineProgressConstant=m,this.isStateDependent=t!=="constant"&&!ec(o.expression),this.configDependencies=tc(o.expression)}evaluateWithoutErrorHandling(t,o,u,m,h,g){return this._styleExpression.evaluateWithoutErrorHandling(t,o,u,m,h,g)}evaluate(t,o,u,m,h,g){return this._styleExpression.evaluate(t,o,u,m,h,g)}}class Uc{constructor(t,o,u,m,h,g){this.kind=t,this.zoomStops=u,this._styleExpression=o,this.isStateDependent=t!=="camera"&&!ec(o.expression),this.isLightConstant=h,this.isLineProgressConstant=g,this.configDependencies=tc(o.expression),this.interpolationType=m}evaluateWithoutErrorHandling(t,o,u,m,h,g){return this._styleExpression.evaluateWithoutErrorHandling(t,o,u,m,h,g)}evaluate(t,o,u,m,h,g){return this._styleExpression.evaluate(t,o,u,m,h,g)}interpolationFactor(t,o,u){return this.interpolationType?Ko.interpolationFactor(this.interpolationType,t,o,u):0}}function x0(l,t,o,u){if((l=uh(l,t,o,u)).result==="error")return l;const m=l.value.expression,h=Bc(m);if(!h&&!Vc(t))return wl([new co("","data expressions not supported")]);const g=js(m,["zoom","pitch","distance-from-center"]);if(!g&&!g0(t))return wl([new co("","zoom expressions not supported")]);const b=js(m,["measure-light"]);if(!b&&!m0(t))return wl([new co("","measure-light expression not supported")]);const E=js(m,["line-progress"]);if(!E&&!function(C){return sh(C.expression,"line-progress")}(t))return wl([new co("","line-progress expression not supported")]);const A=t.expression&&t.expression.relaxZoomRestriction,v=$d(m);return v||g||A?v instanceof co?wl([v]):v instanceof Ko&&!Dd(t)?wl([new co("",'"interpolate" expressions cannot be used with this property')]):sm(v?new Uc(h&&E?"camera":"composite",l.value,v.labels,v instanceof Ko?v.interpolation:void 0,b,E):new Nd(h&&E?"constant":"source",l.value,b,E)):wl([new co("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class jd{constructor(t,o){this._parameters=t,this._specification=o,Ls(this,_0(this._parameters,this._specification))}static deserialize(t){return new jd(t._parameters,t._specification)}static serialize(t){return{_parameters:t._parameters,_specification:t._specification}}}function $d(l){let t=null;if(l instanceof Rd)t=$d(l.result);else if(l instanceof Ad){for(const o of l.args)if(t=$d(o),t)break}else(l instanceof ih||l instanceof Ko)&&l.input instanceof Xo&&l.input.name==="zoom"&&(t=l);return t instanceof co||l.eachChild(o=>{const u=$d(o);u instanceof co?t=u:t&&u&&t!==u&&(t=new co("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),t}var Vd,b0,Hx=function(){if(b0)return Vd;b0=1,Vd=t;var l=3;function t(o,u,m){var h=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var g=new Int32Array(this.arrayBuffer);o=g[0],this.d=(u=g[1])+2*(m=g[2]);for(var b=0;b<this.d*this.d;b++){var E=g[l+b],A=g[l+b+1];h.push(E===A?null:g.subarray(E,A))}var v=g[l+h.length+1];this.keys=g.subarray(g[l+h.length],v),this.bboxes=g.subarray(v),this.insert=this._insertReadonly}else{this.d=u+2*m;for(var C=0;C<this.d*this.d;C++)h.push([]);this.keys=[],this.bboxes=[]}this.n=u,this.extent=o,this.padding=m,this.scale=u/o,this.uid=0;var I=m/u*o;this.min=-I,this.max=o+I}return t.prototype.insert=function(o,u,m,h,g){this._forEachCell(u,m,h,g,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(h),this.bboxes.push(g)},t.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},t.prototype._insertCell=function(o,u,m,h,g,b){this.cells[g].push(b)},t.prototype.query=function(o,u,m,h,g){var b=this.min,E=this.max;if(o<=b&&u<=b&&E<=m&&E<=h&&!g)return Array.prototype.slice.call(this.keys);var A=[];return this._forEachCell(o,u,m,h,this._queryCell,A,{},g),A},t.prototype._queryCell=function(o,u,m,h,g,b,E,A){var v=this.cells[g];if(v!==null)for(var C=this.keys,I=this.bboxes,S=0;S<v.length;S++){var M=v[S];if(E[M]===void 0){var R=4*M;(A?A(I[R+0],I[R+1],I[R+2],I[R+3]):o<=I[R+2]&&u<=I[R+3]&&m>=I[R+0]&&h>=I[R+1])?(E[M]=!0,b.push(C[M])):E[M]=!1}}},t.prototype._forEachCell=function(o,u,m,h,g,b,E,A){for(var v=this._convertToCellCoord(o),C=this._convertToCellCoord(u),I=this._convertToCellCoord(m),S=this._convertToCellCoord(h),M=v;M<=I;M++)for(var R=C;R<=S;R++){var O=this.d*R+M;if((!A||A(this._convertFromCellCoord(M),this._convertFromCellCoord(R),this._convertFromCellCoord(M+1),this._convertFromCellCoord(R+1)))&&g.call(this,o,u,m,h,O,b,E,A))return}},t.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},t.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},t.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,u=l+this.cells.length+1+1,m=0,h=0;h<this.cells.length;h++)m+=this.cells[h].length;var g=new Int32Array(u+m+this.keys.length+this.bboxes.length);g[0]=this.extent,g[1]=this.n,g[2]=this.padding;for(var b=u,E=0;E<o.length;E++){var A=o[E];g[l+E]=b,g.set(A,b),b+=A.length}return g[l+o.length]=b,g.set(this.keys,b),g[l+o.length+1]=b+=this.keys.length,g.set(this.bboxes,b),b+=this.bboxes.length,g.buffer},Vd}(),rc=L(Hx);const hh={};function Yt(l,t,o={}){Object.defineProperty(l,"_classRegistryKey",{value:t,writable:!1}),hh[t]={klass:l,omit:o.omit||[]}}Yt(Object,"Object"),rc.serialize=function(l,t){const o=l.toArrayBuffer();return t&&t.add(o),{buffer:o}},rc.deserialize=function(l){return new rc(l.buffer)},Object.defineProperty(rc,"name",{value:"Grid"}),Yt(rc,"Grid"),typeof DOMMatrix<"u"&&Yt(DOMMatrix,"DOMMatrix"),Yt(Rr,"Color"),Yt(Error,"Error"),Yt(ho,"Formatted"),Yt(Xu,"FormattedSection"),Yt(Zn,"AJAXError"),Yt(Li,"ResolvedImage"),Yt(jd,"StylePropertyFunction"),Yt(Fd,"StyleExpression",{omit:["_evaluator"]}),Yt(Xl,"ImageIdWithOptions"),Yt(Uc,"ZoomDependentExpression"),Yt(Nd,"ZoomConstantExpression"),Yt(Xo,"CompoundExpression",{omit:["_evaluate"]});for(const l in $c)hh[$c[l]._classRegistryKey]||Yt($c[l],`Expression${l}`);function w0(l){return l&&typeof ArrayBuffer<"u"&&(l instanceof ArrayBuffer||l.constructor&&l.constructor.name==="ArrayBuffer")}function nc(l){return self.ImageBitmap&&l instanceof ImageBitmap}function ic(l,t){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp)return l;if(w0(l)||nc(l))return t&&t.add(l),l;if(ArrayBuffer.isView(l))return t&&t.add(l.buffer),l;if(l instanceof ImageData)return t&&t.add(l.data.buffer),l;if(Array.isArray(l)){const o=[];for(const u of l)o.push(ic(u,t));return o}if(l instanceof Map){const o={$name:"Map"};for(const[u,m]of l.entries())o[u]=ic(m);return o}if(l instanceof Set){const o={$name:"Set"};let u=0;for(const m of l.values())o[++u]=ic(m);return o}if(typeof l=="object"){const o=l.constructor,u=o._classRegistryKey;if(!u)throw new Error(`Can't serialize object of unregistered class "${u}".`);const m=o.serialize?o.serialize(l,t):{};if(!o.serialize){for(const h in l)l.hasOwnProperty(h)&&(hh[u].omit.indexOf(h)>=0||(m[h]=ic(l[h],t)));l instanceof Error&&(m.message=l.message)}if(m.$name)throw new Error("$name property is reserved for worker serialization logic.");return u!=="Object"&&(m.$name=u),m}throw new Error("can't serialize object of type "+typeof l)}function oc(l){if(l==null||typeof l=="boolean"||typeof l=="number"||typeof l=="string"||l instanceof Boolean||l instanceof Number||l instanceof String||l instanceof Date||l instanceof RegExp||w0(l)||nc(l)||ArrayBuffer.isView(l)||l instanceof ImageData)return l;if(Array.isArray(l))return l.map(oc);if(typeof l=="object"){const t=l.$name||"Object";if(t==="Map"){const m=new Map;for(const h of Object.keys(l))h!=="$name"&&m.set(h,oc(l[h]));return m}if(t==="Set"){const m=new Set;for(const h of Object.keys(l))h!=="$name"&&m.add(oc(l[h]));return m}const{klass:o}=hh[t];if(!o)throw new Error(`Can't deserialize unregistered class "${t}".`);if(o.deserialize)return o.deserialize(l);const u=Object.create(o.prototype);for(const m of Object.keys(l))m!=="$name"&&(u[m]=oc(l[m]));return u}throw new Error("can't deserialize object of type "+typeof l)}const nr={"Latin-1 Supplement":l=>l>=128&&l<=255,Arabic:l=>l>=1536&&l<=1791,"Arabic Supplement":l=>l>=1872&&l<=1919,"Arabic Extended-A":l=>l>=2208&&l<=2303,"Hangul Jamo":l=>l>=4352&&l<=4607,"Unified Canadian Aboriginal Syllabics":l=>l>=5120&&l<=5759,Khmer:l=>l>=6016&&l<=6143,"Unified Canadian Aboriginal Syllabics Extended":l=>l>=6320&&l<=6399,"General Punctuation":l=>l>=8192&&l<=8303,"Letterlike Symbols":l=>l>=8448&&l<=8527,"Number Forms":l=>l>=8528&&l<=8591,"Miscellaneous Technical":l=>l>=8960&&l<=9215,"Control Pictures":l=>l>=9216&&l<=9279,"Optical Character Recognition":l=>l>=9280&&l<=9311,"Enclosed Alphanumerics":l=>l>=9312&&l<=9471,"Geometric Shapes":l=>l>=9632&&l<=9727,"Miscellaneous Symbols":l=>l>=9728&&l<=9983,"Miscellaneous Symbols and Arrows":l=>l>=11008&&l<=11263,"CJK Radicals Supplement":l=>l>=11904&&l<=12031,"Kangxi Radicals":l=>l>=12032&&l<=12255,"Ideographic Description Characters":l=>l>=12272&&l<=12287,"CJK Symbols and Punctuation":l=>l>=12288&&l<=12351,Hiragana:l=>l>=12352&&l<=12447,Katakana:l=>l>=12448&&l<=12543,Bopomofo:l=>l>=12544&&l<=12591,"Hangul Compatibility Jamo":l=>l>=12592&&l<=12687,Kanbun:l=>l>=12688&&l<=12703,"Bopomofo Extended":l=>l>=12704&&l<=12735,"CJK Strokes":l=>l>=12736&&l<=12783,"Katakana Phonetic Extensions":l=>l>=12784&&l<=12799,"Enclosed CJK Letters and Months":l=>l>=12800&&l<=13055,"CJK Compatibility":l=>l>=13056&&l<=13311,"CJK Unified Ideographs Extension A":l=>l>=13312&&l<=19903,"Yijing Hexagram Symbols":l=>l>=19904&&l<=19967,"CJK Unified Ideographs":l=>l>=19968&&l<=40959,"Yi Syllables":l=>l>=40960&&l<=42127,"Yi Radicals":l=>l>=42128&&l<=42191,"Hangul Jamo Extended-A":l=>l>=43360&&l<=43391,"Hangul Syllables":l=>l>=44032&&l<=55215,"Hangul Jamo Extended-B":l=>l>=55216&&l<=55295,"Private Use Area":l=>l>=57344&&l<=63743,"CJK Compatibility Ideographs":l=>l>=63744&&l<=64255,"Arabic Presentation Forms-A":l=>l>=64336&&l<=65023,"Vertical Forms":l=>l>=65040&&l<=65055,"CJK Compatibility Forms":l=>l>=65072&&l<=65103,"Small Form Variants":l=>l>=65104&&l<=65135,"Arabic Presentation Forms-B":l=>l>=65136&&l<=65279,"Halfwidth and Fullwidth Forms":l=>l>=65280&&l<=65519,Osage:l=>l>=66736&&l<=66815,"CJK Unified Ideographs Extension B":l=>l>=131072&&l<=173791};function Ud(l){for(const t of l)if(Gd(t.charCodeAt(0)))return!0;return!1}function S0(l){for(const t of l)if(!E0(t.charCodeAt(0)))return!1;return!0}function E0(l){return!(nr.Arabic(l)||nr["Arabic Supplement"](l)||nr["Arabic Extended-A"](l)||nr["Arabic Presentation Forms-A"](l)||nr["Arabic Presentation Forms-B"](l))}function Gd(l){return!(l!==746&&l!==747&&(l<4352||!(nr["Bopomofo Extended"](l)||nr.Bopomofo(l)||nr["CJK Compatibility Forms"](l)&&!(l>=65097&&l<=65103)||nr["CJK Compatibility Ideographs"](l)||nr["CJK Compatibility"](l)||nr["CJK Radicals Supplement"](l)||nr["CJK Strokes"](l)||!(!nr["CJK Symbols and Punctuation"](l)||l>=12296&&l<=12305||l>=12308&&l<=12319||l===12336)||nr["CJK Unified Ideographs Extension A"](l)||nr["CJK Unified Ideographs"](l)||nr["Enclosed CJK Letters and Months"](l)||nr["Hangul Compatibility Jamo"](l)||nr["Hangul Jamo Extended-A"](l)||nr["Hangul Jamo Extended-B"](l)||nr["Hangul Jamo"](l)||nr["Hangul Syllables"](l)||nr.Hiragana(l)||nr["Ideographic Description Characters"](l)||nr.Kanbun(l)||nr["Kangxi Radicals"](l)||nr["Katakana Phonetic Extensions"](l)||nr.Katakana(l)&&l!==12540||!(!nr["Halfwidth and Fullwidth Forms"](l)||l===65288||l===65289||l===65293||l>=65306&&l<=65310||l===65339||l===65341||l===65343||l>=65371&&l<=65503||l===65507||l>=65512&&l<=65519)||!(!nr["Small Form Variants"](l)||l>=65112&&l<=65118||l>=65123&&l<=65126)||nr["Unified Canadian Aboriginal Syllabics"](l)||nr["Unified Canadian Aboriginal Syllabics Extended"](l)||nr["Vertical Forms"](l)||nr["Yijing Hexagram Symbols"](l)||nr["Yi Syllables"](l)||nr["Yi Radicals"](l))))}function Hd(l){return!(Gd(l)||function(t){return!!(nr["Latin-1 Supplement"](t)&&(t===167||t===169||t===174||t===177||t===188||t===189||t===190||t===215||t===247)||nr["General Punctuation"](t)&&(t===8214||t===8224||t===8225||t===8240||t===8241||t===8251||t===8252||t===8258||t===8263||t===8264||t===8265||t===8273)||nr["Letterlike Symbols"](t)||nr["Number Forms"](t)||nr["Miscellaneous Technical"](t)&&(t>=8960&&t<=8967||t>=8972&&t<=8991||t>=8996&&t<=9e3||t===9003||t>=9085&&t<=9114||t>=9150&&t<=9165||t===9167||t>=9169&&t<=9179||t>=9186&&t<=9215)||nr["Control Pictures"](t)&&t!==9251||nr["Optical Character Recognition"](t)||nr["Enclosed Alphanumerics"](t)||nr["Geometric Shapes"](t)||nr["Miscellaneous Symbols"](t)&&!(t>=9754&&t<=9759)||nr["Miscellaneous Symbols and Arrows"](t)&&(t>=11026&&t<=11055||t>=11088&&t<=11097||t>=11192&&t<=11243)||nr["CJK Symbols and Punctuation"](t)||nr.Katakana(t)||nr["Private Use Area"](t)||nr["CJK Compatibility Forms"](t)||nr["Small Form Variants"](t)||nr["Halfwidth and Fullwidth Forms"](t)||t===8734||t===8756||t===8757||t>=9984&&t<=10087||t>=10102&&t<=10131||t===65532||t===65533)}(l))}function Wd(l){return l>=1424&&l<=2303||nr["Arabic Presentation Forms-A"](l)||nr["Arabic Presentation Forms-B"](l)}function T0(l,t){return!(!t&&Wd(l)||l>=2304&&l<=3583||l>=3840&&l<=4255||nr.Khmer(l))}function Wx(l){for(const t of l)if(Wd(t.charCodeAt(0)))return!0;return!1}const cs="deferred",lm="loading",cm="loaded";let qd=null,Jo="unavailable",Fa=null;const um=function(l){l&&typeof l=="string"&&l.indexOf("NetworkError")>-1&&(Jo="error"),qd&&qd(l)};function Gc(){Zd.fire(new la("pluginStateChange",{pluginStatus:Jo,pluginURL:Fa}))}const Zd=new lo,hm=function(){return Jo},C0=function(){if(Jo!==cs||!Fa)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Jo=lm,Gc(),Fa&&zi({url:Fa},l=>{l?um(l):(Jo=cm,Gc())})},Qo={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Jo===cm||Qo.applyArabicShaping!=null,isLoading:()=>Jo===lm,setState(l){Jo=l.pluginStatus,Fa=l.pluginURL},isParsed:()=>Qo.applyArabicShaping!=null&&Qo.processBidirectionalText!=null&&Qo.processStyledBidirectionalText!=null,getPluginURL:()=>Fa};class Vn{constructor(t,o){this.zoom=t,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch,this.brightness=o.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(t){return function(o,u){for(const m of o)if(!T0(m.charCodeAt(0),u))return!1;return!0}(t,Qo.isLoaded())}}class dh{constructor(t,o,u,m){this.property=t,this.value=o,this.expression=function(h,g,b,E){if(Od(h))return new jd(h,g);if(Bd(h)||Array.isArray(h)&&h.length>0){const A=x0(h,g,b,E);if(A.result==="error")throw new Error(A.value.map(v=>`${v.key}: ${v.message}`).join(", "));return A.value}{let A=h;return typeof h=="string"&&g.type==="color"&&(A=Rr.parse(h)),{kind:"constant",configDependencies:new Set,evaluate:()=>A}}}(o===void 0?t.specification.default:o,t.specification,u,m)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(t,o,u){return this.property.possiblyEvaluate(this,t,o,u)}}class Hc{constructor(t,o,u){this.property=t,this.value=new dh(t,void 0,o,u)}transitioned(t,o){return new M0(this.property,this.value,o,dn({},t.transition,this.transition),t.now)}untransitioned(){return new M0(this.property,this.value,null,{},0)}}class ac{constructor(t,o,u){this._properties=t,this._values=Object.create(t.defaultTransitionablePropertyValues),this._scope=o,this._options=u,this.configDependencies=new Set}getValue(t){return _i(this._values[t].value.value)}setValue(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new Hc(this._values[t].property,this._scope,this._options)),this._values[t].value=new dh(this._values[t].property,o===null?void 0:_i(o),this._scope,this._options),this._values[t].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[t].value.expression.configDependencies]))}setTransitionOrValue(t,o){o&&(this._options=o);const u=this._properties.properties;if(t)for(const m in t){const h=t[m];if(En(m,"-transition")){const g=m.slice(0,-11);u[g]&&this.setTransition(g,h)}else u.hasOwnProperty(m)&&this.setValue(m,h)}}getTransition(t){return _i(this._values[t].transition)}setTransition(t,o){this._values.hasOwnProperty(t)||(this._values[t]=new Hc(this._values[t].property)),this._values[t].transition=_i(o)||void 0}serialize(){const t={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(t[o]=u);const m=this.getTransition(o);m!==void 0&&(t[`${o}-transition`]=m)}return t}transitioned(t,o){const u=new I0(this._properties);for(const m of Object.keys(this._values))u._values[m]=this._values[m].transitioned(t,o._values[m]);return u}untransitioned(){const t=new I0(this._properties);for(const o of Object.keys(this._values))t._values[o]=this._values[o].untransitioned();return t}}class M0{constructor(t,o,u,m,h){const g=m.delay||0,b=m.duration||0;h=h||0,this.property=t,this.value=o,this.begin=h+g,this.end=this.begin+b,t.specification.transition&&(m.delay||m.duration)&&(this.prior=u)}possiblyEvaluate(t,o,u){const m=t.now||0,h=this.value.possiblyEvaluate(t,o,u),g=this.prior;if(g){if(m>this.end)return this.prior=null,h;if(this.value.isDataDriven())return this.prior=null,h;if(m<this.begin)return g.possiblyEvaluate(t,o,u);{const b=(m-this.begin)/(this.end-this.begin);return this.property.interpolate(g.possiblyEvaluate(t,o,u),h,Xr(b))}}return h}}class I0{constructor(t){this._properties=t,this._values=Object.create(t.defaultTransitioningPropertyValues)}possiblyEvaluate(t,o,u){const m=new qc(this._properties);for(const h of Object.keys(this._values))m._values[h]=this._values[h].possiblyEvaluate(t,o,u);return m}hasTransition(){for(const t of Object.keys(this._values))if(this._values[t].prior)return!0;return!1}}class qx{constructor(t,o,u){this._properties=t,this._values=Object.create(t.defaultPropertyValues),this._scope=o,this._options=u,this.configDependencies=new Set}getValue(t){return _i(this._values[t].value)}setValue(t,o){this._values[t]=new dh(this._values[t].property,o===null?void 0:_i(o),this._scope,this._options),this._values[t].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[t].expression.configDependencies]))}serialize(){const t={};for(const o of Object.keys(this._values)){const u=this.getValue(o);u!==void 0&&(t[o]=u)}return t}possiblyEvaluate(t,o,u){const m=new qc(this._properties);for(const h of Object.keys(this._values))m._values[h]=this._values[h].possiblyEvaluate(t,o,u);return m}}class Wc{constructor(t,o,u){this.property=t,this.value=o,this.parameters=u}isConstant(){return this.value.kind==="constant"}constantOr(t){return this.value.kind==="constant"?this.value.value:t}evaluate(t,o,u,m){return this.property.evaluate(this.value,this.parameters,t,o,u,m)}}class qc{constructor(t){this._properties=t,this._values=Object.create(t.defaultPossiblyEvaluatedValues)}get(t){return this._values[t]}}class zt{constructor(t){this.specification=t}possiblyEvaluate(t,o){return t.expression.evaluate(o)}interpolate(t,o,u){const m=Hr[this.specification.type];return m?m(t,o,u):t}}class Ht{constructor(t,o){this.specification=t,this.overrides=o}possiblyEvaluate(t,o,u,m){return new Wc(this,t.expression.kind==="constant"||t.expression.kind==="camera"?{kind:"constant",value:t.expression.evaluate(o,null,{},u,m)}:t.expression,o)}interpolate(t,o,u){if(t.value.kind!=="constant"||o.value.kind!=="constant")return t;if(t.value.value===void 0||o.value.value===void 0)return new Wc(this,{kind:"constant",value:void 0},t.parameters);const m=Hr[this.specification.type];return m?new Wc(this,{kind:"constant",value:m(t.value.value,o.value.value,u)},t.parameters):t}evaluate(t,o,u,m,h,g){return t.kind==="constant"?t.value:t.evaluate(o,u,m,h,g)}}class Zc{constructor(t){this.specification=t}possiblyEvaluate(t,o,u,m){return!!t.expression.evaluate(o,null,{},u,m)}interpolate(){return!1}}class ti{constructor(t){this.properties=t,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new Vn(0,{});for(const u in t){const m=t[u];m.specification.overridable&&this.overridableProperties.push(u);const h=this.defaultPropertyValues[u]=new dh(m,void 0),g=this.defaultTransitionablePropertyValues[u]=new Hc(m);this.defaultTransitioningPropertyValues[u]=g.untransitioned(),this.defaultPossiblyEvaluatedValues[u]=h.possiblyEvaluate(o)}}}Yt(Ht,"DataDrivenProperty"),Yt(zt,"DataConstantProperty"),Yt(Zc,"ColorRampProperty");var nt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow","experimental":true},"rain":{"type":"rain","experimental":true},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor","experimental":true},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"experimental":true,"type":"featuresets"}},"featuresets":{"experimental":true,"*":{"type":"featureset"}},"featureset":{"experimental":true,"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"experimental":true,"layer":{"type":"string","required":true},"properties":{"type":"selectorProperty","required":false},"featureNamespace":{"type":"string","required":false}},"selectorProperty":{"experimental":true,"*":{"type":"*"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","property-type":"data-constant","expression":{},"required":true},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"property-type":"data-constant"},"shadow-quality":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]},"experimental":true},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"experimental":true,"type":{"required":true,"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":1}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":1}},"url":{"required":false,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"raster-particle":{"experimental":true},"hillshade":{},"model":{"experimental":true},"background":{},"sky":{},"slot":{},"clip":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{},"property-type":"data-constant"},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{},"property-type":"data-constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","experimental":true,"private":true,"expression":{},"property-type":"data-constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","experimental":true,"default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","experimental":true,"expression":{},"property-type":"data-constant"},"line-cross-slope":{"type":"number","experimental":true,"expression":{},"property-type":"constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","experimental":true,"private":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","experimental":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"experimental":true,"private":true,"expression":{},"property-type":"data-constant"},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":"#ffffff","experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.4,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","property-type":"data-constant","default":0.71,"minimum":0,"maximum":5,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"opacity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"center-thinning":{"type":"number","property-type":"data-constant","default":0.57,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","property-type":"data-constant","transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","property-type":"data-constant","default":0.7,"minimum":0,"maximum":1,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"colorTheme":{"data":{"type":"string","property-type":"data-constant","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}},"buildingFeaturesetId":{"type":"string","experimental":true,"property-type":"data-constant","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"property-type":"data-constant","expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"flat","property-type":"data-constant"},"fill-extrusion-base-alignment":{"type":"enum","experimental":true,"values":{"terrain":1,"flat":1},"default":"terrain","property-type":"data-constant"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","experimental":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","experimental":true,"default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","experimental":true,"default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","experimental":true,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","experimental":true,"default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","experimental":true,"default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"experimental":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"property-type":"constant"},"line-trim-fade-range":{"type":"array","value":"number","experimental":true,"length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-trim-color":{"type":"color","experimental":true,"default":"transparent","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"property-type":"data-constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"raster-array-band":{"type":"string","required":false,"experimental":true,"property-type":"data-constant"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"experimental":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string","required":false,"property-type":"data-constant"},"raster-particle-count":{"type":"number","default":512,"minimum":1,"property-type":"data-constant"},"raster-particle-color":{"type":"color","expression":{"interpolated":true,"parameters":["raster-particle-speed"]},"property-type":"color-ramp"},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1,"property-type":"data-constant"},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1,"property-type":"data-constant"},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]},"experimental":true,"property-type":"data-constant"},"background-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{},"property-type":"data-constant"},"model-front-cutoff":{"type":"array","private":true,"value":"number","property-type":"data-constant","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function P0(l){return l instanceof Number||l instanceof String||l instanceof Boolean?l.valueOf():l}function Xd(l){if(Array.isArray(l))return l.map(Xd);if(l instanceof Object&&!(l instanceof Number||l instanceof String||l instanceof Boolean)){const t={};for(const o in l)t[o]=Xd(l[o]);return t}return P0(l)}function dm(l){if(l===!0||l===!1)return!0;if(!Array.isArray(l)||l.length===0)return!1;switch(l[0]){case"has":return l.length>=2&&l[1]!=="$id"&&l[1]!=="$type";case"in":return l.length>=3&&(typeof l[1]!="string"||Array.isArray(l[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return l.length!==3||Array.isArray(l[1])||Array.isArray(l[2]);case"any":case"all":for(const t of l.slice(1))if(!dm(t)&&typeof t!="boolean")return!1;return!0;default:return!0}}function A0(l,t="",o=null,u="fill"){if(l==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};dm(l)||(l=fh(l));const m=l;let h=!0;try{h=function(v){if(!Xc(v))return v;let C=Xd(v);return z0(C),C=R0(C),C}(m)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(m,null,2)}
        `)}let g=null,b=null;if(u!=="background"&&u!=="sky"&&u!=="slot"){b=nt[`filter_${u}`];const v=uh(h,b,t,o);if(v.result==="error")throw new Error(v.value.map(C=>`${C.key}: ${C.message}`).join(", "));g=(C,I,S)=>v.value.evaluate(C,I,{},S)}let E=null,A=null;if(h!==m){const v=uh(m,b,t,o);if(v.result==="error")throw new Error(v.value.map(C=>`${C.key}: ${C.message}`).join(", "));E=(C,I,S,M,R)=>v.value.evaluate(C,I,{},S,void 0,void 0,M,R),A=!Bc(v.value.expression)}return{filter:g,dynamicFilter:E||void 0,needGeometry:fm(h),needFeature:!!A}}function R0(l){if(!Array.isArray(l))return l;const t=function(o){if(Zx.has(o[0])){for(let u=1;u<o.length;u++)if(Xc(o[u]))return!0}return o}(l);return t===!0?t:t.map(o=>R0(o))}function z0(l){let t=!1;const o=[];if(l[0]==="case"){for(let u=1;u<l.length-1;u+=2)t=t||Xc(l[u]),o.push(l[u+1]);o.push(l[l.length-1])}else if(l[0]==="match"){t=t||Xc(l[1]);for(let u=2;u<l.length-1;u+=2)o.push(l[u+1]);o.push(l[l.length-1])}else if(l[0]==="step"){t=t||Xc(l[1]);for(let u=1;u<l.length-1;u+=2)o.push(l[u+1])}t&&(l.length=0,l.push("any",...o));for(let u=1;u<l.length;u++)z0(l[u])}function Xc(l){if(!Array.isArray(l))return!1;if((t=l[0])==="pitch"||t==="distance-from-center")return!0;var t;for(let o=1;o<l.length;o++)if(Xc(l[o]))return!0;return!1}const Zx=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Yc(l,t){return l<t?-1:l>t?1:0}function fm(l){if(!Array.isArray(l))return!1;if(l[0]==="within"||l[0]==="distance")return!0;for(let t=1;t<l.length;t++)if(fm(l[t]))return!0;return!1}function fh(l){if(!l)return!0;const t=l[0];return l.length<=1?t!=="any":t==="=="?Kc(l[1],l[2],"=="):t==="!="?Ba(Kc(l[1],l[2],"==")):t==="<"||t===">"||t==="<="||t===">="?Kc(l[1],l[2],t):t==="any"?(o=l.slice(1),["any"].concat(o.map(fh))):t==="all"?["all"].concat(l.slice(1).map(fh)):t==="none"?["all"].concat(l.slice(1).map(fh).map(Ba)):t==="in"?L0(l[1],l.slice(2)):t==="!in"?Ba(L0(l[1],l.slice(2))):t==="has"?k0(l[1]):t!=="!has"||Ba(k0(l[1]));var o}function Kc(l,t,o){switch(l){case"$type":return[`filter-type-${o}`,t];case"$id":return[`filter-id-${o}`,t];default:return[`filter-${o}`,l,t]}}function L0(l,t){if(t.length===0)return!1;switch(l){case"$type":return["filter-type-in",["literal",t]];case"$id":return["filter-id-in",["literal",t]];default:return t.length>200&&!t.some(o=>typeof o!=typeof t[0])?["filter-in-large",l,["literal",t.sort(Yc)]]:["filter-in-small",l,["literal",t]]}}function k0(l){switch(l){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",l]}}function Ba(l){return["!",l]}const ph="";function Fo(l,t){return t?`${l}${ph}${t}`:l}const D0="-transition",Xx=new Set(["fill","line","background","hillshade","raster"]);class Bo extends lo{constructor(t,o,u,m,h){if(super(),this.id=t.id,this.fqid=Fo(this.id,u),this.type=t.type,this.scope=u,this.lut=m,this.options=h,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,t.type!=="custom"){if(this.metadata=t.metadata,this.minzoom=t.minzoom,this.maxzoom=t.maxzoom,t.type&&t.type!=="background"&&t.type!=="sky"&&t.type!=="slot"){this.source=t.source,this.sourceLayer=t["source-layer"],this.filter=t.filter;const g=uh(this.filter,nt[`filter_${t.type}`]);g.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...g.value.configDependencies]))}if(t.slot&&(this.slot=t.slot),o.layout&&(this._unevaluatedLayout=new qx(o.layout,this.scope,h),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),o.paint){this._transitionablePaint=new ac(o.paint,this.scope,h);for(const g in t.paint)this.setPaintProperty(g,t.paint[g]);for(const g in t.layout)this.setLayoutProperty(g,t.layout[g]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new qc(o.paint)}}}onAdd(t){}onRemove(t){}isDraped(t){return!this.is3D()&&Xx.has(this.type)}getLayoutProperty(t){return t==="visibility"?this.visibility:this._unevaluatedLayout.getValue(t)}setLayoutProperty(t,o){if(this.type==="custom"&&t==="visibility")return void(this.visibility=o);const u=this._unevaluatedLayout;u._properties.properties[t]&&(u.setValue(t,o),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),t==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(t){return En(t,D0)?this._transitionablePaint.getTransition(t.slice(0,-11)):this._transitionablePaint.getValue(t)}setPaintProperty(t,o){const u=this._transitionablePaint,m=u._properties.properties;if(En(t,D0)){const C=t.slice(0,-11);return m[C]&&u.setTransition(C,o||void 0),!1}if(!m[t])return!1;const h=u._values[t],g=h.value.isDataDriven(),b=h.value;u.setValue(t,o),this.configDependencies=new Set([...this.configDependencies,...u.configDependencies]),this._handleSpecialPaintPropertyUpdate(t);const E=u._values[t].value,A=E.isDataDriven(),v=En(t,"pattern")||t==="line-dasharray";return A||g||v||this._handleOverridablePaintPropertyUpdate(t,b,E)}_handleSpecialPaintPropertyUpdate(t){}getProgramIds(){return null}getDefaultProgramParams(t,o,u){return null}_handleOverridablePaintPropertyUpdate(t,o,u){return!1}isHidden(t){return!!(this.minzoom&&t<this.minzoom)||!!(this.maxzoom&&t>=this.maxzoom)||this.visibility==="none"}updateTransitions(t){this._transitioningPaint=this._transitionablePaint.transitioned(t,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(t,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(t,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(t,void 0,o)}serialize(){return zo({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(t,o)=>!(t===void 0||o==="layout"&&!Object.keys(t).length||o==="paint"&&!Object.keys(t).length))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const t in this.paint._values){const o=this.paint.get(t);if(o instanceof Wc&&Vc(o.property.specification)&&(o.value.kind==="source"||o.value.kind==="composite")&&o.value.isStateDependent)return!0}return!1}compileFilter(t){this._filterCompiled||(this._featureFilter=A0(this.filter,this.scope,t),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(t){this._stats&&(t.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(t){}queryIntersectsFeature(t,o,u,m,h,g,b,E,A){}}const Yx={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class mh{constructor(t,o){this._structArray=t,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Dn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(t,o){return t._trim(),o&&(t.isTransferred=!0,o.add(t.arrayBuffer)),{length:t.length,arrayBuffer:t.arrayBuffer}}static deserialize(t){const o=Object.create(this.prototype);return o.arrayBuffer=t.arrayBuffer,o.length=t.length,o.capacity=t.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(t){this.reserve(t),this.length=t}reserve(t){if(t>this.capacity){this.capacity=Math.max(t,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...t){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...t){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function on(l,t=1){let o=0,u=0;return{members:l.map(m=>{const h=Yx[m.type].BYTES_PER_ELEMENT,g=o=gh(o,Math.max(t,h)),b=m.components||1;return u=Math.max(u,h),o+=h*b,{name:m.name,type:m.type,components:b,offset:g}}),size:gh(o,Math.max(u,t)),alignment:t}}function gh(l,t){return Math.ceil(l/t)*t}class $s extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o){const u=this.length;return this.resize(u+1),this.emplace(u,t,o)}emplace(t,o,u){const m=2*t;return this.int16[m+0]=o,this.int16[m+1]=u,t}}$s.prototype.bytesPerElement=4,Yt($s,"StructArrayLayout2i4");class Jc extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,u)}emplace(t,o,u,m){const h=3*t;return this.int16[h+0]=o,this.int16[h+1]=u,this.int16[h+2]=m,t}}Jc.prototype.bytesPerElement=6,Yt(Jc,"StructArrayLayout3i6");class Qc extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,t,o,u,m)}emplace(t,o,u,m,h){const g=4*t;return this.int16[g+0]=o,this.int16[g+1]=u,this.int16[g+2]=m,this.int16[g+3]=h,t}}Qc.prototype.bytesPerElement=8,Yt(Qc,"StructArrayLayout4i8");class Sa extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,u,m,h)}emplace(t,o,u,m,h,g){const b=5*t;return this.int16[b+0]=o,this.int16[b+1]=u,this.int16[b+2]=m,this.int16[b+3]=h,this.int16[b+4]=g,t}}Sa.prototype.bytesPerElement=10,Yt(Sa,"StructArrayLayout5i10");class pm extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h,g,b){const E=this.length;return this.resize(E+1),this.emplace(E,t,o,u,m,h,g,b)}emplace(t,o,u,m,h,g,b,E){const A=6*t,v=12*t,C=3*t;return this.int16[A+0]=o,this.int16[A+1]=u,this.uint8[v+4]=m,this.uint8[v+5]=h,this.uint8[v+6]=g,this.uint8[v+7]=b,this.float32[C+2]=E,t}}pm.prototype.bytesPerElement=12,Yt(pm,"StructArrayLayout2i4ub1f12");class Vs extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,t,o,u,m)}emplace(t,o,u,m,h){const g=4*t;return this.float32[g+0]=o,this.float32[g+1]=u,this.float32[g+2]=m,this.float32[g+3]=h,t}}Vs.prototype.bytesPerElement=16,Yt(Vs,"StructArrayLayout4f16");class Sl extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,u)}emplace(t,o,u,m){const h=3*t;return this.float32[h+0]=o,this.float32[h+1]=u,this.float32[h+2]=m,t}}Sl.prototype.bytesPerElement=12,Yt(Sl,"StructArrayLayout3f12");class El extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,u,m,h)}emplace(t,o,u,m,h,g){const b=6*t,E=3*t;return this.uint16[b+0]=o,this.uint16[b+1]=u,this.uint16[b+2]=m,this.uint16[b+3]=h,this.float32[E+2]=g,t}}El.prototype.bytesPerElement=12,Yt(El,"StructArrayLayout4ui1f12");class Yd extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,t,o,u,m)}emplace(t,o,u,m,h){const g=4*t;return this.uint16[g+0]=o,this.uint16[g+1]=u,this.uint16[g+2]=m,this.uint16[g+3]=h,t}}Yd.prototype.bytesPerElement=8,Yt(Yd,"StructArrayLayout4ui8");class Kd extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,u,m,h,g)}emplace(t,o,u,m,h,g,b){const E=6*t;return this.int16[E+0]=o,this.int16[E+1]=u,this.int16[E+2]=m,this.int16[E+3]=h,this.int16[E+4]=g,this.int16[E+5]=b,t}}Kd.prototype.bytesPerElement=12,Yt(Kd,"StructArrayLayout6i12");class mm extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h,g,b,E,A,v,C,I){const S=this.length;return this.resize(S+1),this.emplace(S,t,o,u,m,h,g,b,E,A,v,C,I)}emplace(t,o,u,m,h,g,b,E,A,v,C,I,S){const M=12*t;return this.int16[M+0]=o,this.int16[M+1]=u,this.int16[M+2]=m,this.int16[M+3]=h,this.uint16[M+4]=g,this.uint16[M+5]=b,this.uint16[M+6]=E,this.uint16[M+7]=A,this.int16[M+8]=v,this.int16[M+9]=C,this.int16[M+10]=I,this.int16[M+11]=S,t}}mm.prototype.bytesPerElement=24,Yt(mm,"StructArrayLayout4i4ui4i24");class gm extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,u,m,h,g)}emplace(t,o,u,m,h,g,b){const E=10*t,A=5*t;return this.int16[E+0]=o,this.int16[E+1]=u,this.int16[E+2]=m,this.float32[A+2]=h,this.float32[A+3]=g,this.float32[A+4]=b,t}}gm.prototype.bytesPerElement=20,Yt(gm,"StructArrayLayout3i3f20");class _m extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint32[1*t+0]=o,t}}_m.prototype.bytesPerElement=4,Yt(_m,"StructArrayLayout1ul4");class Tl extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o){const u=this.length;return this.resize(u+1),this.emplace(u,t,o)}emplace(t,o,u){const m=2*t;return this.uint16[m+0]=o,this.uint16[m+1]=u,t}}Tl.prototype.bytesPerElement=4,Yt(Tl,"StructArrayLayout2ui4");class ym extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h,g,b,E,A,v,C,I,S){const M=this.length;return this.resize(M+1),this.emplace(M,t,o,u,m,h,g,b,E,A,v,C,I,S)}emplace(t,o,u,m,h,g,b,E,A,v,C,I,S,M){const R=20*t,O=10*t;return this.int16[R+0]=o,this.int16[R+1]=u,this.int16[R+2]=m,this.int16[R+3]=h,this.int16[R+4]=g,this.float32[O+3]=b,this.float32[O+4]=E,this.float32[O+5]=A,this.float32[O+6]=v,this.int16[R+14]=C,this.uint32[O+8]=I,this.uint16[R+18]=S,this.uint16[R+19]=M,t}}ym.prototype.bytesPerElement=40,Yt(ym,"StructArrayLayout5i4f1i1ul2ui40");class _h extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h,g,b){const E=this.length;return this.resize(E+1),this.emplace(E,t,o,u,m,h,g,b)}emplace(t,o,u,m,h,g,b,E){const A=8*t;return this.int16[A+0]=o,this.int16[A+1]=u,this.int16[A+2]=m,this.int16[A+4]=h,this.int16[A+5]=g,this.int16[A+6]=b,this.int16[A+7]=E,t}}_h.prototype.bytesPerElement=16,Yt(_h,"StructArrayLayout3i2i2i16");class vm extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,u,m,h)}emplace(t,o,u,m,h,g){const b=4*t,E=8*t;return this.float32[b+0]=o,this.float32[b+1]=u,this.float32[b+2]=m,this.int16[E+6]=h,this.int16[E+7]=g,t}}vm.prototype.bytesPerElement=16,Yt(vm,"StructArrayLayout2f1f2i16");class xm extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h,g){const b=this.length;return this.resize(b+1),this.emplace(b,t,o,u,m,h,g)}emplace(t,o,u,m,h,g,b){const E=20*t,A=5*t;return this.uint8[E+0]=o,this.uint8[E+1]=u,this.float32[A+1]=m,this.float32[A+2]=h,this.float32[A+3]=g,this.float32[A+4]=b,t}}xm.prototype.bytesPerElement=20,Yt(xm,"StructArrayLayout2ub4f20");class no extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,u){const m=this.length;return this.resize(m+1),this.emplace(m,t,o,u)}emplace(t,o,u,m){const h=3*t;return this.uint16[h+0]=o,this.uint16[h+1]=u,this.uint16[h+2]=m,t}}no.prototype.bytesPerElement=6,Yt(no,"StructArrayLayout3ui6");class Jd extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h,g,b,E,A,v,C,I,S,M,R,O,F,H,W,V,Z){const Y=this.length;return this.resize(Y+1),this.emplace(Y,t,o,u,m,h,g,b,E,A,v,C,I,S,M,R,O,F,H,W,V,Z)}emplace(t,o,u,m,h,g,b,E,A,v,C,I,S,M,R,O,F,H,W,V,Z,Y){const ne=30*t,ye=15*t,_e=60*t;return this.int16[ne+0]=o,this.int16[ne+1]=u,this.int16[ne+2]=m,this.float32[ye+2]=h,this.float32[ye+3]=g,this.uint16[ne+8]=b,this.uint16[ne+9]=E,this.uint32[ye+5]=A,this.uint32[ye+6]=v,this.uint32[ye+7]=C,this.uint16[ne+16]=I,this.uint16[ne+17]=S,this.uint16[ne+18]=M,this.float32[ye+10]=R,this.float32[ye+11]=O,this.uint8[_e+48]=F,this.uint8[_e+49]=H,this.uint8[_e+50]=W,this.uint32[ye+13]=V,this.int16[ne+28]=Z,this.uint8[_e+58]=Y,t}}Jd.prototype.bytesPerElement=60,Yt(Jd,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Qd extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h,g,b,E,A,v,C,I,S,M,R,O,F,H,W,V,Z,Y,ne,ye,_e,ge,Re,we,Le,Be,Oe,Ve){const We=this.length;return this.resize(We+1),this.emplace(We,t,o,u,m,h,g,b,E,A,v,C,I,S,M,R,O,F,H,W,V,Z,Y,ne,ye,_e,ge,Re,we,Le,Be,Oe,Ve)}emplace(t,o,u,m,h,g,b,E,A,v,C,I,S,M,R,O,F,H,W,V,Z,Y,ne,ye,_e,ge,Re,we,Le,Be,Oe,Ve,We){const Qe=20*t,Ge=40*t,ut=80*t;return this.float32[Qe+0]=o,this.float32[Qe+1]=u,this.int16[Ge+4]=m,this.int16[Ge+5]=h,this.int16[Ge+6]=g,this.int16[Ge+7]=b,this.int16[Ge+8]=E,this.int16[Ge+9]=A,this.int16[Ge+10]=v,this.int16[Ge+11]=C,this.int16[Ge+12]=I,this.uint16[Ge+13]=S,this.uint16[Ge+14]=M,this.uint16[Ge+15]=R,this.uint16[Ge+16]=O,this.uint16[Ge+17]=F,this.uint16[Ge+18]=H,this.uint16[Ge+19]=W,this.uint16[Ge+20]=V,this.uint16[Ge+21]=Z,this.uint16[Ge+22]=Y,this.uint16[Ge+23]=ne,this.uint16[Ge+24]=ye,this.uint16[Ge+25]=_e,this.uint16[Ge+26]=ge,this.uint16[Ge+27]=Re,this.uint32[Qe+14]=we,this.float32[Qe+15]=Le,this.float32[Qe+16]=Be,this.float32[Qe+17]=Oe,this.float32[Qe+18]=Ve,this.uint8[ut+76]=We,t}}Qd.prototype.bytesPerElement=80,Yt(Qd,"StructArrayLayout2f9i15ui1ul4f1ub80");class Ea extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.float32[1*t+0]=o,t}}Ea.prototype.bytesPerElement=4,Yt(Ea,"StructArrayLayout1f4");class Cl extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h){const g=this.length;return this.resize(g+1),this.emplace(g,t,o,u,m,h)}emplace(t,o,u,m,h,g){const b=5*t;return this.float32[b+0]=o,this.float32[b+1]=u,this.float32[b+2]=m,this.float32[b+3]=h,this.float32[b+4]=g,t}}Cl.prototype.bytesPerElement=20,Yt(Cl,"StructArrayLayout5f20");class bm extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h,g,b){const E=this.length;return this.resize(E+1),this.emplace(E,t,o,u,m,h,g,b)}emplace(t,o,u,m,h,g,b,E){const A=7*t;return this.float32[A+0]=o,this.float32[A+1]=u,this.float32[A+2]=m,this.float32[A+3]=h,this.float32[A+4]=g,this.float32[A+5]=b,this.float32[A+6]=E,t}}bm.prototype.bytesPerElement=28,Yt(bm,"StructArrayLayout7f28");class wm extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h,g,b,E,A,v,C){const I=this.length;return this.resize(I+1),this.emplace(I,t,o,u,m,h,g,b,E,A,v,C)}emplace(t,o,u,m,h,g,b,E,A,v,C,I){const S=11*t;return this.float32[S+0]=o,this.float32[S+1]=u,this.float32[S+2]=m,this.float32[S+3]=h,this.float32[S+4]=g,this.float32[S+5]=b,this.float32[S+6]=E,this.float32[S+7]=A,this.float32[S+8]=v,this.float32[S+9]=C,this.float32[S+10]=I,t}}wm.prototype.bytesPerElement=44,Yt(wm,"StructArrayLayout11f44");class Sm extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h,g,b,E,A){const v=this.length;return this.resize(v+1),this.emplace(v,t,o,u,m,h,g,b,E,A)}emplace(t,o,u,m,h,g,b,E,A,v){const C=9*t;return this.float32[C+0]=o,this.float32[C+1]=u,this.float32[C+2]=m,this.float32[C+3]=h,this.float32[C+4]=g,this.float32[C+5]=b,this.float32[C+6]=E,this.float32[C+7]=A,this.float32[C+8]=v,t}}Sm.prototype.bytesPerElement=36,Yt(Sm,"StructArrayLayout9f36");class Us extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o){const u=this.length;return this.resize(u+1),this.emplace(u,t,o)}emplace(t,o,u){const m=2*t;return this.float32[m+0]=o,this.float32[m+1]=u,t}}Us.prototype.bytesPerElement=8,Yt(Us,"StructArrayLayout2f8");class ef extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t,o,u,m){const h=this.length;return this.resize(h+1),this.emplace(h,t,o,u,m)}emplace(t,o,u,m,h){const g=6*t;return this.uint32[3*t+0]=o,this.uint16[g+2]=u,this.uint16[g+3]=m,this.uint16[g+4]=h,t}}ef.prototype.bytesPerElement=12,Yt(ef,"StructArrayLayout1ul3ui12");class Em extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint16[1*t+0]=o,t}}Em.prototype.bytesPerElement=2,Yt(Em,"StructArrayLayout1ui2");class tf extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h,g,b,E,A,v,C,I,S,M,R,O){const F=this.length;return this.resize(F+1),this.emplace(F,t,o,u,m,h,g,b,E,A,v,C,I,S,M,R,O)}emplace(t,o,u,m,h,g,b,E,A,v,C,I,S,M,R,O,F){const H=16*t;return this.float32[H+0]=o,this.float32[H+1]=u,this.float32[H+2]=m,this.float32[H+3]=h,this.float32[H+4]=g,this.float32[H+5]=b,this.float32[H+6]=E,this.float32[H+7]=A,this.float32[H+8]=v,this.float32[H+9]=C,this.float32[H+10]=I,this.float32[H+11]=S,this.float32[H+12]=M,this.float32[H+13]=R,this.float32[H+14]=O,this.float32[H+15]=F,t}}tf.prototype.bytesPerElement=64,Yt(tf,"StructArrayLayout16f64");class rf extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(t,o,u,m,h,g,b){const E=this.length;return this.resize(E+1),this.emplace(E,t,o,u,m,h,g,b)}emplace(t,o,u,m,h,g,b,E){const A=10*t,v=5*t;return this.uint16[A+0]=o,this.uint16[A+1]=u,this.uint16[A+2]=m,this.uint16[A+3]=h,this.float32[v+2]=g,this.float32[v+3]=b,this.float32[v+4]=E,t}}rf.prototype.bytesPerElement=20,Yt(rf,"StructArrayLayout4ui3f20");class nf extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.int16[1*t+0]=o,t}}nf.prototype.bytesPerElement=2,Yt(nf,"StructArrayLayout1i2");class eu extends Dn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(t){const o=this.length;return this.resize(o+1),this.emplace(o,t)}emplace(t,o){return this.uint8[1*t+0]=o,t}}eu.prototype.bytesPerElement=1,Yt(eu,"StructArrayLayout1ub1");class O0 extends mh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}O0.prototype.size=40;class F0 extends ym{get(t){return new O0(this,t)}}Yt(F0,"CollisionBoxArray");class B0 extends mh{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(t){this._structArray.uint8[this._pos1+49]=t}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(t){this._structArray.uint8[this._pos1+50]=t}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(t){this._structArray.uint32[this._pos4+13]=t}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(t){this._structArray.uint8[this._pos1+58]=t}}B0.prototype.size=60;class N0 extends Jd{get(t){return new B0(this,t)}}Yt(N0,"PlacedSymbolArray");class j0 extends mh{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(t){this._structArray.uint32[this._pos4+14]=t}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(t){this._structArray.float32[this._pos4+18]=t}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}j0.prototype.size=80;class yh extends Qd{get(t){return new j0(this,t)}}Yt(yh,"SymbolInstanceArray");class vh extends Ea{getoffsetX(t){return this.float32[1*t+0]}}Yt(vh,"GlyphOffsetArray");class ea extends $s{getx(t){return this.int16[2*t+0]}gety(t){return this.int16[2*t+1]}}Yt(ea,"SymbolLineVertexArray");class xh extends mh{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}xh.prototype.size=12;class $0 extends ef{get(t){return new xh(this,t)}}Yt($0,"FeatureIndexArray");class V0 extends Tl{geta_centroid_pos0(t){return this.uint16[2*t+0]}geta_centroid_pos1(t){return this.uint16[2*t+1]}}Yt(V0,"FillExtrusionCentroidArray");class U0 extends mh{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}U0.prototype.size=6;class G0 extends Jc{get(t){return new U0(this,t)}}Yt(G0,"FillExtrusionWallArray");const Tm=on([{name:"a_pos",components:2,type:"Int16"}],4),Kx=on([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class ri{constructor(t=[]){this.segments=t}_prepareSegment(t,o,u,m){let h=this.segments[this.segments.length-1];return t>ri.MAX_VERTEX_ARRAY_LENGTH&&gr(`Max vertices per segment is ${ri.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${t}`),(!h||h.vertexLength+t>ri.MAX_VERTEX_ARRAY_LENGTH||h.sortKey!==m)&&(h={vertexOffset:o,primitiveOffset:u,vertexLength:0,primitiveLength:0},m!==void 0&&(h.sortKey=m),this.segments.push(h)),h}prepareSegment(t,o,u,m){return this._prepareSegment(t,o.length,u.length,m)}get(){return this.segments}destroy(){for(const t of this.segments)for(const o in t.vaos)t.vaos[o].destroy()}static simpleSegment(t,o,u,m){return new ri([{vertexOffset:t,primitiveOffset:o,vertexLength:u,primitiveLength:m,vaos:{},sortKey:0}])}}function H0(l,t){return 256*(l=Jt(Math.floor(l),0,255))+Jt(Math.floor(t),0,255)}ri.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Yt(ri,"SegmentVector");const Jx=on([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Cm=on([{name:"a_dash",components:4,type:"Uint16"}]);class bh{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(t,o,u,m){this.ids.push(Mm(t)),this.positions.push(o,u,m)}eachPosition(t,o){const u=Mm(t);let m=0,h=this.ids.length-1;for(;m<h;){const g=m+h>>1;this.ids[g]>=u?h=g:m=g+1}for(;this.ids[m]===u;)o(this.positions[3*m],this.positions[3*m+1],this.positions[3*m+2]),m++}static serialize(t,o){const u=new Float64Array(t.ids),m=new Uint32Array(t.positions);return of(u,m,0,u.length-1),o&&(o.add(u.buffer),o.add(m.buffer)),{ids:u,positions:m}}static deserialize(t){const o=new bh;let u;o.ids=t.ids,o.positions=t.positions;for(const m of o.ids)m!==u&&o.uniqueIds.push(m),u=m;return o.indexed=!0,o}}function Mm(l){const t=+l;return!isNaN(t)&&Number.MIN_SAFE_INTEGER<=t&&t<=Number.MAX_SAFE_INTEGER?t:Rs(String(l))}function of(l,t,o,u){for(;o<u;){const m=l[o+u>>1];let h=o-1,g=u+1;for(;;){do h++;while(l[h]<m);do g--;while(l[g]>m);if(h>=g)break;af(l,h,g),af(t,3*h,3*g),af(t,3*h+1,3*g+1),af(t,3*h+2,3*g+2)}g-o<u-g?(of(l,t,o,g),o=g+1):(of(l,t,g+1,u),u=g)}}function af(l,t,o){const u=l[t];l[t]=l[o],l[o]=u}Yt(bh,"FeaturePositionMap");class Na{constructor(t){this.gl=t.gl,this.initialized=!1}fetchUniformLocation(t,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(t,o),this.initialized=!0),!!this.location}set(t,o,u){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class sc extends Na{constructor(t){super(t),this.current=0}set(t,o,u){this.fetchUniformLocation(t,o)&&this.current!==u&&(this.current=u,this.gl.uniform1i(this.location,u))}}class ci extends Na{constructor(t){super(t),this.current=0}set(t,o,u){this.fetchUniformLocation(t,o)&&this.current!==u&&(this.current=u,this.gl.uniform1f(this.location,u))}}class us extends Na{constructor(t){super(t),this.current=[0,0]}set(t,o,u){this.fetchUniformLocation(t,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]||(this.current=u,this.gl.uniform2f(this.location,u[0],u[1])))}}class sf extends Na{constructor(t){super(t),this.current=[0,0,0]}set(t,o,u){this.fetchUniformLocation(t,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]||(this.current=u,this.gl.uniform3f(this.location,u[0],u[1],u[2])))}}class lf extends Na{constructor(t){super(t),this.current=[0,0,0,0]}set(t,o,u){this.fetchUniformLocation(t,o)&&(u[0]===this.current[0]&&u[1]===this.current[1]&&u[2]===this.current[2]&&u[3]===this.current[3]||(this.current=u,this.gl.uniform4f(this.location,u[0],u[1],u[2],u[3])))}}class cf extends Na{constructor(t){super(t),this.current=Rr.transparent.toRenderColor(null)}set(t,o,u){this.fetchUniformLocation(t,o)&&(u.r===this.current.r&&u.g===this.current.g&&u.b===this.current.b&&u.a===this.current.a||(this.current=u,this.gl.uniform4f(this.location,u.r,u.g,u.b,u.a)))}}const Qx=new Float32Array(16);class wh extends Na{constructor(t){super(t),this.current=Qx}set(t,o,u){if(this.fetchUniformLocation(t,o)){if(u[12]!==this.current[12]||u[0]!==this.current[0])return this.current=u,void this.gl.uniformMatrix4fv(this.location,!1,u);for(let m=1;m<16;m++)if(u[m]!==this.current[m]){this.current=u,this.gl.uniformMatrix4fv(this.location,!1,u);break}}}}const eb=new Float32Array(9),tb=new Float32Array(4);class uf extends Na{constructor(t){super(t),this.current=tb}set(t,o,u){if(this.fetchUniformLocation(t,o)){for(let m=0;m<4;m++)if(u[m]!==this.current[m]){this.current=u,this.gl.uniformMatrix2fv(this.location,!1,u);break}}}}function Im(l){return[H0(255*l.r,255*l.g),H0(255*l.b,255*l.a)]}class tu{constructor(t,o,u,m){this.value=t,this.uniformNames=o.map(h=>`u_${h}`),this.type=u,this.context=m}setUniform(t,o,u,m,h){const g=m.constantOr(this.value);o.set(t,h,g instanceof Rr?g.toRenderColor(this.ignoreLut?null:this.context.lut):g)}getBinding(t,o){return this.type==="color"?new cf(t):new ci(t)}}class ru{constructor(t,o){this.uniformNames=o.map(u=>`u_${u}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(t){this.pixelRatio=t.pixelRatio||1,this.pattern=t.tl.concat(t.br)}setUniform(t,o,u,m,h){const g=h==="u_pattern"||h==="u_dash"?this.pattern:h==="u_pixel_ratio"?this.pixelRatio:null;g&&o.set(t,h,g)}getBinding(t,o){return o==="u_pattern"||o==="u_dash"?new lf(t):new ci(t)}}class Gs{constructor(t,o,u,m){this.expression=t,this.type=u,this.maxValue=0,this.paintVertexAttributes=o.map(h=>({name:`a_${h}`,type:"Float32",components:u==="color"?2:1,offset:0})),this.paintVertexArray=new m}populatePaintArray(t,o,u,m,h,g,b){const E=this.paintVertexArray.length,A=this.expression.evaluate(new Vn(0,{brightness:g}),o,{},h,m,b);this.paintVertexArray.resize(t),this._setPaintValue(E,t,A,this.context)}updatePaintArray(t,o,u,m,h,g,b){const E=this.expression.evaluate({zoom:0,brightness:b},u,m,void 0,h);this._setPaintValue(t,o,E,this.context)}_setPaintValue(t,o,u,m){if(this.type==="color"){const h=Im(u.toRenderColor(this.ignoreLut?null:m.lut));for(let g=t;g<o;g++)this.paintVertexArray.emplace(g,h[0],h[1])}else{for(let h=t;h<o;h++)this.paintVertexArray.emplace(h,u);this.maxValue=Math.max(this.maxValue,Math.abs(u))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ja{constructor(t,o,u,m,h,g){this.expression=t,this.uniformNames=o.map(b=>`u_${b}_t`),this.type=u,this.useIntegerZoom=m,this.context=h,this.maxValue=0,this.paintVertexAttributes=o.map(b=>({name:`a_${b}`,type:"Float32",components:u==="color"?4:2,offset:0})),this.paintVertexArray=new g}populatePaintArray(t,o,u,m,h,g,b){const E=this.expression.evaluate(new Vn(this.context.zoom,{brightness:g}),o,{},h,m,b),A=this.expression.evaluate(new Vn(this.context.zoom+1,{brightness:g}),o,{},h,m,b),v=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValue(v,t,E,A,this.context)}updatePaintArray(t,o,u,m,h,g,b){const E=this.expression.evaluate({zoom:this.context.zoom,brightness:b},u,m,void 0,h),A=this.expression.evaluate({zoom:this.context.zoom+1,brightness:b},u,m,void 0,h);this._setPaintValue(t,o,E,A,this.context)}_setPaintValue(t,o,u,m,h){if(this.type==="color"){const g=Im(u.toRenderColor(this.ignoreLut?null:h.lut)),b=Im(u.toRenderColor(this.ignoreLut?null:h.lut));for(let E=t;E<o;E++)this.paintVertexArray.emplace(E,g[0],g[1],b[0],b[1])}else{for(let g=t;g<o;g++)this.paintVertexArray.emplace(g,u,m);this.maxValue=Math.max(this.maxValue,Math.abs(u),Math.abs(m))}}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(t,o,u,m,h){const g=this.useIntegerZoom?Math.floor(u.zoom):u.zoom,b=Jt(this.expression.interpolationFactor(g,this.context.zoom,this.context.zoom+1),0,1);o.set(t,h,b)}getBinding(t,o){return new ci(t)}}class Ml{constructor(t,o,u,m,h){this.expression=t,this.layerId=h,this.paintVertexAttributes=(u==="array"?Cm:Jx).members;for(let g=0;g<o.length;++g);this.paintVertexArray=new m}populatePaintArray(t,o,u,m){const h=this.paintVertexArray.length;this.paintVertexArray.resize(t),this._setPaintValues(h,t,o.patterns&&o.patterns[this.layerId],u)}updatePaintArray(t,o,u,m,h,g,b){this._setPaintValues(t,o,u.patterns&&u.patterns[this.layerId],g)}_setPaintValues(t,o,u,m){if(!m||!u)return;const h=m[u];if(!h)return;const{tl:g,br:b,pixelRatio:E}=h;for(let A=t;A<o;A++)this.paintVertexArray.emplace(A,g[0],g[1],b[0],b[1],E)}upload(t){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=t.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class lc{constructor(t,o,u=()=>!0){this.binders={},this._buffers=[],this.context=o;const m=[];for(const h in t.paint._values){const g=t.paint.get(h),b=t.paint.get(`${h}-use-theme`);if(h.endsWith("-use-theme")||!u(h)||!(g instanceof Wc&&Vc(g.property.specification)))continue;const E=rb(h,t.type),A=g.value,v=g.property.specification.type,C=!!g.property.useIntegerZoom,I=h==="line-dasharray"||h.endsWith("pattern"),S=h==="line-dasharray"&&t.layout.get("line-cap").value.kind!=="constant";if(A.kind!=="constant"||S)if(A.kind==="source"||S||I){const M=W0(h,v,"source");this.binders[h]=I?new Ml(A,E,v,M,t.id):new Gs(A,E,v,M),m.push(`/a_${h}`)}else{const M=W0(h,v,"composite");this.binders[h]=new ja(A,E,v,C,o,M),m.push(`/z_${h}`)}else this.binders[h]=I?new ru(A.value,E):new tu(A.value,E,v,o),m.push(`/u_${h}`);b&&(this.binders[h].ignoreLut=b.constantOr("default")==="none",this.binders[h].checkUseTheme=!0)}this.cacheKey=m.sort().join("")}getMaxValue(t){const o=this.binders[t];return o instanceof Gs||o instanceof ja?o.maxValue:0}populatePaintArrays(t,o,u,m,h,g,b){for(const E in this.binders){const A=this.binders[E];A.context=this.context,(A instanceof Gs||A instanceof ja||A instanceof Ml)&&A.populatePaintArray(t,o,u,m,h,g,b)}}setConstantPatternPositions(t){for(const o in this.binders){const u=this.binders[o];u instanceof ru&&u.setConstantPatternPositions(t)}}updatePaintArrays(t,o,u,m,h,g,b,E,A){let v=!1;const C=Object.keys(t),I=C.length!==0&&!E,S=I?C:o.uniqueIds;this.context.lut=h.lut;for(const M in this.binders){const R=this.binders[M];if(R.context=this.context,(R instanceof Gs||R instanceof ja||R instanceof Ml)&&(R.expression.isStateDependent===!0||R.expression.isLightConstant===!1)){const O=h.paint.get(M);R.expression=O.value;for(const F of S){const H=t[F.toString()];o.eachPosition(F,(W,V,Z)=>{const Y=m.feature(W);R.updatePaintArray(V,Z,Y,H,g,b,A)})}if(!I)for(const F of u.uniqueIds){const H=t[F.toString()];u.eachPosition(F,(W,V,Z)=>{const Y=m.feature(W);R.updatePaintArray(V,Z,Y,H,g,b,A)})}v=!0}}return v}defines(){const t=[];for(const o in this.binders){const u=this.binders[o];(u instanceof tu||u instanceof ru)&&t.push(...u.uniformNames.map(m=>`#define HAS_UNIFORM_${m}`))}return t}getBinderAttributes(){const t=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof Gs||u instanceof ja||u instanceof Ml)for(let m=0;m<u.paintVertexAttributes.length;m++)t.push(u.paintVertexAttributes[m].name)}return t}getBinderUniforms(){const t=[];for(const o in this.binders){const u=this.binders[o];if(u instanceof tu||u instanceof ru||u instanceof ja)for(const m of u.uniformNames)t.push(m)}return t}getPaintVertexBuffers(){return this._buffers}getUniforms(t){const o=[];for(const u in this.binders){const m=this.binders[u];if(m instanceof tu||m instanceof ru||m instanceof ja)for(const h of m.uniformNames)o.push({name:h,property:u,binding:m.getBinding(t,h)})}return o}setUniforms(t,o,u,m,h){for(const{name:g,property:b,binding:E}of u){if(this.binders[b].checkUseTheme&&this.binders[b]instanceof tu){const A=m.get(`${b}-use-theme`);A.isConstant()&&(this.binders[b].ignoreLut=A.constantOr("default")==="none")}this.binders[b].setUniform(t,E,h,m.get(b),g)}}updatePaintBuffers(){this._buffers=[];for(const t in this.binders){const o=this.binders[t];(o instanceof Gs||o instanceof ja||o instanceof Ml)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(t){for(const o in this.binders){const u=this.binders[o];(u instanceof Gs||u instanceof ja||u instanceof Ml)&&u.upload(t)}this.updatePaintBuffers()}destroy(){for(const t in this.binders){const o=this.binders[t];(o instanceof Gs||o instanceof ja||o instanceof Ml)&&o.destroy()}}}class Il{constructor(t,o,u=()=>!0){this.programConfigurations={};for(const m of t)this.programConfigurations[m.id]=new lc(m,o,u);this.needsUpload=!1,this._featureMap=new bh,this._featureMapWithoutIds=new bh,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(t,o,u,m,h,g,b,E){for(const A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(t,o,m,h,g,b,E);o.id!==void 0?this._featureMap.add(o.id,u,this._bufferOffset,t):(this._featureMapWithoutIds.add(this._idlessCounter,u,this._bufferOffset,t),this._idlessCounter+=1),this._bufferOffset=t,this.needsUpload=!0}updatePaintArrays(t,o,u,m,h,g,b){for(const E of u)this.needsUpload=this.programConfigurations[E.id].updatePaintArrays(t,this._featureMap,this._featureMapWithoutIds,o,E,m,h,g,b||0)||this.needsUpload}get(t){return this.programConfigurations[t]}upload(t){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(t);this.needsUpload=!1}}destroy(){for(const t in this.programConfigurations)this.programConfigurations[t].destroy()}}const hf={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function rb(l,t){return hf[l]||[l.replace(`${t}-`,"").replace(/-/g,"_")]}const nb={"line-pattern":{source:El,composite:El},"fill-pattern":{source:El,composite:El},"fill-extrusion-pattern":{source:El,composite:El},"line-dasharray":{source:Yd,composite:Yd}},df={color:{source:Us,composite:Vs},number:{source:Ea,composite:Us}};function W0(l,t,o){const u=nb[l];return u&&u[o]||df[t][o]}Yt(tu,"ConstantBinder"),Yt(ru,"PatternConstantBinder"),Yt(Gs,"SourceExpressionBinder"),Yt(Ml,"PatternCompositeBinder"),Yt(ja,"CompositeExpressionBinder"),Yt(lc,"ProgramConfiguration",{omit:["_buffers"]}),Yt(Il,"ProgramConfigurationSet");const fo=Nt/Math.PI/2,Pm=5,Am=6,q0=16383,cc=64,Rm=[cc,32,16],Ta=-fo,Ca=fo;function uc(l,t,o,u=fo){return o=ar(o),[l*Math.sin(o)*u,-t*u,l*Math.cos(o)*u]}function hc(l,t,o){return uc(Math.cos(ar(l)),Math.sin(ar(l)),t,o)}const nu=63710088e-1,zm=2*Math.PI*nu;class rn{constructor(t,o){if(isNaN(t)||isNaN(o))throw new Error(`Invalid LngLat object: (${t}, ${o})`);if(this.lng=+t,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new rn(gn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(t){const o=Math.PI/180,u=this.lat*o,m=t.lat*o,h=Math.sin(u)*Math.sin(m)+Math.cos(u)*Math.cos(m)*Math.cos((t.lng-this.lng)*o);return nu*Math.acos(Math.min(h,1))}toBounds(t=0){const o=360*t/40075017,u=o/Math.cos(Math.PI/180*this.lat);return new Pl({lng:this.lng-u,lat:this.lat-o},{lng:this.lng+u,lat:this.lat+o})}toEcef(t){return hc(this.lat,this.lng,fo+t*fo/nu)}static convert(t){if(t instanceof rn)return t;if(Array.isArray(t)&&(t.length===2||t.length===3))return new rn(Number(t[0]),Number(t[1]));if(!Array.isArray(t)&&typeof t=="object"&&t!==null)return new rn(Number("lng"in t?t.lng:t.lon),Number(t.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Pl{constructor(t,o){if(t)if(o)this.setSouthWest(t).setNorthEast(o);else if(t.length===4){const u=t;this.setSouthWest([u[0],u[1]]).setNorthEast([u[2],u[3]])}else{const u=t;this.setSouthWest(u[0]).setNorthEast(u[1])}}setNorthEast(t){return this._ne=t instanceof rn?new rn(t.lng,t.lat):rn.convert(t),this}setSouthWest(t){return this._sw=t instanceof rn?new rn(t.lng,t.lat):rn.convert(t),this}extend(t){const o=this._sw,u=this._ne;let m,h;if(t instanceof rn)m=t,h=t;else{if(!(t instanceof Pl))return Array.isArray(t)?t.length===4||t.every(Array.isArray)?this.extend(Pl.convert(t)):this.extend(rn.convert(t)):typeof t=="object"&&t!==null&&t.hasOwnProperty("lat")&&(t.hasOwnProperty("lon")||t.hasOwnProperty("lng"))?this.extend(rn.convert(t)):this;if(m=t._sw,h=t._ne,!m||!h)return this}return o||u?(o.lng=Math.min(m.lng,o.lng),o.lat=Math.min(m.lat,o.lat),u.lng=Math.max(h.lng,u.lng),u.lat=Math.max(h.lat,u.lat)):(this._sw=new rn(m.lng,m.lat),this._ne=new rn(h.lng,h.lat)),this}getCenter(){return new rn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new rn(this.getWest(),this.getNorth())}getSouthEast(){return new rn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(t){const{lng:o,lat:u}=rn.convert(t);let m=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(m=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=u&&u<=this._ne.lat&&m}static convert(t){if(t)return t instanceof Pl?t:new Pl(t)}}const Z0=0,Lm=25.5;function Sh(l){return zm*Math.cos(l*Math.PI/180)}function Al(l){return(180+l)/360}function Hs(l){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+l*Math.PI/360)))/360}function wo(l,t){return l/Sh(t)}function ta(l){return 360*l-180}function Zi(l){return 360/Math.PI*Math.atan(Math.exp((180-360*l)*Math.PI/180))-90}function km(l,t){return l*Sh(Zi(t))}const mi=85.051129;function f(l){return Math.cos(ar(Jt(l,-mi,mi)))}function n(l,t){const o=Jt(t,Z0,Lm),u=Math.pow(2,o);return f(l)*zm/(512*u)}function s(l){return 1/Math.cos(l*Math.PI/180)}function p(l,t=0){const o=Math.exp(Math.PI*(1-(l.y+t/Nt)/(1<<l.z)*2));return 80150034*o/(o*o+1)/Nt/(1<<l.z)}class _{constructor(t,o,u=0){this.x=+t,this.y=+o,this.z=+u}static fromLngLat(t,o=0){const u=rn.convert(t);return new _(Al(u.lng),Hs(u.lat),wo(o,u.lat))}toLngLat(){return new rn(ta(this.x),Zi(this.y))}toAltitude(){return km(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/zm*s(Zi(this.y))}}function y(l,t,o,u,m,h,g,b,E){const A=(t+u)/2,v=(o+m)/2,C=new wt(A,v);b(C),function(I,S,M,R,O,F){const H=M-O,W=R-F;return Math.abs((R-S)*H-(M-I)*W)/Math.hypot(H,W)}(C.x,C.y,h.x,h.y,g.x,g.y)>=E?(y(l,t,o,A,v,h,C,b,E),y(l,A,v,u,m,C,g,b,E)):l.push(g)}function w(l,t,o){let u=l[0],m=u.x,h=u.y;t(u);const g=[u];for(let b=1;b<l.length;b++){const E=l[b],{x:A,y:v}=E;t(E),y(g,m,h,A,v,u,E,t,o),m=A,h=v,u=E}return g}function P(l,t,o,u){if(u(t,o)){const m=t.add(o)._mult(.5);P(l,t,m,u),P(l,m,o,u)}else l.push(o)}function z(l,t){let o=l[0];const u=[o];for(let m=1;m<l.length;m++){const h=l[m];P(u,o,h,t),o=h}return u}const k=Math.pow(2,14)-1,D=-k-1;function j(l,t){const o=Math.round(l.x*t),u=Math.round(l.y*t);return l.x=Jt(o,D,k),l.y=Jt(u,D,k),(o<l.x||o>l.x+1||u<l.y||u>l.y+1)&&gr("Geometry exceeds allowed extent, reduce your vector tile buffer size"),l}function B(l,t,o){const u=l.loadGeometry(),m=l.extent,h=Nt/m;if(t&&o&&o.projection.isReprojectedInTileSpace){const g=1<<t.z,{scale:b,x:E,y:A,projection:v}=o,C=I=>{const S=ta((t.x+I.x/m)/g),M=Zi((t.y+I.y/m)/g),R=v.project(S,M);I.x=(R.x*b-E)*m,I.y=(R.y*b-A)*m};for(let I=0;I<u.length;I++)if(l.type!==1)u[I]=w(u[I],C,1);else{const S=[];for(const M of u[I])M.x<0||M.x>=m||M.y<0||M.y>=m||(C(M),S.push(M));u[I]=S}}for(const g of u)for(const b of g)j(b,h);return u}function G(l,t){return{type:l.type,id:l.id,properties:l.properties,geometry:t?B(l):[]}}function Q(l,t,o,u,m){l.emplaceBack(2*t+(u+1)/2,2*o+(m+1)/2)}function J(l,t,o){l.emplaceBack(t.x,t.y,t.z,o[0]*16384,o[1]*16384,o[2]*16384)}class ie{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.hasPattern=!1,this.projection=t.projection,this.layoutVertexArray=new $s,this.indexArray=new no,this.segments=new ri,this.programConfigurations=new Il(t.layers,{zoom:t.zoom,lut:t.lut}),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}updateFootprints(t,o){}populate(t,o,u,m){const h=this.layers[0],g=[];let b=null;h.type==="circle"&&(b=h.layout.get("circle-sort-key"));for(const{feature:A,id:v,index:C,sourceLayerIndex:I}of t){const S=this.layers[0]._featureFilter.needGeometry,M=G(A,S);if(!this.layers[0]._featureFilter.filter(new Vn(this.zoom),M,u))continue;const R=b?b.evaluate(M,{},u):void 0,O={id:v,properties:A.properties,type:A.type,sourceLayerIndex:I,index:C,geometry:S?M.geometry:B(A,u,m),patterns:{},sortKey:R};g.push(O)}b&&g.sort((A,v)=>A.sortKey-v.sortKey);let E=null;m.projection.name==="globe"&&(this.globeExtVertexArray=new Kd,E=m.projection);for(const A of g){const{geometry:v,index:C,sourceLayerIndex:I}=A,S=t[C].feature;this.addFeature(A,v,C,o.availableImages,u,E,o.brightness),o.featureIndex.insert(S,v,C,I,this.index)}}update(t,o,u,m,h,g,b){this.programConfigurations.updatePaintArrays(t,o,h,u,m,g,b)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Tm.members),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,Kx.members))),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(t,o,u,m,h,g,b){for(const E of o)for(const A of E){const v=A.x,C=A.y;if(v<0||v>=Nt||C<0||C>=Nt)continue;if(g){const M=g.projectTilePoint(v,C,h),R=g.upVector(h,v,C),O=this.globeExtVertexArray;J(O,M,R),J(O,M,R),J(O,M,R),J(O,M,R)}const I=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,t.sortKey),S=I.vertexLength;Q(this.layoutVertexArray,v,C,-1,-1),Q(this.layoutVertexArray,v,C,1,-1),Q(this.layoutVertexArray,v,C,1,1),Q(this.layoutVertexArray,v,C,-1,1),this.indexArray.emplaceBack(S,S+1,S+2),this.indexArray.emplaceBack(S,S+2,S+3),I.vertexLength+=4,I.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,{},m,h,b)}}function oe(l,t){for(let o=0;o<l.length;o++)if($e(t,l[o]))return!0;for(let o=0;o<t.length;o++)if($e(l,t[o]))return!0;return!!Pe(l,t)}function me(l,t,o){return!!$e(l,t)||!!Ie(t,l,o)}function Se(l,t){if(l.length===1)return De(t,l[0]);for(let o=0;o<t.length;o++){const u=t[o];for(let m=0;m<u.length;m++)if($e(l,u[m]))return!0}for(let o=0;o<l.length;o++)if(De(t,l[o]))return!0;for(let o=0;o<t.length;o++)if(Pe(l,t[o]))return!0;return!1}function be(l,t,o){if(l.length>1){if(Pe(l,t))return!0;for(let u=0;u<t.length;u++)if(Ie(t[u],l,o))return!0}for(let u=0;u<l.length;u++)if(Ie(l[u],t,o))return!0;return!1}function Pe(l,t){if(l.length===0||t.length===0)return!1;for(let o=0;o<l.length-1;o++){const u=l[o],m=l[o+1];for(let h=0;h<t.length-1;h++)if(Me(u,m,t[h],t[h+1]))return!0}return!1}function Me(l,t,o,u){return Gi(l,o,u)!==Gi(t,o,u)&&Gi(l,t,o)!==Gi(l,t,u)}function Ie(l,t,o){const u=o*o;if(t.length===1)return l.distSqr(t[0])<u;for(let m=1;m<t.length;m++)if(Ce(l,t[m-1],t[m])<u)return!0;return!1}function Ce(l,t,o){const u=t.distSqr(o);if(u===0)return l.distSqr(t);const m=((l.x-t.x)*(o.x-t.x)+(l.y-t.y)*(o.y-t.y))/u;return l.distSqr(m<0?t:m>1?o:o.sub(t)._mult(m)._add(t))}function De(l,t){let o,u,m,h=!1;for(let g=0;g<l.length;g++){o=l[g];for(let b=0,E=o.length-1;b<o.length;E=b++)u=o[b],m=o[E],u.y>t.y!=m.y>t.y&&t.x<(m.x-u.x)*(t.y-u.y)/(m.y-u.y)+u.x&&(h=!h)}return h}function $e(l,t){let o=!1;for(let u=0,m=l.length-1;u<l.length;m=u++){const h=l[u],g=l[m];h.y>t.y!=g.y>t.y&&t.x<(g.x-h.x)*(t.y-h.y)/(g.y-h.y)+h.x&&(o=!o)}return o}function at(l,t,o,u,m){for(const g of l)if(t<=g.x&&o<=g.y&&u>=g.x&&m>=g.y)return!0;const h=[new wt(t,o),new wt(t,m),new wt(u,m),new wt(u,o)];if(l.length>2){for(const g of h)if($e(l,g))return!0}for(let g=0;g<l.length-1;g++)if(rt(l[g],l[g+1],h))return!0;return!1}function rt(l,t,o){const u=o[0],m=o[2];if(l.x<u.x&&t.x<u.x||l.x>m.x&&t.x>m.x||l.y<u.y&&t.y<u.y||l.y>m.y&&t.y>m.y)return!1;const h=Gi(l,t,o[0]);return h!==Gi(l,t,o[1])||h!==Gi(l,t,o[2])||h!==Gi(l,t,o[3])}function je(l,t,o,u,m,h){let g=t.y-l.y,b=l.x-t.x;if(h=h||0){const E=g*g+b*b;if(E===0)return!0;const A=Math.sqrt(E);g/=A,b/=A}return!((o.x-l.x)*g+(o.y-l.y)*b-h<0||(u.x-l.x)*g+(u.y-l.y)*b-h<0||(m.x-l.x)*g+(m.y-l.y)*b-h<0)}function qe(l,t,o,u,m,h,g){return!(je(l,t,u,m,h,g)||je(t,o,u,m,h,g)||je(o,l,u,m,h,g)||je(u,m,l,t,o,g)||je(m,h,l,t,o,g)||je(h,u,l,t,o,g))}function mt(l,t,o){const u=t.paint.get(l).value;return u.kind==="constant"?u.value:o.programConfigurations.get(t.id).getMaxValue(l)}function Tt(l){return Math.sqrt(l[0]*l[0]+l[1]*l[1])}function Lt(l,t,o,u,m){if(!t[0]&&!t[1])return l;const h=wt.convert(t)._mult(m);o==="viewport"&&h._rotate(-u);const g=[];for(let b=0;b<l.length;b++)g.push(l[b].sub(h));return g}function et(l,t,o,u){const m=wt.convert(l)._mult(u);return t==="viewport"&&m._rotate(-o),m}let xt,st;Yt(ie,"CircleBucket",{omit:["layers"]});var Rt,bt={exports:{}},gt=(Rt||(Rt=1,function(l,t){(function(o){function u(h,g,b){var E=m(256*h,256*(g=Math.pow(2,b)-g-1),b),A=m(256*(h+1),256*(g+1),b);return E[0]+","+E[1]+","+A[0]+","+A[1]}function m(h,g,b){var E=2*Math.PI*6378137/256/Math.pow(2,b);return[h*E-2*Math.PI*6378137/2,g*E-2*Math.PI*6378137/2]}o.getURL=function(h,g,b,E,A,v){return v=v||{},h+"?"+["bbox="+u(b,E,A),"format="+(v.format||"image/png"),"service="+(v.service||"WMS"),"version="+(v.version||"1.1.1"),"request="+(v.request||"GetMap"),"srs="+(v.srs||"EPSG:3857"),"width="+(v.width||256),"height="+(v.height||256),"layers="+g].join("&")},o.getTileBBox=u,o.getMercCoords=m,Object.defineProperty(o,"__esModule",{value:!0})})(t)}(0,bt.exports)),bt.exports);class jt{constructor(t,o,u){this.z=t,this.x=o,this.y=u,this.key=Zt(0,t,t,o,u)}equals(t){return this.z===t.z&&this.x===t.x&&this.y===t.y}url(t,o){const u=gt.getTileBBox(this.x,this.y,this.z),m=function(h,g,b){let E,A="";for(let v=h;v>0;v--)E=1<<v-1,A+=(g&E?1:0)+(b&E?2:0);return A}(this.z,this.x,this.y);return t[(this.x+this.y)%t.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(o==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",m).replace("{bbox-epsg-3857}",u)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Vt{constructor(t,o){this.wrap=t,this.canonical=o,this.key=Zt(t,o.z,o.z,o.x,o.y)}}class Bt{constructor(t,o,u,m,h){this.overscaledZ=t,this.wrap=o,this.canonical=new jt(u,+m,+h),this.key=o===0&&t===u?this.canonical.key:Zt(o,t,u,m,h)}equals(t){return this.overscaledZ===t.overscaledZ&&this.wrap===t.wrap&&this.canonical.equals(t.canonical)}scaledTo(t){const o=this.canonical.z-t;return t>this.canonical.z?new Bt(t,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Bt(t,this.wrap,t,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(t,o=!0){if(this.overscaledZ===t&&o)return this.key;if(t>this.canonical.z)return Zt(this.wrap*+o,t,this.canonical.z,this.canonical.x,this.canonical.y);{const u=this.canonical.z-t;return Zt(this.wrap*+o,t,t,this.canonical.x>>u,this.canonical.y>>u)}}isChildOf(t){if(t.wrap!==this.wrap)return!1;const o=this.canonical.z-t.canonical.z;return t.overscaledZ===0||t.overscaledZ<this.overscaledZ&&t.canonical.z<this.canonical.z&&t.canonical.x===this.canonical.x>>o&&t.canonical.y===this.canonical.y>>o}children(t){if(this.overscaledZ>=t)return[new Bt(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,u=2*this.canonical.x,m=2*this.canonical.y;return[new Bt(o,this.wrap,o,u,m),new Bt(o,this.wrap,o,u+1,m),new Bt(o,this.wrap,o,u,m+1),new Bt(o,this.wrap,o,u+1,m+1)]}isLessThan(t){return this.wrap<t.wrap||!(this.wrap>t.wrap)&&(this.overscaledZ<t.overscaledZ||!(this.overscaledZ>t.overscaledZ)&&(this.canonical.x<t.canonical.x||!(this.canonical.x>t.canonical.x)&&this.canonical.y<t.canonical.y))}wrapped(){return new Bt(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(t){return new Bt(this.overscaledZ,t,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Vt(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Zt(l,t,o,u,m){const h=1<<Math.min(o,22);let g=h*(m%h)+u%h;return l&&o<22&&(g+=h*h*((l<0?-2*l-1:2*l)%(1<<2*(22-o)))),16*(32*g+o)+(t-o)}const wr=[l=>{let t=l.canonical.x-1,o=l.wrap;return t<0&&(t=(1<<l.canonical.z)-1,o--),new Bt(l.overscaledZ,o,l.canonical.z,t,l.canonical.y)},l=>{let t=l.canonical.x+1,o=l.wrap;return t===1<<l.canonical.z&&(t=0,o++),new Bt(l.overscaledZ,o,l.canonical.z,t,l.canonical.y)},l=>new Bt(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,(l.canonical.y===0?1<<l.canonical.z:l.canonical.y)-1),l=>new Bt(l.overscaledZ,l.wrap,l.canonical.z,l.canonical.x,l.canonical.y===(1<<l.canonical.z)-1?0:l.canonical.y+1)];Yt(jt,"CanonicalTileID"),Yt(Bt,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const lr=on([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:sr}=lr,Er=on([{name:"a_pos_3",components:3,type:"Int16"}]);var Jr=on([{name:"a_pos",type:"Int16",components:2}]);class Or{constructor(t,o){this.pos=t,this.dir=o}intersectsPlane(t,o,u){const m=Ae.vec3.dot(o,this.dir);if(Math.abs(m)<1e-6)return!1;const h=((t[0]-this.pos[0])*o[0]+(t[1]-this.pos[1])*o[1]+(t[2]-this.pos[2])*o[2])/m;return u[0]=this.pos[0]+this.dir[0]*h,u[1]=this.pos[1]+this.dir[1]*h,u[2]=this.pos[2]+this.dir[2]*h,!0}closestPointOnSphere(t,o,u){if(Ae.vec3.equals(this.pos,t)||o===0)return u[0]=u[1]=u[2]=0,!1;const[m,h,g]=this.dir,b=this.pos[0]-t[0],E=this.pos[1]-t[1],A=this.pos[2]-t[2],v=m*m+h*h+g*g,C=2*(b*m+E*h+A*g),I=C*C-4*v*(b*b+E*E+A*A-o*o);if(I<0){const S=Math.max(-C/2,0),M=b+m*S,R=E+h*S,O=A+g*S,F=Math.hypot(M,R,O);return u[0]=M*o/F,u[1]=R*o/F,u[2]=O*o/F,!1}{const S=(-C-Math.sqrt(I))/(2*v);if(S<0){const M=Math.hypot(b,E,A);return u[0]=b*o/M,u[1]=E*o/M,u[2]=A*o/M,!1}return u[0]=b+m*S,u[1]=E+h*S,u[2]=A+g*S,!0}}}class jn{constructor(t,o,u,m,h){this.TL=t,this.TR=o,this.BR=u,this.BL=m,this.horizon=h}static fromInvProjectionMatrix(t,o,u){const m=[-1,1,1],h=[1,1,1],g=[1,-1,1],b=[-1,-1,1],E=Ae.vec3.transformMat4(m,m,t),A=Ae.vec3.transformMat4(h,h,t),v=Ae.vec3.transformMat4(g,g,t),C=Ae.vec3.transformMat4(b,b,t);return new jn(E,A,v,C,o/u)}}function Pn(l,t,o){let u=1/0,m=-1/0;const h=[];for(const g of l){Ae.vec3.sub(h,g,t);const b=Ae.vec3.dot(h,o);u=Math.min(u,b),m=Math.max(m,b)}return[u,m]}function un(l,t){let o=!0;for(let u=0;u<l.planes.length;u++){const m=l.planes[u];let h=0;for(let g=0;g<t.length;g++)h+=Ae.vec3.dot(m,t[g])+m[3]>=0;if(h===0)return 0;h!==t.length&&(o=!1)}return o?2:1}function yn(l,t){for(const o of l.projections){const u=Pn(t,l.points[0],o.axis);if(o.projection[1]<u[0]||o.projection[0]>u[1])return 0}return 1}function Fr(l,t){let o=0;const u=[0,0,0,0];for(let m=0;m<l.length;m++)u[0]=l[m][0],u[1]=l[m][1],u[2]=l[m][2],u[3]=1,Ae.vec4.dot(u,t)>=0&&o++;return o}class Qr{constructor(t,o){this.points=t||new Array(8).fill([0,0,0]),this.planes=o||new Array(6).fill([0,0,0,0]),this.bounds=pr.fromPoints(this.points),this.projections=[],this.frustumEdges=[Ae.vec3.sub([],this.points[2],this.points[3]),Ae.vec3.sub([],this.points[0],this.points[3]),Ae.vec3.sub([],this.points[4],this.points[0]),Ae.vec3.sub([],this.points[5],this.points[1]),Ae.vec3.sub([],this.points[6],this.points[2]),Ae.vec3.sub([],this.points[7],this.points[3])];for(const u of this.frustumEdges){const m=[0,-u[2],u[1]],h=[u[2],0,-u[0]];this.projections.push({axis:m,projection:Pn(this.points,this.points[0],m)}),this.projections.push({axis:h,projection:Pn(this.points,this.points[0],h)})}}static fromInvProjectionMatrix(t,o,u,m){const h=Math.pow(2,u),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(A=>{const v=Ae.vec4.transformMat4([],A,t),C=1/v[3]/o*h;return Ae.vec4.mul(v,v,[C,C,m?1/v[3]:C,C])}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(A=>{const v=Ae.vec3.sub([],g[A[0]],g[A[1]]),C=Ae.vec3.sub([],g[A[2]],g[A[1]]),I=Ae.vec3.normalize([],Ae.vec3.cross([],v,C)),S=-Ae.vec3.dot(I,g[A[1]]);return I.concat(S)}),E=[];for(let A=0;A<g.length;A++)E.push([g[A][0],g[A][1],g[A][2]]);return new Qr(E,b)}intersectsPrecise(t,o,u){for(let m=0;m<o.length;m++)if(!Fr(t,o[m]))return 0;for(let m=0;m<this.planes.length;m++)if(!Fr(t,this.planes[m]))return 0;for(const m of u)for(const h of this.frustumEdges){const g=Ae.vec3.cross([],m,h),b=Ae.vec3.length(g);if(b===0)continue;Ae.vec3.scale(g,g,1/b);const E=Pn(this.points,this.points[0],g),A=Pn(t,this.points[0],g);if(E[0]>A[1]||A[0]>E[1])return 0}return 1}containsPoint(t){for(const o of this.planes){const u=o[3];if(Ae.vec3.dot([o[0],o[1],o[2]],t)+u<0)return!1}return!0}}class pr{static fromPoints(t){const o=[1/0,1/0,1/0],u=[-1/0,-1/0,-1/0];for(const m of t)Ae.vec3.min(o,o,m),Ae.vec3.max(u,u,m);return new pr(o,u)}static fromTileIdAndHeight(t,o,u){const m=1<<t.canonical.z,h=t.canonical.x,g=t.canonical.y;return new pr([h/m,g/m,o],[(h+1)/m,(g+1)/m,u])}static applyTransform(t,o){const u=t.getCorners();for(let m=0;m<u.length;++m)Ae.vec3.transformMat4(u[m],u[m],o);return pr.fromPoints(u)}static applyTransformFast(t,o){const u=[o[12],o[13],o[14]],m=[...u];for(let h=0;h<3;h++)for(let g=0;g<3;g++){const b=o[4*g+h],E=b*t.min[g],A=b*t.max[g];u[h]+=Math.min(E,A),m[h]+=Math.max(E,A)}return new pr(u,m)}static projectAabbCorners(t,o){const u=t.getCorners();for(let m=0;m<u.length;++m)Ae.vec3.transformMat4(u[m],u[m],o);return u}constructor(t,o){this.min=t,this.max=o,this.center=Ae.vec3.scale([],Ae.vec3.add([],this.min,this.max),.5)}quadrant(t){const o=[t%2==0,t<2],u=Ae.vec3.clone(this.min),m=Ae.vec3.clone(this.max);for(let h=0;h<o.length;h++)u[h]=o[h]?this.min[h]:this.center[h],m[h]=o[h]?this.center[h]:this.max[h];return m[2]=this.max[2],new pr(u,m)}distanceX(t){return Math.max(Math.min(this.max[0],t[0]),this.min[0])-t[0]}distanceY(t){return Math.max(Math.min(this.max[1],t[1]),this.min[1])-t[1]}distanceZ(t){return Math.max(Math.min(this.max[2],t[2]),this.min[2])-t[2]}getCorners(){const t=this.min,o=this.max;return[[t[0],t[1],t[2]],[o[0],t[1],t[2]],[o[0],o[1],t[2]],[t[0],o[1],t[2]],[t[0],t[1],o[2]],[o[0],t[1],o[2]],[o[0],o[1],o[2]],[t[0],o[1],o[2]]]}intersects(t){return this.intersectsAabb(t.bounds)?un(t,this.getCorners()):0}intersectsFlat(t){return this.intersectsAabb(t.bounds)?un(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(t,o){return o||this.intersects(t)?yn(t,this.getCorners()):0}intersectsPreciseFlat(t,o){return o||this.intersectsFlat(t)?yn(t,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(t){for(let o=0;o<3;++o)if(this.min[o]>t.max[o]||t.min[o]>this.max[o])return!1;return!0}intersectsAabbXY(t){return!(this.min[0]>t.max[0]||t.min[0]>this.max[0]||this.min[1]>t.max[1]||t.min[1]>this.max[1])}encapsulate(t){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],t.min[o]),this.max[o]=Math.max(this.max[o],t.max[o])}encapsulatePoint(t){for(let o=0;o<3;o++)this.min[o]=Math.min(this.min[o],t[o]),this.max[o]=Math.max(this.max[o],t[o])}closestPoint(t){return[Math.max(Math.min(this.max[0],t[0]),this.min[0]),Math.max(Math.min(this.max[1],t[1]),this.min[1]),Math.max(Math.min(this.max[2],t[2]),this.min[2])]}}function an(l){return l*fo/nu}Yt(pr,"Aabb");const ei=[new pr([Ta,Ta,Ta],[Ca,Ca,Ca]),new pr([Ta,Ta,Ta],[0,0,Ca]),new pr([0,Ta,Ta],[Ca,0,Ca]),new pr([Ta,0,Ta],[0,Ca,Ca]),new pr([0,0,Ta],[Ca,Ca,Ca])];function $i(l,t,o,u=!0){const m=Ae.vec3.scale([],l._camera.position,l.worldSize),h=[t,o,1,1];Ae.vec4.transformMat4(h,h,l.pixelMatrixInverse),Ae.vec4.scale(h,h,1/h[3]);const g=Ae.vec3.sub([],h,m),b=Ae.vec3.normalize([],g),E=l.globeMatrix,A=[E[12],E[13],E[14]],v=Ae.vec3.sub([],A,m),C=Ae.vec3.length(v),I=Ae.vec3.normalize([],v),S=l.worldSize/(2*Math.PI),M=Ae.vec3.dot(I,b),R=Math.asin(S/C);if(R<Math.acos(M)){if(!u)return null;const Re=[],we=[];Ae.vec3.scale(Re,b,C/M),Ae.vec3.normalize(we,Ae.vec3.sub(we,Re,v)),Ae.vec3.normalize(b,Ae.vec3.add(b,v,Ae.vec3.scale(b,we,Math.tan(R)*C)))}const O=[];new Or(m,b).closestPointOnSphere(A,S,O);const F=Ae.vec3.normalize([],Wi(E,0)),H=Ae.vec3.normalize([],Wi(E,1)),W=Ae.vec3.normalize([],Wi(E,2)),V=Ae.vec3.dot(F,O),Z=Ae.vec3.dot(H,O),Y=Ae.vec3.dot(W,O),ne=tn(Math.asin(-Z/S));let ye=tn(Math.atan2(V,Y));ye=l.center.lng+function(Re,we){const Le=(we-Re+180)%360-180;return Le<-180?Le+360:Le}(l.center.lng,ye);const _e=Al(ye),ge=Jt(Hs(ne),0,1);return new _(_e,ge)}class ra{constructor(t,o,u){this.a=Ae.vec3.sub([],t,u),this.b=Ae.vec3.sub([],o,u),this.center=u;const m=Ae.vec3.normalize([],this.a),h=Ae.vec3.normalize([],this.b);this.angle=Math.acos(Ae.vec3.dot(m,h))}}function po(l,t){if(l.angle===0)return null;let o;return o=l.a[t]===0?1/l.angle*.5*Math.PI:1/l.angle*Math.atan(l.b[t]/l.a[t]/Math.sin(l.angle)-1/Math.tan(l.angle)),o<0||o>1?null:function(u,m,h,g){const b=Math.sin(h);return u*(Math.sin((1-g)*h)/b)+m*(Math.sin(g*h)/b)}(l.a[t],l.b[t],l.angle,Jt(o,0,1))+l.center[t]}function ki(l){if(l.z<=1)return ei[l.z+2*l.y+l.x];const t=en(Tn(l));return pr.fromPoints(t)}function vi(l,t,o){return Ae.vec3.scale(l,l,1-o),Ae.vec3.scaleAndAdd(l,l,t,o)}function oi(l,t,o){for(const u of l)Ae.vec3.transformMat4(u,u,t),Ae.vec3.scale(u,u,o)}function On(l,t,o,u){const m=t/l.worldSize,h=l.globeMatrix;if(o.z<=1){const _e=ki(o).getCorners();return oi(_e,h,m),pr.fromPoints(_e)}const g=Tn(o,u),b=en(g,fo+an(l._tileCoverLift));oi(b,h,m);const E=Number.MAX_VALUE,A=[-E,-E,-E],v=[E,E,E];if(g.contains(l.center)){for(const Re of b)Ae.vec3.min(v,v,Re),Ae.vec3.max(A,A,Re);A[2]=0;const _e=l.point,ge=[_e.x*m,_e.y*m,0];return Ae.vec3.min(v,v,ge),Ae.vec3.max(A,A,ge),new pr(v,A)}if(l._tileCoverLift>0){for(const _e of b)Ae.vec3.min(v,v,_e),Ae.vec3.max(A,A,_e);return new pr(v,A)}const C=[h[12]*m,h[13]*m,h[14]*m],I=g.getCenter(),S=Jt(l.center.lat,-mi,mi),M=Jt(I.lat,-mi,mi),R=Al(l.center.lng),O=Hs(S);let F=R-Al(I.lng);const H=O-Hs(M);F>.5?F-=1:F<-.5&&(F+=1);let W=0;if(Math.abs(F)>Math.abs(H))W=F>=0?1:3;else{W=H>=0?0:2;const _e=[h[4]*m,h[5]*m,h[6]*m],ge=-Math.sin(ar(H>=0?g.getSouth():g.getNorth()))*fo;Ae.vec3.scaleAndAdd(C,C,_e,ge)}const V=b[W],Z=b[(W+1)%4],Y=new ra(V,Z,C),ne=[po(Y,0)||V[0],po(Y,1)||V[1],po(Y,2)||V[2]],ye=mo(l.zoom);if(ye>0){const _e=function({x:Re,y:we,z:Le},Be,Oe,Ve,We){const Qe=1/(1<<Le);let Ge=Re*Qe,ut=Ge+Qe,It=we*Qe,dt=It+Qe,Dt=0;const kt=(Ge+ut)/2-Ve;return kt>.5?Dt=-1:kt<-.5&&(Dt=1),Ge=((Ge+Dt)*Be-(Ve*=Be))*Oe+Ve,ut=((ut+Dt)*Be-Ve)*Oe+Ve,It=(It*Be-(We*=Be))*Oe+We,dt=(dt*Be-We)*Oe+We,[[Ge,dt,0],[ut,dt,0],[ut,It,0],[Ge,It,0]]}(o,t,l._pixelsPerMercatorPixel,R,O);for(let Re=0;Re<b.length;Re++)vi(b[Re],_e[Re],ye);const ge=Ae.vec3.add([],_e[W],_e[(W+1)%4]);Ae.vec3.scale(ge,ge,.5),vi(ne,ge,ye)}for(const _e of b)Ae.vec3.min(v,v,_e),Ae.vec3.max(A,A,_e);return v[2]=Math.min(V[2],Z[2]),Ae.vec3.min(v,v,ne),Ae.vec3.max(A,A,ne),new pr(v,A)}function Tn({x:l,y:t,z:o},u=!1){const m=1/(1<<o),h=new rn(ta(l*m),t===(1<<o)-1&&u?-90:Zi((t+1)*m)),g=new rn(ta((l+1)*m),t===0&&u?90:Zi(t*m));return new Pl(h,g)}function en(l,t=fo){const o=ar(l.getNorth()),u=ar(l.getSouth()),m=Math.cos(o),h=Math.cos(u),g=Math.sin(o),b=Math.sin(u),E=l.getWest(),A=l.getEast();return[uc(h,b,E,t),uc(h,b,A,t),uc(m,g,A,t),uc(m,g,E,t)]}function ni(l,t,o,u){const m=1<<o.z,h=(l/Nt+o.x)/m;return hc(Zi((t/Nt+o.y)/m),ta(h),u)}function Di({min:l,max:t}){return q0/Math.max(t[0]-l[0],t[1]-l[1],t[2]-l[2])}const An=new Float64Array(16);function io(l){const t=Di(l),o=Ae.mat4.fromScaling(An,[t,t,t]);return Ae.mat4.translate(o,o,Ae.vec3.negate([],l.min))}function ca(l){const t=Ae.mat4.fromTranslation(An,l.min),o=1/Di(l);return Ae.mat4.scale(t,t,[o,o,o])}function No(l){const t=Nt/(2*Math.PI);return l/(2*Math.PI)/t}function Ws(l,t){return Nt/(512*Math.pow(2,l))*Di(ki(t))}function hs(l,t,o,u,m){const h=No(o),g=[l,t,-o/(2*Math.PI)],b=Ae.mat4.identity(new Float64Array(16));return Ae.mat4.translate(b,b,g),Ae.mat4.scale(b,b,[h,h,h]),Ae.mat4.rotateX(b,b,ar(-m)),Ae.mat4.rotateY(b,b,ar(-u)),b}function mo(l){return bn(Pm,Am,l)}function ua(l,t){const o=hc(t.lat,t.lng),u=function(h){const g=hc(h._center.lat,h._center.lng),b=Ae.vec3.fromValues(0,1,0);let E=Ae.vec3.cross([],b,g);const A=Ae.mat4.fromRotation([],-h.angle,g);E=Ae.vec3.transformMat4(E,E,A),Ae.mat4.fromRotation(A,-h._pitch,E);const v=Ae.vec3.normalize([],g);return Ae.vec3.scale(v,v,an(h.cameraToCenterDistance/h.pixelsPerMeter)),Ae.vec3.transformMat4(v,v,A),Ae.vec3.add([],g,v)}(l),m=Ae.vec3.subtract([],u,o);return Ae.vec3.angle(m,o)}function qs(l,t){return ua(l,t)>Math.PI/2*1.01}const $a=ar(85),dc=Math.cos($a),Eh=Math.sin($a),Dm=Ae.mat4.create(),ff=l=>{const t=[];return l.paint.get("circle-pitch-alignment")==="map"&&t.push("PITCH_WITH_MAP"),l.paint.get("circle-pitch-scale")==="map"&&t.push("SCALE_WITH_MAP"),t};function cT(l,t,o,u,m,h,g,b,E){if(h&&l.queryGeometry.isAboveHorizon)return!1;h&&(E*=l.pixelToTileUnitsFactor);const A=l.tileID.canonical,v=o.projection.upVectorScale(A,o.center.lat,o.worldSize).metersToTile;for(const C of t)for(const I of C){const S=I.add(b),M=m&&o.elevation?o.elevation.exaggeration()*m.getElevationAt(S.x,S.y,!0):0,R=o.projection.projectTilePoint(S.x,S.y,A);if(M>0){const W=o.projection.upVector(A,S.x,S.y);R.x+=W[0]*v*M,R.y+=W[1]*v*M,R.z+=W[2]*v*M}const O=h?S:Sk(R.x,R.y,R.z,u),F=h?l.tilespaceRays.map(W=>Tk(W,M)):l.queryGeometry.screenGeometry,H=Ae.vec4.transformMat4([],[R.x,R.y,R.z,1],u);if(!g&&h?E*=H[3]/o.cameraToCenterDistance:g&&!h&&(E*=o.cameraToCenterDistance/H[3]),h){const W=Zi((I.y/Nt+A.y)/(1<<A.z));E/=o.projection.pixelsPerMeter(W,1)/wo(1,W)}if(me(F,O,E))return!0}return!1}function Sk(l,t,o,u){const m=Ae.vec4.transformMat4([],[l,t,o,1],u);return new wt(m[0]/m[3],m[1]/m[3])}const uT=Ae.vec3.fromValues(0,0,0),Ek=Ae.vec3.fromValues(0,0,1);function Tk(l,t){const o=Ae.vec3.create();return uT[2]=t,l.intersectsPlane(uT,Ek,o),new wt(o[0],o[1])}class hT extends ie{}let dT,fT,pT,mT;function gT(l,{width:t,height:o},u,m){if(m){if(m instanceof Uint8ClampedArray)m=new Uint8Array(m.buffer);else if(m.length!==t*o*u)throw new RangeError("mismatched image size")}else m=new Uint8Array(t*o*u);return l.width=t,l.height=o,l.data=m,l}function _T(l,t,o){const{width:u,height:m}=t;u===l.width&&m===l.height||(ib(l,t,{x:0,y:0},{x:0,y:0},{width:Math.min(l.width,u),height:Math.min(l.height,m)},o,null),l.width=u,l.height=m,l.data=t.data)}function ib(l,t,o,u,m,h,g,b){if(m.width===0||m.height===0)return t;if(m.width>l.width||m.height>l.height||o.x>l.width-m.width||o.y>l.height-m.height)throw new RangeError("out of range source coordinates for image copy");if(m.width>t.width||m.height>t.height||u.x>t.width-m.width||u.y>t.height-m.height)throw new RangeError("out of range destination coordinates for image copy");const E=l.data,A=t.data,v=h===4&&b;for(let C=0;C<m.height;C++){const I=((o.y+C)*l.width+o.x)*h,S=((u.y+C)*t.width+u.x)*h;if(v)for(let M=0;M<m.width;M++){const R=I+M*h+3,O=S+M*h;A[O+0]=255,A[O+1]=255,A[O+2]=255,A[O+3]=E[R]}else if(g)for(let M=0;M<m.width;M++){const R=I+M*h,O=S+M*h,F=E[R+3],H=new Rr(E[R+0]/255*F,E[R+1]/255*F,E[R+2]/255*F,F).toRenderColor(g).toArray();A[O+0]=H[0],A[O+1]=H[1],A[O+2]=H[2],A[O+3]=H[3]}else for(let M=0;M<m.width*h;M++)A[S+M]=E[I+M]}return t}Yt(hT,"HeatmapBucket",{omit:["layers"]});class iu{constructor(t,o){gT(this,t,1,o)}resize(t){_T(this,new iu(t),1)}clone(){return new iu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,u,m,h){ib(t,o,u,m,h,1,null)}}class So{constructor(t,o){gT(this,t,4,o)}resize(t){_T(this,new So(t),4)}replace(t,o){o?this.data.set(t):this.data=t instanceof Uint8ClampedArray?new Uint8Array(t.buffer):t}clone(){return new So({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(t,o,u,m,h,g,b){ib(t,o,u,m,h,4,g,b)}}class yT{constructor(t,o){this.width=t.width,this.height=t.height,this.data=o instanceof Uint8Array?new Float32Array(o.buffer):o}}function Om(l){const t={},o=l.resolution||256,u=l.clips?l.clips.length:1,m=l.image||new So({width:o,height:u}),h=(g,b,E)=>{t[l.evaluationKey]=E;const A=l.expression.evaluate(t);A&&(m.data[g+b+0]=Math.floor(255*A.r/A.a),m.data[g+b+1]=Math.floor(255*A.g/A.a),m.data[g+b+2]=Math.floor(255*A.b/A.a),m.data[g+b+3]=Math.floor(255*A.a))};if(l.clips)for(let g=0,b=0;g<u;++g,b+=4*o)for(let E=0,A=0;E<o;E++,A+=4){const v=E/(o-1),{start:C,end:I}=l.clips[g];h(b,A,C*(1-v)+I*v)}else for(let g=0,b=0;g<o;g++,b+=4)h(0,b,g/(o-1));return m}Yt(iu,"AlphaImage"),Yt(So,"RGBAImage");const Ck=on([{name:"a_pos",components:2,type:"Int16"}],4),{members:Mk}=Ck;function Fm(l,t,o=2){const u=t&&t.length,m=u?t[0]*o:l.length;let h=vT(l,0,m,o,!0);const g=[];if(!h||h.next===h.prev)return g;let b,E,A;if(u&&(h=function(v,C,I,S){const M=[];for(let R=0,O=C.length;R<O;R++){const F=vT(v,C[R]*S,R<O-1?C[R+1]*S:v.length,S,!1);F===F.next&&(F.steiner=!0),M.push(Dk(F))}M.sort(zk);for(let R=0;R<M.length;R++)I=Lk(M[R],I);return I}(l,t,h,o)),l.length>80*o){b=1/0,E=1/0;let v=-1/0,C=-1/0;for(let I=o;I<m;I+=o){const S=l[I],M=l[I+1];S<b&&(b=S),M<E&&(E=M),S>v&&(v=S),M>C&&(C=M)}A=Math.max(v-b,C-E),A=A!==0?32767/A:0}return Bm(h,g,o,b,E,A,0),g}function vT(l,t,o,u,m){let h;if(m===function(g,b,E,A){let v=0;for(let C=b,I=E-A;C<E;C+=A)v+=(g[I]-g[C])*(g[C+1]+g[I+1]),I=C;return v}(l,t,o,u)>0)for(let g=t;g<o;g+=u)h=wT(g/u|0,l[g],l[g+1],h);else for(let g=o-u;g>=t;g-=u)h=wT(g/u|0,l[g],l[g+1],h);return h&&X0(h,h.next)&&(jm(h),h=h.next),h}function Th(l,t){if(!l)return l;t||(t=l);let o,u=l;do if(o=!1,u.steiner||!X0(u,u.next)&&Oi(u.prev,u,u.next)!==0)u=u.next;else{if(jm(u),u=t=u.prev,u===u.next)break;o=!0}while(o||u!==t);return t}function Bm(l,t,o,u,m,h,g){if(!l)return;!g&&h&&function(E,A,v,C){let I=E;do I.z===0&&(I.z=ob(I.x,I.y,A,v,C)),I.prevZ=I.prev,I.nextZ=I.next,I=I.next;while(I!==E);I.prevZ.nextZ=null,I.prevZ=null,function(S){let M,R=1;do{let O,F=S;S=null;let H=null;for(M=0;F;){M++;let W=F,V=0;for(let Y=0;Y<R&&(V++,W=W.nextZ,W);Y++);let Z=R;for(;V>0||Z>0&&W;)V!==0&&(Z===0||!W||F.z<=W.z)?(O=F,F=F.nextZ,V--):(O=W,W=W.nextZ,Z--),H?H.nextZ=O:S=O,O.prevZ=H,H=O;F=W}H.nextZ=null,R*=2}while(M>1)}(I)}(l,u,m,h);let b=l;for(;l.prev!==l.next;){const E=l.prev,A=l.next;if(h?Pk(l,u,m,h):Ik(l))t.push(E.i,l.i,A.i),jm(l),l=A.next,b=A.next;else if((l=A)===b){g?g===1?Bm(l=Ak(Th(l),t),t,o,u,m,h,2):g===2&&Rk(l,t,o,u,m,h):Bm(Th(l),t,o,u,m,h,1);break}}}function Ik(l){const t=l.prev,o=l,u=l.next;if(Oi(t,o,u)>=0)return!1;const m=t.x,h=o.x,g=u.x,b=t.y,E=o.y,A=u.y,v=m<h?m<g?m:g:h<g?h:g,C=b<E?b<A?b:A:E<A?E:A,I=m>h?m>g?m:g:h>g?h:g,S=b>E?b>A?b:A:E>A?E:A;let M=u.next;for(;M!==t;){if(M.x>=v&&M.x<=I&&M.y>=C&&M.y<=S&&pf(m,b,h,E,g,A,M.x,M.y)&&Oi(M.prev,M,M.next)>=0)return!1;M=M.next}return!0}function Pk(l,t,o,u){const m=l.prev,h=l,g=l.next;if(Oi(m,h,g)>=0)return!1;const b=m.x,E=h.x,A=g.x,v=m.y,C=h.y,I=g.y,S=b<E?b<A?b:A:E<A?E:A,M=v<C?v<I?v:I:C<I?C:I,R=b>E?b>A?b:A:E>A?E:A,O=v>C?v>I?v:I:C>I?C:I,F=ob(S,M,t,o,u),H=ob(R,O,t,o,u);let W=l.prevZ,V=l.nextZ;for(;W&&W.z>=F&&V&&V.z<=H;){if(W.x>=S&&W.x<=R&&W.y>=M&&W.y<=O&&W!==m&&W!==g&&pf(b,v,E,C,A,I,W.x,W.y)&&Oi(W.prev,W,W.next)>=0||(W=W.prevZ,V.x>=S&&V.x<=R&&V.y>=M&&V.y<=O&&V!==m&&V!==g&&pf(b,v,E,C,A,I,V.x,V.y)&&Oi(V.prev,V,V.next)>=0))return!1;V=V.nextZ}for(;W&&W.z>=F;){if(W.x>=S&&W.x<=R&&W.y>=M&&W.y<=O&&W!==m&&W!==g&&pf(b,v,E,C,A,I,W.x,W.y)&&Oi(W.prev,W,W.next)>=0)return!1;W=W.prevZ}for(;V&&V.z<=H;){if(V.x>=S&&V.x<=R&&V.y>=M&&V.y<=O&&V!==m&&V!==g&&pf(b,v,E,C,A,I,V.x,V.y)&&Oi(V.prev,V,V.next)>=0)return!1;V=V.nextZ}return!0}function Ak(l,t){let o=l;do{const u=o.prev,m=o.next.next;!X0(u,m)&&xT(u,o,o.next,m)&&Nm(u,m)&&Nm(m,u)&&(t.push(u.i,o.i,m.i),jm(o),jm(o.next),o=l=m),o=o.next}while(o!==l);return Th(o)}function Rk(l,t,o,u,m,h){let g=l;do{let b=g.next.next;for(;b!==g.prev;){if(g.i!==b.i&&Ok(g,b)){let E=bT(g,b);return g=Th(g,g.next),E=Th(E,E.next),Bm(g,t,o,u,m,h,0),void Bm(E,t,o,u,m,h,0)}b=b.next}g=g.next}while(g!==l)}function zk(l,t){return l.x-t.x}function Lk(l,t){const o=function(m,h){let g=h;const b=m.x,E=m.y;let A,v=-1/0;do{if(E<=g.y&&E>=g.next.y&&g.next.y!==g.y){const R=g.x+(E-g.y)*(g.next.x-g.x)/(g.next.y-g.y);if(R<=b&&R>v&&(v=R,A=g.x<g.next.x?g:g.next,R===b))return A}g=g.next}while(g!==h);if(!A)return null;const C=A,I=A.x,S=A.y;let M=1/0;g=A;do{if(b>=g.x&&g.x>=I&&b!==g.x&&pf(E<S?b:v,E,I,S,E<S?v:b,E,g.x,g.y)){const R=Math.abs(E-g.y)/(b-g.x);Nm(g,m)&&(R<M||R===M&&(g.x>A.x||g.x===A.x&&kk(A,g)))&&(A=g,M=R)}g=g.next}while(g!==C);return A}(l,t);if(!o)return t;const u=bT(o,l);return Th(u,u.next),Th(o,o.next)}function kk(l,t){return Oi(l.prev,l,t.prev)<0&&Oi(t.next,l,l.next)<0}function ob(l,t,o,u,m){return(l=1431655765&((l=858993459&((l=252645135&((l=16711935&((l=(l-o)*m|0)|l<<8))|l<<4))|l<<2))|l<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-u)*m|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Dk(l){let t=l,o=l;do(t.x<o.x||t.x===o.x&&t.y<o.y)&&(o=t),t=t.next;while(t!==l);return o}function pf(l,t,o,u,m,h,g,b){return(m-g)*(t-b)>=(l-g)*(h-b)&&(l-g)*(u-b)>=(o-g)*(t-b)&&(o-g)*(h-b)>=(m-g)*(u-b)}function Ok(l,t){return l.next.i!==t.i&&l.prev.i!==t.i&&!function(o,u){let m=o;do{if(m.i!==o.i&&m.next.i!==o.i&&m.i!==u.i&&m.next.i!==u.i&&xT(m,m.next,o,u))return!0;m=m.next}while(m!==o);return!1}(l,t)&&(Nm(l,t)&&Nm(t,l)&&function(o,u){let m=o,h=!1;const g=(o.x+u.x)/2,b=(o.y+u.y)/2;do m.y>b!=m.next.y>b&&m.next.y!==m.y&&g<(m.next.x-m.x)*(b-m.y)/(m.next.y-m.y)+m.x&&(h=!h),m=m.next;while(m!==o);return h}(l,t)&&(Oi(l.prev,l,t.prev)||Oi(l,t.prev,t))||X0(l,t)&&Oi(l.prev,l,l.next)>0&&Oi(t.prev,t,t.next)>0)}function Oi(l,t,o){return(t.y-l.y)*(o.x-t.x)-(t.x-l.x)*(o.y-t.y)}function X0(l,t){return l.x===t.x&&l.y===t.y}function xT(l,t,o,u){const m=K0(Oi(l,t,o)),h=K0(Oi(l,t,u)),g=K0(Oi(o,u,l)),b=K0(Oi(o,u,t));return m!==h&&g!==b||!(m!==0||!Y0(l,o,t))||!(h!==0||!Y0(l,u,t))||!(g!==0||!Y0(o,l,u))||!(b!==0||!Y0(o,t,u))}function Y0(l,t,o){return t.x<=Math.max(l.x,o.x)&&t.x>=Math.min(l.x,o.x)&&t.y<=Math.max(l.y,o.y)&&t.y>=Math.min(l.y,o.y)}function K0(l){return l>0?1:l<0?-1:0}function Nm(l,t){return Oi(l.prev,l,l.next)<0?Oi(l,t,l.next)>=0&&Oi(l,l.prev,t)>=0:Oi(l,t,l.prev)<0||Oi(l,l.next,t)<0}function bT(l,t){const o=ab(l.i,l.x,l.y),u=ab(t.i,t.x,t.y),m=l.next,h=t.prev;return l.next=t,t.prev=l,o.next=m,m.prev=o,u.next=o,o.prev=u,h.next=u,u.prev=h,u}function wT(l,t,o,u){const m=ab(l,t,o);return u?(m.next=u.next,m.prev=u,u.next.prev=m,u.next=m):(m.prev=m,m.next=m),m}function jm(l){l.next.prev=l.prev,l.prev.next=l.next,l.prevZ&&(l.prevZ.nextZ=l.nextZ),l.nextZ&&(l.nextZ.prevZ=l.prevZ)}function ab(l,t,o){return{i:l,x:t,y:o,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function J0(l,t){const o=l.length;if(o<=1)return[l];const u=[];let m,h;for(let g=0;g<o;g++){const b=Lo(l[g]);b!==0&&(l[g].area=Math.abs(b),h===void 0&&(h=b<0),h===b<0?(m&&u.push(m),m=[l[g]]):m.push(l[g]))}if(m&&u.push(m),t>1)for(let g=0;g<u.length;g++)u[g].length<=t||(Y_(u[g],t,1,u[g].length-1,Fk),u[g]=u[g].slice(0,t));return u}function Fk(l,t){return t.area-l.area}function ST(l,t){if(!l)return null;const o=typeof l=="string"?l:l.getPrimary().id;t[o]||(t[o]=[]);const u=Li.from(l).getPrimary();return t[o].push(u),u.serialize()}function sb(l,t,o){const u=o.patternDependencies;let m=!1;for(const h of t){const g=h.paint.get(`${l}-pattern`);g.isConstant()||(m=!0),ST(g.constantOr(null),u)&&(m=!0)}return m}function lb(l,t,o,u,m){const h=m.patternDependencies;for(const g of t){const b=g.paint.get(`${l}-pattern`).value;if(b.kind!=="constant"){let E=b.evaluate({zoom:u},o,{},m.availableImages);E=E&&E.name?E.name:E;const A=ST(E,h);A&&(o.patterns[g.id]=A)}}return o}class cb{constructor(t){this.zoom=t.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new $s,this.indexArray=new no,this.indexArray2=new Tl,this.programConfigurations=new Il(t.layers,{zoom:t.zoom,lut:t.lut}),this.segments=new ri,this.segments2=new ri,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=t.projection}updateFootprints(t,o){}populate(t,o,u,m){this.hasPattern=sb("fill",this.layers,o);const h=this.layers[0].layout.get("fill-sort-key"),g=[];for(const{feature:b,id:E,index:A,sourceLayerIndex:v}of t){const C=this.layers[0]._featureFilter.needGeometry,I=G(b,C);if(!this.layers[0]._featureFilter.filter(new Vn(this.zoom),I,u))continue;const S=h?h.evaluate(I,{},u,o.availableImages):void 0,M={id:E,properties:b.properties,type:b.type,sourceLayerIndex:v,index:A,geometry:C?I.geometry:B(b,u,m),patterns:{},sortKey:S};g.push(M)}h&&g.sort((b,E)=>b.sortKey-E.sortKey);for(const b of g){const{geometry:E,index:A,sourceLayerIndex:v}=b;if(this.hasPattern){const C=lb("fill",this.layers,b,this.zoom,o);this.patternFeatures.push(C)}else this.addFeature(b,E,A,u,{},o.availableImages,o.brightness);o.featureIndex.insert(t[A].feature,E,A,v,this.index)}}update(t,o,u,m,h,g,b){this.programConfigurations.updatePaintArrays(t,o,h,u,m,g,b)}addFeatures(t,o,u,m,h,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,o,u,m,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Mk),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.indexBuffer2=t.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(t,o,u,m,h,g=[],b){for(const E of J0(o,500)){let A=0;for(const R of E)A+=R.length;const v=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray),C=v.vertexLength,I=[],S=[];for(const R of E){if(R.length===0)continue;R!==E[0]&&S.push(I.length/2);const O=this.segments2.prepareSegment(R.length,this.layoutVertexArray,this.indexArray2),F=O.vertexLength;this.layoutVertexArray.emplaceBack(R[0].x,R[0].y),this.indexArray2.emplaceBack(F+R.length-1,F),I.push(R[0].x),I.push(R[0].y);for(let H=1;H<R.length;H++)this.layoutVertexArray.emplaceBack(R[H].x,R[H].y),this.indexArray2.emplaceBack(F+H-1,F+H),I.push(R[H].x),I.push(R[H].y);O.vertexLength+=R.length,O.primitiveLength+=R.length}const M=Fm(I,S);for(let R=0;R<M.length;R+=3)this.indexArray.emplaceBack(C+M[R],C+M[R+1],C+M[R+2]);v.vertexLength+=A,v.primitiveLength+=M.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,h,g,m,b)}}let ET,TT,CT,MT;Yt(cb,"FillBucket",{omit:["layers","patternFeatures"]});class ub{constructor(t,o,u,m){if(this.triangleCount=o.length/3,this.min=new wt(0,0),this.max=new wt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||t.length===0)return;const[h,g]=[t[0].clone(),t[0].clone()];for(let C=1;C<t.length;++C){const I=t[C];h.x=Math.min(h.x,I.x),h.y=Math.min(h.y,I.y),g.x=Math.max(g.x,I.x),g.y=Math.max(g.y,I.y)}if(m){const C=Math.ceil(Math.max(g.x-h.x,g.y-h.y)/m);u=Math.max(u,C)}if(u===0)return;this.min=h,this.max=g;const b=this.max.sub(this.min);b.x=Math.max(b.x,1),b.y=Math.max(b.y,1);const E=Math.max(b.x,b.y)/u;this.cellsX=Math.max(1,Math.ceil(b.x/E)),this.cellsY=Math.max(1,Math.ceil(b.y/E)),this.xScale=1/E,this.yScale=1/E;const A=[];for(let C=0;C<this.triangleCount;C++){const I=t[o[3*C+0]].sub(this.min),S=t[o[3*C+1]].sub(this.min),M=t[o[3*C+2]].sub(this.min),R=Rl(Math.floor(Math.min(I.x,S.x,M.x)),this.xScale,this.cellsX),O=Rl(Math.floor(Math.max(I.x,S.x,M.x)),this.xScale,this.cellsX),F=Rl(Math.floor(Math.min(I.y,S.y,M.y)),this.yScale,this.cellsY),H=Rl(Math.floor(Math.max(I.y,S.y,M.y)),this.yScale,this.cellsY),W=new wt(0,0),V=new wt(0,0),Z=new wt(0,0),Y=new wt(0,0);for(let ne=F;ne<=H;++ne){W.y=V.y=ne*E,Z.y=Y.y=(ne+1)*E;for(let ye=R;ye<=O;++ye)W.x=Z.x=ye*E,V.x=Y.x=(ye+1)*E,(qe(I,S,M,W,V,Y)||qe(I,S,M,W,Y,Z))&&A.push({cellIdx:ne*this.cellsX+ye,triIdx:C})}}if(A.length===0)return;A.sort((C,I)=>C.cellIdx-I.cellIdx||C.triIdx-I.triIdx);let v=0;for(;v<A.length;){const C=A[v].cellIdx,I={start:this.payload.length,len:0};for(;v<A.length&&A[v].cellIdx===C;)++I.len,this.payload.push(A[v++].triIdx);this.cells[C]=I}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(t,o){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>t.x||t.y>this.max.y||this.min.y>t.y)return;const u=Rl(t.x-this.min.x,this.xScale,this.cellsX),m=Rl(t.y-this.min.y,this.yScale,this.cellsY),h=this.cells[m*this.cellsX+u];if(h){this._lazyInitLookup();for(let g=0;g<h.len;g++){const b=this.payload[h.start+g],E=Math.floor(b/8),A=1<<b%8;if(!(this.lookup[E]&A)&&(this.lookup[E]|=A,o.push(b),o.length===this.triangleCount))return}}}query(t,o,u){if(this.triangleCount===0||this.cells.length===0||t.x>this.max.x||this.min.x>o.x||t.y>this.max.y||this.min.y>o.y)return;this._lazyInitLookup();const m=Rl(t.x-this.min.x,this.xScale,this.cellsX),h=Rl(o.x-this.min.x,this.xScale,this.cellsX),g=Rl(t.y-this.min.y,this.yScale,this.cellsY),b=Rl(o.y-this.min.y,this.yScale,this.cellsY);for(let E=g;E<=b;E++)for(let A=m;A<=h;A++){const v=this.cells[E*this.cellsX+A];if(v)for(let C=0;C<v.len;C++){const I=this.payload[v.start+C],S=Math.floor(I/8),M=1<<I%8;if(!(this.lookup[S]&M)&&(this.lookup[S]|=M,u.push(I),u.length===this.triangleCount))return}}}}function Rl(l,t,o){return Math.max(0,Math.min(o-1,Math.floor(l*t)))}Yt(ub,"TriangleGridIndex");class IT{constructor(t){this.zoom=t.zoom,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.footprints=[]}updateFootprints(t,o){for(const u of this.footprints)o.push({footprint:u,id:t})}populate(t,o,u,m){const h=[];for(const{feature:g,id:b,index:E,sourceLayerIndex:A}of t){const v=this.layers[0]._featureFilter.needGeometry,C=G(g,v);if(!this.layers[0]._featureFilter.filter(new Vn(this.zoom),C,u))continue;const I={id:b,properties:g.properties,type:g.type,sourceLayerIndex:A,index:E,geometry:v?C.geometry:B(g,u,m),patterns:{}};h.push(I)}for(const g of h){const{geometry:b,index:E,sourceLayerIndex:A}=g;this.addFeature(g,b,E,u,{},o.availableImages,o.brightness),o.featureIndex.insert(t[E].feature,b,E,A,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(t){}update(t,o,u,m,h,g,b){}destroy(){}addFeature(t,o,u,m,h,g=[],b){for(const E of J0(o,2)){const A=[],v=[],C=[],I=new wt(1/0,1/0),S=new wt(-1/0,-1/0);for(const O of E)if(O.length!==0){O!==E[0]&&C.push(v.length/2);for(let F=0;F<O.length;F++)v.push(O[F].x),v.push(O[F].y),A.push(O[F]),I.x=Math.min(I.x,O[F].x),I.y=Math.min(I.y,O[F].y),S.x=Math.max(S.x,O[F].x),S.y=Math.max(S.y,O[F].y)}const M=Fm(v,C),R=new ub(A,M,8,256);this.footprints.push({vertices:A,indices:M,grid:R,min:I,max:S})}}}Yt(IT,"ClipBucket",{omit:["layers"]});const Bk=on([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Nk=on([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),jk=on([{name:"a_centroid_pos",components:2,type:"Uint16"}]),$k=on([{name:"a_join_normal_inside",components:3,type:"Int16"}]),Vk=on([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),Uk=on([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Gk}=Bk;var hb,PT,db,AT,fb,RT,zT,Q0={};function LT(){if(PT)return hb;PT=1;var l=pn();function t(m,h,g,b,E){this.properties={},this.extent=g,this.type=0,this._pbf=m,this._geometry=-1,this._keys=b,this._values=E,m.readFields(o,this,h)}function o(m,h,g){m==1?h.id=g.readVarint():m==2?function(b,E){for(var A=b.readVarint()+b.pos;b.pos<A;){var v=E._keys[b.readVarint()],C=E._values[b.readVarint()];E.properties[v]=C}}(g,h):m==3?h.type=g.readVarint():m==4&&(h._geometry=g.pos)}function u(m){for(var h,g,b=0,E=0,A=m.length,v=A-1;E<A;v=E++)b+=((g=m[v]).x-(h=m[E]).x)*(h.y+g.y);return b}return hb=t,t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var m=this._pbf;m.pos=this._geometry;for(var h,g=m.readVarint()+m.pos,b=1,E=0,A=0,v=0,C=[];m.pos<g;){if(E<=0){var I=m.readVarint();b=7&I,E=I>>3}if(E--,b===1||b===2)A+=m.readSVarint(),v+=m.readSVarint(),b===1&&(h&&C.push(h),h=[]),h.push(new l(A,v));else{if(b!==7)throw new Error("unknown command "+b);h&&h.push(h[0].clone())}}return h&&C.push(h),C},t.prototype.bbox=function(){var m=this._pbf;m.pos=this._geometry;for(var h=m.readVarint()+m.pos,g=1,b=0,E=0,A=0,v=1/0,C=-1/0,I=1/0,S=-1/0;m.pos<h;){if(b<=0){var M=m.readVarint();g=7&M,b=M>>3}if(b--,g===1||g===2)(E+=m.readSVarint())<v&&(v=E),E>C&&(C=E),(A+=m.readSVarint())<I&&(I=A),A>S&&(S=A);else if(g!==7)throw new Error("unknown command "+g)}return[v,I,C,S]},t.prototype.toGeoJSON=function(m,h,g){var b,E,A=this.extent*Math.pow(2,g),v=this.extent*m,C=this.extent*h,I=this.loadGeometry(),S=t.types[this.type];function M(F){for(var H=0;H<F.length;H++){var W=F[H];F[H]=[360*(W.x+v)/A-180,360/Math.PI*Math.atan(Math.exp((180-360*(W.y+C)/A)*Math.PI/180))-90]}}switch(this.type){case 1:var R=[];for(b=0;b<I.length;b++)R[b]=I[b][0];M(I=R);break;case 2:for(b=0;b<I.length;b++)M(I[b]);break;case 3:for(I=function(F){var H=F.length;if(H<=1)return[F];for(var W,V,Z=[],Y=0;Y<H;Y++){var ne=u(F[Y]);ne!==0&&(V===void 0&&(V=ne<0),V===ne<0?(W&&Z.push(W),W=[F[Y]]):W.push(F[Y]))}return W&&Z.push(W),Z}(I),b=0;b<I.length;b++)for(E=0;E<I[b].length;E++)M(I[b][E])}I.length===1?I=I[0]:S="Multi"+S;var O={type:"Feature",geometry:{type:S,coordinates:I},properties:this.properties};return"id"in this&&(O.id=this.id),O},hb}function kT(){if(AT)return db;AT=1;var l=LT();function t(u,m){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=u,this._keys=[],this._values=[],this._features=[],u.readFields(o,this,m),this.length=this._features.length}function o(u,m,h){u===15?m.version=h.readVarint():u===1?m.name=h.readString():u===5?m.extent=h.readVarint():u===2?m._features.push(h.pos):u===3?m._keys.push(h.readString()):u===4&&m._values.push(function(g){for(var b=null,E=g.readVarint()+g.pos;g.pos<E;){var A=g.readVarint()>>3;b=A===1?g.readString():A===2?g.readFloat():A===3?g.readDouble():A===4?g.readVarint64():A===5?g.readVarint():A===6?g.readSVarint():A===7?g.readBoolean():null}return b}(h))}return db=t,t.prototype.feature=function(u){if(u<0||u>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[u];var m=this._pbf.readVarint()+this._pbf.pos;return new l(this._pbf,m,this.extent,this._keys,this._values)},db}function DT(){return zT||(zT=1,Q0.VectorTile=function(){if(RT)return fb;RT=1;var l=kT();function t(o,u,m){if(o===3){var h=new l(m,m.readVarint()+m.pos);h.length&&(u[h.name]=h)}}return fb=function(o,u){this.layers=o.readFields(t,{},u)},fb}(),Q0.VectorTileFeature=LT(),Q0.VectorTileLayer=kT()),Q0}var mf=DT();class Ch extends wt{constructor(t,o,u){super(t,o),this.z=u}}class OT extends Ch{constructor(t,o,u,m){super(t,o,u),this.w=m}}function ey(l,t,o,u){const m=[],h=u===0?(g,b,E,A,v,C)=>{g.push(new wt(C,E+(C-b)/(A-b)*(v-E)))}:(g,b,E,A,v,C)=>{g.push(new wt(b+(C-E)/(v-E)*(A-b),C))};for(const g of l){const b=[];for(const E of g){if(E.length<=2)continue;const A=[];for(let I=0;I<E.length-1;I++){const S=E[I].x,M=E[I].y,R=E[I+1].x,O=E[I+1].y,F=u===0?S:M,H=u===0?R:O;F<t?H>t&&h(A,S,M,R,O,t):F>o?H<o&&h(A,S,M,R,O,o):A.push(E[I]),H<t&&F>=t&&h(A,S,M,R,O,t),H>o&&F<=o&&h(A,S,M,R,O,o)}let v=E[E.length-1];const C=u===0?v.x:v.y;C>=t&&C<=o&&A.push(v),A.length&&(v=A[A.length-1],A[0].x===v.x&&A[0].y===v.y||A.push(A[0]),b.push(A))}b.length&&m.push(b)}return m}function FT(l,t,o,u){const m=o==="x"?"y":"x",h=(u-l[o])/(t[o]-l[o]);l[m]=l[m]+(t[m]-l[m])*h,l[o]=u,l.hasOwnProperty("z")&&(l.z=ur(l.z,t.z,h)),l.hasOwnProperty("w")&&(l.w=ur(l.w,t.w,h))}function BT(l,t,o,u){const m=o,h=u;for(const g of["x","y"]){let b=l,E=t;b[g]>=E[g]&&(b=t,E=l),b[g]<m&&E[g]>m&&FT(b,E,g,m),b[g]<h&&E[g]>h&&FT(E,b,g,h)}}const ty=Number.MAX_SAFE_INTEGER;function NT(l,t,o,u){return l.order<t||l.order===ty||!(l.clipMask&o)||function(m,h){return h.length!==0&&h.find(g=>g===m)===void 0}(u,l.clipScope)}function ry(l,t){return l.x-t.x||l.y-t.y}function jT(l,t){return ry(l.min,t.min)===0&&ry(l.max,t.max)===0}function pb(l,t){return!(l.min.x>t.max.x||l.max.x<t.min.x||l.min.y>t.max.y||l.max.y<t.min.y)}function mb(l,t){if(l.length!==t.length)return!1;for(let o=0;o<l.length;o++)if(l[o].sourceId!==t[o].sourceId||!jT(l[o],t[o])||l[o].order!==t[o].order||l[o].clipMask!==t[o].clipMask||!Pr(l[o].clipScope,t[o].clipScope))return!1;return!0}function $T(l,t,o){const u=1/Nt,m=1/(1<<o.canonical.z),h=(t.x*u+o.canonical.x)*m+o.wrap,g=(t.y*u+o.canonical.y)*m;return{min:new wt((l.x*u+o.canonical.x)*m+o.wrap,(l.y*u+o.canonical.y)*m),max:new wt(h,g)}}function Hk(l,t,o){const u=1<<o.canonical.z,m=((t.x-o.wrap)*u-o.canonical.x)*Nt,h=(t.y*u-o.canonical.y)*Nt;return{min:new wt(((l.x-o.wrap)*u-o.canonical.x)*Nt,(l.y*u-o.canonical.y)*Nt),max:new wt(m,h)}}function VT(l,t,o,u,m,h,g){const b=l.indices,E=l.vertices,A=[];for(let v=u;v<u+m;v+=3){const C=t[o[v+0]+h],I=t[o[v+1]+h],S=t[o[v+2]+h],M=Math.min(C.x,I.x,S.x),R=Math.max(C.x,I.x,S.x),O=Math.min(C.y,I.y,S.y),F=Math.max(C.y,I.y,S.y);A.length=0,l.grid.query(new wt(M,O),new wt(R,F),A);for(let H=0;H<A.length;H++){const W=A[H];if(qe(E[b[3*W+0]],E[b[3*W+1]],E[b[3*W+2]],C,I,S,g))return!0}}return!1}function UT(l,t,o,u){if(!l||!o)return!1;let m=l.vertices;if(!t.canonical.equals(u.canonical)||t.wrap!==u.wrap){if(o.vertices.length<l.vertices.length)return UT(o,u,l,t);const h=t.canonical,g=u.canonical,b=Math.pow(2,g.z-h.z);m=l.vertices.map(E=>new wt((E.x+h.x*Nt)*b-g.x*Nt,(E.y+h.y*Nt)*b-g.y*Nt))}return VT(o,m,l.indices,0,l.indices.length,0,0)}function GT(l,t,o,u){const m=Math.pow(2,u.z-o.z);return new wt((l+o.x*Nt)*m-u.x*Nt,(t+o.y*Nt)*m-u.y*Nt)}function HT(l,t){const o=[];t.grid.queryPoint(l,o);const u=t.indices,m=t.vertices;for(let h=0;h<o.length;h++){const g=o[h];if($e([m[u[3*g+0]],m[u[3*g+1]],m[u[3*g+2]]],l))return!0}return!1}const gb=[new wt(0,0),new wt(Nt,0),new wt(Nt,Nt),new wt(0,Nt)];function WT(l,t){const o=[];let u=[];if(!t||l.length<2)return[l];if(l.length===2)return rt(l[0],l[1],gb)?[l]:[];for(let m=0;m<l.length+2;m++){const h=l[m%l.length],g=l[(m+1)%l.length],b=rt(m===0?l[l.length-1]:l[(m-1)%l.length],h,gb),E=rt(h,g,gb),A=b||E;A&&u.push(h),A&&E||u.length>0&&(u.length>1&&o.push(u),u=[])}return u.length>1&&o.push(u),o}const _b=mf.VectorTileFeature.types,Wk=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],qk=["fill-extrusion-flood-light-ground-radius"],Zk=Math.pow(2,13),Xk=Math.pow(2,15)-1,qT=new wt(0,1),ou=2147483648;function $m(l,t,o,u,m,h,g,b){l.emplaceBack((t<<1)+g,(o<<1)+h,(Math.floor(u*Zk)<<1)+m,Math.round(b))}function Vm(l,t,o){l.emplaceBack(t.x*Nt,t.y*Nt,o?1:0)}function ny(l,t,o,u,m,h){l.emplaceBack(t.x,t.y,(o.x<<1)+u,(o.y<<1)+m,h)}function Um(l,t,o){l.emplaceBack(t.x,t.y,t.z,o[0]*16384,o[1]*16384,o[2]*16384)}class ZT{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class XT{constructor(){this.centroidXY=new wt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new wt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new wt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new wt(this.max.x-this.min.x,this.max.y-this.min.y)}}class YT{constructor(){this.acc=new wt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(t,o){t.min.x===Number.MAX_VALUE&&(t.min.x=t.max.x=o.x,t.min.y=t.max.y=o.y)}appendEdge(t,o,u){this.accCount++,this.acc._add(o);let m=!!this.borders;o.x<t.min.x?(t.min.x=o.x,m=!0):o.x>t.max.x&&(t.max.x=o.x,m=!0),o.y<t.min.y?(t.min.y=o.y,m=!0):o.y>t.max.y&&(t.max.y=o.y,m=!0),((o.x===0||o.x===Nt)&&o.x===u.x)!=((o.y===0||o.y===Nt)&&o.y===u.y)&&this.processBorderOverlap(o,u),m&&this.checkBorderIntersection(o,u)}checkBorderIntersection(t,o){o.x<0!=t.x<0&&this.addBorderIntersection(0,ur(o.y,t.y,(0-o.x)/(t.x-o.x))),o.x>Nt!=t.x>Nt&&this.addBorderIntersection(1,ur(o.y,t.y,(Nt-o.x)/(t.x-o.x))),o.y<0!=t.y<0&&this.addBorderIntersection(2,ur(o.x,t.x,(0-o.y)/(t.y-o.y))),o.y>Nt!=t.y>Nt&&this.addBorderIntersection(3,ur(o.x,t.x,(Nt-o.y)/(t.y-o.y)))}addBorderIntersection(t,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const u=this.borders[t];o<u[0]&&(u[0]=o),o>u[1]&&(u[1]=o)}processBorderOverlap(t,o){if(t.x===o.x){if(t.y===o.y)return;const u=t.x===0?0:1;this.addBorderIntersection(u,o.y),this.addBorderIntersection(u,t.y)}else{const u=t.y===0?2:3;this.addBorderIntersection(u,o.x),this.addBorderIntersection(u,t.x)}}centroid(){return this.accCount===0?new wt(0,0):new wt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((t,o)=>t+ +(o[0]!==Number.MAX_VALUE),0):0}}function KT(l,t){const o=l.add(t)._unit(),u=Jt(l.x*o.x+l.y*o.y,-1,1);var m,h,g;return g=Math.acos(u),Math.min(4,Math.max(-4,Math.tan(g)))/4*Xk*((m=l).x*(h=t).y-m.y*h.x<0?-1:1)}const Yk=[l=>l.x<0,l=>l.x>Nt,l=>l.y<0,l=>l.y>Nt];function Kk(l,t,o,u){const m=[4];if(u===0)return m;o._mult(u);const h=l.sub(o),g=t.sub(o),b=[l,t,h,g];for(let E=0;E<4;E++)for(const A of b)if(Yk[E](A)){m.push(E);break}return m}class JT{constructor(t){this.vertexArray=new Sa,this.indexArray=new no,this.programConfigurations=new Il(t.layers,{zoom:t.zoom,lut:t.lut},o=>qk.includes(o)),this._segments=new ri,this.hiddenByLandmarkVertexArray=new eu,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new ri}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(t,o,u,m=!1){const h=t.length;if(h>2){let g=Math.max(0,this._segments.get().length-1);const b=this._segments._prepareSegment(4*h,this.vertexArray.length,2*this._segmentToGroundQuads[g].length);let E;g!==this._segments.get().length-1&&(g++,this._segmentToGroundQuads[g]=[],this._segmentToRegionTriCounts[g]=[0,0,0,0,0]);{const A=t[0],v=t[1];E=KT(A.sub(t[h-1])._perp()._unit(),v.sub(A)._perp()._unit())}for(let A=0;A<h;A++){const v=A===h-1?0:A+1,C=t[A],I=t[v],S=t[v===h-1?0:v+1],M=I.sub(C)._perp()._unit(),R=KT(M,S.sub(I)._perp()._unit()),O=E,F=R;if(yb(C,I,o)||m&&tC(C,o)&&tC(I,o)){E=R;continue}const H=b.vertexLength;ny(this.vertexArray,C,I,1,1,O),ny(this.vertexArray,C,I,1,0,O),ny(this.vertexArray,C,I,0,1,F),ny(this.vertexArray,C,I,0,0,F),b.vertexLength+=4;const W=Kk(C,I,M,u);for(const V of W)this._segmentToGroundQuads[g].push({id:H,region:V}),this._segmentToRegionTriCounts[g][V]+=2,b.primitiveLength+=2;E=R}}}prepareBorderSegments(){if(!this.hasData())return;const t=this._segments.get(),o=t.length;for(let u=0;u<o;u++)this._segmentToGroundQuads[u].sort((m,h)=>m.region-h.region);for(let u=0;u<o;u++){const m=this._segmentToGroundQuads[u],h=t[u],g=this._segmentToRegionTriCounts[u];g.reduce((E,A)=>E+A,0);let b=0;for(let E=0;E<=4;E++){const A=g[E];if(A!==0){let v=this.regionSegments[E];v||(v=this.regionSegments[E]=new ri);const C={vertexOffset:h.vertexOffset,primitiveOffset:h.primitiveOffset+b,vertexLength:h.vertexLength,primitiveLength:A};v.get().push(C)}b+=A}for(let E=0;E<m.length;E++){const A=m[E].id;this.indexArray.emplaceBack(A,A+1,A+3),this.indexArray.emplaceBack(A,A+3,A+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(t,o,u,m,h,g){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,t,o,u,m,h,g)}upload(t){this.hasData()&&(this.vertexBuffer=t.createVertexBuffer(this.vertexArray,Nk.members),this.indexBuffer=t.createIndexBuffer(this.indexArray))}uploadPaintProperties(t){this.hasData()&&this.programConfigurations.upload(t)}update(t,o,u,m,h,g,b){this.hasData()&&this.programConfigurations.updatePaintArrays(t,o,u,m,h,g,b)}updateHiddenByLandmark(t){if(!this.hasData())return;const o=t.groundVertexCount+t.groundVertexArrayOffset;if(t.groundVertexCount===0)return;const u=t.flags&ou?1:0;for(let m=t.groundVertexArrayOffset;m<o;++m)this.hiddenByLandmarkVertexArray.emplace(m,u);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(t){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=t.createVertexBuffer(this.hiddenByLandmarkVertexArray,Vk.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let t=0;t<=4;t++){const o=this.regionSegments[t];o&&o.destroy()}}}}class iy{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=t.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new no,this.footprintVertices=new $s,this.footprintSegments=[],this.layoutVertexArray=new Qc,this.centroidVertexArray=new V0,this.wallVertexArray=new G0,this.indexArray=new no,this.programConfigurations=new Il(t.layers,{zoom:t.zoom,lut:t.lut},o=>Wk.includes(o)),this.segments=new ri,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.groundEffect=new JT(t),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[]}updateFootprints(t,o){}populate(t,o,u,m){this.features=[],this.hasPattern=sb("fill-extrusion",this.layers,o),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=p(u),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:h,id:g,index:b,sourceLayerIndex:E}of t){const A=this.layers[0]._featureFilter.needGeometry,v=G(h,A);if(!this.layers[0]._featureFilter.filter(new Vn(this.zoom),v,u))continue;const C={id:g,sourceLayerIndex:E,index:b,geometry:A?v.geometry:B(h,u,m),properties:h.properties,type:h.type,patterns:{}},I=this.layoutVertexArray.length,S=_b[C.type]==="Polygon";if(this.hasPattern)this.features.push(lb("fill-extrusion",this.layers,C,this.zoom,o));else if(this.wallMode)for(const M of C.geometry)for(const R of WT(M,S))this.addFeature(C,[R],b,u,{},o.availableImages,m,o.brightness);else this.addFeature(C,C.geometry,b,u,{},o.availableImages,m,o.brightness);o.featureIndex.insert(h,C.geometry,b,E,this.index,I)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(t,o,u,m,h,g){for(const b of this.features){const E=_b[b.type]==="Polygon",{geometry:A}=b;if(this.wallMode)for(const v of A)for(const C of WT(v,E))this.addFeature(b,[C],b.index,o,u,m,h,g);else this.addFeature(b,A,b.index,o,u,m,h,g)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(t,o,u,m,h,g,b){this.programConfigurations.updatePaintArrays(t,o,h,u,m,g,b),this.groundEffect.update(t,o,h,u,m,g,b)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,Gk),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.wallVertexBuffer=t.createVertexBuffer(this.wallVertexArray,$k.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=t.createVertexBuffer(this.layoutVertexExtArray,Uk.members,!0)),this.groundEffect.upload(t)),this.groundEffect.uploadPaintProperties(t),this.programConfigurations.upload(t),this.uploaded=!0}uploadCentroid(t){this.groundEffect.uploadHiddenByLandmark(t),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=t.createVertexBuffer(this.centroidVertexArray,jk.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(t,o,u,m,h,g,b,E){const A=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(t,{})/this.tileToMeter,v=[new wt(0,0),new wt(Nt,Nt)],C=b.projection,I=C.name==="globe",S=this.wallMode||_b[t.type]==="Polygon",M=new YT;M.centroidDataIndex=this.centroidData.length;const R=new XT,O=this.layers[0].paint.get("fill-extrusion-base").evaluate(t,{},m)<=0,F=this.layers[0].paint.get("fill-extrusion-height").evaluate(t,{},m);let H;if(R.height=F,R.vertexArrayOffset=this.layoutVertexArray.length,R.groundVertexArrayOffset=this.groundEffect.vertexArray.length,I&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Kd),this.wallMode){if(I)return void gr("Non zero fill-extrusion-line-width is not yet supported on globe.");if(o.length!==1)return;H=function(ge){const Re=ge[0].x===ge[ge.length-1].x&&ge[0].y===ge[ge.length-1].y;(function($t){let _t=0;const er=$t.length;for(let Ot=0;Ot<er;Ot++)_t+=($t[(Ot+1)%er].x-$t[Ot].x)*($t[(Ot+1)%er].y+$t[Ot].y);return _t>=0})(ge)||(ge=ge.reverse());const Le={geometry:[],joinNormals:[],indices:[]},Be=[],Oe=[],Ve=[];let We=ge.length;for(;We>=2&&ge[We-1].equals(ge[We-2]);)We--;if(We<(Re?3:2))return Le;let Qe,Ge,ut,It,dt,Dt=0;for(;Dt<We-1&&ge[Dt].equals(ge[Dt+1]);)Dt++;Re&&(Qe=ge[We-2],dt=ge[Dt].sub(Qe)._unit()._perp());for(let $t=Dt;$t<We;$t++){if(ut=$t===We-1?Re?ge[Dt+1]:void 0:ge[$t+1],ut&&ge[$t].equals(ut))continue;dt&&(It=dt),Qe&&(Ge=Qe),Qe=ge[$t],dt=ut?ut.sub(Qe)._unit()._perp():It,It=It||dt;let _t=It.add(dt);_t.x===0&&_t.y===0||_t._unit();const er=_t.x*dt.x+_t.y*dt.y,Ot=er!==0?1/er:1/0,Kt=It.x*dt.y-It.y*dt.x>0;let hr="miter";const Ar=2;hr==="miter"&&Ot>Ar&&(hr="bevel"),hr==="bevel"&&(Ot>100&&(hr="flipbevel"),Ot<Ar&&(hr="miter"));const kr=(jr,Dr,Zr,Cn)=>{const vn=new wt(jr.x,jr.y),Tr=new wt(jr.x,jr.y);vn.x+=Dr.x*Cn,vn.y+=Dr.y*Cn,Tr.x-=Dr.x*Math.max(Zr,1),Tr.y-=Dr.y*Math.max(Zr,1),Ve.push(Dr),Be.push(vn),Oe.push(Tr)};if(hr==="miter")_t._mult(Ot),kr(Qe,_t,0,0);else if(hr==="flipbevel")_t=dt.mult(-1),kr(Qe,_t,0,0),kr(Qe,_t.mult(-1),0,0);else{const jr=-Math.sqrt(Ot*Ot-1),Dr=Kt?jr:0,Zr=Kt?0:jr;Ge&&kr(Qe,It,Dr,Zr),ut&&kr(Qe,dt,Dr,Zr)}}Le.geometry=[...Be,...Oe.reverse(),Be[0]],Le.joinNormals=[...Ve,...Ve.reverse(),Ve[Ve.length-1]];const kt=Le.geometry.length-1;for(let $t=0;$t<kt/2;$t++)if($t+1<kt/2){let _t=$t,er=$t+1,Ot=kt-1-$t,Kt=kt-2-$t;_t=_t===0?kt-1:_t-1,er=er===0?kt-1:er-1,Ot=Ot===0?kt-1:Ot-1,Kt=Kt===0?kt-1:Kt-1,Le.indices.push(Ot),Le.indices.push(er),Le.indices.push(_t),Le.indices.push(Ot),Le.indices.push(Kt),Le.indices.push(er)}return Le}(o[0]),o=[H.geometry]}const W=(ge,Re)=>ge<(Re.length-1)/2||ge===Re.length-1,V=this.wallMode?[o]:J0(o,500);for(let ge=V.length-1;ge>=0;ge--){const Re=V[ge];(Re.length===0||(Z=Re[0]).every(we=>we.x<=0)||Z.every(we=>we.x>=Nt)||Z.every(we=>we.y<=0)||Z.every(we=>we.y>=Nt))&&V.splice(ge,1)}var Z;let Y;if(I)Y=oC(V,v,m);else{Y=[];for(const ge of V)Y.push({polygon:ge,bounds:v})}const ne=S?this.edgeRadius:0,ye=ne>0&&this.zoom<17,_e=(ge,Re)=>{if(ge.length===0)return!1;const we=ge[ge.length-1];return Re.x===we.x&&Re.y===we.y};for(const{polygon:ge,bounds:Re}of Y){let we=0,Le=0;for(const We of ge)S&&!We[0].equals(We[We.length-1])&&We.push(We[0]),Le+=S?We.length-1:We.length;const Be=this.segments.prepareSegment((S?5:4)*Le,this.layoutVertexArray,this.indexArray);R.footprintSegIdx<0&&(R.footprintSegIdx=this.footprintSegments.length),R.polygonSegIdx<0&&(R.polygonSegIdx=this.polygonSegments.length);const Oe={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},Ve=new ZT;if(Ve.vertexOffset=this.footprintVertices.length,Ve.indexOffset=3*this.footprintIndices.length,Ve.ringIndices=[],S){const We=[],Qe=[];we=Be.vertexLength;for(let ut=0;ut<ge.length;ut++){const It=ge[ut];It.length&&ut!==0&&Qe.push(We.length/2);const dt=[];let Dt,kt;Dt=It[1].sub(It[0])._perp()._unit(),Ve.ringIndices.push(It.length-1);for(let $t=1;$t<It.length;$t++){const _t=It[$t],er=It[$t===It.length-1?1:$t+1],Ot=_t.clone();if(ne){kt=er.sub(_t)._perp()._unit();const Kt=Dt.add(kt)._unit(),hr=ne*Math.min(4,1/(Dt.x*Kt.x+Dt.y*Kt.y));Ot.x+=hr*Kt.x,Ot.y+=hr*Kt.y,Ot.x=Math.round(Ot.x),Ot.y=Math.round(Ot.y),Dt=kt}if(!O||ne!==0&&!ye||_e(dt,Ot)||dt.push(Ot),$m(this.layoutVertexArray,Ot.x,Ot.y,0,0,1,1,0),this.wallMode){const Kt=W($t,It);Vm(this.wallVertexArray,H.joinNormals[$t],!Kt)}Be.vertexLength++,this.footprintVertices.emplaceBack(_t.x,_t.y),We.push(_t.x,_t.y),I&&Um(this.layoutVertexExtArray,C.projectTilePoint(Ot.x,Ot.y,m),C.upVector(m,Ot.x,Ot.y))}O&&(ne===0||ye)&&(dt.length!==0&&_e(dt,dt[0])&&dt.pop(),this.groundEffect.addData(dt,Re,A))}const Ge=this.wallMode?H.indices:Fm(We,Qe);for(let ut=0;ut<Ge.length;ut+=3)this.footprintIndices.emplaceBack(Ve.vertexOffset+Ge[ut+0],Ve.vertexOffset+Ge[ut+1],Ve.vertexOffset+Ge[ut+2]),this.indexArray.emplaceBack(we+Ge[ut],we+Ge[ut+2],we+Ge[ut+1]),Be.primitiveLength++;Ve.indexCount+=Ge.length,Ve.vertexCount+=this.footprintVertices.length-Ve.vertexOffset}for(let We=0;We<ge.length;We++){const Qe=ge[We];M.startRing(R,Qe[0]);let Ge=Qe.length>4&&rC(Qe[Qe.length-2],Qe[0],Qe[1]),ut=ne?Jk(Qe[Qe.length-2],Qe[0],Qe[1],ne):0;const It=[];let dt,Dt,kt;Dt=Qe[1].sub(Qe[0])._perp()._unit();let $t=!0;for(let _t=1,er=0;_t<Qe.length;_t++){let Ot=Qe[_t-1],Kt=Qe[_t];const hr=Qe[_t===Qe.length-1?1:_t+1];if(M.appendEdge(R,Kt,Ot),yb(Kt,Ot,Re)){ne&&(Dt=hr.sub(Kt)._perp()._unit(),$t=!$t);continue}const Ar=Kt.sub(Ot)._perp(),kr=Ar.x/(Math.abs(Ar.x)+Math.abs(Ar.y)),jr=Ar.y>0?1:0,Dr=Ot.dist(Kt);if(er+Dr>32768&&(er=0),ne){kt=hr.sub(Kt)._perp()._unit();let Tr=eC(Ot,Kt,hr,QT(Dt,kt),ne);isNaN(Tr)&&(Tr=0);const xn=Kt.sub(Ot)._unit();Ot=Ot.add(xn.mult(ut))._round(),Kt=Kt.add(xn.mult(-Tr))._round(),ut=Tr,Dt=kt,O&&this.zoom>=17&&(_e(It,Ot)||It.push(Ot),_e(It,Kt)||It.push(Kt))}const Zr=Be.vertexLength,Cn=Qe.length>4&&rC(Ot,Kt,hr);let vn=nC(er,Ge,$t);if($m(this.layoutVertexArray,Ot.x,Ot.y,kr,jr,0,0,vn),$m(this.layoutVertexArray,Ot.x,Ot.y,kr,jr,0,1,vn),this.wallMode){const Tr=W(_t-1,Qe),xn=H.joinNormals[_t-1];Vm(this.wallVertexArray,xn,Tr),Vm(this.wallVertexArray,xn,Tr)}if(er+=Dr,vn=nC(er,Cn,!$t),Ge=Cn,$m(this.layoutVertexArray,Kt.x,Kt.y,kr,jr,0,0,vn),$m(this.layoutVertexArray,Kt.x,Kt.y,kr,jr,0,1,vn),this.wallMode){const Tr=W(_t,Qe),xn=H.joinNormals[_t];Vm(this.wallVertexArray,xn,Tr),Vm(this.wallVertexArray,xn,Tr)}if(Be.vertexLength+=4,this.indexArray.emplaceBack(Zr+0,Zr+1,Zr+2),this.indexArray.emplaceBack(Zr+1,Zr+3,Zr+2),Be.primitiveLength+=2,ne){const Tr=we+(_t===1?Qe.length-2:_t-2),xn=_t===1?we:Tr+1;if(this.indexArray.emplaceBack(Zr+1,Tr,Zr+3),this.indexArray.emplaceBack(Tr,xn,Zr+3),Be.primitiveLength+=2,dt===void 0&&(dt=Zr),!yb(hr,Qe[_t],Re)){const mn=_t===Qe.length-1?dt:Be.vertexLength;this.indexArray.emplaceBack(Zr+2,Zr+3,mn),this.indexArray.emplaceBack(Zr+3,mn+1,mn),this.indexArray.emplaceBack(Zr+3,xn,mn+1),Be.primitiveLength+=3}$t=!$t}if(I){const Tr=this.layoutVertexExtArray,xn=C.projectTilePoint(Ot.x,Ot.y,m),mn=C.projectTilePoint(Kt.x,Kt.y,m),Mn=C.upVector(m,Ot.x,Ot.y),Ti=C.upVector(m,Kt.x,Kt.y);Um(Tr,xn,Mn),Um(Tr,xn,Mn),Um(Tr,mn,Ti),Um(Tr,mn,Ti)}}S&&(we+=Qe.length-1),O&&ne&&this.zoom>=17&&(It.length!==0&&_e(It,It[0])&&It.pop(),this.groundEffect.addData(It,Re,A,ne>0))}this.footprintSegments.push(Ve),Oe.triangleCount=this.indexArray.length-Oe.triangleArrayOffset,this.polygonSegments.push(Oe),++R.footprintSegLen,++R.polygonSegLen}if(R.vertexCount=this.layoutVertexArray.length-R.vertexArrayOffset,R.groundVertexCount=this.groundEffect.vertexArray.length-R.groundVertexArrayOffset,R.vertexCount!==0){if(R.centroidXY=M.borders?qT:this.encodeCentroid(M,R),this.centroidData.push(R),M.borders){this.featuresOnBorder.push(M);const ge=this.featuresOnBorder.length-1;for(let Re=0;Re<M.borders.length;Re++)M.borders[Re][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[Re].push(ge)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,h,g,m,E),this.groundEffect.addPaintPropertiesData(t,u,h,g,m,E),this.maxHeight=Math.max(this.maxHeight,F)}}sortBorders(){for(let t=0;t<this.borderFeatureIndices.length;t++)this.borderFeatureIndices[t].sort((o,u)=>this.featuresOnBorder[o].borders[t][0]-this.featuresOnBorder[u].borders[t][0])}splitToSubtiles(){const t=[];for(let b=0;b<this.centroidData.length;b++){const E=this.centroidData[b],A=+(E.min.y+E.max.y>Nt),v=2*A+(+(E.min.x+E.max.x>Nt)^A);for(let C=0;C<E.polygonSegLen;C++){const I=E.polygonSegIdx+C;t.push({centroidIdx:b,subtile:v,polygonSegmentIdx:I,triangleSegmentIdx:this.polygonSegments[I].triangleSegIdx})}}const o=new no;t.sort((b,E)=>b.triangleSegmentIdx===E.triangleSegmentIdx?b.subtile-E.subtile:b.triangleSegmentIdx-E.triangleSegmentIdx);let u=0,m=0,h=0;for(const b of t){if(b.triangleSegmentIdx!==u)break;h++}const g=t.length;for(;m!==t.length;){u=t[m].triangleSegmentIdx;let b=0,E=m,A=m;for(let v=E;v<h&&t[v].subtile===b;v++)A++;for(;E!==h;){const v=t[E];b=v.subtile;const C=this.centroidData[v.centroidIdx].min.clone(),I=this.centroidData[v.centroidIdx].max.clone(),S={vertexOffset:this.segments.segments[u].vertexOffset,primitiveOffset:o.length,vertexLength:this.segments.segments[u].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let M=E;M<A;M++){const R=t[M],O=this.polygonSegments[R.polygonSegmentIdx],F=this.centroidData[R.centroidIdx].min,H=this.centroidData[R.centroidIdx].max,W=this.indexArray.uint16;for(let V=O.triangleArrayOffset;V<O.triangleArrayOffset+O.triangleCount;V++)o.emplaceBack(W[3*V],W[3*V+1],W[3*V+2]);S.primitiveLength+=O.triangleCount,C.x=Math.min(C.x,F.x),C.y=Math.min(C.y,F.y),I.x=Math.max(I.x,H.x),I.y=Math.max(I.y,H.y)}S.primitiveLength>0&&this.triangleSubSegments.push({segment:S,min:C,max:I}),E=A;for(let M=E;M<h&&t[M].subtile===t[E].subtile;M++)A++}m=h;for(let v=m;v<g&&t[v].triangleSegmentIdx===t[m].triangleSegmentIdx;v++)h++}o._trim(),this.indexArray=o}getVisibleSegments(t,o,u){const m=new ri;if(this.wallMode){for(const R of this.triangleSubSegments)m.segments.push(R.segment);return m}let h=0,g=0;const b=1<<t.canonical.z;if(o){const R=o.getMinMaxForTile(t);R&&(h=R.min,g=R.max)}g+=this.maxHeight;const E=t.toUnwrapped();let A;const v=[E.canonical.x/b+E.wrap,E.canonical.y/b],C=[(E.canonical.x+1)/b+E.wrap,(E.canonical.y+1)/b],I=(R,O,F)=>[R[0]*(1-F[0])+O[0]*F[0],R[1]*(1-F[1])+O[1]*F[1]],S=[],M=[];for(const R of this.triangleSubSegments){S[0]=R.min.x/Nt,S[1]=R.min.y/Nt,M[0]=R.max.x/Nt,M[1]=R.max.y/Nt;const O=I(v,C,S),F=I(v,C,M);if(new pr([O[0],O[1],h],[F[0],F[1],g]).intersectsPrecise(u)===0){A&&(m.segments.push(A),A=void 0);continue}const H=R.segment;A&&A.vertexOffset!==H.vertexOffset&&(m.segments.push(A),A=void 0),A?(A.vertexLength+=H.vertexLength,A.primitiveLength+=H.primitiveLength):A={vertexOffset:H.vertexOffset,primitiveLength:H.primitiveLength,vertexLength:H.vertexLength,primitiveOffset:H.primitiveOffset,sortKey:void 0,vaos:{}}}return A&&m.segments.push(A),m}encodeCentroid(t,o){const u=t.centroid(),m=o.span(),h=Math.min(7,Math.round(m.x*this.tileToMeter/10)),g=Math.min(7,Math.round(m.y*this.tileToMeter/10));return new wt(Jt(u.x,1,Nt-1)<<3|h,Jt(u.y,1,Nt-1)<<3|g)}encodeBorderCentroid(t){if(!t.borders)return new wt(0,0);const o=t.borders,u=Number.MAX_VALUE;if(o[0][0]!==u||o[1][0]!==u){const m=o[0][0]!==u?0:1;return new wt(6|(o[0][0]!==u?0:65528),(o[m][0]+o[m][1])/2<<3|6)}{const m=o[2][0]!==u?2:3;return new wt((o[m][0]+o[m][1])/2<<3|6,6|(o[2][0]!==u?0:65528))}}showCentroid(t){const o=this.centroidData[t.centroidDataIndex];o.flags&=ou,o.centroidXY.x=0,o.centroidXY.y=0,this.writeCentroidToBuffer(o)}writeCentroidToBuffer(t){this.groundEffect.updateHiddenByLandmark(t);const o=t.vertexArrayOffset,u=t.vertexCount+t.vertexArrayOffset,m=t.flags&ou?qT:t.centroidXY,h=this.centroidVertexArray.geta_centroid_pos0(o);if(this.centroidVertexArray.geta_centroid_pos1(o)!==m.y||h!==m.x){for(let g=o;g<u;++g)this.centroidVertexArray.emplace(g,m.x,m.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const t of this.centroidData)this.writeCentroidToBuffer(t)}updateReplacement(t,o,u){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const m=o.getReplacementRegionsForTile(t.toUnwrapped());if(mb(this.activeReplacements,m))return;if(this.activeReplacements=m,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const g of this.centroidData)g.flags&=2147483647;const h=[];for(const g of this.activeReplacements){if(g.order<u)continue;const b=Math.max(1,Math.pow(2,g.footprintTileId.canonical.z-t.canonical.z));for(const E of this.centroidData)if(!(E.flags&ou||g.min.x>E.max.x||E.min.x>g.max.x||g.min.y>E.max.y||E.min.y>g.max.y))for(let A=0;A<E.footprintSegLen;A++){const v=this.footprintSegments[E.footprintSegIdx+A];if(h.length=0,Qk(this.footprintVertices,v.vertexOffset,v.vertexCount,g.footprintTileId.canonical,t.canonical,h),VT(g.footprint,h,this.footprintIndices.uint16,v.indexOffset,v.indexCount,-v.vertexOffset,-b)){E.flags|=ou;break}}}for(const g of this.centroidData)this.writeCentroidToBuffer(g);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(t,o,u){let m=!1;for(let h=0;h<u.footprintSegLen;h++){const g=this.footprintSegments[u.footprintSegIdx+h];let b=0;for(const E of g.ringIndices){for(let A=b,v=E+b-1;A<E+b;v=A++){const C=this.footprintVertices.int16[2*(A+g.vertexOffset)+0],I=this.footprintVertices.int16[2*(A+g.vertexOffset)+1],S=this.footprintVertices.int16[2*(v+g.vertexOffset)+1];I>o!=S>o&&t<(this.footprintVertices.int16[2*(v+g.vertexOffset)+0]-C)*(o-I)/(S-I)+C&&(m=!m)}b=E}}return m}getHeightAtTileCoord(t,o){let u=Number.NEGATIVE_INFINITY,m=!0;const h=4*(t+Nt)*Nt+(o+Nt);if(this.partLookup.hasOwnProperty(h)){const g=this.partLookup[h];return g?{height:g.height,hidden:!!(g.flags&ou)}:void 0}for(const g of this.centroidData)t>g.max.x||g.min.x>t||o>g.max.y||g.min.y>o||this.footprintContainsPoint(t,o,g)&&g&&g.height>u&&(u=g.height,this.partLookup[h]=g,m=!!(g.flags&ou));if(u!==Number.NEGATIVE_INFINITY)return{height:u,hidden:m};this.partLookup[h]=void 0}}function QT(l,t){const o=l.add(t)._unit();return l.x*o.x+l.y*o.y}function Jk(l,t,o,u){const m=t.sub(l)._perp()._unit(),h=o.sub(t)._perp()._unit();return eC(l,t,o,QT(m,h),u)}function eC(l,t,o,u,m){const h=Math.sqrt(1-u*u);return Math.min(l.dist(t)/3,t.dist(o)/3,m*h/u)}function yb(l,t,o){return l.x<o[0].x&&t.x<o[0].x||l.x>o[1].x&&t.x>o[1].x||l.y<o[0].y&&t.y<o[0].y||l.y>o[1].y&&t.y>o[1].y}function tC(l,t){return l.x<t[0].x||l.x>t[1].x||l.y<t[0].y||l.y>t[1].y}function rC(l,t,o){if(l.x<0||l.x>=Nt||t.x<0||t.x>=Nt||o.x<0||o.x>=Nt)return!1;const u=o.sub(t),m=u.perp(),h=l.sub(t);return(u.x*h.x+u.y*h.y)/Math.sqrt((u.x*u.x+u.y*u.y)*(h.x*h.x+h.y*h.y))>-.866&&m.x*h.x+m.y*h.y<0}function nC(l,t,o){const u=t?2|l:-3&l;return o?1|u:-2&u}function iC(){const l=Math.PI/32,t=Math.tan(l),o=nu;return o*Math.sqrt(1+2*t*t)-o}function oC(l,t,o){const u=1<<o.z,m=ta(o.x/u),h=ta((o.x+1)/u),g=Zi(o.y/u),b=Zi((o.y+1)/u);return function(E,A,v,C,I=0,S){const M=[];if(!E.length||!v||!C)return M;const R=(Y,ne)=>{for(const ye of Y)M.push({polygon:ye,bounds:ne})},O=Math.ceil(Math.log2(v)),F=Math.ceil(Math.log2(C)),H=O-F,W=[];for(let Y=0;Y<Math.abs(H);Y++)W.push(H>0?0:1);for(let Y=0;Y<Math.min(O,F);Y++)W.push(0),W.push(1);let V=E;if(V=ey(V,A[0].y-I,A[1].y+I,1),V=ey(V,A[0].x-I,A[1].x+I,0),!V.length)return M;const Z=[];for(W.length?Z.push({polygons:V,bounds:A,depth:0}):R(V,A);Z.length;){const Y=Z.pop(),ne=Y.depth,ye=W[ne],_e=Y.bounds[0],ge=Y.bounds[1],Re=ye===0?_e.x:_e.y,we=ye===0?ge.x:ge.y,Le=S?S(ye,Re,we):.5*(Re+we),Be=ey(Y.polygons,Re-I,Le+I,ye),Oe=ey(Y.polygons,Le-I,we+I,ye);if(Be.length){const Ve=[_e,new wt(ye===0?Le:ge.x,ye===1?Le:ge.y)];W.length>ne+1?Z.push({polygons:Be,bounds:Ve,depth:ne+1}):R(Be,Ve)}if(Oe.length){const Ve=[new wt(ye===0?Le:_e.x,ye===1?Le:_e.y),ge];W.length>ne+1?Z.push({polygons:Oe,bounds:Ve,depth:ne+1}):R(Oe,Ve)}}return M}(l,t,Math.ceil((h-m)/11.25),Math.ceil((g-b)/11.25),1,(E,A,v)=>{if(E===0)return .5*(A+v);{const C=Zi((o.y+A/Nt)/u);return(Hs(.5*(Zi((o.y+v/Nt)/u)+C))*u-o.y)*Nt}})}function Qk(l,t,o,u,m,h){const g=Math.pow(2,u.z-m.z);for(let b=0;b<o;b++){let E=l.int16[2*(b+t)+0],A=l.int16[2*(b+t)+1];E=(E+m.x*Nt)*g-u.x*Nt,A=(A+m.y*Nt)*g-u.y*Nt,h.push(new wt(E,A))}}let aC,sC;function Gm(l,t){return l.x*t.x+l.y*t.y}function lC(l,t){if(l.length===1){let o=0;const u=t[o++];let m;for(;!m||u.equals(m);)if(m=t[o++],!m)return 1/0;for(;o<t.length;o++){const h=t[o],g=l[0],b=m.sub(u),E=h.sub(u),A=g.sub(u),v=Gm(b,b),C=Gm(b,E),I=Gm(E,E),S=Gm(A,b),M=Gm(A,E),R=v*I-C*C,O=(I*S-C*M)/R,F=(v*M-C*S)/R,H=u.z*(1-O-F)+m.z*O+h.z*F;if(isFinite(H))return H}return 1/0}{let o=1/0;for(const u of t)o=Math.min(o,u.z);return o}}function cC(l,t,o,u,m,h,g,b){const E=g*m.getElevationAt(l,t,!0,!0),A=h[0]!==0,v=A?h[1]===0?g*(h[0]/7-450):g*function(C,I,S){const M=Math.floor(I[0]/8),R=Math.floor(I[1]/8),O=10*(I[0]-8*M),F=10*(I[1]-8*R),H=C.getElevationAt(M,R,!0,!0),W=C.getMeterToDEM(S),V=Math.floor(.5*(O*W-1)),Z=Math.floor(.5*(F*W-1)),Y=C.tileCoordToPixel(M,R),ne=2*V+1,ye=2*Z+1,_e=function(Oe,Ve,We,Qe,Ge){return[Oe.getElevationAtPixel(Ve,We,!0),Oe.getElevationAtPixel(Ve+Ge,We,!0),Oe.getElevationAtPixel(Ve,We+Ge,!0),Oe.getElevationAtPixel(Ve+Qe,We+Ge,!0)]}(C,Y.x-V,Y.y-Z,ne,ye),ge=Math.abs(_e[0]-_e[1]),Re=Math.abs(_e[2]-_e[3]),we=Math.abs(_e[0]-_e[2])+Math.abs(_e[1]-_e[3]),Le=Math.min(.25,.5*W*(ge+Re)/ne),Be=Math.min(.25,.5*W*we/ye);return H+Math.max(Le*O,Be*F)}(m,h,b):E;return{base:E+(o===0?-1:o),top:A?Math.max(v+u,E+o+2):E+u}}Yt(iy,"FillExtrusionBucket",{omit:["layers","features"]}),Yt(XT,"PartData"),Yt(ZT,"FootprintSegment"),Yt(YT,"BorderCentroidData"),Yt(JT,"GroundEffect");const eD=on([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),tD=on([{name:"a_z_offset_width",components:2,type:"Float32"}],4),{members:rD}=eD,nD=on([{name:"a_packed",components:4,type:"Float32"}]),{members:iD}=nD,oD=on([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:aD}=oD;class uC{constructor(t,o){this.width=t,this.height=o,this.nextRow=0,this.image=new iu({width:t,height:o}),this.positions={},this.uploaded=!1}getDash(t,o){const u=this.getKey(t,o);return this.positions[u]}trim(){const t=this.width,o=this.height=Ji(this.nextRow);this.image.resize({width:t,height:o})}getKey(t,o){return t.join(",")+o}getDashRanges(t,o,u){const m=[];let h=t.length%2==1?-t[t.length-1]*u:0,g=t[0]*u,b=!0;m.push({left:h,right:g,isDash:b,zeroLength:t[0]===0});let E=t[0];for(let A=1;A<t.length;A++){b=!b;const v=t[A];h=E*u,E+=v,g=E*u,m.push({left:h,right:g,isDash:b,zeroLength:v===0})}return m}addRoundDash(t,o,u){const m=o/2;for(let h=-u;h<=u;h++){const g=this.width*(this.nextRow+u+h);let b=0,E=t[b];for(let A=0;A<this.width;A++){A/E.right>1&&(E=t[++b]);const v=Math.abs(A-E.left),C=Math.abs(A-E.right),I=Math.min(v,C);let S;const M=h/u*(m+1);if(E.isDash){const R=m-Math.abs(M);S=Math.sqrt(I*I+R*R)}else S=m-Math.sqrt(I*I+M*M);this.image.data[g+A]=Math.max(0,Math.min(255,S+128))}}}addRegularDash(t,o){for(let E=t.length-1;E>=0;--E){const A=t[E],v=t[E+1];A.zeroLength?t.splice(E,1):v&&v.isDash===A.isDash&&(v.left=A.left,t.splice(E,1))}const u=t[0],m=t[t.length-1];u.isDash===m.isDash&&(u.left=m.left-this.width,m.right=u.right+this.width);const h=this.width*this.nextRow;let g=0,b=t[g];for(let E=0;E<this.width;E++){E/b.right>1&&(b=t[++g]);const A=Math.abs(E-b.left),v=Math.abs(E-b.right),C=Math.min(A,v);this.image.data[h+E]=Math.max(0,Math.min(255,(b.isDash?C:-C)+o+128))}}addDash(t,o){const u=this.getKey(t,o);if(this.positions[u])return this.positions[u];const m=o==="round",h=m?7:0,g=2*h+1;if(this.nextRow+g>this.height)return gr("LineAtlas out of space"),null;t.length===0&&t.push(1);let b=0;for(let v=0;v<t.length;v++)t[v]<0&&(gr("Negative value is found in line dasharray, replacing values with 0"),t[v]=0),b+=t[v];if(b!==0){const v=this.width/b,C=this.getDashRanges(t,this.width,v);m?this.addRoundDash(C,v,h):this.addRegularDash(C,o==="square"?.5*v:0)}const E=this.nextRow+h;this.nextRow+=g;const A={tl:[E,h],br:[b,0]};return this.positions[u]=A,A}}Yt(uC,"LineAtlas");const sD=mf.VectorTileFeature.types,lD=Math.cos(Math.PI/180*37.5),cD=Math.cos(Math.PI/180*5);class vb{constructor(t){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.zoom=t.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.index=t.index,this.projection=t.projection,this.hasPattern=!1,this.hasZOffset=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new pm,this.layoutVertexArray2=new Vs,this.patternVertexArray=new Sl,this.indexArray=new no,this.programConfigurations=new Il(t.layers,{zoom:t.zoom,lut:t.lut}),this.segments=new ri,this.maxLineLength=0,this.zOffsetVertexArray=new Us,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.tessellationStep=t.tessellationStep?t.tessellationStep:Nt/64}updateFootprints(t,o){}populate(t,o,u,m){this.hasPattern=sb("line",this.layers,o);const h=this.layers[0].layout.get("line-sort-key");this.tileToMeter=p(u),this.hasZOffset=!this.layers[0].isDraped();const g=this.layers[0].layout.get("line-elevation-reference");this.hasZOffset&&g==="none"&&gr(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`);const b=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.hasZOffset&&b!==void 0;const E=[];for(const{feature:I,id:S,index:M,sourceLayerIndex:R}of t){const O=this.layers[0]._featureFilter.needGeometry,F=G(I,O);if(!this.layers[0]._featureFilter.filter(new Vn(this.zoom),F,u))continue;const H=h?h.evaluate(F,{},u):void 0,W={id:S,properties:I.properties,type:I.type,sourceLayerIndex:R,index:M,geometry:O?F.geometry:B(I,u,m),patterns:{},sortKey:H};E.push(W)}h&&E.sort((I,S)=>I.sortKey-S.sortKey);const{lineAtlas:A,featureIndex:v}=o,C=this.addConstantDashes(A);for(const I of E){const{geometry:S,index:M,sourceLayerIndex:R}=I;if(C&&this.addFeatureDashes(I,A),this.hasPattern){const O=lb("line",this.layers,I,this.zoom,o);this.patternFeatures.push(O)}else this.addFeature(I,S,M,u,A.positions,o.availableImages,o.brightness);v.insert(t[M].feature,S,M,R,this.index)}}addConstantDashes(t){let o=!1;for(const u of this.layers){const m=u.paint.get("line-dasharray").value,h=u.layout.get("line-cap").value;if(m.kind!=="constant"||h.kind!=="constant")o=!0;else{const g=h.value,b=m.value;if(!b)continue;t.addDash(b,g)}}return o}addFeatureDashes(t,o){const u=this.zoom;for(const m of this.layers){const h=m.paint.get("line-dasharray").value,g=m.layout.get("line-cap").value;if(h.kind==="constant"&&g.kind==="constant")continue;let b,E;if(h.kind==="constant"){if(b=h.value,!b)continue}else b=h.evaluate({zoom:u},t);E=g.kind==="constant"?g.value:g.evaluate({zoom:u},t),o.addDash(b,E),t.patterns[m.id]=o.getKey(b,E)}}update(t,o,u,m,h,g,b){this.programConfigurations.updatePaintArrays(t,o,h,u,m,g,b)}addFeatures(t,o,u,m,h,g){for(const b of this.patternFeatures)this.addFeature(b,b.geometry,b.index,o,u,m,g)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(t){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=t.createVertexBuffer(this.layoutVertexArray2,iD)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=t.createVertexBuffer(this.patternVertexArray,aD)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,tD.members,!0)),this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,rD),this.indexBuffer=t.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(t),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(t){if(t.properties&&t.properties.hasOwnProperty("mapbox_clip_start")&&t.properties.hasOwnProperty("mapbox_clip_end"))return{start:+t.properties.mapbox_clip_start,end:+t.properties.mapbox_clip_end}}addFeature(t,o,u,m,h,g,b){const E=this.layers[0].layout,A=E.get("line-join").evaluate(t,{}),v=E.get("line-cap").evaluate(t,{}),C=E.get("line-miter-limit"),I=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(t),this.lineFeature=t,this.zOffsetValue=E.get("line-z-offset").value;const S=this.layers[0].paint.get("line-width").value;S.kind!=="constant"&&S.isLineProgressConstant===!1&&(this.variableWidthValue=S);for(const M of o)this.addLine(M,t,m,A,v,C,I);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,t,u,h,g,m,b)}addLine(t,o,u,m,h,g,b){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const E=m==="none";if(this.patternJoinNone=this.hasPattern&&E,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[],this.lineClips){this.lineClipsArray.push(this.lineClips);for(let W=0;W<t.length-1;W++)this.totalDistance+=t[W].dist(t[W+1]);this.totalFeatureLength=this.totalDistance/(this.lineClips.end-this.lineClips.start),this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const A=sD[o.type]==="Polygon";let v=t.length;for(;v>=2&&t[v-1].equals(t[v-2]);)v--;let C=0;for(;C<v-1&&t[C].equals(t[C+1]);)C++;if(v<(A?3:2))return;m==="bevel"&&(g=1.05);const I=this.segments.prepareSegment(10*v,this.layoutVertexArray,this.indexArray);let S,M,R,O,F,H;this.e1=this.e2=-1,A&&(S=t[v-2],F=t[C].sub(S)._unit()._perp());for(let W=C;W<v;W++){if(R=W===v-1?A?t[C+1]:void 0:t[W+1],R&&t[W].equals(R))continue;F&&(O=F),S&&(M=S),S=t[W],H=this.evaluateLineProgressFeatures(M?M.dist(S):0),F=R?R.sub(S)._unit()._perp():O,O=O||F;const V=M&&R;let Z=V?m:A||E?"butt":h;const Y=O.x*F.x+O.y*F.y;if(E){const Be=function(Oe){if(Oe.patternJoinNone){const Ve=Oe.segmentPoints.length/2,We=Oe.lineSoFar-Oe.segmentStart;for(let Qe=0;Qe<Ve;++Qe){const Ge=Oe.segmentPoints[2*Qe+1],ut=Math.round(Oe.segmentPoints[2*Qe])+.5+.25*Ge;Oe.patternVertexArray.emplaceBack(ut,We,Oe.segmentStart),Oe.patternVertexArray.emplaceBack(ut,We,Oe.segmentStart)}Oe.segmentPoints.length=0}Oe.e1=Oe.e2=-1};if(V&&Y<cD){this.updateDistance(M,S),this.addCurrentVertex(S,O,1,1,I,H),Be(this),this.addCurrentVertex(S,F,-1,-1,I,H);continue}if(M){if(!R){this.updateDistance(M,S),this.addCurrentVertex(S,O,1,1,I,H),Be(this);continue}Z="miter"}}let ne=O.add(F);ne.x===0&&ne.y===0||ne._unit();const ye=ne.x*F.x+ne.y*F.y,_e=ye!==0?1/ye:1/0,ge=2*Math.sqrt(2-2*ye),Re=ye<lD&&M&&R,we=O.x*F.y-O.y*F.x>0,Le=this.overscaling<=16?15*Nt/(512*this.overscaling):0;if(V&&Z==="round"){if(_e<b)Z="miter";else if(_e<=2){const Be=xb(S,-10,Nt+10);Z=this.hasZOffset&&(Be||this.hasCrossSlope)?"miter":"fakeround"}}if(Z==="miter"&&_e>g&&(Z="bevel"),Z==="bevel"&&(_e>2&&(Z="flipbevel"),_e<g&&(Z="miter")),M&&!(Z==="miter"&&Re)&&this.updateDistance(M,S),Z==="miter")if(Re){const Be=S.dist(M);if(Be>2*Le){const Ve=S.sub(S.sub(M)._mult(Le/Be)._round());this.updateDistance(M,Ve),this.addCurrentVertex(Ve,O,0,0,I,H),M=Ve}this.updateDistance(M,S),ne._mult(_e),this.addCurrentVertex(S,ne,0,0,I,H);const Oe=S.dist(R);if(Oe>2*Le){const Ve=S.add(R.sub(S)._mult(Le/Oe)._round());this.updateDistance(S,Ve),this.addCurrentVertex(Ve,F,0,0,I,H),S=Ve}}else ne._mult(_e),this.addCurrentVertex(S,ne,0,0,I,H);else if(Z==="flipbevel"){if(_e>100)ne=F.mult(-1);else{const Be=_e*O.add(F).mag()/O.sub(F).mag();ne._perp()._mult(Be*(we?-1:1))}this.addCurrentVertex(S,ne,0,0,I,H),this.addCurrentVertex(S,ne.mult(-1),0,0,I,H)}else if(Z==="bevel"||Z==="fakeround"){H!=null&&M&&this.addCurrentVertex(S,O,-1,-1,I,H);const Be=S.dist(M)<=2*Le&&Z!=="bevel",Oe=ne.mult(we?1:-1);Oe._mult(_e);const Ve=F.mult(we?-1:1),We=O.mult(we?-1:1),Qe=this.evaluateLineProgressFeatures(this.distance);if(H==null&&(this.addHalfVertex(S,Oe.x,Oe.y,!1,!we,0,I,Qe),Be||this.addHalfVertex(S,Oe.x+2*We.x,Oe.y+2*We.y,!1,we,0,I,Qe)),Z==="fakeround"){const Ge=Math.round(180*ge/Math.PI/20);this.addHalfVertex(S,We.x,We.y,!1,we,0,I,Qe);for(let ut=0;ut<Ge;ut++){let It=ut/Ge;if(It!==.5){const Dt=It-.5;It+=It*Dt*(It-1)*((1.0904+Y*(Y*(3.55645-1.43519*Y)-3.2452))*Dt*Dt+(.848013+Y*(.215638*Y-1.06021)))}const dt=Ve.sub(We)._mult(It)._add(We)._unit();this.addHalfVertex(S,dt.x,dt.y,!1,we,0,I,Qe)}this.addHalfVertex(S,Ve.x,Ve.y,!1,we,0,I,Qe)}Be||H!=null||this.addHalfVertex(S,Oe.x+2*Ve.x,Oe.y+2*Ve.y,!1,we,0,I,Qe),H!=null&&R&&this.addCurrentVertex(S,F,1,1,I,H)}else Z==="butt"?this.addCurrentVertex(S,ne,0,0,I,H):Z==="square"?(M||this.addCurrentVertex(S,ne,-1,-1,I,H),this.addCurrentVertex(S,ne,0,0,I,H),M&&this.addCurrentVertex(S,ne,1,1,I,H)):Z==="round"&&(M&&(this.addCurrentVertex(S,O,0,0,I,H),this.addCurrentVertex(S,O,1,1,I,H,!0)),R&&(this.addCurrentVertex(S,F,-1,-1,I,H,!0),this.addCurrentVertex(S,F,0,0,I,H)))}}addVerticesTo(t,o,u,m,h,g,b,E,A,v){const C=(o.w-t.w)/this.tessellationStep|0;let I=0;const S=this.scaledDistance;if(C>1){this.lineSoFar=t.w;const R=(o.x-t.x)/C,O=(o.y-t.y)/C,F=(o.z-t.z)/C,H=(o.w-t.w)/C;for(let W=1;W<C;++W){t.x+=R,t.y+=O,t.z+=F,this.lineSoFar+=H,I+=H;const V=this.evaluateLineProgressFeatures(this.prevDistance+I);this.scaledDistance=(this.prevDistance+I)/this.totalDistance,this.addHalfVertex(t,u,m,v,!1,b,A,V),this.addHalfVertex(t,h,g,v,!0,-E,A,V)}}this.lineSoFar=o.w,this.scaledDistance=S;const M=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(o,u,m,v,!1,b,A,M),this.addHalfVertex(o,h,g,v,!0,-E,A,M)}evaluateLineProgressFeatures(t){if(!this.variableWidthValue&&!this.hasZOffset)return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+t)/this.totalFeatureLength):gr(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let o=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(o=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.hasZOffset?this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:o}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:o}:{zOffset:0,variableWidth:o}}addCurrentVertex(t,o,u,m,h,g,b=!1){const E=o.x+o.y*u,A=o.y-o.x*u,v=o.y*m-o.x,C=-o.y-o.x*m;if(g!=null){const I=this.hasZOffset,S=-10,M=Nt+10,R=g.zOffset,O=new OT(t.x,t.y,R,this.lineSoFar),F=!!I&&xb(t,S,M),H=this.lineSoFar,W=this.distance;if(this.currentVertex)if(F){const V=this.currentVertexIsOutside,Z=this.currentVertex,Y=new OT(t.x,t.y,R,this.lineSoFar);if(BT(Z,Y,S,M),!xb(Y,S,M)){if(V){this.e1=this.e2=-1,this.distance-=Z.dist(O),this.lineSoFar=Z.w;const ne=this.evaluateLineProgressFeatures(Z.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(Z,E,A,b,!1,u,h,ne),this.addHalfVertex(Z,v,C,b,!0,-m,h,ne),this.prevDistance=this.distance}this.distance=this.prevDistance+Z.dist(Y),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(Z,Y,E,A,v,C,u,m,h,b),this.distance=W,this.scaledDistance=this.distance/this.totalDistance}}else{const V=this.currentVertex;if(this.currentVertexIsOutside){BT(V,O,S,M),this.e1=this.e2=-1,this.distance-=V.dist(O),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=V.w;const Z=this.evaluateLineProgressFeatures(V.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(V,E,A,b,!1,u,h,Z),this.addHalfVertex(V,v,C,b,!0,-m,h,Z),this.prevDistance=this.distance,this.distance=W,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(V,O,E,A,v,C,u,m,h,b)}else F||(this.addHalfVertex(t,E,A,b,!1,u,h,g),this.addHalfVertex(t,v,C,b,!0,-m,h,g));this.currentVertex=O,this.currentVertexIsOutside=F,this.lineSoFar=H}else this.addHalfVertex(t,E,A,b,!1,u,h,g),this.addHalfVertex(t,v,C,b,!0,-m,h,g)}addHalfVertex({x:t,y:o},u,m,h,g,b,E,A){this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),g||this.segmentPoints.push(this.lineSoFar-this.segmentStart,b)),this.layoutVertexArray.emplaceBack((t<<1)+(h?1:0),(o<<1)+(g?1:0),Math.round(63*u)+128,Math.round(63*m)+128,1+(b===0?0:b<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const v=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,v),E.primitiveLength++),g?this.e2=v:this.e1=v,A!=null&&this.zOffsetVertexArray.emplaceBack(A.zOffset,A.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(t,o){this.prevDistance=this.distance,this.distance+=t.dist(o),this.updateScaledDistance()}}function xb(l,t,o){return l.x<t||l.x>o||l.y<t||l.y>o}let hC,dC;function fC(l,t,o){return t*(Nt/(l.tileSize*Math.pow(2,o-l.tileID.overscaledZ)))}Yt(vb,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const pC=(l,t,o)=>(1-o)*l+o*t;function mC(l,t){return 1/fC(l,1,t.tileZoom)}function gC(l,t,o,u){return l.translatePosMatrix(u||t.tileID.projMatrix,t,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const _C=l=>{const t=[];yC(l)&&t.push("RENDER_LINE_DASH"),l.paint.get("line-gradient")&&t.push("RENDER_LINE_GRADIENT");const o=l.paint.get("line-trim-offset");o[0]===0&&o[1]===0||t.push("RENDER_LINE_TRIM_OFFSET"),l.paint.get("line-border-width").constantOr(1)!==0&&t.push("RENDER_LINE_BORDER");const u=l.layout.get("line-join").constantOr("miter")==="none",m=!!l.paint.get("line-pattern").constantOr(1);return u&&m&&t.push("LINE_JOIN_NONE"),t};function yC(l){const t=l.paint.get("line-dasharray").value;return t.value||t.kind!=="constant"}let bb;const vC=()=>bb||(bb={layout:hC||(hC=new ti({"line-cap":new Ht(nt.layout_line["line-cap"]),"line-join":new Ht(nt.layout_line["line-join"]),"line-miter-limit":new zt(nt.layout_line["line-miter-limit"]),"line-round-limit":new zt(nt.layout_line["line-round-limit"]),"line-sort-key":new Ht(nt.layout_line["line-sort-key"]),"line-z-offset":new Ht(nt.layout_line["line-z-offset"]),"line-elevation-reference":new zt(nt.layout_line["line-elevation-reference"]),"line-cross-slope":new zt(nt.layout_line["line-cross-slope"]),visibility:new zt(nt.layout_line.visibility),"line-width-unit":new zt(nt.layout_line["line-width-unit"])})),paint:dC||(dC=new ti({"line-opacity":new Ht(nt.paint_line["line-opacity"]),"line-color":new Ht(nt.paint_line["line-color"]),"line-translate":new zt(nt.paint_line["line-translate"]),"line-translate-anchor":new zt(nt.paint_line["line-translate-anchor"]),"line-width":new Ht(nt.paint_line["line-width"]),"line-gap-width":new Ht(nt.paint_line["line-gap-width"]),"line-offset":new Ht(nt.paint_line["line-offset"]),"line-blur":new Ht(nt.paint_line["line-blur"]),"line-dasharray":new Ht(nt.paint_line["line-dasharray"]),"line-pattern":new Ht(nt.paint_line["line-pattern"]),"line-gradient":new Zc(nt.paint_line["line-gradient"]),"line-trim-offset":new zt(nt.paint_line["line-trim-offset"]),"line-trim-fade-range":new zt(nt.paint_line["line-trim-fade-range"]),"line-trim-color":new zt(nt.paint_line["line-trim-color"]),"line-emissive-strength":new zt(nt.paint_line["line-emissive-strength"]),"line-border-width":new Ht(nt.paint_line["line-border-width"]),"line-border-color":new Ht(nt.paint_line["line-border-color"]),"line-occlusion-opacity":new zt(nt.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},bb);class uD extends Ht{possiblyEvaluate(t,o){return o=new Vn(Math.floor(o.zoom),{now:o.now,fadeDuration:o.fadeDuration,transition:o.transition}),super.possiblyEvaluate(t,o)}evaluate(t,o,u,m){return o=dn({},o,{zoom:Math.floor(o.zoom)}),super.evaluate(t,o,u,m)}}let Hm;function xC(l,t){return t>0?t+2*l:l}const hD=on([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),dD=on([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),fD=on([{name:"a_projected_pos",components:4,type:"Float32"}],4);on([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const pD=on([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),mD=on([{name:"a_texb",components:2,type:"Uint16"}]),gD=on([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),_D=on([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);on([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const bC=on([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),yD=on([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);on([{name:"triangle",components:3,type:"Uint16"}]),on([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),on([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"}]),on([{type:"Float32",name:"offsetX"}]),on([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var go=24;const Zs=128;function oy(l,t,o,u,m){if(l.kind==="camera")return l.maxSize;if(l.kind==="composite"){const h=t.possiblyEvaluate(new Vn(l.maxZoom),o).evaluate(m,{},o),g=t.possiblyEvaluate(new Vn(l.minZoom),o).evaluate(m,{},o);return Math.max(h,g)}return t.possiblyEvaluate(new Vn(u)).evaluate(m,{},o)}function wb(l,t){const{expression:o}=t;if(o.kind==="constant")return{kind:"constant",layoutSize:o.evaluate(new Vn(l+1))};if(o.kind==="source")return{kind:"source"};{const{zoomStops:u,interpolationType:m}=o;let h=0;for(;h<u.length&&u[h]<=l;)h++;h=Math.max(0,h-1);let g=h;for(;g<u.length&&u[g]<l+1;)g++;g=Math.min(u.length-1,g);const b=u[h],E=u[g];return o.kind==="composite"?{kind:"composite",minZoom:b,maxZoom:E,interpolationType:m}:{kind:"camera",minZoom:b,maxZoom:E,minSize:o.evaluate(new Vn(b)),maxSize:o.evaluate(new Vn(E)),interpolationType:m}}}function ay(l,{uSize:t,uSizeT:o},{lowerSize:u,upperSize:m}){return l.kind==="source"?u/Zs:l.kind==="composite"?ur(u/Zs,m/Zs,o):t}function gf(l,t,o=1){let u=0,m=0;if(l.kind==="constant")m=l.layoutSize*o;else if(l.kind!=="source"){const{interpolationType:h,minZoom:g,maxZoom:b}=l,E=h?Jt(Ko.interpolationFactor(h,t,g,b),0,1):0;l.kind==="camera"?m=ur(l.minSize,l.maxSize,E)*o:u=E*o}return{uSizeT:u,uSize:m}}var vD=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Zs,evaluateSizeForFeature:ay,evaluateSizeForZoom:gf,getRasterizedIconSize:oy,getSizeData:wb});function xD(l,t,o){return l.sections.forEach(u=>{u.text=function(m,h,g){const b=h.layout.get("text-transform").evaluate(g,{});return b==="uppercase"?m=m.toLocaleUpperCase():b==="lowercase"&&(m=m.toLocaleLowerCase()),Qo.applyArabicShaping&&(m=Qo.applyArabicShaping(m)),m}(u.text,t,o)}),l}const Wm={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function bD(l){return l==="︶"||l==="﹈"||l==="︸"||l==="﹄"||l==="﹂"||l==="︾"||l==="︼"||l==="︺"||l==="︘"||l==="﹀"||l==="︐"||l==="︓"||l==="︔"||l==="｀"||l==="￣"||l==="︑"||l==="︒"}function wD(l){return l==="︵"||l==="﹇"||l==="︷"||l==="﹃"||l==="﹁"||l==="︽"||l==="︻"||l==="︹"||l==="︗"||l==="︿"}var wC,Sb,SC,Eb={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function SD(){return wC||(wC=1,Eb.read=function(l,t,o,u,m){var h,g,b=8*m-u-1,E=(1<<b)-1,A=E>>1,v=-7,C=o?m-1:0,I=o?-1:1,S=l[t+C];for(C+=I,h=S&(1<<-v)-1,S>>=-v,v+=b;v>0;h=256*h+l[t+C],C+=I,v-=8);for(g=h&(1<<-v)-1,h>>=-v,v+=u;v>0;g=256*g+l[t+C],C+=I,v-=8);if(h===0)h=1-A;else{if(h===E)return g?NaN:1/0*(S?-1:1);g+=Math.pow(2,u),h-=A}return(S?-1:1)*g*Math.pow(2,h-u)},Eb.write=function(l,t,o,u,m,h){var g,b,E,A=8*h-m-1,v=(1<<A)-1,C=v>>1,I=m===23?Math.pow(2,-24)-Math.pow(2,-77):0,S=u?0:h-1,M=u?1:-1,R=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(b=isNaN(t)?1:0,g=v):(g=Math.floor(Math.log(t)/Math.LN2),t*(E=Math.pow(2,-g))<1&&(g--,E*=2),(t+=g+C>=1?I/E:I*Math.pow(2,1-C))*E>=2&&(g++,E/=2),g+C>=v?(b=0,g=v):g+C>=1?(b=(t*E-1)*Math.pow(2,m),g+=C):(b=t*Math.pow(2,C-1)*Math.pow(2,m),g=0));m>=8;l[o+S]=255&b,S+=M,b/=256,m-=8);for(g=g<<m|b,A+=m;A>0;l[o+S]=255&g,S+=M,g/=256,A-=8);l[o+S-M]|=128*R}),Eb}function EC(){if(SC)return Sb;SC=1,Sb=t;var l=SD();function t(V){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(V)?V:new Uint8Array(V||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var o=4294967296,u=1/o,m=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function h(V){return V.type===t.Bytes?V.readVarint()+V.pos:V.pos+1}function g(V,Z,Y){return Y?4294967296*Z+(V>>>0):4294967296*(Z>>>0)+(V>>>0)}function b(V,Z,Y){var ne=Z<=16383?1:Z<=2097151?2:Z<=268435455?3:Math.floor(Math.log(Z)/(7*Math.LN2));Y.realloc(ne);for(var ye=Y.pos-1;ye>=V;ye--)Y.buf[ye+ne]=Y.buf[ye]}function E(V,Z){for(var Y=0;Y<V.length;Y++)Z.writeVarint(V[Y])}function A(V,Z){for(var Y=0;Y<V.length;Y++)Z.writeSVarint(V[Y])}function v(V,Z){for(var Y=0;Y<V.length;Y++)Z.writeFloat(V[Y])}function C(V,Z){for(var Y=0;Y<V.length;Y++)Z.writeDouble(V[Y])}function I(V,Z){for(var Y=0;Y<V.length;Y++)Z.writeBoolean(V[Y])}function S(V,Z){for(var Y=0;Y<V.length;Y++)Z.writeFixed32(V[Y])}function M(V,Z){for(var Y=0;Y<V.length;Y++)Z.writeSFixed32(V[Y])}function R(V,Z){for(var Y=0;Y<V.length;Y++)Z.writeFixed64(V[Y])}function O(V,Z){for(var Y=0;Y<V.length;Y++)Z.writeSFixed64(V[Y])}function F(V,Z){return(V[Z]|V[Z+1]<<8|V[Z+2]<<16)+16777216*V[Z+3]}function H(V,Z,Y){V[Y]=Z,V[Y+1]=Z>>>8,V[Y+2]=Z>>>16,V[Y+3]=Z>>>24}function W(V,Z){return(V[Z]|V[Z+1]<<8|V[Z+2]<<16)+(V[Z+3]<<24)}return t.prototype={destroy:function(){this.buf=null},readFields:function(V,Z,Y){for(Y=Y||this.length;this.pos<Y;){var ne=this.readVarint(),ye=ne>>3,_e=this.pos;this.type=7&ne,V(ye,Z,this),this.pos===_e&&this.skip(ne)}return Z},readMessage:function(V,Z){return this.readFields(V,Z,this.readVarint()+this.pos)},readFixed32:function(){var V=F(this.buf,this.pos);return this.pos+=4,V},readSFixed32:function(){var V=W(this.buf,this.pos);return this.pos+=4,V},readFixed64:function(){var V=F(this.buf,this.pos)+F(this.buf,this.pos+4)*o;return this.pos+=8,V},readSFixed64:function(){var V=F(this.buf,this.pos)+W(this.buf,this.pos+4)*o;return this.pos+=8,V},readFloat:function(){var V=l.read(this.buf,this.pos,!0,23,4);return this.pos+=4,V},readDouble:function(){var V=l.read(this.buf,this.pos,!0,52,8);return this.pos+=8,V},readVarint:function(V){var Z,Y,ne=this.buf;return Z=127&(Y=ne[this.pos++]),Y<128?Z:(Z|=(127&(Y=ne[this.pos++]))<<7,Y<128?Z:(Z|=(127&(Y=ne[this.pos++]))<<14,Y<128?Z:(Z|=(127&(Y=ne[this.pos++]))<<21,Y<128?Z:function(ye,_e,ge){var Re,we,Le=ge.buf;if(Re=(112&(we=Le[ge.pos++]))>>4,we<128||(Re|=(127&(we=Le[ge.pos++]))<<3,we<128)||(Re|=(127&(we=Le[ge.pos++]))<<10,we<128)||(Re|=(127&(we=Le[ge.pos++]))<<17,we<128)||(Re|=(127&(we=Le[ge.pos++]))<<24,we<128)||(Re|=(1&(we=Le[ge.pos++]))<<31,we<128))return g(ye,Re,_e);throw new Error("Expected varint not more than 10 bytes")}(Z|=(15&(Y=ne[this.pos]))<<28,V,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var V=this.readVarint();return V%2==1?(V+1)/-2:V/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var V=this.readVarint()+this.pos,Z=this.pos;return this.pos=V,V-Z>=12&&m?function(Y,ne,ye){return m.decode(Y.subarray(ne,ye))}(this.buf,Z,V):function(Y,ne,ye){for(var _e="",ge=ne;ge<ye;){var Re,we,Le,Be=Y[ge],Oe=null,Ve=Be>239?4:Be>223?3:Be>191?2:1;if(ge+Ve>ye)break;Ve===1?Be<128&&(Oe=Be):Ve===2?(192&(Re=Y[ge+1]))==128&&(Oe=(31&Be)<<6|63&Re)<=127&&(Oe=null):Ve===3?(we=Y[ge+2],(192&(Re=Y[ge+1]))==128&&(192&we)==128&&((Oe=(15&Be)<<12|(63&Re)<<6|63&we)<=2047||Oe>=55296&&Oe<=57343)&&(Oe=null)):Ve===4&&(we=Y[ge+2],Le=Y[ge+3],(192&(Re=Y[ge+1]))==128&&(192&we)==128&&(192&Le)==128&&((Oe=(15&Be)<<18|(63&Re)<<12|(63&we)<<6|63&Le)<=65535||Oe>=1114112)&&(Oe=null)),Oe===null?(Oe=65533,Ve=1):Oe>65535&&(Oe-=65536,_e+=String.fromCharCode(Oe>>>10&1023|55296),Oe=56320|1023&Oe),_e+=String.fromCharCode(Oe),ge+=Ve}return _e}(this.buf,Z,V)},readBytes:function(){var V=this.readVarint()+this.pos,Z=this.buf.subarray(this.pos,V);return this.pos=V,Z},readPackedVarint:function(V,Z){if(this.type!==t.Bytes)return V.push(this.readVarint(Z));var Y=h(this);for(V=V||[];this.pos<Y;)V.push(this.readVarint(Z));return V},readPackedSVarint:function(V){if(this.type!==t.Bytes)return V.push(this.readSVarint());var Z=h(this);for(V=V||[];this.pos<Z;)V.push(this.readSVarint());return V},readPackedBoolean:function(V){if(this.type!==t.Bytes)return V.push(this.readBoolean());var Z=h(this);for(V=V||[];this.pos<Z;)V.push(this.readBoolean());return V},readPackedFloat:function(V){if(this.type!==t.Bytes)return V.push(this.readFloat());var Z=h(this);for(V=V||[];this.pos<Z;)V.push(this.readFloat());return V},readPackedDouble:function(V){if(this.type!==t.Bytes)return V.push(this.readDouble());var Z=h(this);for(V=V||[];this.pos<Z;)V.push(this.readDouble());return V},readPackedFixed32:function(V){if(this.type!==t.Bytes)return V.push(this.readFixed32());var Z=h(this);for(V=V||[];this.pos<Z;)V.push(this.readFixed32());return V},readPackedSFixed32:function(V){if(this.type!==t.Bytes)return V.push(this.readSFixed32());var Z=h(this);for(V=V||[];this.pos<Z;)V.push(this.readSFixed32());return V},readPackedFixed64:function(V){if(this.type!==t.Bytes)return V.push(this.readFixed64());var Z=h(this);for(V=V||[];this.pos<Z;)V.push(this.readFixed64());return V},readPackedSFixed64:function(V){if(this.type!==t.Bytes)return V.push(this.readSFixed64());var Z=h(this);for(V=V||[];this.pos<Z;)V.push(this.readSFixed64());return V},skip:function(V){var Z=7&V;if(Z===t.Varint)for(;this.buf[this.pos++]>127;);else if(Z===t.Bytes)this.pos=this.readVarint()+this.pos;else if(Z===t.Fixed32)this.pos+=4;else{if(Z!==t.Fixed64)throw new Error("Unimplemented type: "+Z);this.pos+=8}},writeTag:function(V,Z){this.writeVarint(V<<3|Z)},realloc:function(V){for(var Z=this.length||16;Z<this.pos+V;)Z*=2;if(Z!==this.length){var Y=new Uint8Array(Z);Y.set(this.buf),this.buf=Y,this.length=Z}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(V){this.realloc(4),H(this.buf,V,this.pos),this.pos+=4},writeSFixed32:function(V){this.realloc(4),H(this.buf,V,this.pos),this.pos+=4},writeFixed64:function(V){this.realloc(8),H(this.buf,-1&V,this.pos),H(this.buf,Math.floor(V*u),this.pos+4),this.pos+=8},writeSFixed64:function(V){this.realloc(8),H(this.buf,-1&V,this.pos),H(this.buf,Math.floor(V*u),this.pos+4),this.pos+=8},writeVarint:function(V){(V=+V||0)>268435455||V<0?function(Z,Y){var ne,ye;if(Z>=0?(ne=Z%4294967296|0,ye=Z/4294967296|0):(ye=~(-Z/4294967296),4294967295^(ne=~(-Z%4294967296))?ne=ne+1|0:(ne=0,ye=ye+1|0)),Z>=18446744073709552e3||Z<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Y.realloc(10),function(_e,ge,Re){Re.buf[Re.pos++]=127&_e|128,_e>>>=7,Re.buf[Re.pos++]=127&_e|128,_e>>>=7,Re.buf[Re.pos++]=127&_e|128,_e>>>=7,Re.buf[Re.pos++]=127&_e|128,Re.buf[Re.pos]=127&(_e>>>=7)}(ne,0,Y),function(_e,ge){var Re=(7&_e)<<4;ge.buf[ge.pos++]|=Re|((_e>>>=3)?128:0),_e&&(ge.buf[ge.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(ge.buf[ge.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(ge.buf[ge.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(ge.buf[ge.pos++]=127&_e|((_e>>>=7)?128:0),_e&&(ge.buf[ge.pos++]=127&_e)))))}(ye,Y)}(V,this):(this.realloc(4),this.buf[this.pos++]=127&V|(V>127?128:0),V<=127||(this.buf[this.pos++]=127&(V>>>=7)|(V>127?128:0),V<=127||(this.buf[this.pos++]=127&(V>>>=7)|(V>127?128:0),V<=127||(this.buf[this.pos++]=V>>>7&127))))},writeSVarint:function(V){this.writeVarint(V<0?2*-V-1:2*V)},writeBoolean:function(V){this.writeVarint(!!V)},writeString:function(V){V=String(V),this.realloc(4*V.length),this.pos++;var Z=this.pos;this.pos=function(ne,ye,_e){for(var ge,Re,we=0;we<ye.length;we++){if((ge=ye.charCodeAt(we))>55295&&ge<57344){if(!Re){ge>56319||we+1===ye.length?(ne[_e++]=239,ne[_e++]=191,ne[_e++]=189):Re=ge;continue}if(ge<56320){ne[_e++]=239,ne[_e++]=191,ne[_e++]=189,Re=ge;continue}ge=Re-55296<<10|ge-56320|65536,Re=null}else Re&&(ne[_e++]=239,ne[_e++]=191,ne[_e++]=189,Re=null);ge<128?ne[_e++]=ge:(ge<2048?ne[_e++]=ge>>6|192:(ge<65536?ne[_e++]=ge>>12|224:(ne[_e++]=ge>>18|240,ne[_e++]=ge>>12&63|128),ne[_e++]=ge>>6&63|128),ne[_e++]=63&ge|128)}return _e}(this.buf,V,this.pos);var Y=this.pos-Z;Y>=128&&b(Z,Y,this),this.pos=Z-1,this.writeVarint(Y),this.pos+=Y},writeFloat:function(V){this.realloc(4),l.write(this.buf,V,this.pos,!0,23,4),this.pos+=4},writeDouble:function(V){this.realloc(8),l.write(this.buf,V,this.pos,!0,52,8),this.pos+=8},writeBytes:function(V){var Z=V.length;this.writeVarint(Z),this.realloc(Z);for(var Y=0;Y<Z;Y++)this.buf[this.pos++]=V[Y]},writeRawMessage:function(V,Z){this.pos++;var Y=this.pos;V(Z,this);var ne=this.pos-Y;ne>=128&&b(Y,ne,this),this.pos=Y-1,this.writeVarint(ne),this.pos+=ne},writeMessage:function(V,Z,Y){this.writeTag(V,t.Bytes),this.writeRawMessage(Z,Y)},writePackedVarint:function(V,Z){Z.length&&this.writeMessage(V,E,Z)},writePackedSVarint:function(V,Z){Z.length&&this.writeMessage(V,A,Z)},writePackedBoolean:function(V,Z){Z.length&&this.writeMessage(V,I,Z)},writePackedFloat:function(V,Z){Z.length&&this.writeMessage(V,v,Z)},writePackedDouble:function(V,Z){Z.length&&this.writeMessage(V,C,Z)},writePackedFixed32:function(V,Z){Z.length&&this.writeMessage(V,S,Z)},writePackedSFixed32:function(V,Z){Z.length&&this.writeMessage(V,M,Z)},writePackedFixed64:function(V,Z){Z.length&&this.writeMessage(V,R,Z)},writePackedSFixed64:function(V,Z){Z.length&&this.writeMessage(V,O,Z)},writeBytesField:function(V,Z){this.writeTag(V,t.Bytes),this.writeBytes(Z)},writeFixed32Field:function(V,Z){this.writeTag(V,t.Fixed32),this.writeFixed32(Z)},writeSFixed32Field:function(V,Z){this.writeTag(V,t.Fixed32),this.writeSFixed32(Z)},writeFixed64Field:function(V,Z){this.writeTag(V,t.Fixed64),this.writeFixed64(Z)},writeSFixed64Field:function(V,Z){this.writeTag(V,t.Fixed64),this.writeSFixed64(Z)},writeVarintField:function(V,Z){this.writeTag(V,t.Varint),this.writeVarint(Z)},writeSVarintField:function(V,Z){this.writeTag(V,t.Varint),this.writeSVarint(Z)},writeStringField:function(V,Z){this.writeTag(V,t.Bytes),this.writeString(Z)},writeFloatField:function(V,Z){this.writeTag(V,t.Fixed32),this.writeFloat(Z)},writeDoubleField:function(V,Z){this.writeTag(V,t.Fixed64),this.writeDouble(Z)},writeBooleanField:function(V,Z){this.writeVarintField(V,!!Z)}},Sb}var sy=L(EC());const Tb=3;function ED(l,t,o){t.glyphs=[],l===1&&o.readMessage(TD,t)}function TD(l,t,o){if(l===3){const{id:u,bitmap:m,width:h,height:g,left:b,top:E,advance:A}=o.readMessage(CD,{});t.glyphs.push({id:u,bitmap:new iu({width:h+2*Tb,height:g+2*Tb},m),metrics:{width:h,height:g,left:b,top:E,advance:A}})}else l===4?t.ascender=o.readSVarint():l===5&&(t.descender=o.readSVarint())}function CD(l,t,o){l===1?t.id=o.readVarint():l===2?t.bitmap=o.readBytes():l===3?t.width=o.readVarint():l===4?t.height=o.readVarint():l===5?t.left=o.readSVarint():l===6?t.top=o.readSVarint():l===7&&(t.advance=o.readVarint())}const TC=Tb,Va={horizontal:1,vertical:2,horizontalOnly:3};class qm{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(t,o){const u=new qm;return u.scale=t||1,u.fontStack=o,u}static forImage(t){const o=new qm;return o.image=t,o}}class _f{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(t,o){const u=new _f;for(let m=0;m<t.sections.length;m++){const h=t.sections[m];h.image?u.addImageSection(h):u.addTextSection(h,o)}return u}length(){return this.text.length}getSection(t){return this.sections[this.sectionIndex[t]]}getSections(){return this.sections}getSectionIndex(t){return this.sectionIndex[t]}getCodePoint(t){return this.text.codePointAt(t)}verticalizePunctuation(t){this.text=function(o,u){let m="";for(let h=0;h<o.length;h++){const g=o.charCodeAt(h+1)||null,b=o.charCodeAt(h-1)||null;m+=!u&&(g&&Hd(g)&&!Wm[o[h+1]]||b&&Hd(b)&&!Wm[o[h-1]])||!Wm[o[h]]?o[h]:Wm[o[h]]}return m}(this.text,t)}trim(){let t=0;for(let u=0;u<this.text.length&&ly[this.text.charCodeAt(u)];u++)t++;let o=this.text.length;for(let u=this.text.length-1;u>=0&&u>=t&&ly[this.text.charCodeAt(u)];u--)o--;this.text=this.text.substring(t,o),this.sectionIndex=this.sectionIndex.slice(t,o)}substring(t,o){const u=new _f;return u.text=this.text.substring(t,o),u.sectionIndex=this.sectionIndex.slice(t,o),u.sections=this.sections,u}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((t,o)=>Math.max(t,this.sections[o].scale),0)}addTextSection(t,o){this.text+=t.text,this.sections.push(qm.forText(t.scale,t.fontStack||o));const u=this.sections.length-1;for(let m=0;m<t.text.length;++m)this.sectionIndex.push(u)}addImageSection(t){const o=t.image&&t.image.namePrimary?t.image.getPrimary():null;if(!o)return void gr("Can't add FormattedSection with an empty image.");const u=this.getNextImageSectionCharCode();u?(this.text+=String.fromCodePoint(u),this.sections.push(qm.forImage(o)),this.sectionIndex.push(this.sections.length-1)):gr("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Cb(l,t,o,u,m,h,g,b,E,A,v,C,I,S,M){const R=_f.fromFeature(l,m);C===Va.vertical&&R.verticalizePunctuation(I);let O=[];const F=function(Y,ne,ye,_e,ge,Re){if(!Y)return[];const we=[],Le=function(We,Qe,Ge,ut,It,dt){let Dt=0;for(let kt=0;kt<We.length();kt++){const $t=We.getSection(kt);Dt+=CC(We.getCodePoint(kt),$t,ut,It,Qe,dt)}return Dt/Math.max(1,Math.ceil(Dt/Ge))}(Y,ne,ye,_e,ge,Re),Be=Y.text.indexOf("​")>=0;let Oe=0;for(let We=0;We<Y.length();We++){const Qe=Y.getSection(We),Ge=Y.getCodePoint(We);if(ly[Ge]||(Oe+=CC(Ge,Qe,_e,ge,ne,Re)),We<Y.length()-1){const ut=!((Ve=Ge)<11904||!(nr["Bopomofo Extended"](Ve)||nr.Bopomofo(Ve)||nr["CJK Compatibility Forms"](Ve)||nr["CJK Compatibility Ideographs"](Ve)||nr["CJK Compatibility"](Ve)||nr["CJK Radicals Supplement"](Ve)||nr["CJK Strokes"](Ve)||nr["CJK Symbols and Punctuation"](Ve)||nr["CJK Unified Ideographs Extension A"](Ve)||nr["CJK Unified Ideographs"](Ve)||nr["Enclosed CJK Letters and Months"](Ve)||nr["Halfwidth and Fullwidth Forms"](Ve)||nr.Hiragana(Ve)||nr["Ideographic Description Characters"](Ve)||nr["Kangxi Radicals"](Ve)||nr["Katakana Phonetic Extensions"](Ve)||nr.Katakana(Ve)||nr["Vertical Forms"](Ve)||nr["Yi Radicals"](Ve)||nr["Yi Syllables"](Ve)));(MD[Ge]||ut||Qe.image)&&we.push(IC(We+1,Oe,Le,we,ID(Ge,Y.getCodePoint(We+1),ut&&Be),!1))}}var Ve;return PC(IC(Y.length(),Oe,Le,we,0,!0))}(R,A,h,t,u,S),{processBidirectionalText:H,processStyledBidirectionalText:W}=Qo;if(H&&R.sections.length===1){const Y=H(R.toString(),F);for(const ne of Y){const ye=new _f;ye.text=ne,ye.sections=R.sections;for(let _e=0;_e<ne.length;_e++)ye.sectionIndex.push(0);O.push(ye)}}else if(W){const Y=W(R.text,R.sectionIndex,F);for(const ne of Y){const ye=new _f;ye.text=ne[0],ye.sectionIndex=ne[1],ye.sections=R.sections,O.push(ye)}}else O=function(Y,ne){const ye=[],_e=Y.text;let ge=0;for(const Re of ne)ye.push(Y.substring(ge,Re)),ge=Re;return ge<_e.length&&ye.push(Y.substring(ge,_e.length)),ye}(R,F);const V=[],Z={positionedLines:V,text:R.toString(),top:v[1],bottom:v[1],left:v[0],right:v[0],writingMode:C,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Y,ne,ye,_e,ge,Re,we,Le,Be,Oe,Ve,We){let Qe=0,Ge=0,ut=0;const It=Le==="right"?1:Le==="left"?0:.5;let dt=!1;for(const Ot of ge){const Kt=Ot.getSections();for(const hr of Kt){if(hr.image)continue;const Ar=ne[hr.fontStack];if(Ar&&(dt=Ar.ascender!==void 0&&Ar.descender!==void 0,!dt))break}if(!dt)break}let Dt=0;for(const Ot of ge){Ot.trim();const Kt=Ot.getMaxScale(),hr=(Kt-1)*go,Ar={positionedGlyphs:[],lineOffset:0};Y.positionedLines[Dt]=Ar;const kr=Ar.positionedGlyphs;let jr=0;if(!Ot.length()){Ge+=Re,++Dt;continue}let Dr=0,Zr=0;for(let vn=0;vn<Ot.length();vn++){const Tr=Ot.getSection(vn),xn=Ot.getSectionIndex(vn),mn=Ot.getCodePoint(vn);let Mn=Tr.scale,Ti=null,Ci=null,gi=null,na=go,Wn=0;const Xn=!(Be===Va.horizontal||!Ve&&!Gd(mn)||Ve&&(ly[mn]||(kt=mn,nr.Arabic(kt)||nr["Arabic Supplement"](kt)||nr["Arabic Extended-A"](kt)||nr["Arabic Presentation Forms-A"](kt)||nr["Arabic Presentation Forms-B"](kt))));if(Tr.image){const jo=_e[Tr.image.serialize()];if(!jo)continue;gi=Tr.image.id,Y.iconsInText=Y.iconsInText||!0,Ci=jo.paddedRect;const Mi=jo.displaySize;Mn=Mn*go/We,Ti={width:Mi[0],height:Mi[1],left:0,top:-TC,advance:Xn?Mi[1]:Mi[0],localGlyph:!1},Wn=dt?-Ti.height*Mn:Kt*go-17-Mi[1]*Mn,na=Ti.advance;const ha=(Xn?Mi[0]:Mi[1])*Mn-go*Kt;ha>0&&ha>jr&&(jr=ha)}else{const jo=ye[Tr.fontStack];if(!jo)continue;jo[mn]&&(Ci=jo[mn]);const Mi=ne[Tr.fontStack];if(!Mi)continue;const ha=Mi.glyphs[mn];if(!ha)continue;if(Ti=ha.metrics,na=mn!==8203?go:0,dt){const Fi=Mi.ascender!==void 0?Math.abs(Mi.ascender):0,zl=Mi.descender!==void 0?Math.abs(Mi.descender):0,hu=(Fi+zl)*Mn;Dr<hu&&(Dr=hu,Zr=(Fi-zl)/2*Mn),Wn=-Fi*Mn}else Wn=(Kt-Mn)*go-17}Xn?(Y.verticalizable=!0,kr.push({glyph:mn,imageName:gi,x:Qe,y:Ge+Wn,vertical:Xn,scale:Mn,localGlyph:Ti.localGlyph,fontStack:Tr.fontStack,sectionIndex:xn,metrics:Ti,rect:Ci}),Qe+=na*Mn+Oe):(kr.push({glyph:mn,imageName:gi,x:Qe,y:Ge+Wn,vertical:Xn,scale:Mn,localGlyph:Ti.localGlyph,fontStack:Tr.fontStack,sectionIndex:xn,metrics:Ti,rect:Ci}),Qe+=Ti.advance*Mn+Oe)}kr.length!==0&&(ut=Math.max(Qe-Oe,ut),dt?AC(kr,It,jr,Zr,Re*Kt/2):AC(kr,It,jr,0,Re/2)),Qe=0;const Cn=Re*Kt+jr;Ar.lineOffset=Math.max(jr,hr),Ge+=Cn,++Dt}var kt;const $t=Ge,{horizontalAlign:_t,verticalAlign:er}=Mb(we);(function(Ot,Kt,hr,Ar,kr,jr){const Dr=(Kt-hr)*kr,Zr=-jr*Ar;for(const Cn of Ot)for(const vn of Cn.positionedGlyphs)vn.x+=Dr,vn.y+=Zr})(Y.positionedLines,It,_t,er,ut,$t),Y.top+=-er*$t,Y.bottom=Y.top+$t,Y.left+=-_t*ut,Y.right=Y.left+ut,Y.hasBaseline=dt}(Z,t,o,u,O,g,b,E,C,A,I,M),!function(Y){for(const ne of Y)if(ne.positionedGlyphs.length!==0)return!1;return!0}(V)&&Z}const ly={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},MD={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function CC(l,t,o,u,m,h){if(t.image){const g=u[t.image.serialize()];return g?g.displaySize[0]*t.scale*go/h+m:0}{const g=o[t.fontStack],b=g&&g.glyphs[l];return b?b.metrics.advance*t.scale+m:0}}function MC(l,t,o,u){const m=Math.pow(l-t,2);return u?l<t?m/2:2*m:m+Math.abs(o)*o}function ID(l,t,o){let u=0;return l===10&&(u-=1e4),o&&(u+=150),l!==40&&l!==65288||(u+=50),t!==41&&t!==65289||(u+=50),u}function IC(l,t,o,u,m,h){let g=null,b=MC(t,o,m,h);for(const E of u){const A=MC(t-E.x,o,m,h)+E.badness;A<=b&&(g=E,b=A)}return{index:l,x:t,priorBreak:g,badness:b}}function PC(l){return l?PC(l.priorBreak).concat(l.index):[]}function Mb(l){let t=.5,o=.5;switch(l){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0}switch(l){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:t,verticalAlign:o}}function AC(l,t,o,u,m){if(!(t||o||u||m))return;const h=l.length-1,g=l[h],b=(g.x+g.metrics.advance*g.scale)*t;for(let E=0;E<=h;E++)l[E].x-=b,l[E].y+=o+u+m}function PD(l,t,o,u){const{horizontalAlign:m,verticalAlign:h}=Mb(u),g=o[0]-l.displaySize[0]*m,b=o[1]-l.displaySize[1]*h;return{imagePrimary:l,imageSecondary:t,top:b,bottom:b+l.displaySize[1],left:g,right:g+l.displaySize[0]}}function RC(l,t,o,u,m,h){const g=l.imagePrimary;let b;if(g.content){const O=g.content,F=g.pixelRatio||1;b=[O[0]/F,O[1]/F,g.displaySize[0]-O[2]/F,g.displaySize[1]-O[3]/F]}const E=t.left*h,A=t.right*h;let v,C,I,S;o==="width"||o==="both"?(S=m[0]+E-u[3],C=m[0]+A+u[1]):(S=m[0]+(E+A-g.displaySize[0])/2,C=S+g.displaySize[0]);const M=t.top*h,R=t.bottom*h;return o==="height"||o==="both"?(v=m[1]+M-u[0],I=m[1]+R+u[2]):(v=m[1]+(M+R-g.displaySize[1])/2,I=v+g.displaySize[1]),{imagePrimary:g,imageSecondary:void 0,top:v,right:C,bottom:I,left:S,collisionPadding:b}}class fc extends wt{constructor(t,o,u,m,h){super(t,o),this.angle=m,this.z=u,h!==void 0&&(this.segment=h)}clone(){return new fc(this.x,this.y,this.z,this.angle,this.segment)}}function zC(l,t,o,u,m){if(t.segment===void 0)return!0;let h=t,g=t.segment+1,b=0;for(;b>-o/2;){if(g--,g<0)return!1;b-=l[g].dist(h),h=l[g]}b+=l[g].dist(l[g+1]),g++;const E=[];let A=0;for(;b<o/2;){const v=l[g],C=l[g+1];if(!C)return!1;let I=l[g-1].angleTo(v)-v.angleTo(C);for(I=Math.abs((I+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:b,angleDelta:I}),A+=I;b-E[0].distance>u;)A-=E.shift().angleDelta;if(A>m)return!1;g++,b+=v.dist(C)}return!0}function LC(l){let t=0;for(let o=0;o<l.length-1;o++)t+=l[o].dist(l[o+1]);return t}function kC(l,t,o){return l?.6*t*o:0}function DC(l,t){return Math.max(l?l.right-l.left:0,t?t.right-t.left:0)}function AD(l,t,o,u,m,h){const g=kC(o,m,h),b=DC(o,u)*h;let E=0;const A=LC(l)/2;for(let v=0;v<l.length-1;v++){const C=l[v],I=l[v+1],S=C.dist(I);if(E+S>A){const M=(A-E)/S,R=ur(C.x,I.x,M),O=ur(C.y,I.y,M),F=new fc(R,O,0,I.angleTo(C),v);return!g||zC(l,F,b,g,t)?F:void 0}E+=S}}function RD(l,t,o,u,m,h,g,b,E){const A=kC(u,h,g),v=DC(u,m),C=v*g,I=l[0].x===0||l[0].x===E||l[0].y===0||l[0].y===E;return t-C<t/4&&(t=C+t/4),OC(l,I?t/2*b%t:(v/2+2*h)*g*b%t,t,A,o,C,I,!1,E)}function OC(l,t,o,u,m,h,g,b,E){const A=h/2,v=LC(l);let C=0,I=t-o,S=[];for(let M=0;M<l.length-1;M++){const R=l[M],O=l[M+1],F=R.dist(O),H=O.angleTo(R);for(;I+o<C+F;){I+=o;const W=(I-C)/F,V=ur(R.x,O.x,W),Z=ur(R.y,O.y,W);if(V>=0&&V<E&&Z>=0&&Z<E&&I-A>=0&&I+A<=v){const Y=new fc(V,Z,0,H,M);u&&!zC(l,Y,h,u,m)||S.push(Y)}}C+=F}return b||S.length||g||(S=OC(l,C/2,o,u,m,h,g,!0,E)),S}function FC(l,t,o,u,m){const h=[];for(let g=0;g<l.length;g++){const b=l[g];let E;for(let A=0;A<b.length-1;A++){let v=b[A],C=b[A+1];v.x<t&&C.x<t||(v.x<t?v=new wt(t,v.y+(t-v.x)/(C.x-v.x)*(C.y-v.y))._round():C.x<t&&(C=new wt(t,v.y+(t-v.x)/(C.x-v.x)*(C.y-v.y))._round()),v.y<o&&C.y<o||(v.y<o?v=new wt(v.x+(o-v.y)/(C.y-v.y)*(C.x-v.x),o)._round():C.y<o&&(C=new wt(v.x+(o-v.y)/(C.y-v.y)*(C.x-v.x),o)._round()),v.x>=u&&C.x>=u||(v.x>=u?v=new wt(u,v.y+(u-v.x)/(C.x-v.x)*(C.y-v.y))._round():C.x>=u&&(C=new wt(u,v.y+(u-v.x)/(C.x-v.x)*(C.y-v.y))._round()),v.y>=m&&C.y>=m||(v.y>=m?v=new wt(v.x+(m-v.y)/(C.y-v.y)*(C.x-v.x),m)._round():C.y>=m&&(C=new wt(v.x+(m-v.y)/(C.y-v.y)*(C.x-v.x),m)._round()),E&&v.equals(E[E.length-1])||(E=[v],h.push(E)),E.push(C)))))}}return h}function BC(l){let t=0,o=0;for(const g of l)t+=g.w*g.h,o=Math.max(o,g.w);l.sort((g,b)=>b.h-g.h);const u=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(t/.95)),o),h:1/0}];let m=0,h=0;for(const g of l)for(let b=u.length-1;b>=0;b--){const E=u[b];if(!(g.w>E.w||g.h>E.h)){if(g.x=E.x,g.y=E.y,h=Math.max(h,g.y+g.h),m=Math.max(m,g.x+g.w),g.w===E.w&&g.h===E.h){const A=u.pop();b<u.length&&(u[b]=A)}else g.h===E.h?(E.x+=g.w,E.w-=g.w):g.w===E.w?(E.y+=g.h,E.h-=g.h):(u.push({x:E.x+g.w,y:E.y,w:E.w-g.w,h:g.h}),E.y+=g.h,E.h-=g.h);break}}return{w:m,h,fill:t/(m*h)||0}}Yt(fc,"Anchor");const Zm=1;class Ib{constructor(t,{pixelRatio:o,version:u,stretchX:m,stretchY:h,content:g},b){this.paddedRect=t,this.pixelRatio=o,this.stretchX=m,this.stretchY=h,this.content=g,this.version=u,this.padding=b}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.pixelRatio,(this.paddedRect.h-2*this.padding)/this.pixelRatio]}}class NC{constructor(t,o,u){const m={},h={};this.haveRenderCallbacks=[];const g=[];this.addImages(t,m,Zm,g),this.addImages(o,h,2,g);const{w:b,h:E}=BC(g),A=new So({width:b||1,height:E||1});for(const v in t){const C=t[v],I=m[v].paddedRect;So.copy(C.data,A,{x:0,y:0},{x:I.x+Zm,y:I.y+Zm},C.data,u,C.sdf)}for(const v in o){const C=o[v],I=h[v].paddedRect;let S=h[v].padding;const M=I.x+S,R=I.y+S,O=C.data.width,F=C.data.height;S=S>1?S-1:S,So.copy(C.data,A,{x:0,y:0},{x:M,y:R},C.data,u),So.copy(C.data,A,{x:0,y:F-S},{x:M,y:R-S},{width:O,height:S},u),So.copy(C.data,A,{x:0,y:0},{x:M,y:R+F},{width:O,height:S},u),So.copy(C.data,A,{x:O-S,y:0},{x:M-S,y:R},{width:S,height:F},u),So.copy(C.data,A,{x:0,y:0},{x:M+O,y:R},{width:S,height:F},u),So.copy(C.data,A,{x:O-S,y:F-S},{x:M-S,y:R-S},{width:S,height:S},u),So.copy(C.data,A,{x:0,y:F-S},{x:M+O,y:R-S},{width:S,height:S},u),So.copy(C.data,A,{x:0,y:0},{x:M+O,y:R+F},{width:S,height:S},u),So.copy(C.data,A,{x:O-S,y:0},{x:M-S,y:R+F},{width:S,height:S},u)}this.image=A,this.iconPositions=m,this.patternPositions=h}addImages(t,o,u,m){for(const h in t){const g=t[h],b={x:0,y:0,w:g.data.width+2*u,h:g.data.height+2*u};m.push(b),o[h]=new Ib(b,g,u),g.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(t,o,u){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(m=>t.hasImage(m,u)),t.dispatchRenderCallbacks(this.haveRenderCallbacks,u);for(const m in t.getUpdatedImages(u)){const h=Li.build(m).getSerializedPrimary();this.patchUpdatedImage(this.iconPositions[h],t.getImage(m,u),o),this.patchUpdatedImage(this.patternPositions[h],t.getImage(m,u),o)}}patchUpdatedImage(t,o,u){if(!t||!o||t.version===o.version)return;t.version=o.version;const[m,h]=t.tl;u.update(o.data,{position:{x:m,y:h}})}}Yt(Ib,"ImagePosition"),Yt(NC,"ImageAtlas");const Xm=1e20;function jC(l,t,o,u,m,h,g,b,E){for(let A=t;A<t+u;A++)$C(l,o*h+A,h,m,g,b,E);for(let A=o;A<o+m;A++)$C(l,A*h+t,1,u,g,b,E)}function $C(l,t,o,u,m,h,g){h[0]=0,g[0]=-Xm,g[1]=Xm,m[0]=l[t];for(let b=1,E=0,A=0;b<u;b++){m[b]=l[t+b*o];const v=b*b;do{const C=h[E];A=(m[b]-m[C]+v-C*C)/(b-C)/2}while(A<=g[E]&&--E>-1);E++,h[E]=b,g[E]=A,g[E+1]=Xm}for(let b=0,E=0;b<u;b++){for(;g[E+1]<b;)E++;const A=h[E],v=b-A;l[t+b*o]=m[A]+v*v}}const Xs=2,Pb={none:0,ideographs:1,all:2};class yf{constructor(t,o,u){this.requestManager=t,this.localGlyphMode=o,this.localFontFamily=u,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(t,o){this.urls[o]=t}getGlyphs(t,o,u){const m=[],h=this.urls[o]||K.GLYPHS_URL;for(const g in t)for(const b of t[g])m.push({stack:g,id:b});Kn(m,({stack:g,id:b},E)=>{let A=this.entries[g];A||(A=this.entries[g]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let v=A.glyphs[b];if(v!==void 0)return void E(null,{stack:g,id:b,glyph:v});if(v=this._tinySDF(A,g,b),v)return A.glyphs[b]=v,void E(null,{stack:g,id:b,glyph:v});const C=Math.floor(b/256);if(256*C>65535)return gr("glyphs > 65535 not supported"),void E(null,{stack:g,id:b,glyph:v});if(A.ranges[C])return void E(null,{stack:g,id:b,glyph:v});let I=A.requests[C];I||(I=A.requests[C]=[],yf.loadGlyphRange(g,C,h,this.requestManager,(S,M)=>{if(M){A.ascender=M.ascender,A.descender=M.descender;for(const R in M.glyphs)this._doesCharSupportLocalGlyph(+R)||(A.glyphs[+R]=M.glyphs[+R]);A.ranges[C]=!0}for(const R of I)R(S,M);delete A.requests[C]})),I.push((S,M)=>{S?E(S):M&&E(null,{stack:g,id:b,glyph:M.glyphs[b]||null})})},(g,b)=>{if(g)u(g);else if(b){const E={};for(const{stack:A,id:v,glyph:C}of b)E[A]===void 0&&(E[A]={}),E[A].glyphs===void 0&&(E[A].glyphs={}),E[A].glyphs[v]=C&&{id:C.id,bitmap:C.bitmap.clone(),metrics:C.metrics},E[A].ascender=this.entries[A].ascender,E[A].descender=this.entries[A].descender;u(null,E)}})}_doesCharSupportLocalGlyph(t){return this.localGlyphMode!==Pb.none&&(this.localGlyphMode===Pb.all?!!this.localFontFamily:!!this.localFontFamily&&(nr["CJK Unified Ideographs"](t)||nr["Hangul Syllables"](t)||nr.Hiragana(t)||nr.Katakana(t)||nr["CJK Symbols and Punctuation"](t)||nr["CJK Unified Ideographs Extension A"](t)||nr["CJK Unified Ideographs Extension B"](t)||nr.Osage(t)))}_tinySDF(t,o,u){const m=this.localFontFamily;if(!m||!this._doesCharSupportLocalGlyph(u))return;let h=t.tinySDF;if(!h){let R="400";/bold/i.test(o)?R="900":/medium/i.test(o)?R="500":/light/i.test(o)&&(R="200"),h=t.tinySDF=new yf.TinySDF({fontFamily:m,fontWeight:R,fontSize:24*Xs,buffer:3*Xs,radius:8*Xs}),h.fontWeight=R}if(this.localGlyphs[h.fontWeight][u])return this.localGlyphs[h.fontWeight][u];const g=String.fromCodePoint(u),{data:b,width:E,height:A,glyphWidth:v,glyphHeight:C,glyphLeft:I,glyphTop:S,glyphAdvance:M}=h.draw(g);return this.localGlyphs[h.fontWeight][u]={id:u,bitmap:new iu({width:E,height:A},b),metrics:{width:v/Xs,height:C/Xs,left:I/Xs,top:S/Xs-27,advance:M/Xs,localGlyph:!0}}}}yf.loadGlyphRange=function(l,t,o,u,m){const h=256*t,g=h+255,b=u.transformRequest(u.normalizeGlyphsURL(o).replace("{fontstack}",l).replace("{range}",`${h}-${g}`),wi.Glyphs);zi(b,(E,A)=>{if(E)m(E);else if(A){const v={},C=function(I){return new sy(I).readFields(ED,{})}(A);for(const I of C.glyphs)v[I.id]=I;m(null,{glyphs:v,ascender:C.ascender,descender:C.descender})}})},yf.TinySDF=class{constructor({fontSize:l=24,buffer:t=3,radius:o=8,cutoff:u=.25,fontFamily:m="sans-serif",fontWeight:h="normal",fontStyle:g="normal"}={}){this.buffer=t,this.cutoff=u,this.radius=o;const b=this.size=l+4*t,E=this._createCanvas(b),A=this.ctx=E.getContext("2d",{willReadFrequently:!0});A.font=`${g} ${h} ${l}px ${m}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(l){const t=document.createElement("canvas");return t.width=t.height=l,t}draw(l){const{width:t,actualBoundingBoxAscent:o,actualBoundingBoxDescent:u,actualBoundingBoxLeft:m,actualBoundingBoxRight:h}=this.ctx.measureText(l),g=Math.ceil(o),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(h-m))),E=Math.min(this.size-this.buffer,g+Math.ceil(u)),A=b+2*this.buffer,v=E+2*this.buffer,C=Math.max(A*v,0),I=new Uint8ClampedArray(C),S={data:I,width:A,height:v,glyphWidth:b,glyphHeight:E,glyphTop:g,glyphLeft:0,glyphAdvance:t};if(b===0||E===0)return S;const{ctx:M,buffer:R,gridInner:O,gridOuter:F}=this;M.clearRect(R,R,b,E),M.fillText(l,R,R+g);const H=M.getImageData(R,R,b,E);F.fill(Xm,0,C),O.fill(0,0,C);for(let W=0;W<E;W++)for(let V=0;V<b;V++){const Z=H.data[4*(W*b+V)+3]/255;if(Z===0)continue;const Y=(W+R)*A+V+R;if(Z===1)F[Y]=0,O[Y]=Xm;else{const ne=.5-Z;F[Y]=ne>0?ne*ne:0,O[Y]=ne<0?ne*ne:0}}jC(F,0,0,A,v,A,this.f,this.v,this.z),jC(O,R,R,b,E,A,this.f,this.v,this.z);for(let W=0;W<C;W++){const V=Math.sqrt(F[W])-Math.sqrt(O[W]);I[W]=Math.round(255-255*(V/this.radius+this.cutoff))}return S}};const au=Zm;function VC(l,t){return l+t[1]-t[0]}function UC(l,t,o,u,m=1){const h=[],g=l.imagePrimary,b=g.pixelRatio,E=g.paddedRect.w-2*au,A=g.paddedRect.h-2*au,v=(l.right-l.left)*m,C=(l.bottom-l.top)*m,I=g.stretchX||[[0,E]],S=g.stretchY||[[0,A]],M=I.reduce(VC,0),R=S.reduce(VC,0),O=E-M,F=A-R;let H=0,W=M,V=0,Z=R,Y=0,ne=O,ye=0,_e=F;if(g.content&&u){const Re=g.content;H=cy(I,0,Re[0]),V=cy(S,0,Re[1]),W=cy(I,Re[0],Re[2]),Z=cy(S,Re[1],Re[3]),Y=Re[0]-H,ye=Re[1]-V,ne=Re[2]-Re[0]-W,_e=Re[3]-Re[1]-Z}const ge=(Re,we,Le,Be)=>{const Oe=uy(Re.stretch-H,W,v,l.left*m),Ve=hy(Re.fixed-Y,ne,Re.stretch,M),We=uy(we.stretch-V,Z,C,l.top*m),Qe=hy(we.fixed-ye,_e,we.stretch,R),Ge=uy(Le.stretch-H,W,v,l.left*m),ut=hy(Le.fixed-Y,ne,Le.stretch,M),It=uy(Be.stretch-V,Z,C,l.top*m),dt=hy(Be.fixed-ye,_e,Be.stretch,R),Dt=new wt(Oe,We),kt=new wt(Ge,We),$t=new wt(Ge,It),_t=new wt(Oe,It),er=new wt(Ve/b,Qe/b),Ot=new wt(ut/b,dt/b),Kt=t*Math.PI/180;if(Kt){const Zr=Math.sin(Kt),Cn=Math.cos(Kt),vn=[Cn,-Zr,Zr,Cn];Dt._matMult(vn),kt._matMult(vn),_t._matMult(vn),$t._matMult(vn)}const hr=Re.stretch+Re.fixed,Ar=Le.stretch+Le.fixed,kr=we.stretch+we.fixed,jr=Be.stretch+Be.fixed,Dr=l.imageSecondary;return{tl:Dt,tr:kt,bl:_t,br:$t,texPrimary:{x:g.paddedRect.x+au+hr,y:g.paddedRect.y+au+kr,w:Ar-hr,h:jr-kr},texSecondary:Dr?{x:Dr.paddedRect.x+au+hr,y:Dr.paddedRect.y+au+kr,w:Ar-hr,h:jr-kr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:er,pixelOffsetBR:Ot,minFontScaleX:ne/b/v,minFontScaleY:_e/b/C,isSDF:o}};if(u&&(g.stretchX||g.stretchY)){const Re=GC(I,O,M),we=GC(S,F,R);for(let Le=0;Le<Re.length-1;Le++){const Be=Re[Le],Oe=Re[Le+1];for(let Ve=0;Ve<we.length-1;Ve++)h.push(ge(Be,we[Ve],Oe,we[Ve+1]))}}else h.push(ge({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:A+1}));return h}function cy(l,t,o){let u=0;for(const m of l)u+=Math.max(t,Math.min(o,m[1]))-Math.max(t,Math.min(o,m[0]));return u}function GC(l,t,o){const u=[{fixed:-au,stretch:0}];for(const[m,h]of l){const g=u[u.length-1];u.push({fixed:m-g.stretch,stretch:g.stretch}),u.push({fixed:m-g.stretch,stretch:g.stretch+(h-m)})}return u.push({fixed:t+au,stretch:o}),u}function uy(l,t,o,u){return l/t*o+u}function hy(l,t,o,u){return l-t*o/u}function zD(l,t,o,u){const m=t+l.positionedLines[u].lineOffset;return u===0?o+m/2:o+(m+(t+l.positionedLines[u-1].lineOffset))/2}function LD(l,t=1,o=!1){let u=1/0,m=1/0,h=-1/0,g=-1/0;const b=l[0];for(let S=0;S<b.length;S++){const M=b[S];(!S||M.x<u)&&(u=M.x),(!S||M.y<m)&&(m=M.y),(!S||M.x>h)&&(h=M.x),(!S||M.y>g)&&(g=M.y)}const E=Math.min(h-u,g-m);let A=E/2;const v=new Sd([],kD);if(E===0)return new wt(u,m);for(let S=u;S<h;S+=E)for(let M=m;M<g;M+=E)v.push(new vf(S+A,M+A,A,l));let C=function(S){let M=0,R=0,O=0;const F=S[0];for(let H=0,W=F.length,V=W-1;H<W;V=H++){const Z=F[H],Y=F[V],ne=Z.x*Y.y-Y.x*Z.y;R+=(Z.x+Y.x)*ne,O+=(Z.y+Y.y)*ne,M+=3*ne}return new vf(R/M,O/M,0,S)}(l),I=v.length;for(;v.length;){const S=v.pop();(S.d>C.d||!C.d)&&(C=S,o&&console.log("found best %d after %d probes",Math.round(1e4*S.d)/1e4,I)),S.max-C.d<=t||(A=S.h/2,v.push(new vf(S.p.x-A,S.p.y-A,A,l)),v.push(new vf(S.p.x+A,S.p.y-A,A,l)),v.push(new vf(S.p.x-A,S.p.y+A,A,l)),v.push(new vf(S.p.x+A,S.p.y+A,A,l)),I+=4)}return o&&(console.log(`num probes: ${I}`),console.log(`best distance: ${C.d}`)),C.p}function kD(l,t){return t.max-l.max}class vf{constructor(t,o,u,m){this.p=new wt(t,o),this.h=u,this.d=function(h,g){let b=!1,E=1/0;for(let A=0;A<g.length;A++){const v=g[A];for(let C=0,I=v.length,S=I-1;C<I;S=C++){const M=v[C],R=v[S];M.y>h.y!=R.y>h.y&&h.x<(R.x-M.x)*(h.y-M.y)/(R.y-M.y)+M.x&&(b=!b),E=Math.min(E,Ce(h,M,R))}}return(b?1:-1)*Math.sqrt(E)}(this.p,m),this.max=this.d+this.h*Math.SQRT2}}const Ab=Number.POSITIVE_INFINITY,DD=Math.sqrt(2);function HC(l,[t,o]){let u=0,m=0;if(o===Ab){t<0&&(t=0);const h=t/DD;switch(l){case"top-right":case"top-left":m=h-7;break;case"bottom-right":case"bottom-left":m=7-h;break;case"bottom":m=7-t;break;case"top":m=t-7}switch(l){case"top-right":case"bottom-right":u=-h;break;case"top-left":case"bottom-left":u=h;break;case"left":u=t;break;case"right":u=-t}}else{switch(t=Math.abs(t),o=Math.abs(o),l){case"top-right":case"top-left":case"top":m=o-7;break;case"bottom-right":case"bottom-left":case"bottom":m=7-o}switch(l){case"top-right":case"bottom-right":case"right":u=-t;break;case"top-left":case"bottom-left":case"left":u=t}}return[u,m]}function Rb(l){switch(l){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function OD(l,t,o,u,m,h,g,b,E,A,v,C,I,S,M,R){let O=h.textMaxSize.evaluate(t,{},I);O===void 0?O=g*h.textScaleFactor:O*=h.textScaleFactor;const F=l.layers[0].layout,H=F.get("icon-offset").evaluate(t,{},I),W=qC(o.horizontal)||o.vertical,V=S.name==="globe",Z=go,Y=g*h.textScaleFactor/Z,ne=l.tilePixelRatio*O/Z,ye=(Ve=l.overscaling,l.zoom>18&&Ve>2&&(Ve>>=1),Math.max(Nt/(512*Ve),1)*F.get("symbol-spacing")),_e=F.get("text-padding")*l.tilePixelRatio,ge=F.get("icon-padding")*l.tilePixelRatio,Re=ar(F.get("text-max-angle")),we=F.get("text-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",Le=F.get("icon-rotation-alignment")==="map"&&F.get("symbol-placement")!=="point",Be=F.get("symbol-placement"),Oe=ye/2;var Ve;const We=F.get("icon-text-fit").evaluate(t,{},I),Qe=F.get("icon-text-fit-padding").evaluate(t,{},I),Ge=We!=="none";let ut;l.hasAnyIconTextFit===!1&&Ge&&(l.hasAnyIconTextFit=!0),u&&Ge&&(l.allowVerticalPlacement&&o.vertical&&(ut=RC(u,o.vertical,We,Qe,H,Y)),W&&(u=RC(u,W,We,Qe,H,Y)));const It=(dt,Dt,kt)=>{if(Dt.x<0||Dt.x>=Nt||Dt.y<0||Dt.y>=Nt)return;let $t=null;if(V){const{x:_t,y:er,z:Ot}=S.projectTilePoint(Dt.x,Dt.y,kt);$t={anchor:new fc(_t,er,Ot,0,void 0),up:S.upVector(kt,Dt.x,Dt.y)}}(function(_t,er,Ot,Kt,hr,Ar,kr,jr,Dr,Zr,Cn,vn,Tr,xn,mn,Mn,Ti,Ci,gi,na,Wn,Xn,jo,Mi,ha,Fi,zl,hu){const du=_t.addToLineVertexArray(er,Kt);let pc,fu,pu,By,TM,CM,MM,IM=0,PM=0,AM=0,RM=0,dw=-1,fw=-1;const Ll={};let zM=Rs("");const Rh=Ot?Ot.anchor:er,pw=Dr.layout.get("icon-text-fit").evaluate(Wn,{},Fi)!=="none";let mw=0,gw=0;if(Dr._unevaluatedLayout.getValue("text-radial-offset")===void 0?[mw,gw]=Dr.layout.get("text-offset").evaluate(Wn,{},Fi).map(Ga=>Ga*go):(mw=Dr.layout.get("text-radial-offset").evaluate(Wn,{},Fi)*go,gw=Ab),_t.allowVerticalPlacement&&hr.vertical){const Ga=hr.vertical;if(mn)CM=zb(Ga),jr&&(MM=zb(jr));else{const Ma=Dr.layout.get("text-rotate").evaluate(Wn,{},Fi)+90;pu=dy(Zr,Rh,er,Cn,vn,Tr,Ga,xn,Ma,Mn),jr&&(By=dy(Zr,Rh,er,Cn,vn,Tr,jr,Ci,Ma))}}if(Ar){const Ga=_t.iconSizeData,Ma=Mi?oy(_t.iconSizeData,_t.layers[0]._unevaluatedLayout._values["icon-size"],Fi,_t.zoom,Wn):1,Af=Dr.layout.get("icon-rotate").evaluate(Wn,{},Fi),LM=UC(Ar,Af,jo,pw,Mi?1/Ma:Xn.iconScaleFactor),yw=jr?UC(jr,Af,jo,pw,Xn.iconScaleFactor):void 0;fu=dy(Zr,Rh,er,Cn,vn,Tr,Ar,Ci,Af,null,Mi?Xn.iconScaleFactor*Ma:1),IM=4*LM.length;let zh=null;Ga.kind==="source"?(zh=[Zs*Dr.layout.get("icon-size").evaluate(Wn,{},Fi)*Xn.iconScaleFactor],zh[0]>su&&gr(`${_t.layerIds[0]}: Value for "icon-size" is >= ${Ym}. Reduce your "icon-size".`)):Ga.kind==="composite"&&(zh=[Zs*Xn.compositeIconSizes[0].evaluate(Wn,{},Fi)*Xn.iconScaleFactor,Zs*Xn.compositeIconSizes[1].evaluate(Wn,{},Fi)*Xn.iconScaleFactor],(zh[0]>su||zh[1]>su)&&gr(`${_t.layerIds[0]}: Value for "icon-size" is >= ${Ym}. Reduce your "icon-size".`)),_t.addSymbols(_t.icon,LM,zh,na,gi,Wn,!1,Ot,er,du.lineStartIndex,du.lineLength,-1,ha,Fi,zl,hu),dw=_t.icon.placedSymbolArray.length-1,yw&&(PM=4*yw.length,_t.addSymbols(_t.icon,yw,zh,na,gi,Wn,Va.vertical,Ot,er,du.lineStartIndex,du.lineLength,-1,ha,Fi,zl,hu),fw=_t.icon.placedSymbolArray.length-1)}for(const Ga in hr.horizontal){const Ma=hr.horizontal[Ga];pc||(zM=Rs(Ma.text),mn?TM=zb(Ma):pc=dy(Zr,Rh,er,Cn,vn,Tr,Ma,xn,Dr.layout.get("text-rotate").evaluate(Wn,{},Fi),Mn));const Af=Ma.positionedLines.length===1;if(AM+=WC(_t,Ot,er,Ma,kr,Dr,mn,Wn,Mn,du,hr.vertical?Va.horizontal:Va.horizontalOnly,Af?Object.keys(hr.horizontal):[Ga],Ll,dw,Xn,ha,Fi,zl),Af)break}hr.vertical&&(RM+=WC(_t,Ot,er,hr.vertical,kr,Dr,mn,Wn,Mn,du,Va.vertical,["vertical"],Ll,fw,Xn,ha,Fi,zl));let mu=-1;const _w=(Ga,Ma)=>Ga?Math.max(Ga,Ma):Ma;mu=_w(TM,mu),mu=_w(CM,mu),mu=_w(MM,mu);const mF=mu>-1?1:0;_t.glyphOffsetArray.length>=65535&&gr("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),Wn.sortKey!==void 0&&_t.addToSortKeyRanges(_t.symbolInstances.length,Wn.sortKey),_t.symbolInstances.emplaceBack(er.x,er.y,Rh.x,Rh.y,Rh.z,Ll.right>=0?Ll.right:-1,Ll.center>=0?Ll.center:-1,Ll.left>=0?Ll.left:-1,Ll.vertical>=0?Ll.vertical:-1,dw,fw,zM,pc!==void 0?pc:_t.collisionBoxArray.length,pc!==void 0?pc+1:_t.collisionBoxArray.length,pu!==void 0?pu:_t.collisionBoxArray.length,pu!==void 0?pu+1:_t.collisionBoxArray.length,fu!==void 0?fu:_t.collisionBoxArray.length,fu!==void 0?fu+1:_t.collisionBoxArray.length,By||_t.collisionBoxArray.length,By?By+1:_t.collisionBoxArray.length,Cn,AM,RM,IM,PM,mF,0,mw,gw,mu,0,pw?1:0)})(l,Dt,$t,dt,o,u,m,ut,l.layers[0],l.collisionBoxArray,t.index,t.sourceLayerIndex,l.index,_e,we,E,0,ge,Le,H,t,h,A,v,C,I,M,R)};if(Be==="line")for(const dt of FC(t.geometry,0,0,Nt,Nt)){const Dt=RD(dt,ye,Re,o.vertical||W,u,Z,ne,l.overscaling,Nt);for(const kt of Dt)W&&FD(l,W.text,Oe,kt)||It(dt,kt,I)}else if(Be==="line-center"){for(const dt of t.geometry)if(dt.length>1){const Dt=AD(dt,Re,o.vertical||W,u,Z,ne);Dt&&It(dt,Dt,I)}}else if(t.type==="Polygon")for(const dt of J0(t.geometry,0)){const Dt=LD(dt,16);It(dt[0],new fc(Dt.x,Dt.y,0,0,void 0),I)}else if(t.type==="LineString")for(const dt of t.geometry)It(dt,new fc(dt[0].x,dt[0].y,0,0,void 0),I);else if(t.type==="Point")for(const dt of t.geometry)for(const Dt of dt)It([Dt],new fc(Dt.x,Dt.y,0,0,void 0),I)}const Ym=255,su=Ym*Zs;function WC(l,t,o,u,m,h,g,b,E,A,v,C,I,S,M,R,O,F){const H=function(Z,Y,ne,ye,_e,ge,Re,we){const Le=[];if(Y.positionedLines.length===0)return Le;const Be=ye.layout.get("text-rotate").evaluate(ge,{})*Math.PI/180,Oe=function(ut){const It=ut[0],dt=ut[1],Dt=It*dt;return Dt>0?[It,-dt]:Dt<0?[-It,dt]:It===0?[dt,It]:[dt,-It]}(ne);let Ve=Math.abs(Y.top-Y.bottom);for(const ut of Y.positionedLines)Ve-=ut.lineOffset;const We=Y.positionedLines.length,Qe=Ve/We;let Ge=Y.top-ne[1];for(let ut=0;ut<We;++ut){const It=Y.positionedLines[ut];Ge=zD(Y,Qe,Ge,ut);for(const dt of It.positionedGlyphs){if(!dt.rect)continue;const Dt=dt.rect||{};let kt=TC+1,$t=!0,_t=1,er=0;if(dt.imageName){const gi=Re[Li.build(dt.imageName).getSerializedPrimary()];if(!gi)continue;if(gi.sdf){gr("SDF images are not supported in formatted text and will be ignored.");continue}$t=!1,_t=gi.pixelRatio,kt=Zm/_t}const Ot=(_e||we)&&dt.vertical,Kt=dt.metrics.advance*dt.scale/2,hr=dt.metrics,Ar=dt.rect;if(Ar===null)continue;we&&Y.verticalizable&&(er=dt.imageName?Kt-dt.metrics.width*dt.scale/2:0);const kr=_e?[dt.x+Kt,dt.y]:[0,0];let jr=[0,0],Dr=[0,0],Zr=!1;_e||(Ot?(Dr=[dt.x+Kt+Oe[0],dt.y+Oe[1]-er],Zr=!0):jr=[dt.x+Kt+ne[0],dt.y+ne[1]-er]);const Cn=Ar.w*dt.scale/(_t*(dt.localGlyph?Xs:1)),vn=Ar.h*dt.scale/(_t*(dt.localGlyph?Xs:1));let Tr,xn,mn,Mn;if(Ot){const gi=dt.y-Ge,na=new wt(-Kt,Kt-gi),Wn=-Math.PI/2,Xn=new wt(...Dr);Tr=new wt(-Kt+jr[0],jr[1]),Tr._rotateAround(Wn,na)._add(Xn),Tr.x+=-gi+Kt,Tr.y-=(hr.left-kt)*dt.scale;const jo=dt.imageName?hr.advance*dt.scale:go*dt.scale,Mi=String.fromCodePoint(dt.glyph);bD(Mi)?Tr.x+=(1-kt)*dt.scale:wD(Mi)?Tr.x+=jo-hr.height*dt.scale+(-kt-1)*dt.scale:Tr.x+=dt.imageName||hr.width+2*kt===Ar.w&&hr.height+2*kt===Ar.h?(jo-vn)/2:(jo-(hr.height+2*kt)*dt.scale)/2,xn=new wt(Tr.x,Tr.y-Cn),mn=new wt(Tr.x+vn,Tr.y),Mn=new wt(Tr.x+vn,Tr.y-Cn)}else{const gi=(hr.left-kt)*dt.scale-Kt+jr[0],na=(-hr.top-kt)*dt.scale+jr[1],Wn=gi+Cn,Xn=na+vn;Tr=new wt(gi,na),xn=new wt(Wn,na),mn=new wt(gi,Xn),Mn=new wt(Wn,Xn)}if(Be){let gi;gi=_e?new wt(0,0):Zr?new wt(Oe[0],Oe[1]):new wt(ne[0],ne[1]),Tr._rotateAround(Be,gi),xn._rotateAround(Be,gi),mn._rotateAround(Be,gi),Mn._rotateAround(Be,gi)}const Ti=new wt(0,0),Ci=new wt(0,0);Le.push({tl:Tr,tr:xn,bl:mn,br:Mn,texPrimary:Dt,texSecondary:void 0,writingMode:Y.writingMode,glyphOffset:kr,sectionIndex:dt.sectionIndex,isSDF:$t,pixelOffsetTL:Ti,pixelOffsetBR:Ci,minFontScaleX:0,minFontScaleY:0})}}return Le}(0,u,E,h,g,b,m,l.allowVerticalPlacement),W=l.textSizeData;let V=null;W.kind==="source"?(V=[Zs*h.layout.get("text-size").evaluate(b,{},O)*M.textScaleFactor],V[0]>su&&gr(`${l.layerIds[0]}: Value for "text-size" is >= ${Ym}. Reduce your "text-size".`)):W.kind==="composite"&&(V=[Zs*M.compositeTextSizes[0].evaluate(b,{},O)*M.textScaleFactor,Zs*M.compositeTextSizes[1].evaluate(b,{},O)*M.textScaleFactor],(V[0]>su||V[1]>su)&&gr(`${l.layerIds[0]}: Value for "text-size" is >= ${Ym}. Reduce your "text-size".`)),l.addSymbols(l.text,H,V,E,g,b,v,t,o,A.lineStartIndex,A.lineLength,S,R,O,F,!1);for(const Z of C)I[Z]=l.text.placedSymbolArray.length-1;return 4*H.length}function qC(l){for(const t in l)return l[t];return null}function dy(l,t,o,u,m,h,g,b,E,A,v=1){let C=g.top/v,I=g.bottom/v,S=g.left/v,M=g.right/v;const R=g.collisionPadding;if(R&&(S-=R[0],C-=R[1],M+=R[2],I+=R[3]),E){const O=new wt(S,C),F=new wt(M,C),H=new wt(S,I),W=new wt(M,I),V=ar(E);let Z=new wt(0,0);A&&(Z=new wt(A[0],A[1])),O._rotateAround(V,Z),F._rotateAround(V,Z),H._rotateAround(V,Z),W._rotateAround(V,Z),S=Math.min(O.x,F.x,H.x,W.x),M=Math.max(O.x,F.x,H.x,W.x),C=Math.min(O.y,F.y,H.y,W.y),I=Math.max(O.y,F.y,H.y,W.y)}return l.emplaceBack(t.x,t.y,t.z,o.x,o.y,S,C,M,I,b,u,m,h),l.length-1}function zb(l){l.collisionPadding&&(l.top-=l.collisionPadding[1],l.bottom+=l.collisionPadding[3]);const t=l.bottom-l.top;return t>0?Math.max(10,t):null}function FD(l,t,o,u){const m=l.compareText;if(t in m){const h=m[t];for(let g=h.length-1;g>=0;g--)if(u.dist(h[g])<o)return!0}else m[t]=[];return m[t].push(u),!1}function ZC(l,t){const o=l.fovAboveCenter,u=l.elevation?l.elevation.getMinElevationBelowMSL()*t:0,m=(l._camera.position[2]*l.worldSize-u)/Math.cos(l._pitch),h=Math.sin(o)*m/Math.sin(Math.max(Math.PI/2-l._pitch-o,.01));let g=Math.sin(l._pitch)*h+m;const b=m*(1/l._horizonShift);return l.elevation&&l.elevation.exaggeration()!==0||(g*=1+Math.max(l.zoom-17,0)),Math.min(1.01*g,b)}function Km(l,t){if(!t.isReprojectedInTileSpace)return{scale:1<<l.z,x:l.x,y:l.y,x2:l.x+1,y2:l.y+1,projection:t};const o=Math.pow(2,-l.z),u=l.x*o,m=(l.x+1)*o,h=l.y*o,g=(l.y+1)*o,b=ta(u),E=ta(m),A=Zi(h),v=Zi(g),C=t.project(b,A),I=t.project(E,A),S=t.project(E,v),M=t.project(b,v);let R=Math.min(C.x,I.x,S.x,M.x),O=Math.min(C.y,I.y,S.y,M.y),F=Math.max(C.x,I.x,S.x,M.x),H=Math.max(C.y,I.y,S.y,M.y);const W=o/16;function V(Y,ne,ye,_e,ge,Re){const we=(ye+ge)/2,Le=(_e+Re)/2,Be=t.project(ta(we),Zi(Le)),Oe=Math.max(0,R-Be.x,O-Be.y,Be.x-F,Be.y-H);R=Math.min(R,Be.x),F=Math.max(F,Be.x),O=Math.min(O,Be.y),H=Math.max(H,Be.y),Oe>W&&(V(Y,Be,ye,_e,we,Le),V(Be,ne,we,Le,ge,Re))}V(C,I,u,h,m,h),V(I,S,m,h,m,g),V(S,M,m,g,u,g),V(M,C,u,g,u,h),R-=W,O-=W,F+=W,H+=W;const Z=1/Math.max(F-R,H-O);return{scale:Z,x:R*Z,y:O*Z,x2:F*Z,y2:H*Z,projection:t}}function XC(l,{x:t,y:o},u=0){return new wt(((t-u)*l.scale-l.x)*Nt,(o*l.scale-l.y)*Nt)}const BD=Ae.mat4.identity(new Float32Array(16));class lu{constructor(t){this.spec=t,this.name=t.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(t,o){return{x:0,y:0,z:0}}unproject(t,o){return new rn(0,0)}projectTilePoint(t,o,u){return{x:t,y:o,z:0}}locationPoint(t,o,u=!0){return t._coordinatePoint(t.locationCoordinate(o),u)}pixelsPerMeter(t,o){return wo(1,t)*o}pixelSpaceConversion(t,o,u){return 1}farthestPixelDistance(t){return ZC(t,t.pixelsPerMeter)}pointCoordinate(t,o,u,m){const h=t.horizonLineFromTop(!1),g=new wt(o,Math.max(h,u));return t.rayIntersectionCoordinate(t.pointRayIntersection(g,m))}pointCoordinate3D(t,o,u){const m=new wt(o,u);if(t.elevation)return t.elevation.pointCoordinate(m);{const h=this.pointCoordinate(t,m.x,m.y,0);return[h.x,h.y,h.z]}}isPointAboveHorizon(t,o){if(t.elevation&&t.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(t,o.x,o.y);const u=t.horizonLineFromTop();return o.y<u}createInversionMatrix(t,o){return BD}createTileMatrix(t,o,u){let m,h,g;const b=u.canonical,E=Ae.mat4.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const A=Km(b,this);m=1,h=A.x+u.wrap*A.scale,g=A.y,Ae.mat4.scale(E,E,[m/A.scale,m/A.scale,t.pixelsPerMeter/o])}else m=o/t.zoomScale(b.z),h=(b.x+Math.pow(2,b.z)*u.wrap)*m,g=b.y*m;return Ae.mat4.translate(E,E,[h,g,0]),Ae.mat4.scale(E,E,[m/Nt,m/Nt,1]),E}upVector(t,o,u){return[0,0,1]}upVectorScale(t,o,u){return{metersToTile:1}}}class ND extends lu{constructor(t){super(t),this.range=[4,7],this.center=t.center||[-96,37.5];const[o,u]=this.parallels=t.parallels||[29.5,45.5],m=Math.sin(ar(o));this.n=(m+Math.sin(ar(u)))/2,this.c=1+m*(2*this.n-m),this.r0=Math.sqrt(this.c)/this.n}project(t,o){const{n:u,c:m,r0:h}=this,g=ar(t-this.center[0]),b=ar(o),E=Math.sqrt(m-2*u*Math.sin(b))/u;return{x:E*Math.sin(g*u),y:E*Math.cos(g*u)-h,z:0}}unproject(t,o){const{n:u,c:m,r0:h}=this,g=h+o;let b=Math.atan2(t,Math.abs(g))*Math.sign(g);g*u<0&&(b-=Math.PI*Math.sign(t)*Math.sign(g));const E=ar(this.center[0])*u;b=gn(b,-Math.PI-E,Math.PI-E);const A=Jt(tn(b/u)+this.center[0],-180,180),v=Math.asin(Jt((m-(t*t+g*g)*u*u)/(2*u),-1,1)),C=Jt(tn(v),-mi,mi);return new rn(A,C)}}const Jm=1.340264,Qm=-.081106,eg=893e-6,tg=.003796,fy=Math.sqrt(3)/2;class jD extends lu{project(t,o){o=o/180*Math.PI,t=t/180*Math.PI;const u=Math.asin(fy*Math.sin(o)),m=u*u,h=m*m*m;return{x:.5*(t*Math.cos(u)/(fy*(Jm+3*Qm*m+h*(7*eg+9*tg*m)))/Math.PI+.5),y:1-.5*(u*(Jm+Qm*m+h*(eg+tg*m))/Math.PI+1),z:0}}unproject(t,o){t=(2*t-.5)*Math.PI;let u=o=(2*(1-o)-1)*Math.PI,m=u*u,h=m*m*m;for(let v,C,I,S=0;S<12&&(C=u*(Jm+Qm*m+h*(eg+tg*m))-o,I=Jm+3*Qm*m+h*(7*eg+9*tg*m),v=C/I,u=Jt(u-v,-Math.PI/3,Math.PI/3),m=u*u,h=m*m*m,!(Math.abs(v)<1e-12));++S);const g=fy*t*(Jm+3*Qm*m+h*(7*eg+9*tg*m))/Math.cos(u),b=Math.asin(Math.sin(u)/fy),E=Jt(180*g/Math.PI,-180,180),A=Jt(180*b/Math.PI,-mi,mi);return new rn(E,A)}}class $D extends lu{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0}project(t,o){return{x:.5+t/360,y:.5-o/360,z:0}}unproject(t,o){const u=360*(t-.5),m=Jt(360*(.5-o),-mi,mi);return new rn(u,m)}}const xf=Math.PI/2;function py(l){return Math.tan((xf+l)/2)}class VD extends lu{constructor(t){super(t),this.center=t.center||[0,30];const[o,u]=this.parallels=t.parallels||[30,30];let m=ar(o),h=ar(u);this.southernCenter=m+h<0,this.southernCenter&&(m=-m,h=-h);const g=Math.cos(m),b=py(m);this.n=m===h?Math.sin(m):Math.log(g/Math.cos(h))/Math.log(py(h)/b),this.f=g*Math.pow(py(m),this.n)/this.n}project(t,o){o=ar(o),this.southernCenter&&(o=-o),t=ar(t-this.center[0]);const u=1e-6,{n:m,f:h}=this;h>0?o<-xf+u&&(o=-xf+u):o>xf-u&&(o=xf-u);const g=h/Math.pow(py(o),m);let b=g*Math.sin(m*t),E=h-g*Math.cos(m*t);return b=.5*(b/Math.PI+.5),E=.5*(E/Math.PI+.5),{x:b,y:this.southernCenter?E:1-E,z:0}}unproject(t,o){t=(2*t-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:u,f:m}=this,h=m-o,g=Math.sign(h),b=Math.sign(u)*Math.sqrt(t*t+h*h);let E=Math.atan2(t,Math.abs(h))*g;h*u<0&&(E-=Math.PI*Math.sign(t)*g);const A=Jt(tn(E/u)+this.center[0],-180,180),v=Jt(tn(2*Math.atan(Math.pow(m/b,1/u))-xf),-mi,mi);return new rn(A,this.southernCenter?-v:v)}}class YC extends lu{constructor(t){super(t),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(t,o){return{x:Al(t),y:Hs(o),z:0}}unproject(t,o){const u=ta(t),m=Zi(o);return new rn(u,m)}}const KC=ar(mi);class UD extends lu{project(t,o){const u=(o=ar(o))*o,m=u*u;return{x:.5*((t=ar(t))*(.8707-.131979*u+m*(m*(.003971*u-.001529*m)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+u*(.015085+m*(.028874*u-.044475-.005916*m)))/Math.PI+1),z:0}}unproject(t,o){t=(2*t-.5)*Math.PI;let u=o=(2*(1-o)-1)*Math.PI,m=25,h=0,g=u*u;do{g=u*u;const A=g*g;h=(u*(1.007226+g*(.015085+A*(.028874*g-.044475-.005916*A)))-o)/(1.007226+g*(.045255+A*(.259866*g-.311325-.005916*11*A))),u=Jt(u-h,-KC,KC)}while(Math.abs(h)>1e-6&&--m>0);g=u*u;const b=Jt(tn(t/(.8707+g*(g*(g*g*g*(.003971-.001529*g)-.013791)-.131979))),-180,180),E=tn(u);return new rn(b,E)}}const JC=ar(mi);class GD extends lu{project(t,o){o=ar(o),t=ar(t);const u=Math.cos(o),m=2/Math.PI,h=Math.acos(u*Math.cos(t/2)),g=Math.sin(h)/h,b=.5*(t*m+2*u*Math.sin(t/2)/g)||0,E=.5*(o+Math.sin(o)/g)||0;return{x:.5*(b/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(t,o){let u=t=(2*t-.5)*Math.PI,m=o=(2*(1-o)-1)*Math.PI,h=25;const g=1e-6;let b=0,E=0;do{const A=Math.cos(m),v=Math.sin(m),C=2*v*A,I=v*v,S=A*A,M=Math.cos(u/2),R=Math.sin(u/2),O=2*M*R,F=R*R,H=1-S*M*M,W=H?1/H:0,V=H?Math.acos(A*M)*Math.sqrt(1/H):0,Z=.5*(2*V*A*R+2*u/Math.PI)-t,Y=.5*(V*v+m)-o,ne=.5*W*(S*F+V*A*M*I)+1/Math.PI,ye=W*(O*C/4-V*v*R),_e=.125*W*(C*R-V*v*S*O),ge=.5*W*(I*M+V*F*A)+.5,Re=ye*_e-ge*ne;b=(Y*ye-Z*ge)/Re,E=(Z*_e-Y*ne)/Re,u=Jt(u-b,-Math.PI,Math.PI),m=Jt(m-E,-JC,JC)}while((Math.abs(b)>g||Math.abs(E)>g)&&--h>0);return new rn(tn(u),tn(m))}}class QC extends lu{constructor(t){super(t),this.center=t.center||[0,0],this.parallels=t.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ar(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(t,o){const{scale:u,cosPhi:m}=this;return{x:ar(t)*m*u+.5,y:-Math.sin(ar(o))/m*u+.5,z:0}}unproject(t,o){const{scale:u,cosPhi:m}=this,h=-(o-.5)/u,g=Jt(tn((t-.5)/u)/m,-180,180),b=Math.asin(Jt(h*m,-1,1)),E=Jt(tn(b),-mi,mi);return new rn(g,E)}}class HD extends YC{constructor(t){super(t),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(t,o,u){const m=ni(t,o,u),h=io(ki(u));return Ae.vec3.transformMat4(m,m,h),{x:m[0],y:m[1],z:m[2]}}locationPoint(t,o){const u=hc(o.lat,o.lng),m=Ae.vec3.normalize([],u),h=t.elevation?t.elevation.getAtPointOrZero(t.locationCoordinate(o),t._centerAltitude):t._centerAltitude,g=wo(1,0)*Nt*h;Ae.vec3.scaleAndAdd(u,u,m,g);const b=Ae.mat4.identity(new Float64Array(16));return Ae.mat4.multiply(b,t.pixelMatrix,t.globeMatrix),Ae.vec3.transformMat4(u,u,b),new wt(u[0],u[1])}pixelsPerMeter(t,o){return wo(1,0)*o}pixelSpaceConversion(t,o,u){const m=wo(1,t)*o,h=ur(wo(1,45)*o,m,u);return this.pixelsPerMeter(t,o)/h}createTileMatrix(t,o,u){const m=ca(ki(u.canonical));return Ae.mat4.multiply(new Float64Array(16),t.globeMatrix,m)}createInversionMatrix(t,o){const{center:u}=t,m=io(ki(o));return Ae.mat4.rotateY(m,m,ar(u.lng)),Ae.mat4.rotateX(m,m,ar(u.lat)),Ae.mat4.scale(m,m,[t._pixelsPerMercatorPixel,t._pixelsPerMercatorPixel,1]),Float32Array.from(m)}pointCoordinate(t,o,u,m){return $i(t,o,u,!0)||new _(0,0)}pointCoordinate3D(t,o,u){const m=this.pointCoordinate(t,o,u,0);return[m.x,m.y,m.z]}isPointAboveHorizon(t,o){return!$i(t,o.x,o.y,!1)}farthestPixelDistance(t){const o=function(m,h){const g=m.cameraToCenterDistance,b=m._centerAltitude*h,E=m._camera,A=m._camera.forward(),v=Ae.vec3.add([],Ae.vec3.scale([],A,-g),[0,0,b]),C=m.worldSize/(2*Math.PI),I=[0,0,-C],S=m.width/m.height,M=Math.tan(m.fovAboveCenter),R=Ae.vec3.scale([],E.up(),M),O=Ae.vec3.scale([],E.right(),M*S),F=Ae.vec3.normalize([],Ae.vec3.add([],Ae.vec3.add([],A,R),O)),H=[];let W;if(new Or(v,F).closestPointOnSphere(I,C,H)){const V=Ae.vec3.add([],H,I),Z=Ae.vec3.sub([],V,v);W=Math.cos(m.fovAboveCenter)*Ae.vec3.length(Z)}else{const V=Ae.vec3.sub([],v,I),Z=Ae.vec3.sub([],I,v);Ae.vec3.normalize(Z,Z);const Y=Ae.vec3.length(V)-C;W=Math.sqrt(Y*(Y+2*C));const ne=Math.acos(W/(C+Y))-Math.acos(Ae.vec3.dot(A,Z));W*=Math.cos(ne)}return 1.01*W}(t,this.pixelsPerMeter(t.center.lat,t.worldSize)),u=mo(t.zoom);if(u>0){const m=ZC(t,wo(1,t.center.lat)*t.worldSize),h=t.worldSize/(2*Math.PI),g=Math.max(t.width,t.height)/t.worldSize*Math.PI;return ur(o,m+h*(1-Math.cos(g)),Math.pow(u,10))}return o}upVector(t,o,u){return ni(o,u,t,1)}upVectorScale(t){return{metersToTile:an(Di(ki(t)))}}}function e4(l){const t=l.parallels,o=!!t&&Math.abs(t[0]+t[1])<.01;switch(l.name){case"mercator":return new YC(l);case"equirectangular":return new $D(l);case"naturalEarth":return new UD(l);case"equalEarth":return new jD(l);case"winkelTripel":return new GD(l);case"albers":return o?new QC(l):new ND(l);case"lambertConformalConic":return o?new QC(l):new VD(l);case"globe":return new HD(l)}throw new Error(`Invalid projection name: ${l.name}`)}const WD=mf.VectorTileFeature.types,qD=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function my(l,t,o,u,m,h,g,b,E,A,v,C,I){const S=b?Math.min(su,Math.round(b[0])):0,M=b?Math.min(su,Math.round(b[1])):0;l.emplaceBack(t,o,Math.round(32*u),Math.round(32*m),h,g,(S<<1)+(E?1:0),M,16*A,16*v,256*C,256*I)}function gy(l,t,o){l.emplaceBack(t,o)}function _y(l,t,o,u,m,h,g){l.emplaceBack(t,o,u,m,h,g)}function yy(l,t,o,u,m){l.emplaceBack(t,o,u,m),l.emplaceBack(t,o,u,m),l.emplaceBack(t,o,u,m),l.emplaceBack(t,o,u,m)}function ZD(l){for(const t of l.sections)if(Wx(t.text))return!0;return!1}class Lb{constructor(t){this.layoutVertexArray=new mm,this.indexArray=new no,this.programConfigurations=t,this.segments=new ri,this.dynamicLayoutVertexArray=new Vs,this.opacityVertexArray=new _m,this.placedSymbolArray=new N0,this.iconTransitioningVertexArray=new Tl,this.globeExtVertexArray=new gm,this.zOffsetVertexArray=new Ea}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(t,o,u,m,h){this.isEmpty()||(u&&(this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,hD.members),this.indexBuffer=t.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=t.createVertexBuffer(this.dynamicLayoutVertexArray,fD.members,!0),this.opacityVertexBuffer=t.createVertexBuffer(this.opacityVertexArray,qD,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=t.createVertexBuffer(this.iconTransitioningVertexArray,mD.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=t.createVertexBuffer(this.globeExtVertexArray,dD.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||h)&&(this.zOffsetVertexBuffer=t.createVertexBuffer(this.zOffsetVertexArray,pD.members,!0)),this.opacityVertexBuffer.itemSize=1),(u||m)&&this.programConfigurations.upload(t))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy())}}Yt(Lb,"SymbolBuffers");class kb{constructor(t,o,u){this.layoutVertexArray=new t,this.layoutAttributes=o,this.indexArray=new u,this.segments=new ri,this.collisionVertexArray=new xm,this.collisionVertexArrayExt=new Vs}upload(t){this.layoutVertexBuffer=t.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=t.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=t.createVertexBuffer(this.collisionVertexArray,gD.members,!0),this.collisionVertexBufferExt=t.createVertexBuffer(this.collisionVertexArrayExt,_D.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Yt(kb,"CollisionBuffers");class vy{constructor(t){this.collisionBoxArray=t.collisionBoxArray,this.zoom=t.zoom,this.lut=t.lut,this.overscaling=t.overscaling,this.layers=t.layers,this.layerIds=this.layers.map(g=>g.fqid),this.index=t.index,this.pixelRatio=t.pixelRatio,this.sourceLayerIndex=t.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ae.mat4.identity([]),this.placementViewportMatrix=Ae.mat4.identity([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=wb(this.zoom,o["text-size"]),this.iconSizeData=wb(this.zoom,o["icon-size"]);const u=this.layers[0].layout,m=u.get("symbol-sort-key"),h=u.get("symbol-z-order");this.canOverlap=u.get("text-allow-overlap")||u.get("icon-allow-overlap")||u.get("text-ignore-placement")||u.get("icon-ignore-placement"),this.sortFeaturesByKey=h!=="viewport-y"&&m.constantOr(1)!==void 0,this.sortFeaturesByY=(h==="viewport-y"||h==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=u.get("text-writing-mode").map(g=>Va[g]),this.stateDependentLayerIds=this.layers.filter(g=>g.isStateDependent()).map(g=>g.id),this.sourceID=t.sourceID,this.projection=t.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=u.get("symbol-z-elevate"),this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new Lb(new Il(this.layers,{zoom:this.zoom,lut:this.lut},t=>t.startsWith("text")||t.startsWith("symbol"))),this.icon=new Lb(new Il(this.layers,{zoom:this.zoom,lut:this.lut},t=>t.startsWith("icon")||t.startsWith("symbol"))),this.glyphOffsetArray=new vh,this.lineVertexArray=new ea,this.symbolInstances=new yh}calculateGlyphDependencies(t,o,u,m,h){for(const g of t){const b=g.codePointAt(0);if(b===void 0)break;if(o[b]=!0,m&&h&&b<=65535){const E=Wm[g];E&&(o[E.charCodeAt(0)]=!0)}}}updateFootprints(t,o){}updateReplacement(t,o){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const u=o.getReplacementRegionsForTile(t.toUnwrapped(),!0);return!mb(this.activeReplacements,u)&&(this.activeReplacements=u,!0)}populate(t,o,u,m){const h=this.layers[0],g=h.layout,b=this.projection.name==="globe",E=g.get("text-font"),A=g.get("text-field"),v=g.get("icon-image"),[C,I]=g.get("icon-size-scale-range"),S=Jt(o.scaleFactor||1,C,I),M=(A.value.kind!=="constant"||A.value.value instanceof ho&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&(E.value.kind!=="constant"||E.value.value.length>0),R=v.value.kind!=="constant"||!!v.value.value||Object.keys(v.parameters).length>0,O=g.get("symbol-sort-key");if(this.features=[],!M&&!R)return;const F=o.iconDependencies,H=o.glyphDependencies,W=o.availableImages,V=new Vn(this.zoom);for(const{feature:Z,id:Y,index:ne,sourceLayerIndex:ye}of t){const _e=h._featureFilter.needGeometry,ge=G(Z,_e);if(!h._featureFilter.filter(V,ge,u))continue;if(_e||(ge.geometry=B(Z,u,m)),b&&Z.type!==1&&u.z<=5){const Oe=ge.geometry,Ve=.98078528056,We=(Qe,Ge)=>{const ut=ni(Qe.x,Qe.y,u,1),It=ni(Ge.x,Ge.y,u,1);return Ae.vec3.dot(ut,It)<Ve};for(let Qe=0;Qe<Oe.length;Qe++)Oe[Qe]=z(Oe[Qe],We)}let Re,we;if(M){const Oe=h.getValueAndResolveTokens("text-field",ge,u,W),Ve=ho.factory(Oe);ZD(Ve)&&(this.hasRTLText=!0),(!this.hasRTLText||hm()==="unavailable"||this.hasRTLText&&Qo.isParsed())&&(Re=xD(Ve,h,ge))}if(R){const Oe=h.getValueAndResolveTokens("icon-image",ge,u,W);we=Oe instanceof Li?Oe:Li.build(Oe)}if(!Re&&!we)continue;const Le=this.sortFeaturesByKey?O.evaluate(ge,{},u):void 0,Be={id:Y,text:Re,icon:we,index:ne,sourceLayerIndex:ye,geometry:ge.geometry,properties:Z.properties,type:WD[Z.type],sortKey:Le};if(this.features.push(Be),we){const Oe=oy(this.iconSizeData,this.layers[0]._unevaluatedLayout._values["icon-size"],u,this.zoom,Be)*S*this.pixelRatio,Ve=we.getPrimary().scaleSelf(Oe);if(F[Ve.id]=F[Ve.id]||[],F[Ve.id].push(Ve),we.nameSecondary){const We=we.getSecondary().scaleSelf(Oe);F[We.id]=F[We.id]||[],F[We.id].push(We)}}if(Re){const Oe=E.evaluate(ge,{},u).join(","),Ve=g.get("text-rotation-alignment")==="map"&&g.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Va.vertical)>=0;for(const We of Re.sections)if(We.image){const Qe=We.image.getPrimary().scaleSelf(this.pixelRatio);F[Qe.id]=F[Qe.id]||[],F[Qe.id].push(Qe)}else{const Qe=Ud(Re.toString()),Ge=We.fontStack||Oe,ut=H[Ge]=H[Ge]||{};this.calculateGlyphDependencies(We.text,ut,Ve,this.allowVerticalPlacement,Qe)}}}g.get("symbol-placement")==="line"&&(this.features=function(Z){const Y={},ne={},ye=[];let _e=0;function ge(Be){ye.push(Z[Be]),_e++}function Re(Be,Oe,Ve){const We=ne[Be];return delete ne[Be],ne[Oe]=We,ye[We].geometry[0].pop(),ye[We].geometry[0]=ye[We].geometry[0].concat(Ve[0]),We}function we(Be,Oe,Ve){const We=Y[Oe];return delete Y[Oe],Y[Be]=We,ye[We].geometry[0].shift(),ye[We].geometry[0]=Ve[0].concat(ye[We].geometry[0]),We}function Le(Be,Oe,Ve){const We=Ve?Oe[0][Oe[0].length-1]:Oe[0][0];return`${Be}:${We.x}:${We.y}`}for(let Be=0;Be<Z.length;Be++){const Oe=Z[Be],Ve=Oe.geometry,We=Oe.text?Oe.text.toString():null;if(!We){ge(Be);continue}const Qe=Le(We,Ve),Ge=Le(We,Ve,!0);if(Qe in ne&&Ge in Y&&ne[Qe]!==Y[Ge]){const ut=we(Qe,Ge,Ve),It=Re(Qe,Ge,ye[ut].geometry);delete Y[Qe],delete ne[Ge],ne[Le(We,ye[It].geometry,!0)]=It,ye[ut].geometry=null}else Qe in ne?Re(Qe,Ge,Ve):Ge in Y?we(Qe,Ge,Ve):(ge(Be),Y[Qe]=_e-1,ne[Ge]=_e-1)}return ye.filter(Be=>Be.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((Z,Y)=>Z.sortKey-Y.sortKey)}update(t,o,u,m,h,g,b){this.text.programConfigurations.updatePaintArrays(t,o,h,u,m,g,b),this.icon.programConfigurations.updatePaintArrays(t,o,h,u,m,g,b)}updateZOffset(){const t=(h,g,b)=>{u+=g,u>h.length&&h.resize(u);for(let E=-g;E<0;E++)h.emplace(E+u,b)},o=(h,g,b)=>{m+=g,m>h.length&&h.resize(m);for(let E=-g;E<0;E++)h.emplace(E+m,b)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let u=0,m=0;for(let h=0;h<this.symbolInstances.length;h++){const g=this.symbolInstances.get(h),{numHorizontalGlyphVertices:b,numVerticalGlyphVertices:E,numIconVertices:A}=g,v=g.zOffset,C=A>0;if((b>0||E>0)&&(t(this.text.zOffsetVertexArray,b,v),t(this.text.zOffsetVertexArray,E,v)),C){const{placedIconSymbolIndex:I,verticalPlacedIconSymbolIndex:S}=g;I>=0&&o(this.icon.zOffsetVertexArray,A,v),S>=0&&o(this.icon.zOffsetVertexArray,g.numVerticalIconVertices,v)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(t){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(t),this.iconCollisionBox.upload(t)),this.text.upload(t,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(t,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=e4(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(t,o){const u=this.lineVertexArray.length;if(t.segment!==void 0)for(const{x:m,y:h}of o)this.lineVertexArray.emplaceBack(m,h);return{lineStartIndex:u,lineLength:this.lineVertexArray.length-u}}addSymbols(t,o,u,m,h,g,b,E,A,v,C,I,S,M,R,O){const F=t.indexArray,H=t.layoutVertexArray,W=t.globeExtVertexArray,V=t.segments.prepareSegment(4*o.length,H,F,this.canOverlap?g.sortKey:void 0),Z=this.glyphOffsetArray.length,Y=V.vertexLength,ne=this.allowVerticalPlacement&&b===Va.vertical?Math.PI/2:0,ye=g.text&&g.text.sections;for(let ge=0;ge<o.length;ge++){const{tl:Re,tr:we,bl:Le,br:Be,texPrimary:Oe,texSecondary:Ve,pixelOffsetTL:We,pixelOffsetBR:Qe,minFontScaleX:Ge,minFontScaleY:ut,glyphOffset:It,isSDF:dt,sectionIndex:Dt}=o[ge],kt=V.vertexLength,$t=It[1];if(my(H,A.x,A.y,Re.x,$t+Re.y,Oe.x,Oe.y,u,dt,We.x,We.y,Ge,ut),my(H,A.x,A.y,we.x,$t+we.y,Oe.x+Oe.w,Oe.y,u,dt,Qe.x,We.y,Ge,ut),my(H,A.x,A.y,Le.x,$t+Le.y,Oe.x,Oe.y+Oe.h,u,dt,We.x,Qe.y,Ge,ut),my(H,A.x,A.y,Be.x,$t+Be.y,Oe.x+Oe.w,Oe.y+Oe.h,u,dt,Qe.x,Qe.y,Ge,ut),E){const{x:_t,y:er,z:Ot}=E.anchor,[Kt,hr,Ar]=E.up;_y(W,_t,er,Ot,Kt,hr,Ar),_y(W,_t,er,Ot,Kt,hr,Ar),_y(W,_t,er,Ot,Kt,hr,Ar),_y(W,_t,er,Ot,Kt,hr,Ar),yy(t.dynamicLayoutVertexArray,_t,er,Ot,ne)}else yy(t.dynamicLayoutVertexArray,A.x,A.y,A.z,ne);if(O){const _t=Ve||Oe;gy(t.iconTransitioningVertexArray,_t.x,_t.y),gy(t.iconTransitioningVertexArray,_t.x+_t.w,_t.y),gy(t.iconTransitioningVertexArray,_t.x,_t.y+_t.h),gy(t.iconTransitioningVertexArray,_t.x+_t.w,_t.y+_t.h)}F.emplaceBack(kt,kt+1,kt+2),F.emplaceBack(kt+1,kt+2,kt+3),V.vertexLength+=4,V.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(It[0]),ge!==o.length-1&&Dt===o[ge+1].sectionIndex||t.programConfigurations.populatePaintArrays(H.length,g,g.index,{},S,M,R,ye&&ye[Dt])}const _e=E?E.anchor:A;t.placedSymbolArray.emplaceBack(_e.x,_e.y,_e.z,A.x,A.y,Z,this.glyphOffsetArray.length-Z,Y,v,C,A.segment,u?u[0]:0,u?u[1]:0,m[0],m[1],b,0,!1,0,I,0)}_commitLayoutVertex(t,o,u,m,h,g,b){t.emplaceBack(o,u,m,h,g,Math.round(b.x),Math.round(b.y))}_addCollisionDebugVertices(t,o,u,m,h,g,b){const E=u.segments.prepareSegment(4,u.layoutVertexArray,u.indexArray),A=E.vertexLength,v=b.tileAnchorX,C=b.tileAnchorY;for(let S=0;S<4;S++)u.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(u.collisionVertexArrayExt,o,t.padding,b.zOffset),this._commitLayoutVertex(u.layoutVertexArray,m,h,g,v,C,new wt(t.x1,t.y1)),this._commitLayoutVertex(u.layoutVertexArray,m,h,g,v,C,new wt(t.x2,t.y1)),this._commitLayoutVertex(u.layoutVertexArray,m,h,g,v,C,new wt(t.x2,t.y2)),this._commitLayoutVertex(u.layoutVertexArray,m,h,g,v,C,new wt(t.x1,t.y2)),E.vertexLength+=4;const I=u.indexArray;I.emplaceBack(A,A+1),I.emplaceBack(A+1,A+2),I.emplaceBack(A+2,A+3),I.emplaceBack(A+3,A),E.primitiveLength+=4}_addTextDebugCollisionBoxes(t,o,u,m,h,g){for(let b=m;b<h;b++){const E=u.get(b),A=this.getSymbolInstanceTextSize(t,g,o,b);this._addCollisionDebugVertices(E,A,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,g)}}_addIconDebugCollisionBoxes(t,o,u,m,h,g){for(let b=m;b<h;b++){const E=u.get(b),A=this.getSymbolInstanceIconSize(t,o,g.placedIconSymbolIndex);this._addCollisionDebugVertices(E,A,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,g)}}generateCollisionDebugBuffers(t,o,u){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new kb(_h,bC.members,Tl),this.iconCollisionBox=new kb(_h,bC.members,Tl);const m=gf(this.iconSizeData,t),h=gf(this.textSizeData,t,u);for(let g=0;g<this.symbolInstances.length;g++){const b=this.symbolInstances.get(g);this._addTextDebugCollisionBoxes(h,t,o,b.textBoxStartIndex,b.textBoxEndIndex,b),this._addTextDebugCollisionBoxes(h,t,o,b.verticalTextBoxStartIndex,b.verticalTextBoxEndIndex,b),this._addIconDebugCollisionBoxes(m,t,o,b.iconBoxStartIndex,b.iconBoxEndIndex,b),this._addIconDebugCollisionBoxes(m,t,o,b.verticalIconBoxStartIndex,b.verticalIconBoxEndIndex,b)}}getSymbolInstanceTextSize(t,o,u,m){const h=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:m),g=ay(this.textSizeData,t,h)/go;return this.tilePixelRatio*g}getSymbolInstanceIconSize(t,o,u){const m=this.icon.placedSymbolArray.get(u),h=ay(this.iconSizeData,t,m);return this.tilePixelRatio*h}_commitDebugCollisionVertexUpdate(t,o,u,m){t.emplaceBack(o,-u,-u,m),t.emplaceBack(o,u,-u,m),t.emplaceBack(o,u,u,m),t.emplaceBack(o,-u,u,m)}_updateTextDebugCollisionBoxes(t,o,u,m,h,g,b){for(let E=m;E<h;E++){const A=u.get(E),v=this.getSymbolInstanceTextSize(t,g,o,E);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,v,A.padding,g.zOffset)}}_updateIconDebugCollisionBoxes(t,o,u,m,h,g,b){for(let E=m;E<h;E++){const A=u.get(E),v=this.getSymbolInstanceIconSize(t,o,g.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,v,A.padding,g.zOffset)}}updateCollisionDebugBuffers(t,o,u,m){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const h=gf(this.iconSizeData,t,m),g=gf(this.textSizeData,t,u);for(let b=0;b<this.symbolInstances.length;b++){const E=this.symbolInstances.get(b);this._updateTextDebugCollisionBoxes(g,t,o,E.textBoxStartIndex,E.textBoxEndIndex,E,u),this._updateTextDebugCollisionBoxes(g,t,o,E.verticalTextBoxStartIndex,E.verticalTextBoxEndIndex,E,u),this._updateIconDebugCollisionBoxes(h,t,o,E.iconBoxStartIndex,E.iconBoxEndIndex,E,m),this._updateIconDebugCollisionBoxes(h,t,o,E.verticalIconBoxStartIndex,E.verticalIconBoxEndIndex,E,m)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(t,o,u,m,h,g,b,E,A){const v={};if(o<u){const{x1:C,y1:I,x2:S,y2:M,padding:R,projectedAnchorX:O,projectedAnchorY:F,projectedAnchorZ:H,tileAnchorX:W,tileAnchorY:V,featureIndex:Z}=t.get(o);v.textBox={x1:C,y1:I,x2:S,y2:M,padding:R,projectedAnchorX:O,projectedAnchorY:F,projectedAnchorZ:H,tileAnchorX:W,tileAnchorY:V},v.textFeatureIndex=Z}if(m<h){const{x1:C,y1:I,x2:S,y2:M,padding:R,projectedAnchorX:O,projectedAnchorY:F,projectedAnchorZ:H,tileAnchorX:W,tileAnchorY:V,featureIndex:Z}=t.get(m);v.verticalTextBox={x1:C,y1:I,x2:S,y2:M,padding:R,projectedAnchorX:O,projectedAnchorY:F,projectedAnchorZ:H,tileAnchorX:W,tileAnchorY:V},v.verticalTextFeatureIndex=Z}if(g<b){const{x1:C,y1:I,x2:S,y2:M,padding:R,projectedAnchorX:O,projectedAnchorY:F,projectedAnchorZ:H,tileAnchorX:W,tileAnchorY:V,featureIndex:Z}=t.get(g);v.iconBox={x1:C,y1:I,x2:S,y2:M,padding:R,projectedAnchorX:O,projectedAnchorY:F,projectedAnchorZ:H,tileAnchorX:W,tileAnchorY:V},v.iconFeatureIndex=Z}if(E<A){const{x1:C,y1:I,x2:S,y2:M,padding:R,projectedAnchorX:O,projectedAnchorY:F,projectedAnchorZ:H,tileAnchorX:W,tileAnchorY:V,featureIndex:Z}=t.get(E);v.verticalIconBox={x1:C,y1:I,x2:S,y2:M,padding:R,projectedAnchorX:O,projectedAnchorY:F,projectedAnchorZ:H,tileAnchorX:W,tileAnchorY:V},v.verticalIconFeatureIndex=Z}return v}deserializeCollisionBoxes(t){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const u=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(t,u.textBoxStartIndex,u.textBoxEndIndex,u.verticalTextBoxStartIndex,u.verticalTextBoxEndIndex,u.iconBoxStartIndex,u.iconBoxEndIndex,u.verticalIconBoxStartIndex,u.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(t,o){const u=t.placedSymbolArray.get(o),m=u.vertexStartIndex+4*u.numGlyphs;for(let h=u.vertexStartIndex;h<m;h+=4)t.indexArray.emplaceBack(h,h+1,h+2),t.indexArray.emplaceBack(h+1,h+2,h+3)}getSortedSymbolIndexes(t){if(this.sortedAngle===t&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const o=Math.sin(t),u=Math.cos(t),m=[],h=[],g=[];for(let b=0;b<this.symbolInstances.length;++b){g.push(b);const E=this.symbolInstances.get(b);m.push(0|Math.round(o*E.tileAnchorX+u*E.tileAnchorY)),h.push(E.featureIndex)}return g.sort((b,E)=>m[b]-m[E]||h[E]-h[b]),g}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let t=0;t<this.symbolInstances.length;++t)this.symbolInstanceIndexesSortedZOffset.push(t)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((t,o)=>this.symbolInstances.get(o).zOffset-this.symbolInstances.get(t).zOffset)}addToSortKeyRanges(t,o){const u=this.sortKeyRanges[this.sortKeyRanges.length-1];u&&u.sortKey===o?u.symbolInstanceEnd=t+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:t,symbolInstanceEnd:t+1})}sortFeatures(t){if(this.sortFeaturesByY&&this.sortedAngle!==t&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(t),this.sortedAngle=t,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const u=this.symbolInstances.get(o);this.featureSortOrder.push(u.featureIndex);const{rightJustifiedTextSymbolIndex:m,centerJustifiedTextSymbolIndex:h,leftJustifiedTextSymbolIndex:g,verticalPlacedTextSymbolIndex:b,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:A}=u;m>=0&&this.addIndicesForPlacedSymbol(this.text,m),h>=0&&h!==m&&this.addIndicesForPlacedSymbol(this.text,h),g>=0&&g!==h&&g!==m&&this.addIndicesForPlacedSymbol(this.text,g),b>=0&&this.addIndicesForPlacedSymbol(this.text,b),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),A>=0&&this.addIndicesForPlacedSymbol(this.icon,A)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let t4,r4,Db;Yt(vy,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),vy.addDynamicAttributes=yy;class n4{constructor(t){this.type=t.property.overrides?t.property.overrides.runtimeType:_r,this.defaultValue=t}evaluate(t){if(t.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(t.formattedSection))return o.getOverride(t.formattedSection)}return t.feature&&t.featureState?this.defaultValue.evaluate(t.feature,t.featureState):this.defaultValue.property.specification.default}eachChild(t){this.defaultValue.isConstant()||t(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Yt(n4,"FormatSectionOverride",{omit:["defaultValue"]});const Ob=()=>Db||(Db={layout:t4||(t4=new ti({"symbol-placement":new zt(nt.layout_symbol["symbol-placement"]),"symbol-spacing":new zt(nt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new zt(nt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ht(nt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new zt(nt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new zt(nt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new zt(nt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new zt(nt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new zt(nt.layout_symbol["icon-ignore-placement"]),"icon-optional":new zt(nt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new zt(nt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ht(nt.layout_symbol["icon-size"]),"icon-size-scale-range":new zt(nt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new Ht(nt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Ht(nt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ht(nt.layout_symbol["icon-image"]),"icon-rotate":new Ht(nt.layout_symbol["icon-rotate"]),"icon-padding":new zt(nt.layout_symbol["icon-padding"]),"icon-keep-upright":new zt(nt.layout_symbol["icon-keep-upright"]),"icon-offset":new Ht(nt.layout_symbol["icon-offset"]),"icon-anchor":new Ht(nt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new zt(nt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new zt(nt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new zt(nt.layout_symbol["text-rotation-alignment"]),"text-field":new Ht(nt.layout_symbol["text-field"]),"text-font":new Ht(nt.layout_symbol["text-font"]),"text-size":new Ht(nt.layout_symbol["text-size"]),"text-size-scale-range":new zt(nt.layout_symbol["text-size-scale-range"]),"text-max-width":new Ht(nt.layout_symbol["text-max-width"]),"text-line-height":new Ht(nt.layout_symbol["text-line-height"]),"text-letter-spacing":new Ht(nt.layout_symbol["text-letter-spacing"]),"text-justify":new Ht(nt.layout_symbol["text-justify"]),"text-radial-offset":new Ht(nt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new zt(nt.layout_symbol["text-variable-anchor"]),"text-anchor":new Ht(nt.layout_symbol["text-anchor"]),"text-max-angle":new zt(nt.layout_symbol["text-max-angle"]),"text-writing-mode":new zt(nt.layout_symbol["text-writing-mode"]),"text-rotate":new Ht(nt.layout_symbol["text-rotate"]),"text-padding":new zt(nt.layout_symbol["text-padding"]),"text-keep-upright":new zt(nt.layout_symbol["text-keep-upright"]),"text-transform":new Ht(nt.layout_symbol["text-transform"]),"text-offset":new Ht(nt.layout_symbol["text-offset"]),"text-allow-overlap":new zt(nt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new zt(nt.layout_symbol["text-ignore-placement"]),"text-optional":new zt(nt.layout_symbol["text-optional"]),visibility:new zt(nt.layout_symbol.visibility)})),paint:r4||(r4=new ti({"icon-opacity":new Ht(nt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new Ht(nt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new Ht(nt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new Ht(nt.paint_symbol["text-emissive-strength"]),"icon-color":new Ht(nt.paint_symbol["icon-color"]),"icon-halo-color":new Ht(nt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ht(nt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ht(nt.paint_symbol["icon-halo-blur"]),"icon-translate":new zt(nt.paint_symbol["icon-translate"]),"icon-translate-anchor":new zt(nt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Ht(nt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new Ht(nt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new Ht(nt.paint_symbol["text-occlusion-opacity"]),"text-color":new Ht(nt.paint_symbol["text-color"],{runtimeType:_n,getOverride:l=>l.textColor,hasOverride:l=>!!l.textColor}),"text-halo-color":new Ht(nt.paint_symbol["text-halo-color"]),"text-halo-width":new Ht(nt.paint_symbol["text-halo-width"]),"text-halo-blur":new Ht(nt.paint_symbol["text-halo-blur"]),"text-translate":new zt(nt.paint_symbol["text-translate"]),"text-translate-anchor":new zt(nt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new zt(nt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new zt(nt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new zt(nt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new zt(nt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new Ht(nt.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},Db);class xy extends Bo{constructor(t,o,u,m){super(t,Ob(),o,u,m),this._colorAdjustmentMatrix=Ae.mat4.identity([]),this.hasInitialOcclusionOpacityProperties=t.paint!==void 0&&("icon-occlusion-opacity"in t.paint||"text-occlusion-opacity"in t.paint)}recalculate(t,o){super.recalculate(t,o),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const u=this.layout.get("text-writing-mode");if(u){const m=[];for(const h of u)m.indexOf(h)<0&&m.push(h);this.layout._values["text-writing-mode"]=m}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(t,o,u,m){return this._saturation===t&&this._contrast===o&&this._brightnessMin===u&&this._brightnessMax===m||(this._colorAdjustmentMatrix=function(h,g,b,E){h=le(h),g=te(g);const A=Ae.mat4.create(),v=h/3,C=1-2*v,I=[C,v,v,0,v,C,v,0,v,v,C,0,0,0,0,1],S=.5-.5*g,M=E-b;return Ae.mat4.multiply(A,[M,0,0,0,0,M,0,0,0,0,M,0,b,b,b,1],[g,0,0,0,0,g,0,0,0,0,g,0,S,S,S,1]),Ae.mat4.multiply(A,A,I),A}(t,o,u,m),this._saturation=t,this._contrast=o,this._brightnessMin=u,this._brightnessMax=m),this._colorAdjustmentMatrix}getValueAndResolveTokens(t,o,u,m){const h=this.layout.get(t).evaluate(o,{},u,m),g=this._unevaluatedLayout._values[t];return g.isDataDriven()||Bd(g.value)||!h?h:function(b,E){return E.replace(/{([^{}]+)}/g,(A,v)=>v in b?String(b[v]):"")}(o.properties,h)}createBucket(t){return new vy(t)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const t of Ob().paint.overridableProperties){if(!xy.hasPaintOverride(this.layout,t))continue;const o=this.paint.get(t),u=new n4(o),m=new Fd(u,o.property.specification,this.scope,this.options);let h=null;h=o.value.kind==="constant"||o.value.kind==="source"?new Nd("source",m):new Uc("composite",m,o.value.zoomStops,o.value._interpolationType),this.paint._values[t]=new Wc(o.property,h,o.parameters)}}_handleOverridablePaintPropertyUpdate(t,o,u){return!(!this.layout||o.isDataDriven()||u.isDataDriven())&&xy.hasPaintOverride(this.layout,t)}static hasPaintOverride(t,o){const u=t.get("text-field"),m=Ob().paint.properties[o];let h=!1;const g=b=>{for(const E of b)if(m.overrides&&m.overrides.hasOverride(E))return void(h=!0)};if(u.value.kind==="constant"&&u.value.value instanceof ho)g(u.value.value.sections);else if(u.value.kind==="source"){const b=A=>{h||(A instanceof ba&&Hn(A.value)===Zo?g(A.value.sections):A instanceof ks?g(A.sections):A.eachChild(b))},E=u.value;E._styleExpression&&b(E._styleExpression.expression)}return h}getProgramIds(){return["symbol"]}getDefaultProgramParams(t,o,u){return{config:new lc(this,{zoom:o,lut:u}),overrideFog:!1}}}let i4,o4,a4,s4;var Fb=on([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function Bb(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function Nb(l){switch(l){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class jb{constructor(t,o,u,m){this.context=t,this.format=u,this.useMipmap=m&&m.useMipmap,this.texture=t.gl.createTexture(),this.update(o,{premultiply:m&&m.premultiply})}update(t,o){const u=t&&t instanceof HTMLVideoElement&&t.width===0?t.videoWidth:t.width,m=t&&t instanceof HTMLVideoElement&&t.height===0?t.videoHeight:t.height,{context:h}=this,{gl:g}=h,{x:b,y:E}=o&&o.position?o.position:{x:0,y:0},A=Math.max(b+u,this.size?this.size[0]:0),v=Math.max(E+m,this.size?this.size[1]:0);!this.size||this.size[0]===A&&this.size[1]===v||(g.bindTexture(g.TEXTURE_2D,null),g.deleteTexture(this.texture),this.texture=g.createTexture(),this.size=null),g.bindTexture(g.TEXTURE_2D,this.texture),h.pixelStoreUnpackFlipY.set(!1),h.pixelStoreUnpack.set(1),h.pixelStoreUnpackPremultiplyAlpha.set(this.format===g.RGBA8&&(!o||o.premultiply!==!1));const C=t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof HTMLVideoElement||t instanceof ImageData||ImageBitmap&&t instanceof ImageBitmap;if(!this.size&&A>0&&v>0){const I=this.useMipmap?Math.floor(Math.log2(Math.max(A,v)))+1:1;g.texStorage2D(g.TEXTURE_2D,I,this.format,A,v),this.size=[A,v]}if(this.size)if(C)g.texSubImage2D(g.TEXTURE_2D,0,b,E,Bb(this.format),Nb(this.format),t);else{const I=t.data;I&&g.texSubImage2D(g.TEXTURE_2D,0,b,E,u,m,Bb(this.format),Nb(this.format),I)}this.useMipmap&&g.generateMipmap(g.TEXTURE_2D)}bind(t,o,u=!1){const{context:m}=this,{gl:h}=m;h.bindTexture(h.TEXTURE_2D,this.texture),t!==this.minFilter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,t),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap&&!u?t===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),o!==this.wrapS&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,o),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,o),this.wrapS=o)}bindExtraParam(t,o,u,m){const{context:h}=this,{gl:g}=h;g.bindTexture(g.TEXTURE_2D,this.texture),o!==this.magFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,o),this.magFilter=o),t!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,this.useMipmap?t===g.NEAREST?g.NEAREST_MIPMAP_NEAREST:g.LINEAR_MIPMAP_LINEAR:t),this.minFilter=t),u!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,u),this.wrapS=u),m!==this.wrapT&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,m),this.wrapT=m)}destroy(){const{gl:t}=this.context;t.deleteTexture(this.texture),this.texture=null}}class by{constructor(t,o){this.context=t,this.texture=o}bind(t,o){const{context:u}=this,{gl:m}=u;m.bindTexture(m.TEXTURE_2D,this.texture),t!==this.minFilter&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MAG_FILTER,t),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_MIN_FILTER,t),this.minFilter=t),o!==this.wrapS&&(m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_S,o),m.texParameteri(m.TEXTURE_2D,m.TEXTURE_WRAP_T,o),this.wrapS=o)}}function wy(l,t,o,u,m,h,g,b){const E=[l,t,1,o,u,1,m,h,1],A=[g,b,1],v=Ae.mat3.adjoint([],E),[C,I,S]=Ae.vec3.transformMat3(A,A,v);return Ae.mat3.multiply(E,E,[C,0,0,0,I,0,0,0,S])}function l4(l,t,o,u,m,h,g,b){const E=function(A,v,C,I,S,M,R,O){const F=wy(0,0,1,0,1,1,0,1),H=wy(A,v,C,I,S,M,R,O),W=Ae.mat3.adjoint([],F);return Ae.mat3.multiply(H,H,W)}(l,t,o,u,m,h,g,b);return[E[2]/E[8]/Nt,E[5]/E[8]/Nt]}function Sy(l){return[l[0],Math.min(Math.max(l[1],-mi),mi)]}class c4 extends lo{constructor(t,o,u,m){super(),this.id=t,this.dispatcher=u,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(m),this.options=o,this._dirty=!1}load(t,o){if(this._loaded=o||!1,this.fire(new la("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return t&&(this.coordinates=t),this._loaded=!0,void this._finishLoading();this._imageRequest=As(this.map._requestManager.transformRequest(this.url,wi.Image),(u,m)=>{this._imageRequest=null,this._loaded=!0,u?this.fire(new ya(u)):m&&(this.image=m instanceof HTMLImageElement?pt.getImageData(m):m,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,t&&(this.coordinates=t),this._finishLoading())})}loaded(){return this._loaded}updateImage(t){return t.url?(this._imageRequest&&t.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=t.url,this.load(t.coordinates,this._loaded),this):this}setTexture(t){if(!(t.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new by(this.map.painter.context,t.handle),this.width=t.dimensions[0],this.height=t.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new la("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(t){this.map=t,this.load()}onRemove(t){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof by||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(t){if(this.coordinates=t,this._boundsArray=void 0,this._unsupportedCoords=!1,!t.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let o=t[0][1],u=t[0][1];for(const h of t)h[1]>u&&(u=h[1]),h[1]<o&&(o=h[1]);const m=(u+o)/2;if(m>mi?this.onNorthPole=!0:m<-mi&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const h=t.map(_.fromLngLat);this.tileID=function(g){let b=1/0,E=1/0,A=-1/0,v=-1/0;for(const R of g)b=Math.min(b,R.x),E=Math.min(E,R.y),A=Math.max(A,R.x),v=Math.max(v,R.y);const C=Math.max(A-b,v-E),I=Math.max(0,Math.floor(-Math.log(C)/Math.LN2)),S=Math.pow(2,I);let M=Math.floor((b+A)/2*S);return M>1&&(M-=1),new jt(I,M,Math.floor((E+v)/2*S))}(h),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new la("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(t){for(const F in this.tiles){const H=this.tiles[F];H.state!=="loaded"&&(H.state="loaded",H.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const o=Km(new jt(0,0,0),this.map.transform.projection),u=[o.projection.project(this.coordinates[0][0],this.coordinates[0][1]),o.projection.project(this.coordinates[1][0],this.coordinates[1][1]),o.projection.project(this.coordinates[2][0],this.coordinates[2][1]),o.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(F){const H=F[1].x-F[0].x,W=F[1].y-F[0].y,V=F[2].x-F[1].x,Z=F[2].y-F[1].y,Y=F[3].x-F[2].x,ne=F[3].y-F[2].y,ye=F[0].x-F[3].x,_e=F[0].y-F[3].y,ge=H*Z-V*W,Re=V*ne-Y*Z,we=Y*_e-ye*ne,Le=ye*W-H*_e;return ge>0&&Re>0&&we>0&&Le>0||ge<0&&Re<0&&we<0&&Le<0}(u))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const m=Km(this.tileID,this.map.transform.projection),[h,g,b,E]=this.coordinates.map(F=>{const H=m.projection.project(F[0],F[1]);return XC(m,H)._round()});this.perspectiveTransform=l4(h.x,h.y,g.x,g.y,b.x,b.y,E.x,E.y);const A=this._boundsArray=new Qc;A.emplaceBack(h.x,h.y,0,0),A.emplaceBack(g.x,g.y,Nt,0),A.emplaceBack(E.x,E.y,0,Nt),A.emplaceBack(b.x,b.y,Nt,Nt),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=t.createVertexBuffer(A,Fb.members),this.boundsSegments=ri.simpleSegment(0,0,4,2);const v=[],C=[Sy((I=this.coordinates)[0]),Sy(I[1]),Sy(I[2]),Sy(I[3])];var I;const[S,M,R,O]=function(F){let H=F[0][0],W=H,V=F[0][1],Z=V;for(let Y=1;Y<F.length;Y++)F[Y][0]<H?H=F[Y][0]:F[Y][0]>W&&(W=F[Y][0]),F[Y][1]<V?V=F[Y][1]:F[Y][1]>Z&&(Z=F[Y][1]);return[H,V,W-H,Z-V]}(C);{const F=new Qc,[H,W,V,Z]=function(We){let Qe=We[0].x,Ge=Qe,ut=We[0].y,It=ut;for(let dt=1;dt<We.length;dt++)We[dt].x<Qe?Qe=We[dt].x:We[dt].x>Ge&&(Ge=We[dt].x),We[dt].y<ut?ut=We[dt].y:We[dt].y>It&&(It=We[dt].y);return[Qe,ut,Ge-Qe,It-ut]}(u),Y=We=>[(We.x-H)/V,(We.y-W)/Z],[ne,ye,_e,ge]=u.map(Y),Re=function(We,Qe,Ge,ut,It,dt,Dt,kt){const $t=wy(0,0,1,0,1,1,0,1),_t=wy(We,Qe,Ge,ut,It,dt,Dt,kt),er=Ae.mat3.adjoint([],_t);return Ae.mat3.multiply($t,$t,er)}(ne[0],ne[1],ye[0],ye[1],_e[0],_e[1],ge[0],ge[1]);this.elevatedGlobePerspectiveTransform=l4(ne[0],ne[1],ye[0],ye[1],_e[0],_e[1],ge[0],ge[1]);const we=(We,Qe)=>{v.push(We.lng);const Ge=Math.round((We.lng-S)/R*Nt),ut=Math.round((We.lat-M)/O*Nt),It=Y(Qe),dt=Ae.vec3.transformMat3([],[It[0],It[1],1],Re),Dt=Math.round(dt[0]/dt[2]*Nt),kt=Math.round(dt[1]/dt[2]*Nt);F.emplaceBack(Ge,ut,Dt,kt)},Le=u[3].x-u[0].x,Be=u[3].y-u[0].y,Oe=u[2].x-u[1].x,Ve=u[2].y-u[1].y;for(let We=0;We<65;We++){const Qe=We/64,Ge=[u[0].x+Qe*Le,u[0].y+Qe*Be],ut=[u[1].x+Qe*Oe,u[1].y+Qe*Ve],It=ut[0]-Ge[0],dt=ut[1]-Ge[1];for(let Dt=0;Dt<65;Dt++){const kt=Dt/64,$t={x:Ge[0]+It*kt,y:Ge[1]+dt*kt,z:0};we(o.projection.unproject($t.x,$t.y),$t)}}this.elevatedGlobeVertexBuffer=t.createVertexBuffer(F,Fb.members)}{this.maxLongitudeTriangleSize=0;let F=[],H=new no;const W=(V,Z,Y)=>{H.emplaceBack(V,Z,Y);const ne=v[V],ye=v[Z],_e=v[Y],ge=Math.min(Math.min(ne,ye),_e),Re=Math.max(Math.max(ne,ye),_e)-ge;Re>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=Re),F.push(ge+Re/2)};for(let V=0;V<64;V++)for(let Z=0;Z<64;Z++){const Y=65*V+Z,ne=Y+1,ye=Y+65,_e=ye+1;W(Y,ye,ne),W(ne,ye,_e)}[F,H]=function(V,Z){const Y=Array.from({length:V.length},(_e,ge)=>ge);Y.sort((_e,ge)=>V[_e]-V[ge]);const ne=[],ye=new no;for(let _e=0;_e<Y.length;_e++){const ge=Y[_e];ne.push(V[ge]);const Re=3*ge,we=Re+1;ye.emplaceBack(Z.uint16[Re],Z.uint16[we],Z.uint16[we+1])}return[ne,ye]}(F,H),this.elevatedGlobeTrianglesCenterLongitudes=F,this.elevatedGlobeIndexBuffer=t.createIndexBuffer(H)}this.elevatedGlobeSegments=ri.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,R/Nt,0,O/Nt,0,0,M,S,0])}prepare(){const t=Object.keys(this.tiles).length!==0;if(this.tileID&&!t)return;const o=this.map.painter.context,u=o.gl;!this._dirty||this.texture instanceof by||(this.texture?this.texture.update(this.image):(this.texture=new jb(o,this.image,u.RGBA8),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE)),this._dirty=!1),t&&this._prepareData(o)}loadTile(t,o){this.tileID&&this.tileID.equals(t.tileID.canonical)?(this.tiles[String(t.tileID.wrap)]=t,t.buckets={},o(null)):(t.state="errored",o(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(t){const o=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!o)return null;const u=this.elevatedGlobeTrianglesCenterLongitudes;let m=(h=t+180)+360*Math.round((u[0]-h)/360);var h;const g=new ri,b=(C,I)=>{g.segments.push({vertexOffset:0,primitiveOffset:C,vertexLength:o.segments[0].vertexLength,primitiveLength:I,sortKey:void 0,vaos:{}})},E=.51*this.maxLongitudeTriangleSize;if(Math.abs(u[0]-m)<=E){const C=it(u,0,u.length,m+E);return C===u.length||b(C,Bn(u,C+1,u.length,m+360-E)-C),g}m<u[0]&&(m+=360);const A=Bn(u,0,u.length,m-E);if(A===u.length)return b(0,u.length),g;b(0,A-0);const v=it(u,A+1,u.length,m+E);return v!==u.length&&b(v,u.length-v),g}}const XD=(Math.pow(256,2)-1)/16907520;class u4 extends Bo{constructor(t,o,u,m){super(t,{layout:a4||(a4=new ti({visibility:new zt(nt.layout_raster.visibility)})),paint:s4||(s4=new ti({"raster-opacity":new zt(nt.paint_raster["raster-opacity"]),"raster-color":new Zc(nt.paint_raster["raster-color"]),"raster-color-mix":new zt(nt.paint_raster["raster-color-mix"]),"raster-color-range":new zt(nt.paint_raster["raster-color-range"]),"raster-hue-rotate":new zt(nt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new zt(nt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new zt(nt.paint_raster["raster-brightness-max"]),"raster-saturation":new zt(nt.paint_raster["raster-saturation"]),"raster-contrast":new zt(nt.paint_raster["raster-contrast"]),"raster-resampling":new zt(nt.paint_raster["raster-resampling"]),"raster-fade-duration":new zt(nt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new zt(nt.paint_raster["raster-emissive-strength"]),"raster-array-band":new zt(nt.paint_raster["raster-array-band"]),"raster-elevation":new zt(nt.paint_raster["raster-elevation"]),"raster-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},o,u,m),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(t){return!(t&&t._source instanceof c4&&(t._source.onNorthPole||t._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(t){t!=="raster-color"&&t!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(t){if(!this.hasColorMap()||!this._curRampRange)return;const o=this._transitionablePaint._values["raster-color"].value.expression,[u,m]=t||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(u)&&isNaN(m)||u===this._curRampRange[0]&&m===this._curRampRange[1]||(this.colorRamp=Om({expression:o,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:u,end:m}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[u,m])}}let h4,d4,f4,p4,m4;class g4 extends Bo{constructor(t,o,u,m){super(t,{layout:h4||(h4=new ti({visibility:new zt(nt["layout_raster-particle"].visibility)})),paint:d4||(d4=new ti({"raster-particle-array-band":new zt(nt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new zt(nt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new Zc(nt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new zt(nt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new zt(nt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new zt(nt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new zt(nt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new zt(nt["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},o,u,m),this._updateColorRamp(),this.lastInvalidatedAt=pt.now()}onRemove(t){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(t){return!1}_handleSpecialPaintPropertyUpdate(t){t!=="raster-particle-color"&&t!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),t==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const t=this._transitionablePaint._values["raster-particle-color"].value.expression,o=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=Om({expression:t,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:o}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=pt.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class YD extends Bo{constructor(t,o){super(t,{},o,null),this.implementation=t,t.slot&&(this.slot=t.slot)}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(t){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(t){this.implementation.onAdd&&this.implementation.onAdd(t,t.painter.context.gl)}onRemove(t){this.implementation.onRemove&&this.implementation.onRemove(t,t.painter.context.gl)}}function $b(l,t,o){const u=[0,0,1],m=Ae.quat.identity([]);return Ae.quat.rotateY(m,m,o?-ar(l)+Math.PI:ar(l)),Ae.quat.rotateX(m,m,-ar(t)),Ae.vec3.transformQuat(u,u,m),Ae.vec3.normalize(u,u)}function _4(l,t){const o=Ey(l.projection,l.zoom,l.width,l.height),u=function(h,g,b,E,A){const v=new rn(b.lng-180*cu,b.lat),C=new rn(b.lng+180*cu,b.lat),I=h.project(v.lng,v.lat),S=h.project(C.lng,C.lat),M=-Math.atan2(S.y-I.y,S.x-I.x),R=_.fromLngLat(b);R.y=Jt(R.y,-1+cu,1-cu);const O=R.toLngLat(),F=h.project(O.lng,O.lat),H=_.fromLngLat(O);H.x+=cu;const W=H.toLngLat(),V=h.project(W.lng,W.lat),Z=v4(V.x-F.x,V.y-F.y,M),Y=_.fromLngLat(O);Y.y+=cu;const ne=Y.toLngLat(),ye=h.project(ne.lng,ne.lat),_e=v4(ye.x-F.x,ye.y-F.y,M),ge=Math.abs(Z.x)/Math.abs(_e.y),Re=Ae.mat4.identity([]);Ae.mat4.rotateZ(Re,Re,-M*(1-(A?0:E)));const we=Ae.mat4.identity([]);return Ae.mat4.scale(we,we,[1,1-(1-ge)*E,1]),we[4]=-_e.x/_e.y*E,Ae.mat4.rotateZ(we,we,M),Ae.mat4.multiply(we,Re,we),we}(l.projection,0,l.center,o,t),m=y4(l);return Ae.mat4.scale(u,u,[m,m,1]),u}function y4(l){const t=l.projection,o=Ey(l.projection,l.zoom,l.width,l.height),u=Vb(t,l.center),m=Vb(t,rn.convert(t.center));return Math.pow(2,u*o+(1-o)*m)}function Ey(l,t,o,u,m=1/0){const h=l.range;if(!h)return 0;const g=Math.min(m,Math.max(o,u)),b=Math.log(g/1024)/Math.LN2;return bn(h[0]+b,h[1]+b,t)}const cu=1/4e4;function Vb(l,t){const o=Jt(t.lat,-mi,mi),u=new rn(t.lng-180*cu,o),m=new rn(t.lng+180*cu,o),h=l.project(u.lng,o),g=l.project(m.lng,o),b=_.fromLngLat(u),E=_.fromLngLat(m),A=g.x-h.x,v=g.y-h.y,C=E.x-b.x,I=E.y-b.y,S=Math.sqrt((C*C+I*I)/(A*A+v*v));return Math.log(S)/Math.LN2}function v4(l,t,o){const u=Math.cos(o),m=Math.sin(o);return{x:l*u-t*m,y:l*m+t*u}}function x4(l,t,o){Ae.mat4.identity(l),Ae.mat4.rotateZ(l,l,ar(t[2])),Ae.mat4.rotateX(l,l,ar(t[0])),Ae.mat4.rotateY(l,l,ar(t[1])),Ae.mat4.scale(l,l,o),Ae.mat4.multiply(l,l,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Ty(l,t,o,u,m,h,g,b){const E=[o[0]-t[0],o[1]-t[1],0],A=[u[0]-t[0],u[1]-t[1],0];if(Ae.vec3.length(E)<1e-12||Ae.vec3.length(A)<1e-12)return Ae.quat.identity(l);const v=Ae.vec3.cross([],E,A);Ae.vec3.normalize(v,v),Ae.vec3.subtract(A,u,t),E[2]=(h-m)*b,A[2]=(g-m)*b;const C=E;return Ae.vec3.cross(C,E,A),Ae.vec3.normalize(C,C),Ae.quat.rotationTo(l,v,C)}function Ub(l,t,o=!1){const u=mo(t.zoom),m=function(h,g,b){const E=g.worldSize,A=[h[12],h[13],h[14]],v=Zi(A[1]/E),C=ta(A[0]/E),I=Ae.mat4.identity([]),S=wo(1,v)*E,M=wo(1,0)*E*n(v,g.zoom),R=1/No(E);let O=M*R;if(b){const V=Ey(g.projection,g.zoom,g.width,g.height,1024);O=R*g.projection.pixelSpaceConversion(g.center.lat,E,V)}const F=hc(v,C);Ae.vec3.add(F,F,Ae.vec3.scale([],Ae.vec3.normalize([],F),S*O*A[2]));const H=function(V){const Z=[V[0],V[1],V[2]];let Y=[0,1,0];const ne=Ae.vec3.cross([],Y,Z);return Ae.vec3.cross(Y,Z,ne),Ae.vec3.squaredLength(Y)===0&&(Y=[0,1,0],Ae.vec3.cross(ne,Z,Y)),Ae.vec3.normalize(ne,ne),Ae.vec3.normalize(Y,Y),Ae.vec3.normalize(Z,Z),[ne[0],ne[1],ne[2],0,Y[0],Y[1],Y[2],0,Z[0],Z[1],Z[2],0,V[0],V[1],V[2],1]}(F);Ae.mat4.scale(I,I,[O,O,O*S]),Ae.mat4.translate(I,I,[-A[0],-A[1],-A[2]]);const W=Ae.mat4.multiply([],g.globeMatrix,H);return Ae.mat4.multiply(W,W,I),Ae.mat4.multiply(W,W,h),W}(l,t,o);if(u>0){const h=function(g,b){const E=b.worldSize,A=wo(1,0)*E*n(b.center.lat,b.zoom)/No(E),v=wo(1,b.center.lat)*E,C=Ae.mat4.identity([]);return Ae.mat4.rotateY(C,C,ar(b.center.lng)),Ae.mat4.rotateX(C,C,ar(b.center.lat)),Ae.mat4.translate(C,C,[0,0,fo]),Ae.mat4.scale(C,C,[A,A,A*v]),Ae.mat4.translate(C,C,[b.point.x-.5*E,b.point.y-.5*E,0]),Ae.mat4.multiply(C,C,g),Ae.mat4.multiply(C,b.globeMatrix,C)}(l,t);return function(g,b,E){const A=(M,R,O)=>{const F=Ae.vec3.length(M),H=Ae.vec3.length(R),W=vi(M,R,O);return Ae.vec3.scale(W,W,1/Ae.vec3.length(W)*ur(F,H,O))},v=A([g[0],g[1],g[2]],[b[0],b[1],b[2]],E),C=A([g[4],g[5],g[6]],[b[4],b[5],b[6]],E),I=A([g[8],g[9],g[10]],[b[8],b[9],b[10]],E),S=vi([g[12],g[13],g[14]],[b[12],b[13],b[14]],E);return[v[0],v[1],v[2],0,C[0],C[1],C[2],0,I[0],I[1],I[2],0,S[0],S[1],S[2],1]}(m,h,u)}return m}function b4(l,t,o,u){const m=pr.projectAabbCorners(u,o);let h=Number.MAX_VALUE,g=-1;for(let A=0;A<m.length;++A){const v=m[A];v[0]=(.5*v[0]+.5)*t.width,v[1]=(.5-.5*v[1])*t.height,v[2]<h&&(g=A,h=v[2])}const b=A=>new wt(m[A][0],m[A][1]);let E;switch(g){case 0:case 6:E=[b(1),b(5),b(4),b(7),b(3),b(2),b(1)];break;case 1:case 7:E=[b(0),b(4),b(5),b(6),b(2),b(3),b(0)];break;case 3:case 5:E=[b(1),b(0),b(4),b(7),b(6),b(2),b(1)];break;default:E=[b(1),b(5),b(6),b(7),b(3),b(0),b(1)]}if(oe(l,E))return h}const KD=on([{name:"a_pos_3f",components:3,type:"Float32"}]),JD=on([{name:"a_color_3f",components:3,type:"Float32"}]),QD=on([{name:"a_color_4f",components:4,type:"Float32"}]),eO=on([{name:"a_uv_2f",components:2,type:"Float32"}]),tO=on([{name:"a_normal_3f",components:3,type:"Float32"}]),rO=on([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),nO=on([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),w4={None:0,Model:1,Symbol:2,FillExtrusion:4,All:7};class Cy{constructor(t,o,u,m){this.message=(t?`${t}: `:"")+u,m&&(this.identifier=m),o!=null&&o.__line__&&(this.line=o.__line__)}}function S4(l,t){const o=l.indexOf("://")===-1;try{return new URL(l,o&&t?"http://example.com":void 0),!0}catch{return!1}}class E4{constructor(t,o){this.feature=t,this.instancedDataOffset=o,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class T4{constructor(){this.instancedDataArray=new tf,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class Gb{constructor(t){this.zoom=t.zoom,this.canonical=t.canonical,this.layers=t.layers,this.layerIds=this.layers.map(o=>o.fqid),this.projection=t.projection,this.index=t.index,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0}updateFootprints(t,o){}populate(t,o,u,m){this.tileToMeter=p(u);const h=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:g,id:b,index:E,sourceLayerIndex:A}of t){const v=b??(g.properties&&g.properties.hasOwnProperty("id")?g.properties.id:void 0),C=G(g,h);if(!this.layers[0]._featureFilter.filter(new Vn(this.zoom),C,u))continue;const I={id:v,sourceLayerIndex:A,index:E,geometry:h?C.geometry:B(g,u,m),properties:g.properties,type:g.type,patterns:{}},S=this.addFeature(I,I.geometry,C);S&&o.featureIndex.insert(g,I.geometry,E,A,this.index,this.instancesPerModel[S].instancedDataArray.length,Nt/32)}this.lookup=null}update(t,o,u,m){for(const h in this.instancesPerModel){const g=this.instancesPerModel[h];for(const b in t)g.idToFeaturesIndex.hasOwnProperty(b)&&(this.evaluate(g.features[g.idToFeaturesIndex[b]],t[b],g,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let t=!1;for(const o in this.instancesPerModel){const u=this.instancesPerModel[o];for(const m of u.features){const h=this.layers[0],g=m.feature,b=this.canonical,E=h.paint.get("model-rotation").evaluate(g,{},b),A=h.paint.get("model-scale").evaluate(g,{},b),v=h.paint.get("model-translation").evaluate(g,{},b);Ae.vec3.exactEquals(m.rotation,E)&&Ae.vec3.exactEquals(m.scale,A)&&Ae.vec3.exactEquals(m.translation,v)||(this.evaluate(m,m.featureStates,u,!0),t=!0)}}return t}updateReplacement(t,o,u,m){if(o.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=o.updateTime;const h=o.getReplacementRegionsForTile(t.toUnwrapped(),!0);if(mb(this.activeReplacements,h))return!1;this.activeReplacements=h;let g=!1;for(const b in this.instancesPerModel){const E=this.instancesPerModel[b],A=E.instancedDataArray;for(const v of E.features){const C=v.instancedDataOffset,I=v.instancedDataCount;for(let S=0;S<I;S++){const M=16*(S+C);let R=A.float32[M+0];const O=R>Nt;R=O?R-Nt:R;const F=Math.floor(R),H=A.float32[M+1];let W=!1;for(const V of this.activeReplacements)if(!NT(V,u,w4.Model,m)&&!(V.min.x>F||F>V.max.x||V.min.y>H||H>V.max.y)&&(W=HT(GT(F,H,t.canonical,V.footprintTileId.canonical),V.footprint),W))break;A.float32[M]=W?R+Nt:R,g=g||W!==O}}}return g}isEmpty(){for(const t in this.instancesPerModel)if(this.instancesPerModel[t].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(t){if(!this.uploaded)for(const o in this.instancesPerModel){const u=this.instancesPerModel[o];u.instancedDataArray.length<0||u.instancedDataArray.length===0||(u.instancedDataBuffer?u.instancedDataBuffer.updateData(u.instancedDataArray):u.instancedDataBuffer=t.createVertexBuffer(u.instancedDataArray,rO.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const o in this.instancesPerModel){const u=this.instancesPerModel[o];u.instancedDataArray.length!==0&&u.instancedDataBuffer&&u.instancedDataBuffer.destroy()}const t=this.layers[0].modelManager;if(t&&this.modelUris)for(const o of this.modelUris)t.removeModel(o,"")}addFeature(t,o,u){const m=this.layers[0],h=m.layout.get("model-id").evaluate(u,{},this.canonical);if(!h)return gr(`modelId is not evaluated for layer ${m.id} and it is not going to get rendered.`),h;S4(h,!1)&&(this.modelUris.includes(h)||this.modelUris.push(h)),this.instancesPerModel[h]||(this.instancesPerModel[h]=new T4);const g=this.instancesPerModel[h],b=g.instancedDataArray,E=new E4(u,b.length);for(const A of o)for(const v of A){if(v.x<0||v.x>=Nt||v.y<0||v.y>=Nt)continue;const C=(this.lookupDim-1)/Nt,I=this.lookupDim*(v.y*C|0)+v.x*C|0;if(this.lookup){if(this.lookup[I]!==0)continue;this.lookup[I]=1}this.instanceCount++;const S=b.length;b.resize(S+1),g.instancesEvaluatedElevation.push(0),b.float32[16*S]=v.x,b.float32[16*S+1]=v.y}return E.instancedDataCount=g.instancedDataArray.length-E.instancedDataOffset,E.instancedDataCount>0&&(t.id&&(g.idToFeaturesIndex[t.id]=g.features.length),g.features.push(E),this.evaluate(E,{},g,!1)),h}getModelUris(){return this.modelUris}evaluate(t,o,u,m){const h=this.layers[0],g=t.feature,b=this.canonical,E=t.rotation=h.paint.get("model-rotation").evaluate(g,o,b),A=t.scale=h.paint.get("model-scale").evaluate(g,o,b),v=t.translation=h.paint.get("model-translation").evaluate(g,o,b),C=h.paint.get("model-color").evaluate(g,o,b);C.a=h.paint.get("model-color-mix-intensity").evaluate(g,o,b);const I=[];this.maxVerticalOffset<v[2]&&(this.maxVerticalOffset=v[2]),this.maxScale=Math.max(Math.max(this.maxScale,A[0]),Math.max(A[1],A[2])),x4(I,E,A);const S=Math.round(100*C.a)+C.b/1.05;for(let M=0;M<t.instancedDataCount;++M){const R=t.instancedDataOffset+M,O=16*R,F=u.instancedDataArray.float32;let H=0;m&&(H=F[O+6]-u.instancesEvaluatedElevation[R]);const W=0|F[O+1];F[O]=(0|F[O])+C.r/1.05,F[O+1]=W+C.g/1.05,F[O+2]=S,F[O+3]=1/(b.z>10?this.tileToMeter:p(b,W)),F[O+4]=v[0],F[O+5]=v[1],F[O+6]=v[2]+H,F[O+7]=I[0],F[O+8]=I[1],F[O+9]=I[2],F[O+10]=I[4],F[O+11]=I[5],F[O+12]=I[6],F[O+13]=I[8],F[O+14]=I[9],F[O+15]=I[10],u.instancesEvaluatedElevation[R]=v[2]}}}let C4,M4;Yt(Gb,"ModelBucket",{omit:["layers"]}),Yt(T4,"PerModelAttributes"),Yt(E4,"ModelFeature");const Mh=64,bf={CoordinateSpaceTile:1,CoordinateSpaceYUp:2,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function I4(l,t,o,u,m,h,g,b,E,A=!1){const v=o.zoom,C=o.project(u),I=n(u.lat,v),S=1/I;Ae.mat4.identity(l),Ae.mat4.translate(l,l,[C.x+g[0]*S,C.y+g[1]*S,g[2]]);let M=1,R=1;const O=o.worldSize;if(A){if(o.projection.name==="mercator"){let V=0;o.elevation&&(V=o.elevation.getAtPointOrZero(new _(C.x/O,C.y/O),0));const Z=Ae.vec4.transformMat4([],[C.x,C.y,V,1],o.projMatrix)[3]/o.cameraToCenterDistance;M=Z,R=Z*n(o.center.lat,v)}else if(o.projection.name==="globe"){const V=Ub(l,o),Z=Ae.mat4.multiply([],o.projMatrix,V),Y=[0,0,0,1];Ae.vec4.transformMat4(Y,Y,Z);const ne=Y[3]/o.cameraToCenterDistance,ye=mo(v),_e=o.projection.pixelsPerMeter(u.lat,O)*n(u.lat,v),ge=o.projection.pixelsPerMeter(o.center.lat,O)*n(o.center.lat,v);M=ne/ur(_e,f(o.center.lat),ye),R=ne*I/_e,M*=ge,R*=ge}}else M=S;Ae.mat4.scale(l,l,[M,M,R]);const F=[...l],H=t.orientation,W=[];if(x4(W,[H[0]+m[0],H[1]+m[1],H[2]+m[2]],h),Ae.mat4.multiply(l,F,W),b&&o.elevation){let V=0;const Z=[];if(E&&o.elevation){V=function(ye,_e,ge,Re,we){const Le=_e.elevation;if(!Le)return 0;const Be=pr.projectAabbCorners(ge,Re),Oe=wo(1,we.lat)*_e.worldSize,Ve=function(er,Ot){const Kt=[0,0,1],hr=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Ar of hr){const kr=er[Ar.corners[0]],jr=er[Ar.corners[1]],Dr=er[Ar.corners[2]],Zr=[jr[0]-kr[0],jr[1]-kr[1],Ot*(jr[2]-kr[2])],Cn=Ae.vec3.cross(Zr,Zr,[Dr[0]-kr[0],Dr[1]-kr[1],Ot*(Dr[2]-kr[2])]);Ae.vec3.normalize(Cn,Cn),Ar.dotProductWithUp=Ae.vec3.dot(Cn,Kt)}return hr.sort((Ar,kr)=>Ar.dotProductWithUp-kr.dotProductWithUp),hr[0].corners}(Be,Oe),We=Be[Ve[0]],Qe=Be[Ve[1]],Ge=Be[Ve[2]],ut=Be[Ve[3]],It=Le.getAtPointOrZero(new _(We[0]/_e.worldSize,We[1]/_e.worldSize),0),dt=Le.getAtPointOrZero(new _(Qe[0]/_e.worldSize,Qe[1]/_e.worldSize),0),Dt=Le.getAtPointOrZero(new _(Ge[0]/_e.worldSize,Ge[1]/_e.worldSize),0),kt=Le.getAtPointOrZero(new _(ut[0]/_e.worldSize,ut[1]/_e.worldSize),0),$t=(It+kt)/2,_t=(dt+Dt)/2;return $t>_t?dt<Dt?Ty(ye,Qe,ut,We,dt,kt,It,Oe):Ty(ye,Ge,We,ut,Dt,It,kt,Oe):It<kt?Ty(ye,We,Qe,Ge,It,dt,Dt,Oe):Ty(ye,ut,Ge,Qe,kt,Dt,dt,Oe),Math.max($t,_t)}(Z,o,t.aabb,l,u);const Y=Ae.mat4.fromQuat([],Z),ne=Ae.mat4.multiply([],Y,W);Ae.mat4.multiply(l,F,ne)}else V=o.elevation.getAtPointOrZero(new _(C.x/O,C.y/O),0);V!==0&&(l[14]+=V)}}function rg(l,t,o=!1){l.uploaded||(l.gfxTexture=new jb(t,l.image,o?t.gl.R8:t.gl.RGBA8,{useMipmap:l.sampler.minFilter>=t.gl.NEAREST_MIPMAP_NEAREST}),l.uploaded=!0,l.image=null)}function iO(l,t,o){l.indexBuffer=t.createIndexBuffer(l.indexArray,!1,!0),l.vertexBuffer=t.createVertexBuffer(l.vertexArray,KD.members,!1,!0),l.normalArray&&(l.normalBuffer=t.createVertexBuffer(l.normalArray,tO.members,!1,!0)),l.texcoordArray&&(l.texcoordBuffer=t.createVertexBuffer(l.texcoordArray,eO.members,!1,!0)),l.colorArray&&(l.colorBuffer=t.createVertexBuffer(l.colorArray,(l.colorArray.bytesPerElement===12?JD:QD).members,!1,!0)),l.featureArray&&(l.pbrBuffer=t.createVertexBuffer(l.featureArray,nO.members,!0)),l.segments=ri.simpleSegment(0,0,l.vertexArray.length,l.indexArray.length);const u=l.material;u.pbrMetallicRoughness.baseColorTexture&&rg(u.pbrMetallicRoughness.baseColorTexture,t),u.pbrMetallicRoughness.metallicRoughnessTexture&&rg(u.pbrMetallicRoughness.metallicRoughnessTexture,t),u.normalTexture&&rg(u.normalTexture,t),u.occlusionTexture&&rg(u.occlusionTexture,t,o),u.emissionTexture&&rg(u.emissionTexture,t)}function Hb(l,t,o){if(l.meshes)for(const u of l.meshes)iO(u,t,o);if(l.children)for(const u of l.children)Hb(u,t,o)}function My(l){if(l.meshes)for(const t of l.meshes)t.indexArray.destroy(),t.vertexArray.destroy(),t.colorArray&&t.colorArray.destroy(),t.normalArray&&t.normalArray.destroy(),t.texcoordArray&&t.texcoordArray.destroy(),t.featureArray&&t.featureArray.destroy();if(l.children)for(const t of l.children)My(t)}function Wb(l){if(l.meshes)for(const o of l.meshes)o.vertexBuffer&&(o.vertexBuffer.destroy(),o.indexBuffer.destroy(),o.normalBuffer&&o.normalBuffer.destroy(),o.texcoordBuffer&&o.texcoordBuffer.destroy(),o.colorBuffer&&o.colorBuffer.destroy(),o.pbrBuffer&&o.pbrBuffer.destroy(),o.segments.destroy(),o.material&&((t=o.material).pbrMetallicRoughness.baseColorTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture&&t.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),t.pbrMetallicRoughness.metallicRoughnessTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&t.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),t.normalTexture&&t.normalTexture.gfxTexture&&t.normalTexture.gfxTexture.destroy(),t.emissionTexture&&t.emissionTexture.gfxTexture&&t.emissionTexture.gfxTexture.destroy(),t.occlusionTexture&&t.occlusionTexture.gfxTexture&&t.occlusionTexture.gfxTexture.destroy()));var t;if(l.children)for(const o of l.children)Wb(o)}class wf{constructor(t,o,u){this._demTile=t,this._dem=this._demTile.dem,this._scale=o,this._offset=u}static create(t,o,u){const m=u||t.findDEMTileFor(o);if(!m||!m.dem)return;const h=m.dem,g=m.tileID,b=1<<o.canonical.z-g.canonical.z;return new wf(m,h.dim/Nt/b,[(o.canonical.x/b-g.canonical.x)*h.dim,(o.canonical.y/b-g.canonical.y)*h.dim])}tileCoordToPixel(t,o){const u=o*this._scale+this._offset[1],m=Math.floor(t*this._scale+this._offset[0]),h=Math.floor(u);return new wt(m,h)}getElevationAt(t,o,u,m){const h=t*this._scale+this._offset[0],g=o*this._scale+this._offset[1],b=Math.floor(h),E=Math.floor(g),A=this._dem;return m=!!m,u?ur(ur(A.get(b,E,m),A.get(b,E+1,m),g-E),ur(A.get(b+1,E,m),A.get(b+1,E+1,m),g-E),h-b):A.get(b,E,m)}getElevationAtPixel(t,o,u){return this._dem.get(t,o,!!u)}getMeterToDEM(t){return(1<<this._demTile.tileID.canonical.z)*wo(1,t)*this._dem.stride}}const qb=new Float32Array(262144),Ih=new Uint8Array(262144);function P4(l){let t=0;if(l.meshes)for(const o of l.meshes)t=Math.max(t,o.aabb.max[2]);if(l.children)for(const o of l.children)t=Math.max(t,P4(o));return t}function A4(l,t,o){if(l.meshes)for(const u of l.meshes){if(u.aabb.min[0]===1/0)continue;const m=pr.applyTransform(u.aabb,l.matrix);o.insert(t,m.min[0],m.min[1],m.max[0],m.max[1])}if(l.children)for(const u of l.children)A4(u,t,o)}const R4=["","wall","door","roof","window","lamp","logo"];class z4{constructor(t){this.node=t,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:t.id,geometry:[],properties:{height:P4(t)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new pr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let t=0;const o=new pr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const u of this.node.meshes)this.node.lightMeshIndex!==t&&(u.transformedAabb=pr.applyTransformFast(u.aabb,this.node.matrix),o.encapsulate(u.transformedAabb)),t++;this.aabb=o}return this.aabb}}class Iy{constructor(t,o,u,m,h,g,b){this.id=u,this.layers=t,this.layerIds=this.layers.map(E=>E.fqid),this.stateDependentLayerIds=this.layers.filter(E=>E.isStateDependent()).map(E=>E.id),this.modelTraits|=bf.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,m&&(this.modelTraits|=bf.HasMapboxMeshFeatures),h&&(this.modelTraits|=bf.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=g,this.dirty=!0,this.needsUpload=!1,this.nodesInfo=[];for(const E of o)this.nodesInfo.push(new z4(E)),A4(E,b.featureIndexArray.length,b.grid),b.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,b.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(t,o){for(const u of this.getNodesInfo()){const m=u.node;m.footprint&&o.push({footprint:m.footprint,id:t})}}update(t){const o=Object.keys(t).length!==0;if(o&&!this.stateDependentLayers.length)return;const u=o?this.stateDependentLayers:this.layers;if(!Pr(t,this.states))for(const m of u)this.evaluate(m,t);this.states=structuredClone(t)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(t){if(!this.needsUpload)return;const o=this.getNodesInfo();for(const u of o){const m=u.node;this.uploaded?this.updatePbrBuffer(m):Hb(m,t,!0)}for(const u of o)My(u.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(t){let o=!1;if(!t.meshes)return o;for(const u of t.meshes)u.pbrBuffer&&(u.pbrBuffer.updateData(u.featureArray),o=!0);return o}needsReEvaluation(t,o,u){const m=t.transform.projectionOptions,h=t.style.getBrightness(),g=this.brightness!==h;if(!this.uploaded||this.dirty||m.name!==this.projection.name||ng(u.paint.get("model-color").value,g)||ng(u.paint.get("model-color-mix-intensity").value,g)||ng(u.paint.get("model-roughness").value,g)||ng(u.paint.get("model-emissive-strength").value,g)||ng(u.paint.get("model-height-based-emissive-strength-multiplier").value,g)){this.projection=m,this.brightness=h;const b=this.getNodesInfo();for(const E of b)E.state=null;return!0}return!1}evaluateScale(t,o){if(t.transform.zoom===this.zoom)return;this.zoom=t.transform.zoom;const u=this.getNodesInfo(),m=this.id.canonical;for(const h of u){const g=h.feature;h.evaluatedScale=o.paint.get("model-scale").evaluate(g,{},m)}}evaluate(t,o){const u=this.getNodesInfo();for(const m of u){if(!m.node.meshes)continue;const h=m.feature,g=o&&o[h.id];if(Pr(g,m.state))continue;m.state=structuredClone(g);const b=m.node.meshes&&m.node.meshes[0].featureData,E=m.evaluatedColor[2],A=m.evaluatedRMEA[2],v=this.id.canonical;if(m.hasTranslucentParts=!1,b){for(let C=0;C<R4.length;C++){const I=R4[C];I.length&&(h.properties.part=I);const S=t.paint.get("model-color").evaluate(h,g,v).toRenderColor(null),M=t.paint.get("model-color-mix-intensity").evaluate(h,g,v);m.evaluatedColor[C]=[S.r,S.g,S.b,M],m.evaluatedRMEA[C][0]=t.paint.get("model-roughness").evaluate(h,g,v),m.evaluatedRMEA[C][2]=t.paint.get("model-emissive-strength").evaluate(h,g,v),m.evaluatedRMEA[C][3]=S.a,m.emissionHeightBasedParams[C]=t.paint.get("model-height-based-emissive-strength-multiplier").evaluate(h,g,v),!m.hasTranslucentParts&&S.a<1&&(m.hasTranslucentParts=!0)}delete h.properties.part,aO(m,E!==m.evaluatedColor[2]||A!==m.evaluatedRMEA[2],this.modelTraits)}else m.evaluatedRMEA[0][2]=t.paint.get("model-emissive-strength").evaluate(h,g,v);m.evaluatedScale=t.paint.get("model-scale").evaluate(h,g,v),this.updatePbrBuffer(m.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(t,o,u,m){const h=t.findDEMTileFor(u);if(h&&(h.tileID.canonical!==this.terrainTile||o!==this.terrainExaggeration)){if(h.dem&&h.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=h.tileID.overscaledZ;const g=wf.create(t,u,h);if(!g)return;this.modelTraits&bf.HasMapboxMeshFeatures&&this.updateDEM(t,g,u,m);for(const b of this.getNodesInfo()){const E=b.node;if(!E.footprint||!E.footprint.vertices||!E.footprint.vertices.length)continue;const A=E.footprint.vertices;let v=g.getElevationAt(A[0].x,A[0].y,!0,!0);for(let C=1;C<A.length;C++)v=Math.min(v,g.getElevationAt(A[C].x,A[C].y,!0,!0));E.elevation=v}}this.terrainTile=h.tileID.canonical,this.terrainExaggeration=o}}updateDEM(t,o,u,m){let h=o._dem._modifiedForSources[m];if(h===void 0&&(o._dem._modifiedForSources[m]=[],h=o._dem._modifiedForSources[m]),h.includes(u.canonical))return;const g=o._dem.dim;h.push(u.canonical);let b=!1;for(const E of this.getNodesInfo()){const A=E.node;if(!A.footprint||!A.footprint.grid)continue;const v=A.footprint.grid,C=o.tileCoordToPixel(v.min.x,v.min.y),I=o.tileCoordToPixel(v.max.x,v.max.y),S=Math.min(Math.min(g-I.y,C.x),Math.min(C.y,g-I.x));if(S<0)continue;const M=Jt(S,2,5);let R=Math.max(0,C.x-M),O=Math.max(0,C.y-M),F=Math.min(I.x+M,g-1),H=Math.min(I.y+M,g-1);for(let Y=O;Y<=H;++Y)for(let ne=R;ne<=F;++ne)Ih[Y*g+ne]=255;let W=0,V=0;for(let Y=0;Y<v.cellsY;++Y)for(let ne=0;ne<v.cellsX;++ne){if(!v.cells[Y*v.cellsX+ne])continue;const ye=o.tileCoordToPixel(v.min.x+ne/v.xScale,v.min.y+Y/v.yScale),_e=o.tileCoordToPixel(v.min.x+(ne+1)/v.xScale,v.min.y+(Y+1)/v.yScale);for(let ge=ye.y;ge<=Math.min(_e.y+1,g-1);++ge)for(let Re=ye.x;Re<=Math.min(_e.x+1,g-1);++Re)Ih[ge*g+Re]===255&&(Ih[ge*g+Re]=0,W+=o.getElevationAtPixel(Re,ge),V++)}const Z=W/V;R=Math.max(1,C.x-M),O=Math.max(1,C.y-M),F=Math.min(I.x+M,g-2),H=Math.min(I.y+M,g-2),b=!0;for(let Y=O;Y<=H;++Y)for(let ne=R;ne<=F;++ne)Ih[Y*g+ne]===0&&(qb[Y*g+ne]=o._dem.set(ne,Y,Z));for(let Y=1;Y<M;++Y){R=Math.max(1,C.x-Y),O=Math.max(1,C.y-Y),F=Math.min(I.x+Y,g-2),H=Math.min(I.y+Y,g-2);for(let ne=O;ne<=H;++ne)for(let ye=R;ye<=F;++ye){const _e=ne*g+ye;if(Ih[_e]===255){let ge=0,Re=0,we=-1,Le=-1;for(let Be=-1;Be<=1;++Be)for(let Oe=-1;Oe<=1;++Oe){const Ve=(ne+Be)*g+ye+Oe;if(Ih[Ve]>=Y)continue;const We=qb[Ve],Qe=Math.abs(We);Qe>Re&&(ge=We,Re=Qe,we=Oe,Le=Be)}if(Re>.1){const Be=1-(Y+.5*Math.abs(we*Le))/M;let Oe=o._dem.get(ye,ne)+ge*Be;const Ve=o._dem.get(ye+we,ne+Le),We=o._dem.get(ye-we,ne-Le,!0);(Oe-Ve)*(Oe-We)>0&&(Oe=(Ve+We)/2),qb[_e]=o._dem.set(ye,ne,Oe),Ih[_e]=Y}}}}}b&&(o._demTile.needsDEMTextureUpload=!0,o._dem._timestamp=pt.now())}getNodesInfo(){return this.nodesInfo}destroy(){const t=this.getNodesInfo();for(const o of t)My(o.node),Wb(o.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(t,o){if(o.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=o.updateTime;const u=o.getReplacementRegionsForTile(t.toUnwrapped()),m=this.getNodesInfo();for(let h=0;h<this.nodesInfo.length;h++){const g=m[h].node;m[h].hiddenByReplacement=!!g.footprint&&!u.find(b=>b.footprint===g.footprint)}}getHeightAtTileCoord(t,o){const u=this.getNodesInfo(),m=[],h=[0,0,0],g=Ae.mat4.identity([]);for(let b=0;b<this.nodesInfo.length;b++){const E=u[b],A=E.node.meshes[0],v=A.transformedAabb;if(t<v.min[0]||o<v.min[1]||t>v.max[0]||o>v.max[1])continue;if(E.node.hidden===!0)return{height:1/0,maxHeight:E.feature.properties.height,hidden:!1,verticalScale:E.evaluatedScale[2]};Ae.mat4.invert(g,E.node.matrix),h[0]=t,h[1]=o,Ae.vec3.transformMat4(h,h,g);const C=(h[0]-A.aabb.min[0])/(A.aabb.max[0]-A.aabb.min[0])*Mh|0,I=Math.min(63,(h[1]-A.aabb.min[1])/(A.aabb.max[1]-A.aabb.min[1])*Mh|0)*Mh+Math.min(63,C),S=A.heightmap[I];if(!(S<0&&E.node.footprint))return E.hiddenByReplacement?void 0:{height:S,maxHeight:E.feature.properties.height,hidden:!1,verticalScale:E.evaluatedScale[2]};if(E.node.footprint.grid.query(new wt(t,o),new wt(t,o),m),m.length>0)return{height:void 0,maxHeight:E.feature.properties.height,hidden:E.hiddenByReplacement,verticalScale:E.evaluatedScale[2]}}}}function ng(l,t){return!l.isLightConstant&&t}function oO(l,t,o,u,m,h,g,b){let E=(61440&t|(61440&t)>>4)>>8,A=(3840&t|(3840&t)>>4)>>4,v=240&t|(240&t)>>4;o[3]>0&&(E=ur(E,255*o[0],o[3]),A=ur(A,255*o[1],o[3]),v=ur(v,255*o[2],o[3]));const C=E<<8|A,I=v<<8|Math.floor(255*u[3]),S=function(Y){const ne=Jt(Y,0,2);return Math.min(Math.round(.5*ne*255),255)}(u[2])<<8|15*u[0]<<4|15*u[1],M=Jt(m[0],0,1),R=Jt(m[1],0,1),O=Jt(m[2],0,1),F=Jt(m[3],0,1);let H,W,V,Z;if(M!==R&&g!==h&&R!==M){const Y=g-h;W=1/(Y*(R-M)),V=-(h+Y*M)/(Y*(R-M));const ne=Jt(m[4],-1,1);Z=Math.pow(10,ne),H=255*O<<8|255*F}else H=65535,W=0,V=1,Z=1;if(l.emplaceBack(C,I,S,H,W,V,Z),b){const Y=b.length;b.clear();for(let ne=0;ne<Y;ne++)b.emplaceBack(C,I,S,H,W,V,Z)}}function aO(l,t,o){const u=l.node;let m=0;const h=o&bf.HasMeshoptCompression;for(const g of u.meshes){if(u.lights&&u.lightMeshIndex===m||!g.featureData)continue;g.featureArray=new rf,g.featureArray.reserve(g.featureData.length);let b=t;for(const E of g.featureData){const A=h?65535&E:E>>16&65535,v=h?E>>16&65535:65535&E,C=(15&v)<8?15&v:0,I=l.evaluatedRMEA[C],S=l.evaluatedColor[C],M=l.emissionHeightBasedParams[C];let R;if(b&&C===2&&u.lights&&(R=new rf,R.resize(10*u.lights.length)),oO(g.featureArray,A,S,I,M,g.aabb.min[2],g.aabb.max[2],R),R&&b){b=!1;const O=u.meshes[u.lightMeshIndex];O.featureArray=R,O.featureArray._trim()}}g.featureArray._trim(),m++}}function L4(l,t,o,u){const m=1<<l.z;t.lat=Zi((u/Nt+l.y)/m),t.lng=ta((o/Nt+l.x)/m)}Yt(Iy,"Tiled3dModelBucket",{omit:["layers"]}),Yt(z4,"Tiled3dModelFeature");const sO={circle:class extends Bo{constructor(l,t,o,u){super(l,{layout:xt||(xt=new ti({"circle-sort-key":new Ht(nt.layout_circle["circle-sort-key"]),visibility:new zt(nt.layout_circle.visibility)})),paint:st||(st=new ti({"circle-radius":new Ht(nt.paint_circle["circle-radius"]),"circle-color":new Ht(nt.paint_circle["circle-color"]),"circle-blur":new Ht(nt.paint_circle["circle-blur"]),"circle-opacity":new Ht(nt.paint_circle["circle-opacity"]),"circle-translate":new zt(nt.paint_circle["circle-translate"]),"circle-translate-anchor":new zt(nt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new zt(nt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new zt(nt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ht(nt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ht(nt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ht(nt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new zt(nt.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u)}createBucket(l){return new ie(l)}queryRadius(l){const t=l;return mt("circle-radius",this,t)+mt("circle-stroke-width",this,t)+Tt(this.paint.get("circle-translate"))}queryIntersectsFeature(l,t,o,u,m,h,g,b){const E=et(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),h.angle,l.pixelToTileUnitsFactor),A=this.paint.get("circle-radius").evaluate(t,o)+this.paint.get("circle-stroke-width").evaluate(t,o);return cT(l,u,h,g,b,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",E,A)}getProgramIds(){return["circle"]}getDefaultProgramParams(l,t,o){const u=ff(this);return{config:new lc(this,{zoom:t,lut:o}),defines:u,overrideFog:!1}}},heatmap:class extends Bo{createBucket(l){return new hT(l)}constructor(l,t,o,u){super(l,{layout:dT||(dT=new ti({visibility:new zt(nt.layout_heatmap.visibility)})),paint:fT||(fT=new ti({"heatmap-radius":new Ht(nt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ht(nt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new zt(nt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Zc(nt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new zt(nt.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Om({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(l){return mt("heatmap-radius",this,l)}queryIntersectsFeature(l,t,o,u,m,h,g,b){const E=this.paint.get("heatmap-radius").evaluate(t,o);return cT(l,u,h,g,b,!0,!0,new wt(0,0),E)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(l,t,o){return l==="heatmap"?{config:new lc(this,{zoom:t,lut:o}),overrideFog:!1}:{}}},hillshade:class extends Bo{constructor(l,t,o,u){super(l,{layout:pT||(pT=new ti({visibility:new zt(nt.layout_hillshade.visibility)})),paint:mT||(mT=new ti({"hillshade-illumination-direction":new zt(nt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new zt(nt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new zt(nt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new zt(nt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new zt(nt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new zt(nt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new zt(nt.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(l,t,o){return{overrideFog:!1}}},fill:class extends Bo{constructor(l,t,o,u){super(l,{layout:ET||(ET=new ti({"fill-sort-key":new Ht(nt.layout_fill["fill-sort-key"]),visibility:new zt(nt.layout_fill.visibility),"fill-elevation-reference":new zt(nt.layout_fill["fill-elevation-reference"])})),paint:TT||(TT=new ti({"fill-antialias":new zt(nt.paint_fill["fill-antialias"]),"fill-opacity":new Ht(nt.paint_fill["fill-opacity"]),"fill-color":new Ht(nt.paint_fill["fill-color"]),"fill-outline-color":new Ht(nt.paint_fill["fill-outline-color"]),"fill-translate":new zt(nt.paint_fill["fill-translate"]),"fill-translate-anchor":new zt(nt.paint_fill["fill-translate-anchor"]),"fill-pattern":new Ht(nt.paint_fill["fill-pattern"]),"fill-emissive-strength":new zt(nt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new Ht(nt.paint_fill["fill-z-offset"]),"fill-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u)}getProgramIds(){const l=this.paint.get("fill-pattern"),t=l&&l.constantOr(1),o=[t?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(t&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getDefaultProgramParams(l,t,o){return{config:new lc(this,{zoom:t,lut:o}),overrideFog:!1}}recalculate(l,t){super.recalculate(l,t);const o=this.paint._values["fill-outline-color"];o.value.kind==="constant"&&o.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(l){return new cb(l)}queryRadius(){return Tt(this.paint.get("fill-translate"))}queryIntersectsFeature(l,t,o,u,m,h){return!l.queryGeometry.isAboveHorizon&&Se(Lt(l.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),h.angle,l.pixelToTileUnitsFactor),u)}isTileClipped(){return!0}is3D(){return this.paint.get("fill-z-offset").constantOr(1)!==0}},"fill-extrusion":class extends Bo{constructor(l,t,o,u){super(l,{layout:aC||(aC=new ti({visibility:new zt(nt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new zt(nt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:sC||(sC=new ti({"fill-extrusion-opacity":new zt(nt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ht(nt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new zt(nt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new zt(nt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new Ht(nt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ht(nt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ht(nt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new zt(nt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new zt(nt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new zt(nt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new zt(nt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new zt(nt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new zt(nt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new zt(nt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new zt(nt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new zt(nt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new zt(nt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new Ht(nt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new Ht(nt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new zt(nt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new zt(nt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new zt(nt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new zt(nt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new Ht(nt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new Ht(nt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new zt(nt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new iy(l)}queryRadius(){return Tt(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(l,t,o,u,m,h,g,b,E){const A=et(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),h.angle,l.pixelToTileUnitsFactor),v=this.paint.get("fill-extrusion-height").evaluate(t,o),C=this.paint.get("fill-extrusion-base").evaluate(t,o),I=[0,0],S=b&&h.elevation,M=h.elevation?h.elevation.exaggeration():1,R=l.tile.getBucket(this);if(S&&R instanceof iy){const V=R.centroidVertexArray,Z=E+1;Z<V.length&&(I[0]=V.geta_centroid_pos0(Z),I[1]=V.geta_centroid_pos1(Z))}if(I[0]===0&&I[1]===1)return!1;h.projection.name==="globe"&&(u=oC([u],[new wt(0,0),new wt(Nt,Nt)],l.tileID.canonical).map(V=>V.polygon).flat());const O=S?b:null,[F,H]=function(V,Z,Y,ne,ye,_e,ge,Re,we,Le,Be){return V.projection.name==="globe"?function(Oe,Ve,We,Qe,Ge,ut,It,dt,Dt,kt,$t){const _t=[],er=[],Ot=Oe.projection.upVectorScale($t,Oe.center.lat,Oe.worldSize).metersToTile,Kt=[0,0,0,1],hr=[0,0,0,1],Ar=(jr,Dr,Zr,Cn)=>{jr[0]=Dr,jr[1]=Zr,jr[2]=Cn,jr[3]=1},kr=iC();We>0&&(We+=kr),Qe+=kr;for(const jr of Ve){const Dr=[],Zr=[];for(const Cn of jr){const vn=Cn.x+Ge.x,Tr=Cn.y+Ge.y,xn=Oe.projection.projectTilePoint(vn,Tr,$t),mn=Oe.projection.upVector($t,Cn.x,Cn.y);let Mn=We,Ti=Qe;if(It){const Ci=cC(vn,Tr,We,Qe,It,dt,Dt,kt);Mn+=Ci.base,Ti+=Ci.top}We!==0?Ar(Kt,xn.x+mn[0]*Ot*Mn,xn.y+mn[1]*Ot*Mn,xn.z+mn[2]*Ot*Mn):Ar(Kt,xn.x,xn.y,xn.z),Ar(hr,xn.x+mn[0]*Ot*Ti,xn.y+mn[1]*Ot*Ti,xn.z+mn[2]*Ot*Ti),Ae.vec3.transformMat4(Kt,Kt,ut),Ae.vec3.transformMat4(hr,hr,ut),Dr.push(new Ch(Kt[0],Kt[1],Kt[2])),Zr.push(new Ch(hr[0],hr[1],hr[2]))}_t.push(Dr),er.push(Zr)}return[_t,er]}(V,Z,Y,ne,ye,_e,ge,Re,we,Le,Be):ge?function(Oe,Ve,We,Qe,Ge,ut,It,dt,Dt){const kt=[],$t=[],_t=[0,0,0,1];for(const er of Oe){const Ot=[],Kt=[];for(const hr of er){const Ar=hr.x+Qe.x,kr=hr.y+Qe.y,jr=cC(Ar,kr,Ve,We,ut,It,dt,Dt);_t[0]=Ar,_t[1]=kr,_t[2]=jr.base,_t[3]=1,Ae.vec4.transformMat4(_t,_t,Ge),_t[3]=Math.max(_t[3],1e-5);const Dr=new Ch(_t[0]/_t[3],_t[1]/_t[3],_t[2]/_t[3]);_t[0]=Ar,_t[1]=kr,_t[2]=jr.top,_t[3]=1,Ae.vec4.transformMat4(_t,_t,Ge),_t[3]=Math.max(_t[3],1e-5);const Zr=new Ch(_t[0]/_t[3],_t[1]/_t[3],_t[2]/_t[3]);Ot.push(Dr),Kt.push(Zr)}kt.push(Ot),$t.push(Kt)}return[kt,$t]}(Z,Y,ne,ye,_e,ge,Re,we,Le):function(Oe,Ve,We,Qe,Ge){const ut=[],It=[],dt=Ge[8]*Ve,Dt=Ge[9]*Ve,kt=Ge[10]*Ve,$t=Ge[11]*Ve,_t=Ge[8]*We,er=Ge[9]*We,Ot=Ge[10]*We,Kt=Ge[11]*We;for(const hr of Oe){const Ar=[],kr=[];for(const jr of hr){const Dr=jr.x+Qe.x,Zr=jr.y+Qe.y,Cn=Ge[0]*Dr+Ge[4]*Zr+Ge[12],vn=Ge[1]*Dr+Ge[5]*Zr+Ge[13],Tr=Ge[2]*Dr+Ge[6]*Zr+Ge[14],xn=Ge[3]*Dr+Ge[7]*Zr+Ge[15],mn=Cn+dt,Mn=vn+Dt,Ti=Tr+kt,Ci=Math.max(xn+$t,1e-5),gi=Cn+_t,na=vn+er,Wn=Tr+Ot,Xn=Math.max(xn+Kt,1e-5);Ar.push(new Ch(mn/Ci,Mn/Ci,Ti/Ci)),kr.push(new Ch(gi/Xn,na/Xn,Wn/Xn))}ut.push(Ar),It.push(kr)}return[ut,It]}(Z,Y,ne,ye,_e)}(h,u,C,v,A,g,O,I,M,h.center.lat,l.tileID.canonical),W=l.queryGeometry;return function(V,Z,Y){let ne=1/0;Se(Y,Z)&&(ne=lC(Y,Z[0]));for(let ye=0;ye<Z.length;ye++){const _e=Z[ye],ge=V[ye];for(let Re=0;Re<_e.length-1;Re++){const we=_e[Re],Le=[we,_e[Re+1],ge[Re+1],ge[Re],we];oe(Y,Le)&&(ne=Math.min(ne,lC(Y,Le)))}}return ne!==1/0&&ne}(F,H,W.isPointQuery()?W.screenBounds:W.screenGeometry)}},line:class extends Bo{constructor(l,t,o,u){const m=vC();super(l,m,t,o,u),m.layout&&(this.layout=new qc(m.layout)),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(l){if(l==="line-gradient"){const t=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=t._styleExpression&&t._styleExpression.expression instanceof ih,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(l,t){super.recalculate(l,t),this.paint._values["line-floorwidth"]=(()=>{if(Hm)return Hm;const o=vC();return Hm=new uD(o.paint.properties["line-width"].specification),Hm.useIntegerZoom=!0,Hm})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,l)}createBucket(l){return new vb(l)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(l,t,o){const u=_C(this);return{config:new lc(this,{zoom:t,lut:o}),defines:u,overrideFog:!1}}queryRadius(l){const t=l,o=xC(mt("line-width",this,t),mt("line-gap-width",this,t)),u=mt("line-offset",this,t);return o/2+Math.abs(u)+Tt(this.paint.get("line-translate"))}queryIntersectsFeature(l,t,o,u,m,h){if(l.queryGeometry.isAboveHorizon)return!1;const g=Lt(l.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),h.angle,l.pixelToTileUnitsFactor),b=l.pixelToTileUnitsFactor/2*xC(this.paint.get("line-width").evaluate(t,o),this.paint.get("line-gap-width").evaluate(t,o)),E=this.paint.get("line-offset").evaluate(t,o);return E&&(u=function(A,v){const C=[],I=new wt(0,0);for(let S=0;S<A.length;S++){const M=A[S],R=[];for(let O=0;O<M.length;O++){const F=M[O],H=M[O+1],W=O===0?I:F.sub(M[O-1])._unit()._perp(),V=O===M.length-1?I:H.sub(F)._unit()._perp(),Z=W._add(V)._unit();Z._mult(1/(Z.x*V.x+Z.y*V.y)),R.push(Z._mult(v)._add(F))}C.push(R)}return C}(u,E*l.pixelToTileUnitsFactor)),function(A,v,C){for(let I=0;I<v.length;I++){const S=v[I];if(A.length>=3){for(let M=0;M<S.length;M++)if($e(A,S[M]))return!0}if(be(A,S,C))return!0}return!1}(g,u,b)}isTileClipped(){return!0}isDraped(l){const t=this.layout.get("line-z-offset"),o=t.isConstant()&&!t.constantOr(0),u=this.layout.get("line-elevation-reference");return!(u==="sea"||u==="ground")&&(o||u!=="none")}},symbol:xy,background:class extends Bo{constructor(l,t,o,u){super(l,{layout:i4||(i4=new ti({visibility:new zt(nt.layout_background.visibility)})),paint:o4||(o4=new ti({"background-pitch-alignment":new zt(nt.paint_background["background-pitch-alignment"]),"background-color":new zt(nt.paint_background["background-color"]),"background-pattern":new zt(nt.paint_background["background-pattern"]),"background-opacity":new zt(nt.paint_background["background-opacity"]),"background-emissive-strength":new zt(nt.paint_background["background-emissive-strength"]),"background-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(l,t,o){return{overrideFog:!1}}is3D(){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:u4,"raster-particle":g4,sky:class extends Bo{constructor(l,t,o,u){super(l,{layout:f4||(f4=new ti({visibility:new zt(nt.layout_sky.visibility)})),paint:p4||(p4=new ti({"sky-type":new zt(nt.paint_sky["sky-type"]),"sky-atmosphere-sun":new zt(nt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new zt(nt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new zt(nt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new zt(nt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Zc(nt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new zt(nt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new zt(nt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new zt(nt.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(l){l==="sky-gradient"?this._updateColorRamp():l!=="sky-atmosphere-sun"&&l!=="sky-atmosphere-halo-color"&&l!=="sky-atmosphere-color"&&l!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Om({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(l){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const t=l.style.light.properties.get("position");return this._lightPosition.azimuthal!==t.azimuthal||this._lightPosition.polar!==t.polar}return!1}getCenter(l,t){if(this.paint.get("sky-type")==="atmosphere"){const u=this.paint.get("sky-atmosphere-sun"),m=!u,h=l.style.light,g=h.properties.get("position");return m&&h.properties.get("anchor")==="viewport"&&gr("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),m?$b(g.azimuthal,90-g.polar,t):$b(u[0],90-u[1],t)}const o=this.paint.get("sky-gradient-center");return $b(o[0],90-o[1],t)}isSky(){return!0}markSkyboxValid(l){this._skyboxInvalidated=!1,this._lightPosition=l.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const l=this.paint.get("sky-type");return l==="atmosphere"?["skyboxCapture","skybox"]:l==="gradient"?["skyboxGradient"]:null}},slot:class extends Bo{constructor(l,t,o,u){super(l,{paint:m4||(m4=new ti({}))},t,null)}},model:class extends Bo{constructor(l,t,o,u){super(l,{layout:C4||(C4=new ti({visibility:new zt(nt.layout_model.visibility),"model-id":new Ht(nt.layout_model["model-id"])})),paint:M4||(M4=new ti({"model-opacity":new Ht(nt.paint_model["model-opacity"]),"model-rotation":new Ht(nt.paint_model["model-rotation"]),"model-scale":new Ht(nt.paint_model["model-scale"]),"model-translation":new Ht(nt.paint_model["model-translation"]),"model-color":new Ht(nt.paint_model["model-color"]),"model-color-mix-intensity":new Ht(nt.paint_model["model-color-mix-intensity"]),"model-type":new zt(nt.paint_model["model-type"]),"model-cast-shadows":new zt(nt.paint_model["model-cast-shadows"]),"model-receive-shadows":new zt(nt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new zt(nt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new Ht(nt.paint_model["model-emissive-strength"]),"model-roughness":new Ht(nt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new Ht(nt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new zt(nt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new zt(nt.paint_model["model-front-cutoff"]),"model-color-use-theme":new Ht({type:"string",default:"default","property-type":"data-driven"})}))},t,o,u),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(l){return new Gb(l)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(l){return l instanceof Iy?Nt-1:0}queryIntersectsFeature(l,t,o,u,m,h){if(!this.modelManager)return!1;const g=this.modelManager,b=l.tile.getBucket(this);if(!(b&&b instanceof Gb))return!1;for(const E in b.instancesPerModel){const A=b.instancesPerModel[E],v=t.id!==void 0?t.id:t.properties&&t.properties.hasOwnProperty("id")?t.properties.id:void 0;if(A.idToFeaturesIndex.hasOwnProperty(v)){const C=A.features[A.idToFeaturesIndex[v]],I=g.getModel(E,this.scope);if(!I)return!1;let S=Ae.mat4.create();const M=new rn(0,0),R=b.canonical;let O=Number.MAX_VALUE;for(let F=0;F<C.instancedDataCount;++F){const H=16*(C.instancedDataOffset+F),W=A.instancedDataArray.float32,V=[W[H+4],W[H+5],W[H+6]];L4(R,M,W[H],0|W[H+1]),I4(S,I,h,M,C.rotation,C.scale,V,!1,!1,!1),h.projection.name==="globe"&&(S=Ub(S,h));const Z=Ae.mat4.multiply([],h.projMatrix,S),Y=l.queryGeometry,ne=b4(Y.isPointQuery()?Y.screenBounds:Y.screenGeometry,h,Z,I.aabb);ne!=null&&(O=Math.min(ne,O))}return O!==Number.MAX_VALUE&&O}}return!1}_handleOverridablePaintPropertyUpdate(l,t,o){return!(!this.layout||t.isDataDriven()||o.isDataDriven()||l!=="model-color"&&l!=="model-color-mix-intensity"&&l!=="model-rotation"&&l!=="model-scale"&&l!=="model-translation"&&l!=="model-emissive-strength")}_isPropertyZoomDependent(l){const t=this._transitionablePaint._values[l];return t!=null&&t.value!=null&&t.value.expression!=null&&t.value.expression instanceof Uc}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends Bo{constructor(l,t,o,u){super(l,{layout:CT||(CT=new ti({"clip-layer-types":new zt(nt.layout_clip["clip-layer-types"]),"clip-layer-scope":new zt(nt.layout_clip["clip-layer-scope"])})),paint:MT||(MT=new ti({}))},t,o,u)}recalculate(l,t){super.recalculate(l,t)}createBucket(l){return new IT(l)}isTileClipped(){return!0}is3D(){return!0}}};class lO{constructor(t){this._callback=t,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class cO{constructor(){this.tasks={},this.taskQueue=[],nn(["process"],this),this.invoker=new lO(this.process),this.nextId=0}add(t,o){const u=this.nextId++,m=function({type:h,isSymbolTile:g,zoom:b}){return b=b||0,h==="message"?0:h!=="maybePrepare"||g?h!=="parseTile"||g?h==="parseTile"&&g?300-b:h==="maybePrepare"&&g?400-b:500:200-b:100-b}(o);if(m===0){try{t()}finally{}return null}return this.tasks[u]={fn:t,metadata:o,priority:m,id:u},this.taskQueue.push(u),this.invoker.trigger(),{cancel:()=>{delete this.tasks[u]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(u=>!!this.tasks[u]),!this.taskQueue.length)return;const t=this.pick();if(t===null)return;const o=this.tasks[t];if(delete this.tasks[t],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let t=null,o=1/0;for(let m=0;m<this.taskQueue.length;m++){const h=this.tasks[this.taskQueue[m]];h.priority<o&&(o=h.priority,t=m)}if(t===null)return null;const u=this.taskQueue[t];return this.taskQueue.splice(t,1),u}remove(){this.invoker.remove()}}class k4{constructor(t,o,u){this.target=t,this.parent=o,this.mapId=u,this.callbacks={},this.cancelCallbacks={},nn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new cO}send(t,o,u,m,h=!1,g){const b=Math.round(1e18*Math.random()).toString(36).substring(0,10);u&&(u.metadata=g,this.callbacks[b]=u);const E=new Set;return this.target.postMessage({id:b,type:t,hasCallback:!!u,targetMapId:m,mustQueue:h,sourceMapId:this.mapId,data:ic(o,E)},E),{cancel:()=>{u&&delete this.callbacks[b],this.target.postMessage({id:b,type:"<cancel>",targetMapId:m,sourceMapId:this.mapId})}}}receive(t){const o=t.data,u=o.id;if(u&&(!o.targetMapId||this.mapId===o.targetMapId))if(o.type==="<cancel>"){const m=this.cancelCallbacks[u];delete this.cancelCallbacks[u],m&&m.cancel()}else if(o.mustQueue||Hi()){const m=this.callbacks[u],h=this.scheduler.add(()=>this.processTask(u,o),m&&m.metadata||{type:"message"});h&&(this.cancelCallbacks[u]=h)}else this.processTask(u,o)}processTask(t,o){if(delete this.cancelCallbacks[t],o.type==="<response>"){const u=this.callbacks[t];delete this.callbacks[t],u&&(o.error?u(oc(o.error)):u(null,oc(o.data)))}else{const u=new Set,m=o.hasCallback?(g,b)=>{this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:g?ic(g):null,data:ic(b,u)},u)}:()=>{},h=oc(o.data);if(this.parent[o.type])this.parent[o.type](o.sourceMapId,h,m);else if(this.parent.getWorkerSource){const g=o.type.split(".");this.parent.getWorkerSource(o.sourceMapId,g[0],h.source,h.scope)[g[1]](h,m)}else m(new Error(`Could not find function ${o.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var ig={workerUrl:"",workerClass:null,workerParams:void 0};const Zb="mapboxgl_preloaded_worker_pool";class Ph{constructor(){this.active={}}acquire(t,o=Ph.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<o;)this.workers.push(ig.workerClass!=null?new ig.workerClass:new self.Worker(ig.workerUrl,ig.workerParams));return this.active[t]=!0,this.workers.slice()}release(t){delete this.active[t],this.workers&&this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Zb]}numActive(){return Object.keys(this.active).length}}Ph.workerCount=2;class Sf{constructor(t,o,u="Worker",m=Ph.workerCount){this.workerPool=t,this.actors=[],this.currentActor=0,this.id=Ui();const h=this.workerPool.acquire(this.id,m);for(let g=0;g<h.length;g++){const b=new Sf.Actor(h[g],o,this.id);b.name=`${u} ${g}`,this.actors.push(b)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(t,o,u){Kn(this.actors,(m,h)=>{m.send(t,o,h)},u=u||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(t=>{t.remove()}),this.actors=[],this.workerPool.release(this.id)}}let og,Xb;function Py(){return og||(og=new Ph),og}Sf.Actor=k4;const Yb=new Rr(0,0,0);var Ay=(l=>(l[l.PATH_RULE_UNSPECIFIED=0]="PATH_RULE_UNSPECIFIED",l[l.PATH_RULE_NON_ZERO=1]="PATH_RULE_NON_ZERO",l[l.PATH_RULE_EVEN_ODD=2]="PATH_RULE_EVEN_ODD",l))(Ay||{}),Ry=(l=>(l[l.LINE_CAP_UNSPECIFIED=0]="LINE_CAP_UNSPECIFIED",l[l.LINE_CAP_BUTT=1]="LINE_CAP_BUTT",l[l.LINE_CAP_ROUND=2]="LINE_CAP_ROUND",l[l.LINE_CAP_SQUARE=3]="LINE_CAP_SQUARE",l))(Ry||{}),ag=(l=>(l[l.LINE_JOIN_UNSPECIFIED=0]="LINE_JOIN_UNSPECIFIED",l[l.LINE_JOIN_MITER=1]="LINE_JOIN_MITER",l[l.LINE_JOIN_MITER_CLIP=2]="LINE_JOIN_MITER_CLIP",l[l.LINE_JOIN_ROUND=3]="LINE_JOIN_ROUND",l[l.LINE_JOIN_BEVEL=4]="LINE_JOIN_BEVEL",l))(ag||{}),D4=(l=>(l[l.PAINT_ORDER_UNSPECIFIED=0]="PAINT_ORDER_UNSPECIFIED",l[l.PAINT_ORDER_FILL_AND_STROKE=1]="PAINT_ORDER_FILL_AND_STROKE",l[l.PAINT_ORDER_STROKE_AND_FILL=2]="PAINT_ORDER_STROKE_AND_FILL",l))(D4||{}),Ef=(l=>(l[l.PATH_COMMAND_UNSPECIFIED=0]="PATH_COMMAND_UNSPECIFIED",l[l.PATH_COMMAND_MOVE=1]="PATH_COMMAND_MOVE",l[l.PATH_COMMAND_LINE=2]="PATH_COMMAND_LINE",l[l.PATH_COMMAND_QUAD=3]="PATH_COMMAND_QUAD",l[l.PATH_COMMAND_CUBIC=4]="PATH_COMMAND_CUBIC",l[l.PATH_COMMAND_CLOSE=5]="PATH_COMMAND_CLOSE",l))(Ef||{}),O4=(l=>(l[l.MASK_TYPE_UNSPECIFIED=0]="MASK_TYPE_UNSPECIFIED",l[l.MASK_TYPE_LUMINANCE=1]="MASK_TYPE_LUMINANCE",l[l.MASK_TYPE_ALPHA=2]="MASK_TYPE_ALPHA",l))(O4||{});function uO(l,t,o){l===1&&t.icons.push(function(u,m){return function(h){if(h.usvg_tree.height||(h.usvg_tree.height=h.usvg_tree.width),!h.metadata)return h;const{metadata:g}=h;if(g.content_area){const{content_area:b}=g;b.top==null&&(b.top=b.left),b.width==null&&(b.width=h.usvg_tree.width),b.height==null&&(b.height=b.width)}return g.stretch_x&&g.stretch_x.length&&F4(g,"x"),g.stretch_y&&g.stretch_y.length&&F4(g,"y"),h}(u.readFields(hO,{name:void 0},m))}(o,o.readVarint()+o.pos))}function F4(l,t){const o=[],u=l[`stretch_${t}`];let m=null;for(let h=0;h<u.length;h++)m===null?m=o.length===0?u[0]:o[o.length-1][1]+u[h]:(o.push([m,m+u[h]]),m=null);l[`stretch_${t}_areas`]=o}function hO(l,t,o){l===1?t.name=o.readString():l===2?t.metadata=function(u,m){return u.readFields(dO,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},m)}(o,o.readVarint()+o.pos):l===3&&(t.usvg_tree=function(u,m){return u.readFields(mO,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},m)}(o,o.readVarint()+o.pos),t.data="usvg_tree")}function dO(l,t,o){l===1?t.stretch_x=o.readPackedVarint():l===2?t.stretch_y=o.readPackedVarint():l===3?t.content_area=function(u,m){return u.readFields(fO,{left:0},m)}(o,o.readVarint()+o.pos):l===4&&t.variables.push(function(u,m){return u.readFields(pO,{name:void 0},m)}(o,o.readVarint()+o.pos))}function fO(l,t,o){l===1?t.left=o.readVarint():l===2?t.width=o.readVarint():l===3?t.top=o.readVarint():l===4&&(t.height=o.readVarint())}function pO(l,t,o){l===1?t.name=o.readString():l===2&&(t.rgb_color=ky(o.readVarint()),t.value="rgb_color")}function mO(l,t,o){l===1?t.width=t.height=o.readVarint():l===2?t.height=o.readVarint():l===3?t.children.push(zy(o,o.readVarint()+o.pos)):l===4?t.linear_gradients.push(function(u,m){return u.readFields(wO,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},m)}(o,o.readVarint()+o.pos)):l===5?t.radial_gradients.push(function(u,m){return u.readFields(EO,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},m)}(o,o.readVarint()+o.pos)):l===7?t.clip_paths.push(function(u,m){return u.readFields(TO,{children:[]},m)}(o,o.readVarint()+o.pos)):l===8&&t.masks.push(function(u,m){const h=u.readFields(CO,{left:0,width:20,mask_type:1,children:[]},m);return h.height==null&&(h.height=h.width),h.top==null&&(h.top=h.left),h}(o,o.readVarint()+o.pos))}function zy(l,t){return l.readFields(gO,{},t)}function gO(l,t,o){l===1?(t.group=function(u,m){return u.readFields(_O,{opacity:255,children:[]},m)}(o,o.readVarint()+o.pos),t.node="group"):l===2&&(t.path=function(u,m){return u.readFields(vO,{paint_order:1,commands:[],step:1,diffs:[],rule:1},m)}(o,o.readVarint()+o.pos),t.node="path")}function _O(l,t,o){l===1?t.transform=Ly(o,o.readVarint()+o.pos):l===2?t.opacity=o.readVarint():l===5?t.clip_path_idx=o.readVarint():l===6?t.mask_idx=o.readVarint():l===7&&t.children.push(zy(o,o.readVarint()+o.pos))}function Ly(l,t){return l.readFields(yO,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},t)}function yO(l,t,o){l===1?t.sx=o.readFloat():l===2?t.ky=o.readFloat():l===3?t.kx=o.readFloat():l===4?t.sy=o.readFloat():l===5?t.tx=o.readFloat():l===6&&(t.ty=o.readFloat())}function vO(l,t,o){l===1?t.fill=function(u,m){return u.readFields(xO,{rgb_color:Yb,paint:"rgb_color",opacity:255},m)}(o,o.readVarint()+o.pos):l===2?t.stroke=function(u,m){return u.readFields(bO,{rgb_color:Yb,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},m)}(o,o.readVarint()+o.pos):l===3?t.paint_order=o.readVarint():l===5?o.readPackedVarint(t.commands):l===6?t.step=o.readFloat():l===7?o.readPackedSVarint(t.diffs):l===8&&(t.rule=o.readVarint())}function xO(l,t,o){l===1?(t.rgb_color=ky(o.readVarint()),t.paint="rgb_color"):l===2?(t.linear_gradient_idx=o.readVarint(),t.paint="linear_gradient_idx"):l===3?(t.radial_gradient_idx=o.readVarint(),t.paint="radial_gradient_idx"):l===5&&(t.opacity=o.readVarint())}function ky(l){return new Rr((l>>16&255)/255,(l>>8&255)/255,(255&l)/255,1)}function bO(l,t,o){l===1?(t.rgb_color=ky(o.readVarint()),t.paint="rgb_color"):l===2?(t.linear_gradient_idx=o.readVarint(),t.paint="linear_gradient_idx"):l===3?(t.radial_gradient_idx=o.readVarint(),t.paint="radial_gradient_idx"):l===5?o.readPackedFloat(t.dasharray):l===6?t.dashoffset=o.readFloat():l===7?t.miterlimit=o.readFloat():l===8?t.opacity=o.readVarint():l===9?t.width=o.readFloat():l===10?t.linecap=o.readVarint():l===11&&(t.linejoin=o.readVarint())}function wO(l,t,o){l===1?t.transform=Ly(o,o.readVarint()+o.pos):l===2?t.spread_method=o.readVarint():l===3?t.stops.push(B4(o,o.readVarint()+o.pos)):l===4?t.x1=o.readFloat():l===5?t.y1=o.readFloat():l===6?t.x2=o.readFloat():l===7&&(t.y2=o.readFloat())}function B4(l,t){return l.readFields(SO,{offset:0,opacity:255,rgb_color:Yb},t)}function SO(l,t,o){l===1?t.offset=o.readFloat():l===2?t.opacity=o.readVarint():l===3&&(t.rgb_color=ky(o.readVarint()))}function EO(l,t,o){l===1?t.transform=Ly(o,o.readVarint()+o.pos):l===2?t.spread_method=o.readVarint():l===3?t.stops.push(B4(o,o.readVarint()+o.pos)):l===4?t.cx=o.readFloat():l===5?t.cy=o.readFloat():l===6?t.r=o.readFloat():l===7?t.fx=o.readFloat():l===8?t.fy=o.readFloat():l===9&&(t.fr=o.readFloat())}function TO(l,t,o){l===1?t.transform=Ly(o,o.readVarint()+o.pos):l===2?t.clip_path_idx=o.readVarint():l===3&&t.children.push(zy(o,o.readVarint()+o.pos))}function CO(l,t,o){l===1?t.left=t.top=o.readFloat():l===2?t.width=t.height=o.readFloat():l===3?t.top=o.readFloat():l===4?t.height=o.readFloat():l===5?t.mask_type=o.readVarint():l===6?t.mask_idx=o.readVarint():l===7&&t.children.push(zy(o,o.readVarint()+o.pos))}class MO{static calculate(t,o){const u=new Map,m=new Map;if(Object.keys(t).length===0)return u;o.forEach(h=>{m.set(h.name,h.rgb_color||new Rr(0,0,0))});for(const[h,g]of Object.entries(t))m.has(h)?u.set(m.get(h).toStringPremultipliedAlpha(),g):console.warn(`Ignoring unknown image variable "${h}"`);return u}}function Tf(l,t=255,o){const u=t/255,m=l.toStringPremultipliedAlpha(),h=o.has(m)?o.get(m).clone():l.clone();return h.a=u,h.toString()}function Kb(l,t){if(!ot()){const o=document.createElement("canvas");return o.width=l,o.height=t,o}return new OffscreenCanvas(l,t)}function IO(l,t){const o=MO.calculate(t.params,l.metadata?l.metadata.variables:[]),u=l.usvg_tree,m=u.width,h=u.height,g=t.transform?t.transform:new DOMMatrix,b=Math.max(1,Math.round(m*g.a)),E=Math.max(1,Math.round(h*g.d)),A=new DOMMatrix([b/m,0,0,E/h,0,0]),v=Kb(b,E).getContext("2d");return Jb(v,A,u,u,o),v.getImageData(0,0,b,E)}function Jb(l,t,o,u,m){for(const h of u.children)N4(l,t,o,h,m)}function N4(l,t,o,u,m){u.group?(l.save(),function(h,g,b,E,A){const v=E.mask_idx!=null?b.masks[E.mask_idx]:null,C=E.clip_path_idx!=null?b.clip_paths[E.clip_path_idx]:null;if(E.transform&&(g=sg(E.transform).preMultiplySelf(g)),!function(M,R,O){return M.opacity!==255||R||O}(E,C!=null,v!=null))return void Jb(h,g,b,E,A);const I=Kb(h.canvas.width,h.canvas.height),S=I.getContext("2d");C&&G4(S,g,b,C),Jb(S,g,b,E,A),v&&H4(S,g,b,v,A),h.globalAlpha=E.opacity/255,h.drawImage(I,0,0)}(l,t,o,u.group,m),l.restore()):u.path&&(l.save(),function(h,g,b,E,A){const v=W4(E);h.setTransform(g),E.paint_order===D4.PAINT_ORDER_FILL_AND_STROKE?(j4(h,b,E,v,A),$4(h,b,E,v,A)):($4(h,b,E,v,A),j4(h,b,E,v,A))}(l,t,o,u.path,m),l.restore())}function j4(l,t,o,u,m){const h=o.fill;if(!h)return;const g=h.opacity/255;switch(h.paint){case"rgb_color":l.fillStyle=Tf(h.rgb_color,h.opacity,m);break;case"linear_gradient_idx":l.fillStyle=V4(l,t.linear_gradients[h.linear_gradient_idx],g,m);break;case"radial_gradient_idx":l.fillStyle=U4(l,t.radial_gradients[h.radial_gradient_idx],g,m)}let b;switch(o.rule){case Ay.PATH_RULE_NON_ZERO:b="nonzero";break;case Ay.PATH_RULE_EVEN_ODD:b="evenodd"}l.fill(u,b)}function $4(l,t,o,u,m){const h=o.stroke;if(!h)return;l.lineWidth=h.width,l.miterLimit=h.miterlimit,l.setLineDash(h.dasharray),l.lineDashOffset=h.dashoffset;const g=h.opacity/255;switch(h.paint){case"rgb_color":l.strokeStyle=Tf(h.rgb_color,h.opacity,m);break;case"linear_gradient_idx":l.strokeStyle=V4(l,t.linear_gradients[h.linear_gradient_idx],g,m);break;case"radial_gradient_idx":l.strokeStyle=U4(l,t.radial_gradients[h.radial_gradient_idx],g,m)}switch(h.linejoin){case ag.LINE_JOIN_MITER_CLIP:case ag.LINE_JOIN_MITER:l.lineJoin="miter";break;case ag.LINE_JOIN_ROUND:l.lineJoin="round";break;case ag.LINE_JOIN_BEVEL:l.lineJoin="bevel"}switch(h.linecap){case Ry.LINE_CAP_BUTT:l.lineCap="butt";break;case Ry.LINE_CAP_ROUND:l.lineCap="round";break;case Ry.LINE_CAP_SQUARE:l.lineCap="square"}l.stroke(u)}function V4(l,t,o,u){if(t.stops.length===1){const I=t.stops[0];return Tf(I.rgb_color,I.opacity*o,u)}const m=sg(t.transform),{x1:h,y1:g,x2:b,y2:E}=t,A=m.transformPoint(new DOMPoint(h,g)),v=m.transformPoint(new DOMPoint(b,E)),C=l.createLinearGradient(A.x,A.y,v.x,v.y);for(const I of t.stops)C.addColorStop(I.offset,Tf(I.rgb_color,I.opacity*o,u));return C}function U4(l,t,o,u){if(t.stops.length===1){const I=t.stops[0];return Tf(I.rgb_color,I.opacity*o,u)}const m=sg(t.transform),{fx:h,fy:g,cx:b,cy:E}=t,A=m.transformPoint(new DOMPoint(h,g)),v=m.transformPoint(new DOMPoint(b,E)),C=l.createRadialGradient(A.x,A.y,0,v.x,v.y,t.r*((m.a+m.d)/2));for(const I of t.stops)C.addColorStop(I.offset,Tf(I.rgb_color,I.opacity*o,u));return C}function G4(l,t,o,u){const m=sg(u.transform).preMultiplySelf(t),h=u.clip_path_idx!=null?o.clip_paths[u.clip_path_idx]:null;h&&G4(l,m,o,h);const g=new Path2D;let b;function E(A,v){if(A.path){const C=A.path;g.addPath(W4(C),v),C.rule===Ay.PATH_RULE_EVEN_ODD&&(b="evenodd")}else if(A.group){const C=A.group.transform?sg(A.group.transform).preMultiplySelf(v):v;for(const I of A.group.children)E(I,C)}}for(const A of u.children)E(A,m);l.clip(g,b)}function H4(l,t,o,u,m){if(u.children.length===0)return;const h=u.mask_idx!=null?o.masks[u.mask_idx]:null;h&&H4(l,t,o,h,m);const g=l.canvas.width,b=l.canvas.height,E=Kb(g,b),A=E.getContext("2d"),v=u.width,C=u.height,I=u.left,S=u.top,M=new Path2D,R=new Path2D;R.rect(I,S,v,C),M.addPath(R,t),A.clip(M);for(const H of u.children)N4(A,t,o,H,m);const O=A.getImageData(0,0,g,b),F=O.data;if(u.mask_type===O4.MASK_TYPE_LUMINANCE)for(let H=0;H<F.length;H+=4)F[H+3]=F[H+3]/255*(.2126*F[H]+.7152*F[H+1]+.0722*F[H+2]);A.putImageData(O,0,0),l.globalCompositeOperation="destination-in",l.drawImage(E,0,0)}function sg(l){return l?new DOMMatrix([l.sx,l.ky,l.kx,l.sy,l.tx,l.ty]):new DOMMatrix}function W4(l){const t=new Path2D,o=l.step;let u=l.diffs[0]*o,m=l.diffs[1]*o;t.moveTo(u,m);for(let h=0,g=2;h<l.commands.length;h++)switch(l.commands[h]){case Ef.PATH_COMMAND_MOVE:u+=l.diffs[g++]*o,m+=l.diffs[g++]*o,t.moveTo(u,m);break;case Ef.PATH_COMMAND_LINE:u+=l.diffs[g++]*o,m+=l.diffs[g++]*o,t.lineTo(u,m);break;case Ef.PATH_COMMAND_QUAD:{const b=u+l.diffs[g++]*o,E=m+l.diffs[g++]*o;u=b+l.diffs[g++]*o,m=E+l.diffs[g++]*o,t.quadraticCurveTo(b,E,u,m);break}case Ef.PATH_COMMAND_CUBIC:{const b=u+l.diffs[g++]*o,E=m+l.diffs[g++]*o,A=b+l.diffs[g++]*o,v=E+l.diffs[g++]*o;u=A+l.diffs[g++]*o,m=v+l.diffs[g++]*o,t.bezierCurveTo(b,E,A,v,u,m);break}case Ef.PATH_COMMAND_CLOSE:t.closePath()}return t}class Qb{constructor(t){this.capacity=t,this.cache=new Map}get(t){if(!this.cache.has(t))return;const o=this.cache.get(t);return this.cache.delete(t),this.cache.set(t,o),o}put(t,o){this.cache.has(t)?this.cache.delete(t):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(t,o)}delete(t){this.cache.delete(t)}}class ew{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(t){return new So(t,t.data)}getFromCache(t,o,u){return this.cacheMap.has(u)||this.cacheMap.set(u,new Qb(150)),this.cacheMap.get(u).get(Fo(t.serialize(),o))}setInCache(t,o,u,m){this.cacheDependenciesMap.has(m)||this.cacheDependenciesMap.set(m,new Map),this.cacheMap.has(m)||this.cacheMap.set(m,new Qb(150));const h=this.cacheDependenciesMap.get(m);h.get(Fo(t.id,u))||h.set(Fo(t.id,u),new Set);const g=this.cacheMap.get(m),b=t.serialize();h.get(Fo(t.id,u)).add(b),g.put(Fo(t.serialize(),u),o)}removeImagesFromCacheByIds(t,o,u=""){if(!this.cacheMap.has(u)||!this.cacheDependenciesMap.has(u))return;const m=this.cacheMap.get(u),h=this.cacheDependenciesMap.get(u);for(const g of t)if(h.has(Fo(g,o))){for(const b of h.get(Fo(g,o)))m.delete(b);h.delete(Fo(g,o))}}rasterize(t,o,u,m,h=IO){const g=this.getFromCache(t,u,m);if(g)return g.clone();const b=h(o.icon,t.options),E=ew._getImage(b);return this.setInCache(t,E,u,m),E.clone()}}class q4{constructor(t){this.size=t,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(t,o){const u=this.toIdx(t,o);return{min:this.minimums[u],max:this.maximums[u]}}isLeaf(t,o){return this.leaves[this.toIdx(t,o)]}toIdx(t,o){return o*this.size+t}}function Z4(l,t,o,u){let m=0,h=Number.MAX_VALUE;for(let g=0;g<3;g++)if(Math.abs(u[g])<1e-15){if(o[g]<l[g]||o[g]>t[g])return null}else{const b=1/u[g];let E=(l[g]-o[g])*b,A=(t[g]-o[g])*b;if(E>A){const v=E;E=A,A=v}if(E>m&&(m=E),A<h&&(h=A),m>h)return null}return m}function X4(l,t,o,u,m,h,g,b,E,A,v){const C=u-l,I=m-t,S=h-o,M=g-l,R=b-t,O=E-o,F=v[1]*O-v[2]*R,H=v[2]*M-v[0]*O,W=v[0]*R-v[1]*M,V=C*F+I*H+S*W;if(Math.abs(V)<1e-15)return null;const Z=1/V,Y=A[0]-l,ne=A[1]-t,ye=A[2]-o,_e=(Y*F+ne*H+ye*W)*Z;if(_e<0||_e>1)return null;const ge=ne*S-ye*I,Re=ye*C-Y*S,we=Y*I-ne*C,Le=(v[0]*ge+v[1]*Re+v[2]*we)*Z;return Le<0||_e+Le>1?null:(M*ge+R*Re+O*we)*Z}function Y4(l,t,o){return(l-t)/(o-t)}function K4(l,t,o,u,m,h,g,b,E){const A=1<<o,v=h-u,C=g-m,I=(l+1)/A*v+u,S=(t+0)/A*C+m,M=(t+1)/A*C+m;b[0]=(l+0)/A*v+u,b[1]=S,E[0]=I,E[1]=M}class J4{constructor(t){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=t,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(h){const g=Math.ceil(Math.log2(h.dim/8)),b=[];let E=Math.ceil(Math.pow(2,g));const A=1/E,v=(S,M,R,O,F)=>{const H=O?1:0,W=(S+1)*R-H,V=M*R,Z=(M+1)*R-H;F[0]=S*R,F[1]=V,F[2]=W,F[3]=Z};let C=new q4(E);const I=[];for(let S=0;S<E*E;S++){v(S%E,Math.floor(S/E),A,!1,I);const M=uu(I[0],I[1],h),R=uu(I[2],I[1],h),O=uu(I[2],I[3],h),F=uu(I[0],I[3],h);C.minimums.push(Math.min(M,R,O,F)),C.maximums.push(Math.max(M,R,O,F)),C.leaves.push(1)}for(b.push(C),E/=2;E>=1;E/=2){const S=b[b.length-1];C=new q4(E);for(let M=0;M<E*E;M++){v(M%E,Math.floor(M/E),2,!0,I);const R=S.getElevation(I[0],I[1]),O=S.getElevation(I[2],I[1]),F=S.getElevation(I[2],I[3]),H=S.getElevation(I[0],I[3]),W=S.isLeaf(I[0],I[1]),V=S.isLeaf(I[2],I[1]),Z=S.isLeaf(I[2],I[3]),Y=S.isLeaf(I[0],I[3]),ne=Math.min(R.min,O.min,F.min,H.min),ye=Math.max(R.max,O.max,F.max,H.max),_e=W&&V&&Z&&Y;C.maximums.push(ye),C.minimums.push(ne),C.leaves.push(ye-ne<=5&&_e?1:0)}b.push(C)}return b}(this.dem),u=o.length-1,m=o[u];this._addNode(m.minimums[0],m.maximums[0],m.leaves[0]),this._construct(o,0,0,u,0)}raycastRoot(t,o,u,m,h,g,b=1){return Z4([t,o,-100],[u,m,this.maximums[0]*b],h,g)}raycast(t,o,u,m,h,g,b=1){if(!this.nodeCount)return null;const E=this.raycastRoot(t,o,u,m,h,g,b);if(E==null)return null;const A=[],v=[],C=[],I=[],S=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;S.length>0;){const{idx:M,t:R,nodex:O,nodey:F,depth:H}=S.pop();if(this.leaves[M]){K4(O,F,H,t,o,u,m,C,I);const V=1<<H,Z=(O+0)/V,Y=(O+1)/V,ne=(F+0)/V,ye=(F+1)/V,_e=uu(Z,ne,this.dem)*b,ge=uu(Y,ne,this.dem)*b,Re=uu(Y,ye,this.dem)*b,we=uu(Z,ye,this.dem)*b,Le=X4(C[0],C[1],_e,I[0],C[1],ge,I[0],I[1],Re,h,g),Be=X4(I[0],I[1],Re,C[0],I[1],we,C[0],C[1],_e,h,g),Oe=Math.min(Le!==null?Le:Number.MAX_VALUE,Be!==null?Be:Number.MAX_VALUE);if(Oe!==Number.MAX_VALUE)return Oe;{const Ve=Ae.vec3.scaleAndAdd([],h,g,R);if(Q4(_e,ge,we,Re,Y4(Ve[0],C[0],I[0]),Y4(Ve[1],C[1],I[1]))>=Ve[2])return R}continue}let W=0;for(let V=0;V<this._siblingOffset.length;V++){K4((O<<1)+this._siblingOffset[V][0],(F<<1)+this._siblingOffset[V][1],H+1,t,o,u,m,C,I),C[2]=-100,I[2]=this.maximums[this.childOffsets[M]+V]*b;const Z=Z4(C,I,h,g);if(Z!=null){const Y=Z;A[V]=Y;let ne=!1;for(let ye=0;ye<W&&!ne;ye++)Y>=A[v[ye]]&&(v.splice(ye,0,V),ne=!0);ne||(v[W]=V),W++}}for(let V=0;V<W;V++){const Z=v[V];S.push({idx:this.childOffsets[M]+Z,t:A[Z],nodex:(O<<1)+this._siblingOffset[Z][0],nodey:(F<<1)+this._siblingOffset[Z][1],depth:H+1})}}return null}_addNode(t,o,u){return this.minimums.push(t),this.maximums.push(o),this.leaves.push(u),this.childOffsets.push(0),this.nodeCount++}_construct(t,o,u,m,h){if(t[m].isLeaf(o,u)===1)return;this.childOffsets[h]||(this.childOffsets[h]=this.nodeCount);const g=m-1,b=t[g];let E=0,A=0;for(let v=0;v<this._siblingOffset.length;v++){const C=2*o+this._siblingOffset[v][0],I=2*u+this._siblingOffset[v][1],S=b.getElevation(C,I),M=b.isLeaf(C,I),R=this._addNode(S.min,S.max,M);M&&(E|=1<<v),A||(A=R)}for(let v=0;v<this._siblingOffset.length;v++)E&1<<v||this._construct(t,2*o+this._siblingOffset[v][0],2*u+this._siblingOffset[v][1],g,A+v)}}function Q4(l,t,o,u,m,h){return ur(ur(l,o,h),ur(t,u,h),m)}function uu(l,t,o){const u=o.dim,m=Jt(l*u-.5,0,u-1),h=Jt(t*u-.5,0,u-1),g=Math.floor(m),b=Math.floor(h),E=Math.min(g+1,u-1),A=Math.min(b+1,u-1);return Q4(o.get(g,b),o.get(E,b),o.get(g,A),o.get(E,A),m-g,h-b)}const PO={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function AO(l,t,o){return(256*l*256+256*t+o)/10-1e4}function RO(l,t,o){return 256*l+t+o/256-32768}class Dy{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(t,o,u,m=!1){if(this.uid=t,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(u&&u!=="mapbox"&&u!=="terrarium")return void gr(`"${u}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const h=this.dim=o.height-2,g=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.floatView=new Float32Array(o.data.buffer),this.borderReady=m,this._modifiedForSources={},!m){for(let E=0;E<h;E++)g[this._idx(-1,E)]=g[this._idx(0,E)],g[this._idx(h,E)]=g[this._idx(h-1,E)],g[this._idx(E,-1)]=g[this._idx(E,0)],g[this._idx(E,h)]=g[this._idx(E,h-1)];g[this._idx(-1,-1)]=g[this._idx(0,0)],g[this._idx(h,-1)]=g[this._idx(h-1,0)],g[this._idx(-1,h)]=g[this._idx(0,h-1)],g[this._idx(h,h)]=g[this._idx(h-1,h-1)]}const b=u==="terrarium"?RO:AO;for(let E=0;E<g.length;++E){const A=4*E;this.floatView[E]=b(this.pixels[A],this.pixels[A+1],this.pixels[A+2])}this._timestamp=pt.now()}_buildQuadTree(){this._tree=new J4(this)}get(t,o,u=!1){u&&(t=Jt(t,-1,this.dim),o=Jt(o,-1,this.dim));const m=this._idx(t,o);return this.floatView[m]}set(t,o,u){const m=this._idx(t,o),h=this.floatView[m];return this.floatView[m]=u,u-h}static getUnpackVector(t){return PO[t]}_idx(t,o){if(t<-1||t>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(t+1)}static pack(t,o){const u=[0,0,0,0],m=Dy.getUnpackVector(o);let h=Math.floor((t+m[3])/m[2]);return u[2]=h%256,h=Math.floor(h/256),u[1]=h%256,h=Math.floor(h/256),u[0]=h,u}getPixels(){return new yT({width:this.stride,height:this.stride},this.pixels)}backfillBorder(t,o,u){if(this.dim!==t.dim)throw new Error("dem dimension mismatch");let m=o*this.dim,h=o*this.dim+this.dim,g=u*this.dim,b=u*this.dim+this.dim;switch(o){case-1:m=h-1;break;case 1:h=m+1}switch(u){case-1:g=b-1;break;case 1:b=g+1}const E=-o*this.dim,A=-u*this.dim;for(let v=g;v<b;v++)for(let C=m;C<h;C++){const I=4*this._idx(C,v),S=4*this._idx(C+E,v+A);this.pixels[I+0]=t.pixels[S+0],this.pixels[I+1]=t.pixels[S+1],this.pixels[I+2]=t.pixels[S+2],this.pixels[I+3]=t.pixels[S+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function zO(l,t,o){l===1?t.headerLength=o.readFixed32():l===2?t.x=o.readVarint():l===3?t.y=o.readVarint():l===4?t.z=o.readVarint():l===5&&t.layers.push(function(u,m){return u.readFields(FO,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},m)}(o,o.readVarint()+o.pos))}function LO(l,t,o){l===1?(t.delta_filter=function(u,m){return u.readFields(kO,{blockSize:0},m)}(o,o.readVarint()+o.pos),t.filter="delta_filter"):l===2?(o.readVarint(),t.filter="zigzag_filter"):l===3?(o.readVarint(),t.filter="bitshuffle_filter"):l===4&&(o.readVarint(),t.filter="byteshuffle_filter")}function kO(l,t,o){l===1&&(t.blockSize=o.readVarint())}function DO(l,t,o){l===1?(o.readVarint(),t.codec="gzip_data"):l===2?(o.readVarint(),t.codec="jpeg_image"):l===3?(o.readVarint(),t.codec="webp_image"):l===4&&(o.readVarint(),t.codec="png_image")}function OO(l,t,o){let u=0,m=0;l===1?t.firstByte=o.readFixed64():l===2?t.lastByte=o.readFixed64():l===3?t.filters.push(function(h,g){return h.readFields(LO,{},g)}(o,o.readVarint()+o.pos)):l===4?t.codec=function(h,g){return h.readFields(DO,{},g)}(o,o.readVarint()+o.pos):l===5?m=o.readFloat():l===6?u=o.readFloat():l===7?t.bands.push(o.readString()):l===8?t.offset=o.readDouble():l===9&&(t.scale=o.readDouble()),t.offset===0&&(t.offset=m),t.scale===0&&(t.scale=u)}function FO(l,t,o){l===1?t.version=o.readVarint():l===2?t.name=o.readString():l===3?t.units=o.readString():l===4?t.tileSize=o.readVarint():l===5?t.buffer=o.readVarint():l===6?t.pixelFormat=o.readVarint():l===7&&t.dataIndex.push(function(u,m){return u.readFields(OO,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},m)}(o,o.readVarint()+o.pos))}function BO(l,t,o){if(l===2)(function(u,m,h){u.readFields(NO,h,m)})(o,o.readVarint()+o.pos,t);else if(l===3)throw new Error("Not implemented")}function NO(l,t,o){if(l===1){let u=0;const m=o.readVarint()+o.pos;for(;o.pos<m;)t[u++]=o.readVarint()}}function jO(l,t){if(t.length!==4)throw new Error(`Expected data of dimension 4 but got ${t.length}.`);let o=t[3];for(let u=2;u>=1;u--){const m=u===1?1:0,h=u===2?1:0;for(let g=0;g<t[0];g++){const b=t[1]*g;for(let E=m;E<t[1];E++){const A=t[2]*(E+b);for(let v=h;v<t[2];v++){const C=t[3]*(v+A);for(let I=0;I<t[3];I++){const S=C+I;l[S]+=l[S-o]}}}}o*=t[u]}return l}function $O(l){for(let t=0,o=l.length;t<o;t++)l[t]=l[t]>>>1^-(1&l[t]);return l}function VO(l,t){switch(t){case"uint32":return l;case"uint16":for(let o=0;o<l.length;o+=2){const u=l[o],m=l[o+1];l[o]=(240&u)>>4|(61440&u)>>8|(240&m)<<4|61440&m,l[o+1]=15&u|(3840&u)>>4|(15&m)<<8|(3840&m)<<4}return l;case"uint8":for(let o=0;o<l.length;o+=4){const u=l[o],m=l[o+1],h=l[o+2],g=l[o+3];l[o+0]=(192&u)>>6|(192&m)>>4|(192&h)>>2|192&g,l[o+1]=(48&u)>>4|(48&m)>>2|48&h|(48&g)<<2,l[o+2]=(12&u)>>2|12&m|(12&h)<<2|(12&g)<<4,l[o+3]=3&u|(3&m)<<2|(3&h)<<4|(3&g)<<6}return l;default:throw new Error(`Invalid pixel format, "${t}"`)}}Yt(Dy,"DEMData"),Yt(J4,"DemMinMaxQuadTree",{omit:["dem"]});var Ua=Uint8Array,lg=Uint16Array,UO=Int32Array,eM=new Ua([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),tM=new Ua([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),GO=new Ua([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),rM=function(l,t){for(var o=new lg(31),u=0;u<31;++u)o[u]=t+=1<<l[u-1];var m=new UO(o[30]);for(u=1;u<30;++u)for(var h=o[u];h<o[u+1];++h)m[h]=h-o[u]<<5|u;return{b:o,r:m}},nM=rM(eM,2),iM=nM.b,HO=nM.r;iM[28]=258,HO[258]=28;for(var WO=rM(tM,0).b,oM=new lg(32768),Ei=0;Ei<32768;++Ei){var Cf=(43690&Ei)>>1|(21845&Ei)<<1;oM[Ei]=((65280&(Cf=(61680&(Cf=(52428&Cf)>>2|(13107&Cf)<<2))>>4|(3855&Cf)<<4))>>8|(255&Cf)<<8)>>1}var cg=function(l,t,o){for(var u=l.length,m=0,h=new lg(t);m<u;++m)l[m]&&++h[l[m]-1];var g,b=new lg(t);for(m=1;m<t;++m)b[m]=b[m-1]+h[m-1]<<1;g=new lg(1<<t);var E=15-t;for(m=0;m<u;++m)if(l[m])for(var A=m<<4|l[m],v=t-l[m],C=b[l[m]-1]++<<v,I=C|(1<<v)-1;C<=I;++C)g[oM[C]>>E]=A;return g},ug=new Ua(288);for(Ei=0;Ei<144;++Ei)ug[Ei]=8;for(Ei=144;Ei<256;++Ei)ug[Ei]=9;for(Ei=256;Ei<280;++Ei)ug[Ei]=7;for(Ei=280;Ei<288;++Ei)ug[Ei]=8;var aM=new Ua(32);for(Ei=0;Ei<32;++Ei)aM[Ei]=5;var qO=cg(ug,9),ZO=cg(aM,5),tw=function(l){for(var t=l[0],o=1;o<l.length;++o)l[o]>t&&(t=l[o]);return t},Ys=function(l,t,o){var u=t/8|0;return(l[u]|l[u+1]<<8)>>(7&t)&o},rw=function(l,t){var o=t/8|0;return(l[o]|l[o+1]<<8|l[o+2]<<16)>>(7&t)},XO=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Ks=function(l,t,o){var u=new Error(t||XO[l]);if(u.code=l,Error.captureStackTrace&&Error.captureStackTrace(u,Ks),!o)throw u;return u},YO=new Ua(0),KO=typeof TextDecoder<"u"&&new TextDecoder;try{KO.decode(YO,{stream:!0})}catch{}const JO={gzip_data:"gzip"};class ds extends Error{constructor(t){super(t),this.name="MRTError"}}const QO={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},sM={uint32:1,uint16:2,uint8:4},eF={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let nw;class iw{constructor(t=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=t}getLayer(t){const o=this.layers[t];if(!o)throw new ds(`Layer '${t}' not found`);return o}getHeaderLength(t){const o=new Uint8Array(t),u=new DataView(t);if(o[0]!==13)throw new ds("File is not a valid MRT.");return u.getUint32(1,!0)}parseHeader(t){const o=new Uint8Array(t),u=this.getHeaderLength(t);if(o.length<u)throw new ds(`Expected header with length >= ${u} but got buffer of length ${o.length}`);const m=function(h,g){return h.readFields(zO,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new nw(o.subarray(0,u)));if(!isNaN(this.x)&&(this.x!==m.x||this.y!==m.y||this.z!==m.z))throw new ds(`Invalid attempt to parse header ${m.z}/${m.x}/${m.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=m.x,this.y=m.y,this.z=m.z;for(const h of m.layers)this.layers[h.name]=new tF(h,{cacheSize:this._cacheSize});return this}createDecodingTask(t){const o=[],u=this.getLayer(t.layerName);for(let m of t.blockIndices){const h=u.dataIndex[m],g=h.firstByte-t.firstByte,b=h.lastByte-t.firstByte;if(u._blocksInProgress.has(m))continue;const E={layerName:u.name,firstByte:g,lastByte:b,pixelFormat:u.pixelFormat,blockIndex:m,blockShape:[h.bands.length].concat(u.bandShape),buffer:u.buffer,codec:h.codec.codec,filters:h.filters.map(A=>A.filter)};u._blocksInProgress.add(m),o.push(E)}return new lM(o,()=>{o.forEach(m=>u._blocksInProgress.delete(m.blockIndex))},(m,h)=>{if(o.forEach(g=>u._blocksInProgress.delete(g.blockIndex)),m)throw m;h.forEach(g=>{this.getLayer(g.layerName).processDecodedData(g)})})}}class tF{constructor({version:t,name:o,units:u,tileSize:m,pixelFormat:h,buffer:g,dataIndex:b},E){if(this.version=t,this.version!==1)throw new ds(`Cannot parse raster layer encoded with MRT version ${t}`);this.name=o,this.units=u,this.tileSize=m,this.buffer=g,this.pixelFormat=QO[h],this.dataIndex=b,this.bandShape=[m+2*g,m+2*g,sM[this.pixelFormat]],this._decodedBlocks=new Qb(E?E.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return sM[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:t})=>t).flat()}processDecodedData(t){const o=t.blockIndex.toString();this._decodedBlocks.get(o)||this._decodedBlocks.put(o,t.data)}getBlockForBand(t){let o=0;switch(typeof t){case"string":for(const[u,m]of this.dataIndex.entries()){for(const[h,g]of m.bands.entries())if(g===t)return{bandIndex:o+h,blockIndex:u,blockBandIndex:h};o+=m.bands.length}break;case"number":for(const[u,m]of this.dataIndex.entries()){if(t>=o&&t<o+m.bands.length)return{bandIndex:t,blockIndex:u,blockBandIndex:t-o};o+=m.bands.length}break;default:throw new ds(`Invalid band \`${JSON.stringify(t)}\`. Expected string or integer.`)}throw new ds(`Band not found: ${JSON.stringify(t)}`)}getDataRange(t){let o=1/0,u=-1/0;const m=[],h=new Set;for(const g of t){const{blockIndex:b}=this.getBlockForBand(g);if(b<0)throw new ds(`Invalid band: ${JSON.stringify(g)}`);const E=this.dataIndex[b];m.includes(b)||m.push(b),h.add(b),o=Math.min(o,E.firstByte),u=Math.max(u,E.lastByte)}if(h.size>this.cacheSize)throw new ds(`Number of blocks to decode (${h.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:o,lastByte:u,blockIndices:m}}hasBand(t){const{blockIndex:o}=this.getBlockForBand(t);return o>=0}hasDataForBand(t){const{blockIndex:o}=this.getBlockForBand(t);return o>=0&&!!this._decodedBlocks.get(o.toString())}getBandView(t){const{blockIndex:o,blockBandIndex:u}=this.getBlockForBand(t),m=this._decodedBlocks.get(o.toString());if(!m)throw new ds(`Data for band ${JSON.stringify(t)} of layer "${this.name}" not decoded.`);const h=this.dataIndex[o],g=this.bandShape.reduce((A,v)=>A*v,1),b=u*g,E=m.subarray(b,b+g);return{data:E,bytes:new Uint8Array(E.buffer).subarray(E.byteOffset,E.byteOffset+E.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:h.offset,scale:h.scale}}}iw.setPbf=function(l){nw=l};class lM{constructor(t,o,u){this.tasks=t,this._onCancel=o,this._onComplete=u,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(t,o){this._finalized||(this._onComplete(t,o),this._finalized=!0)}}iw.performDecoding=function(l,t){const o=new Uint8Array(l);return Promise.all(t.tasks.map(u=>{const{layerName:m,firstByte:h,lastByte:g,pixelFormat:b,blockShape:E,blockIndex:A,filters:v,codec:C}=u,I=o.subarray(h,g+1),S=new Uint32Array(E[0]*E[1]*E[2]);let M;if(C!=="gzip_data")throw new ds(`Unhandled codec: ${C}`);return M=function(R,O){if(!globalThis.DecompressionStream&&O==="gzip_data")return Promise.resolve(((V=function(ne){ne[0]==31&&ne[1]==139&&ne[2]==8||Ks(6,"invalid gzip data");var ye=ne[3],_e=10;4&ye&&(_e+=2+(ne[10]|ne[11]<<8));for(var ge=(ye>>3&1)+(ye>>4&1);ge>0;ge-=!ne[_e++]);return _e+(2&ye)}(W=R))+8>W.length&&Ks(6,"invalid gzip data"),function(ne,ye,_e,ge){var Re=ne.length;if(!Re||ye.f&&!ye.l)return _e||new Ua(0);var we=!_e,Le=we||ye.i!=2,Be=ye.i;we&&(_e=new Ua(3*Re));var Oe,Ve,We=function(pc){var fu=_e.length;if(pc>fu){var pu=new Ua(Math.max(2*fu,pc));pu.set(_e),_e=pu}},Qe=ye.f||0,Ge=ye.p||0,ut=ye.b||0,It=ye.l,dt=ye.d,Dt=ye.m,kt=ye.n,$t=8*Re;do{if(!It){Qe=Ys(ne,Ge,1);var _t=Ys(ne,Ge+1,3);if(Ge+=3,!_t){var er=ne[(Tr=4+((Ge+7)/8|0))-4]|ne[Tr-3]<<8,Ot=Tr+er;if(Ot>Re){Be&&Ks(0);break}Le&&We(ut+er),_e.set(ne.subarray(Tr,Ot),ut),ye.b=ut+=er,ye.p=Ge=8*Ot,ye.f=Qe;continue}if(_t==1)It=qO,dt=ZO,Dt=9,kt=5;else if(_t==2){var Kt=Ys(ne,Ge,31)+257,hr=Ys(ne,Ge+10,15)+4,Ar=Kt+Ys(ne,Ge+5,31)+1;Ge+=14;for(var kr=new Ua(Ar),jr=new Ua(19),Dr=0;Dr<hr;++Dr)jr[GO[Dr]]=Ys(ne,Ge+3*Dr,7);Ge+=3*hr;var Zr=tw(jr),Cn=(1<<Zr)-1,vn=cg(jr,Zr);for(Dr=0;Dr<Ar;){var Tr,xn=vn[Ys(ne,Ge,Cn)];if(Ge+=15&xn,(Tr=xn>>4)<16)kr[Dr++]=Tr;else{var mn=0,Mn=0;for(Tr==16?(Mn=3+Ys(ne,Ge,3),Ge+=2,mn=kr[Dr-1]):Tr==17?(Mn=3+Ys(ne,Ge,7),Ge+=3):Tr==18&&(Mn=11+Ys(ne,Ge,127),Ge+=7);Mn--;)kr[Dr++]=mn}}var Ti=kr.subarray(0,Kt),Ci=kr.subarray(Kt);Dt=tw(Ti),kt=tw(Ci),It=cg(Ti,Dt),dt=cg(Ci,kt)}else Ks(1);if(Ge>$t){Be&&Ks(0);break}}Le&&We(ut+131072);for(var gi=(1<<Dt)-1,na=(1<<kt)-1,Wn=Ge;;Wn=Ge){var Xn=(mn=It[rw(ne,Ge)&gi])>>4;if((Ge+=15&mn)>$t){Be&&Ks(0);break}if(mn||Ks(2),Xn<256)_e[ut++]=Xn;else{if(Xn==256){Wn=Ge,It=null;break}var jo=Xn-254;Xn>264&&(jo=Ys(ne,Ge,(1<<(Fi=eM[Dr=Xn-257]))-1)+iM[Dr],Ge+=Fi);var Mi=dt[rw(ne,Ge)&na],ha=Mi>>4;if(Mi||Ks(3),Ge+=15&Mi,Ci=WO[ha],ha>3){var Fi=tM[ha];Ci+=rw(ne,Ge)&(1<<Fi)-1,Ge+=Fi}if(Ge>$t){Be&&Ks(0);break}Le&&We(ut+131072);var zl=ut+jo;if(ut<Ci){var hu=0-Ci,du=Math.min(Ci,zl);for(hu+ut<0&&Ks(3);ut<du;++ut)_e[ut]=(void 0)[hu+ut]}for(;ut<zl;++ut)_e[ut]=_e[ut-Ci]}}ye.l=It,ye.p=Wn,ye.b=ut,ye.f=Qe,It&&(Qe=1,ye.m=Dt,ye.d=dt,ye.n=kt)}while(!Qe);return ut!=_e.length&&we?(Oe=_e,((Ve=ut)==null||Ve>Oe.length)&&(Ve=Oe.length),new Ua(Oe.subarray(0,Ve))):_e.subarray(0,ut)}(W.subarray(V,-8),{i:2},new Ua(((F=W)[(H=F.length)-4]|F[H-3]<<8|F[H-2]<<16|F[H-1]<<24)>>>0))));var F,H,W,V;const Z=JO[O];if(!Z)throw new Error(`Unhandled codec: ${O}`);const Y=new globalThis.DecompressionStream(Z);return new Response(new Blob([R]).stream().pipeThrough(Y)).arrayBuffer().then(ne=>new Uint8Array(ne))}(I,C).then(R=>(function(O,F){O.readFields(BO,F)}(new nw(R),S),new eF[b](S.buffer))),M.then(R=>{for(let O=v.length-1;O>=0;O--)switch(v[O]){case"delta_filter":jO(R,E);break;case"zigzag_filter":$O(R);break;case"bitshuffle_filter":VO(R,b);break;default:throw new ds(`Unhandled filter "${v[O]}"`)}return{layerName:m,blockIndex:A,data:R}}).catch(R=>{throw R})}))},Yt(lM,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]});let hg,ow,Js,Mf,aw,If=null;function cM(){return Hi()&&self.worker&&self.worker.dracoUrl?self.worker.dracoUrl:ow||K.DRACO_URL}function uM(){if(Hi()&&self.worker&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Mf)return Mf;const l=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Mf=WebAssembly.validate(l)?K.MESHOPT_SIMD_URL:K.MESHOPT_URL,Mf}const Oy={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},rF={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},dg={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function hM(l,t,o){const u=o.json.bufferViews.length,m=o.buffers.length;t.bufferView=u,o.json.bufferViews[u]={buffer:m,byteLength:l.byteLength},o.buffers[m]=l}const sw="KHR_draco_mesh_compression";function nF(l,t){const o=l.extensions&&l.extensions[sw];if(!o)return;const u=new Js.Decoder,m=mM(t,o.bufferView),h=new Js.Mesh;if(!u.DecodeArrayToMesh(m,m.byteLength,h))throw new Error("Failed to decode Draco mesh");const g=t.json.accessors[l.indices],b=Oy[g.componentType],E=g.count*b.BYTES_PER_ELEMENT,A=Js._malloc(E);b===Uint16Array?u.GetTrianglesUInt16Array(h,E,A):u.GetTrianglesUInt32Array(h,E,A),hM(Js.memory.buffer.slice(A,A+E),g,t),Js._free(A);for(const v of Object.keys(o.attributes)){const C=u.GetAttributeByUniqueId(h,o.attributes[v]),I=t.json.accessors[l.attributes[v]],S=rF[I.componentType],M=I.count*dg[I.type]*Oy[I.componentType].BYTES_PER_ELEMENT,R=Js._malloc(M);u.GetAttributeDataArrayForAllPoints(h,C,Js[S],M,R),hM(Js.memory.buffer.slice(R,R+M),I,t),Js._free(R)}u.destroy(),h.destroy(),delete l.extensions[sw]}const Fy="EXT_meshopt_compression";function iF(l,t){if(!l.extensions||!l.extensions[Fy])return;const o=l.extensions[Fy],u=new Uint8Array(t.buffers[o.buffer],o.byteOffset||0,o.byteLength||0),m=new Uint8Array(o.count*o.byteStride);aw.decodeGltfBuffer(m,o.count,o.byteStride,u,o.mode,o.filter),l.buffer=t.buffers.length,l.byteOffset=0,t.buffers[l.buffer]=m.buffer,delete l.extensions[Fy]}const dM=1179937895,fM=new TextDecoder("utf8");function pM(l,t){return new URL(l,t).href}function oF(l,t,o,u){return fetch(pM(l.uri,u)).then(m=>m.arrayBuffer()).then(m=>{t.buffers[o]=m})}function mM(l,t){const o=l.json.bufferViews[t];return new Uint8Array(l.buffers[o.buffer],o.byteOffset||0,o.byteLength)}function aF(l,t,o,u){if(l.uri){const m=pM(l.uri,u);return fetch(m).then(h=>h.blob()).then(h=>createImageBitmap(h)).then(h=>{t.images[o]=h})}if(l.bufferView!==void 0){const m=mM(t,l.bufferView),h=new Blob([m],{type:l.mimeType});return createImageBitmap(h).then(g=>{t.images[o]=g})}}function gM(l,t=0,o){const u={json:null,images:[],buffers:[]};if(new Uint32Array(l,t,1)[0]===dM){const v=new Uint32Array(l,t);let C=2;const I=(v[C++]>>2)-3,S=v[C++]>>2;if(C++,u.json=JSON.parse(fM.decode(v.subarray(C,C+S))),C+=S,C<I){const M=v[C++];C++;const R=t+(C<<2);u.buffers[0]=l.slice(R,R+M)}}else u.json=JSON.parse(fM.decode(new Uint8Array(l,t)));const{buffers:m,images:h,meshes:g,extensionsUsed:b,bufferViews:E}=u.json;let A=Promise.resolve();if(m){const v=[];for(let C=0;C<m.length;C++){const I=m[C];I.uri?v.push(oF(I,u,C,o)):u.buffers[C]||(u.buffers[C]=null)}A=Promise.all(v)}return A.then(()=>{const v=[],C=b&&b.includes(sw),I=b&&b.includes(Fy);if(C&&v.push(function(){if(!Js)return hg??(hg=function(S){let M,R=null;function O(){M=new Uint8Array(R.buffer)}function F(){throw new Error("Unexpected Draco error.")}const H={a:{a:F,d:function(W,V,Z){return M.copyWithin(W,V,V+Z)},c:function(W){const V=M.length,Z=Math.max(W>>>0,Math.ceil(1.2*V)),Y=Math.ceil((Z-V)/65536);try{return R.grow(Y),O(),!0}catch{return!1}},b:F}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(S,H):S.then(W=>W.arrayBuffer()).then(W=>WebAssembly.instantiate(W,H))).then(W=>{const{Rb:V,Qb:Z,P:Y,T:ne,X:ye,Ja:_e,La:ge,Qa:Re,Va:we,Wa:Le,eb:Be,jb:Oe,f:Ve,e:We,yb:Qe,zb:Ge,Ab:ut,Bb:It,Db:dt,Gb:Dt}=W.instance.exports;R=We;const kt=(()=>{let $t=0,_t=0,er=0,Ot=0;return Kt=>{er&&(V(Ot),V($t),_t+=er,er=$t=0),$t||(_t+=128,$t=Z(_t));const hr=Kt.length+7&-8;let Ar=$t;hr>=_t&&(er=hr,Ar=Ot=Z(hr));for(let kr=0;kr<Kt.length;kr++)M[Ar+kr]=Kt[kr];return Ar}})();return O(),Ve(),{memory:We,_free:V,_malloc:Z,Mesh:class{constructor(){this.ptr=Y()}destroy(){ne(this.ptr)}},Decoder:class{constructor(){this.ptr=_e()}destroy(){Oe(this.ptr)}DecodeArrayToMesh($t,_t,er){const Ot=kt($t),Kt=ge(this.ptr,Ot,_t,er.ptr);return!!ye(Kt)}GetAttributeByUniqueId($t,_t){return{ptr:Re(this.ptr,$t.ptr,_t)}}GetTrianglesUInt16Array($t,_t,er){we(this.ptr,$t.ptr,_t,er)}GetTrianglesUInt32Array($t,_t,er){Le(this.ptr,$t.ptr,_t,er)}GetAttributeDataArrayForAllPoints($t,_t,er,Ot,Kt){Be(this.ptr,$t.ptr,_t.ptr,er,Ot,Kt)}},DT_INT8:Qe(),DT_UINT8:Ge(),DT_INT16:ut(),DT_UINT16:It(),DT_UINT32:dt(),DT_FLOAT32:Dt()}})}(fetch(cM())),hg.then(S=>{Js=S,hg=void 0}))}()),I&&v.push(function(){if(aw)return;const S=function(M){let R;const O=WebAssembly.instantiateStreaming(M,{}).then(W=>{R=W.instance,R.exports.__wasm_call_ctors()}),F={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},H={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:O,supported:!0,decodeGltfBuffer(W,V,Z,Y,ne,ye){(function(_e,ge,Re,we,Le,Be,Oe){const Ve=_e.exports.sbrk,We=we+3&-4,Qe=Ve(We*Le),Ge=Ve(Be.length),ut=new Uint8Array(_e.exports.memory.buffer);ut.set(Be,Ge);const It=ge(Qe,we,Le,Ge,Be.length);if(It===0&&Oe&&Oe(Qe,We,Le),Re.set(ut.subarray(Qe,Qe+we*Le)),Ve(Qe-Ve(0)),It!==0)throw new Error(`Malformed buffer data: ${It}`)})(R,R.exports[H[ne]],W,V,Z,Y,R.exports[F[ye]])}}}(fetch(uM()));return S.ready.then(()=>{aw=S})}()),h)for(let S=0;S<h.length;S++)v.push(aF(h[S],u,S,o));return(v.length?Promise.all(v):Promise.resolve()).then(()=>{if(C&&g)for(const{primitives:S}of g)for(const M of S)nF(M,u);if(I&&g&&E)for(const S of E)iF(S,u);return u})})}function Ah(l,t){const o=l.json.bufferViews[t.bufferView],u=Oy[t.componentType];return new u(l.buffers[o.buffer],(t.byteOffset||0)+(o.byteOffset||0),t.count*(o.byteStride&&o.byteStride!==dg[t.type]*u.BYTES_PER_ELEMENT?o.byteStride/u.BYTES_PER_ELEMENT:dg[t.type]))}function lw(l,t,o,u){const m=Oy[t.componentType],h=function(v){switch(v){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(m),g=l.json.bufferViews[t.bufferView],b=g.byteStride?g.byteStride/m.BYTES_PER_ELEMENT:dg[t.type],E=o.float32,A=E.length/o.capacity;for(let v=0,C=0;v<t.count*b;v+=b,C+=A)for(let I=0;I<A;I++)E[C+I]=u[v+I]*h;o._trim()}function sF(l,t,o){const u=l.indices,m=l.attributes,h={};h.indexArray=new no;const g=t.json.accessors[u],b=g.count/3;h.indexArray.reserve(b);const E=Ah(t,g);for(let I=0;I<b;I++)h.indexArray.emplaceBack(E[3*I],E[3*I+1],E[3*I+2]);h.indexArray._trim(),h.vertexArray=new Sl;const A=t.json.accessors[m.POSITION];h.vertexArray.reserve(A.count);const v=Ah(t,A);for(let I=0;I<A.count;I++)h.vertexArray.emplaceBack(v[3*I],v[3*I+1],v[3*I+2]);if(h.vertexArray._trim(),h.aabb=new pr(A.min,A.max),h.centroid=function(I,S){const M=[0,0,0],R=I.length;if(R>0){for(let O=0;O<R;O++){const F=3*I[O];M[0]+=S[F],M[1]+=S[F+1],M[2]+=S[F+2]}M[0]/=R,M[1]/=R,M[2]/=R}return M}(E,v),m.COLOR_0!==void 0){const I=t.json.accessors[m.COLOR_0],S=dg[I.type],M=Ah(t,I);h.colorArray=S===3?new Sl:new Vs,h.colorArray.resize(I.count),lw(t,I,h.colorArray,M)}if(m.NORMAL!==void 0){h.normalArray=new Sl;const I=t.json.accessors[m.NORMAL];h.normalArray.resize(I.count);const S=Ah(t,I);lw(t,I,h.normalArray,S)}if(m.TEXCOORD_0!==void 0&&o.length>0){h.texcoordArray=new Us;const I=t.json.accessors[m.TEXCOORD_0];h.texcoordArray.resize(I.count);const S=Ah(t,I);lw(t,I,h.texcoordArray,S)}if(m._FEATURE_ID_RGBA4444!==void 0){const I=t.json.accessors[m._FEATURE_ID_RGBA4444];t.json.extensionsUsed&&t.json.extensionsUsed.includes("EXT_meshopt_compression")&&(h.featureData=Ah(t,I))}m._FEATURE_RGBA4444!==void 0&&(h.featureData=new Uint32Array(Ah(t,t.json.accessors[m._FEATURE_RGBA4444]).buffer));const C=l.material;return h.material=function(I,S){const{emissiveFactor:M=[0,0,0],alphaMode:R="OPAQUE",alphaCutoff:O=.5,normalTexture:F,occlusionTexture:H,emissiveTexture:W,doubleSided:V}=I,{baseColorFactor:Z=[1,1,1,1],metallicFactor:Y=1,roughnessFactor:ne=1,baseColorTexture:ye,metallicRoughnessTexture:_e}=I.pbrMetallicRoughness||{},ge=H?S[H.index]:void 0;if(H&&H.extensions&&H.extensions.KHR_texture_transform&&ge){const Re=H.extensions.KHR_texture_transform;ge.offsetScale=[Re.offset[0],Re.offset[1],Re.scale[0],Re.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Rr(...Z),metallicFactor:Y,roughnessFactor:ne,baseColorTexture:ye?S[ye.index]:void 0,metallicRoughnessTexture:_e?S[_e.index]:void 0},doubleSided:V,emissiveFactor:M,alphaMode:R,alphaCutoff:O,normalTexture:F?S[F.index]:void 0,occlusionTexture:ge,emissionTexture:W?S[W.index]:void 0,defined:I.defined===void 0}}(C!==void 0?t.json.materials[C]:{defined:!1},o),h}function _M(l,t,o){const{matrix:u,rotation:m,translation:h,scale:g,mesh:b,extras:E,children:A}=l,v={};if(v.matrix=u||Ae.mat4.fromRotationTranslationScale([],m||[0,0,0,1],h||[0,0,0],g||[1,1,1]),b!==void 0){v.meshes=o[b];const C=v.anchor=[0,0];for(const I of v.meshes){const{min:S,max:M}=I.aabb;C[0]+=S[0]+M[0],C[1]+=S[1]+M[1]}C[0]=Math.floor(C[0]/v.meshes.length/2),C[1]=Math.floor(C[1]/v.meshes.length/2)}if(E&&(E.id&&(v.id=E.id),E.lights&&(v.lights=function(C){if(!C.length)return[];const I=function(F){const H=atob(F),W=new Uint8Array(H.length);for(let V=0;V<H.length;V++)W[V]=H.codePointAt(V);return W}(C),S=[],M=I.length/24,R=new Uint16Array(I.buffer),O=new Float32Array(I.buffer);for(let F=0;F<M;F++){const H=R[2*F*6]/30,W=R[2*F*6+1]/30,V=R[2*F*6+10]/100,Z=O[6*F+1],Y=O[6*F+2],ne=O[6*F+3],ye=O[6*F+4],_e=ne-Z,ge=ye-Y,Re=Math.hypot(_e,ge);S.push({pos:[Z+.5*_e,Y+.5*ge,W],normal:[ge/Re,-_e/Re,0],width:Re,height:H,depth:V,points:[Z,Y,ne,ye]})}return S}(E.lights))),A){const C=[];for(const I of A)C.push(_M(t.json.nodes[I],t,o));v.children=C}return v}function lF(l){if(l.vertices.length===0||l.indices.length===0)return null;const t=new ub(l.vertices,l.indices,8,256),[o,u]=[t.min.clone(),t.max.clone()];return{vertices:l.vertices,indices:l.indices,grid:t,min:o,max:u}}function cF(l){if(!l.extras||!l.extras.ground)return null;const t=l.extras.ground;if(!t||!Array.isArray(t)||t.length===0)return null;const o=t[0];if(!o||!Array.isArray(o)||o.length===0)return null;const u=[];for(const g of o){if(!Array.isArray(g)||g.length!==2)continue;const b=g[0],E=g[1];typeof b=="number"&&typeof E=="number"&&u.push(new wt(b,E))}if(u.length<3)return null;u.length>1&&u[u.length-1].equals(u[0])&&u.pop();let m=0;for(let g=0;g<u.length;g++){const b=u[g],E=u[(g+1)%u.length],A=u[(g+2)%u.length];m+=(b.x-E.x)*(A.y-E.y)-(A.x-E.x)*(b.y-E.y)}m>0&&u.reverse();const h=Fm(u.flatMap(g=>[g.x,g.y]),[]);return h.length===0?null:{vertices:u,indices:h}}function uF(l,t){const o=[],u=[];let m=0;const h=[];for(const g of l){m=o.length;const b=g.vertexArray.float32,E=g.indexArray.uint16;for(let A=0;A<g.vertexArray.length;A++)h[0]=b[3*A+0],h[1]=b[3*A+1],h[2]=b[3*A+2],Ae.vec3.transformMat4(h,h,t),o.push(new wt(h[0],h[1]));for(let A=0;A<3*g.indexArray.length;A++)u.push(E[A]+m)}if(u.length%3!=0)return null;for(let g=0;g<u.length;g+=3){const b=o[u[g+0]],E=o[u[g+1]],A=o[u[g+2]];(b.x-E.x)*(A.y-E.y)-(A.x-E.x)*(b.y-E.y)>0&&([u[g+1],u[g+2]]=[u[g+2],u[g+1]])}return{vertices:o,indices:u}}function yM(l){const t=function(E,A){const v=[],C=WebGL2RenderingContext;if(E.json.textures)for(const I of E.json.textures){const S={magFilter:C.LINEAR,minFilter:C.NEAREST,wrapS:C.REPEAT,wrapT:C.REPEAT};I.sampler!==void 0&&Object.assign(S,E.json.samplers[I.sampler]),v.push({image:A[I.source],sampler:S,uploaded:!1})}return v}(l,l.images),o=function(E,A){const v=[];for(const C of E.json.meshes){const I=[];for(const S of C.primitives)I.push(sF(S,E,A));v.push(I)}return v}(l,t),{scenes:u,scene:m,nodes:h}=l.json,g=u?u[m||0].nodes:h,b=[];for(const E of g)b.push(_M(h[E],l,o));return function(E,A,v){const C={},I=new Set;for(let S=0;S<E.length;S++){const M=v[A[S]];if(!M.extras)continue;const R=M.extras["mapbox:footprint:version"],O=M.extras["mapbox:footprint:id"];(R||O)&&I.add(S),R==="1.0.0"&&O&&(C[O]=S)}for(let S=0;S<E.length;S++){if(I.has(S))continue;const M=E[S],R=v[A[S]];if(!R.extras)continue;let O=null;M.id in C&&(O=uF(E[C[M.id]].meshes,M.matrix)),O||(O=cF(R)),O&&(M.footprint=lF(O))}if(I.size>0){const S=Array.from(I.values()).sort((M,R)=>M-R);for(let M=S.length-1;M>=0;M--)E.splice(S[M],1)}}(b,g,l.json.nodes),b}function hF(l){l.heightmap=new Float32Array(4096),l.heightmap.fill(-1);const t=l.vertexArray.float32,o=l.aabb.min[0]-1,u=l.aabb.min[1]-1,m=Mh/(l.aabb.max[0]-o+2),h=Mh/(l.aabb.max[1]-u+2);for(let g=0;g<t.length;g+=3){const b=t[g+2],E=(t[g+0]-o)*m|0,A=(t[g+1]-u)*h|0;b>l.heightmap[A*Mh+E]&&(l.heightmap[A*Mh+E]=b)}}function dF(l,t){const o={};o.indexArray=new no,o.indexArray.reserve(4*l.length),o.vertexArray=new Sl,o.vertexArray.reserve(10*l.length),o.colorArray=new Vs,o.vertexArray.reserve(10*l.length);let u=0;for(const g of l){const b=Math.min(10,Math.max(4,1.3*g.height))*t,E=[-g.normal[1],g.normal[0],0],A=Math.min(.29,.1*g.width/g.depth),v=g.width-2*g.depth*t*(A+.01),C=Ae.vec3.scaleAndAdd([],g.pos,E,v/2),I=Ae.vec3.scaleAndAdd([],g.pos,E,-v/2),S=[C[0],C[1],C[2]+g.height],M=[I[0],I[1],I[2]+g.height],R=Ae.vec3.scaleAndAdd([],g.normal,E,A);Ae.vec3.scale(R,R,b);const O=Ae.vec3.scaleAndAdd([],g.normal,E,-A);Ae.vec3.scale(O,O,b),Ae.vec3.add(R,C,R),Ae.vec3.add(O,I,O),C[2]+=.1,I[2]+=.1,o.vertexArray.emplaceBack(R[0],R[1],R[2]),o.vertexArray.emplaceBack(O[0],O[1],O[2]),o.vertexArray.emplaceBack(C[0],C[1],C[2]),o.vertexArray.emplaceBack(I[0],I[1],I[2]),o.vertexArray.emplaceBack(S[0],S[1],S[2]),o.vertexArray.emplaceBack(M[0],M[1],M[2]),o.vertexArray.emplaceBack(C[0],C[1],C[2]),o.vertexArray.emplaceBack(I[0],I[1],I[2]),o.vertexArray.emplaceBack(R[0],R[1],R[2]),o.vertexArray.emplaceBack(O[0],O[1],O[2]);const F=v/b/2;o.colorArray.emplaceBack(-F-A,-1,F,.8),o.colorArray.emplaceBack(F+A,-1,F,.8),o.colorArray.emplaceBack(-F,0,F,1.3),o.colorArray.emplaceBack(F,0,F,1.3),o.colorArray.emplaceBack(F+A,-.8,F,.7),o.colorArray.emplaceBack(F+A,-.8,F,.7),o.colorArray.emplaceBack(0,0,F,1.3),o.colorArray.emplaceBack(0,0,F,1.3),o.colorArray.emplaceBack(F+A,-1.2,F,.8),o.colorArray.emplaceBack(F+A,-1.2,F,.8),o.indexArray.emplaceBack(6+u,4+u,8+u),o.indexArray.emplaceBack(7+u,9+u,5+u),o.indexArray.emplaceBack(0+u,1+u,2+u),o.indexArray.emplaceBack(1+u,3+u,2+u),u+=10}const m={defined:!0,emissiveFactor:[0,0,0]},h={};return h.baseColorFactor=Rr.white,m.pbrMetallicRoughness=h,o.material=m,o.aabb=new pr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),o}class vM{constructor(t){this._stringToNumber={},this._numberToString=[];for(let o=0;o<t.length;o++){const u=t[o];this._stringToNumber[u]=o,this._numberToString[o]=u}}encode(t){return this._stringToNumber[t]}decode(t){return this._numberToString[t]}}const fF=["id","tile","layer","source","sourceLayer","state"];class Pf{constructor(t,o,u,m,h){this.type="Feature",this._vectorTileFeature=t,this._z=o,this._x=u,this._y=m,this.properties=t.properties,this.id=h}clone(){const t=new Pf(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(t.state={...this.state}),this.layer&&(t.layer={...this.layer}),this.source&&(t.source=this.source),this.sourceLayer&&(t.sourceLayer=this.sourceLayer),t}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(t){this._geometry=t}toJSON(){const t={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const o of fF)this[o]!==void 0&&(t[o]=this[o]);return t}}class xM{constructor(t,o){this.tileID=t,this.x=t.canonical.x,this.y=t.canonical.y,this.z=t.canonical.z,this.grid=new rc(Nt,16,0),this.featureIndexArray=new $0,this.promoteId=o,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(t,o,u,m,h,g=0,b=0){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(u,m,h,g);const A=this.grid;for(let v=0;v<o.length;v++){const C=o[v],I=[1/0,1/0,-1/0,-1/0];for(let S=0;S<C.length;S++){const M=C[S];I[0]=Math.min(I[0],M.x),I[1]=Math.min(I[1],M.y),I[2]=Math.max(I[2],M.x),I[3]=Math.max(I[3],M.y)}b!==0&&(I[0]-=b,I[1]-=b,I[2]+=b,I[3]+=b),I[0]<Nt&&I[1]<Nt&&I[2]>=0&&I[3]>=0&&A.insert(E,I[0],I[1],I[2],I[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new mf.VectorTile(new sy(this.rawTileData)).layers,this.sourceLayerCoder=new vM(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const t in this.vtLayers)this.vtFeatures[t]=[]}return this.vtLayers}query(t,o){const{tilespaceGeometry:u,transform:m,tileTransform:h,pixelPosMatrix:g,availableImages:b}=o;this.loadVTLayers(),this.serializedLayersCache.clear();const E=u.bufferedTilespaceBounds,A=this.grid.query(E.min.x,E.min.y,E.max.x,E.max.y,(S,M,R,O)=>at(u.bufferedTilespaceGeometry,S,M,R,O));A.sort(pF);let v=null;m.elevation&&A.length>0&&(v=wf.create(m.elevation,this.tileID));const C={};let I;for(let S=0;S<A.length;S++){const M=A[S];if(M===I)continue;I=M;const R=this.featureIndexArray.get(M);let O=null;this.is3DTile?this.loadMatchingModelFeature(C,R,t,u,m):this.loadMatchingFeature(C,R,t,b,(F,H,W,V=0)=>(O||(O=B(F,this.tileID.canonical,h)),H.queryIntersectsFeature(u,F,W,O,this.z,m,g,v,V)))}return C}loadMatchingFeature(t,o,u,m,h){const{featureIndex:g,bucketIndex:b,sourceLayerIndex:E,layoutVertexArrayOffset:A}=o,v=this.bucketLayerIDs[b],C=u.layers,I=Object.keys(C);if(I.length&&!function(F,H){for(let W=0;W<F.length;W++)if(H.indexOf(F[W])>=0)return!0;return!1}(I,v))return;const S=u.sourceCache,M=this.sourceLayerCoder.decode(E),R=this.vtLayers[M].feature(g),O=this.getId(R,M);for(let F=0;F<v.length;F++){const H=v[F];if(!C[H])continue;const{styleLayer:W,targets:V}=C[H];let Z={};O!==void 0&&(Z=S.getFeatureState(W.sourceLayer,O));const Y=!h||h(R,W,Z,A);if(!Y)continue;const ne=new Pf(R,this.z,this.x,this.y,O);ne.tile=this.tileID.canonical,ne.state=Z;let ye=this.serializedLayersCache.get(H);ye||(ye=W.serialize(),ye.id=H,this.serializedLayersCache.set(H,ye)),ne.source=ye.source,ne.sourceLayer=ye["source-layer"],ne.layer=dn({},ye),ne.layer.paint=bM(ye.paint,W.paint,R,Z,m),ne.layer.layout=bM(ye.layout,W.layout,R,Z,m);let _e=!1;for(const ge of V){const{filter:Re}=ge;if(Re){if(Re.needGeometry){const we=G(R,!0);if(!Re.filter(new Vn(this.tileID.overscaledZ),we,this.tileID.canonical))continue}else if(!Re.filter(new Vn(this.tileID.overscaledZ),R))continue}_e=!0,ge.targetId&&this.addFeatureVariant(ne,ge)}_e&&this.appendToResult(t,H,g,ne,Y)}}loadMatchingModelFeature(t,o,u,m,h){const g=this.bucketLayerIDs[0][0],b=u.layers;if(!b[g])return;const{styleLayer:E,targets:A}=b[g];if(E.type!=="model")return;const v=m.tile,C=o.featureIndex,I=v.getBucket(E);if(!(I&&I instanceof Iy))return;const S=function(ye,_e,ge,Re){const we=ye.getNodesInfo()[_e];if(we.hiddenByReplacement||!we.node.meshes)return;let Le=Number.MAX_VALUE;const Be=we.node,Oe=ge.tile,Ve=Re.calculatePosMatrix(Oe.tileID.toUnwrapped(),Re.worldSize),We=we.evaluatedScale;let Qe=0;Re.elevation&&Be.elevation&&(Qe=Be.elevation*Re.elevation.exaggeration()),Ae.mat4.translate(Ve,Ve,[(Be.anchor?Be.anchor[0]:0)*(We[0]-1),(Be.anchor?Be.anchor[1]:0)*(We[1]-1),Qe]),Ae.mat4.scale(Ve,Ve,We);const Ge=ge.queryGeometry,ut=Ge.isPointQuery()?Ge.screenBounds:Ge.screenGeometry,It=function(Dt){const kt=Ae.mat4.multiply([],Ve,Dt.matrix);Ae.mat4.multiply(kt,Re.expandedFarZProjMatrix,kt);for(let $t=0;$t<Dt.meshes.length;++$t){const _t=Dt.meshes[$t];if($t===Dt.lightMeshIndex)continue;const er=b4(ut,Re,kt,_t.aabb);er!=null&&(Le=Math.min(er,Le))}if(Dt.children)for(const $t of Dt.children)It($t)};if(It(Be),Le===Number.MAX_VALUE)return;const dt=new rn(0,0);return L4(Oe.tileID.canonical,dt,we.node.anchor[0],we.node.anchor[1]),{intersectionZ:Le,position:dt,feature:we.feature}}(I,C,m,h);if(!S)return;const{z:M,x:R,y:O}=v.tileID.canonical,{feature:F,intersectionZ:H,position:W}=S;let V={};F.id!==void 0&&(V=u.sourceCache.getFeatureState(E.sourceLayer,F.id));const Z=new Pf({},M,R,O,F.id);Z.tile=this.tileID.canonical,Z.state=V,Z.properties=F.properties,Z.geometry={type:"Point",coordinates:[W.lng,W.lat]};let Y=this.serializedLayersCache.get(g);Y||(Y=E.serialize(),Y.id=g,this.serializedLayersCache.set(g,Y)),Z.source=Y.source,Z.sourceLayer=Y["source-layer"],Z.layer=dn({},Y);let ne=!1;for(const ye of A){const{filter:_e}=ye;if(_e){if(_e.needGeometry){if(!_e.filter(new Vn(this.tileID.overscaledZ),F,this.tileID.canonical))continue}else if(!_e.filter(new Vn(this.tileID.overscaledZ),F))continue}ne=!0,ye.targetId&&this.addFeatureVariant(Z,ye)}ne&&this.appendToResult(t,g,C,Z,H)}addFeatureVariant(t,o,u){const m={target:o.target,namespace:o.namespace};if(o.properties){const h={};for(const g in o.properties){const b=o.properties[g].evaluate({zoom:this.z},t._vectorTileFeature,t.state,t.tile,u);b!=null&&(h[g]=b)}m.properties=h}t.variants=t.variants||{},t.variants[o.targetId]=t.variants[o.targetId]||[],t.variants[o.targetId].push(m)}appendToResult(t,o,u,m,h){let g=t[o];g===void 0&&(g=t[o]=[]),g.push({featureIndex:u,feature:m,intersectionZ:h})}lookupSymbolFeatures(t,o,u,m,h){const g={};this.loadVTLayers();for(const b of t)this.loadMatchingFeature(g,{bucketIndex:o,sourceLayerIndex:u,featureIndex:b,layoutVertexArrayOffset:0},m,h);return g}loadFeature(t){const{featureIndex:o,sourceLayerIndex:u}=t;this.loadVTLayers();const m=this.sourceLayerCoder.decode(u),h=this.vtFeatures[m];if(h[o])return h[o];const g=this.vtLayers[m].feature(o);return h[o]=g,g}hasLayer(t){for(const o of this.bucketLayerIDs)for(const u of o)if(t===u)return!0;return!1}getId(t,o){let u=t.id;if(this.promoteId){const m=typeof this.promoteId=="string"?this.promoteId:this.promoteId[o];m!=null&&(u=t.properties[m]),typeof u=="boolean"&&(u=Number(u))}return u}}function bM(l,t,o,u,m){return Jn(l,(h,g)=>{const b=t instanceof qc?t.get(g):null;return b&&b.evaluate?b.evaluate(o,u,m):b})}function pF(l,t){return t-l}Yt(xM,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const wM=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class cw{static from(t){if(!(t instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,u]=new Uint8Array(t,0,2);if(o!==219)throw new Error("Data does not appear to be in a KDBush format.");const m=u>>4;if(m!==1)throw new Error(`Got v${m} data when expected v1.`);const h=wM[15&u];if(!h)throw new Error("Unrecognized array type.");const[g]=new Uint16Array(t,2,1),[b]=new Uint32Array(t,4,1);return new cw(b,g,h,t)}constructor(t,o=64,u=Float64Array,m){if(isNaN(t)||t<0)throw new Error(`Unpexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=u,this.IndexArrayType=t<65536?Uint16Array:Uint32Array;const h=wM.indexOf(this.ArrayType),g=2*t*this.ArrayType.BYTES_PER_ELEMENT,b=t*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-b%8)%8;if(h<0)throw new Error(`Unexpected typed array class: ${u}.`);m&&m instanceof ArrayBuffer?(this.data=m,this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+E,2*t),this._pos=2*t,this._finished=!0):(this.data=new ArrayBuffer(8+g+b+E),this.ids=new this.IndexArrayType(this.data,8,t),this.coords=new this.ArrayType(this.data,8+b+E,2*t),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+h]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=t)}add(t,o){const u=this._pos>>1;return this.ids[u]=u,this.coords[this._pos++]=t,this.coords[this._pos++]=o,u}finish(){const t=this._pos>>1;if(t!==this.numItems)throw new Error(`Added ${t} items when expected ${this.numItems}.`);return uw(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(t,o,u,m){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:g,nodeSize:b}=this,E=[0,h.length-1,0],A=[];for(;E.length;){const v=E.pop()||0,C=E.pop()||0,I=E.pop()||0;if(C-I<=b){for(let O=I;O<=C;O++){const F=g[2*O],H=g[2*O+1];F>=t&&F<=u&&H>=o&&H<=m&&A.push(h[O])}continue}const S=I+C>>1,M=g[2*S],R=g[2*S+1];M>=t&&M<=u&&R>=o&&R<=m&&A.push(h[S]),(v===0?t<=M:o<=R)&&(E.push(I),E.push(S-1),E.push(1-v)),(v===0?u>=M:m>=R)&&(E.push(S+1),E.push(C),E.push(1-v))}return A}within(t,o,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:h,nodeSize:g}=this,b=[0,m.length-1,0],E=[],A=u*u;for(;b.length;){const v=b.pop()||0,C=b.pop()||0,I=b.pop()||0;if(C-I<=g){for(let O=I;O<=C;O++)EM(h[2*O],h[2*O+1],t,o)<=A&&E.push(m[O]);continue}const S=I+C>>1,M=h[2*S],R=h[2*S+1];EM(M,R,t,o)<=A&&E.push(m[S]),(v===0?t-u<=M:o-u<=R)&&(b.push(I),b.push(S-1),b.push(1-v)),(v===0?t+u>=M:o+u>=R)&&(b.push(S+1),b.push(C),b.push(1-v))}return E}}function uw(l,t,o,u,m,h){if(m-u<=o)return;const g=u+m>>1;SM(l,t,g,u,m,h),uw(l,t,o,u,g-1,1-h),uw(l,t,o,g+1,m,1-h)}function SM(l,t,o,u,m,h){for(;m>u;){if(m-u>600){const A=m-u+1,v=o-u+1,C=Math.log(A),I=.5*Math.exp(2*C/3),S=.5*Math.sqrt(C*I*(A-I)/A)*(v-A/2<0?-1:1);SM(l,t,o,Math.max(u,Math.floor(o-v*I/A+S)),Math.min(m,Math.floor(o+(A-v)*I/A+S)),h)}const g=t[2*o+h];let b=u,E=m;for(fg(l,t,u,o),t[2*m+h]>g&&fg(l,t,u,m);b<E;){for(fg(l,t,b,E),b++,E--;t[2*b+h]<g;)b++;for(;t[2*E+h]>g;)E--}t[2*u+h]===g?fg(l,t,u,E):(E++,fg(l,t,E,m)),E<=o&&(u=E+1),o<=E&&(m=E-1)}}function fg(l,t,o,u){hw(l,o,u),hw(t,2*o,2*u),hw(t,2*o+1,2*u+1)}function hw(l,t,o){const u=l[t];l[t]=l[o],l[o]=u}function EM(l,t,o,u){const m=l-o,h=t-u;return m*m+h*h}i.$=Od,i.A=2,i.B=BC,i.C=Ib,i.D=Sf,i.E=lo,i.F=class extends Cy{},i.G=Jl,i.H=Ls,i.I=ew,i.J=P0,i.K=Dd,i.L=Vc,i.M=g0,i.N=Bd,i.O=Xd,i.P=wt,i.Q=x0,i.R=wi,i.S=uh,i.T=jb,i.U=ec,i.V=Cy,i.W=js,i.X=Bc,i.Y=Xo,i.Z=Hl,i._=dm,i.a=function(l){return K.API_CDN_URL_REGEX.test(l)},i.a$=fi,i.a0=m0,i.a1=function(l){const t=l.value;let o=[];if(!t)return o;const u=Jl(t);return u!=="string"?(o=o.concat([new Cy(l.key,t,`string expected, "${u}" found`)]),o):(S4(t,!0)||(o=o.concat([new Cy(l.key,t,`invalid url "${t}"`)])),o)},i.a2=nt,i.a3=ac,i.a4=ti,i.a5=zt,i.a6=class{constructor(l){this.specification=l}possiblyEvaluate(l,t){return li(l.expression.evaluate(t))}interpolate(l,t,o){return{x:ur(l.x,t.x,o),y:ur(l.y,t.y,o),z:ur(l.z,t.z,o),azimuthal:ur(l.azimuthal,t.azimuthal,o),polar:ur(l.polar,t.polar,o)}}},i.a7=Vn,i.a8=Uc,i.a9=_,i.aA=class{constructor(l){this.entries={},this.scheduler=l}request(l,t,o,u){const m=this.entries[l]=this.entries[l]||{callbacks:[]};if(m.result){const[h,g]=m.result;return this.scheduler?this.scheduler.add(()=>{u(h,g)},t):u(h,g),()=>{}}return m.callbacks.push(u),m.cancel||(m.cancel=o((h,g)=>{m.result=[h,g];for(const b of m.callbacks)this.scheduler?this.scheduler.add(()=>{b(h,g)},t):b(h,g);setTimeout(()=>delete this.entries[l],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(h=>h!==u),m.callbacks.length||(m.cancel(),delete this.entries[l]))}}},i.aB=Fo,i.aC=function(l,t,o){const u=JSON.stringify(l.request);return l.data&&(this.deduped.entries[u]={result:[null,l.data]}),this.deduped.request(u,{type:"parseTile",isSymbolTile:l.isSymbolTile,zoom:l.tileZoom},m=>{const h=zi(l.request,(g,b,E,A)=>{g?m(g):b&&m(null,{vectorTile:o?void 0:new mf.VectorTile(new sy(b)),rawData:b,cacheControl:E,expires:A})});return()=>{h.cancel(),m()}},t)},i.aD=function(l){In++,In>Xt&&(l.getActor().send("enforceCacheSizeLimit",Gt),In=0)},i.aE=function(l){return l<=1?1:Math.pow(2,Math.floor(Math.log(l)/Math.LN2))},i.aF=Bt,i.aG=u4,i.aH=g4,i.aI=c4,i.aJ=function(l,t){const o=document.createElement("video");o.muted=!0,o.onloadstart=function(){t(null,o)};for(let u=0;u<l.length;u++){const m=document.createElement("source");ss(l[u])||(o.crossOrigin="Anonymous"),m.src=l[u],o.appendChild(m)}return{cancel:()=>{}}},i.aK=by,i.aL=function(l){return fetch(l).then(t=>t.arrayBuffer()).then(t=>gM(t,0,l))},i.aM=yM,i.aN=class{constructor(l,t,o,u){this.id=l,this.position=t!=null?new rn(t[0],t[1]):new rn(0,0),this.orientation=o??[0,0,0],this.nodes=u,this.uploaded=!1,this.aabb=new pr([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(l,t){if(Ae.mat4.multiply(l.matrix,t,l.matrix),l.meshes)for(const o of l.meshes){const u=pr.applyTransformFast(o.aabb,l.matrix);this.aabb.encapsulate(u)}if(l.children)for(const o of l.children)this._applyTransformations(o,l.matrix)}computeBoundsAndApplyParent(){const l=Ae.mat4.identity([]);for(const t of this.nodes)this._applyTransformations(t,l)}computeModelMatrix(l,t,o,u,m,h,g=!1){I4(this.matrix,this,l.transform,this.position,t,o,u,m,h,g)}upload(l){if(!this.uploaded){for(const t of this.nodes)Hb(t,l);for(const t of this.nodes)My(t);this.uploaded=!0}}destroy(){for(const l of this.nodes)Wb(l)}},i.aO=nn,i.aP=Km,i.aQ=ta,i.aR=Zi,i.aS=Qc,i.aT=no,i.aU=Ui,i.aV=F0,i.aW=vy,i.aX=function(){Qo.isLoading()||Qo.isLoaded()||hm()!=="deferred"||C0()},i.aY=A0,i.aZ=G,i.a_=Pf,i.aa=Ae,i.ab=bn,i.ac=qc,i.ad=mo,i.ae=ur,i.af=Nt,i.ag=va,i.ah=ar,i.ai=Rr,i.aj=class{constructor(l){this.specification=l}possiblyEvaluate(l,t){return function([o,u]){const m=li([1,o,u]);return{x:m.x,y:m.y,z:m.z}}(l.expression.evaluate(t))}interpolate(l,t,o){return{x:ur(l.x,t.x,o),y:ur(l.y,t.y,o),z:ur(l.z,t.z,o)}}},i.ak=function(l,t,o=0,u=!0){const m=new wt(o,o),h=l.sub(m),g=t.add(m),b=[h,new wt(g.x,h.y),g,new wt(h.x,g.y)];return u&&b.push(h.clone()),b},i.al=function(l,t){const o=[];for(let u=0;u<l.length;u++){const m=gn(u-1,-1,l.length-1),h=gn(u+1,-1,l.length-1),g=l[u],b=l[h],E=l[m].sub(g).unit(),A=b.sub(g).unit(),v=A.angleWithSep(E.x,E.y),C=E.add(A).unit().mult(-1*t/Math.sin(v/2));o.push(g.add(C))}return o},i.am=XC,i.an=at,i.ao=function(l,t,o=0){return Ae.vec3.fromValues(((t.x-o)*l.scale-l.x)*Nt,(t.y*l.scale-l.y)*Nt,km(t.z,t.y))},i.ap=Or,i.aq=fC,i.ar=function(l){let t=1/0,o=1/0,u=-1/0,m=-1/0;for(const h of l)t=Math.min(t,h.x),o=Math.min(o,h.y),u=Math.max(u,h.x),m=Math.max(m,h.y);return{min:new wt(t,o),max:new wt(u,m)}},i.as=Al,i.at=$e,i.au=w,i.av=Jt,i.aw=fo,i.ax=function(l,t){const o={};for(let u=0;u<t.length;u++){const m=t[u];m in l&&(o[m]=l[m])}return o},i.ay=Pl,i.az=Hs,i.b=function(l){return K.API_FONTS_REGEX.test(l)},i.b$=_4,i.b0=vb,i.b1=cb,i.b2=B,i.b3=$s,i.b4=Em,i.b5=Jr,i.b6=ri,i.b7=Fm,i.b8=Fb,i.b9=function(l,t){const o=mo(t.zoom);if(o===0)return ki(l);const u=Tn(l),m=en(u),h=Al(u.getWest())*t.worldSize,g=Al(u.getEast())*t.worldSize,b=Hs(u.getNorth())*t.worldSize,E=Hs(u.getSouth())*t.worldSize,A=[h,b,0],v=[g,b,0],C=[h,E,0],I=[g,E,0],S=Ae.mat4.invert([],t.globeMatrix);return Ae.vec3.transformMat4(A,A,S),Ae.vec3.transformMat4(v,v,S),Ae.vec3.transformMat4(C,C,S),Ae.vec3.transformMat4(I,I,S),m[0]=vi(m[0],C,o),m[1]=vi(m[1],I,o),m[2]=vi(m[2],v,o),m[3]=vi(m[3],A,o),pr.fromPoints(m)},i.bA=Rb,i.bB=HC,i.bC=Mb,i.bD=cw,i.bE=gn,i.bF=Wi,i.bG=wo,i.bH=function(l,t,o){l[4*t+0]=o[0],l[4*t+1]=o[1],l[4*t+2]=o[2],l[4*t+3]=o[3]},i.bI=wh,i.bJ=us,i.bK=sf,i.bL=ci,i.bM=sc,i.bN=rn,i.bO=e4,i.bP=Vt,i.bQ=Qr,i.bR=y4,i.bS=jt,i.bT=On,i.bU=function(l,t,o,u,m,h,g,b,E){if(E.name==="globe")return On(l,t,new jt(o,u,m),!1);const A=Km({z:o,x:u,y:m},E);return new pr([(h+A.x/A.scale)*t,t*(A.y/A.scale),g],[(h+A.x2/A.scale)*t,t*(A.y2/A.scale),b])},i.bV=function(l,t,o){let u=0;for(let m=0;m<2;++m)l[m]>0&&(u+=(l[m]-0)*(l[m]-0)),t[m]<0&&(u+=(0-t[m])*(0-t[m]));return u},i.bW=mi,i.bX=Am,i.bY=function(l){const t=Ae.mat4.identity(new Float64Array(16));Ae.mat4.multiply(t,l.pixelMatrix,l.globeMatrix);const o=[0,Ta,0],u=[0,Ca,0];return Ae.vec3.transformMat4(o,o,t),Ae.vec3.transformMat4(u,u,t),[o[0]>0&&o[0]<=l.width&&o[1]>0&&o[1]<=l.height&&!qs(l,new rn(l.center.lat,90)),u[0]>0&&u[0]<=l.width&&u[1]>0&&u[1]<=l.height&&!qs(l,new rn(l.center.lat,-90))]},i.bZ=function(l,t){const{scale:o}=l.tileTransform,u=o*Nt/(l.tileSize*Math.pow(2,t.zoom-l.tileID.overscaledZ+l.tileID.canonical.z));return Ae.mat2.scale(new Float32Array(4),t.inverseAdjustmentMatrix,[u,u])},i.b_=Ey,i.ba=io,i.bb=ni,i.bc=vi,i.bd=Jc,i.be=Er,i.bf=iw,i.bg=sy,i.bh=zi,i.bi=function(l){const t=[];for(const o in l)t.push(l[o]);return t},i.bj=function(l,t){const o=[];for(const u in l)u in t||o.push(u);return o},i.bk=Kn,i.bl=["type","source","source-layer","minzoom","maxzoom","filter","layout"],i.bm=Pr,i.bn=function(l,t){const{x:o,y:u}=l.point,m=hs(o,u,l.worldSize/l._pixelsPerMercatorPixel,0,0);return Ae.mat4.multiply(m,m,ca(ki(t)))},i.bo=gf,i.bp=Va,i.bq=ay,i.br=function(l,t,o,u,m){const h=5*t+2;l.float32[h+0]=o,l.float32[h+1]=u,l.float32[h+2]=m},i.bs=yy,i.bt=FC,i.bu=oe,i.bv=go,i.bw=NT,i.bx=w4,i.by=GT,i.bz=HT,i.c=de,i.c$=(l,t,o,u,m,h,g,b)=>{const E=l.transform,A=E.pitch<15?pC(.07,.7,Jt((14-E.zoom)/5,0,1)):.07,v=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:gC(l,t,o,u),u_texsize:t.imageAtlasTexture?t.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:E.calculatePixelsToTileUnitsMatrix(t),u_device_pixel_ratio:m,u_width_scale:h,u_floor_width_scale:g,u_image:0,u_tile_units_to_pixels:mC(t,E),u_units_to_pixels:[1/E.pixelsToGLUnits[0],1/E.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:b,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toRenderColor(v?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:A,u_tile_to_meter:p(t.tileID.canonical,0)}},i.c0=function(l){const t=_4(l,!0);return Ae.mat2.invert([],[t[0],t[1],t[4],t[5]])},i.c1=jn,i.c2=function(l){const{x:t,y:o}=l.point,{lng:u,lat:m}=l._center;return hs(t,o,l.worldSize,u,m)},i.c3=tn,i.c4=Zt,i.c5=Pm,i.c6=function(l){const t=Math.round((l+45+360)%360/90)%4;return Ln[t]},i.c7=45,i.c8=Sh,i.c9=lf,i.cA=Xr,i.cB=function(l,t,o){const u=mo(o.zoom),m=l.style.map._antialias,h=t.options.extStandardDerivativesForceOff||l.terrain&&l.terrain.exaggeration()>0;return u===0&&!m&&!h},i.cC=function(l){const t=l.pixelsPerMeter,o=t/wo(1,l.center.lat),u=Ae.mat4.identity(new Float64Array(16));return Ae.mat4.translate(u,u,[l.point.x,l.point.y,0]),Ae.mat4.scale(u,u,[o,o,t]),Float32Array.from(u)},i.cD=Tn,i.cE=function(l){const t=mi-5;l=Jt(l,-t,t)/t*90;const o=Math.pow(Math.abs(Math.sin(ar(l))),3);return Math.round(o*(Rm.length-1))},i.cF=function(l,t,o,u){const m=t.getNorth(),h=t.getSouth(),g=t.getWest(),b=t.getEast(),E=1<<l.z,A=b-g,v=m-h,C=A/cc,I=-v/Rm[o],S=[0,C,0,I,0,0,m,g,0];if(l.z>0){const M=180/u;Ae.mat3.multiply(S,S,[M/A+1,0,0,0,M/v+1,0,-.5*M/C,.5*M/I,1])}return S[2]=E,S[5]=l.x,S[8]=l.y,S},i.cG=ki,i.cH=function(l,t,o){const u=Ae.mat4.identity(new Float64Array(16)),m=(t/(1<<l)-.5)*Math.PI*2;return Ae.mat4.rotateY(u,o.globeMatrix,m),Float32Array.from(u)},i.cI=class{isDataAvailableAtPoint(l){const t=this._source();if(this.isUsingMockSource()||!t||l.y<0||l.y>1)return!1;const o=t.getSource().maxzoom,u=1<<o,m=Math.floor(l.x),h=Math.floor((l.x-m)*u),g=Math.floor(l.y*u),b=this.findDEMTileFor(new Bt(o,m,o,h,g));return!(!b||!b.dem)}getAtPointOrZero(l,t=0){return this.getAtPoint(l,t)||0}getAtPoint(l,t,o=!0){if(this.isUsingMockSource())return null;t==null&&(t=null);const u=this._source();if(!u||l.y<0||l.y>1)return t;const m=u.getSource().maxzoom,h=1<<m,g=Math.floor(l.x),b=l.x-g,E=new Bt(m,g,m,Math.floor(b*h),Math.floor(l.y*h)),A=this.findDEMTileFor(E);if(!A||!A.dem)return t;const v=A.dem,C=1<<A.tileID.canonical.z,I=(b*C-A.tileID.canonical.x)*v.dim,S=(l.y*C-A.tileID.canonical.y)*v.dim,M=Math.floor(I),R=Math.floor(S);return(o?this.exaggeration():1)*ur(ur(v.get(M,R),v.get(M,R+1),S-R),ur(v.get(M+1,R),v.get(M+1,R+1),S-R),I-M)}getAtTileOffset(l,t,o){const u=1<<l.canonical.z;return this.getAtPointOrZero(new _(l.wrap+(l.canonical.x+t/Nt)/u,(l.canonical.y+o/Nt)/u))}getAtTileOffsetFunc(l,t,o,u){return m=>{const h=this.getAtTileOffset(l,m.x,m.y),g=u.upVector(l.canonical,m.x,m.y),b=u.upVectorScale(l.canonical,t,o).metersToTile;return Ae.vec3.scale(g,g,h*b),g}}getForTilePoints(l,t,o,u){if(this.isUsingMockSource())return!1;const m=wf.create(this,l,u);return!!m&&(t.forEach(h=>{h[2]=this.exaggeration()*m.getElevationAt(h[0],h[1],o)}),!0)}getMinMaxForTile(l){if(this.isUsingMockSource())return null;const t=this.findDEMTileFor(l);if(!t||!t.dem)return null;const o=t.dem.tree,u=t.tileID,m=1<<l.canonical.z-u.canonical.z;let h=l.canonical.x/m-u.canonical.x,g=l.canonical.y/m-u.canonical.y,b=0;for(let E=0;E<l.canonical.z-u.canonical.z&&!o.leaves[b];E++){h*=2,g*=2;const A=2*Math.floor(g)+Math.floor(h);b=o.childOffsets[b]+A,h%=1,g%=1}return{min:this.exaggeration()*o.minimums[b],max:this.exaggeration()*o.maximums[b]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(l,t,o){throw new Error("Pure virtual method called.")}pointCoordinate(l){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(l){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const l=this.visibleDemTiles;if(l.length===0)return null;let t=!1,o=Number.MAX_VALUE,u=Number.MIN_VALUE;for(const m of l){const h=this.getMinMaxForTile(m.tileID);h&&(o=Math.min(o,h.min),u=Math.max(u,h.max),t=!0)}return t?{min:o,max:u}:null}},i.cJ=yT,i.cK=an,i.cL=function(l,t){return[Math.pow(l[0],2.2)*t,Math.pow(l[1],2.2)*t,Math.pow(l[2],2.2)*t]},i.cM=Ws,i.cN=le,i.cO=te,i.cP=256,i.cQ=function(l,t){const o=[0,0,0],u=io(ki(t.canonical));return Ae.vec3.transformMat4(o,o,u),Ae.vec3.transformMat4(o,o,l),o},i.cR=l=>({u_camera_to_center_distance:new ci(l),u_extrude_scale:new uf(l),u_device_pixel_ratio:new ci(l),u_matrix:new wh(l),u_inv_rot_matrix:new wh(l),u_merc_center:new us(l),u_tile_id:new sf(l),u_zoom_transition:new ci(l),u_up_dir:new sf(l),u_emissive_strength:new ci(l)}),i.cS=l=>({u_matrix:new wh(l),u_pixels_to_tile_units:new uf(l),u_device_pixel_ratio:new ci(l),u_width_scale:new ci(l),u_floor_width_scale:new ci(l),u_units_to_pixels:new us(l),u_dash_image:new sc(l),u_gradient_image:new sc(l),u_image_height:new ci(l),u_texsize:new us(l),u_tile_units_to_pixels:new ci(l),u_alpha_discard_threshold:new ci(l),u_trim_offset:new us(l),u_trim_fade_range:new us(l),u_trim_color:new lf(l),u_emissive_strength:new ci(l),u_zbias_factor:new ci(l),u_tile_to_meter:new ci(l)}),i.cT=l=>({u_matrix:new wh(l),u_texsize:new us(l),u_pixels_to_tile_units:new uf(l),u_device_pixel_ratio:new ci(l),u_width_scale:new ci(l),u_floor_width_scale:new ci(l),u_image:new sc(l),u_units_to_pixels:new us(l),u_tile_units_to_pixels:new ci(l),u_alpha_discard_threshold:new ci(l),u_trim_offset:new us(l),u_trim_fade_range:new us(l),u_trim_color:new lf(l),u_emissive_strength:new ci(l),u_zbias_factor:new ci(l),u_tile_to_meter:new ci(l)}),i.cU=vm,i.cV=yD,i.cW=vD,i.cX=ff,i.cY=(l,t,o,u,m,h)=>{const g=l.transform,b=g.projection.name==="globe";let E;if(h.paint.get("circle-pitch-alignment")==="map")if(b){const v=Ws(g.zoom,t.canonical)*g._pixelsPerMercatorPixel;E=Float32Array.from([v,0,0,v])}else E=g.calculatePixelsToTileUnitsMatrix(o);else E=new Float32Array([g.pixelsToGLUnits[0],0,0,g.pixelsToGLUnits[1]]);const A={u_camera_to_center_distance:l.transform.getCameraToCenterDistance(g.projection),u_matrix:l.translatePosMatrix(t.projMatrix,o,h.paint.get("circle-translate"),h.paint.get("circle-translate-anchor")),u_device_pixel_ratio:pt.devicePixelRatio,u_extrude_scale:E,u_inv_rot_matrix:Dm,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:h.paint.get("circle-emissive-strength")};if(b){A.u_inv_rot_matrix=u,A.u_merc_center=m,A.u_tile_id=[t.canonical.x,t.canonical.y,1<<t.canonical.z],A.u_zoom_transition=mo(g.zoom);const v=m[0]*Nt,C=m[1]*Nt;A.u_up_dir=g.projection.upVector(new jt(0,0,0),v,C)}return A},i.cZ=_C,i.c_=Li,i.ca=function(l,t,o){const u=Math.sqrt(l*l+t*t+o*o),m=u>0?Math.acos(o/u)*Un:0;let h=l!==0||t!==0?Math.atan2(-t,-l)*Un+90:0;return h<0&&(h+=360),[u,h,m]},i.cb=p,i.cc=pr,i.cd=li,i.ce=function(l){return[Math.pow(l[0],1/2.2),Math.pow(l[1],1/2.2),Math.pow(l[2],1/2.2)]},i.cf=function(l,t){return l.readFields(uO,{icons:[]},t)},i.cg=function(l){return l({pluginStatus:Jo,pluginURL:Fa}),Zd.on("pluginStateChange",l),l},i.ch=Py,i.ci=yf,i.cj=Pb,i.ck=eo,i.cl=um,i.cm=Ut,i.cn=Rs,i.co=_i,i.cp=function(l){const t=l.indexOf(ph);return t>=0?l.slice(0,t):l},i.cq=function(l){return l.indexOf(ph)>=0},i.cr=function(l){const t=l.indexOf(ph);return t>=0?l.slice(t+1):""},i.cs=function(l){const t=[],o=l.id;return o===void 0&&t.push({message:`layers.${o}: missing required property "id"`}),l.render===void 0&&t.push({message:`layers.${o}: missing required method "render"`}),l.renderingMode&&l.renderingMode!=="2d"&&l.renderingMode!=="3d"&&t.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),t},i.ct=function(l,t,o,u){return l.type==="custom"?new YD(l,t):new sO[l.type](l,t,o,u)},i.cu=zo,i.cv=class extends Pf{constructor(l,t){super(l._vectorTileFeature,l._z,l._x,l._y,l.id),l.state&&(this.state={...l.state}),this.target=t.target,this.namespace=t.namespace,t.properties&&(this.properties=t.properties)}toJSON(){const l=super.toJSON();return l.target=this.target,l.namespace=this.namespace,l}},i.cw=Zd,i.cx=Si,i.cy=cf,i.cz=class extends Na{constructor(l){super(l),this.current=eb}set(l,t,o){if(this.fetchUniformLocation(l,t)){for(let u=0;u<9;u++)if(o[u]!==this.current[u]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}}},i.d=function(l){return K.API_TILEJSON_REGEX.test(l)},i.d$=Jn,i.d0=(l,t,o,u,m,h,g,b,E)=>{const A=l.transform,v=A.calculatePixelsToTileUnitsMatrix(t),C=o.paint.get("line-trim-color-use-theme").constantOr("default")==="none",I=A.pitch<15?pC(.07,.7,Jt((14-A.zoom)/5,0,1)):.07;return{u_matrix:gC(l,t,o,u),u_pixels_to_tile_units:v,u_device_pixel_ratio:h,u_width_scale:g,u_floor_width_scale:b,u_units_to_pixels:[1/A.pixelsToGLUnits[0],1/A.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:m,u_texsize:yC(o)&&t.lineAtlasTexture?t.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:mC(t,l.transform),u_alpha_discard_threshold:0,u_trim_offset:E,u_trim_fade_range:o.paint.get("line-trim-fade-range"),u_trim_color:o.paint.get("line-trim-color").toRenderColor(C?null:o.lut).toArray01(),u_emissive_strength:o.paint.get("line-emissive-strength"),u_zbias_factor:I,u_tile_to_meter:p(t.tileID.canonical,0)}},i.d1=Ji,i.d2=Om,i.d3=iC,i.d4=wr,i.d5=iy,i.d6=ou,i.d7=450,i.d8=7,i.d9=XD,i.dA=fr,i.dB=s,i.dC=hc,i.dD=function([l,t,o]){const u=Math.hypot(l,t,o),m=Math.atan2(l,o),h=.5*Math.PI-Math.acos(-t/u);return new rn(tn(m),tn(h))},i.dE=Vb,i.dF=function(l){const t=l.navigator?l.navigator.userAgent:null;return!!function(o){if(pi==null){const u=o.navigator?o.navigator.userAgent:null;pi=!!o.safari||!(!u||!(/\b(iPad|iPhone|iPod)\b/.test(u)||u.match("Safari")&&!u.match("Chrome")))}return pi}(l)&&t&&(t.match("Version/15.4")||t.match("Version/15.5")||t.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},i.dG=function(l,t){Gt=l,Xt=t},i.dH=qs,i.dI=ua,i.dJ=function(l){const t=[0,0,0],o=Ae.mat4.identity(new Float64Array(16));return Ae.mat4.multiply(o,l.pixelMatrix,l.globeMatrix),Ae.vec3.transformMat4(t,t,o),new wt(t[0],t[1])},i.dK=function(l,t,o=!1){if(Jo===cs||Jo===lm||Jo===cm)throw new Error("setRTLTextPlugin cannot be called multiple times.");Fa=pt.resolveURL(l),Jo=cs,qd=t,Gc(),o||C0()},i.dL=hm,i.dM=function(){Py().acquire(Zb)},i.dN=function(){const l=og;l&&(l.isPreloaded()&&l.numActive()===1?(l.release(Zb),og=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},i.dO=Ph,i.dP=function(l){const t=Vr();if(!t)return;const o=t.delete(tr);l&&o.catch(l).then(()=>l())},i.dQ=ig,i.dR=cM,i.dS=function(l){ow=pt.resolveURL(l),If||(If=new Sf(Py(),new lo)),If.broadcast("setDracoUrl",ow)},i.dT=uM,i.dU=function(l){Mf=pt.resolveURL(l),If||(If=new Sf(Py(),new lo)),If.broadcast("setMeshoptUrl",Mf)},i.dV=Yt,i.dW=iu,i.dX=Xs,i.dY=vM,i.dZ=xM,i.d_=uC,i.da=on,i.db=nf,i.dc=256,i.dd=ca,i.de=Sl,i.df=Cl,i.dg=bm,i.dh=function(l,t,o,u,m){return Jt((l-t)/(o-t)*(m-u)+u,u,m)},i.di=f0,i.dj=n,i.dk=class{constructor(l,t,o,u){this.context=l,this.format=u,this.size=o,this.texture=l.gl.createTexture();const[m,h,g]=this.size,{gl:b}=l;b.bindTexture(b.TEXTURE_3D,this.texture),l.pixelStoreUnpackFlipY.set(!1),l.pixelStoreUnpack.set(1),l.pixelStoreUnpackPremultiplyAlpha.set(!1),b.texImage3D(b.TEXTURE_3D,0,this.format,m,h,g,0,Bb(this.format),Nb(this.format),t.data)}bind(l,t){const{context:o}=this,{gl:u}=o;u.bindTexture(u.TEXTURE_3D,this.texture),l!==this.minFilter&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MAG_FILTER,l),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_MIN_FILTER,l),this.minFilter=l),t!==this.wrapS&&(u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_S,t),u.texParameteri(u.TEXTURE_3D,u.TEXTURE_WRAP_T,t),this.wrapS=t)}destroy(){const{gl:l}=this.context;l.deleteTexture(this.texture),this.texture=null}},i.dl=Ub,i.dm=[1,1,1],i.dn=wf,i.dp=bf,i.dq=Tl,i.dr=Us,i.ds=nu,i.dt=Sm,i.du=wm,i.dv=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new wt(1/0,1/0),max:new wt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(l,t=!1){const o=$T(new wt(0,0),new wt(Nt,Nt),l),u=[];if(t&&!pb(o,this._globalClipBounds))return u;for(const m of this._activeRegions){if(m.hiddenByOverlap||!pb(o,m))continue;const h=Hk(m.min,m.max,l);u.push({min:h.min,max:h.max,sourceId:this._sourceIds[m.priority],footprint:m.footprint,footprintTileId:m.tileId,order:m.order,clipMask:m.clipMask,clipScope:m.clipScope})}return u}setSources(l){this._setSources(l.map(t=>({getSourceId:()=>t.cache.id,getFootprints:()=>{const o=[];for(const u of t.cache.getVisibleCoordinates()){const m=t.cache.getTile(u).buckets[t.layer];m&&m.updateFootprints(u.toUnwrapped(),o)}return o},getOrder:()=>t.order,getClipMask:()=>t.clipMask,getClipScope:()=>t.clipScope})))}_addSource(l){const t=l.getFootprints();if(t.length===0)return;const o=l.getOrder(),u=l.getClipMask(),m=l.getClipScope();for(const h of t){if(!h.footprint)continue;const g=$T(h.footprint.min,h.footprint.max,h.id);this._activeRegions.push({min:g.min,max:g.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:h.id,footprint:h.footprint,order:o,clipMask:u,clipScope:m})}this._sourceIds.push(l.getSourceId())}_computeReplacement(){this._activeRegions.sort((t,o)=>t.priority-o.priority||ry(t.min,o.min)||ry(t.max,o.max)||t.order-o.order||t.clipMask-o.clipMask||function(u,m){const h=(g,b)=>g+b;return u.length-m.length||u.reduce(h,"").localeCompare(m.reduce(h,""))}(t.clipScope,o.clipScope));let l=this._activeRegions.length!==this._prevRegions.length;if(!l){let t=0;for(;!l&&t!==this._activeRegions.length;){const o=this._activeRegions[t],u=this._prevRegions[t];l=o.priority!==u.priority||!jT(o,u)||o.order!==u.order||o.clipMask!==u.clipMask||!Pr(o.clipScope,u.clipScope),++t}}if(l){++this._updateTime;for(const o of this._activeRegions)o.order!==ty&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,o.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,o.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,o.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,o.max.y));const t=o=>{const u=this._activeRegions;if(o>=u.length)return o;const m=u[o].priority;for(;o<u.length&&u[o].priority===m;)++o;return o};if(this._sourceIds.length>1){let o=0,u=t(o);for(;o!==u;){let m=o;const h=o;for(;m!==u;){const g=this._activeRegions[m];g.hiddenByOverlap=!1;for(let b=0;b<h;b++){const E=this._activeRegions[b];if(!E.hiddenByOverlap&&g.order===ty&&pb(g,E)&&(g.hiddenByOverlap=UT(g.footprint,g.tileId,E.footprint,E.tileId),g.hiddenByOverlap))break}++m}o=u,u=t(o)}}}}_setSources(l){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let t=l.length-1;t>=0;t--)this._addSource(l[t]);this._computeReplacement()}},i.dw=class{constructor(l){this._createGrid(l),this._createPoles(l)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const l of this._poleSegments)l.destroy();for(const l of this._gridSegments)l.withSkirts.destroy(),l.withoutSkirts.destroy()}_fillGridMeshWithLods(l,t){const o=new $s,u=new no,m=[],h=l+1+2,g=t[0]+1,b=t[0]+1+(1+t.length),E=(A,v,C)=>{let I=A===h-1?A-2:A===0?A:A-1;return I+=C?24575:0,[I,v]};for(let A=0;A<h;++A)o.emplaceBack(...E(A,0,!0));for(let A=0;A<g;++A)for(let v=0;v<h;++v)o.emplaceBack(...E(v,A,(v===0||v===h-1)&&!0));for(let A=0;A<t.length;++A){const v=t[A];for(let C=0;C<h;++C)o.emplaceBack(...E(C,v,!0))}for(let A=0;A<t.length;++A){const v=u.length,C=t[A]+1+2,I=new no;for(let R=0;R<C-1;R++){const O=R===C-2,F=O?h*(b-t.length+A-R):h;for(let H=0;H<h-1;H++){const W=R*h+H;R===0||O||H===0||H===h-2?(I.emplaceBack(W+1,W,W+F),I.emplaceBack(W+F,W+F+1,W+1)):(u.emplaceBack(W+1,W,W+F),u.emplaceBack(W+F,W+F+1,W+1))}}const S=ri.simpleSegment(0,v,o.length,u.length-v);for(let R=0;R<I.uint16.length;R+=3)u.emplaceBack(I.uint16[R],I.uint16[R+1],I.uint16[R+2]);const M=ri.simpleSegment(0,v,o.length,u.length-v);m.push({withoutSkirts:S,withSkirts:M})}return{vertices:o,indices:u,segments:m}}_createGrid(l){const t=this._fillGridMeshWithLods(cc,Rm);this._gridSegments=t.segments,this._gridBuffer=l.createVertexBuffer(t.vertices,Jr.members),this._gridIndexBuffer=l.createIndexBuffer(t.indices,!0)}_createPoles(l){const t=new no;for(let g=0;g<=cc;g++)t.emplaceBack(0,g+1,g+2);this._poleIndexBuffer=l.createIndexBuffer(t,!0);const o=new Cl,u=new Cl,m=new Cl,h=new Cl;this._poleSegments=[];for(let g=0,b=0;g<Pm;g++){const E=360/(1<<g);o.emplaceBack(0,-fo,0,.5,0),u.emplaceBack(0,-fo,0,.5,1),m.emplaceBack(0,-fo,0,.5,.5),h.emplaceBack(0,-fo,0,.5,.5);for(let A=0;A<=cc;A++){let v=A/cc,C=0;const I=ur(0,E,v),[S,M,R]=uc(dc,Eh,I,fo);o.emplaceBack(S,M,R,v,C),u.emplaceBack(S,M,R,v,1-C);const O=ar(I);v=.5+.5*Math.sin(O),C=.5+.5*Math.cos(O),m.emplaceBack(S,M,R,v,C),h.emplaceBack(S,M,R,v,1-C)}this._poleSegments.push(ri.simpleSegment(b,0,66,64)),b+=66}this._poleNorthVertexBuffer=l.createVertexBuffer(o,sr,!1),this._poleSouthVertexBuffer=l.createVertexBuffer(u,sr,!1),this._texturedPoleNorthVertexBuffer=l.createVertexBuffer(m,sr,!1),this._texturedPoleSouthVertexBuffer=l.createVertexBuffer(h,sr,!1)}getGridBuffers(l,t){return[this._gridBuffer,this._gridIndexBuffer,t?this._gridSegments[l].withSkirts:this._gridSegments[l].withoutSkirts]}getPoleBuffers(l,t){return[t?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,t?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[l]]}},i.dx=ty,i.dy=hn,i.dz=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},i.e=K,i.e0=Xl,i.e1=NC,i.e2=function(l,t,o,u,m,h,g,b,E,A,v=1,C,I){l.createArrays(),l.tilePixelRatio=Nt/(512*l.overscaling),l.compareText={},l.iconsNeedLinear=!1;const S=l.layers[0].layout,M=l.layers[0]._unevaluatedLayout._values,R={};R.scaleFactor=v,R.textSizeScaleRange=S.get("text-size-scale-range"),R.iconSizeScaleRange=S.get("icon-size-scale-range");const[O,F]=R.textSizeScaleRange,[H,W]=R.iconSizeScaleRange;if(R.textScaleFactor=Jt(R.scaleFactor,O,F),R.iconScaleFactor=Jt(R.scaleFactor,H,W),l.textSizeData.kind==="composite"){const{minZoom:ne,maxZoom:ye}=l.textSizeData;R.compositeTextSizes=[M["text-size"].possiblyEvaluate(new Vn(ne),b),M["text-size"].possiblyEvaluate(new Vn(ye),b)]}if(l.iconSizeData.kind==="composite"){const{minZoom:ne,maxZoom:ye}=l.iconSizeData;R.compositeIconSizes=[M["icon-size"].possiblyEvaluate(new Vn(ne),b),M["icon-size"].possiblyEvaluate(new Vn(ye),b)]}R.layoutTextSize=M["text-size"].possiblyEvaluate(new Vn(E+1),b),R.layoutIconSize=M["icon-size"].possiblyEvaluate(new Vn(E+1),b),R.textMaxSize=M["text-size"].possiblyEvaluate(new Vn(18),b);const V=S.get("text-rotation-alignment")==="map"&&S.get("symbol-placement")!=="point",Z=S.get("text-size");let Y=!1;for(const ne of l.features)if(ne.icon&&ne.icon.nameSecondary){Y=!0;break}for(const ne of l.features){const ye=S.get("text-font").evaluate(ne,{},b).join(","),_e=Z.evaluate(ne,{},b)*R.textScaleFactor,ge=R.layoutTextSize.evaluate(ne,{},b)*R.textScaleFactor,Re=(R.layoutIconSize.evaluate(ne,{},b),{horizontal:{},vertical:void 0}),we=ne.text;let Le,Be=[0,0];if(we){const Qe=we.toString(),Ge=S.get("text-letter-spacing").evaluate(ne,{},b)*go,ut=S.get("text-line-height").evaluate(ne,{},b)*go,It=S0(Qe)?Ge:0,dt=S.get("text-anchor").evaluate(ne,{},b),Dt=S.get("text-variable-anchor");if(!Dt){const Ot=S.get("text-radial-offset").evaluate(ne,{},b);Be=Ot?HC(dt,[Ot*go,Ab]):S.get("text-offset").evaluate(ne,{},b).map(Kt=>Kt*go)}let kt=V?"center":S.get("text-justify").evaluate(ne,{},b);const $t=S.get("symbol-placement")==="point",_t=$t?S.get("text-max-width").evaluate(ne,{},b)*go:1/0,er=Ot=>{l.allowVerticalPlacement&&Ud(Qe)&&(Re.vertical=Cb(we,t,o,m,ye,_t,ut,dt,Ot,It,Be,Va.vertical,!0,ge,_e))};if(!V&&Dt){const Ot=kt==="auto"?Dt.map(hr=>Rb(hr)):[kt];let Kt=!1;for(let hr=0;hr<Ot.length;hr++){const Ar=Ot[hr];if(!Re.horizontal[Ar])if(Kt)Re.horizontal[Ar]=Re.horizontal[0];else{const kr=Cb(we,t,o,m,ye,_t,ut,"center",Ar,It,Be,Va.horizontal,!1,ge,_e);kr&&(Re.horizontal[Ar]=kr,Kt=kr.positionedLines.length===1)}}er("left")}else{if(kt==="auto"&&(kt=Rb(dt)),$t||S.get("text-writing-mode").indexOf("horizontal")>=0||!Ud(Qe)){const Ot=Cb(we,t,o,m,ye,_t,ut,dt,kt,It,Be,Va.horizontal,!1,ge,_e);Ot&&(Re.horizontal[kt]=Ot)}er($t?"left":kt)}}let Oe=!1,Ve=!1;if(ne.icon&&ne.icon.namePrimary){const Qe=oy(l.iconSizeData,M["icon-size"],b,l.zoom,ne)*R.iconScaleFactor*C,Ge=ne.icon.getPrimary().scaleSelf(Qe).serialize(),ut=u[Ge];ut&&(Le=PD(m[Ge],ne.icon.nameSecondary?m[ne.icon.getSecondary().scaleSelf(Qe).serialize()]:void 0,S.get("icon-offset").evaluate(ne,{},b),S.get("icon-anchor").evaluate(ne,{},b)),Oe=ut.sdf,Ve=ut.usvg,l.sdfIcons===void 0?l.sdfIcons=ut.sdf:l.sdfIcons!==ut.sdf&&gr("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ut.pixelRatio!==l.pixelRatio||S.get("icon-rotate").constantOr(1)!==0)&&(l.iconsNeedLinear=!0))}const We=qC(Re.horizontal)||Re.vertical;l.iconsInText||(l.iconsInText=!!We&&We.iconsInText),(We||Le)&&OD(l,ne,Re,Le,u,R,ge,0,Be,Oe,Ve,g,b,A,I,Y)}h&&l.generateCollisionDebugBuffers(E,l.collisionBoxArray,R.textScaleFactor)},i.e3=mf,i.e4=Dy,i.e5=pn,i.e6=DT,i.e7=EC,i.e8=L,i.e9=function(l){let t=0;if(new Uint32Array(l,0,1)[0]!==dM){const o=new Uint32Array(l,0,7),[,,u,m,h,g]=o;t=o.byteLength+m+h+g+h,(u!==l.byteLength||t>=l.byteLength)&&gr("Invalid b3dm header information.")}return gM(l,t)},i.ea=function(l,t){const o=yM(l);for(const u of o){for(const m of u.meshes)hF(m);u.lights&&(u.lightMeshIndex=u.meshes.length,u.meshes.push(dF(u.lights,t)))}return o},i.eb=Iy,i.ec=k4,i.ed=Qo,i.ee=function(l){Gr(),Nr!=null&&Nr.then(t=>{t.keys().then(o=>{for(let u=0;u<o.length-l;u++)t.delete(o[u])})})},i.f=function(l){return l.indexOf("mapbox:")===0},i.g=function(l,t){return Si(dn(l,{method:"GET"}),t)},i.h=he,i.i=function(l){return K.API_STYLE_REGEX.test(l)&&!de(l)},i.j=function(l){return decodeURIComponent(atob(l).split("").map(t=>"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)).join(""))},i.k=function(l){return btoa(encodeURIComponent(l).replace(/%([0-9A-F]{2})/g,(t,o)=>String.fromCharCode(+("0x"+o))))},i.l=dn,i.m=ii,i.n=function(l,t){return Si(dn(l,{type:"json"}),t)},i.o=As,i.p=function(l,t){return Si(dn(l,{method:"POST"}),t)},i.q=pt,i.r=So,i.s=function(l){try{const t=self[l];return t.setItem("_mapbox_test_",1),t.removeItem("_mapbox_test_"),!0}catch{return!1}},i.t=ot,i.u=function(){return function l(t){return t?(t^Math.random()*(16>>t/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,l)}()},i.v=function(l){return!!l&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(l)},i.w=gr,i.x=function(){return Xb||(Xb=new Ph),Xb},i.y=ya,i.z=la}),x(["./shared"],function(i){function L(it){const te=it?it.url.toString():void 0;return te?performance.getEntriesByName(te):[]}function N(it){if(typeof it=="number"||typeof it=="boolean"||typeof it=="string"||it==null)return JSON.stringify(it);if(Array.isArray(it)){let le="[";for(const K of it)le+=`${N(K)},`;return`${le}]`}let te="{";for(const le of Object.keys(it).sort())te+=`${le}:${N(it[le])},`;return`${te}}`}function U(it){let te="";for(const le of i.bl)te+=`/${N(it[le])}`;return te}class q{constructor(te){this.keyCache={},this._layers={},this._layerConfigs={},te&&this.replace(te)}replace(te,le){this._layerConfigs={},this._layers={},this.update(te,[],le)}update(te,le,K){this._options=K;for(const de of te)this._layerConfigs[de.id]=de,(this._layers[de.id]=i.ct(de,this.scope,null,this._options)).compileFilter(K),this.keyCache[de.id]&&delete this.keyCache[de.id];for(const de of le)delete this.keyCache[de],delete this._layerConfigs[de],delete this._layers[de];this.familiesBySource={};const he=function(de,xe){const ke={};for(let He=0;He<de.length;He++){const Ue=de[He];let Ze=xe&&xe[Ue.id];!Ze&&(Ze=U(Ue),Ue.type==="line"&&Ue.paint)&&function pt(St){return typeof St=="string"&&St==="line-progress"||(Array.isArray(St)?St.some(pt):!(!St||typeof St!="object")&&Object.values(St).some(pt))}(Ue.paint["line-width"])&&(Ze+=`/${N(Ue.paint["line-width"])}`),xe&&(xe[Ue.id]=Ze);let ot=ke[Ze];ot||(ot=ke[Ze]=[]),ot.push(Ue)}const ze=[];for(const He in ke)ze.push(ke[He]);return ze}(i.bi(this._layerConfigs),this.keyCache);for(const de of he){const xe=de.map(ot=>this._layers[ot.id]),ke=xe[0];if(ke.visibility==="none")continue;const ze=ke.source||"";let He=this.familiesBySource[ze];He||(He=this.familiesBySource[ze]={});const Ue=ke.sourceLayer||"_geojsonTileLayer";let Ze=He[Ue];Ze||(Ze=He[Ue]=[]),Ze.push(xe)}}}const X=1*i.dX;class se{constructor(te){const le={},K=[];for(const ke in te){const ze=te[ke],He=le[ke]={};for(const Ue in ze.glyphs){const Ze=ze.glyphs[+Ue];if(!Ze||Ze.bitmap.width===0||Ze.bitmap.height===0)continue;const ot=Ze.metrics.localGlyph?X:1,pt={x:0,y:0,w:Ze.bitmap.width+2*ot,h:Ze.bitmap.height+2*ot};K.push(pt),He[Ue]=pt}}const{w:he,h:de}=i.B(K),xe=new i.dW({width:he||1,height:de||1});for(const ke in te){const ze=te[ke];for(const He in ze.glyphs){const Ue=ze.glyphs[+He];if(!Ue||Ue.bitmap.width===0||Ue.bitmap.height===0)continue;const Ze=le[ke][He],ot=Ue.metrics.localGlyph?X:1;i.dW.copy(Ue.bitmap,xe,{x:0,y:0},{x:Ze.x+ot,y:Ze.y+ot},Ue.bitmap)}}this.image=xe,this.positions=le}}i.dV(se,"GlyphAtlas");class ce{constructor(te){this.tileID=new i.aF(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.tileZoom=te.tileZoom,this.uid=te.uid,this.zoom=te.zoom,this.lut=te.lut,this.canonical=te.tileID.canonical,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.scope=te.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=te.showCollisionBoxes,this.collectResourceTiming=!!te.request&&te.request.collectResourceTiming,this.promoteId=te.promoteId,this.isSymbolTile=te.isSymbolTile,this.tileTransform=i.aP(te.tileID.canonical,te.projection),this.projection=te.projection,this.worldview=te.worldview,this.localizableLayerIds=te.localizableLayerIds,this.brightness=te.brightness,this.extraShadowCaster=!!te.extraShadowCaster,this.tessellationStep=te.tessellationStep,this.scaleFactor=te.scaleFactor}parse(te,le,K,he,de){this.status="parsing",this.data=te,this.collisionBoxArray=new i.aV;const xe=new i.dY(Object.keys(te.layers).sort()),ke=new i.dZ(this.tileID,this.promoteId);ke.bucketLayerIDs=[];const ze={},He=new i.d_(256,256),Ue={featureIndex:ke,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:He,availableImages:K,brightness:this.brightness,scaleFactor:this.scaleFactor},Ze=le.familiesBySource[this.source];for(const Xt in Ze){const vr=te.layers[Xt];if(!vr)continue;let Nr=!1,dr=!1,Vr=!1;for(const ii of Ze[Xt])ii[0].type==="symbol"?Nr=!0:dr=!0,ii[0].is3D()&&ii[0].type!=="model"&&(Vr=!0);if(this.extraShadowCaster&&!Vr||this.isSymbolTile===!0&&!Nr||this.isSymbolTile===!1&&!dr)continue;vr.version===1&&i.w(`Vector tile source "${this.source}" layer "${Xt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Gr=xe.encode(Xt),In=[];for(let ii=0,$n=0;ii<vr.length;ii++){const Qn=vr.feature(ii),so=ke.getId(Qn,Xt);if(this.localizableLayerIds&&this.localizableLayerIds.has(Xt)){const Yr=Qn.properties?Qn.properties.worldview:null;if(this.worldview&&typeof Yr=="string")if(Yr==="all")Qn.properties.$localized=!0;else{if(!Yr.split(",").includes(this.worldview))continue;Qn.properties.$localized=!0,Qn.properties.worldview=this.worldview}}In.push({feature:Qn,id:so,index:$n,sourceLayerIndex:Gr}),$n++}for(const ii of Ze[Xt]){const $n=ii[0];(!this.extraShadowCaster||$n.is3D()&&$n.type!=="model")&&(this.isSymbolTile!==void 0&&$n.type==="symbol"!==this.isSymbolTile||$n.minzoom&&this.zoom<Math.floor($n.minzoom)||$n.maxzoom&&this.zoom>=$n.maxzoom||$n.visibility!=="none"&&(ue(ii,this.zoom,Ue.brightness,K),(ze[$n.id]=$n.createBucket({index:ke.bucketLayerIDs.length,layers:ii,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Gr,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep})).populate(In,Ue,this.tileID.canonical,this.tileTransform),ke.bucketLayerIDs.push(ii.map(Qn=>i.aB(Qn.id,Qn.scope)))))}}let ot,pt,St,Ut;He.trim();const tr={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},Gt=()=>{if(ot)return this.status="done",de(ot);if(this.extraShadowCaster)this.status="done",de(null,{buckets:i.bi(ze).filter(Xt=>!Xt.isEmpty()),featureIndex:ke,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Ue.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(pt&&St&&Ut){const Xt=new se(pt),vr=new i.e1(St,Ut,this.lut);for(const Nr in ze){const dr=ze[Nr];dr instanceof i.aW?(ue(dr.layers,this.zoom,Ue.brightness,K),i.e2(dr,pt,Xt.positions,St,vr.iconPositions,this.showCollisionBoxes,K,this.tileID.canonical,this.tileZoom,this.projection,this.scaleFactor,this.pixelRatio,this.brightness)):dr.hasPattern&&(dr instanceof i.b0||dr instanceof i.b1||dr instanceof i.d5)&&(ue(dr.layers,this.zoom,Ue.brightness,K),dr.addFeatures(Ue,this.tileID.canonical,vr.patternPositions,K,this.tileTransform,this.brightness))}this.status="done",de(null,{buckets:i.bi(ze).filter(Nr=>!Nr.isEmpty()),featureIndex:ke,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Xt.image,lineAtlas:He,imageAtlas:vr,brightness:Ue.brightness})}};if(!this.extraShadowCaster){const Xt=i.d$(Ue.glyphDependencies,dr=>Object.keys(dr).map(Number));Object.keys(Xt).length?he.send("getGlyphs",{uid:this.uid,stacks:Xt,scope:this.scope},(dr,Vr)=>{ot||(ot=dr,pt=Vr,Gt())},void 0,!1,tr):pt={};const vr=Object.keys(Ue.iconDependencies);vr.length?he.send("getImages",{icons:vr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(dr,Vr)=>{if(ot)return;ot=dr;const Gr={};Object.values(Vr).some(In=>In.usvg)?this.rasterize(he,Gr,Vr,Ue.iconDependencies,()=>{St=Gr,Gt()}):(this.fillImageMap(Gr,Ue.iconDependencies,Vr),St=Gr,Gt())},void 0,!1,tr):St={};const Nr=Object.keys(Ue.patternDependencies);Nr.length?he.send("getImages",{icons:Nr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(dr,Vr)=>{if(!ot){ot=dr;const Gr={};Object.values(Vr).some(In=>In.usvg)?this.rasterize(he,Gr,Vr,Ue.patternDependencies,()=>{Ut=Gr,Gt()}):(this.fillImageMap(Gr,Ue.patternDependencies,Vr),Ut=Gr,Gt())}},void 0,!1,tr):Ut={}}Gt()}fillImageMap(te,le,K){for(const he in K){const de=le[he]||[];for(const xe of de)K[xe.id].usvg||(te[xe.serialize()]=K[xe.id])}}getImageTaskQueue(te,le,K){const he={};for(const de in le){const xe=K[de]||[];for(const ke of xe){const ze=ke.serialize();le[ke.id].usvg?he[ze]||(he[ze]=ke):te[ze]=le[ke.id]}}return he}rasterize(te,le,K,he,de){const xe=this.getImageTaskQueue(le,K,he);this.rasterizeTask=te.send("rasterizeImages",{scope:this.scope,imageTasks:xe},(ke,ze)=>{if(!ke)for(const He in ze){const{id:Ue}=i.e0.deserializeFromString(He);le[He]={...K[Ue],data:ze[He]}}de()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function ue(it,te,le,K){const he=new i.a7(te,{brightness:le});for(const de of it)de.recalculate(he,K)}class fe extends i.E{constructor(te,le,K,he,de,xe){super(),this.actor=te,this.layerIndex=le,this.availableImages=K,this.loadVectorData=de||i.aC,this.loading={},this.loaded={},this.deduped=new i.aA(te.scheduler),this.isSpriteLoaded=he,this.scheduler=te.scheduler,this.brightness=xe}loadTile(te,le){const K=te.uid,he=te&&te.request,de=he&&he.collectResourceTiming,xe=this.loading[K]=new ce(te);xe.abort=this.loadVectorData(te,(ke,ze)=>{const He=!this.loading[K];if(delete this.loading[K],xe.cancelRasterize(),He||ke||!ze)return xe.status="done",He||(this.loaded[K]=xe),le(ke);const Ue=ze.rawData,Ze={};ze.expires&&(Ze.expires=ze.expires),ze.cacheControl&&(Ze.cacheControl=ze.cacheControl),xe.vectorTile=ze.vectorTile||new i.e3.VectorTile(new i.bg(Ue));const ot=()=>{xe.parse(xe.vectorTile,this.layerIndex,this.availableImages,this.actor,(pt,St)=>{if(pt||!St)return le(pt);const Ut={};if(de){const tr=L(he);tr.length>0&&(Ut.resourceTiming=JSON.parse(JSON.stringify(tr)))}le(null,i.l({rawTileData:Ue.slice(0)},St,Ze,Ut))})};this.isSpriteLoaded?ot():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(ot,{type:"parseTile",isSymbolTile:te.isSymbolTile,zoom:te.tileZoom}):ot()}),this.loaded=this.loaded||{},this.loaded[K]=xe})}reloadTile(te,le){const K=this.loaded,he=te.uid;if(K&&K[he]){const de=K[he];de.scaleFactor=te.scaleFactor,de.showCollisionBoxes=te.showCollisionBoxes,de.projection=te.projection,de.brightness=te.brightness,de.tileTransform=i.aP(te.tileID.canonical,te.projection),de.extraShadowCaster=te.extraShadowCaster,de.lut=te.lut;const xe=(ke,ze)=>{const He=de.reloadCallback;He&&(delete de.reloadCallback,de.parse(de.vectorTile,this.layerIndex,this.availableImages,this.actor,He)),le(ke,ze)};de.status==="parsing"?de.reloadCallback=xe:de.status==="done"&&(de.vectorTile?de.parse(de.vectorTile,this.layerIndex,this.availableImages,this.actor,xe):xe())}else le(null,void 0)}abortTile(te,le){const K=te.uid,he=this.loading[K];he&&(he.abort&&he.abort(),delete this.loading[K]),le()}removeTile(te,le){const K=this.loaded,he=te.uid;K&&K[he]&&delete K[he],le()}}class re{loadTile(te,le){const{uid:K,encoding:he,rawImageData:de,padding:xe}=te,ke=ImageBitmap&&de instanceof ImageBitmap?this.getImageData(de,xe):de;le(null,new i.e4(K,ke,he,xe<1))}getImageData(te,le){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(te.width,te.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=te.width,this.offscreenCanvas.height=te.height,this.offscreenCanvasContext.drawImage(te,0,0,te.width,te.height);const K=this.offscreenCanvasContext.getImageData(-le,-le,te.width+2*le,te.height+2*le);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),K}}i.bf.setPbf(i.bg);class ee{decodeRasterArray({task:te,buffer:le},K){i.bf.performDecoding(le,te).then(he=>{K(null,he)},he=>{K(he)})}}const ae=i.e3.VectorTileFeature.prototype.toGeoJSON;class ve{constructor(te){this._feature=te,this.extent=i.af,this.type=te.type,this.properties=te.tags,"id"in te&&!isNaN(te.id)&&(this.id=parseInt(te.id,10))}loadGeometry(){if(this._feature.type===1){const te=[];for(const le of this._feature.geometry)te.push([new i.P(le[0],le[1])]);return te}{const te=[];for(const le of this._feature.geometry){const K=[];for(const he of le)K.push(new i.P(he[0],he[1]));te.push(K)}return te}}toGeoJSON(te,le,K){return ae.call(this,te,le,K)}}class Te{constructor(te){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=i.af,this.length=te.length,this._features=te}feature(te){return new ve(this._features[te])}}const pe=64/4096,Ee=128;class Ne{constructor(){this.features=new Map}clear(){this.features.clear()}load(te=[],le){for(const K of te){const he=K.id;if(he==null)continue;let de=this.features.get(he);de&&this.updateCache(de,le),K.geometry?(de=Fe(K),this.updateCache(de,le),this.features.set(he,de)):this.features.delete(he),this.updateCache(de,le)}}updateCache(te,le){for(const{canonical:K,uid:he}of Object.values(le)){const{z:de,x:xe,y:ke}=K;Xe(te,Math.pow(2,de),xe,ke)&&delete le[he]}}getTile(te,le,K){const he=Math.pow(2,te),de=[];for(const xe of this.features.values())Xe(xe,he,le,K)&&de.push(yt(xe,he,le,K));return{features:de}}getFeatures(){return[...this.features.values()]}}function Xe({minX:it,minY:te,maxX:le,maxY:K},he,de,xe){return it<(de+1+pe)/he&&te<(xe+1+pe)/he&&le>(de-pe)/he&&K>(xe-pe)/he}function Fe(it){const{id:te,geometry:le,properties:K}=it;if(!le)return;if(le.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:he,coordinates:de}=le,xe={id:te,type:1,geometry:[],tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},ke=xe.geometry;if(he==="Point")Je(de,ke,xe);else if(he==="MultiPoint")for(const ze of de)Je(ze,ke,xe);else if(he==="LineString")xe.type=2,Ct(de,ke,xe);else if(he==="MultiLineString")xe.type=2,ft(de,ke,xe);else if(he==="Polygon")xe.type=3,ft(de,ke,xe,!0);else{if(he!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");xe.type=3;for(const ze of de)ft(ze,ke,xe,!0)}return xe}function Je([it,te],le,K){const he=i.as(it);let de=i.az(te);de=de<0?0:de>1?1:de,le.push(he,de),K.minX=Math.min(K.minX,he),K.minY=Math.min(K.minY,de),K.maxX=Math.max(K.maxX,he),K.maxY=Math.max(K.maxY,de)}function Ct(it,te,le,K=!1,he=!1){const de=[];for(const xe of it)Je(xe,de,le);te.push(de),K&&function(xe,ke){let ze=0;for(let He=0,Ue=xe.length,Ze=Ue-2;He<Ue;Ze=He,He+=2)ze+=(xe[He]-xe[Ze])*(xe[He+1]+xe[Ze+1]);if(ze>0===ke)for(let He=0,Ue=xe.length;He<Ue/2;He+=2){const Ze=xe[He],ot=xe[He+1];xe[He]=xe[Ue-2-He],xe[He+1]=xe[Ue-1-He],xe[Ue-2-He]=Ze,xe[Ue-1-He]=ot}}(de,he)}function ft(it,te,le,K=!1){for(let he=0;he<it.length;he++)Ct(it[he],te,le,K,he===0)}function yt(it,te,le,K){const{id:he,type:de,geometry:xe,tags:ke}=it,ze=[];if(de===1)(function(He,Ue,Ze,ot,pt){for(let St=0;St<He.length;St+=2){const Ut=Math.round(i.af*(He[St+0]*Ue-Ze)),tr=Math.round(i.af*(He[St+1]*Ue-ot));pt.push([Ut,tr])}})(xe,te,le,K,ze);else for(const He of xe)lt(He,te,le,K,ze);return{id:he,type:de,geometry:ze,tags:ke}}function lt(it,te,le,K,he){const de=-Ee,xe=i.af+Ee;let ke;for(let ze=0;ze<it.length-2;ze+=2){let He=Math.round(i.af*(it[ze+0]*te-le)),Ue=Math.round(i.af*(it[ze+1]*te-K)),Ze=Math.round(i.af*(it[ze+2]*te-le)),ot=Math.round(i.af*(it[ze+3]*te-K));const pt=Ze-He,St=ot-Ue;He<de&&Ze<de||(He<de?(Ue+=Math.round(St*((de-He)/pt)),He=de):Ze<de&&(ot=Ue+Math.round(St*((de-He)/pt)),Ze=de),Ue<de&&ot<de||(Ue<de?(He+=Math.round(pt*((de-Ue)/St)),Ue=de):ot<de&&(Ze=He+Math.round(pt*((de-Ue)/St)),ot=de),He>=xe&&Ze>=xe||(He>=xe?(Ue+=Math.round(St*((xe-He)/pt)),He=xe):Ze>=xe&&(ot=Ue+Math.round(St*((xe-He)/pt)),Ze=xe),Ue>=xe&&ot>=xe||(Ue>=xe?(He+=Math.round(pt*((xe-Ue)/St)),Ue=xe):ot>=xe&&(Ze=He+Math.round(pt*((xe-Ue)/St)),ot=xe),ke&&He===ke[ke.length-1][0]&&Ue===ke[ke.length-1][1]||(ke=[[He,Ue]],he.push(ke)),ke.push([Ze,ot])))))}}var ct,Ye,Ke,tt={exports:{}},ht=function(){if(Ke)return tt.exports;Ke=1;var it=i.e7(),te=function(){if(Ye)return ct;Ye=1;var Ue=i.e5(),Ze=i.e6().VectorTileFeature;function ot(St,Ut){this.options=Ut||{},this.features=St,this.length=St.length}function pt(St,Ut){this.id=typeof St.id=="number"?St.id:void 0,this.type=St.type,this.rawGeometry=St.type===1?[St.geometry]:St.geometry,this.properties=St.tags,this.extent=Ut||4096}return ct=ot,ot.prototype.feature=function(St){return new pt(this.features[St],this.options.extent)},pt.prototype.loadGeometry=function(){var St=this.rawGeometry;this.geometry=[];for(var Ut=0;Ut<St.length;Ut++){for(var tr=St[Ut],Gt=[],Xt=0;Xt<tr.length;Xt++)Gt.push(new Ue(tr[Xt][0],tr[Xt][1]));this.geometry.push(Gt)}return this.geometry},pt.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var St=this.geometry,Ut=1/0,tr=-1/0,Gt=1/0,Xt=-1/0,vr=0;vr<St.length;vr++)for(var Nr=St[vr],dr=0;dr<Nr.length;dr++){var Vr=Nr[dr];Ut=Math.min(Ut,Vr.x),tr=Math.max(tr,Vr.x),Gt=Math.min(Gt,Vr.y),Xt=Math.max(Xt,Vr.y)}return[Ut,Gt,tr,Xt]},pt.prototype.toGeoJSON=Ze.prototype.toGeoJSON,ct}();function le(Ue){var Ze=new it;return function(ot,pt){for(var St in ot.layers)pt.writeMessage(3,K,ot.layers[St])}(Ue,Ze),Ze.finish()}function K(Ue,Ze){var ot;Ze.writeVarintField(15,Ue.version||1),Ze.writeStringField(1,Ue.name||""),Ze.writeVarintField(5,Ue.extent||4096);var pt={keys:[],values:[],keycache:{},valuecache:{}};for(ot=0;ot<Ue.length;ot++)pt.feature=Ue.feature(ot),Ze.writeMessage(2,he,pt);var St=pt.keys;for(ot=0;ot<St.length;ot++)Ze.writeStringField(3,St[ot]);var Ut=pt.values;for(ot=0;ot<Ut.length;ot++)Ze.writeMessage(4,He,Ut[ot])}function he(Ue,Ze){var ot=Ue.feature;ot.id!==void 0&&Ze.writeVarintField(1,ot.id),Ze.writeMessage(2,de,Ue),Ze.writeVarintField(3,ot.type),Ze.writeMessage(4,ze,ot)}function de(Ue,Ze){var ot=Ue.feature,pt=Ue.keys,St=Ue.values,Ut=Ue.keycache,tr=Ue.valuecache;for(var Gt in ot.properties){var Xt=ot.properties[Gt],vr=Ut[Gt];if(Xt!==null){vr===void 0&&(pt.push(Gt),Ut[Gt]=vr=pt.length-1),Ze.writeVarint(vr);var Nr=typeof Xt;Nr!=="string"&&Nr!=="boolean"&&Nr!=="number"&&(Xt=JSON.stringify(Xt));var dr=Nr+":"+Xt,Vr=tr[dr];Vr===void 0&&(St.push(Xt),tr[dr]=Vr=St.length-1),Ze.writeVarint(Vr)}}}function xe(Ue,Ze){return(Ze<<3)+(7&Ue)}function ke(Ue){return Ue<<1^Ue>>31}function ze(Ue,Ze){for(var ot=Ue.loadGeometry(),pt=Ue.type,St=0,Ut=0,tr=ot.length,Gt=0;Gt<tr;Gt++){var Xt=ot[Gt],vr=1;pt===1&&(vr=Xt.length),Ze.writeVarint(xe(1,vr));for(var Nr=pt===3?Xt.length-1:Xt.length,dr=0;dr<Nr;dr++){dr===1&&pt!==1&&Ze.writeVarint(xe(2,Nr-1));var Vr=Xt[dr].x-St,Gr=Xt[dr].y-Ut;Ze.writeVarint(ke(Vr)),Ze.writeVarint(ke(Gr)),St+=Vr,Ut+=Gr}pt===3&&Ze.writeVarint(xe(7,1))}}function He(Ue,Ze){var ot=typeof Ue;ot==="string"?Ze.writeStringField(1,Ue):ot==="boolean"?Ze.writeBooleanField(7,Ue):ot==="number"&&(Ue%1!=0?Ze.writeDoubleField(3,Ue):Ue<0?Ze.writeSVarintField(6,Ue):Ze.writeVarintField(5,Ue))}return tt.exports=le,tt.exports.fromVectorTileJs=le,tt.exports.fromGeojsonVt=function(Ue,Ze){Ze=Ze||{};var ot={};for(var pt in Ue)ot[pt]=new te(Ue[pt].features,Ze),ot[pt].name=pt,ot[pt].version=Ze.version,ot[pt].extent=Ze.extent;return le({layers:ot})},tt.exports.GeoJSONWrapper=te,tt.exports}(),vt=i.e8(ht);const At={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:it=>it},Pt=Math.fround||(qt=new Float32Array(1),it=>(qt[0]=+it,qt[0]));var qt;const or=3,cr=5,Qt=6;class qr{constructor(te){this.options=Object.assign(Object.create(At),te),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(te){const{log:le,minZoom:K,maxZoom:he}=this.options;le&&console.time("total time");const de=`prepare ${te.length} points`;le&&console.time(de),this.points=te;const xe=[];for(let ze=0;ze<te.length;ze++){const He=te[ze];if(!He.geometry)continue;const[Ue,Ze]=He.geometry.coordinates,ot=Pt(Lr(Ue)),pt=Pt($r(Ze));xe.push(ot,pt,1/0,ze,-1,1),this.options.reduce&&xe.push(0)}let ke=this.trees[he+1]=this._createTree(xe);le&&console.timeEnd(de);for(let ze=he;ze>=K;ze--){const He=+Date.now();ke=this.trees[ze]=this._createTree(this._cluster(ke,ze)),le&&console.log("z%d: %d clusters in %dms",ze,ke.numItems,+Date.now()-He)}return le&&console.timeEnd("total time"),this}getClusters(te,le){let K=((te[0]+180)%360+360)%360-180;const he=Math.max(-90,Math.min(90,te[1]));let de=te[2]===180?180:((te[2]+180)%360+360)%360-180;const xe=Math.max(-90,Math.min(90,te[3]));if(te[2]-te[0]>=360)K=-180,de=180;else if(K>de){const Ze=this.getClusters([K,he,180,xe],le),ot=this.getClusters([-180,he,de,xe],le);return Ze.concat(ot)}const ke=this.trees[this._limitZoom(le)],ze=ke.range(Lr(K),$r(xe),Lr(de),$r(he)),He=ke.data,Ue=[];for(const Ze of ze){const ot=this.stride*Ze;Ue.push(He[ot+cr]>1?yr(He,ot,this.clusterProps):this.points[He[ot+or]])}return Ue}getChildren(te){const le=this._getOriginId(te),K=this._getOriginZoom(te),he="No cluster with the specified id.",de=this.trees[K];if(!de)throw new Error(he);const xe=de.data;if(le*this.stride>=xe.length)throw new Error(he);const ke=this.options.radius/(this.options.extent*Math.pow(2,K-1)),ze=de.within(xe[le*this.stride],xe[le*this.stride+1],ke),He=[];for(const Ue of ze){const Ze=Ue*this.stride;xe[Ze+4]===te&&He.push(xe[Ze+cr]>1?yr(xe,Ze,this.clusterProps):this.points[xe[Ze+or]])}if(He.length===0)throw new Error(he);return He}getLeaves(te,le,K){const he=[];return this._appendLeaves(he,te,le=le||10,K=K||0,0),he}getTile(te,le,K){const he=this.trees[this._limitZoom(te)],de=Math.pow(2,te),{extent:xe,radius:ke}=this.options,ze=ke/xe,He=(K-ze)/de,Ue=(K+1+ze)/de,Ze={features:[]};return this._addTileFeatures(he.range((le-ze)/de,He,(le+1+ze)/de,Ue),he.data,le,K,de,Ze),le===0&&this._addTileFeatures(he.range(1-ze/de,He,1,Ue),he.data,de,K,de,Ze),le===de-1&&this._addTileFeatures(he.range(0,He,ze/de,Ue),he.data,-1,K,de,Ze),Ze.features.length?Ze:null}getClusterExpansionZoom(te){let le=this._getOriginZoom(te)-1;for(;le<=this.options.maxZoom;){const K=this.getChildren(te);if(le++,K.length!==1)break;te=K[0].properties.cluster_id}return le}_appendLeaves(te,le,K,he,de){const xe=this.getChildren(le);for(const ke of xe){const ze=ke.properties;if(ze&&ze.cluster?de+ze.point_count<=he?de+=ze.point_count:de=this._appendLeaves(te,ze.cluster_id,K,he,de):de<he?de++:te.push(ke),te.length===K)break}return de}_createTree(te){const le=new i.bD(te.length/this.stride|0,this.options.nodeSize,Float32Array);for(let K=0;K<te.length;K+=this.stride)le.add(te[K],te[K+1]);return le.finish(),le.data=te,le}_addTileFeatures(te,le,K,he,de,xe){for(const ke of te){const ze=ke*this.stride,He=le[ze+cr]>1;let Ue,Ze,ot;if(He)Ue=Ae(le,ze,this.clusterProps),Ze=le[ze],ot=le[ze+1];else{const Ut=this.points[le[ze+or]];Ue=Ut.properties;const[tr,Gt]=Ut.geometry.coordinates;Ze=Lr(tr),ot=$r(Gt)}const pt={type:1,geometry:[[Math.round(this.options.extent*(Ze*de-K)),Math.round(this.options.extent*(ot*de-he))]],tags:Ue};let St;St=He||this.options.generateId?le[ze+or]:this.points[le[ze+or]].id,St!==void 0&&(pt.id=St),xe.features.push(pt)}}_limitZoom(te){return Math.max(this.options.minZoom,Math.min(Math.floor(+te),this.options.maxZoom+1))}_cluster(te,le){const{radius:K,extent:he,reduce:de,minPoints:xe}=this.options,ke=K/(he*Math.pow(2,le)),ze=te.data,He=[],Ue=this.stride;for(let Ze=0;Ze<ze.length;Ze+=Ue){if(ze[Ze+2]<=le)continue;ze[Ze+2]=le;const ot=ze[Ze],pt=ze[Ze+1],St=te.within(ze[Ze],ze[Ze+1],ke),Ut=ze[Ze+cr];let tr=Ut;for(const Gt of St){const Xt=Gt*Ue;ze[Xt+2]>le&&(tr+=ze[Xt+cr])}if(tr>Ut&&tr>=xe){let Gt,Xt=ot*Ut,vr=pt*Ut,Nr=-1;const dr=(Ze/Ue<<5)+(le+1)+this.points.length;for(const Vr of St){const Gr=Vr*Ue;if(ze[Gr+2]<=le)continue;ze[Gr+2]=le;const In=ze[Gr+cr];Xt+=ze[Gr]*In,vr+=ze[Gr+1]*In,ze[Gr+4]=dr,de&&(Gt||(Gt=this._map(ze,Ze,!0),Nr=this.clusterProps.length,this.clusterProps.push(Gt)),de(Gt,this._map(ze,Gr)))}ze[Ze+4]=dr,He.push(Xt/tr,vr/tr,1/0,dr,-1,tr),de&&He.push(Nr)}else{for(let Gt=0;Gt<Ue;Gt++)He.push(ze[Ze+Gt]);if(tr>1)for(const Gt of St){const Xt=Gt*Ue;if(!(ze[Xt+2]<=le)){ze[Xt+2]=le;for(let vr=0;vr<Ue;vr++)He.push(ze[Xt+vr])}}}}return He}_getOriginId(te){return te-this.points.length>>5}_getOriginZoom(te){return(te-this.points.length)%32}_map(te,le,K){if(te[le+cr]>1){const xe=this.clusterProps[te[le+Qt]];return K?Object.assign({},xe):xe}const he=this.points[te[le+or]].properties,de=this.options.map(he);return K&&de===he?Object.assign({},de):de}}function yr(it,te,le){return{type:"Feature",id:it[te+or],properties:Ae(it,te,le),geometry:{type:"Point",coordinates:[(K=it[te],360*(K-.5)),pn(it[te+1])]}};var K}function Ae(it,te,le){const K=it[te+cr],he=K>=1e4?`${Math.round(K/1e3)}k`:K>=1e3?Math.round(K/100)/10+"k":K,de=it[te+Qt],xe=de===-1?{}:Object.assign({},le[de]);return Object.assign(xe,{cluster:!0,cluster_id:it[te+or],point_count:K,point_count_abbreviated:he})}function Lr(it){return it/360+.5}function $r(it){const te=Math.sin(it*Math.PI/180),le=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return le<0?0:le>1?1:le}function pn(it){const te=(180-360*it)*Math.PI/180;return 360*Math.atan(Math.exp(te))/Math.PI-90}function wt(it,te,le,K){let he=K;const de=te+(le-te>>1);let xe,ke=le-te;const ze=it[te],He=it[te+1],Ue=it[le],Ze=it[le+1];for(let ot=te+3;ot<le;ot+=3){const pt=Pr(it[ot],it[ot+1],ze,He,Ue,Ze);if(pt>he)xe=ot,he=pt;else if(pt===he){const St=Math.abs(ot-de);St<ke&&(xe=ot,ke=St)}}he>K&&(xe-te>3&&wt(it,te,xe,K),it[xe+2]=he,le-xe>3&&wt(it,xe,le,K))}function Pr(it,te,le,K,he,de){let xe=he-le,ke=de-K;if(xe!==0||ke!==0){const ze=((it-le)*xe+(te-K)*ke)/(xe*xe+ke*ke);ze>1?(le=he,K=de):ze>0&&(le+=xe*ze,K+=ke*ze)}return xe=it-le,ke=te-K,xe*xe+ke*ke}function Ur(it,te,le,K){const he={id:it??null,type:te,geometry:le,tags:K,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(te==="Point"||te==="MultiPoint"||te==="LineString")Un(he,le);else if(te==="Polygon")Un(he,le[0]);else if(te==="MultiLineString")for(const de of le)Un(he,de);else if(te==="MultiPolygon")for(const de of le)Un(he,de[0]);return he}function Un(it,te){for(let le=0;le<te.length;le+=3)it.minX=Math.min(it.minX,te[le]),it.minY=Math.min(it.minY,te[le+1]),it.maxX=Math.max(it.maxX,te[le]),it.maxY=Math.max(it.maxY,te[le+1])}function ar(it,te,le,K){if(!te.geometry)return;const he=te.geometry.coordinates;if(he&&he.length===0)return;const de=te.geometry.type,xe=Math.pow(le.tolerance/((1<<le.maxZoom)*le.extent),2);let ke=[],ze=te.id;if(le.promoteId?ze=te.properties[le.promoteId]:le.generateId&&(ze=K||0),de==="Point")tn(he,ke);else if(de==="MultiPoint")for(const He of he)tn(He,ke);else if(de==="LineString")Ln(he,ke,xe,!1);else if(de==="MultiLineString"){if(le.lineMetrics){for(const He of he)ke=[],Ln(He,ke,xe,!1),it.push(Ur(ze,"LineString",ke,te.properties));return}Xr(he,ke,xe,!1)}else if(de==="Polygon")Xr(he,ke,xe,!0);else{if(de!=="MultiPolygon"){if(de==="GeometryCollection"){for(const He of te.geometry.geometries)ar(it,{id:ze,geometry:He,properties:te.properties},le,K);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const He of he){const Ue=[];Xr(He,Ue,xe,!0),ke.push(Ue)}}it.push(Ur(ze,de,ke,te.properties))}function tn(it,te){te.push(hn(it[0]),fr(it[1]),0)}function Ln(it,te,le,K){let he,de,xe=0;for(let ze=0;ze<it.length;ze++){const He=hn(it[ze][0]),Ue=fr(it[ze][1]);te.push(He,Ue,0),ze>0&&(xe+=K?(he*Ue-He*de)/2:Math.sqrt(Math.pow(He-he,2)+Math.pow(Ue-de,2))),he=He,de=Ue}const ke=te.length-3;te[2]=1,wt(te,0,ke,le),te[ke+2]=1,te.size=Math.abs(xe),te.start=0,te.end=te.size}function Xr(it,te,le,K){for(let he=0;he<it.length;he++){const de=[];Ln(it[he],de,le,K),te.push(de)}}function hn(it){return it/360+.5}function fr(it){const te=Math.sin(it*Math.PI/180),le=.5-.25*Math.log((1+te)/(1-te))/Math.PI;return le<0?0:le>1?1:le}function Jt(it,te,le,K,he,de,xe,ke){if(K/=te,de>=(le/=te)&&xe<K)return it;if(xe<le||de>=K)return null;const ze=[];for(const He of it){const Ue=He.geometry;let Ze=He.type;const ot=he===0?He.minX:He.minY,pt=he===0?He.maxX:He.maxY;if(ot>=le&&pt<K){ze.push(He);continue}if(pt<le||ot>=K)continue;let St=[];if(Ze==="Point"||Ze==="MultiPoint")bn(Ue,St,le,K,he);else if(Ze==="LineString")gn(Ue,St,le,K,he,!1,ke.lineMetrics);else if(Ze==="MultiLineString")dn(Ue,St,le,K,he,!1);else if(Ze==="Polygon")dn(Ue,St,le,K,he,!0);else if(Ze==="MultiPolygon")for(const Ut of Ue){const tr=[];dn(Ut,tr,le,K,he,!0),tr.length&&St.push(tr)}if(St.length){if(ke.lineMetrics&&Ze==="LineString"){for(const Ut of St)ze.push(Ur(He.id,Ze,Ut,He.tags));continue}Ze!=="LineString"&&Ze!=="MultiLineString"||(St.length===1?(Ze="LineString",St=St[0]):Ze="MultiLineString"),Ze!=="Point"&&Ze!=="MultiPoint"||(Ze=St.length===3?"Point":"MultiPoint"),ze.push(Ur(He.id,Ze,St,He.tags))}}return ze.length?ze:null}function bn(it,te,le,K,he){for(let de=0;de<it.length;de+=3){const xe=it[de+he];xe>=le&&xe<=K&&di(te,it[de],it[de+1],it[de+2])}}function gn(it,te,le,K,he,de,xe){let ke=Kn(it);const ze=he===0?Ui:Ji;let He,Ue,Ze=it.start;for(let tr=0;tr<it.length-3;tr+=3){const Gt=it[tr],Xt=it[tr+1],vr=it[tr+2],Nr=it[tr+3],dr=it[tr+4],Vr=he===0?Gt:Xt,Gr=he===0?Nr:dr;let In=!1;xe&&(He=Math.sqrt(Math.pow(Gt-Nr,2)+Math.pow(Xt-dr,2))),Vr<le?Gr>le&&(Ue=ze(ke,Gt,Xt,Nr,dr,le),xe&&(ke.start=Ze+He*Ue)):Vr>K?Gr<K&&(Ue=ze(ke,Gt,Xt,Nr,dr,K),xe&&(ke.start=Ze+He*Ue)):di(ke,Gt,Xt,vr),Gr<le&&Vr>=le&&(Ue=ze(ke,Gt,Xt,Nr,dr,le),In=!0),Gr>K&&Vr<=K&&(Ue=ze(ke,Gt,Xt,Nr,dr,K),In=!0),!de&&In&&(xe&&(ke.end=Ze+He*Ue),te.push(ke),ke=Kn(it)),xe&&(Ze+=He)}let ot=it.length-3;const pt=it[ot],St=it[ot+1],Ut=he===0?pt:St;Ut>=le&&Ut<=K&&di(ke,pt,St,it[ot+2]),ot=ke.length-3,de&&ot>=3&&(ke[ot]!==ke[0]||ke[ot+1]!==ke[1])&&di(ke,ke[0],ke[1],ke[2]),ke.length&&te.push(ke)}function Kn(it){const te=[];return te.size=it.size,te.start=it.start,te.end=it.end,te}function dn(it,te,le,K,he,de){for(const xe of it)gn(xe,te,le,K,he,de,!1)}function di(it,te,le,K){it.push(te,le,K)}function Ui(it,te,le,K,he,de){const xe=(de-te)/(K-te);return di(it,de,le+(he-le)*xe,1),xe}function Ji(it,te,le,K,he,de){const xe=(de-le)/(he-le);return di(it,te+(K-te)*xe,de,1),xe}function nn(it,te){const le=[];for(let K=0;K<it.length;K++){const he=it[K],de=he.type;let xe;if(de==="Point"||de==="MultiPoint"||de==="LineString")xe=En(he.geometry,te);else if(de==="MultiLineString"||de==="Polygon"){xe=[];for(const ke of he.geometry)xe.push(En(ke,te))}else if(de==="MultiPolygon"){xe=[];for(const ke of he.geometry){const ze=[];for(const He of ke)ze.push(En(He,te));xe.push(ze)}}le.push(Ur(he.id,de,xe,he.tags))}return le}function En(it,te){const le=[];le.size=it.size,it.start!==void 0&&(le.start=it.start,le.end=it.end);for(let K=0;K<it.length;K+=3)le.push(it[K]+te,it[K+1],it[K+2]);return le}function Jn(it,te){if(it.transformed)return it;const le=1<<it.z,K=it.x,he=it.y;for(const de of it.features){const xe=de.geometry,ke=de.type;if(de.geometry=[],ke===1)for(let ze=0;ze<xe.length;ze+=2)de.geometry.push(zo(xe[ze],xe[ze+1],te,le,K,he));else for(let ze=0;ze<xe.length;ze++){const He=[];for(let Ue=0;Ue<xe[ze].length;Ue+=2)He.push(zo(xe[ze][Ue],xe[ze][Ue+1],te,le,K,he));de.geometry.push(He)}}return it.transformed=!0,it}function zo(it,te,le,K,he,de){return[Math.round(le*(it*K-he)),Math.round(le*(te*K-de))]}function _i(it,te,le,K,he){const de=te===he.maxZoom?0:he.tolerance/((1<<te)*he.extent),xe={features:[],numPoints:0,numSimplified:0,numFeatures:it.length,source:null,x:le,y:K,z:te,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const ke of it)bi(xe,ke,de,he);return xe}function bi(it,te,le,K){const he=te.geometry,de=te.type,xe=[];if(it.minX=Math.min(it.minX,te.minX),it.minY=Math.min(it.minY,te.minY),it.maxX=Math.max(it.maxX,te.maxX),it.maxY=Math.max(it.maxY,te.maxY),de==="Point"||de==="MultiPoint")for(let ke=0;ke<he.length;ke+=3)xe.push(he[ke],he[ke+1]),it.numPoints++,it.numSimplified++;else if(de==="LineString")gr(xe,he,it,le,!1,!1);else if(de==="MultiLineString"||de==="Polygon")for(let ke=0;ke<he.length;ke++)gr(xe,he[ke],it,le,de==="Polygon",ke===0);else if(de==="MultiPolygon")for(let ke=0;ke<he.length;ke++){const ze=he[ke];for(let He=0;He<ze.length;He++)gr(xe,ze[He],it,le,!0,He===0)}if(xe.length){let ke=te.tags||null;if(de==="LineString"&&K.lineMetrics){ke={};for(const He in te.tags)ke[He]=te.tags[He];ke.mapbox_clip_start=he.start/he.size,ke.mapbox_clip_end=he.end/he.size}const ze={geometry:xe,type:de==="Polygon"||de==="MultiPolygon"?3:de==="LineString"||de==="MultiLineString"?2:1,tags:ke};te.id!==null&&(ze.id=te.id),it.features.push(ze)}}function gr(it,te,le,K,he,de){const xe=K*K;if(K>0&&te.size<(he?xe:K))return void(le.numPoints+=te.length/3);const ke=[];for(let ze=0;ze<te.length;ze+=3)(K===0||te[ze+2]>xe)&&(le.numSimplified++,ke.push(te[ze],te[ze+1])),le.numPoints++;he&&function(ze,He){let Ue=0;for(let Ze=0,ot=ze.length,pt=ot-2;Ze<ot;pt=Ze,Ze+=2)Ue+=(ze[Ze]-ze[pt])*(ze[Ze+1]+ze[pt+1]);if(Ue>0===He)for(let Ze=0,ot=ze.length;Ze<ot/2;Ze+=2){const pt=ze[Ze],St=ze[Ze+1];ze[Ze]=ze[ot-2-Ze],ze[Ze+1]=ze[ot-1-Ze],ze[ot-2-Ze]=pt,ze[ot-1-Ze]=St}}(ke,de),it.push(ke)}const Gi={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Lo{constructor(te,le){const K=(le=this.options=function(de,xe){for(const ke in xe)de[ke]=xe[ke];return de}(Object.create(Gi),le)).debug;if(K&&console.time("preprocess data"),le.maxZoom<0||le.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(le.promoteId&&le.generateId)throw new Error("promoteId and generateId cannot be used together.");let he=function(de,xe){const ke=[];if(de.type==="FeatureCollection")for(let ze=0;ze<de.features.length;ze++)ar(ke,de.features[ze],xe,ze);else ar(ke,de.type==="Feature"?de:{geometry:de},xe);return ke}(te,le);this.tiles={},this.tileCoords=[],K&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",le.indexMaxZoom,le.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),he=function(de,xe){const ke=xe.buffer/xe.extent;let ze=de;const He=Jt(de,1,-1-ke,ke,0,-1,2,xe),Ue=Jt(de,1,1-ke,2+ke,0,-1,2,xe);return(He||Ue)&&(ze=Jt(de,1,-ke,1+ke,0,-1,2,xe)||[],He&&(ze=nn(He,1).concat(ze)),Ue&&(ze=ze.concat(nn(Ue,-1)))),ze}(he,le),he.length&&this.splitTile(he,0,0,0),K&&(he.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(te,le,K,he,de,xe,ke){const ze=[te,le,K,he],He=this.options,Ue=He.debug;for(;ze.length;){he=ze.pop(),K=ze.pop(),le=ze.pop(),te=ze.pop();const Ze=1<<le,ot=li(le,K,he);let pt=this.tiles[ot];if(!pt&&(Ue>1&&console.time("creation"),pt=this.tiles[ot]=_i(te,le,K,he,He),this.tileCoords.push({z:le,x:K,y:he}),Ue)){Ue>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",le,K,he,pt.numFeatures,pt.numPoints,pt.numSimplified),console.timeEnd("creation"));const In=`z${le}`;this.stats[In]=(this.stats[In]||0)+1,this.total++}if(pt.source=te,de==null){if(le===He.indexMaxZoom||pt.numPoints<=He.indexMaxPoints)continue}else{if(le===He.maxZoom||le===de)continue;if(de!=null){const In=de-le;if(K!==xe>>In||he!==ke>>In)continue}}if(pt.source=null,te.length===0)continue;Ue>1&&console.time("clipping");const St=.5*He.buffer/He.extent,Ut=.5-St,tr=.5+St,Gt=1+St;let Xt=null,vr=null,Nr=null,dr=null,Vr=Jt(te,Ze,K-St,K+tr,0,pt.minX,pt.maxX,He),Gr=Jt(te,Ze,K+Ut,K+Gt,0,pt.minX,pt.maxX,He);te=null,Vr&&(Xt=Jt(Vr,Ze,he-St,he+tr,1,pt.minY,pt.maxY,He),vr=Jt(Vr,Ze,he+Ut,he+Gt,1,pt.minY,pt.maxY,He),Vr=null),Gr&&(Nr=Jt(Gr,Ze,he-St,he+tr,1,pt.minY,pt.maxY,He),dr=Jt(Gr,Ze,he+Ut,he+Gt,1,pt.minY,pt.maxY,He),Gr=null),Ue>1&&console.timeEnd("clipping"),ze.push(Xt||[],le+1,2*K,2*he),ze.push(vr||[],le+1,2*K,2*he+1),ze.push(Nr||[],le+1,2*K+1,2*he),ze.push(dr||[],le+1,2*K+1,2*he+1)}}getTile(te,le,K){te=+te,le=+le,K=+K;const he=this.options,{extent:de,debug:xe}=he;if(te<0||te>24)return null;const ke=1<<te,ze=li(te,le=le+ke&ke-1,K);if(this.tiles[ze])return Jn(this.tiles[ze],de);xe>1&&console.log("drilling down to z%d-%d-%d",te,le,K);let He,Ue=te,Ze=le,ot=K;for(;!He&&Ue>0;)Ue--,Ze>>=1,ot>>=1,He=this.tiles[li(Ue,Ze,ot)];return He&&He.source?(xe>1&&(console.log("found parent tile z%d-%d-%d",Ue,Ze,ot),console.time("drilling down")),this.splitTile(He.source,Ue,Ze,ot,te,le,K),xe>1&&console.timeEnd("drilling down"),this.tiles[ze]?Jn(this.tiles[ze],de):null):null}}function li(it,te,le){return 32*((1<<it)*le+te)+it}function Hi(it,te){const le=it.tileID.canonical;if(!this._geoJSONIndex)return void te(null,null);const K=this._geoJSONIndex.getTile(le.z,le.x,le.y);if(!K)return void te(null,null);const he=new Te(K.features);let de=vt(he);de.byteOffset===0&&de.byteLength===de.buffer.byteLength||(de=new Uint8Array(de)),te(null,{vectorTile:he,rawData:de.buffer})}class fi extends fe{constructor(te,le,K,he,de,xe){super(te,le,K,he,Hi,xe),de&&(this.loadGeoJSON=de),this._dynamicIndex=new Ne}loadData(te,le){const K=te&&te.request,he=K&&K.collectResourceTiming;this.loadGeoJSON(te,(de,xe)=>{if(de||!xe)return le(de);if(typeof xe!="object")return le(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`));{try{if(te.filter){const ze=i.S(te.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(ze.result==="error")throw new Error(ze.value.map(He=>`${He.key}: ${He.message}`).join(", "));xe.features=xe.features.filter(He=>ze.value.evaluate({zoom:0},He))}te.dynamic?(xe.type==="Feature"&&(xe={type:"FeatureCollection",features:[xe]}),te.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(xe.features,this.loaded),te.cluster&&(xe.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=te.cluster?new qr(function({superclusterOptions:ze,clusterProperties:He}){if(!He||!ze)return ze;const Ue={},Ze={},ot={accumulated:null,zoom:0},pt={properties:null},St=Object.keys(He);for(const Ut of St){const[tr,Gt]=He[Ut],Xt=i.S(Gt),vr=i.S(typeof tr=="string"?[tr,["accumulated"],["get",Ut]]:tr);Ue[Ut]=Xt.value,Ze[Ut]=vr.value}return ze.map=Ut=>{pt.properties=Ut;const tr={};for(const Gt of St)tr[Gt]=Ue[Gt].evaluate(ot,pt);return tr},ze.reduce=(Ut,tr)=>{pt.properties=tr;for(const Gt of St)ot.accumulated=Ut[Gt],Ut[Gt]=Ze[Gt].evaluate(ot,pt)},ze}(te)).load(xe.features):te.dynamic?this._dynamicIndex:function(ze,He){return new Lo(ze,He)}(xe,te.geojsonVtOptions)}catch(ze){return le(ze)}const ke={};if(he){const ze=L(K);ze&&(ke.resourceTiming={},ke.resourceTiming[te.source]=JSON.parse(JSON.stringify(ze)))}le(null,ke)}})}reloadTile(te,le){const K=this.loaded;return K&&K[te.uid]?te.partial?le(null,void 0):super.reloadTile(te,le):this.loadTile(te,le)}loadGeoJSON(te,le){if(te.request)i.n(te.request,le);else{if(typeof te.data!="string")return le(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`));try{return le(null,JSON.parse(te.data))}catch{return le(new Error(`Input data given to '${te.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(te,le){try{le(null,this._geoJSONIndex.getClusterExpansionZoom(te.clusterId))}catch(K){le(K)}}getClusterChildren(te,le){try{le(null,this._geoJSONIndex.getChildren(te.clusterId))}catch(K){le(K)}}getClusterLeaves(te,le){try{le(null,this._geoJSONIndex.getLeaves(te.clusterId,te.limit,te.offset))}catch(K){le(K)}}}class pi{constructor(te,le){this.tileID=new i.aF(te.tileID.overscaledZ,te.tileID.wrap,te.tileID.canonical.z,te.tileID.canonical.x,te.tileID.canonical.y),this.tileZoom=te.tileZoom,this.uid=te.uid,this.zoom=te.zoom,this.canonical=te.tileID.canonical,this.pixelRatio=te.pixelRatio,this.tileSize=te.tileSize,this.source=te.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=te.projection,this.brightness=le}parse(te,le,K,he){this.status="parsing";const de=new i.aF(K.tileID.overscaledZ,K.tileID.wrap,K.tileID.canonical.z,K.tileID.canonical.x,K.tileID.canonical.y),xe=[],ke=le.familiesBySource[K.source],ze=new i.dZ(de,K.promoteId);return ze.bucketLayerIDs=[],ze.is3DTile=!0,i.e9(te).then(He=>{if(!He)return he(new Error("Could not parse tile"));const Ue=i.ea(He,1/i.cb(K.tileID.canonical)),Ze=He.json.extensionsUsed&&He.json.extensionsUsed.includes("MAPBOX_mesh_features")||He.json.asset.extras&&He.json.asset.extras.MAPBOX_mesh_features,ot=He.json.extensionsUsed&&He.json.extensionsUsed.includes("EXT_meshopt_compression"),pt=new i.a7(this.zoom,{brightness:this.brightness});for(const St in ke)for(const Ut of ke[St]){const tr=Ut[0];ze.bucketLayerIDs.push(Ut.map(Xt=>i.aB(Xt.id,Xt.scope))),tr.recalculate(pt,[]);const Gt=new i.eb(Ut,Ue,de,Ze,ot,this.brightness,ze);Ze||(Gt.needsUpload=!0),xe.push(Gt),Gt.evaluate(tr)}this.status="done",he(null,{buckets:xe,featureIndex:ze,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(He=>he(new Error(He.message)))}}class Wi{constructor(te,le,K,he,de,xe){this.actor=te,this.layerIndex=le,this.availableImages=K,this.brightness=xe,this.loading={},this.loaded={}}loadTile(te,le){const K=te.uid,he=this.loading[K]=new pi(te,this.brightness);i.bh(te.request,(de,xe)=>{const ke=!this.loading[K];return delete this.loading[K],ke||de?(he.status="done",ke||(this.loaded[K]=he),le(de)):xe&&xe.byteLength!==0?void he.parse(xe,this.layerIndex,te,(ze,He)=>{he.status="done",this.loaded=this.loaded||{},this.loaded[K]=he,ze||!He?le(ze):le(null,He)}):(he.status="done",this.loaded[K]=he,le())})}reloadTile(te,le){const K=this.loaded,he=te.uid;if(K&&K[he]){const de=K[he];de.projection=te.projection,de.brightness=te.brightness;const xe=(ke,ze)=>{de.reloadCallback&&(delete de.reloadCallback,this.loadTile(te,le)),le(ke,ze)};de.status==="parsing"?de.reloadCallback=xe:de.status==="done"&&this.loadTile(te,le)}}abortTile(te,le){const K=te.uid;this.loading[K]&&delete this.loading[K],le()}removeTile(te,le){const K=this.loaded,he=te.uid;K&&K[he]&&delete K[he],le()}}class Bn{constructor(te){this.self=te,this.actor=new i.ec(te,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.imageRasterizer=new i.I,this.projections={},this.defaultProjection=i.bO({name:"mercator"}),this.workerSourceTypes={vector:fe,geojson:fi,"batched-model":Wi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(le,K)=>{if(this.workerSourceTypes[le])throw new Error(`Worker source with name "${le}" already registered.`);this.workerSourceTypes[le]=K},this.self.registerRTLTextPlugin=le=>{if(i.ed.isParsed())throw new Error("RTL text plugin already registered.");i.ed.applyArabicShaping=le.applyArabicShaping,i.ed.processBidirectionalText=le.processBidirectionalText,i.ed.processStyledBidirectionalText=le.processStyledBidirectionalText}}clearCaches(te,le,K){delete this.layerIndexes[te],delete this.availableImages[te],delete this.workerSources[te],delete this.demWorkerSources[te],delete this.rasterArrayWorkerSource,K()}checkIfReady(te,le,K){K()}setReferrer(te,le){this.referrer=le}spriteLoaded(te,{scope:le,isLoaded:K}){if(this.isSpriteLoaded[te]||(this.isSpriteLoaded[te]={}),this.isSpriteLoaded[te][le]=K,this.workerSources[te]&&this.workerSources[te][le])for(const he in this.workerSources[te][le]){const de=this.workerSources[te][le][he];for(const xe in de){const ke=de[xe];ke instanceof fe&&(ke.isSpriteLoaded=K,ke.fire(new i.z("isSpriteLoaded")))}}}setImages(te,{scope:le,images:K},he){if(this.availableImages[te]||(this.availableImages[te]={}),this.availableImages[te][le]=K,this.workerSources[te]&&this.workerSources[te][le]){for(const de in this.workerSources[te][le]){const xe=this.workerSources[te][le][de];for(const ke in xe)xe[ke].availableImages=K}he()}else he()}setProjection(te,le){this.projections[te]=i.bO(le)}setBrightness(te,le,K){this.brightness=le,K()}setLayers(te,le,K){this.getLayerIndex(te,le.scope).replace(le.layers,le.options),K()}updateLayers(te,le,K){this.getLayerIndex(te,le.scope).update(le.layers,le.removedIds,le.options),K()}loadTile(te,le,K){le.projection=this.projections[te]||this.defaultProjection,this.getWorkerSource(te,le.type,le.source,le.scope).loadTile(le,K)}loadDEMTile(te,le,K){this.getDEMWorkerSource(te,le.source,le.scope).loadTile(le,K)}decodeRasterArray(te,le,K){this.getRasterArrayWorkerSource().decodeRasterArray(le,K)}reloadTile(te,le,K){le.projection=this.projections[te]||this.defaultProjection,this.getWorkerSource(te,le.type,le.source,le.scope).reloadTile(le,K)}abortTile(te,le,K){this.getWorkerSource(te,le.type,le.source,le.scope).abortTile(le,K)}removeTile(te,le,K){this.getWorkerSource(te,le.type,le.source,le.scope).removeTile(le,K)}removeSource(te,le,K){if(!(this.workerSources[te]&&this.workerSources[te][le.scope]&&this.workerSources[te][le.scope][le.type]&&this.workerSources[te][le.scope][le.type][le.source]))return;const he=this.workerSources[te][le.scope][le.type][le.source];delete this.workerSources[te][le.scope][le.type][le.source],he.removeSource!==void 0?he.removeSource(le,K):K()}loadWorkerSource(te,le,K){try{this.self.importScripts(le.url),K()}catch(he){K(he.toString())}}syncRTLPluginState(te,le,K){try{i.ed.setState(le);const he=i.ed.getPluginURL();if(i.ed.isLoaded()&&!i.ed.isParsed()&&he!=null){this.self.importScripts(he);const de=i.ed.isParsed();K(de?void 0:new Error(`RTL Text Plugin failed to import scripts from ${he}`),de)}}catch(he){K(he.toString())}}setDracoUrl(te,le){this.dracoUrl=le}getAvailableImages(te,le){this.availableImages[te]||(this.availableImages[te]={});let K=this.availableImages[te][le];return K||(K=[]),K}getLayerIndex(te,le){this.layerIndexes[te]||(this.layerIndexes[te]={});let K=this.layerIndexes[te][le];return K||(K=this.layerIndexes[te][le]=new q,K.scope=le),K}getWorkerSource(te,le,K,he){return this.workerSources[te]||(this.workerSources[te]={}),this.workerSources[te][he]||(this.workerSources[te][he]={}),this.workerSources[te][he][le]||(this.workerSources[te][he][le]={}),this.isSpriteLoaded[te]||(this.isSpriteLoaded[te]={}),this.workerSources[te][he][le][K]||(this.workerSources[te][he][le][K]=new this.workerSourceTypes[le]({send:(de,xe,ke,ze,He,Ue)=>{this.actor.send(de,xe,ke,te,He,Ue)},scheduler:this.actor.scheduler},this.getLayerIndex(te,he),this.getAvailableImages(te,he),this.isSpriteLoaded[te][he],void 0,this.brightness)),this.workerSources[te][he][le][K]}rasterizeImages(te,le,K){const{imageTasks:he,scope:de}=le,xe={};for(const ke in he){const{image:ze,imageIdWithOptions:He}=he[ke];xe[ke]=this.imageRasterizer.rasterize(He,ze,de,te)}K(void 0,xe)}removeRasterizedImages(te,le,K){const{imageIds:he,scope:de}=le;this.imageRasterizer.removeImagesFromCacheByIds(he,de,te),K()}getDEMWorkerSource(te,le,K){return this.demWorkerSources[te]||(this.demWorkerSources[te]={}),this.demWorkerSources[te][K]||(this.demWorkerSources[te][K]={}),this.demWorkerSources[te][K][le]||(this.demWorkerSources[te][K][le]=new re),this.demWorkerSources[te][K][le]}getRasterArrayWorkerSource(){return this.rasterArrayWorkerSource||(this.rasterArrayWorkerSource=new ee),this.rasterArrayWorkerSource}enforceCacheSizeLimit(te,le){i.ee(le)}getWorkerPerformanceMetrics(te,le,K){K(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Bn(self)),Bn}),x(["./shared"],function(i){var L="3.9.0";const N={create:"create",load:"load",fullLoad:"fullLoad"},U={mark(f){performance.mark(f)},measure(f,n,s){performance.measure(f,n,s)}};function q(f){const n=f.name.split("?")[0];return i.a(n)&&n.includes("mapbox-gl.js")?"javascript":i.a(n)&&n.includes("mapbox-gl.css")?"css":i.b(n)?"fontRange":i.c(n)?"sprite":i.i(n)?"style":i.d(n)?"tilejson":"other"}var X,se={},ce=function(){if(X)return se;function f(p){return!n(p)}function n(p){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,w,P=new Blob([""],{type:"text/javascript"}),z=URL.createObjectURL(P);try{w=new Worker(z),y=!0}catch{y=!1}return w&&w.terminate(),URL.revokeObjectURL(z),y}()?function(){var y=document.createElement("canvas");y.width=y.height=1;var w=y.getContext("2d");if(!w)return!1;var P=w.getImageData(0,0,1,1);return P&&P.width===y.width}()?(s[_=p&&p.failIfMajorPerformanceCaveat]===void 0&&(s[_]=function(y){var w,P=function(z){var k=document.createElement("canvas"),D=Object.create(f.webGLContextAttributes);return D.failIfMajorPerformanceCaveat=z,k.getContext("webgl2",D)}(y);if(!P)return!1;try{w=P.createShader(P.VERTEX_SHADER)}catch{return!1}return!(!w||P.isContextLost())&&(P.shaderSource(w,"void main() {}"),P.compileShader(w),P.getShaderParameter(w,P.COMPILE_STATUS)===!0)}(_)),s[_]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var _}X=1,se.supported=f,se.notSupportedReason=n;var s={};return f.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},se}();function ue(f,n,s){const p=document.createElement(f);return n!=null&&(p.className=n),s&&s.appendChild(p),p}function fe(f,n,s){const p=document.createElementNS("http://www.w3.org/2000/svg",f);for(const _ of Object.keys(n))p.setAttributeNS(null,_,String(n[_]));return s&&s.appendChild(p),p}const re=typeof document<"u"?document.documentElement&&document.documentElement.style:null,ee=re&&re.userSelect!==void 0?"userSelect":"WebkitUserSelect";let ae;function ve(){re&&ee&&(ae=re[ee],re[ee]="none")}function Te(){re&&ee&&(re[ee]=ae)}function pe(f){f.preventDefault(),f.stopPropagation(),window.removeEventListener("click",pe,!0)}function Ee(){window.addEventListener("click",pe,!0),window.setTimeout(()=>{window.removeEventListener("click",pe,!0)},0)}function Ne(f,n){const s=f.getBoundingClientRect();return Je(f,s,n)}function Xe(f,n){const s=f.getBoundingClientRect(),p=[];for(let _=0;_<n.length;_++)p.push(Je(f,s,n[_]));return p}function Fe(f){return window.InstallTrigger!==void 0&&f.button===2&&f.ctrlKey&&window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:f.button}function Je(f,n,s){const p=f.offsetWidth===n.width?1:f.offsetWidth/n.width;return new i.P((s.clientX-n.left)*p,(s.clientY-n.top)*p)}const Ct="01",ft="NO_ACCESS_TOKEN";class yt{constructor(n,s,p){this._transformRequestFn=n,this._customAccessToken=s,this._silenceAuthErrors=!!p,this._createSkuToken()}_createSkuToken(){const n=function(){let s="";for(let p=0;p<10;p++)s+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",Ct,s].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=n.token,this._skuTokenExpiresAt=n.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(n,s){return this._transformRequestFn&&this._transformRequestFn(n,s)||{url:n}}normalizeStyleURL(n,s){if(!i.f(n))return n;const p=ct(n);return p.params.push(`sdk=js-${L}`),p.path=`/styles/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||s)}normalizeGlyphsURL(n,s){if(!i.f(n))return n;const p=ct(n);return p.path=`/fonts/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||s)}normalizeModelURL(n,s){if(!i.f(n))return n;const p=ct(n);return p.path=`/models/v1${p.path}`,this._makeAPIURL(p,this._customAccessToken||s)}normalizeSourceURL(n,s,p,_){if(!i.f(n))return n;const y=ct(n);return y.path=`/v4/${y.authority}.json`,y.params.push("secure"),p&&y.params.push(`language=${p}`),_&&y.params.push(`worldview=${_}`),this._makeAPIURL(y,this._customAccessToken||s)}normalizeIconsetURL(n,s){const p=ct(n);return i.f(n)?(p.path=`/styles/v1${p.path}/iconset.pbf`,this._makeAPIURL(p,this._customAccessToken||s)):Ye(p)}normalizeSpriteURL(n,s,p,_){const y=ct(n);return i.f(n)?(y.path=`/styles/v1${y.path}/sprite${s}${p}`,this._makeAPIURL(y,this._customAccessToken||_)):(y.path+=`${s}${p}`,Ye(y))}normalizeTileURL(n,s,p){if(this._isSkuTokenExpired()&&this._createSkuToken(),n&&!i.f(n))return n;const _=ct(n);_.path=_.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${s||p&&_.authority!=="raster"&&p===512?"@2x":""}${i.m.supported?".webp":"$1"}`),_.authority==="raster"?_.path=`/${i.e.RASTER_URL_PREFIX}${_.path}`:_.authority==="rasterarrays"?_.path=`/${i.e.RASTERARRAYS_URL_PREFIX}${_.path}`:_.authority==="3dtiles"?_.path=`/${i.e.TILES3D_URL_PREFIX}${_.path}`:(_.path=_.path.replace(/^.+\/v4\//,"/"),_.path=`/${i.e.TILE_URL_VERSION}${_.path}`);const y=this._customAccessToken||function(w){for(const P of w){const z=P.match(/^access_token=(.*)$/);if(z)return z[1]}return null}(_.params)||i.e.ACCESS_TOKEN;return i.e.REQUIRE_ACCESS_TOKEN&&y&&this._skuToken&&_.params.push(`sku=${this._skuToken}`),this._makeAPIURL(_,y)}canonicalizeTileURL(n,s){const p=ct(n);if(!p.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!p.path.match(/\.[\w]+$/))return n;let _="mapbox://";p.path.match(/^\/raster\/v1\//)?_+=`raster/${p.path.replace(`/${i.e.RASTER_URL_PREFIX}/`,"")}`:p.path.match(/^\/rasterarrays\/v1\//)?_+=`rasterarrays/${p.path.replace(`/${i.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:_+=`tiles/${p.path.replace(`/${i.e.TILE_URL_VERSION}/`,"")}`;let y=p.params;return s&&(y=y.filter(w=>!w.match(/^access_token=/))),y.length&&(_+=`?${y.join("&")}`),_}canonicalizeTileset(n,s){const p=!!s&&i.f(s),_=[];for(const y of n.tiles||[])i.h(y)?_.push(this.canonicalizeTileURL(y,p)):_.push(y);return _}_makeAPIURL(n,s){const p="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",_=ct(i.e.API_URL);if(n.protocol=_.protocol,n.authority=_.authority,n.protocol==="http"){const y=n.params.indexOf("secure");y>=0&&n.params.splice(y,1)}if(_.path!=="/"&&(n.path=`${_.path}${n.path}`),!i.e.REQUIRE_ACCESS_TOKEN)return Ye(n);if(s=s||i.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!s)throw new Error(`An API access token is required to use Mapbox GL. ${p}`);if(s[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${p}`)}return n.params=n.params.filter(y=>y.indexOf("access_token")===-1),n.params.push(`access_token=${s||""}`),Ye(n)}}const lt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ct(f){const n=f.match(lt);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function Ye(f){const n=f.params.length?`?${f.params.join("&")}`:"";return`${f.protocol}://${f.authority}${f.path}${n}`}const Ke="mapbox.eventData";function tt(f){if(!f)return null;const n=f.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(i.j(n[1]))}catch{return null}}class ht{constructor(n){this.type=n,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(n){const s=tt(i.e.ACCESS_TOKEN);let p="";return p=s&&s.u?i.k(s.u):i.e.ACCESS_TOKEN||"",n?`${Ke}.${n}:${p}`:`${Ke}:${p}`}fetchEventData(){const n=i.s("localStorage"),s=this.getStorageKey(),p=this.getStorageKey("uuid");if(n)try{const _=localStorage.getItem(s);_&&(this.eventData=JSON.parse(_));const y=localStorage.getItem(p);y&&(this.anonId=y)}catch{i.w("Unable to read from LocalStorage")}}saveEventData(){const n=i.s("localStorage"),s=this.getStorageKey(),p=this.getStorageKey("uuid"),_=this.anonId;if(n&&_)try{localStorage.setItem(p,_),Object.keys(this.eventData).length>=1&&localStorage.setItem(s,JSON.stringify(this.eventData))}catch{i.w("Unable to write to LocalStorage")}}processRequests(n){}postEvent(n,s,p,_){if(!i.e.EVENTS_URL)return;const y=ct(i.e.EVENTS_URL);y.params.push(`access_token=${_||i.e.ACCESS_TOKEN||""}`);const w={event:this.type,created:new Date(n).toISOString()},P=s?i.l(w,s):w,z={url:Ye(y),headers:{"Content-Type":"text/plain"},body:JSON.stringify([P])};this.pendingRequest=i.p(z,k=>{this.pendingRequest=null,p(k),this.saveEventData(),this.processRequests(_)})}queueRequest(n,s){this.queue.push(n),this.processRequests(s)}}const vt=new class extends ht{constructor(f){super("appUserTurnstile"),this._customAccessToken=f}postTurnstileEvent(f,n){i.e.EVENTS_URL&&i.e.ACCESS_TOKEN&&Array.isArray(f)&&f.some(s=>i.f(s)||i.h(s))&&this.queueRequest(Date.now(),n)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const n=tt(i.e.ACCESS_TOKEN),s=n?n.u:i.e.ACCESS_TOKEN;let p=s!==this.eventData.tokenU;i.v(this.anonId)||(this.anonId=i.u(),p=!0);const _=this.queue.shift();if(this.eventData.lastSuccess){const y=new Date(this.eventData.lastSuccess),w=new Date(_),P=(_-this.eventData.lastSuccess)/864e5;p=p||P>=1||P<-1||y.getDate()!==w.getDate()}else p=!0;p?this.postEvent(_,{sdkIdentifier:"mapbox-gl-js",sdkVersion:L,skuId:Ct,"enabled.telemetry":!1,userId:this.anonId},y=>{y||(this.eventData.lastSuccess=_,this.eventData.tokenU=s)},f):this.processRequests()}},At=vt.postTurnstileEvent.bind(vt),Pt=new class extends ht{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(f,n,s,p){this.skuToken=n,this.errorCb=p,i.e.EVENTS_URL&&(s||i.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},s):this.errorCb(new Error(ft)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:s}=this.queue.shift();n&&this.success[n]||(this.anonId||this.fetchEventData(),i.v(this.anonId)||(this.anonId=i.u()),this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:L,skuId:Ct,skuToken:this.skuToken,userId:this.anonId},p=>{p?this.errorCb(p):n&&(this.success[n]=!0)},f))}remove(){this.errorCb=null}},qt=Pt.postMapLoadEvent.bind(Pt),or=new class extends ht{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(f){let n=this.mapInstanceIdMap.get(f);return n||(n=i.u(),this.mapInstanceIdMap.set(f,n)),n}getEventId(f){const n=this.eventIdPerMapInstanceMap.get(f)||0;return this.eventIdPerMapInstanceMap.set(f,n+1),n}postStyleLoadEvent(f,n){const{map:s,style:p,importedStyles:_}=n;if(!i.e.EVENTS_URL||!f&&!i.e.ACCESS_TOKEN)return;const y=this.getMapInstanceId(s),w={mapInstanceId:y,eventId:this.getEventId(y),style:p};_.length&&(w.importedStyles=_),this.queueRequest({timestamp:Date.now(),payload:w},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,payload:s}=this.queue.shift();this.postEvent(n,s,()=>{},f)}},cr=or.postStyleLoadEvent.bind(or),Qt=new class extends ht{constructor(){super("gljs.performance")}postPerformanceEvent(f,n){i.e.EVENTS_URL&&(f||i.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:n},f)}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,performanceData:s}=this.queue.shift(),p=function(_){const y=performance.getEntriesByType("resource"),w=performance.getEntriesByType("mark"),P=function(G){const Q={};if(G){for(const J in G)if(J!=="other")for(const ie of G[J]){const oe=`${J}ResolveRangeMin`,me=`${J}ResolveRangeMax`,Se=`${J}RequestCount`,be=`${J}RequestCachedCount`;Q[oe]=Math.min(Q[oe]||1/0,ie.startTime),Q[me]=Math.max(Q[me]||-1/0,ie.responseEnd);const Pe=Me=>{Q[Me]===void 0&&(Q[Me]=0),++Q[Me]};ie.transferSize!==void 0&&ie.transferSize===0&&Pe(be),Pe(Se)}}return Q}(function(G,Q){const J={};if(G)for(const ie of G){const oe=Q(ie);J[oe]===void 0&&(J[oe]=[]),J[oe].push(ie)}return J}(y,q)),z=window.devicePixelRatio,k=navigator.connection||navigator.mozConnection||navigator.webkitConnection,D=k?k.effectiveType:void 0,j={counters:[],metadata:[],attributes:[]},B=(G,Q,J)=>{J!=null&&G.push({name:Q,value:J.toString()})};for(const G in P)B(j.counters,G,P[G]);if(_.interactionRange[0]!==1/0&&_.interactionRange[1]!==-1/0&&(B(j.counters,"interactionRangeMin",_.interactionRange[0]),B(j.counters,"interactionRangeMax",_.interactionRange[1])),w)for(const G of Object.keys(N)){const Q=N[G],J=w.find(ie=>ie.name===Q);J&&B(j.counters,Q,J.startTime)}return B(j.counters,"visibilityHidden",_.visibilityHidden),B(j.attributes,"style",function(G){if(G)for(const Q of G){const J=Q.name.split("?")[0];if(i.i(J)){const ie=J.split("/").slice(-2);if(ie.length===2)return`mapbox://styles/${ie[0]}/${ie[1]}`}}}(y)),B(j.attributes,"terrainEnabled",_.terrainEnabled?"true":"false"),B(j.attributes,"fogEnabled",_.fogEnabled?"true":"false"),B(j.attributes,"projection",_.projection),B(j.attributes,"zoom",_.zoom),B(j.metadata,"devicePixelRatio",z),B(j.metadata,"connectionEffectiveType",D),B(j.metadata,"navigatorUserAgent",navigator.userAgent),B(j.metadata,"screenWidth",window.screen.width),B(j.metadata,"screenHeight",window.screen.height),B(j.metadata,"windowWidth",window.innerWidth),B(j.metadata,"windowHeight",window.innerHeight),B(j.metadata,"mapWidth",_.width/z),B(j.metadata,"mapHeight",_.height/z),B(j.metadata,"webglRenderer",_.renderer),B(j.metadata,"webglVendor",_.vendor),B(j.metadata,"sdkVersion",L),B(j.metadata,"sdkIdentifier","mapbox-gl-js"),j}(s);for(const _ of p.metadata);for(const _ of p.counters);for(const _ of p.attributes);this.postEvent(n,p,()=>{},f)}},qr=Qt.postPerformanceEvent.bind(Qt),yr=new class extends ht{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(f,n,s,p){if(!i.e.API_URL||!i.e.SESSION_PATH)return;const _=ct(i.e.API_URL+i.e.SESSION_PATH);_.params.push(`sku=${n||""}`),_.params.push(`access_token=${p||i.e.ACCESS_TOKEN||""}`);const y={url:Ye(_),headers:{"Content-Type":"text/plain"}};this.pendingRequest=i.g(y,w=>{this.pendingRequest=null,s(w),this.saveEventData(),this.processRequests(p)})}getSessionAPI(f,n,s,p){this.skuToken=n,this.errorCb=p,i.e.SESSION_PATH&&i.e.API_URL&&(s||i.e.ACCESS_TOKEN?this.queueRequest({id:f,timestamp:Date.now()},s):this.errorCb(new Error(ft)))}processRequests(f){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:s}=this.queue.shift();n&&this.success[n]||this.getSession(s,this.skuToken,p=>{p?this.errorCb(p):n&&(this.success[n]=!0)},f)}remove(){this.errorCb=null}},Ae=yr.getSessionAPI.bind(yr),Lr=new Set;function $r(f,n){n?Lr.add(f):Lr.delete(f)}class pn{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages=new Set}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(n,s){this._updatedSourceCaches[n]=s,this.setDirty()}discardSourceCacheUpdate(n){delete this._updatedSourceCaches[n]}updateLayer(n){const s=n.scope;this._updatedLayers[s]=this._updatedLayers[s]||new Set,this._updatedLayers[s].add(n.id),this.setDirty()}removeLayer(n){const s=n.scope;this._removedLayers[s]=this._removedLayers[s]||{},this._updatedLayers[s]=this._updatedLayers[s]||new Set,this._removedLayers[s][n.id]=n,this._updatedLayers[s].delete(n.id),this._updatedPaintProps.delete(n.fqid),this.setDirty()}getRemovedLayer(n){return this._removedLayers[n.scope]?this._removedLayers[n.scope][n.id]:null}discardLayerRemoval(n){this._removedLayers[n.scope]&&delete this._removedLayers[n.scope][n.id]}getLayerUpdatesByScope(){const n={};for(const s in this._updatedLayers)n[s]=n[s]||{},n[s].updatedIds=Array.from(this._updatedLayers[s].values());for(const s in this._removedLayers)n[s]=n[s]||{},n[s].removedIds=Object.keys(this._removedLayers[s]);return n}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(n){this._updatedPaintProps.add(n.fqid),this.setDirty()}getUpdatedImages(){return Array.from(this._updatedImages.values())}updateImage(n){this._updatedImages.add(n),this.setDirty()}resetUpdatedImages(){this._updatedImages.clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages.clear()}}function wt(f){const{userImage:n}=f;return!!(n&&n.render&&n.render())&&(f.data.replace(new Uint8Array(n.data.buffer)),!0)}class Pr extends i.E{constructor(n){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0,this.spriteFormat=n,n!=="raster"&&i.t()&&(this.imageRasterizerDispatcher=new i.D(i.x(),this,"Image Rasterizer Worker",1))}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new i.I),this._imageRasterizer}createScope(n){this.images[n]={},this.loaded[n]=!1,this.updatedImages[n]={},this.patterns[n]={},this.callbackDispatchedThisFrame[n]={},this.atlasImage[n]=new i.r({width:1,height:1})}isLoaded(){for(const n in this.loaded)if(!this.loaded[n])return!1;return!0}setLoaded(n,s){if(this.loaded[s]!==n&&(this.loaded[s]=n,n)){for(const{ids:p,callback:_}of this.requestors)this._notify(p,s,_);this.requestors=[]}}hasImage(n,s){return!!this.getImage(n,s)}getImage(n,s){return this.images[s][n]}addImage(n,s,p){this._validate(n,p)&&(this.images[s][n]=p)}_validate(n,s){let p=!0;return this._validateStretch(s.stretchX,s.data&&s.data.width)||(this.fire(new i.y(new Error(`Image "${n}" has invalid "stretchX" value`))),p=!1),this._validateStretch(s.stretchY,s.data&&s.data.height)||(this.fire(new i.y(new Error(`Image "${n}" has invalid "stretchY" value`))),p=!1),this._validateContent(s.content,s)||(this.fire(new i.y(new Error(`Image "${n}" has invalid "content" value`))),p=!1),p}_validateStretch(n,s){if(!n)return!0;let p=0;for(const _ of n){if(_[0]<p||_[1]<_[0]||s<_[1])return!1;p=_[1]}return!0}_validateContent(n,s){return n?n.length!==4||!s.usvg&&(n[0]<0||s.data.width<n[0]||n[1]<0||s.data.height<n[1]||n[2]<0||s.data.width<n[2]||n[3]<0||s.data.height<n[3])?!1:!(n[2]<n[0]||n[3]<n[1]):!0}updateImage(n,s,p){p.version=this.images[s][n].version+1,this.images[s][n]=p,this.updatedImages[s][n]=!0,this.removeFromImageRasterizerCache(n,s)}removeFromImageRasterizerCache(n,s){this.spriteFormat!=="raster"&&(i.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[n],scope:s}):this.imageRasterizer.removeImagesFromCacheByIds([n],s))}removeImage(n,s){const p=this.images[s][n];delete this.images[s][n],delete this.patterns[s][n],this.removeFromImageRasterizerCache(n,s),p.userImage&&p.userImage.onRemove&&p.userImage.onRemove()}listImages(n){return Object.keys(this.images[n])}getImages(n,s,p){let _=!0;const y=!!this.loaded[s];if(!y)for(const w of n)this.images[s][w]||(_=!1);y||_?this._notify(n,s,p):this.requestors.push({ids:n,scope:s,callback:p})}rasterizeImages({scope:n,imageTasks:s},p){const _={};for(const y in s){const w=s[y],P=this.getImage(w.id,n);P&&(_[y]={image:P,imageIdWithOptions:w})}i.t()?this.imageRasterizerDispatcher.getActor().send("rasterizeImages",{imageTasks:_,scope:n},p):this.rasterizeImagesInMainThread({imageTasks:_,scope:n},p)}rasterizeImagesInMainThread(n,s){const{imageTasks:p,scope:_}=n,y={};for(const w in p){const{image:P,imageIdWithOptions:z}=p[w];y[w]=this.imageRasterizer.rasterize(z,P,_,"")}s(void 0,y)}getUpdatedImages(n){return this.updatedImages[n]}_notify(n,s,p){const _={};for(const y of n){this.images[s][y]||this.fire(new i.z("styleimagemissing",{id:y}));const w=this.images[s][y];w?_[y]={data:w.usvg?null:w.data.clone(),pixelRatio:w.pixelRatio,sdf:w.sdf,usvg:w.usvg,version:w.version,stretchX:w.stretchX,stretchY:w.stretchY,content:w.content,hasRenderCallback:!!(w.userImage&&w.userImage.render)}:i.w(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}p(null,_)}getPixelSize(n){const{width:s,height:p}=this.atlasImage[n];return{width:s,height:p}}getPattern(n,s,p){const _=this.patterns[s][n],y=this.getImage(n,s);if(!y)return null;if(_&&_.position.version===y.version)return _.position;if(_)_.position.version=y.version;else{const w={w:y.data.width+2*i.A,h:y.data.height+2*i.A,x:0,y:0},P=new i.C(w,y,i.A);this.patterns[s][n]={bin:w,position:P}}return this._updatePatternAtlas(s,p),this.patterns[s][n].position}bind(n,s){const p=n.gl;let _=this.atlasTexture[s];_?this.dirty&&(_.update(this.atlasImage[s]),this.dirty=!1):(_=new i.T(n,this.atlasImage[s],p.RGBA8),this.atlasTexture[s]=_),_.bind(p.LINEAR,p.CLAMP_TO_EDGE)}_updatePatternAtlas(n,s){const p=[];for(const P in this.patterns[n])p.push(this.patterns[n][P].bin);const{w:_,h:y}=i.B(p),w=this.atlasImage[n];w.resize({width:_||1,height:y||1});for(const P in this.patterns[n]){const{bin:z,position:k}=this.patterns[n][P];let D=k.padding;const j=z.x+D,B=z.y+D,G=this.images[n][P].data,Q=G.width,J=G.height;D=D>1?D-1:D,i.r.copy(G,w,{x:0,y:0},{x:j,y:B},{width:Q,height:J},s),i.r.copy(G,w,{x:0,y:J-D},{x:j,y:B-D},{width:Q,height:D},s),i.r.copy(G,w,{x:0,y:0},{x:j,y:B+J},{width:Q,height:D},s),i.r.copy(G,w,{x:Q-D,y:0},{x:j-D,y:B},{width:D,height:J},s),i.r.copy(G,w,{x:0,y:0},{x:j+Q,y:B},{width:D,height:J},s),i.r.copy(G,w,{x:Q-D,y:J-D},{x:j-D,y:B-D},{width:D,height:D},s),i.r.copy(G,w,{x:0,y:J-D},{x:j+Q,y:B-D},{width:D,height:D},s),i.r.copy(G,w,{x:0,y:0},{x:j+Q,y:B+J},{width:D,height:D},s),i.r.copy(G,w,{x:Q-D,y:0},{x:j-D,y:B+J},{width:D,height:D},s)}this.dirty=!0}beginFrame(){for(const n in this.images)this.callbackDispatchedThisFrame[n]={}}dispatchRenderCallbacks(n,s){for(const p of n){if(this.callbackDispatchedThisFrame[s][p])continue;this.callbackDispatchedThisFrame[s][p]=!0;const _=this.images[s][p];wt(_)&&this.updateImage(p,s,_)}}}function Ur(f){const n=f.key,s=f.value,p=f.valueSpec||{},_=f.objectElementValidators||{},y=f.style,w=f.styleSpec;let P=[];const z=i.G(s);if(z!=="object")return[new i.V(n,s,`object expected, ${z} found`)];for(const k in s){const D=k.split(".")[0];let j;_[D]?j=_[D]:p[D]?j=gr:_["*"]?j=_["*"]:p["*"]&&(j=gr),j?P=P.concat(j({key:(n&&`${n}.`)+k,value:s[k],valueSpec:p[D]||p["*"],style:y,styleSpec:w,object:s,objectKey:k},s)):P.push(new i.F(n,s[k],`unknown property "${k}"`))}for(const k in p)_[k]||p[k].required&&p[k].default===void 0&&s[k]===void 0&&P.push(new i.V(n,s,`missing required property "${k}"`));return P}function Un(f){const n=f.value,s=f.valueSpec,p=f.style,_=f.styleSpec,y=f.key,w=f.arrayElementValidator||gr;if(i.G(n)!=="array")return[new i.V(y,n,`array expected, ${i.G(n)} found`)];if(s.length&&n.length!==s.length)return[new i.V(y,n,`array length ${s.length} expected, length ${n.length} found`)];if(s["min-length"]&&n.length<s["min-length"])return[new i.V(y,n,`array length at least ${s["min-length"]} expected, length ${n.length} found`)];let P={type:s.value,values:s.values,minimum:s.minimum,maximum:s.maximum,function:void 0};_.$version<7&&(P.function=s.function),i.G(s.value)==="object"&&(P=s.value);let z=[];for(let k=0;k<n.length;k++)z=z.concat(w({array:n,arrayIndex:k,value:n[k],valueSpec:P,style:p,styleSpec:_,key:`${y}[${k}]`},!0));return z}function ar(f){const n=f.key,s=f.value,p=f.valueSpec;let _=i.G(s);if(_==="number"&&s!=s&&(_="NaN"),_!=="number")return[new i.V(n,s,`number expected, ${_} found`)];if("minimum"in p){let y=p.minimum;if(i.G(p.minimum)==="array"&&(y=p.minimum[f.arrayIndex]),s<y)return[new i.V(n,s,`${s} is less than the minimum value ${y}`)]}if("maximum"in p){let y=p.maximum;if(i.G(p.maximum)==="array"&&(y=p.maximum[f.arrayIndex]),s>y)return[new i.V(n,s,`${s} is greater than the maximum value ${y}`)]}return[]}function tn(f){const n=f.valueSpec,s=i.J(f.value.type);let p,_,y,w={};const P=s!=="categorical"&&f.value.property===void 0,z=!P,k=i.G(f.value.stops)==="array"&&i.G(f.value.stops[0])==="array"&&i.G(f.value.stops[0][0])==="object",D=Ur({key:f.key,value:f.value,valueSpec:f.styleSpec.function,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{stops:function(G){if(s==="identity")return[new i.V(G.key,G.value,'identity function may not have a "stops" property')];let Q=[];const J=G.value;return Q=Q.concat(Un({key:G.key,value:J,valueSpec:G.valueSpec,style:G.style,styleSpec:G.styleSpec,arrayElementValidator:j})),i.G(J)==="array"&&J.length===0&&Q.push(new i.V(G.key,J,"array must have at least one stop")),Q},default:function(G){return gr({key:G.key,value:G.value,valueSpec:n,style:G.style,styleSpec:G.styleSpec})}}});return s==="identity"&&P&&D.push(new i.V(f.key,f.value,'missing required property "property"')),s==="identity"||f.value.stops||D.push(new i.V(f.key,f.value,'missing required property "stops"')),s==="exponential"&&f.valueSpec.expression&&!i.K(f.valueSpec)&&D.push(new i.V(f.key,f.value,"exponential functions not supported")),f.styleSpec.$version>=8&&(z&&!i.L(f.valueSpec)?D.push(new i.V(f.key,f.value,"property functions not supported")):P&&!i.M(f.valueSpec)&&D.push(new i.V(f.key,f.value,"zoom functions not supported"))),s!=="categorical"&&!k||f.value.property!==void 0||D.push(new i.V(f.key,f.value,'"property" property is required')),D;function j(G){let Q=[];const J=G.value,ie=G.key;if(i.G(J)!=="array")return[new i.V(ie,J,`array expected, ${i.G(J)} found`)];if(J.length!==2)return[new i.V(ie,J,`array length 2 expected, length ${J.length} found`)];if(k){if(i.G(J[0])!=="object")return[new i.V(ie,J,`object expected, ${i.G(J[0])} found`)];if(J[0].zoom===void 0)return[new i.V(ie,J,"object stop key must have zoom")];if(J[0].value===void 0)return[new i.V(ie,J,"object stop key must have value")];const oe=i.J(J[0].zoom);if(typeof oe!="number")return[new i.V(ie,J[0].zoom,"stop zoom values must be numbers")];if(y&&y>oe)return[new i.V(ie,J[0].zoom,"stop zoom values must appear in ascending order")];oe!==y&&(y=oe,_=void 0,w={}),Q=Q.concat(Ur({key:`${ie}[0]`,value:J[0],valueSpec:{zoom:{}},style:G.style,styleSpec:G.styleSpec,objectElementValidators:{zoom:ar,value:B}}))}else Q=Q.concat(B({key:`${ie}[0]`,value:J[0],valueSpec:{},style:G.style,styleSpec:G.styleSpec},J));return i.N(i.O(J[1]))?Q.concat([new i.V(`${ie}[1]`,J[1],"expressions are not allowed in function stops.")]):Q.concat(gr({key:`${ie}[1]`,value:J[1],valueSpec:n,style:G.style,styleSpec:G.styleSpec}))}function B(G,Q){const J=i.G(G.value),ie=i.J(G.value),oe=G.value!==null?G.value:Q;if(p){if(J!==p)return[new i.V(G.key,oe,`${J} stop domain type must match previous stop domain type ${p}`)]}else p=J;if(J!=="number"&&J!=="string"&&J!=="boolean"&&typeof ie!="number"&&typeof ie!="string"&&typeof ie!="boolean")return[new i.V(G.key,oe,"stop domain value must be a number, string, or boolean")];if(J!=="number"&&s!=="categorical"){let me=`number expected, ${J} found`;return i.L(n)&&s===void 0&&(me+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new i.V(G.key,oe,me)]}return s!=="categorical"||J!=="number"||typeof ie=="number"&&isFinite(ie)&&Math.floor(ie)===ie?s!=="categorical"&&J==="number"&&typeof ie=="number"&&typeof _=="number"&&_!==void 0&&ie<_?[new i.V(G.key,oe,"stop domain values must appear in ascending order")]:(_=ie,s==="categorical"&&ie in w?[new i.V(G.key,oe,"stop domain values must be unique")]:(w[ie]=!0,[])):[new i.V(G.key,oe,`integer expected, found ${String(ie)}`)]}}function Ln(f){const n=(f.expressionContext==="property"?i.Q:i.S)(i.O(f.value),f.valueSpec);if(n.result==="error")return n.value.map(p=>new i.V(`${f.key}${p.key}`,f.value,p.message));const s=n.value.expression||n.value._styleExpression.expression;if(f.expressionContext==="property"&&f.propertyKey==="text-font"&&!s.outputDefined())return[new i.V(f.key,f.value,`Invalid data expression for "${f.propertyKey}". Output values must be contained as literals within the expression.`)];if(f.expressionContext==="property"&&f.propertyType==="layout"&&!i.U(s))return[new i.V(f.key,f.value,'"feature-state" data expressions are not supported with layout properties.')];if(f.expressionContext==="filter")return Xr(s,f);if(f.expressionContext&&f.expressionContext.indexOf("cluster")===0){if(!i.W(s,["zoom","feature-state"]))return[new i.V(f.key,f.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(f.expressionContext==="cluster-initial"&&!i.X(s))return[new i.V(f.key,f.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Xr(f,n){const s=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const _ of n.valueSpec.expression.parameters)s.delete(_);if(s.size===0)return[];const p=[];return f instanceof i.Y&&s.has(f.name)?[new i.V(n.key,n.value,`["${f.name}"] expression is not supported in a filter for a ${n.object.type} layer with id: ${n.object.id}`)]:(f.eachChild(_=>{p.push(...Xr(_,n))}),p)}function hn(f){const n=f.key,s=f.value,p=f.valueSpec,_=[];return Array.isArray(p.values)?p.values.indexOf(i.J(s))===-1&&_.push(new i.V(n,s,`expected one of [${p.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(p.values).indexOf(i.J(s))===-1&&_.push(new i.V(n,s,`expected one of [${Object.keys(p.values).join(", ")}], ${JSON.stringify(s)} found`)),_}function fr(f){return i._(i.O(f.value))?Ln(i.H({},f,{expressionContext:"filter",valueSpec:f.styleSpec[`filter_${f.layerType||"fill"}`]})):Jt(f)}function Jt(f){const n=f.value,s=f.key;if(i.G(n)!=="array")return[new i.V(s,n,`array expected, ${i.G(n)} found`)];const p=f.styleSpec;let _,y=[];if(n.length<1)return[new i.V(s,n,"filter array must have at least 1 element")];switch(y=y.concat(hn({key:`${s}[0]`,value:n[0],valueSpec:p.filter_operator,style:f.style,styleSpec:f.styleSpec})),i.J(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&i.J(n[1])==="$type"&&y.push(new i.V(s,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&y.push(new i.V(s,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(_=i.G(n[1]),_!=="string"&&y.push(new i.V(`${s}[1]`,n[1],`string expected, ${_} found`)));for(let w=2;w<n.length;w++)_=i.G(n[w]),i.J(n[1])==="$type"?y=y.concat(hn({key:`${s}[${w}]`,value:n[w],valueSpec:p.geometry_type,style:f.style,styleSpec:f.styleSpec})):_!=="string"&&_!=="number"&&_!=="boolean"&&y.push(new i.V(`${s}[${w}]`,n[w],`string, number, or boolean expected, ${_} found`));break;case"any":case"all":case"none":for(let w=1;w<n.length;w++)y=y.concat(Jt({key:`${s}[${w}]`,value:n[w],style:f.style,styleSpec:f.styleSpec}));break;case"has":case"!has":_=i.G(n[1]),n.length!==2?y.push(new i.V(s,n,`filter array for "${n[0]}" operator must have 2 elements`)):_!=="string"&&y.push(new i.V(`${s}[1]`,n[1],`string expected, ${_} found`))}return y}function bn(f,n){const s=f.key,p=f.style,_=f.layer,y=f.styleSpec,w=f.value,P=f.objectKey,z=y[`${n}_${f.layerType}`];if(!z)return[];const k=P.match(/^(.*)-use-theme$/);if(n==="paint"&&k&&z[k[1]])return gr({key:s,value:w,valueSpec:{type:"string"},style:p,styleSpec:y});const D=P.match(/^(.*)-transition$/);if(n==="paint"&&D&&z[D[1]]&&z[D[1]].transition)return gr({key:s,value:w,valueSpec:y.transition,style:p,styleSpec:y});const j=f.valueSpec||z[P];if(!j)return[new i.F(s,w,`unknown property "${P}"`)];let B;if(i.G(w)==="string"&&i.L(j)&&!j.tokens&&(B=/^{([^}]+)}$/.exec(w))){const Q=`\`{ "type": "identity", "property": ${B?JSON.stringify(B[1]):'"_"'} }\``;return[new i.V(s,w,`"${P}" does not support interpolation syntax
Use an identity property function instead: ${Q}.`)]}const G=[];if(f.layerType==="symbol")P!=="text-field"||!p||p.glyphs||p.imports||G.push(new i.V(s,w,'use of "text-field" requires a style "glyphs" property')),P==="text-font"&&i.$(i.O(w))&&i.J(w.type)==="identity"&&G.push(new i.V(s,w,'"text-font" does not support identity functions'));else if(f.layerType==="model"&&n==="paint"&&_&&_.layout&&_.layout.hasOwnProperty("model-id")&&i.L(j)&&(i.a0(j)||i.M(j))){const Q=i.Q(i.O(w),j),J=Q.value.expression||Q.value._styleExpression.expression;J&&!i.W(J,["measure-light"])&&(P==="model-emissive-strength"&&i.X(J)&&i.U(J)||G.push(new i.V(s,w,`${P} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return G.concat(gr({key:f.key,value:w,valueSpec:j,style:p,styleSpec:y,expressionContext:"property",propertyType:n,propertyKey:P}))}function gn(f){return bn(f,"paint")}function Kn(f){return bn(f,"layout")}function dn(f){let n=[];const s=f.value,p=f.key,_=f.style,y=f.styleSpec;s.type||s.ref||n.push(new i.V(p,s,'either "type" or "ref" is required'));let w=i.J(s.type);const P=i.J(s.ref);if(s.id){const z=i.J(s.id);for(let k=0;k<f.arrayIndex;k++){const D=_.layers[k];i.J(D.id)===z&&n.push(new i.V(p,s.id,`duplicate layer id "${s.id}", previously used at line ${D.id.__line__}`))}}if("ref"in s){let z;["type","source","source-layer","filter","layout"].forEach(k=>{k in s&&n.push(new i.V(p,s[k],`"${k}" is prohibited for ref layers`))}),_.layers.forEach(k=>{i.J(k.id)===P&&(z=k)}),z?z.ref?n.push(new i.V(p,s.ref,"ref cannot reference another ref layer")):w=i.J(z.type):typeof P=="string"&&n.push(new i.V(p,s.ref,`ref layer "${P}" not found`))}else if(w!=="background"&&w!=="sky"&&w!=="slot")if(s.source){const z=_.sources&&_.sources[s.source],k=z&&i.J(z.type);z?k==="vector"&&w==="raster"?n.push(new i.V(p,s.source,`layer "${s.id}" requires a raster source`)):k==="raster"&&w!=="raster"?n.push(new i.V(p,s.source,`layer "${s.id}" requires a vector source`)):k!=="vector"||s["source-layer"]?k==="raster-dem"&&w!=="hillshade"?n.push(new i.V(p,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):k!=="raster-array"||["raster","raster-particle"].includes(w)?w!=="line"||!s.paint||!s.paint["line-gradient"]&&!s.paint["line-trim-offset"]||k==="geojson"&&z.lineMetrics?w==="raster-particle"&&k!=="raster-array"&&n.push(new i.V(p,s.source,`layer "${s.id}" requires a 'raster-array' source.`)):n.push(new i.V(p,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new i.V(p,s.source,"raster-array source can only be used with layer type 'raster'.")):n.push(new i.V(p,s,`layer "${s.id}" must specify a "source-layer"`)):n.push(new i.V(p,s.source,`source "${s.source}" not found`))}else n.push(new i.V(p,s,'missing required property "source"'));return n=n.concat(Ur({key:p,value:s,valueSpec:y.layer,style:f.style,styleSpec:f.styleSpec,objectElementValidators:{"*":()=>[],type:()=>gr({key:`${p}.type`,value:s.type,valueSpec:y.layer.type,style:f.style,styleSpec:f.styleSpec,object:s,objectKey:"type"}),filter:z=>fr(i.H({layerType:w},z)),layout:z=>Ur({layer:s,key:z.key,value:z.value,valueSpec:{},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{"*":k=>Kn(i.H({layerType:w},k))}}),paint:z=>Ur({layer:s,key:z.key,value:z.value,valueSpec:{},style:z.style,styleSpec:z.styleSpec,objectElementValidators:{"*":k=>gn(i.H({layerType:w,layer:s},k))}})}})),n}function di(f){const n=f.value,s=f.key,p=i.G(n);return p!=="string"?[new i.V(s,n,`string expected, ${p} found`)]:[]}const Ui={promoteId:function({key:f,value:n}){if(i.G(n)==="string")return di({key:f,value:n});{const s=[];for(const p in n)s.push(...di({key:`${f}.${p}`,value:n[p]}));return s}}};function Ji(f){const n=f.value,s=f.key,p=f.styleSpec,_=f.style;if(!n.type)return[new i.V(s,n,'"type" is required')];const y=i.J(n.type);let w=[];switch(["vector","raster","raster-dem","raster-array"].includes(y)&&(n.url||n.tiles||w.push(new i.F(s,n,'Either "url" or "tiles" is required.'))),y){case"vector":case"raster":case"raster-dem":case"raster-array":return w=w.concat(Ur({key:s,value:n,valueSpec:p[`source_${y.replace("-","_")}`],style:f.style,styleSpec:p,objectElementValidators:Ui})),w;case"geojson":if(w=Ur({key:s,value:n,valueSpec:p.source_geojson,style:_,styleSpec:p,objectElementValidators:Ui}),n.cluster)for(const P in n.clusterProperties){const[z,k]=n.clusterProperties[P],D=typeof z=="string"?[z,["accumulated"],["get",P]]:z;w.push(...Ln({key:`${s}.${P}.map`,value:k,expressionContext:"cluster-map"})),w.push(...Ln({key:`${s}.${P}.reduce`,value:D,expressionContext:"cluster-reduce"}))}return w;case"video":return Ur({key:s,value:n,valueSpec:p.source_video,style:_,styleSpec:p});case"image":return Ur({key:s,value:n,valueSpec:p.source_image,style:_,styleSpec:p});case"canvas":return[new i.V(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return hn({key:`${s}.type`,value:n.type,valueSpec:{values:nn(p)},style:_,styleSpec:p})}}function nn(f){return f.source.reduce((n,s)=>{const p=f[s];return p.type.type==="enum"&&(n=n.concat(Object.keys(p.type.values))),n},[])}function En(f){const n=f.value,s=f.styleSpec,p=s.light,_=f.style;let y=[];const w=i.G(n);if(n===void 0)return y;if(w!=="object")return y=y.concat([new i.V("light",n,`object expected, ${w} found`)]),y;for(const P in n){const z=P.match(/^(.*)-transition$/),k=P.match(/^(.*)-use-theme$/);y=y.concat(k&&p[k[1]]?gr({key:P,value:n[P],valueSpec:{type:"string"},style:_,styleSpec:s}):z&&p[z[1]]&&p[z[1]].transition?gr({key:P,value:n[P],valueSpec:s.transition,style:_,styleSpec:s}):p[P]?gr({key:P,value:n[P],valueSpec:p[P],style:_,styleSpec:s}):[new i.V(P,n[P],`unknown property "${P}"`)])}return y}function Jn(f){const n=f.value;let s=[];if(!n)return s;const p=i.G(n);if(p!=="object")return s=s.concat([new i.V("light-3d",n,`object expected, ${p} found`)]),s;const _=f.styleSpec,y=_["light-3d"],w=f.key,P=f.style,z=f.style.lights;for(const j of["type","id"])if(!(j in n))return s=s.concat([new i.V("light-3d",n,`missing property ${j} on light`)]),s;if(n.type&&z)for(let j=0;j<f.arrayIndex;j++){const B=i.J(n.type),G=z[j];i.J(G.type)===B&&s.push(new i.V(w,n.id,`duplicate light type "${n.type}", previously defined at line ${G.id.__line__}`))}const k=`properties_light_${n.type}`;if(!(k in _))return s=s.concat([new i.V("light-3d",n,`Invalid light type ${n.type}`)]),s;const D=_[k];for(const j in n)if(j==="properties"){const B=n[j],G=i.G(B);if(G!=="object")return s=s.concat([new i.V("properties",B,`object expected, ${G} found`)]),s;for(const Q in B)s=s.concat(D[Q]?gr({key:Q,value:B[Q],valueSpec:D[Q],style:P,styleSpec:_}):[new i.F(f.key,B[Q],`unknown property "${Q}"`)])}else{const B=j.match(/^(.*)-transition$/),G=j.match(/^(.*)-use-theme$/);s=s.concat(G&&y[G[1]]?gr({key:j,value:n[j],valueSpec:{type:"string"},style:P,styleSpec:_}):B&&y[B[1]]&&y[B[1]].transition?gr({key:j,value:n[j],valueSpec:_.transition,style:P,styleSpec:_}):y[j]?gr({key:j,value:n[j],valueSpec:y[j],style:P,styleSpec:_}):[new i.F(j,n[j],`unknown property "${j}"`)])}return s}function zo(f){const n=f.value,s=f.key,p=f.style,_=f.styleSpec,y=_.terrain;let w=[];const P=i.G(n);if(n===void 0||P==="null")return w;if(P!=="object")return w=w.concat([new i.V("terrain",n,`object expected, ${P} found`)]),w;for(const z in n){const k=z.match(/^(.*)-transition$/),D=z.match(/^(.*)-use-theme$/);w=w.concat(D&&y[D[1]]?gr({key:z,value:n[z],valueSpec:{type:"string"},style:p,styleSpec:_}):k&&y[k[1]]&&y[k[1]].transition?gr({key:z,value:n[z],valueSpec:_.transition,style:p,styleSpec:_}):y[z]?gr({key:z,value:n[z],valueSpec:y[z],style:p,styleSpec:_}):[new i.F(z,n[z],`unknown property "${z}"`)])}if(n.source){const z=p.sources&&p.sources[n.source],k=z&&i.J(z.type);z?k!=="raster-dem"&&w.push(new i.V(s,n.source,`terrain cannot be used with a source of type ${String(k)}, it only be used with a "raster-dem" source type`)):w.push(new i.V(s,n.source,`source "${n.source}" not found`))}else w.push(new i.V(s,n,'terrain is missing required property "source"'));return w}function _i(f){const n=f.value,s=f.style,p=f.styleSpec,_=p.fog;let y=[];const w=i.G(n);if(n===void 0)return y;if(w!=="object")return y=y.concat([new i.V("fog",n,`object expected, ${w} found`)]),y;for(const P in n){const z=P.match(/^(.*)-transition$/),k=P.match(/^(.*)-use-theme$/);y=y.concat(k&&_[k[1]]?gr({key:P,value:n[P],valueSpec:{type:"string"},style:s,styleSpec:p}):z&&_[z[1]]&&_[z[1]].transition?gr({key:P,value:n[P],valueSpec:p.transition,style:s,styleSpec:p}):_[P]?gr({key:P,value:n[P],valueSpec:_[P],style:s,styleSpec:p}):[new i.F(P,n[P],`unknown property "${P}"`)])}return y}const bi={"*":()=>[],array:Un,boolean:function(f){const n=f.value,s=f.key,p=i.G(n);return p!=="boolean"?[new i.V(s,n,`boolean expected, ${p} found`)]:[]},number:ar,color:function(f){const n=f.key,s=f.value,p=i.G(s);return p!=="string"?[new i.V(n,s,`color expected, ${p} found`)]:i.Z.parseCSSColor(s)===null?[new i.V(n,s,`color expected, "${s}" found`)]:[]},enum:hn,filter:fr,function:tn,layer:dn,object:Ur,source:Ji,model:i.a1,light:En,"light-3d":Jn,terrain:zo,fog:_i,string:di,formatted:function(f){return di(f).length===0?[]:Ln(f)},resolvedImage:function(f){return di(f).length===0?[]:Ln(f)},projection:function(f){const n=f.value,s=f.styleSpec,p=s.projection,_=f.style;let y=[];const w=i.G(n);if(w==="object")for(const P in n)y=y.concat(gr({key:P,value:n[P],valueSpec:p[P],style:_,styleSpec:s}));else w!=="string"&&(y=y.concat([new i.V("projection",n,`object or string expected, ${w} found`)]));return y},import:function(f){const{value:n,styleSpec:s}=f,{data:p,..._}=n;Object.defineProperty(_,"__line__",{value:n.__line__,enumerable:!1});let y=Ur(i.H({},f,{value:_,valueSpec:s.import}));return i.J(_.id)===""&&y.push(new i.V(`${f.key}.id`,_,"import id can't be an empty string")),p&&(y=y.concat(Lo(p,s,{key:`${f.key}.data`}))),y}};function gr(f,n=!1){const s=f.value,p=f.valueSpec,_=f.styleSpec;if(p.expression&&i.$(i.J(s)))return tn(f);if(p.expression&&i.N(i.O(s)))return Ln(f);if(p.type&&bi[p.type]){const y=bi[p.type](f);return n===!0&&y.length>0&&i.G(f.value)==="array"?Ln(f):y}return Ur(i.H({},f,{valueSpec:p.type?_[p.type]:p}))}function Gi(f){const n=f.value,s=f.key,p=di(f);return p.length||(n.indexOf("{fontstack}")===-1&&p.push(new i.V(s,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&p.push(new i.V(s,n,'"glyphs" url must include a "{range}" token'))),p}function Lo(f,n=i.a2,s={}){return gr({key:s.key||"",value:f,valueSpec:n.$root,styleSpec:n,style:f,objectElementValidators:{glyphs:Gi,"*":()=>[]}})}function li(f,n=i.a2){return ke(Lo(f,n))}const Hi=f=>ke(Ji(f)),fi=f=>ke(En(f)),pi=f=>ke(Jn(f)),Wi=f=>ke(zo(f)),Bn=f=>ke(_i(f)),it=f=>ke(function(n){const s=n.value,p=n.style,_=n.styleSpec,y=_.snow;let w=[];const P=i.G(s);if(s===void 0)return w;if(P!=="object")return w=w.concat([new i.V("snow",s,`object expected, ${P} found`)]),w;for(const z in s){const k=z.match(/^(.*)-transition$/);w=w.concat(k&&y[k[1]]&&y[k[1]].transition?gr({key:z,value:s[z],valueSpec:_.transition,style:p,styleSpec:_}):y[z]?gr({key:z,value:s[z],valueSpec:y[z],style:p,styleSpec:_}):[new i.F(z,s[z],`unknown property "${z}"`)])}return w}(f)),te=f=>ke(function(n){const s=n.value,p=n.style,_=n.styleSpec,y=_.rain;let w=[];const P=i.G(s);if(s===void 0)return w;if(P!=="object")return w=w.concat([new i.V("rain",s,`object expected, ${P} found`)]),w;for(const z in s){const k=z.match(/^(.*)-transition$/);w=w.concat(k&&y[k[1]]&&y[k[1]].transition?gr({key:z,value:s[z],valueSpec:_.transition,style:p,styleSpec:_}):y[z]?gr({key:z,value:s[z],valueSpec:y[z],style:p,styleSpec:_}):[new i.F(z,s[z],`unknown property "${z}"`)])}return w}(f)),le=f=>ke(dn(f)),K=f=>ke(fr(f)),he=f=>ke(gn(f)),de=f=>ke(Kn(f)),xe=f=>ke(i.a1(f));function ke(f){return f.slice().sort((n,s)=>n.line&&s.line?n.line-s.line:0)}function ze(f,n){let s=!1;if(n&&n.length)for(const p of n)p instanceof i.F?i.w(p.message):(f.fire(new i.y(new Error(p.message))),s=!0);return s}let He;class Ue extends i.E{constructor(n,s="flat"){super(),this._transitionable=new i.a3(He||(He=new i.a4({anchor:new i.a5(i.a2.light.anchor),position:new i.a6(i.a2.light.position),color:new i.a5(i.a2.light.color),intensity:new i.a5(i.a2.light.intensity)}))),this.setLight(n,s),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,s,p={}){this._validate(fi,n,p)||(this._transitionable.setTransitionOrValue(n),this.id=s)}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,s,p){return(!p||p.validate!==!1)&&ze(this,n.call(li,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a2})))}}let Ze=class extends i.E{constructor(f,n,s,p){super(),this.scope=s,this._transitionable=new i.a3(new i.a4({source:new i.a5(i.a2.terrain.source),exaggeration:new i.a5(i.a2.terrain.exaggeration)}),s,p),this._transitionable.setTransitionOrValue(f,p),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n}get(){return this._transitionable.serialize()}set(f,n){this._transitionable.setTransitionOrValue(f,n)}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}getExaggeration(f){return this._transitioning.possiblyEvaluate(new i.a7(f)).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const f=this._transitionable._values.exaggeration;if(!f)return null;const n=f.value.expression;if(!n)return null;let s=-1,p=-1,_=1;for(const y of n.zoomStops)_=n.evaluate(new i.a7(y)),_>.01?(s=y,p=-1):p=y;return _<.01&&s>0&&p>s?[s,p]:null}isZoomDependent(){const f=this._transitionable._values.exaggeration;return f!=null&&f.value!=null&&f.value.expression!=null&&f.value.expression instanceof i.a8}};const ot=45,pt=65,St=.05;function Ut(f,n,s,p){const _=i.ab(ot,pt,s),[y,w]=tr(f,p);let P=1-Math.min(1,Math.exp((n-y)/(w-y)*-6));return P*=P*P,P=Math.min(1,1.00747*P),P*_*f.alpha}function tr(f,n){const s=.5/Math.tan(.5*n);return[f.range[0]+s,f.range[1]+s]}function Gt(f,n,s,p,_){const y=i.aa.vec3.transformMat4([],[n,s,p],_.mercatorFogMatrix);return Ut(f,i.aa.vec3.length(y),_.pitch,_._fov)}function Xt(f,n,s,p,_,y,w){const P=[[s,p,0],[_,p,0],[_,y,0],[s,y,0]];let z=Number.MAX_VALUE,k=-Number.MAX_VALUE;for(const D of P){const j=i.aa.vec3.transformMat4([],D,n),B=i.aa.vec3.length(j);z=Math.min(z,B),k=Math.max(k,B)}return[Ut(f,z,w.pitch,w._fov),Ut(f,k,w.pitch,w._fov)]}class vr extends i.E{constructor(n,s,p,_){super();const y=new i.a4({range:new i.a5(i.a2.fog.range),color:new i.a5(i.a2.fog.color),"color-use-theme":new i.a5({type:"string","property-type":"data-constant",default:"default"}),"high-color":new i.a5(i.a2.fog["high-color"]),"high-color-use-theme":new i.a5({type:"string","property-type":"data-constant",default:"default"}),"space-color":new i.a5(i.a2.fog["space-color"]),"space-color-use-theme":new i.a5({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new i.a5(i.a2.fog["horizon-blend"]),"star-intensity":new i.a5(i.a2.fog["star-intensity"]),"vertical-range":new i.a5(i.a2.fog["vertical-range"])});this._transitionable=new i.a3(y,p,new Map(_)),this.set(n,_),this._transitioning=this._transitionable.untransitioned(),this._transform=s,this.properties=new i.ac(y),this.scope=p}get state(){const n=this._transform,s=n.projection.name==="globe",p=i.ad(n.zoom),_=this.properties.get("range"),y=[.5,3];return{range:s?[i.ae(y[0],_[0],p),i.ae(y[1],_[1],p)]:_,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(n,s,p={}){if(this._validate(Bn,n,p))return;const _=i.l({},n);for(const y of Object.keys(i.a2.fog))_[y]===void 0&&(_[y]=i.a2.fog[y].default);this._options=_,this._transitionable.setTransitionOrValue(this._options,s)}getOpacity(n){if(!this._transform.projection.supportsFog)return 0;const s=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:i.ab(ot,pt,n))*s.a}getOpacityAtLatLng(n,s){return this._transform.projection.supportsFog?function(p,_,y){const w=i.a9.fromLngLat(_),P=y.elevation?y.elevation.getAtPointOrZero(w):0;return Gt(p,w.x,w.y,P,y)}(this.state,n,s):0}getOpacityForTile(n){if(!this._transform.projection.supportsFog)return[1,1];const s=this._transform.calculateFogTileMatrix(n.toUnwrapped());return Xt(this.state,s,0,0,i.af,i.af,this._transform)}getOpacityForBounds(n,s,p,_,y){return this._transform.projection.supportsFog?Xt(this.state,n,s,p,_,y,this._transform):[1,1]}getFovAdjustedRange(n){return this._transform.projection.supportsFog?tr(this.state,n):[0,1]}isVisibleOnFrustum(n){if(!this._transform.projection.supportsFog)return!1;const s=[4,5,6,7];for(const p of s){const _=n.points[p];let y;if(_[2]>=0)y=_;else{const w=n.points[p-4];y=i.ag(w,_,w[2]/(w[2]-_[2]))}if(Gt(this.state,y[0],y[1],0,this._transform)>=St)return!0}return!1}updateConfig(n){this._transitionable.setTransitionOrValue(this._options,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,s,p){return(!p||p.validate!==!1)&&ze(this,n.call(li,i.l({value:s,style:{glyphs:!0,sprite:!0},styleSpec:i.a2})))}}let Nr,dr,Vr,Gr,In=class extends i.E{constructor(f,n,s,p){super();const _=Nr||(Nr=new i.a4({density:new i.a5(i.a2.snow.density),intensity:new i.a5(i.a2.snow.intensity),color:new i.a5(i.a2.snow.color),opacity:new i.a5(i.a2.snow.opacity),vignette:new i.a5(i.a2.snow.vignette),"vignette-color":new i.a5(i.a2.snow["vignette-color"]),"center-thinning":new i.a5(i.a2.snow["center-thinning"]),direction:new i.a5(i.a2.snow.direction),"flake-size":new i.a5(i.a2.snow["flake-size"])}));this._transitionable=new i.a3(_,s,new Map(p)),this.set(f,p),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ac(_),this.scope=s}get state(){const f=this.properties.get("opacity"),n=this.properties.get("color"),s=this.properties.get("direction"),p=i.ah(s[0]),_=-Math.max(i.ah(s[1]),.01),y=[Math.cos(p)*Math.cos(_),Math.sin(p)*Math.cos(_),Math.sin(_)],w=this.properties.get("vignette"),P=this.properties.get("vignette-color");return P.a=w,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.ai(n.r,n.g,n.b,n.a*f),direction:y,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:P}}get(){return this._transitionable.serialize()}set(f,n,s={}){if(this._validate(it,f,s))return;const p=i.l({},f);for(const _ of Object.keys(i.a2.snow))p[_]===void 0&&(p[_]=i.a2.snow[_].default);this._options=p,this._transitionable.setTransitionOrValue(this._options,n)}updateConfig(f){this._transitionable.setTransitionOrValue(this._options,new Map(f))}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}_validate(f,n,s){return(!s||s.validate!==!1)&&ze(this,f.call(li,i.l({value:n,style:{glyphs:!0,sprite:!0},styleSpec:i.a2})))}},ii=class extends i.E{constructor(f,n,s,p){super();const _=dr||(dr=new i.a4({density:new i.a5(i.a2.rain.density),intensity:new i.a5(i.a2.rain.intensity),color:new i.a5(i.a2.rain.color),opacity:new i.a5(i.a2.rain.opacity),vignette:new i.a5(i.a2.rain.vignette),"vignette-color":new i.a5(i.a2.rain["vignette-color"]),"center-thinning":new i.a5(i.a2.rain["center-thinning"]),direction:new i.a5(i.a2.rain.direction),"droplet-size":new i.a5(i.a2.rain["droplet-size"]),"distortion-strength":new i.a5(i.a2.rain["distortion-strength"])}));this._transitionable=new i.a3(_,s,new Map(p)),this.set(f,p),this._transitioning=this._transitionable.untransitioned(),this.properties=new i.ac(_),this.scope=s}get state(){const f=this.properties.get("opacity"),n=this.properties.get("color"),s=this.properties.get("direction"),p=i.ah(s[0]),_=-Math.max(i.ah(s[1]),.01),y=[Math.cos(p)*Math.cos(_),Math.sin(p)*Math.cos(_),Math.sin(_)],w=this.properties.get("vignette-color");return w.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new i.ai(n.r,n.g,n.b,n.a*f),direction:y,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:w}}get(){return this._transitionable.serialize()}set(f,n,s={}){if(this._validate(te,f,s))return;const p=i.l({},f);for(const _ of Object.keys(i.a2.rain))p[_]===void 0&&(p[_]=i.a2.rain[_].default);this._options=p,this._transitionable.setTransitionOrValue(this._options,n)}updateConfig(f){this._transitionable.setTransitionOrValue(this._options,new Map(f))}updateTransitions(f){this._transitioning=this._transitionable.transitioned(f,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(f){this.properties=this._transitioning.possiblyEvaluate(f)}_validate(f,n,s){return(!s||s.validate!==!1)&&ze(this,f.call(li,i.l({value:n,style:{glyphs:!0,sprite:!0},styleSpec:i.a2})))}};class $n extends i.E{constructor(n,s,p,_){super(),this.scope=p,this._options=n,this.properties=new i.ac(s),this._transitionable=new i.a3(s,p,new Map(_)),this._transitionable.setTransitionOrValue(n.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(n){this._transitionable.setTransitionOrValue(this._options.properties,new Map(n))}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(n,s){this._options=n,this._transitionable.setTransitionOrValue(n.properties,s)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Qn{constructor(n,s,p,_){this.screenBounds=n,this.cameraPoint=s,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,_)}static createFromScreenPoints(n,s){let p,_;if(n instanceof i.P||typeof n[0]=="number"){const y=i.P.convert(n);p=[y],_=s.isPointAboveHorizon(y)}else{const y=i.P.convert(n[0]),w=i.P.convert(n[1]);p=[y,w],_=i.ak(y,w).every(P=>s.isPointAboveHorizon(P))}return new Qn(p,s.getCameraPoint(),_,s)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(n){return i.ak(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],n)}bufferedCameraGeometry(n){const s=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],_=i.ak(s,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>s.x&&this.cameraPoint.x<p.x?_.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?_[2]=this.cameraPoint:this.cameraPoint.x<=s.x&&(_[3]=this.cameraPoint)),i.al(_,n)}bufferedCameraGeometryGlobe(n){const s=this.screenBounds[0],p=this.screenBounds.length===1?this.screenBounds[0].add(new i.P(1,1)):this.screenBounds[1],_=i.ak(s,p,n),y=this.cameraPoint.clone();switch(3*((y.y>s.y)+(y.y>p.y))+((y.x>s.x)+(y.x>p.x))){case 0:_[0]=y,_[4]=y.clone();break;case 1:_.splice(1,0,y);break;case 2:_[1]=y;break;case 3:_.splice(4,0,y);break;case 5:_.splice(2,0,y);break;case 6:_[3]=y;break;case 7:_.splice(3,0,y);break;case 8:_[2]=y}return _}containsTile(n,s,p,_=0){const y=n.queryPadding/s._pixelsPerMercatorPixel+1,w=p?this._bufferedCameraMercator(y,s):this._bufferedScreenMercator(y,s);let P=n.tileID.wrap+(w.unwrapped?_:0);const z=w.polygon.map(ie=>i.am(n.tileTransform,ie,P));if(!i.an(z,0,0,i.af,i.af))return;P=n.tileID.wrap+(this.screenGeometryMercator.unwrapped?_:0);const k=this.screenGeometryMercator.polygon.map(ie=>i.ao(n.tileTransform,ie,P)),D=k.map(ie=>new i.P(ie[0],ie[1])),j=s.getFreeCameraOptions().position||new i.a9(0,0,0),B=i.ao(n.tileTransform,j,P),G=k.map(ie=>{const oe=i.aa.vec3.sub(ie,ie,B);return i.aa.vec3.normalize(oe,oe),new i.ap(B,oe)}),Q=i.aq(n,1,s.zoom)*s._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:D,tilespaceRays:G,bufferedTilespaceGeometry:z,bufferedTilespaceBounds:(J=i.ar(z),J.min.x=i.av(J.min.x,0,i.af),J.min.y=i.av(J.min.y,0,i.af),J.max.x=i.av(J.max.x,0,i.af),J.max.y=i.av(J.max.y,0,i.af),J),tile:n,tileID:n.tileID,pixelToTileUnitsFactor:Q};var J}_bufferedScreenMercator(n,s){const p=Gn(n);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let _;return _=s.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(n),s):{polygon:this.bufferedScreenGeometry(n).map(y=>s.pointCoordinate3D(y)),unwrapped:!0},this._screenRaycastCache[p]=_,_}}_bufferedCameraMercator(n,s){const p=Gn(n);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let _;return _=s.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(n),s):{polygon:this.bufferedCameraGeometry(n).map(y=>s.pointCoordinate3D(y)),unwrapped:!0},this._cameraRaycastCache[p]=_,_}}_projectAndResample(n,s){const p=function(y,w){const P=i.aa.mat4.multiply([],w.pixelMatrix,w.globeMatrix),z=[0,-i.aw,0,1],k=[0,i.aw,0,1],D=[0,0,0,1];i.aa.vec4.transformMat4(z,z,P),i.aa.vec4.transformMat4(k,k,P),i.aa.vec4.transformMat4(D,D,P);const j=new i.P(z[0]/z[3],z[1]/z[3]),B=new i.P(k[0]/k[3],k[1]/k[3]),G=i.at(y,j)&&z[3]<D[3],Q=i.at(y,B)&&k[3]<D[3];if(!G&&!Q)return null;const J=function(Ie,Ce,De){for(let $e=1;$e<Ie.length;$e++){const at=Yr(Ce.pointCoordinate3D(Ie[$e-1]).x),rt=Yr(Ce.pointCoordinate3D(Ie[$e]).x);if(De<0){if(at<rt)return{idx:$e,t:-at/(rt-1-at)}}else if(rt<at)return{idx:$e,t:(1-at)/(rt+1-at)}}return null}(y,w,G?-1:1);if(!J)return null;const{idx:ie,t:oe}=J;let me=ie>1?so(y.slice(0,ie),w):[],Se=ie<y.length?so(y.slice(ie),w):[];me=me.map(Ie=>new i.P(Yr(Ie.x),Ie.y)),Se=Se.map(Ie=>new i.P(Yr(Ie.x),Ie.y));const be=[...me];be.length===0&&be.push(Se[Se.length-1]);const Pe=i.ae(be[be.length-1].y,(Se.length===0?me[0]:Se[0]).y,oe);let Me;return Me=G?[new i.P(0,Pe),new i.P(0,0),new i.P(1,0),new i.P(1,Pe)]:[new i.P(1,Pe),new i.P(1,1),new i.P(0,1),new i.P(0,Pe)],be.push(...Me),Se.length===0?be.push(me[0]):be.push(...Se),{polygon:be.map(Ie=>new i.a9(Ie.x,Ie.y)),unwrapped:!1}}(n,s);if(p)return p;const _=function(y,w){let P=!1,z=-1/0,k=0;for(let j=0;j<y.length-1;j++)y[j].x>z&&(z=y[j].x,k=j);for(let j=0;j<y.length-1;j++){const B=(k+j)%(y.length-1),G=y[B],Q=y[B+1];Math.abs(G.x-Q.x)>.5&&(G.x<Q.x?(G.x+=1,B===0&&(y[y.length-1].x+=1)):(Q.x+=1,B+1===y.length-1&&(y[0].x+=1)),P=!0)}const D=i.as(w.center.lng);return P&&D<Math.abs(D-1)&&y.forEach(j=>{j.x-=1}),{polygon:y,unwrapped:P}}(so(n,s).map(y=>new i.P(Yr(y.x),y.y)),s);return{polygon:_.polygon.map(y=>new i.a9(y.x,y.y)),unwrapped:_.unwrapped}}}function so(f,n){return i.au(f,s=>{const p=n.pointCoordinate3D(s);s.x=p.x,s.y=p.y},1/256)}function Yr(f){return f<0?1+f%1:f%1}function Gn(f){return 100*f|0}function Qi(f,n,s,p,_){const y=function(P,z){if(P)return _(P);if(z){if(f.url&&z.tiles&&f.tiles&&delete f.tiles,z.variants){if(!Array.isArray(z.variants))return _(new Error("variants must be an array"));for(const D of z.variants){if(D==null||typeof D!="object"||D.constructor!==Object)return _(new Error("variant must be an object"));if(!Array.isArray(D.capabilities))return _(new Error("capabilities must be an array"));if(D.capabilities.length===1&&D.capabilities[0]==="meshopt"){z=i.l(z,D);break}}}const k=i.ax(i.l({},z,f),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);k.tiles=n.canonicalizeTileset(k,f.url),_(null,k)}},w=function(P,z,k){if(!P)return null;if(!z&&!k)return P;k=k||P.worldview_default;const D=Object.values(P.language||{});if(D.length===0)return null;const j=Object.values(P.worldview||{});if(j.length===0)return null;const B=D.every(Q=>Q===z),G=j.every(Q=>Q===k);return B&&G?P:z in(P.language_options||{})||k in(P.worldview_options||{})?null:P.language_options&&P.worldview_options?P:null}(f.data,s,p);return w?i.q.frame(()=>y(null,w)):f.url?i.n(n.transformRequest(n.normalizeSourceURL(f.url,null,s,p),i.R.Source),y):i.q.frame(()=>{const{data:P,...z}=f;y(null,z)})}class wi{constructor(n,s,p){this.bounds=i.ay.convert(this.validateBounds(n)),this.minzoom=s||0,this.maxzoom=p||24}validateBounds(n){return Array.isArray(n)&&n.length===4?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const s=Math.pow(2,n.z),p=Math.floor(i.as(this.bounds.getWest())*s),_=Math.floor(i.az(this.bounds.getNorth())*s),y=Math.ceil(i.as(this.bounds.getEast())*s),w=Math.ceil(i.az(this.bounds.getSouth())*s);return n.x>=p&&n.x<y&&n.y>=_&&n.y<w}}class Zn extends i.E{constructor(n,s,p,_){if(super(),this.id=n,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,i.l(this,i.ax(s,["url","scheme","tileSize","promoteId"])),this._options=i.l({type:"vector"},s),this._collectResourceTiming=!!s.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new i.aA}load(n){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const s=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map.getWorldview();this._tileJSONRequest=Qi(this._options,this.map._requestManager,s,p,(_,y)=>{if(this._tileJSONRequest=null,this._loaded=!0,_)s&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${s}`),p&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new i.y(_));else if(y){if(i.l(this,y),this.hasWorldviews=!!y.worldview_options,y.worldview_default&&(this.worldviewDefault=y.worldview_default),y.vector_layers){this.vectorLayers=y.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const w of y.vector_layers)this.vectorLayerIds.push(w.id),y.worldview&&y.worldview[w.source]&&this.localizableLayerIds.add(w.id)}y.bounds&&(this.tileBounds=new wi(y.bounds,this.minzoom,this.maxzoom)),At(y.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}n&&n(_)})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=i.aB(this.id,this.scope);this.load(()=>this.map.style.clearSource(n))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}loadTile(n,s){const p=n.tileID.canonical.url(this.tiles,this.scheme),_=this.map._requestManager.normalizeTileURL(p),y=this.map._requestManager.transformRequest(_,i.R.Tile),w=this.map.style?this.map.style.getLut(this.scope):null,P=w?{image:w.image.clone()}:null,z={request:y,data:void 0,uid:n.uid,tileID:n.tileID,tileZoom:n.tileZoom,zoom:n.tileID.overscaledZ,maxZoom:this.maxzoom,lut:P,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:n.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:n.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor()};if(this.hasWorldviews&&i.f(p)&&(z.worldview=this.map.getWorldview()||this.worldviewDefault,z.localizableLayerIds=this.localizableLayerIds),z.request.collectResourceTiming=this._collectResourceTiming,n.actor&&n.state!=="expired")n.state==="loading"?n.reloadCallback=s:n.request=n.actor.send("reloadTile",z,k.bind(this));else if(n.actor=this._tileWorkers[_]=this._tileWorkers[_]||this.dispatcher.getActor(),this.dispatcher.ready)n.request=n.actor.send("loadTile",z,k.bind(this),void 0,!0);else{const D=i.aC.call({deduped:this._deduped},z,(j,B)=>{j||!B?k.call(this,j):(z.data={cacheControl:B.cacheControl,expires:B.expires,rawData:B.rawData.slice(0)},n.actor&&n.actor.send("loadTile",z,k.bind(this),void 0,!0))},!0);n.request={cancel:D}}function k(D,j){return delete n.request,n.aborted?s(null):D&&D.status!==404?s(D):(j&&j.resourceTiming&&(n.resourceTiming=j.resourceTiming),this.map._refreshExpiredTiles&&j&&n.setExpiryData(j),n.loadVectorData(j,this.map.painter),i.aD(this.dispatcher),s(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(n,s){n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id,scope:this.scope}),n.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class eo extends i.E{constructor(n,s,p,_){super(),this.id=n,this.dispatcher=p,this.setEventedParent(_),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=i.l({type:"raster"},s),i.l(this,i.ax(s,["url","scheme","tileSize"]))}load(n){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._tileJSONRequest=Qi(this._options,this.map._requestManager,null,null,(s,p)=>{this._tileJSONRequest=null,this._loaded=!0,s?this.fire(new i.y(s)):p&&(i.l(this,p),p.raster_layers&&(this.rasterLayers=p.raster_layers,this.rasterLayerIds=this.rasterLayers.map(_=>_.id)),p.bounds&&(this.tileBounds=new wi(p.bounds,this.minzoom,this.maxzoom)),At(p.tiles),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),n&&n(s)})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest();const n=i.aB(this.id,this.scope);this.load(()=>this.map.style.clearSource(n))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(n){this.cancelTileJSONRequest()}serialize(){return i.l({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,s){const p=i.q.devicePixelRatio>=2,_=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);n.request=i.o(this.map._requestManager.transformRequest(_,i.R.Tile),(y,w,P,z)=>(delete n.request,n.aborted?(n.state="unloaded",s(null)):y?(n.state="errored",s(y)):w?(this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:P,expires:z}),n.setTexture(w,this.map.painter),n.state="loaded",i.aD(this.dispatcher),void s(null)):s(null)))}abortTile(n,s){n.request&&(n.request.cancel(),delete n.request),s&&s()}unloadTile(n,s){n.texture&&n.texture instanceof i.T?(n.destroy(!0),n.texture&&n.texture instanceof i.T&&this.map.painter.saveTileTexture(n.texture)):n.destroy(),s&&s()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Si extends eo{constructor(n,s,p,_){super(n,s,p,_),this.type="raster-array",this.maxzoom=22,this._options=i.l({type:"raster-array"},s)}triggerRepaint(n){const s=this.map.painter._terrain,p=this.map.style.getSourceCache(this.id);s&&s.enabled&&p&&s._clearRenderCacheForTile(p.id,n.tileID),this.map.triggerRepaint()}loadTile(n,s){const p=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),_=this.map._requestManager.transformRequest(p,i.R.Tile);n.requestParams=_,n.actor||(n.actor=this.dispatcher.getActor()),n.request=n.fetchHeader(void 0,(y,w,P,z)=>{if(delete n.request,n.aborted)return n.state="unloaded",s(null);if(y)return y.code===20?void 0:(n.state="errored",s(y));this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:P,expires:z}),n.state="empty",s(null)})}unloadTile(n,s){const p=n.texture;p&&p instanceof i.T?(n.destroy(!0),this.map.painter.saveTileTexture(p)):(n.destroy(),n.flushQueues(),n._isHeaderLoaded=!1,delete n._mrt,delete n.textureDescriptor),n.fbo&&(n.fbo.destroy(),delete n.fbo),delete n.request,delete n.requestParams,delete n.neighboringTiles,n.state="unloaded"}prepareTile(n,s,p){n._isHeaderLoaded&&(n.state!=="empty"&&(n.state="reloading"),n.fetchBand(s,p,(_,y)=>{if(_)return n.state="errored",this.fire(new i.y(_)),void this.triggerRepaint(n);y&&(n.setTexture(y,this.map.painter),n.state="loaded",this.triggerRepaint(n))}))}getInitialBand(n){if(!this.rasterLayers)return 0;const s=this.rasterLayers.find(({id:y})=>y===n),p=s&&s.fields,_=p&&p.bands&&p.bands;return _?_[0]:0}getTextureDescriptor(n,s,p){if(!n)return;const _=s.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!_)return;let y=null;s instanceof i.aG?y=s.paint.get("raster-array-band"):s instanceof i.aH&&(y=s.paint.get("raster-particle-array-band"));const w=y||this.getInitialBand(_);if(w!=null)if(n.textureDescriptor){if(!n.updateNeeded(_,w)||p)return Object.assign({},n.textureDescriptor,{texture:n.texture})}else this.prepareTile(n,_,w)}}const zi={vector:Zn,raster:eo,"raster-dem":class extends eo{constructor(f,n,s,p){super(f,n,s,p),this.type="raster-dem",this.maxzoom=22,this._options=i.l({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(f,n){const s=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(_,y){_&&(f.state="errored",n(_)),y&&(f.dem=y,f.dem.onDeserialize(),f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0,f.state="loaded",n(null))}f.request=i.o(this.map._requestManager.transformRequest(s,i.R.Tile),(function(_,y,w,P){if(delete f.request,f.aborted)f.state="unloaded",n(null);else if(_)f.state="errored",n(_);else if(y){this.map._refreshExpiredTiles&&f.setExpiryData({cacheControl:w,expires:P});const z=ImageBitmap&&y instanceof ImageBitmap&&i.t(),k=1-(y.width-i.aE(y.width))/2;k<1||f.neighboringTiles||(f.neighboringTiles=this._getNeighboringTiles(f.tileID));const D=z?y:i.q.getImageData(y,k),j={uid:f.uid,coord:f.tileID,source:this.id,scope:this.scope,rawImageData:D,encoding:this.encoding,padding:k};f.actor&&f.state!=="expired"||(f.actor=this.dispatcher.getActor(),f.actor.send("loadDEMTile",j,p.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(f){const n=f.canonical,s=Math.pow(2,n.z),p=(n.x-1+s)%s,_=n.x===0?f.wrap-1:f.wrap,y=(n.x+1+s)%s,w=n.x+1===s?f.wrap+1:f.wrap,P={};return P[new i.aF(f.overscaledZ,_,n.z,p,n.y).key]={backfilled:!1},P[new i.aF(f.overscaledZ,w,n.z,y,n.y).key]={backfilled:!1},n.y>0&&(P[new i.aF(f.overscaledZ,_,n.z,p,n.y-1).key]={backfilled:!1},P[new i.aF(f.overscaledZ,f.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},P[new i.aF(f.overscaledZ,w,n.z,y,n.y-1).key]={backfilled:!1}),n.y+1<s&&(P[new i.aF(f.overscaledZ,_,n.z,p,n.y+1).key]={backfilled:!1},P[new i.aF(f.overscaledZ,f.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},P[new i.aF(f.overscaledZ,w,n.z,y,n.y+1).key]={backfilled:!1}),P}},"raster-array":Si,geojson:class extends i.E{constructor(f,n,s,p){super(),this.id=f,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=s.getActor(),this.setEventedParent(p),this._data=n.data,this._options=i.l({},n),this._collectResourceTiming=n.collectResourceTiming,n.maxzoom!==void 0&&(this.maxzoom=n.maxzoom),n.minzoom!==void 0&&(this.minzoom=n.minzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const _=i.af/this.tileSize;this.workerOptions=i.l({source:this.id,scope:this.scope,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(n.buffer!==void 0?n.buffer:128)*_,tolerance:(n.tolerance!==void 0?n.tolerance:.375)*_,extent:i.af,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:n.clusterMaxZoom!==void 0?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:i.af,radius:(n.clusterRadius!==void 0?n.clusterRadius:50)*_,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter,dynamic:n.dynamic},n.workerOptions)}onAdd(f){this.map=f,this.setData(this._data)}setData(f){return this._data=f,this._updateWorkerData(),this}updateData(f){if(!this._options.dynamic)return this.fire(new i.y(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof f!="string"&&(f.type==="Feature"&&(f={type:"FeatureCollection",features:[f]}),f.type!=="FeatureCollection"))return this.fire(new i.y(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof f!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const n=new Map;for(const s of this._data.features)n.set(s.id,s);for(const s of f.features)n.set(s.id,s);this._data.features=[...n.values()]}else this._data=f;return this._updateWorkerData(!0),this}getClusterExpansionZoom(f,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:f,source:this.id,scope:this.scope},n),this}getClusterChildren(f,n){return this.actor.send("geojson.getClusterChildren",{clusterId:f,source:this.id,scope:this.scope},n),this}getClusterLeaves(f,n,s,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:f,limit:n,offset:s},p),this}_updateWorkerData(f=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new i.z("dataloading",{dataType:"source"})),this._loaded=!1;const n=i.l({append:f},this.workerOptions);n.scope=this.scope;const s=this._data;typeof s=="string"?(n.request=this.map._requestManager.transformRequest(i.q.resolveURL(s),i.R.Source),n.request.collectResourceTiming=this._collectResourceTiming):n.data=JSON.stringify(s),this._pendingLoad=this.actor.send(`${this.type}.loadData`,n,(p,_)=>{if(this._loaded=!0,this._pendingLoad=null,p)this.fire(new i.y(p));else{const y={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(y.resourceTiming=_.resourceTiming[this.id]),f&&(this._partialReload=!0),this.fire(new i.z("data",y)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(f),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(f,n){const s=f.actor?"reloadTile":"loadTile";f.actor=this.actor;const p=this.map.style?this.map.style.getLut(this.scope):null,_=p?{image:p.image.clone()}:null,y=this._partialReload,w={type:this.type,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:_,scope:this.scope,pixelRatio:i.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,scaleFactor:this.map.getScaleFactor(),partial:y};f.request=this.actor.send(s,w,(P,z)=>y&&!z?(f.state="loaded",n(null)):(delete f.request,f.destroy(),f.aborted?n(null):P?n(P):(f.loadVectorData(z,this.map.painter,s==="reloadTile"),n(null))),void 0,s==="loadTile")}abortTile(f){f.request&&(f.request.cancel(),delete f.request),f.aborted=!0}unloadTile(f,n){this.actor.send("removeTile",{uid:f.uid,type:this.type,source:this.id,scope:this.scope}),f.destroy()}onRemove(f){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return i.l({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends i.aI{constructor(f,n,s,p){super(f,n,s,p),this.roundZoom=!0,this.type="video",this.options=n}load(){this._loaded=!1;const f=this.options;this.urls=[];for(const n of f.urls)this.urls.push(this.map._requestManager.transformRequest(n,i.R.Source).url);i.aJ(this.urls,(n,s)=>{this._loaded=!0,n?this.fire(new i.y(n)):s&&(this.video=s,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(f){if(this.video){const n=this.video.seekable;f<n.start(0)||f>n.end(0)?this.fire(new i.y(new i.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=f}}getVideo(){return this.video}onAdd(f){this.map||(this.map=f,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const f=this.map.painter.context,n=f.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new i.T(f,this.video,n.RGBA8),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(f)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:i.aI,model:class extends i.E{constructor(f,n,s,p){super(),this.id=f,this.type="model",this.models=[],this._loaded=!1,this._options=n}load(){const f=[];for(const n in this._options.models){const s=this._options.models[n],p=i.aL(this.map._requestManager.transformRequest(s.uri,i.R.Model).url).then(_=>{if(!_)return;const y=i.aM(_),w=new i.aN(n,s.position,s.orientation,y);w.computeBoundsAndApplyParent(),this.models.push(w)}).catch(_=>{this.fire(new i.y(new Error(`Could not load model ${n} from ${s.uri}: ${_.message}`)))});f.push(p)}return Promise.allSettled(f).then(()=>{this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(n=>{this.fire(new i.y(new Error(`Could not load models: ${n.message}`)))})}onAdd(f){this.map=f,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(f,n){}serialize(){return{type:"model"}}},"batched-model":class extends i.E{constructor(f,n,s,p){super(),this.type="batched-model",this.id=f,this.tileSize=512,this._options=n,this.tiles=this._options.tiles,this.maxzoom=n.maxzoom||19,this.minzoom=n.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=s,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(p)}onAdd(f){this.map=f,this.load()}load(f){this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"}));const n=Array.isArray(this.map._language)?this.map._language.join():this.map._language,s=this.map.getWorldview();this._tileJSONRequest=Qi(this._options,this.map._requestManager,n,s,(p,_)=>{this._tileJSONRequest=null,this._loaded=!0,p?(n&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${n}`),s&&s.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${s}`),this.fire(new i.y(p))):_&&(i.l(this,_),_.bounds&&(this.tileBounds=new wi(_.bounds,this.minzoom,this.maxzoom)),At(_.tiles,this.map._requestManager._customAccessToken),this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))),f&&f(p)})}hasTransition(){return!1}hasTile(f){return!this.tileBounds||this.tileBounds.contains(f.canonical)}loaded(){return this._loaded}loadTile(f,n){const s=this.map._requestManager.normalizeTileURL(f.tileID.canonical.url(this.tiles,this.scheme)),p={request:this.map._requestManager.transformRequest(s,i.R.Tile),data:void 0,uid:f.uid,tileID:f.tileID,tileZoom:f.tileZoom,zoom:f.tileID.overscaledZ,tileSize:this.tileSize*f.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:f.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,lut:null,maxZoom:null,promoteId:null,pixelRatio:null,scaleFactor:null};if(f.actor&&f.state!=="expired")if(f.state==="loading")f.reloadCallback=n;else{if(f.buckets){const y=Object.values(f.buckets);for(const w of y)w.dirty=!0;return void(f.state="loaded")}f.request=f.actor.send("reloadTile",p,_.bind(this))}else f.actor=this.dispatcher.getActor(),f.request=f.actor.send("loadTile",p,_.bind(this),void 0,!0);function _(y,w){return f.aborted?n(null):y&&y.status!==404?n(y):(this.map._refreshExpiredTiles&&w&&f.setExpiryData(w),f.loadModelData(w,this.map.painter),f.state="loaded",void n(null))}}serialize(){return i.l({},this._options)}},canvas:class extends i.aI{constructor(f,n,s,p){super(f,n,s,p),n.coordinates?Array.isArray(n.coordinates)&&n.coordinates.length===4&&!n.coordinates.some(_=>!Array.isArray(_)||_.length!==2||_.some(y=>typeof y!="number"))||this.fire(new i.y(new i.V(`sources.${f}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new i.y(new i.V(`sources.${f}`,null,'missing required property "coordinates"'))),n.animate&&typeof n.animate!="boolean"&&this.fire(new i.y(new i.V(`sources.${f}`,null,'optional "animate" property must be a boolean value'))),n.canvas?typeof n.canvas=="string"||n.canvas instanceof HTMLCanvasElement||this.fire(new i.y(new i.V(`sources.${f}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new i.y(new i.V(`sources.${f}`,null,'missing required property "canvas"'))),this.options=n,this.animate=n.animate===void 0||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new i.y(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(f){this.map=f,this.load(),this.canvas&&this.animate&&this.play()}onRemove(f){this.pause()}prepare(){let f=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,f=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,f=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const n=this.map.painter.context;this.texture?!f&&!this._playing||this.texture instanceof i.aK||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new i.T(n,this.canvas,n.gl.RGBA8,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const f of[this.canvas.width,this.canvas.height])if(isNaN(f)||f<=0)return!0;return!1}},custom:class extends i.E{constructor(f,n,s,p){super(),this.id=f,this.type="custom",this._dataType="raster",this._dispatcher=s,this._implementation=n,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new i.y(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new i.y(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new wi(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),i.l(this,i.ax(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return i.ax(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new i.z("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(f){this.map=f,this._loaded=!1,this.fire(new i.z("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(f),this.load()}onRemove(f){this._implementation.onRemove&&this._implementation.onRemove(f)}hasTile(f){if(this._implementation.hasTile){const{x:n,y:s,z:p}=f.canonical;return this._implementation.hasTile({x:n,y:s,z:p})}return!this.tileBounds||this.tileBounds.contains(f.canonical)}loadTile(f,n){const{x:s,y:p,z:_}=f.tileID.canonical,y=new AbortController;f.request=Promise.resolve(this._implementation.loadTile({x:s,y:p,z:_},{signal:y.signal})).then((function(w){return delete f.request,f.aborted?(f.state="unloaded",n(null)):w===void 0?(f.state="errored",n(null)):w===null?(this.loadTileData(f,{width:this.tileSize,height:this.tileSize,data:null}),f.state="loaded",n(null)):function(P){return P instanceof ImageData||P instanceof HTMLCanvasElement||P instanceof ImageBitmap||P instanceof HTMLImageElement}(w)?(this.loadTileData(f,w),f.state="loaded",void n(null)):(f.state="errored",n(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(w=>{w.code!==20&&(f.state="errored",n(w))}),f.request.cancel=()=>y.abort()}loadTileData(f,n){f.setTexture(n,this.map.painter)}unloadTile(f,n){if(f.texture&&f.texture instanceof i.T?(f.destroy(!0),f.texture&&f.texture instanceof i.T&&this.map.painter.saveTileTexture(f.texture)):f.destroy(),this._implementation.unloadTile){const{x:s,y:p,z:_}=f.tileID.canonical;this._implementation.unloadTile({x:s,y:p,z:_})}n&&n()}abortTile(f,n){f.request&&f.request.cancel&&(f.request.cancel(),delete f.request),n&&n()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(f=>({x:f.canonical.x,y:f.canonical.y,z:f.canonical.z}))}_clearTiles(){const f=i.aB(this.id,this.scope);this.map.style.clearSource(f)}_update(){this.fire(new i.z("data",{dataType:"source",sourceDataType:"content"}))}}},ss=function(f,n,s,p){const _=new zi[n.type](f,n,s,p);if(_.id!==f)throw new Error(`Expected Source id to be ${f} instead of ${_.id}`);return i.aO(["load","abort","unload","serialize","prepare"],_),_};function Is(f,n,s,p,_=!1){const y=n.sourceCache.transform,w=n.sourceCache.tilesIn(f,n.has3DLayers,_);w.sort(As);const P=[];for(const z of w){const k=z.tile.queryRenderedFeatures(n,z,s,p,y,_);Object.keys(k).length&&P.push({wrappedTileID:z.tile.tileID.wrapped().key,queryResults:k})}return P.length===0?{}:function(z){const k={},D={};for(const j of z){const B=j.queryResults,G=j.wrappedTileID,Q=D[G]=D[G]||{};for(const J in B){const ie=B[J],oe=Q[J]=Q[J]||{},me=k[J]=k[J]||[];for(const Se of ie)oe[Se.featureIndex]||(oe[Se.featureIndex]=!0,me.push(Se))}}return k}(P)}function ko(f,n,s,p,_){const y={},w=p.queryRenderedSymbols(f),P=[];for(const z of Object.keys(w).map(Number))P.push(_[z]);P.sort(As);for(const z of P){const k=z.featureIndex.lookupSymbolFeatures(w[z.bucketInstanceId],z.bucketIndex,z.sourceLayerIndex,n,s);for(const D in k){const j=y[D]=y[D]||[],B=k[D];B.sort((G,Q)=>{const J=z.featureSortOrder;if(J){const ie=J.indexOf(G.featureIndex);return J.indexOf(Q.featureIndex)-ie}return Q.featureIndex-G.featureIndex});for(const G of B)j.push(G)}}return y}function Ps(f,n){const s=f.getRenderableIds().map(y=>f.getTileByID(y)),p=[],_={};for(let y=0;y<s.length;y++){const w=s[y],P=w.tileID.canonical.key;_[P]||(_[P]=!0,w.querySourceFeatures(p,n))}return p}function As(f,n){const s=f.tileID,p=n.tileID;return s.overscaledZ-p.overscaledZ||s.canonical.y-p.canonical.y||s.wrap-p.wrap||s.canonical.x-p.canonical.x}function Ul(f,n){const s={};if(!n)return s;for(const p of f){const _=p.layerIds.map(y=>n.getLayer(y)).filter(Boolean);if(_.length!==0){p.layers=_,p.stateDependentLayerIds&&(p.stateDependentLayers=p.stateDependentLayerIds.map(y=>_.filter(w=>w.id===y)[0]));for(const y of _)s[y.fqid]=p}}return s}const qi=32,Do=33,xo=new Uint16Array(8184);for(let f=0;f<2046;f++){let n=f+2,s=0,p=0,_=0,y=0,w=0,P=0;for(1&n?_=y=w=qi:s=p=P=qi;(n>>=1)>1;){const k=s+_>>1,D=p+y>>1;1&n?(_=s,y=p,s=w,p=P):(s=_,p=y,_=w,y=P),w=k,P=D}const z=4*f;xo[z+0]=s,xo[z+1]=p,xo[z+2]=_,xo[z+3]=y}const Oo=new Uint16Array(2178),qo=new Uint8Array(1089),pl=new Uint16Array(1089);function Rs(f){return f===0?-.03125:f===32?.03125:0}const la=(()=>({type:2,extent:i.af,loadGeometry:()=>[[new i.P(0,0),new i.P(i.af+1,0),new i.P(i.af+1,i.af+1),new i.P(0,i.af+1),new i.P(0,0)]]}))();class ya{constructor(n,s,p,_,y){this.tileID=n,this.uid=i.aU(),this.uses=0,this.tileSize=s,this.tileZoom=p,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=y,_&&_.style&&(this._lastUpdatedBrightness=_.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",_&&_.transform&&(this.projection=_.transform.projection)}registerFadeDuration(n){const s=n+this.timeAdded;s<i.q.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=i.aP(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(n,s,p){if(this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=Ul(n.buckets,s.style),this.hasSymbolBuckets=!1;for(const _ in this.buckets){const y=this.buckets[_];if(y instanceof i.aW){if(this.hasSymbolBuckets=!0,!p)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const _ in this.buckets){const y=this.buckets[_];if(y instanceof i.aW&&y.hasRTLText){this.hasRTLText=!0,i.aX();break}}this.queryPadding=0;for(const _ in this.buckets){const y=this.buckets[_],w=s.style.getOwnLayer(_);if(!w)continue;const P=w.queryRadius(y);this.queryPadding=Math.max(this.queryPadding,P)}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),n.lineAtlas&&(this.lineAtlas=n.lineAtlas),this._lastUpdatedBrightness=n.brightness}else this.collisionBoxArray=new i.aV}unloadVectorData(){if(this.hasData()){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(n,s,p){n&&(n.resourceTiming&&(this.resourceTiming=n.resourceTiming),this.buckets={...this.buckets,...Ul(n.buckets,s.style)},n.featureIndex&&(this.latestFeatureIndex=n.featureIndex))}getBucket(n){return this.buckets[n.fqid]}upload(n){for(const _ in this.buckets){const y=this.buckets[_];y.uploadPending()&&y.upload(n)}const s=n.gl,p=this.imageAtlas;if(p&&!p.uploaded){const _=!!Object.keys(p.patternPositions).length;this.imageAtlasTexture=new i.T(n,p.image,s.RGBA8,{useMipmap:_}),this.imageAtlas.uploaded=!0}this.glyphAtlasImage&&(this.glyphAtlasTexture=new i.T(n,this.glyphAtlasImage,s.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new i.T(n,this.lineAtlas.image,s.R8),this.lineAtlas.uploaded=!0)}prepare(n,s,p){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture,p),!s||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const _=s.style.getBrightness();(this._lastUpdatedBrightness||_)&&(this._lastUpdatedBrightness&&_&&Math.abs(this._lastUpdatedBrightness-_)<.001||(this.updateBuckets(s,this._lastUpdatedBrightness!==_),this._lastUpdatedBrightness=_))}queryRenderedFeatures(n,s,p,_,y,w){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const P=function(z,k){const D=i.aa.mat4.fromScaling([],[.5*z.width,.5*-z.height,1]);return i.aa.mat4.translate(D,D,[1,-1,0]),i.aa.mat4.multiply(D,D,z.calculateProjMatrix(k.toUnwrapped())),Float32Array.from(D)}(y,this.tileID);return this.latestFeatureIndex.query(n,{tilespaceGeometry:s,pixelPosMatrix:P,transform:_,availableImages:p,tileTransform:this.tileTransform})}querySourceFeatures(n,s){const p=this.latestFeatureIndex;if(!p||!p.rawTileData)return;const _=p.loadVTLayers(),y=s?s.sourceLayer:"",w=_._geojsonTileLayer||_[y];if(!w)return;const P=i.aY(s&&s.filter),{z,x:k,y:D}=this.tileID.canonical,j={z,x:k,y:D};for(let B=0;B<w.length;B++){const G=w.feature(B);if(P.needGeometry){const ie=i.aZ(G,!0);if(!P.filter(new i.a7(this.tileID.overscaledZ),ie,this.tileID.canonical))continue}else if(!P.filter(new i.a7(this.tileID.overscaledZ),G))continue;const Q=p.getId(G,y),J=new i.a_(G,z,k,D,Q);J.tile=j,n.push(J)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const s=this.expirationTime;if(n.cacheControl){const p=i.a$(n.cacheControl);p["max-age"]&&(this.expirationTime=Date.now()+1e3*p["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const p=Date.now();let _=!1;if(this.expirationTime>p)_=!1;else if(s)if(this.expirationTime<s)_=!0;else{const y=this.expirationTime-s;y?this.expirationTime=p+Math.max(y,3e4):_=!0}else _=!0;_?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(n){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&n&&this.updateBuckets(n)}updateBuckets(n,s){if(!this.latestFeatureIndex)return;const p=this.latestFeatureIndex.loadVTLayers(),_=n.style.listImages(),y=n.style.getBrightness();for(const w in this.buckets){if(!n.style.hasLayer(w))continue;const P=this.buckets[w],z=P.layers[0],k=z.sourceLayer||"_geojsonTileLayer",D=p[k],j=n.style.getSourceCache(z.source,z.scope);let B={};j&&(B=j._state.getState(k,void 0));const G=this.imageAtlas&&this.imageAtlas.patternPositions||{},Q=Object.keys(B).length>0&&!s;(Q&&P.stateDependentLayers.length!==0||s)&&P.update(B,D,_,G,Q?P.stateDependentLayers:P.layers,s,y),(P instanceof i.b0||P instanceof i.b1)&&n._terrain&&n._terrain.enabled&&j&&P.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(j.id,this.tileID);const J=n&&n.style&&n.style.getOwnLayer(w);J&&(this.queryPadding=Math.max(this.queryPadding,J.queryRadius(P)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<i.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=i.q.now()+n}setTexture(n,s){const p=s.context,_=p.gl;this.texture=this.texture||s.getTileTexture(n.width),this.texture&&this.texture instanceof i.T?this.texture.update(n):(this.texture=new i.T(p,n,_.RGBA8,{useMipmap:!0}),this.texture.bind(_.LINEAR,_.CLAMP_TO_EDGE))}setDependencies(n,s){const p={};for(const _ of s)p[_]=!0;this.dependencies[n]=p}hasDependency(n,s){for(const p of n){const _=this.dependencies[p];if(_){for(const y of s)if(_[y])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(n,s){if(!s||s.name==="mercator"||this._tileDebugBuffer)return;const p=i.b2(la,this.tileID.canonical,this.tileTransform)[0],_=new i.b3,y=new i.b4;for(let w=0;w<p.length;w++){const{x:P,y:z}=p[w];_.emplaceBack(P,z),y.emplaceBack(w)}y.emplaceBack(0),this._tileDebugIndexBuffer=n.createIndexBuffer(y),this._tileDebugBuffer=n.createVertexBuffer(_,i.b5.members),this._tileDebugSegments=i.b6.simpleSegment(0,0,_.length,y.length)}_makeTileBoundsBuffers(n,s){if(this._tileBoundsBuffer||!s||s.name==="mercator")return;const p=i.b2(la,this.tileID.canonical,this.tileTransform)[0];let _,y;if(this.isRaster){const w=function(P,z){const k=i.aP(P,z),D=Math.pow(2,P.z);for(let ie=0;ie<Do;ie++)for(let oe=0;oe<Do;oe++){const me=i.aQ((P.x+(oe+Rs(oe))/qi)/D),Se=i.aR((P.y+(ie+Rs(ie))/qi)/D),be=z.project(me,Se),Pe=ie*Do+oe;Oo[2*Pe+0]=Math.round((be.x*k.scale-k.x)*i.af),Oo[2*Pe+1]=Math.round((be.y*k.scale-k.y)*i.af)}qo.fill(0),pl.fill(0);for(let ie=2045;ie>=0;ie--){const oe=4*ie,me=xo[oe+0],Se=xo[oe+1],be=xo[oe+2],Pe=xo[oe+3],Me=me+be>>1,Ie=Se+Pe>>1,Ce=Me+Ie-Se,De=Ie+me-Me,$e=Se*Do+me,at=Pe*Do+be,rt=Ie*Do+Me,je=Math.hypot((Oo[2*$e+0]+Oo[2*at+0])/2-Oo[2*rt+0],(Oo[2*$e+1]+Oo[2*at+1])/2-Oo[2*rt+1])>=16;qo[rt]=qo[rt]||(je?1:0),ie<1022&&(qo[rt]=qo[rt]||qo[(Se+De>>1)*Do+(me+Ce>>1)]||qo[(Pe+De>>1)*Do+(be+Ce>>1)])}const j=new i.aS,B=new i.aT;let G=0;function Q(ie,oe){const me=oe*Do+ie;return pl[me]===0&&(j.emplaceBack(Oo[2*me+0],Oo[2*me+1],ie*i.af/qi,oe*i.af/qi),pl[me]=++G),pl[me]-1}function J(ie,oe,me,Se,be,Pe){const Me=ie+me>>1,Ie=oe+Se>>1;if(Math.abs(ie-be)+Math.abs(oe-Pe)>1&&qo[Ie*Do+Me])J(be,Pe,ie,oe,Me,Ie),J(me,Se,be,Pe,Me,Ie);else{const Ce=Q(ie,oe),De=Q(me,Se),$e=Q(be,Pe);B.emplaceBack(Ce,De,$e)}}return J(0,0,qi,qi,qi,0),J(qi,qi,0,0,0,qi),{vertices:j,indices:B}}(this.tileID.canonical,s);_=w.vertices,y=w.indices}else{_=new i.aS,y=new i.aT;for(const{x:P,y:z}of p)_.emplaceBack(P,z,0,0);const w=i.b7(_.int16,void 0,4);for(let P=0;P<w.length;P+=3)y.emplaceBack(w[P],w[P+1],w[P+2])}this._tileBoundsBuffer=n.createVertexBuffer(_,i.b8.members),this._tileBoundsIndexBuffer=n.createIndexBuffer(y),this._tileBoundsSegments=i.b6.simpleSegment(0,0,_.length,y.length)}_makeGlobeTileDebugBuffers(n,s){const p=s.projection;if(!p||p.name!=="globe"||s.freezeTileCoverage)return;const _=this.tileID.canonical,y=i.b9(_,s),w=i.ba(y),P=i.ad(s.zoom);let z;P>0&&(z=i.aa.mat4.invert(new Float64Array(16),s.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(n,_,s,w,z,P),this._makeGlobeTileDebugTextBuffer(n,_,s,w,z,P)}_globePoint(n,s,p,_,y,w,P){let z=i.bb(n,s,p);if(w){const k=1<<p.z,D=i.as(_.center.lng),j=i.az(_.center.lat),B=(p.x+.5)/k-D;let G=0;B>.5?G=-1:B<-.5&&(G=1);let Q=(n/i.af+p.x)/k+G,J=(s/i.af+p.y)/k;Q=(Q-D)*_._pixelsPerMercatorPixel+D,J=(J-j)*_._pixelsPerMercatorPixel+j;const ie=[Q*_.worldSize,J*_.worldSize,0];i.aa.vec3.transformMat4(ie,ie,w),z=i.bc(z,ie,P)}return i.aa.vec3.transformMat4(z,z,y)}_makeGlobeTileDebugBorderBuffer(n,s,p,_,y,w){const P=new i.b3,z=new i.b4,k=new i.bd,D=(B,G,Q,J,ie)=>{const oe=(Q-B)/(ie-1),me=(J-G)/(ie-1),Se=P.length;for(let be=0;be<ie;be++){const Pe=B+be*oe,Me=G+be*me;P.emplaceBack(Pe,Me);const Ie=this._globePoint(Pe,Me,s,p,_,y,w);k.emplaceBack(Ie[0],Ie[1],Ie[2]),z.emplaceBack(Se+be)}},j=i.af;D(0,0,j,0,16),D(j,0,j,j,16),D(j,j,0,j,16),D(0,j,0,0,16),this._tileDebugIndexBuffer=n.createIndexBuffer(z),this._tileDebugBuffer=n.createVertexBuffer(P,i.b5.members),this._globeTileDebugBorderBuffer=n.createVertexBuffer(k,i.be.members),this._tileDebugSegments=i.b6.simpleSegment(0,0,P.length,z.length)}_makeGlobeTileDebugTextBuffer(n,s,p,_,y,w){const P=i.af/4,z=new i.b3,k=new i.aT,D=new i.bd,j=25;k.reserve(32),z.reserve(j),D.reserve(j);const B=(G,Q)=>j*G+Q;for(let G=0;G<j;G++){const Q=G*P;for(let J=0;J<j;J++){const ie=J*P;z.emplaceBack(ie,Q);const oe=this._globePoint(ie,Q,s,p,_,y,w);D.emplaceBack(oe[0],oe[1],oe[2])}}for(let G=0;G<4;G++)for(let Q=0;Q<4;Q++){const J=B(G,Q),ie=B(G,Q+1),oe=B(G+1,Q),me=B(G+1,Q+1);k.emplaceBack(J,ie,oe),k.emplaceBack(oe,ie,me)}this._tileDebugTextIndexBuffer=n.createIndexBuffer(k),this._tileDebugTextBuffer=n.createVertexBuffer(z,i.b5.members),this._globeTileDebugTextBuffer=n.createVertexBuffer(D,i.be.members),this._tileDebugTextSegments=i.b6.simpleSegment(0,0,j,32)}destroy(n=!1){for(const s in this.buckets)this.buckets[s].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!n&&this.texture&&this.texture instanceof i.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}i.bf.setPbf(i.bg);class ml extends ya{constructor(n,s,p,_,y){super(n,s,p,_,y),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}setTexture(n,s){const p=s.context,_=p.gl;this.texture=this.texture||s.getTileTexture(n.width),this.texture&&this.texture instanceof i.T?this.texture.update(n,{premultiply:!1}):this.texture=new i.T(p,n,_.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(n=16384,s){const p=this._mrt=new i.bf(30),_=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(n-1)}});return this.entireBuffer=null,this.request=i.bh(_,(y,w,P,z)=>{if(y)s(y);else try{const k=p.getHeaderLength(w);if(k>n)return void(this.request=this.fetchHeader(k,s));p.parseHeader(w),this._isHeaderLoaded=!0;let D=0;for(const j of Object.values(p.layers))D=Math.max(D,j.dataIndex[j.dataIndex.length-1].last_byte);w.byteLength>=D&&(this.entireBuffer=w),s(null,this.entireBuffer||w,P,z)}catch(k){s(k)}}),this.request}fetchBand(n,s,p){const _=this._mrt;if(!this._isHeaderLoaded||!_)return void p(new Error("Tile header is not ready"));const y=this.actor;if(!y)return void p(new Error("Can't fetch tile band without an actor"));let w;const P=(j,B)=>{w.complete(j,B),j?p(j):(this.updateTextureDescriptor(n,s),p(null,this.textureDescriptor&&this.textureDescriptor.img))},z=(j,B)=>{if(j)return p(j);const G=y.send("decodeRasterArray",{buffer:B,task:w},P,void 0,!0);this._workQueue.push(()=>{G&&G.cancel(),w.cancel()})},k=_.getLayer(n);if(!k)return void p(new Error(`Unknown sourceLayer "${n}"`));if(k.hasDataForBand(s))return this.updateTextureDescriptor(n,s),void p(null,this.textureDescriptor?this.textureDescriptor.img:null);const D=k.getDataRange([s]);if(w=_.createDecodingTask(D),!w||w.tasks.length)if(this.flushQueues(),this.entireBuffer)z(null,this.entireBuffer.slice(D.firstByte,D.lastByte+1));else{const j=Object.assign({},this.requestParams,{headers:{Range:`bytes=${D.firstByte}-${D.lastByte}`}}),B=i.bh(j,z);this._fetchQueue.push(()=>{B.cancel(),w.cancel()})}else p(null)}updateNeeded(n,s){return(!this.textureDescriptor||this.textureDescriptor.band!==s||this.textureDescriptor.layer!==n)&&this.state!=="errored"}updateTextureDescriptor(n,s){if(!this._mrt)return;const p=this._mrt.getLayer(n);if(!p||!p.hasBand(s)||!p.hasDataForBand(s))return;const{bytes:_,tileSize:y,buffer:w,offset:P,scale:z}=p.getBandView(s),k=y+2*w,D={data:_,width:k,height:k},j=this.texture;j&&j instanceof i.T&&j.update(D,{premultiply:!1}),this.textureDescriptor={layer:n,band:s,img:D,buffer:w,offset:P,tileSize:y,format:p.pixelFormat,mix:[z,256*z,65536*z,16777216*z]}}}class zs{constructor(n,s){this.max=n,this.onRemove=s,this.reset()}reset(){for(const n in this.data)for(const s of this.data[n])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(n,s,p){const _=n.wrapped().key;this.data[_]===void 0&&(this.data[_]=[]);const y={value:s,timeout:void 0};if(p!==void 0&&(y.timeout=setTimeout(()=>{this.remove(n,y)},p)),this.data[_].push(y),this.order.push(_),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value}getByKey(n){const s=this.data[n];return s?s[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,s){if(!this.has(n))return this;const p=n.wrapped().key,_=s===void 0?0:this.data[p].indexOf(s),y=this.data[p][_];return this.data[p].splice(_,1),y.timeout&&clearTimeout(y.timeout),this.data[p].length===0&&delete this.data[p],this.onRemove(y.value),this.order.splice(this.order.indexOf(p),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(n){const s=[];for(const p in this.data)for(const _ of this.data[p])n(_.value)||s.push(_);for(const p of s)this.remove(p.value.tileID,p)}}class lo{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,s,p){const _=String(s);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][_]=this.stateChanges[n][_]||{},i.l(this.stateChanges[n][_],p),this.deletedStates[n]===null){this.deletedStates[n]={};for(const y in this.state[n])y!==_&&(this.deletedStates[n][y]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][_]===null){this.deletedStates[n][_]={};for(const y in this.state[n][_])p[y]||(this.deletedStates[n][_][y]=null)}else for(const y in p)this.deletedStates[n]&&this.deletedStates[n][_]&&this.deletedStates[n][_][y]===null&&delete this.deletedStates[n][_][y]}removeFeatureState(n,s,p){if(this.deletedStates[n]===null)return;const _=String(s);if(this.deletedStates[n]=this.deletedStates[n]||{},p&&s!==void 0)this.deletedStates[n][_]!==null&&(this.deletedStates[n][_]=this.deletedStates[n][_]||{},this.deletedStates[n][_][p]=null);else if(s!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][_])for(p in this.deletedStates[n][_]={},this.stateChanges[n][_])this.deletedStates[n][_][p]=null;else this.deletedStates[n][_]=null;else this.deletedStates[n]=null}getState(n,s){const p=this.state[n]||{},_=this.stateChanges[n]||{},y=this.deletedStates[n];if(y===null)return{};if(s!==void 0){const P=String(s),z=i.l({},p[P],_[P]);if(y){const k=y[s];if(k===null)return{};for(const D in k)delete z[D]}return z}const w=i.l({},p,_);if(y)for(const P in y)delete w[P];return w}initializeTileState(n,s){n.refreshFeatureState(s)}coalesceChanges(n,s){const p={};for(const _ in this.stateChanges){this.state[_]=this.state[_]||{};const y={};for(const w in this.stateChanges[_])this.state[_][w]||(this.state[_][w]={}),i.l(this.state[_][w],this.stateChanges[_][w]),y[w]=this.state[_][w];p[_]=y}for(const _ in this.deletedStates){this.state[_]=this.state[_]||{};const y={};if(this.deletedStates[_]===null)for(const w in this.state[_])y[w]={},this.state[_][w]={};else for(const w in this.deletedStates[_]){if(this.deletedStates[_][w]===null)this.state[_][w]={};else if(this.state[_][w])for(const P of Object.keys(this.deletedStates[_][w]))delete this.state[_][w][P];y[w]=this.state[_][w]}p[_]=p[_]||{},i.l(p[_],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(p).length!==0)for(const _ in n)n[_].refreshFeatureState(s)}}class bo extends i.E{constructor(n,s,p){super(),this.id=n,this._onlySymbols=p,s.on("data",_=>{_.dataType==="source"&&_.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&_.dataType==="source"&&_.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),s.on("error",()=>{this._sourceErrored=!0}),this._source=s,this._tiles={},this._cache=new zs(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new lo,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(n){this.map=n,this._minTileCacheSize=this._minTileCacheSize===void 0&&n?n._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&n?n._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles){const s=this._tiles[n];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(n,s){return n.isSymbolTile=this._onlySymbols,n.isExtraShadowCaster=this._shadowCasterTiles[n.tileID.key],this._source.loadTile(n,s)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n)}_abortTile(n){if(this._source.abortTile)return this._source.abortTile(n)}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const p=this._tiles[s];p.upload(n),p.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return i.bi(this._tiles).map(n=>n.tileID).sort(Gl).map(n=>n.key)}getRenderableIds(n,s){const p=[];for(const _ in this._tiles)this._isIdRenderable(+_,n,s)&&p.push(this._tiles[_]);return n?p.sort((_,y)=>{const w=_.tileID,P=y.tileID,z=new i.P(w.canonical.x,w.canonical.y)._rotate(this.transform.angle),k=new i.P(P.canonical.x,P.canonical.y)._rotate(this.transform.angle);return w.overscaledZ-P.overscaledZ||k.y-z.y||k.x-z.x}).map(_=>_.tileID.key):p.map(_=>_.tileID).sort(Gl).map(_=>_.key)}hasRenderableParent(n){const s=this.findLoadedParent(n,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(n,s,p){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(s||!this._tiles[n].holdingForFade())&&(p||!this._shadowCasterTiles[n])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(+n,"reloading")}}_reloadTile(n,s){const p=this._tiles[n];p&&(p.state!=="loading"&&(p.state=s),this._loadTile(p,this._tileLoaded.bind(this,p,n,s)))}_tileLoaded(n,s,p,_){if(_)if(n.state="errored",_.status!==404)this._source.fire(new i.y(_,{tile:n}));else{if(this._source.fire(new i.z("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:n})),!(n.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const y=this.map.painter.terrain;this.update(this.transform,y.getScaledDemTileSize(),!0),y.resetTileLookupCache(this.id)}else this.update(this.transform)}else n.timeAdded=i.q.now(),p==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(s,n),this._source.type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new i.z("data",{dataType:"source",tile:n,coord:n.tileID,sourceCacheId:this.id}))}_backfillDEM(n){const s=this.getRenderableIds();for(let _=0;_<s.length;_++){const y=s[_];if(n.neighboringTiles&&n.neighboringTiles[y]){const w=this.getTileByID(y);p(n,w),p(w,n)}}function p(_,y){if(!_.dem||_.dem.borderReady)return;_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0;let w=y.tileID.canonical.x-_.tileID.canonical.x;const P=y.tileID.canonical.y-_.tileID.canonical.y,z=Math.pow(2,_.tileID.canonical.z),k=y.tileID.key;w===0&&P===0||Math.abs(P)>1||(Math.abs(w)>1&&(Math.abs(w+z)===1?w+=z:Math.abs(w-z)===1&&(w-=z)),y.dem&&_.dem&&(_.dem.backfillBorder(y.dem,w,P),_.neighboringTiles&&_.neighboringTiles[k]&&(_.neighboringTiles[k].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,s,p,_){for(const y in this._tiles){let w=this._tiles[y];if(_[y]||!w.hasData()||w.tileID.overscaledZ<=s||w.tileID.overscaledZ>p)continue;let P=w.tileID;for(;w&&w.tileID.overscaledZ>s+1;){const k=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[k.key],w&&w.hasData()&&(P=k)}let z=P;for(;z.overscaledZ>s;)if(z=z.scaledTo(z.overscaledZ-1),n[z.key]){_[P.key]=P;break}}}findLoadedParent(n,s){if(n.key in this._loadedParentTiles){const p=this._loadedParentTiles[n.key];return p&&p.tileID.overscaledZ>=s?p:null}for(let p=n.overscaledZ-1;p>=s;p--){const _=n.scaledTo(p),y=this._getLoadedTile(_);if(y)return y}}_getLoadedTile(n){const s=this._tiles[n.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?n.wrapped().key:n.canonical.key)}updateCacheSize(n,s){s=s||this._source.tileSize;const p=Math.ceil(n.width/s)+1,_=Math.ceil(n.height/s)+1,y=Math.floor(p*_*5),w=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,y):y,P=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(P)}handleWrapJump(n){const s=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,s){const p={};for(const _ in this._tiles){const y=this._tiles[_];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+s),p[y.tileID.key]=y}this._tiles=p;for(const _ in this._timers)clearTimeout(this._timers[_]),delete this._timers[_];for(const _ in this._tiles)this._setTileReloadTimer(+_,this._tiles[_])}}update(n,s,p,_){if(this.transform=n,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!p)return;this.updateCacheSize(n,s),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const y=this._source.type==="batched-model";let w,P=this._source.maxzoom;const z=this.map&&this.map.painter?this.map.painter._terrain:null;if(z&&z.sourceCache===this&&z.attenuationRange()){const j=z.attenuationRange()[0],B=Math.floor(j)-Math.log2(z.getDemUpscale());P>B&&(P=B)}if(this.used||this.usedForTerrain){if(this._source.tileID)w=n.getVisibleUnwrappedCoordinates(this._source.tileID).map(j=>new i.aF(j.canonical.z,j.wrap,j.canonical.z,j.canonical.x,j.canonical.y));else if(this.tileCoverLift!==0){const j=n.clone();j.tileCoverLift=this.tileCoverLift,w=j.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:P,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:y}),this._source.minzoom<=1&&n.projection.name==="globe"&&(w.push(new i.aF(1,0,1,0,0)),w.push(new i.aF(1,0,1,1,0)),w.push(new i.aF(1,0,1,0,1)),w.push(new i.aF(1,0,1,1,1)))}else if(w=n.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:P,roundZoom:this._source.roundZoom&&!p,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:y}),this._source.hasTile){const j=this._source.hasTile.bind(this._source);w=w.filter(B=>j(B))}}else w=[];if(w.length>0&&this.castsShadows&&_&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Hl(this._source.type)){const j=n.coveringZoomLevel({tileSize:s||this._source.tileSize,roundZoom:this._source.roundZoom&&!p}),B=Math.min(j,this._source.maxzoom);if(y){const G=n.extendTileCover(w,B);for(const Q of G)w.push(Q)}else{const G=n.extendTileCover(w,B,_);for(const Q of G)this._shadowCasterTiles[Q.key]=!0,w.push(Q)}}const k=this._updateRetainedTiles(w);if(Hl(this._source.type)&&w.length!==0){const j={},B={},G=Object.keys(k);for(const J of G){const ie=k[J],oe=this._tiles[J];if(!oe||oe.fadeEndTime&&oe.fadeEndTime<=i.q.now())continue;const me=this.findLoadedParent(ie,Math.max(ie.overscaledZ-bo.maxOverzooming,this._source.minzoom));me&&(this._addTile(me.tileID),j[me.tileID.key]=me.tileID),B[J]=ie}const Q=w[w.length-1].overscaledZ;for(const J in this._tiles){const ie=this._tiles[J];if(k[J]||!ie.hasData())continue;let oe=ie.tileID;for(;oe.overscaledZ>Q;){oe=oe.scaledTo(oe.overscaledZ-1);const me=this._tiles[oe.key];if(me&&me.hasData()&&B[oe.key]){k[J]=ie.tileID;break}}}for(const J in j)k[J]||(this._coveredTiles[J]=!0,k[J]=j[J])}for(const j in k)this._tiles[j].clearFadeHold();const D=i.bj(this._tiles,k);for(const j of D){const B=this._tiles[j];B.hasSymbolBuckets&&!B.holdingForFade()?B.setHoldDuration(this.map._fadeDuration):B.hasSymbolBuckets&&!B.symbolFadeFinished()||this._removeTile(+j)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(+n)}_updateRetainedTiles(n){const s={};if(n.length===0)return s;const p={},_=n.reduce((k,D)=>Math.min(k,D.overscaledZ),1/0),y=n[0].overscaledZ,w=Math.max(y-bo.maxOverzooming,this._source.minzoom),P=Math.max(y+bo.maxUnderzooming,this._source.minzoom),z={};for(const k of n){const D=this._addTile(k);s[k.key]=k,D.hasData()||_<this._source.maxzoom&&(z[k.key]=k)}this._retainLoadedChildren(z,_,P,s);for(const k of n){let D=this._tiles[k.key];if(D.hasData())continue;if(k.canonical.z>=this._source.maxzoom){const B=k.children(this._source.maxzoom)[0],G=this.getTile(B);if(G&&G.hasData()){s[B.key]=B;continue}}else{const B=k.children(this._source.maxzoom);if(s[B[0].key]&&s[B[1].key]&&s[B[2].key]&&s[B[3].key])continue}let j=D.wasRequested();for(let B=k.overscaledZ-1;B>=w;--B){const G=k.scaledTo(B);if(p[G.key]||(p[G.key]=!0,D=this.getTile(G),!D&&j&&(D=this._addTile(G)),D&&(s[G.key]=G,j=D.wasRequested(),D.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const s=[];let p,_=this._tiles[n].tileID;for(;_.overscaledZ>0;){if(_.key in this._loadedParentTiles){p=this._loadedParentTiles[_.key];break}s.push(_.key);const y=_.scaledTo(_.overscaledZ-1);if(p=this._getLoadedTile(y),p)break;_=y}for(const y of s)this._loadedParentTiles[y]=p}}_addTile(n){let s=this._tiles[n.key];if(s)return s.isExtraShadowCaster!==!0||this._shadowCasterTiles[n.key]||this._reloadTile(n.key,"reloading"),s;s=this._cache.getAndRemove(n),s&&(this._setTileReloadTimer(n.key,s),s.tileID=n,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,s)));const p=!!s;if(!p){const _=this.map?this.map.painter:null,y=this._source.tileSize*n.overscaleFactor();s=this._source.type==="raster-array"?new ml(n,y,this.transform.tileZoom,_,this._isRaster):new ya(n,y,this.transform.tileZoom,_,this._isRaster),this._loadTile(s,this._tileLoaded.bind(this,s,n.key,s.state))}return s?(s.uses++,this._tiles[n.key]=s,p||this._source.fire(new i.z("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(n,s){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const p=s.getExpiryTimeout();p&&(this._timers[n]=setTimeout(()=>{this._reloadTile(n,"expired"),delete this._timers[n]},p))}_removeTile(n){const s=this._tiles[n];s&&(s.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),s.uses>0||(s.hasData()&&s.state!=="reloading"||s.state==="empty"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(+n);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(n,s,p){const _=[],y=this.transform;if(!y)return _;const w=y.projection.name==="globe",P=i.as(y.center.lng);for(const z in this._tiles){const k=this._tiles[z];if(p&&k.clearQueryDebugViz(),k.holdingForFade())continue;let D;if(w){const j=k.tileID.canonical;if(j.z===0){const B=[Math.abs(i.av(P,...Rr(j,-1))-P),Math.abs(i.av(P,...Rr(j,1))-P)];D=[0,2*B.indexOf(Math.min(...B))-1]}else{const B=[Math.abs(i.av(P,...Rr(j,-1))-P),Math.abs(i.av(P,...Rr(j,0))-P),Math.abs(i.av(P,...Rr(j,1))-P)];D=[B.indexOf(Math.min(...B))-1]}}else D=[0];for(const j of D){const B=n.containsTile(k,y,s,j);B&&_.push(B)}}return _}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(n){return this._getRenderableCoordinates(n)}_getRenderableCoordinates(n,s){const p=this.getRenderableIds(n,s).map(y=>this._tiles[y].tileID),_=this.transform.projection.name==="globe";for(const y of p)y.projMatrix=this.transform.calculateProjMatrix(y.toUnwrapped()),y.expandedProjMatrix=_?this.transform.calculateProjMatrix(y.toUnwrapped(),!1,!0):y.projMatrix;return p}sortCoordinatesByDistance(n){const s=n.slice(),p=this.transform._camera.position,_=this.transform._camera.forward(),y={};for(const w of s){const P=1/(1<<w.canonical.z);y[w.key]=((w.canonical.x+.5)*P+w.wrap-p[0])*_[0]+((w.canonical.y+.5)*P-p[1])*_[1]-p[2]*_[2]}return s.sort((w,P)=>y[w.key]-y[P.key]),s}hasTransition(){if(this._source.hasTransition())return!0;if(Hl(this._source.type))for(const n in this._tiles){const s=this._tiles[n];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=i.q.now())return!0}return!1}setFeatureState(n,s,p){this._state.updateState(n=n||"_geojsonTileLayer",s,p)}removeFeatureState(n,s,p){this._state.removeFeatureState(n=n||"_geojsonTileLayer",s,p)}getFeatureState(n,s){return this._state.getState(n=n||"_geojsonTileLayer",s)}setDependencies(n,s,p){const _=this._tiles[n];_&&_.setDependencies(s,p)}reloadTilesForDependencies(n,s){for(const p in this._tiles)this._tiles[p].hasDependency(n,s)&&this._reloadTile(+p,"reloading");this._cache.filter(p=>!p.hasDependency(n,s))}_preloadTiles(n,s){if(!this._sourceLoaded){const z=()=>{this._sourceLoaded&&(this._source.off("data",z),this._preloadTiles(n,s))};return void this._source.on("data",z)}const p=new Map,_=Array.isArray(n)?n:[n],y=this.map.painter.terrain,w=this.usedForTerrain&&y?y.getScaledDemTileSize():this._source.tileSize;for(const z of _){const k=z.coveringTiles({tileSize:w,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const D of k)p.set(D.key,D);this.usedForTerrain&&z.updateElevation(!1)}const P=Array.from(p.values());i.bk(P,(z,k)=>{const D=new ya(z,this._source.tileSize*z.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(D,j=>{this._source.type==="raster-dem"&&D.dem&&this._backfillDEM(D),k(j,D)})},s)}}function Gl(f,n){const s=Math.abs(2*f.wrap)-+(f.wrap<0),p=Math.abs(2*n.wrap)-+(n.wrap<0);return f.overscaledZ-n.overscaledZ||p-s||n.canonical.y-f.canonical.y||n.canonical.x-f.canonical.x}function Hl(f){return f==="raster"||f==="image"||f==="video"||f==="custom"}function Rr(f,n){const s=1<<f.z;return[f.x/s+n,(f.x+1)/s+n]}bo.maxOverzooming=10,bo.maxUnderzooming=3;class gl{constructor(n){this.style=n,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const n=!1,s=!1;for(const p in this.style._mergedLayers){const _=this.style._mergedLayers[p];if(_.type==="fill-extrusion")this.layers.push({layer:_,visible:n,visibilityChanged:s});else if(_.type==="model"){const y=this.style.getLayerSource(_);y&&y.type==="batched-model"&&this.layers.push({layer:_,visible:n,visibilityChanged:s})}}}onNewFrame(n){this.layersGotHidden=!1;for(const s of this.layers){const p=s.layer;let _=!1;p.type==="fill-extrusion"?_=!p.isHidden(n)&&p.paint.get("fill-extrusion-opacity")>0:p.type==="model"&&(_=!p.isHidden(n)&&p.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!_&&s.visible,s.visible=_}}updateZOffset(n,s){this.currentBuildingBuckets=[];for(const _ of this.layers){const y=_.layer,w=this.style.getLayerSourceCache(y);let P=1;y.type==="fill-extrusion"&&(P=_.visible?y.paint.get("fill-extrusion-vertical-scale"):0);let z=w?w.getTile(s):null;if(!z&&w&&s.canonical.z>w.getSource().minzoom){let k=s.scaledTo(Math.min(w.getSource().maxzoom,s.overscaledZ-1));for(;k.overscaledZ>=w.getSource().minzoom&&(z=w.getTile(k),!z&&k.overscaledZ!==0);)k=k.scaledTo(k.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:z?z.getBucket(y):null,tileID:z?z.tileID:s,verticalScale:P})}n.hasAnyZOffset=!1;let p=!1;for(let _=0;_<n.symbolInstances.length;_++){const y=n.symbolInstances.get(_),w=y.zOffset,P=this._getHeightAtTileOffset(s,y.tileAnchorX,y.tileAnchorY);y.zOffset=P!==Number.NEGATIVE_INFINITY?P:w,p||w===y.zOffset||(p=!0),n.hasAnyZOffset||y.zOffset===0||(n.hasAnyZOffset=!0)}p&&(n.zOffsetBuffersNeedUpload=!0,n.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(n,s,p,_){let y=s,w=p;if(n.canonical.z!==_.canonical.z){const P=_.canonical,z=1/(1<<n.canonical.z-P.z);y=(s+n.canonical.x*i.af)*z-P.x*i.af|0,w=(p+n.canonical.y*i.af)*z-P.y*i.af|0}return{tileX:y,tileY:w}}_getHeightAtTileOffset(n,s,p){let _,y;for(let w=0;w<this.layers.length;++w){if(this.layers[w].layer.type!=="fill-extrusion")continue;const{bucket:P,tileID:z,verticalScale:k}=this.currentBuildingBuckets[w];if(!P)continue;const{tileX:D,tileY:j}=this._mapCoordToOverlappingTile(n,s,p,z),B=P.getHeightAtTileCoord(D,j);B&&B.height!==void 0&&(B.hidden?_=B.height:y=Math.max(B.height*k,y||0))}if(y!==void 0)return y;for(let w=0;w<this.layers.length;++w){const P=this.layers[w];if(P.layer.type!=="model"||!P.visible)continue;const{bucket:z,tileID:k}=this.currentBuildingBuckets[w];if(!z)continue;const{tileX:D,tileY:j}=this._mapCoordToOverlappingTile(n,s,p,k),B=z.getHeightAtTileCoord(D,j);if(B&&!B.hidden)return B.height===void 0&&_!==void 0?Math.min(B.maxHeight,_)*B.verticalScale:B.height?B.height*B.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function ur(f,n){const s={};for(const p in f)p!=="ref"&&(s[p]=f[p]);return i.bl.forEach(p=>{p in n&&(s[p]=n[p])}),s}function va(f){f=f.slice();const n=Object.create(null);for(let s=0;s<f.length;s++)n[f[s].id]=f[s];for(let s=0;s<f.length;s++)"ref"in f[s]&&(f[s]=ur(f[s],n[f[s].ref]));return f}const Hr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport"};function Ls(f,n,s){s.push({command:Hr.addSource,args:[f,n[f]]})}function co(f,n,s){n.push({command:Hr.removeSource,args:[f]}),s[f]=!0}function Wl(f,n,s,p){co(f,s,p),Ls(f,n,s)}function _r(f,n,s){let p;for(p in f[s])if(f[s].hasOwnProperty(p)&&p!=="data"&&!i.bm(f[s][p],n[s][p]))return!1;for(p in n[s])if(n[s].hasOwnProperty(p)&&p!=="data"&&!i.bm(f[s][p],n[s][p]))return!1;return!0}function Mt(f,n,s,p,_,y){let w;for(w in n=n||{},f=f||{})f.hasOwnProperty(w)&&(i.bm(f[w],n[w])||s.push({command:y,args:[p,w,n[w],_]}));for(w in n)n.hasOwnProperty(w)&&!f.hasOwnProperty(w)&&(i.bm(f[w],n[w])||s.push({command:y,args:[p,w,n[w],_]}))}function xr(f){return f.id}function br(f,n){return f[n.id]=n,f}class _n{constructor(n,s){this.reset(n,s)}reset(n,s){this.points=n||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(s||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(this.points.length===1)return this.points[0];n=i.av(n,0,1);let s=1,p=this._distances[s];const _=n*this.paddedLength+this.padding;for(;p<_&&s<this._distances.length;)p=this._distances[++s];const y=s-1,w=this._distances[y],P=p-w,z=P>0?(_-w)/P:0;return this.points[y].mult(1-z).add(this.points[s].mult(z))}}class xa{constructor(n,s,p){const _=this.boxCells=[],y=this.circleCells=[];this.xCellCount=Math.ceil(n/p),this.yCellCount=Math.ceil(s/p);for(let w=0;w<this.xCellCount*this.yCellCount;w++)_.push([]),y.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=s,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/s,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,s,p,_,y){this._forEachCell(s,p,_,y,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(s),this.bboxes.push(p),this.bboxes.push(_),this.bboxes.push(y)}insertCircle(n,s,p,_){this._forEachCell(s-_,p-_,s+_,p+_,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(s),this.circles.push(p),this.circles.push(_)}_insertBoxCell(n,s,p,_,y,w){this.boxCells[y].push(w)}_insertCircleCell(n,s,p,_,y,w){this.circleCells[y].push(w)}_query(n,s,p,_,y,w){if(p<0||n>this.width||_<0||s>this.height)return!y&&[];const P=[];if(n<=0&&s<=0&&this.width<=p&&this.height<=_){if(y)return!0;for(let z=0;z<this.boxKeys.length;z++)P.push({key:this.boxKeys[z],x1:this.bboxes[4*z],y1:this.bboxes[4*z+1],x2:this.bboxes[4*z+2],y2:this.bboxes[4*z+3]});for(let z=0;z<this.circleKeys.length;z++){const k=this.circles[3*z],D=this.circles[3*z+1],j=this.circles[3*z+2];P.push({key:this.circleKeys[z],x1:k-j,y1:D-j,x2:k+j,y2:D+j})}return w?P.filter(w):P}return this._forEachCell(n,s,p,_,this._queryCell,P,{hitTest:y,seenUids:{box:{},circle:{}}},w),y?P.length>0:P}_queryCircle(n,s,p,_,y){const w=n-p,P=n+p,z=s-p,k=s+p;if(P<0||w>this.width||k<0||z>this.height)return!_&&[];const D=[];return this._forEachCell(w,z,P,k,this._queryCellCircle,D,{hitTest:_,circle:{x:n,y:s,radius:p},seenUids:{box:{},circle:{}}},y),_?D.length>0:D}query(n,s,p,_,y){return this._query(n,s,p,_,!1,y)}hitTest(n,s,p,_,y){return this._query(n,s,p,_,!0,y)}hitTestCircle(n,s,p,_){return this._queryCircle(n,s,p,!0,_)}_queryCell(n,s,p,_,y,w,P,z){const k=P.seenUids,D=this.boxCells[y];if(D!==null){const B=this.bboxes;for(const G of D)if(!k.box[G]){k.box[G]=!0;const Q=4*G;if(n<=B[Q+2]&&s<=B[Q+3]&&p>=B[Q+0]&&_>=B[Q+1]&&(!z||z(this.boxKeys[G]))){if(P.hitTest)return w.push(!0),!0;w.push({key:this.boxKeys[G],x1:B[Q],y1:B[Q+1],x2:B[Q+2],y2:B[Q+3]})}}}const j=this.circleCells[y];if(j!==null){const B=this.circles;for(const G of j)if(!k.circle[G]){k.circle[G]=!0;const Q=3*G;if(this._circleAndRectCollide(B[Q],B[Q+1],B[Q+2],n,s,p,_)&&(!z||z(this.circleKeys[G]))){if(P.hitTest)return w.push(!0),!0;{const J=B[Q],ie=B[Q+1],oe=B[Q+2];w.push({key:this.circleKeys[G],x1:J-oe,y1:ie-oe,x2:J+oe,y2:ie+oe})}}}}}_queryCellCircle(n,s,p,_,y,w,P,z){const k=P.circle,D=P.seenUids,j=this.boxCells[y];if(j!==null){const G=this.bboxes;for(const Q of j)if(!D.box[Q]){D.box[Q]=!0;const J=4*Q;if(this._circleAndRectCollide(k.x,k.y,k.radius,G[J+0],G[J+1],G[J+2],G[J+3])&&(!z||z(this.boxKeys[Q])))return w.push(!0),!0}}const B=this.circleCells[y];if(B!==null){const G=this.circles;for(const Q of B)if(!D.circle[Q]){D.circle[Q]=!0;const J=3*Q;if(this._circlesCollide(G[J],G[J+1],G[J+2],k.x,k.y,k.radius)&&(!z||z(this.circleKeys[Q])))return w.push(!0),!0}}}_forEachCell(n,s,p,_,y,w,P,z){const k=this._convertToXCellCoord(n),D=this._convertToYCellCoord(s),j=this._convertToXCellCoord(p),B=this._convertToYCellCoord(_);for(let G=k;G<=j;G++)for(let Q=D;Q<=B;Q++)if(y.call(this,n,s,p,_,this.xCellCount*Q+G,w,P,z))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,s,p,_,y,w){const P=_-n,z=y-s,k=p+w;return k*k>P*P+z*z}_circleAndRectCollide(n,s,p,_,y,w,P){const z=(w-_)/2,k=Math.abs(n-(_+z));if(k>z+p)return!1;const D=(P-y)/2,j=Math.abs(s-(y+D));if(j>D+p)return!1;if(k<=z||j<=D)return!0;const B=k-z,G=j-D;return B*B+G*G<=p*p}}const Wr={unknown:0,flipRequired:1,flipNotRequired:2},ql=Math.tan(85*Math.PI/180);function Zo(f,n,s,p,_,y,w){const P=i.aa.mat4.create();if(s)if(y.name==="globe"){const z=i.bn(_,n);i.aa.mat4.multiply(P,P,z)}else{const z=i.aa.mat2.invert([],w);P[0]=z[0],P[1]=z[1],P[4]=z[2],P[5]=z[3],p||i.aa.mat4.rotateZ(P,P,_.angle)}else i.aa.mat4.multiply(P,_.labelPlaneMatrix,f);return P}function Zl(f,n,s,p,_,y,w){const P=Zo(f,n,s,p,_,y,w);return y.name==="globe"&&s||(P[2]=P[6]=P[10]=P[14]=0),P}function uo(f,n,s,p,_,y,w){if(s){if(y.name==="globe"){const P=Zo(f,n,s,p,_,y,w);return i.aa.mat4.invert(P,P),i.aa.mat4.multiply(P,f,P),P}{const P=i.aa.mat4.clone(f),z=i.aa.mat4.identity([]);return z[0]=w[0],z[1]=w[1],z[4]=w[2],z[5]=w[3],i.aa.mat4.multiply(P,P,z),p||i.aa.mat4.rotateZ(P,P,-_.angle),P}}return _.glCoordMatrix}function kn(f,n,s,p){const _=[f,n,s,1];s?i.aa.vec4.transformMat4(_,_,p):Kl(_,_,p);const y=_[3];return _[0]/=y,_[1]/=y,_[2]/=y,_}function Z_(f,n){return Math.min(.5+f/n*.5,1.5)}function Zu(f,n){const s=f[0]/f[3],p=f[1]/f[3];return s>=-n[0]&&s<=n[0]&&p>=-n[1]&&p<=n[1]}function pd(f,n,s,p,_,y,w,P,z,k){const D=s.transform,j=p?f.textSizeData:f.iconSizeData,B=i.bo(j,s.transform.zoom),G=D.projection.name==="globe",Q=[256/s.width*2+1,256/s.height*2+1],J=p?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;J.clear();let ie=null;G&&(ie=p?f.text.globeExtVertexArray:f.icon.globeExtVertexArray);const oe=f.lineVertexArray,me=p?f.text.placedSymbolArray:f.icon.placedSymbolArray,Se=s.transform.width/s.transform.height;let be,Pe=!1;for(let Me=0;Me<me.length;Me++){const Ie=me.get(Me),{numGlyphs:Ce,writingMode:De}=Ie;if(De!==i.bp.vertical||Pe||be===i.bp.horizontal||(Pe=!0),be=De,(Ie.hidden||De===i.bp.vertical)&&!Pe){Yl(Ce,J);continue}Pe=!1;const $e=new i.P(Ie.tileAnchorX,Ie.tileAnchorY);let{x:at,y:rt,z:je}=D.projection.projectTilePoint($e.x,$e.y,k.canonical);if(z){const[gt,jt,Vt]=z($e);at+=gt,rt+=jt,je+=Vt}const qe=[at,rt,je,1];if(i.aa.vec4.transformMat4(qe,qe,n),!Zu(qe,Q)){Yl(Ce,J);continue}const mt=qe[3],Tt=Z_(s.transform.getCameraToCenterDistance(D.projection),mt),Lt=i.bq(j,B,Ie),et=w?Lt/Tt:Lt*Tt,xt=kn(at,rt,je,_);if(xt[3]<=0){Yl(Ce,J);continue}let st={};const Rt=w?null:z,bt=Xu(Ie,et,!1,P,n,_,y,f.glyphOffsetArray,oe,J,ie,xt,$e,st,Se,Rt,D.projection,k,w);Pe=bt.useVertical,Rt&&bt.needsFlipping&&(st={}),(bt.notEnoughRoom||Pe||bt.needsFlipping&&Xu(Ie,et,!0,P,n,_,y,f.glyphOffsetArray,oe,J,ie,xt,$e,st,Se,Rt,D.projection,k,w).notEnoughRoom)&&Yl(Ce,J)}p?(f.text.dynamicLayoutVertexBuffer.updateData(J),ie&&f.text.globeExtVertexBuffer&&f.text.globeExtVertexBuffer.updateData(ie)):(f.icon.dynamicLayoutVertexBuffer.updateData(J),ie&&f.icon.globeExtVertexBuffer&&f.icon.globeExtVertexBuffer.updateData(ie))}function Ac(f,n,s,p,_,y,w,P,z,k,D,j,B,G,Q,J){const{lineStartIndex:ie,glyphStartIndex:oe,segment:me}=P,Se=oe+P.numGlyphs,be=ie+P.lineLength,Pe=n.getoffsetX(oe),Me=n.getoffsetX(Se-1),Ie=Li(f*Pe,s,p,_,y,w,me,ie,be,z,k,D,j,B,!0,G,Q,J);if(!Ie)return null;const Ce=Li(f*Me,s,p,_,y,w,me,ie,be,z,k,D,j,B,!0,G,Q,J);return Ce?{first:Ie,last:Ce}:null}function md(f,n,s,p){return f===i.bp.horizontal&&Math.abs(p)>Math.abs(s)?{useVertical:!0}:f===i.bp.vertical?p>0?{needsFlipping:!0}:null:n!==Wr.unknown&&function(_,y){return _===0||Math.abs(y/_)>ql}(s,p)?n===Wr.flipRequired?{needsFlipping:!0}:null:s<0?{needsFlipping:!0}:null}function Xu(f,n,s,p,_,y,w,P,z,k,D,j,B,G,Q,J,ie,oe,me){const Se=n/24,be=f.lineOffsetX*Se,Pe=f.lineOffsetY*Se,{lineStartIndex:Me,glyphStartIndex:Ie,numGlyphs:Ce,segment:De,writingMode:$e,flipState:at}=f,rt=Me+f.lineLength,je=qe=>{if(D){const[et,xt,st]=qe.up,Rt=k.length;i.br(D,Rt+0,et,xt,st),i.br(D,Rt+1,et,xt,st),i.br(D,Rt+2,et,xt,st),i.br(D,Rt+3,et,xt,st)}const[mt,Tt,Lt]=qe.point;i.bs(k,mt,Tt,Lt,qe.angle)};if(Ce>1){const qe=Ac(Se,P,be,Pe,s,j,B,f,z,y,G,J,!1,ie,oe,me);if(!qe)return{notEnoughRoom:!0};if(p&&!s){let[mt,Tt,Lt]=qe.first.point,[et,xt,st]=qe.last.point;[mt,Tt]=kn(mt,Tt,Lt,w),[et,xt]=kn(et,xt,st,w);const Rt=md($e,at,(et-mt)*Q,xt-Tt);if(f.flipState=Rt&&Rt.needsFlipping?Wr.flipRequired:Wr.flipNotRequired,Rt)return Rt}je(qe.first);for(let mt=Ie+1;mt<Ie+Ce-1;mt++){const Tt=Li(Se*P.getoffsetX(mt),be,Pe,s,j,B,De,Me,rt,z,y,G,J,!1,!1,ie,oe,me);if(!Tt)return k.length-=4*(mt-Ie),{notEnoughRoom:!0};je(Tt)}je(qe.last)}else{if(p&&!s){const mt=kn(B.x,B.y,0,_),Tt=Me+De+1,Lt=new i.P(z.getx(Tt),z.gety(Tt)),et=kn(Lt.x,Lt.y,0,_),xt=et[3]>0?et:Xl(B,Lt,mt,1,_,void 0,ie,oe.canonical),st=md($e,at,(xt[0]-mt[0])*Q,xt[1]-mt[1]);if(f.flipState=st&&st.needsFlipping?Wr.flipRequired:Wr.flipNotRequired,st)return st}const qe=Li(Se*P.getoffsetX(Ie),be,Pe,s,j,B,De,Me,rt,z,y,G,J,!1,!1,ie,oe,me);if(!qe)return{notEnoughRoom:!0};je(qe)}return{}}function ho(f,n,s,p,_){const{x:y,y:w,z:P}=p.projectTilePoint(f.x,f.y,n);if(!_)return kn(y,w,P,s);const[z,k,D]=_(f);return kn(y+z,w+k,P+D,s)}function Xl(f,n,s,p,_,y,w,P){const z=ho(f.sub(n)._unit()._add(f),P,_,w,y);return i.aa.vec3.sub(z,s,z),i.aa.vec3.normalize(z,z),i.aa.vec3.scaleAndAdd(z,s,z,p)}function Li(f,n,s,p,_,y,w,P,z,k,D,j,B,G,Q,J,ie,oe){const me=p?f-n:f+n;let Se=me>0?1:-1,be=0;p&&(Se*=-1,be=Math.PI),Se<0&&(be+=Math.PI);let Pe=P+w+(Se>0?0:1)|0,Me=_,Ie=_,Ce=0,De=0;const $e=Math.abs(me),at=[],rt=[];let je=y,qe=je;const mt=()=>Xl(qe,je,Ie,$e-Ce+1,D,B,J,ie.canonical);for(;Ce+De<=$e;){if(Pe+=Se,Pe<P||Pe>=z)return null;if(Ie=Me,qe=je,at.push(Ie),G&&rt.push(qe),je=new i.P(k.getx(Pe),k.gety(Pe)),Me=j[Pe],!Me){const jt=ho(je,ie.canonical,D,J,B);Me=jt[3]>0?j[Pe]=jt:mt()}Ce+=De,De=i.aa.vec3.distance(Ie,Me)}Q&&B&&(j[Pe]&&(Me=mt(),De=i.aa.vec3.distance(Ie,Me)),j[Pe]=Me);const Tt=($e-Ce)/De,Lt=je.sub(qe)._mult(Tt)._add(qe),et=i.aa.vec3.sub([],Me,Ie),xt=i.aa.vec3.scaleAndAdd([],Ie,et,Tt);let st=[0,0,1],Rt=et[0],bt=et[1];if(oe&&(st=J.upVector(ie.canonical,Lt.x,Lt.y),st[0]!==0||st[1]!==0||st[2]!==1)){const jt=[st[2],0,-st[0]],Vt=i.aa.vec3.cross([],st,jt);i.aa.vec3.normalize(jt,jt),i.aa.vec3.normalize(Vt,Vt),Rt=i.aa.vec3.dot(et,jt),bt=i.aa.vec3.dot(et,Vt)}if(s){const jt=i.aa.vec3.cross([],st,et);i.aa.vec3.normalize(jt,jt),i.aa.vec3.scaleAndAdd(xt,xt,jt,s*Se)}const gt=be+Math.atan2(bt,Rt);return at.push(xt),G&&rt.push(Lt),{point:xt,angle:gt,path:at,tilePath:rt,up:st}}function Yl(f,n){const s=n.length,p=s+4*f;n.resize(p),n.float32.fill(-1/0,4*s,4*p)}function Kl(f,n,s){const p=n[0],_=n[1];return f[0]=s[0]*p+s[4]*_+s[12],f[1]=s[1]*p+s[5]*_+s[13],f[3]=s[3]*p+s[7]*_+s[15],f}const Hn=100;class ka{constructor(n,s,p=new xa(n.width+200,n.height+200,25),_=new xa(n.width+200,n.height+200,25)){this.transform=n,this.grid=p,this.ignoredGrid=_,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+Hn,this.screenBottomBoundary=n.height+Hn,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.fogState=s}placeCollisionBox(n,s,p,_,y,w,P,z){let k=p.projectedAnchorX,D=p.projectedAnchorY,j=p.projectedAnchorZ;const B=p.elevation,G=p.tileID,Q=n.getProjection();if(B&&G){const[Me,Ie,Ce]=Q.upVector(G.canonical,p.tileAnchorX,p.tileAnchorY),De=Q.upVectorScale(G.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;k+=Me*B*De,D+=Ie*B*De,j+=Ce*B*De}const J=this.projectAndGetPerspectiveRatio(P,k,D,j,p.tileID,Q.name==="globe"||!!B||this.transform.pitch>0,Q),ie=w*J.perspectiveRatio,oe=(p.x1*s+_.x-p.padding)*ie+J.point.x,me=(p.y1*s+_.y-p.padding)*ie+J.point.y,Se=(p.x2*s+_.x+p.padding)*ie+J.point.x,be=(p.y2*s+_.y+p.padding)*ie+J.point.y,Pe=J.perspectiveRatio<=.55||J.occluded;return!this.isInsideGrid(oe,me,Se,be)||!y&&this.grid.hitTest(oe,me,Se,be,z)||Pe?{box:[],offscreen:!1,occluded:J.occluded}:{box:[oe,me,Se,be],offscreen:this.isOffscreen(oe,me,Se,be),occluded:!1}}placeCollisionCircles(n,s,p,_,y,w,P,z,k,D,j,B,G,Q,J){const ie=[],oe=this.transform.elevation,me=n.getProjection(),Se=oe?oe.getAtTileOffsetFunc(J,this.transform.center.lat,this.transform.worldSize,me):null,be=new i.P(p.tileAnchorX,p.tileAnchorY);let{x:Pe,y:Me,z:Ie}=me.projectTilePoint(be.x,be.y,J.canonical);if(Se){const[Lt,et,xt]=Se(be);Pe+=Lt,Me+=et,Ie+=xt}const Ce=me.name==="globe",De=this.projectAndGetPerspectiveRatio(P,Pe,Me,Ie,J,Ce||!!oe||this.transform.pitch>0,me),{perspectiveRatio:$e}=De,at=(j?w/$e:w*$e)/i.bv,rt=kn(Pe,Me,Ie,z),je=De.signedDistanceFromCamera>0?Ac(at,y,p.lineOffsetX*at,p.lineOffsetY*at,!1,rt,be,p,_,z,{},oe&&!j?Se:null,j&&!!oe,me,J,j):null;let qe=!1,mt=!1,Tt=!0;if(je&&!De.occluded){const Lt=.5*G*$e+Q,et=new i.P(-100,-100),xt=new i.P(this.screenRightBoundary,this.screenBottomBoundary),st=new _n,{first:Rt,last:bt}=je,gt=Rt.path.length;let jt=[];for(let Zt=gt-1;Zt>=1;Zt--)jt.push(Rt.path[Zt]);for(let Zt=1;Zt<bt.path.length;Zt++)jt.push(bt.path[Zt]);const Vt=2.5*Lt;k&&(jt=jt.map(([Zt,wr,lr],sr)=>(Se&&!Ce&&(lr=Se(sr<gt-1?Rt.tilePath[gt-1-sr]:bt.tilePath[sr-gt+2])[2]),kn(Zt,wr,lr,k))),jt.some(Zt=>Zt[3]<=0)&&(jt=[]));let Bt=[];if(jt.length>0){let Zt=1/0,wr=-1/0,lr=1/0,sr=-1/0;for(const Er of jt)Zt=Math.min(Zt,Er[0]),lr=Math.min(lr,Er[1]),wr=Math.max(wr,Er[0]),sr=Math.max(sr,Er[1]);wr>=et.x&&Zt<=xt.x&&sr>=et.y&&lr<=xt.y&&(Bt=[jt.map(Er=>new i.P(Er[0],Er[1]))],(Zt<et.x||wr>xt.x||lr<et.y||sr>xt.y)&&(Bt=i.bt(Bt,et.x,et.y,xt.x,xt.y)))}for(const Zt of Bt){st.reset(Zt,.25*Lt);let wr=0;wr=st.length<=.5*Lt?1:Math.ceil(st.paddedLength/Vt)+1;for(let lr=0;lr<wr;lr++){const sr=lr/Math.max(wr-1,1),Er=st.lerp(sr),Jr=Er.x+Hn,Or=Er.y+Hn;ie.push(Jr,Or,Lt,0);const jn=Jr-Lt,Pn=Or-Lt,un=Jr+Lt,yn=Or+Lt;if(Tt=Tt&&this.isOffscreen(jn,Pn,un,yn),mt=mt||this.isInsideGrid(jn,Pn,un,yn),!s&&this.grid.hitTestCircle(Jr,Or,Lt,B)&&(qe=!0,!D))return{circles:[],offscreen:!1,collisionDetected:qe,occluded:!1}}}}return{circles:!D&&qe||!mt?[]:ie,offscreen:Tt,collisionDetected:qe,occluded:De.occluded}}queryRenderedSymbols(n){if(n.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const s=[];let p=1/0,_=1/0,y=-1/0,w=-1/0;for(const D of n){const j=new i.P(D.x+Hn,D.y+Hn);p=Math.min(p,j.x),_=Math.min(_,j.y),y=Math.max(y,j.x),w=Math.max(w,j.y),s.push(j)}const P=this.grid.query(p,_,y,w).concat(this.ignoredGrid.query(p,_,y,w)),z={},k={};for(const D of P){const j=D.key;if(z[j.bucketInstanceId]===void 0&&(z[j.bucketInstanceId]={}),z[j.bucketInstanceId][j.featureIndex])continue;const B=[new i.P(D.x1,D.y1),new i.P(D.x2,D.y1),new i.P(D.x2,D.y2),new i.P(D.x1,D.y2)];i.bu(s,B)&&(z[j.bucketInstanceId][j.featureIndex]=!0,k[j.bucketInstanceId]===void 0&&(k[j.bucketInstanceId]=[]),k[j.bucketInstanceId].push(j.featureIndex))}return k}insertCollisionBox(n,s,p,_,y){(s?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:_,collisionGroupID:y},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,s,p,_,y){const w=s?this.ignoredGrid:this.grid,P={bucketInstanceId:p,featureIndex:_,collisionGroupID:y};for(let z=0;z<n.length;z+=4)w.insertCircle(P,n[z],n[z+1],n[z+2])}projectAndGetPerspectiveRatio(n,s,p,_,y,w,P){const z=[s,p,_,1];let k=!1;_||this.transform.pitch>0?(i.aa.vec4.transformMat4(z,z,n),this.fogState&&y&&P.name!=="globe"&&(k=function(B,G,Q,J,ie,oe){const me=oe.calculateFogTileMatrix(ie),Se=[G,Q,J];return i.aa.vec3.transformMat4(Se,Se,me),Ut(B,i.aa.vec3.length(Se),oe.pitch,oe._fov)}(this.fogState,s,p,_,y.toUnwrapped(),this.transform)>.9)):Kl(z,z,n);const D=z[3];return{point:new i.P((z[0]/D+1)/2*this.transform.width+Hn,(-z[1]/D+1)/2*this.transform.height+Hn),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(P)/D*.5,1.5),signedDistanceFromCamera:D,occluded:w&&z[2]>D||k}}isOffscreen(n,s,p,_){return p<Hn||n>=this.screenRightBoundary||_<Hn||s>this.screenBottomBoundary}isInsideGrid(n,s,p,_){return p>=0&&n<this.gridRightBoundary&&_>=0&&s<this.gridBottomBoundary}getViewportMatrix(){const n=i.aa.mat4.identity([]);return i.aa.mat4.translate(n,n,[-100,-100,0]),n}}function ba(f,n,s){const p=n.createTileMatrix(f,f.worldSize,s.toUnwrapped());return i.aa.mat4.multiply(new Float32Array(16),f.projMatrix,p)}function yi(f,n,s){if(n.projection.name===s.projection.name)return f.projMatrix;const p=s.clone();return p.setProjection(n.projection),ba(p,n.getProjection(),f)}function Yu(f,n,s){return n.name===s.projection.name?f.projMatrix:ba(s,n,f)}class wa{constructor(n,s,p,_){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?s:-s))):_&&p?1:0,this.placed=p}isHidden(){return this.opacity===0&&!this.placed}}class ks{constructor(n,s,p,_,y,w=!1){this.text=new wa(n?n.text:null,s,p,y),this.icon=new wa(n?n.icon:null,s,_,y),this.clipped=w}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Rc{constructor(n,s,p,_=!1){this.text=n,this.icon=s,this.skipFade=p,this.clipped=_}}class Jl{constructor(){this.invProjMatrix=i.aa.mat4.create(),this.viewportMatrix=i.aa.mat4.create(),this.circles=[]}}class Ex{constructor(n,s,p,_,y){this.bucketInstanceId=n,this.featureIndex=s,this.sourceLayerIndex=p,this.bucketIndex=_,this.tileID=y}}class Ds{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const s=++this.maxGroupID;this.collisionGroups[n]={ID:s,predicate:p=>p.collisionGroupID===s}}return this.collisionGroups[n]}}function X_(f,n,s,p,_){const{horizontalAlign:y,verticalAlign:w}=i.bC(f),P=-(y-.5)*n,z=-(w-.5)*s,k=i.bB(f,p);return new i.P(P+k[0]*_,z+k[1]*_)}function gd(f,n,s,p,_){const y=new i.P(f,n);return s&&y._rotate(p?_:-_),y}class Xo{constructor(n,s,p,_,y,w){this.transform=n.clone(),this.projection=n.projection.name,this.collisionIndex=new ka(this.transform,y),this.buildingIndex=w,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=s,this.retainedQueryData={},this.collisionGroups=new Ds(p),this.collisionCircleArrays={},this.prevPlacement=_,_&&(_.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,s,p,_,y=1){const w=p.getBucket(s),P=p.latestFeatureIndex;if(!w||!P||s.fqid!==w.layerIds[0])return;const z=w.layers[0].layout,k=w.layers[0].paint,D=p.collisionBoxArray,j=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),B=p.tileSize/i.af,G=p.tileID.toUnwrapped();this.transform.setProjection(w.projection);const Q=(J=p.tileID,ie=w.getProjection(),oe=this.transform,ie.name===this.projection?oe.calculateProjMatrix(J.toUnwrapped()):ba(oe,ie,J));var J,ie,oe;const me=z.get("text-pitch-alignment")==="map",Se=z.get("text-rotation-alignment")==="map";s.compileFilter(s.options);const be=s.dynamicFilter(),Pe=s.dynamicFilterNeedsFeature(),Me=this.transform.calculatePixelsToTileUnitsMatrix(p),Ie=Zl(Q,p.tileID.canonical,me,Se,this.transform,w.getProjection(),Me);let Ce=null;if(me){const Lt=uo(Q,p.tileID.canonical,me,Se,this.transform,w.getProjection(),Me);Ce=i.aa.mat4.multiply([],this.transform.labelPlaneMatrix,Lt)}let De=null;be&&p.latestFeatureIndex&&(De={unwrappedTileID:G,dynamicFilter:be,dynamicFilterNeedsFeature:Pe}),this.retainedQueryData[w.bucketInstanceId]=new Ex(w.bucketInstanceId,P,w.sourceLayerIndex,w.index,p.tileID);const[$e,at]=w.layers[0].layout.get("text-size-scale-range"),rt=i.av(y,$e,at),[je,qe]=z.get("icon-size-scale-range"),mt=i.av(y,je,qe),Tt={bucket:w,layout:z,paint:k,posMatrix:Q,textLabelPlaneMatrix:Ie,labelToScreenMatrix:Ce,clippingData:De,scale:j,textPixelRatio:B,holdingForFade:p.holdingForFade(),collisionBoxArray:D,partiallyEvaluatedTextSize:i.bo(w.textSizeData,this.transform.zoom,rt),partiallyEvaluatedIconSize:i.bo(w.iconSizeData,this.transform.zoom,mt),collisionGroup:this.collisionGroups.get(w.sourceID),latestFeatureIndex:p.latestFeatureIndex};if(_)for(const Lt of w.sortKeyRanges){const{sortKey:et,symbolInstanceStart:xt,symbolInstanceEnd:st}=Lt;n.push({sortKey:et,symbolInstanceStart:xt,symbolInstanceEnd:st,parameters:Tt})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:Tt})}attemptAnchorPlacement(n,s,p,_,y,w,P,z,k,D,j,B,G,Q,J,ie,oe,me){const{textOffset0:Se,textOffset1:be,crossTileID:Pe}=B,Me=[Se,be],Ie=X_(n,p,_,Me,y),Ce=this.collisionIndex.placeCollisionBox(Q,y,s,gd(Ie.x,Ie.y,w,P,this.transform.angle),j,z,k,D.predicate);if(ie){const De=Q.getSymbolInstanceIconSize(me,this.transform.zoom,B.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(Q,De,ie,gd(Ie.x,Ie.y,w,P,this.transform.angle),j,z,k,D.predicate).box.length===0)return}if(Ce.box.length>0){let De;return this.prevPlacement&&this.prevPlacement.variableOffsets[Pe]&&this.prevPlacement.placements[Pe]&&this.prevPlacement.placements[Pe].text&&(De=this.prevPlacement.variableOffsets[Pe].anchor),this.variableOffsets[Pe]={textOffset:Me,width:p,height:_,anchor:n,textScale:y,prevAnchor:De},this.markUsedJustification(Q,n,B,J),Q.allowVerticalPlacement&&(this.markUsedOrientation(Q,J,B),this.placedOrientations[Pe]=J),{shift:Ie,placedGlyphBoxes:Ce}}}placeLayerBucketPart(n,s,p,_,y=1){const{bucket:w,layout:P,paint:z,posMatrix:k,textLabelPlaneMatrix:D,labelToScreenMatrix:j,clippingData:B,textPixelRatio:G,holdingForFade:Q,collisionBoxArray:J,partiallyEvaluatedTextSize:ie,partiallyEvaluatedIconSize:oe,collisionGroup:me,latestFeatureIndex:Se}=n.parameters,be=P.get("text-optional"),Pe=P.get("icon-optional"),Me=P.get("text-allow-overlap"),Ie=P.get("icon-allow-overlap"),Ce=P.get("text-rotation-alignment")==="map",De=P.get("text-pitch-alignment")==="map",$e=P.get("symbol-z-elevate"),at=z.get("symbol-z-offset"),rt=P.get("symbol-elevation-reference")==="sea",[je,qe]=P.get("text-size-scale-range"),[mt,Tt]=P.get("icon-size-scale-range"),Lt=i.av(y,je,qe),et=i.av(y,mt,Tt);this.transform.setProjection(w.projection);let xt=Me&&(Ie||!w.hasIconData()||Pe),st=Ie&&(Me||!w.hasTextData()||be);const Rt=!at.isConstant();!w.collisionArrays&&J&&w.deserializeCollisionBoxes(J),p&&_&&w.updateCollisionDebugBuffers(this.transform.zoom,J,Lt,et);const bt=(gt,jt,Vt)=>{const{crossTileID:Bt,numVerticalGlyphVertices:Zt}=gt;let wr=null;if(B&&B.dynamicFilterNeedsFeature||Rt){const On=this.retainedQueryData[w.bucketInstanceId];wr=Se.loadFeature({featureIndex:gt.featureIndex,bucketIndex:On.bucketIndex,sourceLayerIndex:On.sourceLayerIndex,layoutVertexArrayOffset:0})}if(B&&!(0,B.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},wr,this.retainedQueryData[w.bucketInstanceId].tileID.canonical,new i.P(gt.tileAnchorX,gt.tileAnchorY),this.transform.calculateDistanceTileData(B.unwrappedTileID)))return this.placements[Bt]=new Rc(!1,!1,!1,!0),void s.add(Bt);const lr=at.evaluate(wr,{});if(s.has(Bt))return;if(Q)return void(this.placements[Bt]=new Rc(!1,!1,!1));let sr=!1,Er=!1,Jr=!0,Or=!1,jn=!1,Pn=null,un={box:null,offscreen:null,occluded:null},yn={box:null,offscreen:null,occluded:null},Fr=null,Qr=null,pr=null,an=0,ei=0,$i=0;Vt.textFeatureIndex?an=Vt.textFeatureIndex:gt.useRuntimeCollisionCircles&&(an=gt.featureIndex),Vt.verticalTextFeatureIndex&&(ei=Vt.verticalTextFeatureIndex);const ra=On=>{On.tileID=this.retainedQueryData[w.bucketInstanceId].tileID;const Tn=this.transform.elevation;On.elevation=rt?lr:lr+(Tn?Tn.getAtTileOffset(On.tileID,On.tileAnchorX,On.tileAnchorY):0),On.elevation+=gt.zOffset},po=Vt.textBox;if(po){ra(po);const On=en=>{let ni=i.bp.horizontal;if(w.allowVerticalPlacement&&!en&&this.prevPlacement){const Di=this.prevPlacement.placedOrientations[Bt];Di&&(this.placedOrientations[Bt]=Di,ni=Di,this.markUsedOrientation(w,ni,gt))}return ni},Tn=(en,ni)=>{if(w.allowVerticalPlacement&&Zt>0&&Vt.verticalTextBox){for(const Di of w.writingModes)if(Di===i.bp.vertical?(un=ni(),yn=un):un=en(),un&&un.box&&un.box.length)break}else un=en()};if(P.get("text-variable-anchor")){let en=P.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Bt]){const An=this.prevPlacement.variableOffsets[Bt];en.indexOf(An.anchor)>0&&(en=en.filter(io=>io!==An.anchor),en.unshift(An.anchor))}const ni=(An,io,ca)=>{const No=w.getSymbolInstanceTextSize(ie,gt,this.transform.zoom,jt),Ws=(An.x2-An.x1)*No+2*An.padding,hs=(An.y2-An.y1)*No+2*An.padding,mo=gt.hasIconTextFit&&!Ie?io:null;mo&&ra(mo);let ua={box:[],offscreen:!1,occluded:!1};const qs=Me?2*en.length:en.length;for(let $a=0;$a<qs;++$a){const dc=this.attemptAnchorPlacement(en[$a%en.length],An,Ws,hs,No,Ce,De,G,k,me,$a>=en.length,gt,jt,w,ca,mo,ie,oe);if(dc&&(ua=dc.placedGlyphBoxes,ua&&ua.box&&ua.box.length)){sr=!0,Pn=dc.shift;break}}return ua};Tn(()=>ni(po,Vt.iconBox,i.bp.horizontal),()=>{const An=Vt.verticalTextBox;return An&&ra(An),w.allowVerticalPlacement&&!(un&&un.box&&un.box.length)&&Zt>0&&An?ni(An,Vt.verticalIconBox,i.bp.vertical):{box:null,offscreen:null,occluded:null}}),un&&(sr=un.box,Jr=un.offscreen,Or=un.occluded);const Di=On(!(!un||!un.box));if(!sr&&this.prevPlacement){const An=this.prevPlacement.variableOffsets[Bt];An&&(this.variableOffsets[Bt]=An,this.markUsedJustification(w,An.anchor,gt,Di))}}else{const en=(ni,Di)=>{const An=w.getSymbolInstanceTextSize(ie,gt,this.transform.zoom,jt,y),io=this.collisionIndex.placeCollisionBox(w,An,ni,new i.P(0,0),Me,G,k,me.predicate);return io&&io.box&&io.box.length&&(this.markUsedOrientation(w,Di,gt),this.placedOrientations[Bt]=Di),io};Tn(()=>en(po,i.bp.horizontal),()=>{const ni=Vt.verticalTextBox;return w.allowVerticalPlacement&&Zt>0&&ni?(ra(ni),en(ni,i.bp.vertical)):{box:null,offscreen:null,occluded:null}}),On(!!(un&&un.box&&un.box.length))}}if(Fr=un,sr=Fr&&Fr.box&&Fr.box.length>0,Jr=Fr&&Fr.offscreen,Or=Fr&&Fr.occluded,gt.useRuntimeCollisionCircles){const On=w.text.placedSymbolArray.get(gt.centerJustifiedTextSymbolIndex>=0?gt.centerJustifiedTextSymbolIndex:gt.verticalPlacedTextSymbolIndex),Tn=i.bq(w.textSizeData,ie,On),en=P.get("text-padding");Qr=this.collisionIndex.placeCollisionCircles(w,Me,On,w.lineVertexArray,w.glyphOffsetArray,Tn,k,D,j,p,De,me.predicate,gt.collisionCircleDiameter*Tn/i.bv,en,this.retainedQueryData[w.bucketInstanceId].tileID),sr=Me||Qr.circles.length>0&&!Qr.collisionDetected,Jr=Jr&&Qr.offscreen,Or=Qr.occluded}if(Vt.iconFeatureIndex&&($i=Vt.iconFeatureIndex),Vt.iconBox){const On=Tn=>{ra(Tn);const en=gt.hasIconTextFit&&Pn?gd(Pn.x,Pn.y,Ce,De,this.transform.angle):new i.P(0,0),ni=w.getSymbolInstanceIconSize(oe,this.transform.zoom,gt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(w,ni,Tn,en,Ie,G,k,me.predicate)};yn&&yn.box&&yn.box.length&&Vt.verticalIconBox?(pr=On(Vt.verticalIconBox),Er=pr.box.length>0):(pr=On(Vt.iconBox),Er=pr.box.length>0),Jr=Jr&&pr.offscreen,jn=pr.occluded}const ki=be||gt.numHorizontalGlyphVertices===0&&Zt===0,vi=Pe||gt.numIconVertices===0;if(ki||vi?vi?ki||(Er=Er&&sr):sr=Er&&sr:Er=sr=Er&&sr,sr&&Fr&&Fr.box&&this.collisionIndex.insertCollisionBox(Fr.box,P.get("text-ignore-placement"),w.bucketInstanceId,yn&&yn.box&&ei?ei:an,me.ID),Er&&pr&&this.collisionIndex.insertCollisionBox(pr.box,P.get("icon-ignore-placement"),w.bucketInstanceId,$i,me.ID),Qr&&(sr&&this.collisionIndex.insertCollisionCircles(Qr.circles,P.get("text-ignore-placement"),w.bucketInstanceId,an,me.ID),p)){const On=w.bucketInstanceId;let Tn=this.collisionCircleArrays[On];Tn===void 0&&(Tn=this.collisionCircleArrays[On]=new Jl);for(let en=0;en<Qr.circles.length;en+=4)Tn.circles.push(Qr.circles[en+0]),Tn.circles.push(Qr.circles[en+1]),Tn.circles.push(Qr.circles[en+2]),Tn.circles.push(Qr.collisionDetected?1:0)}const oi=w.projection.name!=="globe";xt=xt&&(oi||!Or),st=st&&(oi||!jn),this.placements[Bt]=new Rc(sr||xt,Er||st,Jr||w.justReloaded),s.add(Bt)};if($e&&this.buildingIndex&&(this.buildingIndex.updateZOffset(w,this.retainedQueryData[w.bucketInstanceId].tileID),w.updateZOffset()),w.sortFeaturesByY){const gt=w.getSortedSymbolIndexes(this.transform.angle);for(let jt=gt.length-1;jt>=0;--jt){const Vt=gt[jt];bt(w.symbolInstances.get(Vt),Vt,w.collisionArrays[Vt])}w.hasAnyZOffset&&i.w(`${w.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(w.hasAnyZOffset){const gt=w.getSortedIndexesByZOffset();for(let jt=0;jt<gt.length;++jt){const Vt=gt[jt];bt(w.symbolInstances.get(Vt),Vt,w.collisionArrays[Vt])}}else for(let gt=n.symbolInstanceStart;gt<n.symbolInstanceEnd;gt++)bt(w.symbolInstances.get(gt),gt,w.collisionArrays[gt]);if(p&&w.bucketInstanceId in this.collisionCircleArrays){const gt=this.collisionCircleArrays[w.bucketInstanceId];i.aa.mat4.invert(gt.invProjMatrix,k),gt.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1}markUsedJustification(n,s,p,_){const{leftJustifiedTextSymbolIndex:y,centerJustifiedTextSymbolIndex:w,rightJustifiedTextSymbolIndex:P,verticalPlacedTextSymbolIndex:z,crossTileID:k}=p,D=i.bA(s),j=_===i.bp.vertical?z:D==="left"?y:D==="center"?w:D==="right"?P:-1;y>=0&&(n.text.placedSymbolArray.get(y).crossTileID=j>=0&&y!==j?0:k),w>=0&&(n.text.placedSymbolArray.get(w).crossTileID=j>=0&&w!==j?0:k),P>=0&&(n.text.placedSymbolArray.get(P).crossTileID=j>=0&&P!==j?0:k),z>=0&&(n.text.placedSymbolArray.get(z).crossTileID=j>=0&&z!==j?0:k)}markUsedOrientation(n,s,p){const _=s===i.bp.horizontal||s===i.bp.horizontalOnly?s:0,y=s===i.bp.vertical?s:0,{leftJustifiedTextSymbolIndex:w,centerJustifiedTextSymbolIndex:P,rightJustifiedTextSymbolIndex:z,verticalPlacedTextSymbolIndex:k}=p,D=n.text.placedSymbolArray;w>=0&&(D.get(w).placedOrientation=_),P>=0&&(D.get(P).placedOrientation=_),z>=0&&(D.get(z).placedOrientation=_),k>=0&&(D.get(k).placedOrientation=y)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const s=this.prevPlacement;let p=!1;this.prevZoomAdjustment=s?s.zoomAdjustment(this.transform.zoom):0;const _=s?s.symbolFadeChange(n):1,y=s?s.opacities:{},w=s?s.variableOffsets:{},P=s?s.placedOrientations:{};for(const z in this.placements){const k=this.placements[z],D=y[z];D?(this.opacities[z]=new ks(D,_,k.text,k.icon,null,k.clipped),p=p||k.text!==D.text.placed||k.icon!==D.icon.placed):(this.opacities[z]=new ks(null,_,k.text,k.icon,k.skipFade,k.clipped),p=p||k.text||k.icon)}for(const z in y){const k=y[z];if(!this.opacities[z]){const D=new ks(k,_,!1,!1);D.isHidden()||(this.opacities[z]=D,p=p||k.text.placed||k.icon.placed)}}for(const z in w)this.variableOffsets[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.variableOffsets[z]=w[z]);for(const z in P)this.placedOrientations[z]||!this.opacities[z]||this.opacities[z].isHidden()||(this.placedOrientations[z]=P[z]);p?this.lastPlacementChangeTime=n:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=s?s.lastPlacementChangeTime:n)}updateLayerOpacities(n,s,p,_){const y=new Set;for(const w of s){const P=w.getBucket(n);P&&w.latestFeatureIndex&&n.fqid===P.layerIds[0]&&(this.updateBucketOpacities(P,y,w,w.collisionBoxArray,p,_,w.tileID,n.scope),P.layers[0].layout.get("symbol-z-elevate")&&this.buildingIndex&&(this.buildingIndex.updateZOffset(P,w.tileID),P.updateZOffset()))}}updateBucketOpacities(n,s,p,_,y,w,P,z){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const k=n.layers[0].layout,D=n.layers[0].paint,j=!!n.layers[0].dynamicFilter(),B=new ks(null,0,!1,!1,!0),G=k.get("text-allow-overlap"),Q=k.get("icon-allow-overlap"),J=k.get("text-variable-anchor"),ie=k.get("text-rotation-alignment")==="map",oe=k.get("text-pitch-alignment")==="map",me=D.get("symbol-z-offset"),Se=k.get("symbol-elevation-reference")==="sea",be=!me.isConstant(),Pe=new ks(null,0,G&&(Q||!n.hasIconData()||k.get("icon-optional")),Q&&(G||!n.hasTextData()||k.get("text-optional")),!0);!n.collisionArrays&&_&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(_);const Me=(Ce,De,$e)=>{for(let at=0;at<De/4;at++)Ce.opacityVertexArray.emplaceBack($e)};let Ie=0;w&&n.updateReplacement(P,w);for(let Ce=0;Ce<n.symbolInstances.length;Ce++){const De=n.symbolInstances.get(Ce),{numHorizontalGlyphVertices:$e,numVerticalGlyphVertices:at,crossTileID:rt,numIconVertices:je,tileAnchorX:qe,tileAnchorY:mt}=De;let Tt=null;const Lt=this.retainedQueryData[n.bucketInstanceId];be&&De&&Lt&&(Tt=p.latestFeatureIndex.loadFeature({featureIndex:De.featureIndex,bucketIndex:Lt.bucketIndex,sourceLayerIndex:Lt.sourceLayerIndex,layoutVertexArrayOffset:0}));const et=me.evaluate(Tt,{}),xt=s.has(rt);let st=this.opacities[rt];xt?st=B:st||(st=Pe,this.opacities[rt]=st),s.add(rt);const Rt=$e>0||at>0,bt=je>0,gt=this.placedOrientations[rt],jt=gt===i.bp.vertical,Vt=gt===i.bp.horizontal||gt===i.bp.horizontalOnly;!Rt&&!bt||st.isHidden()||Ie++;let Bt=!1;if((Rt||bt)&&w)for(const Zt of n.activeReplacements){if(i.bw(Zt,y,i.bx.Symbol,z)||Zt.min.x>qe||qe>Zt.max.x||Zt.min.y>mt||mt>Zt.max.y)continue;const wr=i.by(qe,mt,P.canonical,Zt.footprintTileId.canonical);if(Bt=i.bz(wr,Zt.footprint),Bt)break}if(Rt){const Zt=Bt?Da:K_(st.text);Me(n.text,$e,jt?Da:Zt),Me(n.text,at,Vt?Da:Zt);const wr=st.text.isHidden(),{leftJustifiedTextSymbolIndex:lr,centerJustifiedTextSymbolIndex:sr,rightJustifiedTextSymbolIndex:Er,verticalPlacedTextSymbolIndex:Jr}=De,Or=n.text.placedSymbolArray,jn=wr||jt?1:0;lr>=0&&(Or.get(lr).hidden=jn),sr>=0&&(Or.get(sr).hidden=jn),Er>=0&&(Or.get(Er).hidden=jn),Jr>=0&&(Or.get(Jr).hidden=wr||Vt?1:0);const Pn=this.variableOffsets[rt];Pn&&this.markUsedJustification(n,Pn.anchor,De,gt);const un=this.placedOrientations[rt];un&&(this.markUsedJustification(n,"left",De,un),this.markUsedOrientation(n,un,De))}if(bt){const Zt=Bt?Da:K_(st.icon),{placedIconSymbolIndex:wr,verticalPlacedIconSymbolIndex:lr}=De,sr=n.icon.placedSymbolArray,Er=st.icon.isHidden()?1:0;wr>=0&&(Me(n.icon,je,jt?Da:Zt),sr.get(wr).hidden=Er),lr>=0&&(Me(n.icon,De.numVerticalIconVertices,Vt?Da:Zt),sr.get(lr).hidden=Er)}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const Zt=n.collisionArrays[Ce];if(Zt){let wr=new i.P(0,0),lr=!0;if(Zt.textBox||Zt.verticalTextBox){if(J){const Er=this.variableOffsets[rt];Er?(wr=X_(Er.anchor,Er.width,Er.height,Er.textOffset,Er.textScale),ie&&wr._rotate(oe?this.transform.angle:-this.transform.angle)):lr=!1}j&&(lr=!st.clipped),Zt.textBox&&_d(n.textCollisionBox.collisionVertexArray,st.text.placed,!lr||jt,et,Se,wr.x,wr.y),Zt.verticalTextBox&&_d(n.textCollisionBox.collisionVertexArray,st.text.placed,!lr||Vt,et,Se,wr.x,wr.y)}const sr=lr&&!!(!Vt&&Zt.verticalIconBox);Zt.iconBox&&_d(n.iconCollisionBox.collisionVertexArray,st.icon.placed,sr,et,Se,De.hasIconTextFit?wr.x:0,De.hasIconTextFit?wr.y:0),Zt.verticalIconBox&&_d(n.iconCollisionBox.collisionVertexArray,st.icon.placed,!sr,et,Se,De.hasIconTextFit?wr.x:0,De.hasIconTextFit?wr.y:0)}}}if(n.fullyClipped=Ie===0,n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){const Ce=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=Ce.invProjMatrix,n.placementViewportMatrix=Ce.viewportMatrix,n.collisionCircleArray=Ce.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return this.fadeDuration===0?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,s){const p=this.zoomAtLastRecencyCheck===s?1-this.zoomAdjustment(s):1;return this.zoomAtLastRecencyCheck=s,this.commitTime+this.fadeDuration*p>n}setStale(){this.stale=!0}}function _d(f,n,s,p,_,y,w){f.emplaceBack(n?1:0,s?1:0,y||0,w||0,p,_?1:0),f.emplaceBack(n?1:0,s?1:0,y||0,w||0,p,_?1:0),f.emplaceBack(n?1:0,s?1:0,y||0,w||0,p,_?1:0),f.emplaceBack(n?1:0,s?1:0,y||0,w||0,p,_?1:0)}const yd=Math.pow(2,25),Y_=Math.pow(2,24),Ku=Math.pow(2,17),Tx=Math.pow(2,16),Cx=Math.pow(2,9),Ju=Math.pow(2,8),Qu=Math.pow(2,1);function K_(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const n=f.placed?1:0,s=Math.floor(127*f.opacity);return s*yd+n*Y_+s*Ku+n*Tx+s*Cx+n*Ju+s*Qu+n}const Da=0;class J_{constructor(n){this._sortAcrossTiles=n.layout.get("symbol-z-order")!=="viewport-y"&&n.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(n,s,p,_,y,w){const P=this._bucketParts;for(;this._currentTileIndex<n.length;)if(s.getBucketParts(P,_,n[this._currentTileIndex],this._sortAcrossTiles,w),this._currentTileIndex++,y())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,P.sort((z,k)=>z.sortKey-k.sortKey));this._currentPartIndex<P.length;){const z=P[this._currentPartIndex];if(s.placeLayerBucketPart(z,this._seenCrossTileIDs,p,z.symbolInstanceStart===0,w),this._currentPartIndex++,y())return!0}return!1}}class vd{constructor(n,s,p,_,y,w,P,z,k){this.placement=new Xo(n,y,w,P,z,k),this._currentPlacementIndex=s.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=_,this._done=!1}isDone(){return this._done}continuePlacement(n,s,p,_,y){const w=i.q.now(),P=()=>{const z=i.q.now()-w;return!this._forceFullPlacement&&z>2};for(;this._currentPlacementIndex>=0;){const z=s[n[this._currentPlacementIndex]],k=this.placement.collisionIndex.transform.zoom;if(z.type==="symbol"&&(!z.minzoom||z.minzoom<=k)&&(!z.maxzoom||z.maxzoom>k)){const D=z,j=D.layout.get("symbol-z-elevate"),B=D.layout.get("symbol-sort-key").constantOr(1)!==void 0,G=D.layout.get("symbol-z-order"),Q=G==="viewport-y"||G==="auto"&&!(G!=="viewport-y"&&B),J=D.layout.get("text-allow-overlap")||D.layout.get("icon-allow-overlap")||D.layout.get("text-ignore-placement")||D.layout.get("icon-ignore-placement"),ie=Q&&J,oe=this._inProgressLayer=this._inProgressLayer||new J_(D),me=i.aB(z.source,z.scope);if(oe.continuePlacement(j||ie?_[me]:p[me],this.placement,this._showCollisionBoxes,z,P,y))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const ls=512/i.af/2;class Mx{constructor(n,s,p){this.tileID=n,this.bucketInstanceId=p,this.index=new i.bD(s.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const _=n.canonical.x*i.af,y=n.canonical.y*i.af;for(let w=0;w<s.length;w++){const{key:P,crossTileID:z,tileAnchorX:k,tileAnchorY:D}=s.get(w),j=Math.floor((_+k)*ls),B=Math.floor((y+D)*ls);this.index.add(j,B),this.keys.push(P),this.crossTileIDs.push(z)}this.index.finish()}findMatches(n,s,p){const _=this.tileID.canonical.z<s.canonical.z?1:Math.pow(2,this.tileID.canonical.z-s.canonical.z),y=ls/Math.pow(2,s.canonical.z-this.tileID.canonical.z),w=s.canonical.x*i.af,P=s.canonical.y*i.af;for(let z=0;z<n.length;z++){const k=n.get(z);if(k.crossTileID)continue;const{key:D,tileAnchorX:j,tileAnchorY:B}=k,G=Math.floor((w+j)*y),Q=Math.floor((P+B)*y),J=this.index.range(G-_,Q-_,G+_,Q+_);for(const ie of J){const oe=this.crossTileIDs[ie];if(this.keys[ie]===D&&!p.has(oe)){p.add(oe),k.crossTileID=oe;break}}}}}class Ix{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Px{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const s=Math.round((n-this.lng)/360);if(s!==0)for(const p in this.indexes){const _=this.indexes[p],y={};for(const w in _){const P=_[w];P.tileID=P.tileID.unwrapTo(P.tileID.wrap+s),y[P.tileID.key]=P}this.indexes[p]=y}this.lng=n}addBucket(n,s,p){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===s.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let y=0;y<s.symbolInstances.length;y++)s.symbolInstances.get(y).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]=new Set);const _=this.usedCrossTileIDs[n.overscaledZ];for(const y in this.indexes){const w=this.indexes[y];if(Number(y)>n.overscaledZ)for(const P in w){const z=w[P];z.tileID.isChildOf(n)&&z.findMatches(s.symbolInstances,n,_)}else{const P=w[n.scaledTo(Number(y)).key];P&&P.findMatches(s.symbolInstances,n,_)}}for(let y=0;y<s.symbolInstances.length;y++){const w=s.symbolInstances.get(y);w.crossTileID||(w.crossTileID=p.generate(),_.add(w.crossTileID))}return this.indexes[n.overscaledZ]===void 0&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new Mx(n,s.symbolInstances,s.bucketInstanceId),!0}removeBucketCrossTileIDs(n,s){for(const p of s.crossTileIDs)this.usedCrossTileIDs[n].delete(p)}removeStaleBuckets(n){let s=!1;for(const p in this.indexes){const _=this.indexes[p];for(const y in _)n[_[y].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,_[y]),delete _[y],s=!0)}return s}}class Q_{constructor(){this.layerIndexes={},this.crossTileIDs=new Ix,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,s,p,_){let y=this.layerIndexes[n.fqid];y===void 0&&(y=this.layerIndexes[n.fqid]=new Px);let w=!1;const P={};_.name!=="globe"&&y.handleWrapJump(p);for(const z of s){const k=z.getBucket(n);k&&n.fqid===k.layerIds[0]&&(k.bucketInstanceId||(k.bucketInstanceId=++this.maxBucketInstanceId),y.addBucket(z.tileID,k,this.crossTileIDs)&&(w=!0),P[k.bucketInstanceId]=!0)}return y.removeStaleBuckets(P)&&(w=!0),w}pruneUnusedLayers(n){const s={};n.forEach(p=>{s[p]=!0});for(const p in this.layerIndexes)s[p]||delete this.layerIndexes[p]}}const zc=771;class Br{constructor(n,s,p,_){this.blendFunction=n,this.blendColor=s,this.mask=p,this.blendEquation=_}}Br.Replace=[1,0,1,0],Br.disabled=new Br(Br.Replace,i.ai.transparent,[!1,!1,!1,!1]),Br.unblended=new Br(Br.Replace,i.ai.transparent,[!0,!0,!0,!0]),Br.alphaBlended=new Br([1,zc,1,zc],i.ai.transparent,[!0,!0,!0,!0]),Br.alphaBlendedNonPremultiplied=new Br([770,zc,770,zc],i.ai.transparent,[!0,!0,!0,!0]),Br.multiply=new Br([774,0,774,0],i.ai.transparent,[!0,!0,!0,!0]);class ir{constructor(n,s,p){this.func=n,this.mask=s,this.range=p}}ir.ReadOnly=!1,ir.ReadWrite=!0,ir.disabled=new ir(519,ir.ReadOnly,[0,1]);const xd=7680;class Cr{constructor(n,s,p,_,y,w){this.test=n,this.ref=s,this.mask=p,this.fail=_,this.depthFail=y,this.pass=w}}Cr.disabled=new Cr({func:519,mask:0},0,0,xd,xd,xd);const bd=1029,Os=2305;class mr{constructor(n,s,p){this.enable=n,this.mode=s,this.frontFace=p}}function jp(f,n){const s=i.bF(f,3);i.aa.mat4.fromQuat(f,n),i.bH(f,3,s)}function wd(f,n){const s=i.aa.quat.identity([]);return i.aa.quat.rotateZ(s,s,-n),i.aa.quat.rotateX(s,s,-f),s}function Lc(f,n){const s=[f[0],f[1],0],p=[n[0],n[1],0];if(i.aa.vec3.length(s)>=1e-15){const w=i.aa.vec3.normalize([],s);i.aa.vec3.scale(p,w,i.aa.vec3.dot(p,w)),n[0]=p[0],n[1]=p[1]}const _=i.aa.vec3.cross([],n,f);if(i.aa.vec3.len(_)<1e-15)return null;const y=Math.atan2(-_[1],_[0]);return wd(Math.atan2(Math.sqrt(f[0]*f[0]+f[1]*f[1]),-f[2]),y)}mr.disabled=new mr(!1,bd,Os),mr.backCCW=new mr(!0,bd,Os),mr.backCW=new mr(!0,bd,2304),mr.frontCW=new mr(!0,1028,2304),mr.frontCCW=new mr(!0,1028,Os);class kc{constructor(n,s){this.position=n,this.orientation=s}get position(){return this._position}set position(n){if(n){const s=n instanceof i.a9?n:new i.a9(n[0],n[1],n[2]);this._renderWorldCopies&&(s.x=i.bE(s.x,0,1)),this._position=s}else this._position=null}lookAtPoint(n,s){if(this.orientation=null,!this.position)return;const p=this.position,_=this._elevation?this._elevation.getAtPointOrZero(i.a9.fromLngLat(n)):0,y=i.a9.fromLngLat(n,_),w=[y.x-p.x,y.y-p.y,y.z-p.z];s||(s=[0,0,1]),s[2]=Math.abs(s[2]),this.orientation=Lc(w,s)}setPitchBearing(n,s){this.orientation=wd(i.ah(n),i.ah(-s))}}class eh{constructor(n,s){this._transform=i.aa.mat4.identity([]),this.orientation=s,this.position=n}get mercatorPosition(){const n=this.position;return new i.a9(n[0],n[1],n[2])}get position(){const n=i.bF(this._transform,3);return[n[0],n[1],n[2]]}set position(n){var s;n&&i.bH(this._transform,3,[(s=n)[0],s[1],s[2],1])}get orientation(){return this._orientation}set orientation(n){this._orientation=n||i.aa.quat.identity([]),n&&jp(this._transform,this._orientation)}getPitchBearing(){const n=this.forward(),s=this.right();return{bearing:Math.atan2(-s[1],s[0]),pitch:Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),-n[2])}}setPitchBearing(n,s){this._orientation=wd(n,s),jp(this._transform,this._orientation)}forward(){const n=i.bF(this._transform,2);return[-n[0],-n[1],-n[2]]}up(){const n=i.bF(this._transform,1);return[-n[0],-n[1],-n[2]]}right(){const n=i.bF(this._transform,0);return[n[0],n[1],n[2]]}getCameraToWorld(n,s){const p=new Float64Array(16);return i.aa.mat4.invert(p,this.getWorldToCamera(n,s)),p}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(n,s,p){const _=this.position;i.aa.vec3.scale(_,_,-n);const y=new Float64Array(16);return i.aa.mat4.fromScaling(y,[p,p,p]),i.aa.mat4.translate(y,y,_),y[10]*=s,y}getWorldToCamera(n,s){const p=new Float64Array(16),_=new Float64Array(4),y=this.position;return i.aa.quat.conjugate(_,this._orientation),i.aa.vec3.scale(y,y,-n),i.aa.mat4.fromQuat(p,_),i.aa.mat4.translate(p,p,y),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=s,p[9]*=s,p[10]*=s,p[11]*=s,p}getCameraToClipPerspective(n,s,p,_){const y=new Float64Array(16);return i.aa.mat4.perspective(y,n,s,p,_),y}getCameraToClipOrthographic(n,s,p,_,y,w){const P=new Float64Array(16);return i.aa.mat4.ortho(P,n,s,p,_,y,w),P}getDistanceToElevation(n,s=!1){const p=n===0?0:i.bG(n,s?i.aR(this.position[1]):this.position[1]),_=this.forward();return(p-this.position[2])/_[2]}clone(){return new eh([...this.position],[...this.orientation])}}const to={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class Yo{constructor(n=0,s=0,p=0,_=0){if(isNaN(n)||n<0||isNaN(s)||s<0||isNaN(p)||p<0||isNaN(_)||_<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=s,this.left=p,this.right=_}interpolate(n,s,p){return s.top!=null&&n.top!=null&&(this.top=i.ae(n.top,s.top,p)),s.bottom!=null&&n.bottom!=null&&(this.bottom=i.ae(n.bottom,s.bottom,p)),s.left!=null&&n.left!=null&&(this.left=i.ae(n.left,s.left,p)),s.right!=null&&n.right!=null&&(this.right=i.ae(n.right,s.right,p)),this}getCenter(n,s){const p=i.av((this.left+n-this.right)/2,0,n),_=i.av((this.top+s-this.bottom)/2,0,s);return new i.P(p,_)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new Yo(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const Sd=(f,n,s)=>(1-s)*f+s*n,Nt=f=>f*f*f*f*f;class Ed{constructor(n,s,p,_,y,w,P){this.tileSize=512,this._renderWorldCopies=y===void 0||y,this._minZoom=n||0,this._maxZoom=s||22,this._minPitch=p??0,this._maxPitch=_??60,this.setProjection(w),this.setMaxBounds(P),this.width=0,this.height=0,this._center=new i.bN(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new Yo,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new eh,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const n=new Ed(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return n._elevation=this._elevation,n._centerAltitude=this._centerAltitude,n._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,n.tileSize=this.tileSize,n.mercatorFromTransition=this.mercatorFromTransition,n.width=this.width,n.height=this.height,n.cameraElevationReference=this.cameraElevationReference,n._center=this._center,n._setZoom(this.zoom),n._seaLevelZoom=this._seaLevelZoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._nearZ=this._nearZ,n._farZ=this._farZ,n._averageElevation=this._averageElevation,n._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._camera=this._camera.clone(),n._calcMatrices(),n.freezeTileCoverage=this.freezeTileCoverage,n.frustumCorners=this.frustumCorners,n}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<15}get elevation(){return this._elevation}set elevation(n){this._elevation!==n&&(this._elevation=n,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(n,s=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||p)&&this._updateCameraOnTerrain(),(n||p)&&this._constrainCamera(s),this._calcMatrices()}getProjection(){return i.ax(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const s=this.projection?this.getProjection():void 0;this.projection=i.bO(this.projectionOptions);const p=this.getProjection(),_=!i.bm(s,p);return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setOrthographicProjectionAtLowPitch(n){return this._orthographicProjectionAtLowPitch!==n&&(this._orthographicProjectionAtLowPitch=n,this._calcMatrices(),!0)}setMercatorFromTransition(){const n=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=i.bO({name:"mercator"});const s=n!==this.projection.name;return s&&this._calcMatrices(),s}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(n){n===void 0?n=!0:n===null&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get cameraWorldSize(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return i.bG(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new i.P(this.width,this.height)}get bearing(){return i.bE(this.rotation,-180,180)}set bearing(n){this.rotation=n}get rotation(){return-this.angle/Math.PI*180}set rotation(n){const s=-n*Math.PI/180;this.angle!==s&&(this._unmodified=!1,this.angle=s,this._calcMatrices(),this.rotationMatrix=i.aa.mat2.create(),i.aa.mat2.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const s=i.av(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==s&&(this._unmodified=!1,this._pitch=s,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const n=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/n)}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=i.ah(n),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(n){this._averageElevation=n,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(n){const s=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==s&&(this._unmodified=!1,this._setZoom(s),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(n){this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(n){this._tileCoverLift!==n&&(this._tileCoverLift=n)}_updateCameraOnTerrain(){const n=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,s=this.elevation&&n===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||n===Number.NEGATIVE_INFINITY&&(!s||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const p=this._elevation;s||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&p.exaggeration()&&this._centerAltitudeValidForExaggeration!==p.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*p.exaggeration(),this._centerAltitudeValidForExaggeration=p.exaggeration()):(this._centerAltitude=n||0,this._centerAltitudeValidForExaggeration=p.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const n=this._elevation,s=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let _=0,y=0;for(let w=0;w<s.length;w++){const P=new i.P(s[w][0]*this.width,p+s[w][1]*(this.height-p)),z=n.pointCoordinate(P);if(!z)continue;const k=1/Math.hypot(z[0]-this._camera.position[0],z[1]-this._camera.position[1]);_+=z[3]*k,y+=k}return y===0?NaN:_/y}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const n=this._seaLevelZoom,s=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*s,_=this._mercatorZfromZoom(n),y=this._mercatorZfromZoom(this._maxZoom),w=Math.max(_-p,y);this._setZoom(this._zoomFromMercatorZ(w))}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}computeZoomRelativeTo(n){const s=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,n.toAltitude()));let p;p=n.z<this._camera.position[2]?[s.x,s.y,s.z]:[n.x,n.y,n.z];const _=i.aa.vec3.length(i.aa.vec3.sub([],this._camera.position,p));return i.av(this._zoomFromMercatorZ(_),this._minZoom,this._maxZoom)}setFreeCameraOptions(n){if(!this.height||!n.position&&!n.orientation)return;this._updateCameraState();let s=!1;if(n.orientation&&!i.aa.quat.exactEquals(n.orientation,this._camera.orientation)&&(s=this._setCameraOrientation(n.orientation)),n.position){const p=[n.position.x,n.position.y,n.position.z];i.aa.vec3.exactEquals(p,this._camera.position)||(this._setCameraPosition(p),s=!0)}s&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const n=this._camera.position,s=new kc;return s.position=new i.a9(n[0],n[1],n[2]),s.orientation=this._camera.orientation,s._elevation=this.elevation,s._renderWorldCopies=this.renderWorldCopies,s}_setCameraOrientation(n){if(!i.aa.quat.length(n))return!1;i.aa.quat.normalize(n,n);const s=i.aa.vec3.transformQuat([],[0,0,-1],n),p=i.aa.vec3.transformQuat([],[0,-1,0],n);if(p[2]<0)return!1;const _=Lc(s,p);return!!_&&(this._camera.orientation=_,!0)}_setCameraPosition(n){const s=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,_=this.cameraToCenterDistance;n[2]=i.av(n[2],_/p,_/s),this._camera.position=n}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,s,p){this._unmodified=!1,this._edgeInsets.interpolate(n,s,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const s=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,s)}getVisibleUnwrappedCoordinates(n){const s=[new i.bP(0,n)];if(this.renderWorldCopies){const p=this.pointCoordinate(new i.P(0,0)),_=this.pointCoordinate(new i.P(this.width,0)),y=this.pointCoordinate(new i.P(this.width,this.height)),w=this.pointCoordinate(new i.P(0,this.height)),P=Math.floor(Math.min(p.x,_.x,y.x,w.x)),z=Math.floor(Math.max(p.x,_.x,y.x,w.x)),k=1;for(let D=P-k;D<=z+k;D++)D!==0&&s.push(new i.bP(D,n))}return s}isLODDisabled(n){return(!n||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(n,s,p){let _=[];const y=p!==void 0,w=!y;if(w&&this.zoom<s||y&&p[0]===0&&p[1]===0)return _;const P=new Set,z=(D,j,B,G,Q)=>{const J=i.c4(j,D,B,G,Q);P.has(J)||(_.push(new i.aF(D,j,B,G,Q)),P.add(J))};for(let D=0;D<n.length;D++){const j=n[D];if(w&&j.canonical.z!==s)continue;const B=j.canonical,G=j.overscaledZ,Q=j.wrap,J=1<<B.z,ie=B.x+1<J,oe=B.x>0,me=B.y+1<J,Se=B.y>0,be=j.wrap-(oe?0:1),Pe=j.wrap+(ie?0:1),Me=oe?B.x-1:J-1,Ie=ie?B.x+1:0;if(y)p[0]<0?(z(G,Pe,B.z,Ie,B.y),p[1]<0&&me&&(z(G,Q,B.z,B.x,B.y+1),z(G,Pe,B.z,Ie,B.y+1)),p[1]>0&&Se&&(z(G,Q,B.z,B.x,B.y-1),z(G,Pe,B.z,Ie,B.y-1))):p[0]>0?(z(G,be,B.z,Me,B.y),p[1]<0&&me&&(z(G,Q,B.z,B.x,B.y+1),z(G,be,B.z,Me,B.y+1)),p[1]>0&&Se&&(z(G,Q,B.z,B.x,B.y-1),z(G,be,B.z,Me,B.y-1))):p[1]<0&&me?z(G,Q,B.z,B.x,B.y+1):Se&&z(G,Q,B.z,B.x,B.y-1);else{const Ce=j.visibleQuadrants;1&Ce&&(z(G,be,B.z,Me,B.y),Se&&(z(G,Q,B.z,B.x,B.y-1),z(G,be,B.z,Me,B.y-1))),2&Ce&&(z(G,Pe,B.z,Ie,B.y),Se&&(z(G,Q,B.z,B.x,B.y-1),z(G,Pe,B.z,Ie,B.y-1))),4&Ce&&(z(G,be,B.z,Me,B.y),me&&(z(G,Q,B.z,B.x,B.y+1),z(G,be,B.z,Me,B.y+1))),8&Ce&&(z(G,Pe,B.z,Ie,B.y),me&&(z(G,Q,B.z,B.x,B.y+1),z(G,Pe,B.z,Ie,B.y+1)))}}const k=[];for(const D of _)_.some(j=>D.isChildOf(j))||k.push(D);if(_=k.filter(D=>!n.some(j=>!!(D.overscaledZ<s&&j.isChildOf(D))||D.equals(j)||D.isChildOf(j))),w){const D=1<<s,j=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),B=[D*j.x,D*j.y],G=4,Q=G*G;_=_.filter(J=>{const ie=J.canonical.x+.5-B[0],oe=J.canonical.y+.5-B[1];return ie*ie+oe*oe<Q})}return _}coveringTiles(n){let s=this.coveringZoomLevel(n);const p=s,_=this.elevation&&this.elevation.exaggeration(),y=_&&!n.isTerrainDEM,w=this.projection.name==="mercator";if(n.minzoom!==void 0&&s<n.minzoom)return[];n.maxzoom!==void 0&&s>n.maxzoom&&(s=n.maxzoom);const P=this.locationCoordinate(this.center),z=this.center.lat,k=1<<s,D=[k*P.x,k*P.y,0],j=this.projection.name==="globe",B=!j,G=i.bQ.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,s,B),Q=j?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),J=k*i.bG(1,this.center.lat),ie=this._camera.position[2]/i.bG(1,this.center.lat),oe=[k*Q.x,k*Q.y,ie*(B?1:J)],me=j||_,Se=this.cameraToCenterDistance/n.tileSize*(n.roundZoom?1:.502),be=this.isLODDisabled(!0)?s:0;let Pe;if(this._elevation&&n.isTerrainDEM)Pe=1e4*this._elevation.exaggeration();else if(this._elevation){const et=this._elevation.getMinMaxForVisibleTiles();Pe=et?et.max:this._centerAltitude}else Pe=this._centerAltitude;const Me=n.isTerrainDEM?-Pe:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ie=this.projection.isReprojectedInTileSpace?i.bR(this):1,Ce=et=>{const st=new i.a9(et.x+25e-6,et.y,et.z),Rt=new i.a9(et.x,et.y+25e-6,et.z),bt=et.toLngLat(),gt=st.toLngLat(),jt=Rt.toLngLat(),Vt=this.locationCoordinate(bt),Bt=this.locationCoordinate(gt),Zt=this.locationCoordinate(jt),wr=Math.hypot(Bt.x-Vt.x,Bt.y-Vt.y),lr=Math.hypot(Zt.x-Vt.x,Zt.y-Vt.y);return Math.sqrt(wr*lr)*Ie/25e-6},De=et=>{const xt=Pe,st=Me;return{aabb:i.bU(this,k,0,0,0,et,st,xt,this.projection),zoom:0,x:0,y:0,minZ:st,maxZ:xt,wrap:et,fullyVisible:!1}},$e=[];let at=[];const rt=s,je=n.reparseOverscaled?p:s,qe=(ie-this._centerAltitude)*J,mt=et=>{if(!this._elevation||!et.tileID||!w)return;const xt=this._elevation.getMinMaxForTile(et.tileID),st=et.aabb;xt?(st.min[2]=xt.min,st.max[2]=xt.max,st.center[2]=(st.min[2]+st.max[2])/2):(et.shouldSplit=Lt(et),et.shouldSplit||(st.min[2]=st.max[2]=st.center[2]=this._centerAltitude))},Tt=(et,xt)=>{if(.707*xt<et)return 1;const st=xt/et;return st/(1.4144271570014144+(Math.pow(1.1,st-1.4144271570014144+1)-1)/(1.1-1)-1)},Lt=et=>{if(et.zoom<be)return!0;if(et.zoom===rt)return!1;if(et.shouldSplit!=null)return et.shouldSplit;const xt=et.aabb.distanceX(oe),st=et.aabb.distanceY(oe);let Rt=qe,bt=1;if(j){Rt=et.aabb.distanceZ(oe);const lr=Math.pow(2,et.zoom),sr=i.aR((et.y+1)/lr),Er=i.aR(et.y/lr),Jr=Math.min(Math.max(z,sr),Er),Or=i.c8(Jr)/i.c8(z);if(bt=Jr===z?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Or/this._mercatorScaleRatio),this.zoom<=i.c5&&et.zoom===rt-1&&Or>=.9)return!0}else if(y&&(Rt=et.aabb.distanceZ(oe)*J),this.projection.isReprojectedInTileSpace&&p<=5){const lr=Math.pow(2,et.zoom),sr=Ce(new i.a9((et.x+.5)/lr,(et.y+.5)/lr));bt=sr>.85?1:sr}if(!w){const lr=Math.sqrt(xt*xt+st*st+Rt*Rt);let sr=(1<<rt-et.zoom)*Se*bt;return sr*=Tt(Math.max(Rt,qe),lr),lr<sr}let gt=Number.MAX_VALUE,jt=0;const Vt=et.aabb.getCorners(),Bt=[];for(const lr of Vt){i.aa.vec3.sub(Bt,lr,oe),j||(y?Bt[2]*=J:Bt[2]=qe);const sr=i.aa.vec3.dot(Bt,this._camera.forward());sr<gt&&(gt=sr,jt=Math.abs(Bt[2]))}let Zt=(1<<rt-et.zoom)*Se*bt;if(Zt*=Tt(Math.max(jt,qe),gt),gt<Zt)return!0;const wr=et.aabb.closestPoint(D);return wr[0]===D[0]&&wr[1]===D[1]};if(this.renderWorldCopies)for(let et=1;et<=3;et++)$e.push(De(-et)),$e.push(De(et));for($e.push(De(0));$e.length>0;){const et=$e.pop(),xt=et.x,st=et.y;let Rt=et.fullyVisible;const bt=()=>this.projection.name==="globe"&&(et.y===0||et.y===(1<<et.zoom)-1);if(!Rt){let gt=me?et.aabb.intersects(G):et.aabb.intersectsFlat(G);if(gt===0&&bt()){const jt=new i.bS(et.zoom,xt,st);gt=i.bT(this,k,jt,!0).intersects(G)}if(gt===0)continue;Rt=gt===2}if(et.zoom!==rt&&Lt(et))for(let gt=0;gt<4;gt++){const jt=(xt<<1)+gt%2,Vt=(st<<1)+(gt>>1),Bt={aabb:w?et.aabb.quadrant(gt):i.bU(this,k,et.zoom+1,jt,Vt,et.wrap,et.minZ,et.maxZ,this.projection),zoom:et.zoom+1,x:jt,y:Vt,wrap:et.wrap,fullyVisible:Rt,tileID:void 0,shouldSplit:void 0,minZ:et.minZ,maxZ:et.maxZ};y&&!j&&(Bt.tileID=new i.aF(et.zoom+1===rt?je:et.zoom+1,et.wrap,et.zoom+1,jt,Vt),mt(Bt)),$e.push(Bt)}else{const gt=et.zoom===rt?je:et.zoom;if(n.minzoom&&n.minzoom>gt)continue;let jt=0;if(!Rt){let wr=me?et.aabb.intersectsPrecise(G):et.aabb.intersectsPreciseFlat(G);if(wr===0&&bt()){const lr=new i.bS(et.zoom,xt,st);wr=i.bT(this,k,lr,!0).intersectsPrecise(G)}if(wr===0)continue;if(n.calculateQuadrantVisibility)if(G.containsPoint(et.aabb.center))jt=15;else for(let lr=0;lr<4;lr++)et.aabb.quadrant(lr).intersects(G)!==0&&(jt|=1<<lr)}const Vt=D[0]-(.5+xt+(et.wrap<<et.zoom))*(1<<s-et.zoom),Bt=D[1]-.5-st,Zt=et.tileID?et.tileID:new i.aF(gt,et.wrap,et.zoom,xt,st);n.calculateQuadrantVisibility&&(Zt.visibleQuadrants=jt),at.push({tileID:Zt,distanceSq:Vt*Vt+Bt*Bt})}}if(this.fogCullDistSq){const et=this.fogCullDistSq,xt=this.horizonLineFromTop();at=at.filter(st=>{const Rt=[0,0,0,1],bt=[i.af,i.af,0,1],gt=this.calculateFogTileMatrix(st.tileID.toUnwrapped());i.aa.vec4.transformMat4(Rt,Rt,gt),i.aa.vec4.transformMat4(bt,bt,gt);const jt=i.aa.vec4.min([],Rt,bt),Vt=i.aa.vec4.max([],Rt,bt),Bt=i.bV(jt,Vt);if(Bt===0)return!0;let Zt=!1;const wr=this._elevation;if(wr&&Bt>et&&xt!==0){const lr=this.calculateProjMatrix(st.tileID.toUnwrapped());let sr;n.isTerrainDEM||(sr=wr.getMinMaxForTile(st.tileID)),sr||(sr={min:Me,max:Pe});const Er=i.c6(this.rotation),Jr=[Er[0]*i.af,Er[1]*i.af,sr.max];i.aa.vec3.transformMat4(Jr,Jr,lr),Zt=(1-Jr[1])*this.height*.5<xt}return Bt<et||Zt})}return at.sort((et,xt)=>et.distanceSq-xt.distanceSq).map(et=>et.tileID)}resize(n,s){this.width=n,this.height=s,this.pixelsToGLUnits=[2/n,-2/s],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const s=i.av(n.lat,-i.bW,i.bW),p=this.projection.project(n.lng,s);return new i.P(p.x*this.worldSize,p.y*this.worldSize)}unproject(n){return this.projection.unproject(n.x/this.worldSize,n.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/i.bG(1,this.center.lat)/this.worldSize}setLocationAtPoint(n,s){let p,_;const y=this.centerPoint;if(this.projection.name==="globe"){const P=this.worldSize;p=(s.x-y.x)/P,_=(s.y-y.y)/P}else{const P=this.pointCoordinate(s),z=this.pointCoordinate(y);p=P.x-z.x,_=P.y-z.y}const w=this.locationCoordinate(n);this.setLocation(new i.a9(w.x-p,w.y-_))}setLocation(n){this.center=this.coordinateLocation(n),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(n){return this.projection.locationPoint(this,n)}locationPoint3D(n){return this.projection.locationPoint(this,n,!0)}pointLocation(n){return this.coordinateLocation(this.pointCoordinate(n))}pointLocation3D(n){return this.coordinateLocation(this.pointCoordinate3D(n))}locationCoordinate(n,s){const p=s?i.bG(s,n.lat):void 0,_=this.projection.project(n.lng,n.lat);return new i.a9(_.x,_.y,p)}coordinateLocation(n){return this.projection.unproject(n.x,n.y)}pointRayIntersection(n,s){const p=s??this._centerAltitude,_=[n.x,n.y,0,1],y=[n.x,n.y,1,1];i.aa.vec4.transformMat4(_,_,this.pixelMatrixInverse),i.aa.vec4.transformMat4(y,y,this.pixelMatrixInverse);const w=y[3];i.aa.vec4.scale(_,_,1/_[3]),i.aa.vec4.scale(y,y,1/w);const P=_[2],z=y[2];return{p0:_,p1:y,t:P===z?0:(p-P)/(z-P)}}screenPointToMercatorRay(n){const s=[n.x,n.y,0,1],p=[n.x,n.y,1,1];return i.aa.vec4.transformMat4(s,s,this.pixelMatrixInverse),i.aa.vec4.transformMat4(p,p,this.pixelMatrixInverse),i.aa.vec4.scale(s,s,1/s[3]),i.aa.vec4.scale(p,p,1/p[3]),s[2]=i.bG(s[2],this._center.lat)*this.worldSize,p[2]=i.bG(p[2],this._center.lat)*this.worldSize,i.aa.vec4.scale(s,s,1/this.worldSize),i.aa.vec4.scale(p,p,1/this.worldSize),new i.ap([s[0],s[1],s[2]],i.aa.vec3.normalize([],i.aa.vec3.sub([],p,s)))}rayIntersectionCoordinate(n){const{p0:s,p1:p,t:_}=n,y=i.bG(s[2],this._center.lat),w=i.bG(p[2],this._center.lat);return new i.a9(i.ae(s[0],p[0],_)/this.worldSize,i.ae(s[1],p[1],_)/this.worldSize,i.ae(y,w,_))}pointCoordinate(n,s=this._centerAltitude){return this.projection.pointCoordinate(this,n.x,n.y,s)}pointCoordinate3D(n){if(!this.elevation)return this.pointCoordinate(n);let s=this.projection.pointCoordinate3D(this,n.x,n.y);if(s)return new i.a9(s[0],s[1],s[2]);let p=0,_=this.horizonLineFromTop();if(n.y>_)return this.pointCoordinate(n);const y=.02*_,w=n.clone();for(let P=0;P<10&&_-p>y;P++){w.y=i.ae(p,_,.66);const z=this.projection.pointCoordinate3D(this,w.x,w.y);z?(_=w.y,s=z):p=w.y}return s?new i.a9(s[0],s[1],s[2]):this.pointCoordinate(n)}isPointAboveHorizon(n){return this.projection.isPointAboveHorizon(this,n)}isPointOnSurface(n){if(n.y<0||n.y>this.height||n.x<0||n.x>this.width)return!1;if(this.elevation||this.zoom>=i.bX)return!this.isPointAboveHorizon(n);const s=this.pointCoordinate(n);return s.y>=0&&s.y<=1}_coordinatePoint(n,s){const p=s&&this.elevation?this.elevation.getAtPointOrZero(n,this._centerAltitude):this._centerAltitude,_=[n.x*this.worldSize,n.y*this.worldSize,p+n.toAltitude(),1];return i.aa.vec4.transformMat4(_,_,this.pixelMatrix),_[3]>0?new i.P(_[0]/_[3],_[1]/_[3]):new i.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:n,left:s}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,_=this.width-this._edgeInsets.right,y=this.pointLocation3D(new i.P(s,n)),w=this.pointLocation3D(new i.P(_,n)),P=this.pointLocation3D(new i.P(_,p)),z=this.pointLocation3D(new i.P(s,p));let k=Math.min(y.lng,w.lng,P.lng,z.lng),D=Math.max(y.lng,w.lng,P.lng,z.lng),j=Math.min(y.lat,w.lat,P.lat,z.lat),B=Math.max(y.lat,w.lat,P.lat,z.lat);const G=Math.pow(2,-this.zoom)/16*270,Q=this.projection.name==="globe"?1:4,J=(ie,oe,me,Se,be)=>{const Pe=(ie+me)/2,Me=(oe+Se)/2,Ie=new i.P(Pe,Me),{lng:Ce,lat:De}=this.pointLocation3D(Ie),$e=Math.max(0,k-Ce,j-De,Ce-D,De-B);k=Math.min(k,Ce),D=Math.max(D,Ce),j=Math.min(j,De),B=Math.max(B,De),(be<Q||$e>G)&&(J(ie,oe,Pe,Me,be+1),J(Pe,Me,me,Se,be+1))};if(J(s,n,_,n,1),J(_,n,_,p,1),J(_,p,s,p,1),J(s,p,s,n,1),this.projection.name==="globe"){const[ie,oe]=i.bY(this);ie?(B=90,D=180,k=-180):oe&&(j=-90,D=180,k=-180)}return new i.ay(new i.bN(k,j),new i.bN(D,B))}_getBoundsRectangular(n,s){const{top:p,left:_}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,P=new i.P(_,p),z=new i.P(w,p),k=new i.P(w,y),D=new i.P(_,y);let j=this.pointCoordinate(P,n),B=this.pointCoordinate(z,n);const G=this.pointCoordinate(k,s),Q=this.pointCoordinate(D,s),J=(ie,oe)=>(oe.y-ie.y)/(oe.x-ie.x);return j.y>1&&B.y>=0?j=new i.a9((1-Q.y)/J(Q,j)+Q.x,1):j.y<0&&B.y<=1&&(j=new i.a9(-Q.y/J(Q,j)+Q.x,0)),B.y>1&&j.y>=0?B=new i.a9((1-G.y)/J(G,B)+G.x,1):B.y<0&&j.y<=1&&(B=new i.a9(-G.y/J(G,B)+G.x,0)),new i.ay().extend(this.coordinateLocation(j)).extend(this.coordinateLocation(B)).extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(G))}_getBoundsRectangularTerrain(){const n=this.elevation;if(!n.visibleDemTiles.length||n.isUsingMockSource())return this._getBoundsRectangular(0,0);const s=n.visibleDemTiles.reduce((p,_)=>{if(_.dem){const y=_.dem.tree;p.min=Math.min(p.min,y.minimums[0]),p.max=Math.max(p.max,y.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(s.min*n.exaggeration(),s.max*n.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(n=!0){const s=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,p=this.height/2-s*(1-this._horizonShift);return n?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(n){this.maxBounds=n,this.minLat=-i.bW,this.maxLat=i.bW,this.minLng=-180,this.maxLng=180,n&&(this.minLat=n.getSouth(),this.maxLat=n.getNorth(),this.minLng=n.getWest(),this.maxLng=n.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=i.as(this.minLng)*this.tileSize,this.worldMaxX=i.as(this.maxLng)*this.tileSize,this.worldMinY=i.az(this.maxLat)*this.tileSize,this.worldMaxY=i.az(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(n,s){return this.projection.createTileMatrix(this,s,n)}calculateDistanceTileData(n){const s=n.key,p=this._distanceTileDataCache;if(p[s])return p[s];const _=n.canonical,y=1/this.height,w=this.cameraWorldSize,P=w/this.zoomScale(_.z),z=(_.x+Math.pow(2,_.z)*n.wrap)*P,k=_.y*P,D=this.point;D.x*=w/this.worldSize,D.y*=w/this.worldSize;const j=this.angle,B=Math.sin(-j),G=-Math.cos(-j);return p[s]={bearing:[B,G],center:[(D.x-z)*y,(D.y-k)*y],scale:P/i.af*y},p[s]}calculateFogTileMatrix(n){const s=n.key,p=this._fogTileMatrixCache;if(p[s])return p[s];const _=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,n);return i.aa.mat4.multiply(_,this.worldToFogMatrix,_),p[s]=new Float32Array(_),p[s]}calculateProjMatrix(n,s=!1,p=!1){const _=n.key;let y;if(y=p?this._expandedProjMatrixCache:s?this._alignedProjMatrixCache:this._projMatrixCache,y[_])return y[_];const w=this.calculatePosMatrix(n,this.worldSize);let P;return P=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:p?this.expandedFarZProjMatrix:s?this.alignedProjMatrix:this.projMatrix,i.aa.mat4.multiply(w,P,w),y[_]=new Float32Array(w),y[_]}calculatePixelsToTileUnitsMatrix(n){const s=n.tileID.key,p=this._pixelsToTileUnitsCache;if(p[s])return p[s];const _=i.bZ(n,this);return p[s]=_,p[s]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const n=1/this.worldSize,s=i.aa.mat4.fromScaling([],[n,n,n]);return i.aa.mat4.multiply(s,s,this.globeMatrix),s}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const n=this._elevation;this._updateCameraState();const s=i.bG(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(s),_=this._camera.forward(),y=i.bG(1,this._center.lat);p[2]/=y,_[2]/=y,i.aa.vec3.normalize(_,_);const w=n.raycast(p,_,n.exaggeration());if(w){const P=i.aa.vec3.scaleAndAdd([],p,_,w),z=new i.a9(P[0],P[1],i.bG(P[2],i.aR(P[1]))),k=(z.z+i.aa.vec3.length([z.x-p[0],z.y-p[1],z.z-p[2]*y]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(k),this._centerAltitude=z.toAltitude(),this._center=this.coordinateLocation(z),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(n=!1){if(!this._elevation)return;const s=this._elevation,p=i.bG(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(p),y=s.getAtPointOrZero(new i.a9(..._)),w=this.pixelsPerMeter/this.worldSize*y,P=this._minimumHeightOverTerrain(),z=_[2]-w;if(z<=P)if(z<0||n){const k=this.locationCoordinate(this._center,this._centerAltitude),D=[_[0],_[1],k.z-_[2]],j=i.aa.vec3.length(D);D[2]-=(P-z)/this._pixelsPerMercatorPixel;const B=i.aa.vec3.length(D);if(B===0)return;i.aa.vec3.scale(D,D,j/B*this._pixelsPerMercatorPixel),this._camera.position=[_[0],_[1],k.z*this._pixelsPerMercatorPixel-D[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||n){const B=this.center;return B.lat=i.av(B.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!n)&&(B.lng=i.av(B.lng,this.minLng,this.maxLng)),this.center=B,void(this._constraining=!1)}const s=this._unmodified,{x:p,y:_}=this.point;let y=0,w=p,P=_;const z=this.width/2,k=this.height/2,D=this.worldMinY*this.scale,j=this.worldMaxY*this.scale;if(_-k<D&&(P=D+k),_+k>j&&(P=j-k),j-D<this.height&&(y=Math.max(y,this.height/(j-D)),P=(j+D)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const B=this.worldMinX*this.scale,G=this.worldMaxX*this.scale,Q=this.worldSize/2-(B+G)/2;w=(p+Q+this.worldSize)%this.worldSize-Q,w-z<B&&(w=B+z),w+z>G&&(w=G-z),G-B<this.width&&(y=Math.max(y,this.width/(G-B)),w=(G+B)/2)}w===p&&P===_||(this.center=this.unproject(new i.P(w,P))),y&&(this.zoom+=this.scaleZoom(y)),this._constrainCamera(),this._unmodified=s,this._constraining=!1}_minZoomForBounds(){let n=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(n=Math.max(n,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),n}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,s=this.projection.name==="globe",p=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=i.bG(1,this.center.lat)/i.bG(1,i.c7));const _=i.b_(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,_),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const y=this.projection.zAxisUnit==="meters"?p:1,w=this._camera.getWorldToCamera(this.worldSize,y);let P;const z=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(z[8]=2*-n.x/this.width,z[9]=2*n.y/this.height,this.isOrthographic){let De=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),$e=De*this.aspect,at=-$e,rt=-De;$e-=n.x,at-=n.x,De+=n.y,rt+=n.y,P=this._camera.getCameraToClipOrthographic(at,$e,rt,De,this._nearZ,this._farZ),((je,qe,mt,Tt)=>{for(let Lt=0;Lt<16;Lt++)je[Lt]=Sd(qe[Lt],mt[Lt],Tt)})(P,P,z,Nt(this.pitch>=15?1:this.pitch/15))}else P=z;const k=i.aa.mat4.mul([],z,w);let D=i.aa.mat4.mul([],P,w);if(this.projection.isReprojectedInTileSpace){const De=this.locationCoordinate(this.center),$e=i.aa.mat4.identity([]);i.aa.mat4.translate($e,$e,[De.x*this.worldSize,De.y*this.worldSize,0]),i.aa.mat4.multiply($e,$e,i.b$(this)),i.aa.mat4.translate($e,$e,[-De.x*this.worldSize,-De.y*this.worldSize,0]),i.aa.mat4.multiply(D,D,$e),i.aa.mat4.multiply(k,k,$e),this.inverseAdjustmentMatrix=i.c0(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=i.aa.mat4.scale([],D,[this.worldSize,this.worldSize,this.worldSize/y,1]),this.projMatrix=D,this.invProjMatrix=i.aa.mat4.invert(new Float64Array(16),this.projMatrix),s){const De=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);De[8]=2*-n.x/this.width,De[9]=2*n.y/this.height,this.expandedFarZProjMatrix=i.aa.mat4.mul([],De,w)}else this.expandedFarZProjMatrix=this.projMatrix;const j=i.aa.mat4.invert([],P);this.frustumCorners=i.c1.fromInvProjectionMatrix(j,this.horizonLineFromTop(),this.height),this.cameraFrustum=i.bQ.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!s);const B=new Float32Array(16);i.aa.mat4.identity(B),i.aa.mat4.scale(B,B,[1,-1,1]),i.aa.mat4.rotateX(B,B,this._pitch),i.aa.mat4.rotateZ(B,B,this.angle);const G=i.aa.mat4.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=i.aa.mat4.clone(G);const Q=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;G[8]=2*-n.x/this.width,G[9]=2*(n.y+Q)/this.height,this.skyboxMatrix=i.aa.mat4.multiply(B,G,B);const J=this.point,ie=J.x,oe=J.y,me=this.width%2/2,Se=this.height%2/2,be=Math.cos(this.angle),Pe=Math.sin(this.angle),Me=ie-Math.round(ie)+be*me+Pe*Se,Ie=oe-Math.round(oe)+be*Se+Pe*me,Ce=new Float64Array(D);if(i.aa.mat4.translate(Ce,Ce,[Me>.5?Me-1:Me,Ie>.5?Ie-1:Ie,0]),this.alignedProjMatrix=Ce,D=i.aa.mat4.create(),i.aa.mat4.scale(D,D,[this.width/2,-this.height/2,1]),i.aa.mat4.translate(D,D,[1,-1,0]),this.labelPlaneMatrix=D,D=i.aa.mat4.create(),i.aa.mat4.scale(D,D,[1,-1,1]),i.aa.mat4.translate(D,D,[-1,-1,0]),i.aa.mat4.scale(D,D,[2/this.width,2/this.height,1]),this.glCoordMatrix=D,this.pixelMatrix=i.aa.mat4.multiply(new Float64Array(16),this.labelPlaneMatrix,k),this._calcFogMatrices(),this._distanceTileDataCache={},D=i.aa.mat4.invert(new Float64Array(16),this.pixelMatrix),!D)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=D,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=i.c2(this);const De=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=i.aa.vec3.transformMat4(De,De,w),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=D;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const n=this.cameraWorldSizeForFog,s=this.cameraPixelsPerMeter,p=this._camera.position,_=1/this.height/this._pixelsPerMercatorPixel,y=[n,n,s];i.aa.vec3.scale(y,y,_),i.aa.vec3.scale(p,p,-1),i.aa.vec3.multiply(p,p,y);const w=i.aa.mat4.create();i.aa.mat4.translate(w,w,p),i.aa.mat4.scale(w,w,y),this.mercatorFogMatrix=w,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(n,s,_)}_computeCameraPosition(n){const s=(n=n||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),_=this.point,y=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*s-n/this.worldSize*this._centerAltitude;return[_.x/this.worldSize-p[0]*y,_.y/this.worldSize-p[1]*y,n/this.worldSize*this._centerAltitude-p[2]*y]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(n){const s=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],_=n[2];let y=1;this.projection.wrap&&(this.center=this.center.wrap()),_>0&&(y=Math.min((s-p)/_,1)),this._camera.position=i.aa.vec3.scaleAndAdd([],this._camera.position,n,y),this._updateStateFromCamera()}_updateStateFromCamera(){const n=this._camera.position,s=this._camera.forward(),{pitch:p,bearing:_}=this._camera.getPitchBearing(),y=i.bG(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,w=this._mercatorZfromZoom(this._maxZoom)*Math.cos(i.ah(this._maxPitch)),P=Math.max((n[2]-y)/Math.cos(p),w),z=this._zoomFromMercatorZ(P);i.aa.vec3.scaleAndAdd(n,n,s,P),this._pitch=i.av(p,i.ah(this.minPitch),i.ah(this.maxPitch)),this.angle=i.bE(_,-Math.PI,Math.PI),this._setZoom(i.av(z,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new i.a9(n[0],n[1],n[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(n){return Math.pow(2,n)*this.tileSize}_mercatorZfromZoom(n){return this.cameraToCenterDistance/this._worldSizeFromZoom(n)}_minimumHeightOverTerrain(){const n=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(n)}_zoomFromMercatorZ(n){return this.scaleZoom(this.cameraToCenterDistance/(n*this.tileSize))}zoomFromMercatorZAdjusted(n){let s=0,p=i.bX,_=0,y=1/0;for(;p-s>1e-6&&p>s;){const w=s+.5*(p-s),P=this.tileSize*Math.pow(2,w),z=this.getCameraToCenterDistance(this.projection,w,P),k=this.scaleZoom(z/(n*this.tileSize)),D=Math.abs(w-k);D<y&&(y=D,_=w),w<k?s=w:p=w}return _}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(i.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(n,s){const p=Math.min(n.x,s.x),_=Math.max(n.x,s.x),y=Math.min(n.y,s.y),w=Math.max(n.y,s.y);if(y<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const P=[new i.P(p,y),new i.P(_,w),new i.P(p,w),new i.P(_,y)],z=this.renderWorldCopies?-3:0,k=this.renderWorldCopies?4:1;for(const D of P){const j=this.pointRayIntersection(D);if(j.t<0)return!0;const B=this.rayIntersectionCoordinate(j);if(B.x<z||B.y<0||B.x>k||B.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+i.c3(this.fovAboveCenter)>88||this.anyCornerOffEdge(new i.P(0,0),new i.P(this.width,this.height))}zoomDeltaToMovement(n,s){const p=i.aa.vec3.length(i.aa.vec3.sub([],this._camera.position,n)),_=this._zoomFromMercatorZ(p)+s;return p-this._mercatorZfromZoom(_)}getCameraPoint(){if(this.projection.name==="globe"){const n=function([s,p,_],y){const w=[s,p,_,1];i.aa.vec4.transformMat4(w,w,y);const P=w[3]=Math.max(w[3],1e-6);return w[0]/=P,w[1]/=P,w[2]/=P,w}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new i.P(n[0],n[1])}{const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new i.P(0,n))}}getCameraToCenterDistance(n,s=this.zoom,p=this.worldSize){const _=i.b_(n,s,this.width,this.height,1024),y=n.pixelSpaceConversion(this.center.lat,p,_);let w=.5/Math.tan(.5*this._fov)*this.height*y;return this.isOrthographic&&(w=Sd(1,w,Nt(this.pitch>=15?1:this.pitch/15))),w}getWorldToCameraMatrix(){const n=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&i.aa.mat4.multiply(n,n,this.globeMatrix),n}getFrustum(n){return i.bQ.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,n,this.projection.zAxisUnit==="meters")}}const Fs=(f,n)=>{if(n>0&&f.terrain&&i.w("Cutoff is currently disabled on terrain"),n<=0||f.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const s=f.transform,p=Math.max(Math.abs(s._zoom-(f.minCutoffZoom-1)),1),_=s.isLODDisabled(!1)?i.ab(60,45,s.pitch):i.ab(30,15,s.pitch),y=s._farZ-s._nearZ,w=n*s.height,P=((1-(z=_))*s.cameraToCenterDistance+z*(s._farZ+w))*p;var z;return{shouldRenderCutoff:_<1,uniformValues:{u_cutoff_params:[s._nearZ,s._farZ,(P-s._nearZ)/y,(P-w-s._nearZ)/y]}}},ro={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class e0{constructor(n,s){this.aabb=n,this.lastCascade=s}}class Td{add(n,s){const p=this.receivers[n.key];p!==void 0?(p.aabb.min[0]=Math.min(p.aabb.min[0],s.min[0]),p.aabb.min[1]=Math.min(p.aabb.min[1],s.min[1]),p.aabb.min[2]=Math.min(p.aabb.min[2],s.min[2]),p.aabb.max[0]=Math.max(p.aabb.max[0],s.max[0]),p.aabb.max[1]=Math.max(p.aabb.max[1],s.max[1]),p.aabb.max[2]=Math.max(p.aabb.max[2],s.max[2])):this.receivers[n.key]=new e0(s,null)}clear(){this.receivers={}}get(n){return this.receivers[n.key]}computeRequiredCascades(n,s,p){const _=i.cc.fromPoints(n.points);let y=0;for(const w in this.receivers){const P=this.receivers[w];if(!P||!_.intersectsAabb(P.aabb))continue;P.aabb.min=_.closestPoint(P.aabb.min),P.aabb.max=_.closestPoint(P.aabb.max);const z=P.aabb.getCorners();for(let k=0;k<p.length;k++){let D=!0;for(const j of z){const B=[j[0]*s,j[1]*s,j[2]];if(i.aa.vec3.transformMat4(B,B,p[k].matrix),B[0]<-1||B[0]>1||B[1]<-1||B[1]>1){D=!1;break}}if(P.lastCascade=k,y=Math.max(y,k),D)break}}return y+1}}class Bs{constructor(n){this.painter=n,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new Td,this._depthMode=new ir(n.context.gl.LEQUAL,ir.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,n.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),n.tp.registerParameter(ro,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),n.tp.registerParameter(ro,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),n.tp.registerParameter(ro,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),n.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const n of this._cascades)n.texture.destroy(),n.framebuffer.destroy();this._cascades=[]}updateShadowParameters(n,s){const p=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!s||!s.properties)return;const _=s.properties.get("shadow-intensity");if(!s.shadowsEnabled()||_<=0||(this._shadowLayerCount=p.style.order.reduce((Q,J)=>{const ie=p.style._mergedLayers[J];return Q+(ie.hasShadowPass()&&!ie.isHidden(n.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const y=p.context,w=ro.shadowMapResolution,P=ro.shadowMapResolution;if(this._cascades.length===0||ro.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let Q=0;Q<ro.cascadeCount;++Q){const J=p._shadowMapDebug,ie=y.gl,oe=y.createFramebuffer(w,P,J,"texture"),me=new i.T(y,{width:w,height:P,data:null},ie.DEPTH_COMPONENT16);if(oe.depthAttachment.set(me.texture),J){const Se=new i.T(y,{width:w,height:P,data:null},ie.RGBA8);oe.colorAttachment.set(Se.texture)}this._cascades.push({framebuffer:oe,texture:me,matrix:[],far:0,boundingSphereRadius:0,frustum:new i.bQ,scale:0})}}this.shadowDirection=_l(s);let z=0;if(n.elevation){const Q=n.elevation,J=[1e4,-1e4];Q.visibleDemTiles.filter(ie=>ie.dem).forEach(ie=>{const oe=ie.dem.tree;J[0]=Math.min(J[0],oe.minimums[0]),J[1]=Math.max(J[1],oe.maximums[0])}),J[0]!==1e4&&(z=(J[1]-J[0])*Q.exaggeration())}const k=1.5*n.cameraToCenterDistance,D=3*k,j=new Float64Array(16);for(let Q=0;Q<this._cascades.length;++Q){const J=this._cascades[Q];let ie=n.height/50,oe=1;ro.cascadeCount===1?oe=D:Q===0?oe=k:(ie=k,oe=D);const[me,Se]=Fc(n,this.shadowDirection,ie,oe,ro.shadowMapResolution,z);J.scale=n.scale,J.matrix=me,J.boundingSphereRadius=Se,i.aa.mat4.invert(j,J.matrix),J.frustum=i.bQ.fromInvProjectionMatrix(j,1,0,!0),J.far=oe}const B=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[B].far,this._cascades[B].far],this._uniformValues.u_shadow_intensity=_,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/ro.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=ro.shadowMapResolution,this._uniformValues.u_shadowmap_0=to.ShadowMap0,this._uniformValues.u_shadowmap_1=to.ShadowMap0+1,this._groundShadowTiles=p.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const G=p.transform.elevation;for(const Q of this._groundShadowTiles){let J={min:0,max:0};if(G){const ie=G.getMinMaxForTile(Q);ie&&(J=ie)}this.addShadowReceiver(Q.toUnwrapped(),J.min,J.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(n){this._enabled=n}drawShadowPass(n,s){if(!this.enabled)return;const p=this.painter,_=p.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(p.transform.getFrustum(0),p.transform.worldSize,this._cascades),_.viewport.set([0,0,ro.shadowMapResolution,ro.shadowMapResolution]);for(let y=0;y<this._numCascadesToRender;++y){p.currentShadowCascade=y,_.bindFramebuffer.set(this._cascades[y].framebuffer.framebuffer),_.clear({color:i.ai.white,depth:1});for(const w of n.order){const P=n._mergedLayers[w];if(!P.hasShadowPass()||P.isHidden(p.transform.zoom))continue;const z=n.getLayerSourceCache(P),k=z?s[z.id]:void 0;(P.type==="model"||k&&k.length)&&p.renderLayer(p,z,P,k)}}p.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const n=this.painter,s=n.style,p=n.context,_=s.directionalLight,y=s.ambientLight;if(!_||!y)return;const w=[],P=Fs(n,n.longestCutoffRange);P.shouldRenderCutoff&&w.push("RENDER_CUTOFF"),w.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&w.push("NORMAL_OFFSET");const z=Oc(s,_,y),k=new ir(p.gl.LEQUAL,ir.ReadOnly,n.depthRangeFor3D);for(const D of this._groundShadowTiles){const j=D.toUnwrapped(),B=n.isTileAffectedByFog(D),G=n.getOrCreateProgram("groundShadow",{defines:w,overrideFog:B});this.setupShadows(j,G),n.uploadCommonUniforms(p,G,j,null,P);const Q={u_matrix:n.transform.calculateProjMatrix(j),u_ground_shadow_factor:z};G.draw(n,p.gl.TRIANGLES,k,Cr.disabled,Br.multiply,mr.disabled,Q,"ground_shadow",n.tileExtentBuffer,n.quadTriangleIndexBuffer,n.tileExtentSegments,{},n.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Br.unblended:Br.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(n){const s=this.painter.transform,p=s.calculatePosMatrix(n,s.worldSize);return i.aa.mat4.multiply(p,this._cascades[this.painter.currentShadowCascade].matrix,p),Float32Array.from(p)}calculateShadowPassMatrixFromMatrix(n){return i.aa.mat4.multiply(n,this._cascades[this.painter.currentShadowCascade].matrix,n),Float32Array.from(n)}setupShadows(n,s,p,_=0){if(!this.enabled)return;const y=this.painter.transform,w=this.painter.context,P=w.gl,z=this._uniformValues,k=new Float64Array(16),D=y.calculatePosMatrix(n,y.worldSize);for(let j=0;j<this._cascades.length;j++)i.aa.mat4.multiply(k,this._cascades[j].matrix,D),z[j===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(k),w.activeTexture.set(P.TEXTURE0+to.ShadowMap0+j),this._cascades[j].texture.bind(P.NEAREST,P.CLAMP_TO_EDGE);if(this.useNormalOffset=!!p,this.useNormalOffset){const j=i.cb(n.canonical),B=2/y.tileSize*i.af/ro.shadowMapResolution,G=B*this._cascades[0].boundingSphereRadius,Q=B*this._cascades[this._cascades.length-1].boundingSphereRadius,J=(p==="vector-tile"?1:3)/Math.pow(2,_-n.canonical.z-(1-y.zoom+Math.floor(y.zoom)));z.u_shadow_normal_offset=[j,G*J,Q*J],z.u_shadow_bias=[6e-5,.0012,.012]}else z.u_shadow_bias=[36e-5,.0012,.012];s.setShadowUniformValues(w,z)}setupShadowsFromMatrix(n,s,p=!1){if(!this.enabled)return;const _=this.painter.context,y=_.gl,w=this._uniformValues,P=new Float64Array(16);for(let z=0;z<ro.cascadeCount;z++)i.aa.mat4.multiply(P,this._cascades[z].matrix,n),w[z===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(P),_.activeTexture.set(y.TEXTURE0+to.ShadowMap0+z),this._cascades[z].texture.bind(y.NEAREST,y.CLAMP_TO_EDGE);if(this.useNormalOffset=p,p){const z=ro.normalOffset;w.u_shadow_normal_offset=[1,z,z],w.u_shadow_bias=[6e-5,.0012,.012]}else w.u_shadow_bias=[36e-5,.0012,.012];s.setShadowUniformValues(_,w)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(n,s,p,_){if(_[2]>=0)return{};const y=function(z,k,D){const j=D/(1<<z.canonical.z);return new i.cc([z.canonical.x*j+z.wrap*D,z.canonical.y*j+z.wrap*D,0],[(z.canonical.x+1)*j+z.wrap*D,(z.canonical.y+1)*j+z.wrap*D,k])}(n,s,p).getCorners(),w=s/-_[2];_[0]<0?(i.aa.vec3.add(y[0],y[0],[_[0]*w,0,0]),i.aa.vec3.add(y[3],y[3],[_[0]*w,0,0])):_[0]>0&&(i.aa.vec3.add(y[1],y[1],[_[0]*w,0,0]),i.aa.vec3.add(y[2],y[2],[_[0]*w,0,0])),_[1]<0?(i.aa.vec3.add(y[0],y[0],[0,_[1]*w,0]),i.aa.vec3.add(y[1],y[1],[0,_[1]*w,0])):_[1]>0&&(i.aa.vec3.add(y[2],y[2],[0,_[1]*w,0]),i.aa.vec3.add(y[3],y[3],[0,_[1]*w,0]));const P={};return P.vertices=y,P.planes=[Dc(y[1],y[0],y[4]),Dc(y[2],y[1],y[5]),Dc(y[3],y[2],y[6]),Dc(y[0],y[3],y[7])],P}addShadowReceiver(n,s,p){this._receivers.add(n,i.cc.fromTileIdAndHeight(n,s,p))}getMaxCascadeForTile(n){const s=this._receivers.get(n);return s&&s.lastCascade?s.lastCascade:0}}function Dc(f,n,s){const p=i.aa.vec3.sub([],s,n),_=i.aa.vec3.sub([],f,n),y=i.aa.vec3.cross([],p,_),w=i.aa.vec3.length(y);return w===0?[0,0,1,0]:(i.aa.vec3.scale(y,y,1/w),[y[0],y[1],y[2],-i.aa.vec3.dot(y,n)])}function _l(f){const n=f.properties.get("direction"),s=i.ca(n.x,n.y,n.z);s[2]=i.av(s[2],0,75);const p=i.cd([s[0],s[1],s[2]]);return i.aa.vec3.fromValues(p.x,p.y,p.z)}function Oc(f,n,s){const p=n.properties.get("color-use-theme")==="none",_=n.properties.get("color"),y=n.properties.get("intensity"),w=n.properties.get("direction"),P=[w.x,w.y,w.z],z=s.properties.get("color-use-theme")==="none",k=s.properties.get("color"),D=s.properties.get("intensity"),j=Math.max(i.aa.vec3.dot([0,0,1],P),0),B=[0,0,0];i.aa.vec3.scale(B,k.toRenderColor(z?null:f.getLut(n.scope)).toArray01Linear().slice(0,3),D);const G=[0,0,0];return i.aa.vec3.scale(G,_.toRenderColor(p?null:f.getLut(s.scope)).toArray01Linear().slice(0,3),j*y),i.ce([B[0]>0?B[0]/(B[0]+G[0]):0,B[1]>0?B[1]/(B[1]+G[1]):0,B[2]>0?B[2]/(B[2]+G[2]):0])}function Fc(f,n,s,p,_,y){const w=f.zoom,P=f.scale,z=f.worldSize,k=1/z,D=f.aspect,j=Math.sqrt(1+D*D)*Math.tan(.5*f.fovX),B=j*j,G=p-s,Q=p+s;let J,ie;B>G/Q?(J=p,ie=p*j):(J=.5*Q*(1+B),ie=.5*Math.sqrt(G*G+2*(p*p+s*s)*B+Q*Q*B*B));const oe=f.projection.pixelsPerMeter(f.center.lat,z),me=f._camera.getCameraToWorldMercator(),Se=[0,0,-J*k];i.aa.vec3.transformMat4(Se,Se,me);let be=ie*k;const Pe=f._edgeInsets;if(!(Pe.left===0&&Pe.top===0&&Pe.right===0&&Pe.bottom===0||Pe.left===Pe.right&&Pe.top===Pe.bottom)){const Rt=f._camera.getWorldToCamera(f.worldSize,f.projection.zAxisUnit==="meters"?oe:1),bt=f._camera.getCameraToClipPerspective(f._fov,f.width/f.height,s,p);bt[8]=2*-f.centerOffset.x/f.width,bt[9]=2*f.centerOffset.y/f.height;const gt=new Float64Array(16);i.aa.mat4.mul(gt,bt,Rt);const jt=new Float64Array(16);i.aa.mat4.invert(jt,gt);const Vt=i.bQ.fromInvProjectionMatrix(jt,z,w,!0);for(const Bt of Vt.points){const Zt=((Me=Bt)[0]/=P,Me[1]/=P,Me[2]=i.bG(Me[2],f._center.lat),Me);be=Math.max(be,i.aa.vec3.len(i.aa.vec3.subtract([],Se,Zt)))}}var Me;be*=_/(_-1);const Ie=Math.acos(n[2]),Ce=Math.atan2(-n[0],-n[1]),De=new eh;De.position=Se,De.setPitchBearing(Ie,Ce);const $e=De.getWorldToCamera(z,oe),at=be*z,rt=Math.min(f._mercatorZfromZoom(17)*z*-2,-2*at),je=De.getCameraToClipOrthographic(-at,at,-at,at,rt,(at+y*oe)/n[2]),qe=new Float64Array(16);i.aa.mat4.multiply(qe,je,$e);const mt=i.aa.vec3.fromValues(Math.floor(1e6*Se[0])/1e6*z,Math.floor(1e6*Se[1])/1e6*z,0),Tt=.5*_,Lt=[0,0,0];i.aa.vec3.transformMat4(Lt,mt,qe),i.aa.vec3.scale(Lt,Lt,Tt);const et=[Math.floor(Lt[0]),Math.floor(Lt[1]),Math.floor(Lt[2])],xt=[0,0,0];i.aa.vec3.sub(xt,Lt,et),i.aa.vec3.scale(xt,xt,-1/Tt);const st=new Float64Array(16);return i.aa.mat4.identity(st),i.aa.mat4.translate(st,st,xt),i.aa.mat4.multiply(qe,st,qe),[qe,at]}class Ax extends i.E{constructor(n){super(),this.requestManager=n,this.models={"":{}},this.numModelsLoading={}}loadModel(n,s){return i.aL(this.requestManager.transformRequest(s,i.R.Model).url).then(p=>{if(!p)return;const _=i.aM(p),y=new i.aN(n,void 0,void 0,_);return y.computeBoundsAndApplyParent(),y}).catch(p=>{if(p&&p.status===404)return null;this.fire(new i.y(new Error(`Could not load model ${n} from ${s}: ${p.message}`)))})}load(n,s){this.models[s]||(this.models[s]={});const p=Object.keys(n);this.numModelsLoading[s]=(this.numModelsLoading[s]||0)+p.length;const _=[];for(const y of p)_.push(this.loadModel(y,n[y]));Promise.allSettled(_).then(y=>{for(let w=0;w<y.length;w++){const{status:P,value:z}=y[w];P==="fulfilled"&&z&&(this.models[s][p[w]]={model:z,numReferences:1})}this.numModelsLoading[s]-=p.length,this.fire(new i.z("data",{dataType:"style"}))}).catch(y=>{this.fire(new i.y(new Error(`Could not load models: ${y.message}`)))})}isLoaded(){for(const n in this.numModelsLoading)if(this.numModelsLoading[n]>0)return!1;return!0}hasModel(n,s){return!!this.getModel(n,s)}getModel(n,s){return this.models[s]||(this.models[s]={}),this.models[s][n]?this.models[s][n].model:void 0}addModel(n,s,p){this.models[p]||(this.models[p]={}),this.hasModel(n,p)&&this.models[p][n].numReferences++,this.load({[n]:this.requestManager.normalizeModelURL(s)},p)}addModels(n,s){this.models[s]||(this.models[s]={});const p={};for(const _ in n)this.models[s][_]={},p[_]=this.requestManager.normalizeModelURL(n[_]);this.load(p,s)}addModelsFromBucket(n,s){this.models[s]||(this.models[s]={});const p={};for(const _ of n)this.hasModel(_,s)?this.models[s][_].numReferences++:p[_]=this.requestManager.normalizeModelURL(_);this.load(p,s)}removeModel(n,s){if(this.models[s]&&this.models[s][n]&&(this.models[s][n].numReferences--,this.models[s][n].numReferences===0)){const p=this.models[s][n].model;delete this.models[s][n],p.destroy()}}listModels(n){return this.models[n]||(this.models[n]={}),Object.keys(this.models[n])}upload(n,s){this.models[s]||(this.models[s]={});for(const p in this.models[s])this.models[s][p].model&&this.models[s][p].model.upload(n.context)}}const Rx=new i.a4({data:new i.a5(i.a2.colorTheme.data)}),$p={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function t0(f){return f=f||{},Object.assign(f,$p)}class r0 extends i.E{constructor(n){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._selectedLevel=void 0,this._floorplanStates={},i.aO(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=n,this._checkFloorplanVisible(!0),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(n=>{n.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new i.y(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=n.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=n.stylesheet.indoor.buildingFeaturesetId,this._scope=n.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:n=>(n.feature&&n.feature.properties.floorplan&&this.selectFloorplan(n.feature.properties.floorplan),!0)}),this._checkFloorplanVisible(!0)}_onMove(){this._checkFloorplanVisible(!1)}_checkFloorplanVisible(n){if(!this._queryFeatureSetId||!this._map.isStyleLoaded()||this._map.transform.zoom<13)return;this._indoorData&&!function(w,P){const[z,k]=w,{center:D,radius:j}=P,[B,G]=D,Q=Math.abs(z-B);return Math.sqrt((Q>180?360-Q:Q)**2+(k-G)**2)<=j}([this._map.getCenter().lng,this._map.getCenter().lat],this._indoorData.circumCircle)&&(this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new i.z("floorplangone")));const s={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},p=new i.P(this._map.transform.width/2,this._map.transform.height/2),_=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],y=this._map.queryRenderedFeatures(n?_:p,s);y.length>0&&(this._selectedFloorplan&&y[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=y[0],this._floorplanSelected(!1)))}_floorplanSelected(n){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._indoorData.circumCircle=function(y){const[[w,P],[z,k]]=y,D=(z-w+360)%360,j=D>180?360-D:D;return{center:[(w+j/2+360)%360,(P+k)/2],radius:Math.sqrt(j**2+(k-P)**2)/2}}(this._indoorData.extent),this._floorplanStates[this._indoorData.id]||(this._floorplanStates[this._indoorData.id]={});const s=this._floorplanStates[this._indoorData.id].selectedBuilding,p=this._floorplanStates[this._indoorData.id].selectedLevel;let _;if(this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",this._indoorData.floorplanIDs),this._selectedLevel)for(const y of this._indoorData.levels)y.id===this._selectedLevel.id&&(_=y.id);if(this.fire(new i.z("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:_})),s){const y=this._indoorData.buildings.find(w=>w.id===s);this._buildingSelected(y,!1)}else this._indoorData.buildings.length>0&&this._buildingSelected(this._indoorData.buildings[0],!1);if(p){const y=this._indoorData.levels.find(w=>w.id===p);this._updateLevels(y,n)}else n&&this._indoorData["default-levels"].length>0&&this.selectLevel(this._indoorData["default-levels"][0])}_buildingSelected(n,s){s&&n&&n.extent&&this._map.fitBounds(n.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=n?n.id:void 0;const p=this._indoorData.levels.filter(_=>n.levels.includes(_.id));this.fire(new i.z("buildingselected",{buildingId:n.id,levels:p}))}_levelSelected(n){if(n==="overview")this._updateLevels(void 0,!0);else{const s=this._indoorData.levels.find(p=>p.id===n);this._updateLevels(s,!0)}this.fire(new i.z("levelselected",{levelId:n==="overview"?void 0:n}))}_updateLevels(n,s){if(!n)return this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",[]]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._floorplanStates[this._indoorData.id].selectedLevel=void 0,void(s&&this._indoorData.extent&&this._map.fitBounds(this._indoorData.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}));function p(k){const D=k.indexOf("/floor/");if(D===-1)return k;const j=D+7,B=k.indexOf("/",j);return B===-1?k.slice(j):k.slice(j,B)}this._selectedLevel=n,this._floorplanStates[this._indoorData.id].selectedLevel=n?n.id:void 0;const _=[],y={},w={},P={},z={};for(const k of this._indoorData.levels)if(_.push(k.id),y[k.id]=k.height,w[k.id]=k.base,n){if(this.mergeFloors){const D=p(n.id),j=p(k.id);P[k.id]=j===D?"true":"false"}else P[k.id]=k.id===n.id?"true":"false";z[k.id]=k.base<n.base?"true":"false"}else z[k.id]=!0;if(this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",_]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",y]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",w]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",P]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",z]),n&&(this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!!n.isUnderground),s&&n.extent)){const k=this._map.cameraForBounds(n.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),D=this._map.getZoom(),j=k.zoom?Math.abs(D-k.zoom):0;this._map.fitBounds(n.extent,j>=1?{pitch:this._map.getPitch(),bearing:this._map.getBearing()}:{pitch:this._map.getPitch(),bearing:this._map.getBearing(),zoom:D})}}selectFloorplan(n){const s={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},p=[new i.P(0,0),new i.P(this._map.transform.width,this._map.transform.height)],_=this._map.queryRenderedFeatures(p,s);if(_.length>0){for(const y of _)if(JSON.parse(y.properties["indoor-data"]).floorplanIDs.includes(n)){this._selectedFloorplan=y,this._floorplanSelected(!0);break}}}selectBuilding(n){const s=this._indoorData.buildings.find(p=>p.id===n);this._buildingSelected(s,!0)}selectLevel(n){this._levelSelected(n)}}function n0(f){if(!f.metadata||!f.metadata.content_area)return;const{left:n,top:s,width:p,height:_}=f.metadata.content_area;return[n,s,n+p,s+_]}const Ns=(f,n)=>ze(f,n&&n.filter(s=>s.identifier!=="source.canvas")),zx=i.ax(Hr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport"]),Lx=i.ax(Hr,["setCenter","setZoom","setBearing","setPitch"]),Vp=new Set(["background","sky","slot"]),i0={version:8,layers:[],sources:{}},Up={duration:300,delay:0};class Oa extends i.E{constructor(n,s={}){super(),this.map=n,this.scope=s.scope||"",this.globalId=null,this.fragments=[],this.importDepth=s.importDepth||0,this.importsCache=s.importsCache||new Map,this.resolvedImports=s.resolvedImports||new Set,this.transition=i.l({},Up),this._buildingIndex=new gl(this),this.crossTileSymbolIndex=new Q_,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=s.styleChanges||new pn,this.dispatcher=s.dispatcher?s.dispatcher:new i.D(i.ch(),this),s.imageManager?this.imageManager=s.imageManager:(this.imageManager=new Pr(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=s.glyphManager?s.glyphManager:new i.ci(n._requestManager,s.localFontFamily?i.cj.all:s.localIdeographFontFamily?i.cj.ideographs:i.cj.none,s.localFontFamily||s.localIdeographFontFamily),s.modelManager?this.modelManager=s.modelManager:(this.modelManager=new Ax(n._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._order=[],this._markersNeedUpdate=!1,this.options=s.configOptions?s.configOptions:new Map,this._configDependentLayers=s.configDependentLayers?s.configDependentLayers:new Set,this._config=s.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:s.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=s.initialConfig,this.dispatcher.broadcast("setReferrer",i.ck());const p=this;this._rtlTextPluginCallback=Oa.registerForPluginStateChange(_=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:_.pluginStatus,pluginURL:_.pluginURL},(y,w)=>{if(i.cl(y),w&&w.every(P=>P))for(const P in p._sourceCaches){const z=p._sourceCaches[P],k=z.getSource().type;k!=="vector"&&k!=="geojson"||z.reload()}})}),this.on("data",_=>{if(_.dataType!=="source"||_.sourceDataType!=="metadata")return;const y=this.getOwnSource(_.sourceId);if(y&&y.vectorLayerIds)for(const w in this._layers){const P=this._layers[w];P.source===y.id&&this._validateLayer(P)}})}load(n){return n?(typeof n=="string"?this.loadURL(n):this.loadJSON(n),this):this}_getGlobalId(n){if(!n)return null;if(typeof n=="string"){if(i.f(n))return n;const s=i.cm(n);if(!s.startsWith("http"))try{return new URL(s,location.href).toString()}catch{return s}return s}return`json://${i.cn(JSON.stringify(n))}`}_diffStyle(n,s,p){this.globalId=this._getGlobalId(n);const _=(y,w)=>{try{w(null,this.setState(y,p))}catch(P){w(P,!1)}};if(typeof n=="string"){const y=this.map._requestManager.normalizeStyleURL(n),w=this.map._requestManager.transformRequest(y,i.R.Style);i.n(w,(P,z)=>{P?this.fire(new i.y(P)):z&&_(z,s)})}else typeof n=="object"&&_(n,s)}loadURL(n,s={}){this.fire(new i.z("dataloading",{dataType:"style"}));const p=typeof s.validate=="boolean"?s.validate:!i.f(n);this.globalId=this._getGlobalId(n),n=this.map._requestManager.normalizeStyleURL(n,s.accessToken),this.resolvedImports.add(n);const _=this.importsCache.get(n);if(_)return this._load(_,p);const y=this.map._requestManager.transformRequest(n,i.R.Style);this._request=i.n(y,(w,P)=>{if(this._request=null,w)this.fire(new i.y(w));else if(P)return this.importsCache.set(n,P),this._load(P,p)})}loadJSON(n,s={}){this.fire(new i.z("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(n),this._request=i.q.frame(()=>{this._request=null,this._load(n,s.validate!==!1)})}loadEmpty(){this.fire(new i.z("dataloading",{dataType:"style"})),this._load(i0,!1)}_loadImports(n,s,p){if(this.importDepth>=4)return i.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const _=[];for(const y of n){const w=this._createFragmentStyle(y),P=new Promise(D=>{w.once("style.import.load",D),w.once("error",D)}).then(()=>this.mergeAll());if(_.push(P),this.resolvedImports.has(y.url)){w.loadEmpty();continue}const z=y.data||this.importsCache.get(y.url);z?(w.loadJSON(z,{validate:s}),this._isInternalStyle(z)&&(w.globalId=null)):y.url?w.loadURL(y.url,{validate:s}):w.loadEmpty();const k={style:w,id:y.id,config:y.config};if(p){const D=this.fragments.findIndex(({id:j})=>j===p);this.fragments=this.fragments.slice(0,D).concat(k).concat(this.fragments.slice(D))}else this.fragments.push(k)}return Promise.allSettled(_)}getImportGlobalIds(n=this,s=new Set){for(const p of n.fragments)p.style.globalId&&s.add(p.style.globalId),this.getImportGlobalIds(p.style,s);return[...s.values()]}_createFragmentStyle(n){const s=this.scope?i.aB(n.id,this.scope):n.id;let p;const _=this._initialConfig&&this._initialConfig[s];(n.config||_)&&(p=i.l({},n.config,_));const y=new Oa(this.map,{scope:s,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:p,configOptions:this.options,colorThemeOverride:n["color-theme"],configDependentLayers:this._configDependentLayers});return y.setEventedParent(this.map,{style:y}),y}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(n){return this.isRootStyle()&&(n.fragment||!!n.schema&&n.fragment!==!1)}_load(n,s){const p=n.indoor?t0(n.schema):n.schema;if(this._isInternalStyle(n)){const w=i.l({},i0,{imports:[{id:"basemap",data:n,url:""}]});return void this._load(w,s)}if(this.updateConfig(this._config,p),s&&Ns(this,li(n)))return;this._loaded=!0,this.stylesheet=i.co(n);const _=()=>{for(const k in n.sources)this.addSource(k,n.sources[k],{validate:!1,isInitialLoad:!0});n.sprite?this._loadIconset(n.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(n.glyphs,this.scope);const w=va(this.stylesheet.layers);if(this._order=w.map(k=>k.id),this.stylesheet.light&&i.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const k=this.stylesheet.lights[0];this.light=new Ue(k.properties,k.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new Ue(this.stylesheet.light)),this._layers={};for(const k of w){const D=i.ct(k,this.scope,this._styleColorTheme.lut,this.options);D.configDependencies.size!==0&&this._configDependentLayers.add(D.fqid),D.setEventedParent(this,{layer:{id:D.id}}),this._layers[D.id]=D;const j=this.getOwnLayerSourceCache(D),B=!!this.directionalLight&&this.directionalLight.shadowsEnabled();j&&D.canCastShadows()&&B&&(j.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const P=this.stylesheet.terrain;P&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(P,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new i.z("data",{dataType:"style"}));const z=this.isRootStyle();n.imports?this._loadImports(n.imports,s).then(()=>{this._reloadImports(),this.fire(new i.z(z?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new i.z(z?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const y=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(y){const w=this._evaluateColorThemeData(y);this._loadColorTheme(w).then(()=>{_()}).catch(P=>{i.w(`Couldn't load color theme from the stylesheet: ${P}`),_()})}else this._styleColorTheme.lut=null,_()}isRootStyle(){return this.importDepth===0}mergeAll(){let n,s,p,_,y,w,P,z,k,D;const j={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(B=>{if(B.stylesheet){if(B.light!=null&&(n=B.light),B.stylesheet.lights)for(const G of B.stylesheet.lights)G.type==="ambient"&&B.ambientLight!=null&&(s=B.ambientLight),G.type==="directional"&&B.directionalLight!=null&&(p=B.directionalLight);_=this._prioritizeTerrain(_,B.terrain,B.stylesheet.terrain),B.stylesheet.fog&&B.fog!=null&&(y=B.fog),B.stylesheet.snow&&B.snow!=null&&(w=B.snow),B.stylesheet.rain&&B.rain!=null&&(P=B.rain),B.stylesheet.camera!=null&&(D=B.stylesheet.camera),B.stylesheet.projection!=null&&(z=B.stylesheet.projection),B.stylesheet.transition!=null&&(k=B.stylesheet.transition),j[B.scope]=B._styleColorTheme}}),this.light=n,this.ambientLight=s,this.directionalLight=p,this.fog=y,this.snow=w,this.rain=P,this._styleColorThemeForScope=j,_===null?delete this.terrain:this.terrain=_,this.camera=D||{"camera-projection":"perspective"},this.projection=z||{name:"mercator"},this.transition=i.l({},Up,k),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(n){const s=p=>{for(const _ of p.fragments)s(_.style);n(p)};s(this)}_prioritizeTerrain(n,s,p){const _=n&&n.drapeRenderMode===0;return p===null?s&&s.drapeRenderMode===0?s:_?n:null:s!=null&&(!n||_||s&&s.drapeRenderMode===1)?s:n}mergeTerrain(){let n;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(s=>{n=this._prioritizeTerrain(n,s.terrain,s.stylesheet.terrain)}),n===null?delete this.terrain:this.terrain=n}mergeProjection(){let n;this.forEachFragmentStyle(s=>{s.stylesheet.projection!=null&&(n=s.stylesheet.projection)}),this.projection=n||{name:"mercator"}}mergeSources(){const n={},s={},p={};this.forEachFragmentStyle(_=>{for(const y in _._sourceCaches){const w=i.aB(y,_.scope);n[w]=_._sourceCaches[y]}for(const y in _._otherSourceCaches){const w=i.aB(y,_.scope);s[w]=_._otherSourceCaches[y]}for(const y in _._symbolSourceCaches){const w=i.aB(y,_.scope);p[w]=_._symbolSourceCaches[y]}}),this._mergedSourceCaches=n,this._mergedOtherSourceCaches=s,this._mergedSymbolSourceCaches=p}mergeLayers(){const n={},s=[],p={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(y=>{for(const w of y._order){const P=y._layers[w];if(P.type==="slot"){const z=i.cp(w);if(n[z])continue;n[z]=[]}P.slot&&n[P.slot]?n[P.slot].push(P):s.push(P)}}),this._mergedOrder=[];const _=(y=[])=>{for(const w of y)if(w.type==="slot"){const P=i.cp(w.id);n[P]&&_(n[P]),this._mergedSlots.push(P)}else{const P=i.aB(w.id,w.scope);this._mergedOrder.push(P),p[P]=w,w.is3D()&&(this._has3DLayers=!0),w.type==="circle"&&(this._hasCircleLayers=!0),w.type==="symbol"&&(this._hasSymbolLayers=!0),w.type==="clip"&&(this._clipLayerPresent=!0)}};_(s),this._mergedOrder.sort((y,w)=>{const P=p[y],z=p[w];return P.hasInitialOcclusionOpacityProperties?z.is3D()?1:0:P.is3D()&&z.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=p,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(n){return this.stylesheet.camera=i.l({},this.stylesheet.camera,n),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(n){return n.data?function(s,p,_){const y=i.l({},p);for(const P of Object.keys(i.a2.colorTheme))y[P]===void 0&&(y[P]=i.a2.colorTheme[P].default);const w=new i.a3(Rx,s,new Map(_));return w.setTransitionOrValue(y,_),w.untransitioned().possiblyEvaluate(new i.a7(0))}(this.scope,n,this.options).get("data"):null}_loadColorTheme(n){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const s=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((p,_)=>{const y="data:image/png;base64,";if(!n||n.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void p();let w=n;w.startsWith(y)||(w=y+w);const P="mapbox-reserved-lut",z=new Image;z.src=w,z.onerror=()=>{this._styleColorTheme.lutLoading=!1,_(new Error("Failed to load image data"))},z.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==s)return void p();this._styleColorTheme.lutLoading=!1;const{width:k,height:D,data:j}=i.q.getImageData(z);if(D>32)return void _(new Error("The height of the image must be less than or equal to 32 pixels."));if(k!==D*D)return void _(new Error("The width of the image must be equal to the height squared."));this.getImage(P)&&this.removeImage(P),this.addImage(P,{data:new i.r({width:k,height:D},j),pixelRatio:1,sdf:!1,usvg:!1,version:0});const B=this.imageManager.getImage(P,this.scope);B?(this._styleColorTheme.lut={image:B.data,data:n},p()):_(new Error("Missing LUT image."))}})}getLut(n){const s=this._styleColorThemeForScope[n];return s?s.lut:null}setProjection(n){n?this.stylesheet.projection=n:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(n){this._spriteRequest=function(s,p,_){let y,w,P;const z=i.q.devicePixelRatio>1?"@2x":"";let k=i.n(p.transformRequest(p.normalizeSpriteURL(s,z,".json"),i.R.SpriteJSON),(B,G)=>{k=null,P||(P=B,y=G,j())}),D=i.o(p.transformRequest(p.normalizeSpriteURL(s,z,".png"),i.R.SpriteImage),(B,G)=>{D=null,P||(P=B,w=G,j())});function j(){if(P)_(P);else if(y&&w){const B=i.q.getImageData(w),G={};for(const Q in y){const{width:J,height:ie,x:oe,y:me,sdf:Se,pixelRatio:be,stretchX:Pe,stretchY:Me,content:Ie}=y[Q],Ce=new i.r({width:J,height:ie});i.r.copy(B,Ce,{x:oe,y:me},{x:0,y:0},{width:J,height:ie},null),G[Q]={data:Ce,pixelRatio:be,sdf:Se,stretchX:Pe,stretchY:Me,content:Ie,usvg:!1}}_(null,G)}}return{cancel(){k&&(k.cancel(),k=null),D&&(D.cancel(),D=null)}}}(n,this.map._requestManager,(s,p)=>{if(this._spriteRequest=null,s)this.fire(new i.y(s));else if(p)for(const _ in p)this.imageManager.addImage(_,this.scope,p[_]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))})}_loadIconset(n){if(!i.f(n)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(n);const s=this.map._spriteFormat==="auto";var p,_;this._spriteRequest=(_=(y,w)=>{if(this._spriteRequest=null,y)s?this._loadSprite(n):this.fire(new i.y(y));else if(w)for(const P in w)this.imageManager.addImage(P,this.scope,w[P]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new i.z("data",{dataType:"style"}))},i.bh((p=this.map._requestManager).transformRequest(p.normalizeIconsetURL(n),i.R.Iconset),(y,w)=>{if(y)return void _(y);const P={},z=i.cf(new i.bg(w));for(const k of z.icons){const D={version:1,pixelRatio:i.q.devicePixelRatio,content:n0(k),stretchX:k.metadata?k.metadata.stretch_x_areas:void 0,stretchY:k.metadata?k.metadata.stretch_y_areas:void 0,sdf:!1,usvg:!0,icon:k};P[k.name]=D}_(null,P)}))}_validateLayer(n){const s=this.getOwnSource(n.source);if(!s)return;const p=n.sourceLayer;p&&(s.type==="geojson"||s.vectorLayerIds&&s.vectorLayerIds.indexOf(p)===-1)&&this.fire(new i.y(new Error(`Source layer "${p}" does not exist on source "${s.id}" as specified by style layer "${n.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const n in this._sourceCaches)if(!this._sourceCaches[n].loaded())return!1;if(!this.imageManager.isLoaded()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:n}of this.fragments)if(!n.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((n,s)=>{const p=this.fragments[s];return p&&p.style&&(n.data=p.style.serialize()),n})}_serializeSources(){const n={};for(const s in this._sourceCaches){const p=this._sourceCaches[s].getSource();n[p.id]||(n[p.id]=p.serialize())}return n}_serializeLayers(n){const s=[];for(const p of n){const _=this._layers[p];_&&_.type!=="custom"&&s.push(_.serialize())}return s}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const n in this._sourceCaches)if(this._sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(n){return n?this.order:this._mergedOrder}isLayerDraped(n){return!!this.terrain&&n.isDraped(this.getLayerSourceCache(n))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(n){const s=this.getOwnLayer(n);if(s)return s;this.fire(new i.y(new Error(`The layer '${n}' does not exist in the map's style.`)))}_checkSource(n){const s=this.getOwnSource(n);if(s)return s;this.fire(new i.y(new Error(`The source '${n}' does not exist in the map's style.`)))}precompilePrograms(n,s){const p=this.map.painter;if(p)for(let _=n.minzoom||0;_<(n.maxzoom||25.5);_++){const y=n.getProgramIds();if(y)for(const w of y){const P=n.getDefaultProgramParams(w,s.zoom,this._styleColorTheme.lut);P&&(p.style=this,this.fog&&(p._fogVisible=!0,P.overrideFog=!0,p.getOrCreateProgram(w,P)),p._fogVisible=!1,P.overrideFog=!1,p.getOrCreateProgram(w,P),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(P.overrideRtt=!0,p.getOrCreateProgram(w,P)))}}}update(n){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(n),this.directionalLight&&this.directionalLight.recalculate(n);const s=this.calculateLightsBrightness();n.brightness=s||0,s!==this._brightness&&(this._brightness=s,this.dispatcher.broadcast("setBrightness",s));const p=this._changes.isDirty();let _=!1;if(this._changes.isDirty()){const w=this._changes.getLayerUpdatesByScope();for(const P in w){const{updatedIds:z,removedIds:k}=w[P];(z||k)&&(this._updateWorkerLayers(P,z,k),_=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(n),this.light&&this.light.updateTransitions(n),this.ambientLight&&this.ambientLight.updateTransitions(n),this.directionalLight&&this.directionalLight.updateTransitions(n),this.fog&&this.fog.updateTransitions(n),this.snow&&this.snow.updateTransitions(n),this.rain&&this.rain.updateTransitions(n),this._changes.reset()}const y={};for(const w in this._mergedSourceCaches){const P=this._mergedSourceCaches[w];y[w]=P.used,P.used=!1,P.tileCoverLift=0}for(const w of this._mergedOrder){const P=this._mergedLayers[w];if(P.recalculate(n,this._availableImages),!P.isHidden(n.zoom)){const z=this.getLayerSourceCache(P);z&&(z.used=!0,z.tileCoverLift=Math.max(z.tileCoverLift,P.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(P,n)}):this.precompilePrograms(P,n))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&_&&this.mergeLayers();for(const w in y){const P=this._mergedSourceCaches[w];y[w]!==P.used&&P.getSource().fire(new i.z("data",{sourceDataType:"visibility",dataType:"source",sourceId:P.getSource().id}))}this.light&&this.light.recalculate(n),this.terrain&&this.terrain.recalculate(n),this.fog&&this.fog.recalculate(n),this.snow&&this.snow.recalculate(n),this.rain&&this.rain.recalculate(n),this.z=n.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),p&&this.fire(new i.z("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=this._changes.getUpdatedImages();if(n.length){for(const s in this._sourceCaches)this._sourceCaches[s].reloadTilesForDependencies(["icons","patterns"],n);this._changes.resetUpdatedImages()}}_updateWorkerLayers(n,s,p){const _=this.getFragmentStyle(n);_&&this.dispatcher.broadcast("updateLayers",{layers:s?_._serializeLayers(s):[],scope:n,removedIds:p||[],options:_.options})}setState(n,s){if(this._checkLoaded(),Ns(this,li(n)))return!1;(n=i.co(n)).layers=va(n.layers);const p=function(w,P){if(!w)return[{command:Hr.setStyle,args:[P]}];let z=[];try{if(!i.bm(w.version,P.version))return[{command:Hr.setStyle,args:[P]}];if(i.bm(w.center,P.center)||z.push({command:Hr.setCenter,args:[P.center]}),i.bm(w.zoom,P.zoom)||z.push({command:Hr.setZoom,args:[P.zoom]}),i.bm(w.bearing,P.bearing)||z.push({command:Hr.setBearing,args:[P.bearing]}),i.bm(w.pitch,P.pitch)||z.push({command:Hr.setPitch,args:[P.pitch]}),i.bm(w.sprite,P.sprite)||z.push({command:Hr.setSprite,args:[P.sprite]}),i.bm(w.glyphs,P.glyphs)||z.push({command:Hr.setGlyphs,args:[P.glyphs]}),i.bm(w.imports,P.imports)||function(G=[],Q=[],J){Q=Q||[];const ie=(G=G||[]).map(xr),oe=Q.map(xr),me=G.reduce(br,{}),Se=Q.reduce(br,{}),be=ie.slice();let Pe,Me,Ie,Ce;for(Pe=0,Me=0;Pe<ie.length;Pe++)Ie=ie[Pe],Se.hasOwnProperty(Ie)?Me++:(J.push({command:Hr.removeImport,args:[Ie]}),be.splice(be.indexOf(Ie,Me),1));for(Pe=0,Me=0;Pe<oe.length;Pe++)Ie=oe[oe.length-1-Pe],be[be.length-1-Pe]!==Ie&&(me.hasOwnProperty(Ie)?(J.push({command:Hr.removeImport,args:[Ie]}),be.splice(be.lastIndexOf(Ie,be.length-Me),1)):Me++,Ce=be[be.length-Pe],J.push({command:Hr.addImport,args:[Se[Ie],Ce]}),be.splice(be.length-Pe,0,Ie));for(const De of Q){const $e=me[De.id];$e&&!i.bm($e,De)&&J.push({command:Hr.updateImport,args:[De.id,De]})}}(w.imports,P.imports,z),i.bm(w.transition,P.transition)||z.push({command:Hr.setTransition,args:[P.transition]}),i.bm(w.light,P.light)||z.push({command:Hr.setLight,args:[P.light]}),i.bm(w.fog,P.fog)||z.push({command:Hr.setFog,args:[P.fog]}),i.bm(w.snow,P.snow)||z.push({command:Hr.setSnow,args:[P.snow]}),i.bm(w.rain,P.rain)||z.push({command:Hr.setRain,args:[P.rain]}),i.bm(w.projection,P.projection)||z.push({command:Hr.setProjection,args:[P.projection]}),i.bm(w.lights,P.lights)||z.push({command:Hr.setLights,args:[P.lights]}),i.bm(w.camera,P.camera)||z.push({command:Hr.setCamera,args:[P.camera]}),!i.bm(w["color-theme"],P["color-theme"]))return[{command:Hr.setStyle,args:[P]}];const k={},D=[];(function(G,Q,J,ie){let oe;for(oe in Q=Q||{},G=G||{})G.hasOwnProperty(oe)&&(Q.hasOwnProperty(oe)||co(oe,J,ie));for(oe in Q){if(!Q.hasOwnProperty(oe))continue;const me=Q[oe];G.hasOwnProperty(oe)?i.bm(G[oe],me)||(G[oe].type==="geojson"&&me.type==="geojson"&&_r(G,Q,oe)?J.push({command:Hr.setGeoJSONSourceData,args:[oe,me.data]}):Wl(oe,Q,J,ie)):Ls(oe,Q,J)}})(w.sources,P.sources,D,k);const j=[];w.layers&&w.layers.forEach(G=>{G.source&&k[G.source]?z.push({command:Hr.removeLayer,args:[G.id]}):j.push(G)});let B=w.terrain;B&&k[B.source]&&(z.push({command:Hr.setTerrain,args:[void 0]}),B=void 0),z=z.concat(D),i.bm(B,P.terrain)||z.push({command:Hr.setTerrain,args:[P.terrain]}),function(G,Q,J){Q=Q||[];const ie=(G=G||[]).map(xr),oe=Q.map(xr),me=G.reduce(br,{}),Se=Q.reduce(br,{}),be=ie.slice(),Pe=Object.create(null);let Me,Ie,Ce,De,$e,at,rt;for(Me=0,Ie=0;Me<ie.length;Me++)Ce=ie[Me],Se.hasOwnProperty(Ce)?Ie++:(J.push({command:Hr.removeLayer,args:[Ce]}),be.splice(be.indexOf(Ce,Ie),1));for(Me=0,Ie=0;Me<oe.length;Me++)Ce=oe[oe.length-1-Me],be[be.length-1-Me]!==Ce&&(me.hasOwnProperty(Ce)?(J.push({command:Hr.removeLayer,args:[Ce]}),be.splice(be.lastIndexOf(Ce,be.length-Ie),1)):Ie++,at=be[be.length-Me],J.push({command:Hr.addLayer,args:[Se[Ce],at]}),be.splice(be.length-Me,0,Ce),Pe[Ce]=!0);for(Me=0;Me<oe.length;Me++)if(Ce=oe[Me],De=me[Ce],$e=Se[Ce],!Pe[Ce]&&!i.bm(De,$e))if(i.bm(De.source,$e.source)&&i.bm(De["source-layer"],$e["source-layer"])&&i.bm(De.type,$e.type)){for(rt in Mt(De.layout,$e.layout,J,Ce,null,Hr.setLayoutProperty),Mt(De.paint,$e.paint,J,Ce,null,Hr.setPaintProperty),i.bm(De.slot,$e.slot)||J.push({command:Hr.setSlot,args:[Ce,$e.slot]}),i.bm(De.filter,$e.filter)||J.push({command:Hr.setFilter,args:[Ce,$e.filter]}),i.bm(De.minzoom,$e.minzoom)&&i.bm(De.maxzoom,$e.maxzoom)||J.push({command:Hr.setLayerZoomRange,args:[Ce,$e.minzoom,$e.maxzoom]}),De)De.hasOwnProperty(rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&rt!=="slot"&&(rt.indexOf("paint.")===0?Mt(De[rt],$e[rt],J,Ce,rt.slice(6),Hr.setPaintProperty):i.bm(De[rt],$e[rt])||J.push({command:Hr.setLayerProperty,args:[Ce,rt,$e[rt]]}));for(rt in $e)$e.hasOwnProperty(rt)&&!De.hasOwnProperty(rt)&&rt!=="layout"&&rt!=="paint"&&rt!=="filter"&&rt!=="metadata"&&rt!=="minzoom"&&rt!=="maxzoom"&&rt!=="slot"&&(rt.indexOf("paint.")===0?Mt(De[rt],$e[rt],J,Ce,rt.slice(6),Hr.setPaintProperty):i.bm(De[rt],$e[rt])||J.push({command:Hr.setLayerProperty,args:[Ce,rt,$e[rt]]}))}else J.push({command:Hr.removeLayer,args:[Ce]}),at=be[be.lastIndexOf(Ce)+1],J.push({command:Hr.addLayer,args:[$e,at]})}(j,P.layers,z)}catch(k){console.warn("Unable to compute style diff:",k),z=[{command:Hr.setStyle,args:[P]}]}return z}(this.serialize(),n).filter(w=>!(w.command in Lx));if(p.length===0)return!1;const _=p.filter(w=>!(w.command in zx));if(_.length>0)throw new Error(`Unimplemented: ${_.map(w=>w.command).join(", ")}.`);const y=[];return p.forEach(w=>{y.push(this[w.command].apply(this,w.args))}),s&&Promise.all(y).then(s),this.stylesheet=n,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}addImage(n,s){return this.getImage(n)?this.fire(new i.y(new Error("An image with this name already exists."))):(this.imageManager.addImage(n,this.scope,s),this._afterImageUpdated(n),this)}updateImage(n,s,p=!1){this.imageManager.updateImage(n,this.scope,s),p&&this._afterImageUpdated(n)}getImage(n){return this.imageManager.getImage(n,this.scope)}removeImage(n){return this.getImage(n)?(this.imageManager.removeImage(n,this.scope),this._afterImageUpdated(n),this):this.fire(new i.y(new Error("No image with this name exists.")))}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(this.scope),this._changes.updateImage(n),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new i.z("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(n,s,p={}){return this._checkLoaded(),this._validate(xe,`models.${n}`,s,null,p)||(this.modelManager.addModel(n,s,this.scope),this._changes.setDirty()),this}hasModel(n){return this.modelManager.hasModel(n,this.scope)}removeModel(n){return this.hasModel(n)?(this.modelManager.removeModel(n,this.scope),this):this.fire(new i.y(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(n,s,p={}){if(this._checkLoaded(),this.getOwnSource(n)!==void 0)throw new Error(`There is already a source with ID "${n}".`);if(!s.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(s).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(s.type)>=0&&this._validate(Hi,`sources.${n}`,s,null,p))return;this.map&&this.map._collectResourceTiming&&(s.collectResourceTiming=!0);const _=ss(n,s,this.dispatcher,this);_.scope=this.scope,_.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(_.id),source:_.serialize(),sourceId:_.id}));const y=w=>{const P=(w?"symbol:":"other:")+_.id,z=i.aB(P,this.scope),k=this._sourceCaches[P]=new bo(z,_,w);(w?this._symbolSourceCaches:this._otherSourceCaches)[_.id]=k,k.onAdd(this.map)};y(!1),s.type!=="vector"&&s.type!=="geojson"||y(!0),_.onAdd&&_.onAdd(this.map),p.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(n){this._checkLoaded();const s=this.getOwnSource(n);if(!s)throw new Error("There is no source with this ID");for(const _ in this._layers)if(this._layers[_].source===n)return this.fire(new i.y(new Error(`Source "${n}" cannot be removed while layer "${_}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===n)return this.fire(new i.y(new Error(`Source "${n}" cannot be removed while terrain is using it.`)));const p=this.getOwnSourceCaches(n);for(const _ of p){const y=i.cp(_.id);delete this._sourceCaches[y],this._changes.discardSourceCacheUpdate(_.id),_.fire(new i.z("data",{sourceDataType:"metadata",dataType:"source",sourceId:_.getSource().id})),_.setEventedParent(null),_.clearTiles()}return delete this._otherSourceCaches[n],delete this._symbolSourceCaches[n],this.mergeSources(),s.setEventedParent(null),s.onRemove&&s.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(n,s){this._checkLoaded(),this.getOwnSource(n).setData(s),this._changes.setDirty()}getOwnSource(n){const s=this.getOwnSourceCache(n);return s&&s.getSource()}getOwnSources(){const n=[];for(const s in this._otherSourceCaches){const p=this.getOwnSourceCache(s);p&&n.push(p.getSource())}return n}areTilesLoaded(){const n=this._mergedSourceCaches;for(const s in n){const p=n[s]._tiles;for(const _ in p){const y=p[_];if(y.state!=="loaded"&&y.state!=="errored")return!1}}return!0}setLights(n){if(this._checkLoaded(),!n)return delete this.ambientLight,void delete this.directionalLight;const s=this._getTransitionParameters();for(const _ of n){if(this._validate(pi,"lights",_))return;switch(_.type){case"ambient":if(this.ambientLight){const y=this.ambientLight;y.set(_),y.updateTransitions(s)}else this.ambientLight=new $n(_,Vr||(Vr=new i.a4({color:new i.a5(i.a2.properties_light_ambient.color),"color-use-theme":new i.a5({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a5(i.a2.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const y=this.directionalLight;y.set(_),y.updateTransitions(s)}else this.directionalLight=new $n(_,Gr||(Gr=new i.a4({direction:new i.aj(i.a2.properties_light_directional.direction),color:new i.a5(i.a2.properties_light_directional.color),"color-use-theme":new i.a5({type:"string",default:"default","property-type":"data-constant"}),intensity:new i.a5(i.a2.properties_light_directional.intensity),"cast-shadows":new i.a5(i.a2.properties_light_directional["cast-shadows"]),"shadow-quality":new i.a5(i.a2.properties_light_directional["shadow-quality"]),"shadow-intensity":new i.a5(i.a2.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const p=new i.a7(this.z||0,s);this.ambientLight&&this.ambientLight.recalculate(p),this.directionalLight&&this.directionalLight.recalculate(p),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const n=this.directionalLight,s=this.ambientLight;if(!n||!s)return;const p=B=>.2126*(B[0]<=.03928?B[0]/12.92:Math.pow((B[0]+.055)/1.055,2.4))+.7152*(B[1]<=.03928?B[1]/12.92:Math.pow((B[1]+.055)/1.055,2.4))+.0722*(B[2]<=.03928?B[2]/12.92:Math.pow((B[2]+.055)/1.055,2.4)),_=n.properties.get("color").toRenderColor(null).toArray01(),y=n.properties.get("intensity"),w=n.properties.get("direction"),P=1-i.ca(w.x,w.y,w.z)[2]/90,z=p(_)*y*P,k=s.properties.get("color").toRenderColor(null).toArray01(),D=s.properties.get("intensity"),j=p(k)*D;return Number(((z+j)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const n=[];return this.directionalLight&&n.push(this.directionalLight.get()),this.ambientLight&&n.push(this.ambientLight.get()),n}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(n){if(!n)return this;if(i.cq(n)){const s=i.cr(n),p=this.fragments.find(({id:y})=>y===s);if(!p)throw new Error(`Style import '${n}' not found`);const _=i.cp(n);return p.style.getFragmentStyle(_)}{const s=this.fragments.find(({id:p})=>p===n);if(!s)throw new Error(`Style import '${n}' not found`);return s.style}}setFeaturesetSelectors(n){if(n){this.featuresetSelectors={};for(const s in n){const p=this.featuresetSelectors[s]=[];for(const _ of n[s].selectors){let y;if(_.properties)for(const w in _.properties){const P=i.S(_.properties[w]);P.result==="success"&&(y=y||{},y[w]=P.value)}p.push({layerId:_.layer,namespace:_.featureNamespace,properties:y})}}}}getFeaturesetDescriptors(n){const s=this.getFragmentStyle(n);if(!s||!s.stylesheet.featuresets)return[];const p=[];for(const _ in s.stylesheet.featuresets)p.push({featuresetId:_,importId:s.scope?s.scope:void 0});return p}getFeaturesetLayers(n,s){const p=this.getFragmentStyle(s),_=p.stylesheet.featuresets;if(!_||!_[n])return this.fire(new i.y(new Error(`The featureset '${n}' does not exist in the map's style and cannot be queried.`))),[];const y=[];for(const w of _[n].selectors){const P=p.getOwnLayer(w.layer);P&&y.push(P)}return y}getConfigProperty(n,s){const p=this.getFragmentStyle(n);if(!p)return null;const _=i.aB(s,p.scope),y=p.options.get(_),w=y?y.value||y.default:null;return w?w.serialize():null}setConfigProperty(n,s,p){const _=this.getFragmentStyle(n);if(!_)return;const y=_.stylesheet.indoor?t0(_.stylesheet.schema):_.stylesheet.schema;if(!y||!y[s])return;const w=i.S(p);if(w.result!=="success")return void Ns(this,w.value);const P=w.value.expression,z=i.aB(s,_.scope),k=_.options.get(z);if(!k)return;let D;const{minValue:j,maxValue:B,stepValue:G,type:Q,values:J}=y[s],ie=i.S(y[s].default);ie.result==="success"&&(D=ie.value.expression),D?(this.options.set(z,{...k,value:P,default:D,minValue:j,maxValue:B,stepValue:G,type:Q,values:J}),this.updateConfigDependencies(s)):this.fire(new i.y(new Error(`No schema defined for the config option "${s}" in the "${n}" fragment.`)))}getConfig(n){const s=this.getFragmentStyle(n);if(!s)return null;const p=s.stylesheet.schema;if(!p)return null;const _={};for(const y in p){const w=i.aB(y,s.scope),P=s.options.get(w),z=P?P.value||P.default:null;_[y]=z?z.serialize():null}return _}setConfig(n,s){const p=this.getFragmentStyle(n);p&&(p.updateConfig(s,p.stylesheet.schema),this.updateConfigDependencies())}getSchema(n){const s=this.getFragmentStyle(n);return s?s.stylesheet.schema:null}setSchema(n,s){const p=this.getFragmentStyle(n);p&&(p.stylesheet.schema=s,p.updateConfig(p._config,s),this.updateConfigDependencies())}updateConfig(n,s){if(this._config=n,n||s)if(s)for(const p in s){let _,y;const w=i.S(s[p].default);if(w.result==="success"&&(_=w.value.expression),n&&n[p]!==void 0){const B=i.S(n[p]);B.result==="success"&&(y=B.value.expression)}const{minValue:P,maxValue:z,stepValue:k,type:D,values:j}=s[p];if(_){const B=i.aB(p,this.scope);this.options.set(B,{default:_,value:y,minValue:P,maxValue:z,stepValue:k,type:D,values:j})}else this.fire(new i.y(new Error(`No schema defined for config option "${p}".`)))}else this.fire(new i.y(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(n){for(const s of this._configDependentLayers){const p=this.getLayer(s);if(p){if(n&&!p.configDependencies.has(n))continue;p.possiblyEvaluateVisibility(),this._updateLayer(p)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(s=>{const p=s._styleColorTheme.colorThemeOverride?s._styleColorTheme.colorThemeOverride:s._styleColorTheme.colorTheme;if(p){const _=s._evaluateColorThemeData(p);(!s._styleColorTheme.lut&&_!==""||s._styleColorTheme.lut&&_!==s._styleColorTheme.lut.data)&&s.setColorTheme(p)}}),this._changes.setDirty()}addLayer(n,s,p={}){this._checkLoaded();const _=n.id;if(this._layers[_])return void this.fire(new i.y(new Error(`Layer with id "${_}" already exists on this map`)));let y;if(n.type==="custom"){if(Ns(this,i.cs(n)))return;y=i.ct(n,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof n.source=="object"&&(this.addSource(_,n.source),n=i.co(n),n=i.l(n,{source:_})),this._validate(le,`layers.${_}`,n,{arrayIndex:-1},p))return;y=i.ct(n,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(y),y.setEventedParent(this,{layer:{id:_}})}y.configDependencies.size!==0&&this._configDependentLayers.add(y.fqid);let w=this._order.length;if(s){const D=this._order.indexOf(s);if(D===-1)return void this.fire(new i.y(new Error(`Layer with id "${s}" does not exist on this map.`)));y.slot===this._layers[s].slot?w=D:i.w(`Layer with id "${s}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(w,0,_),this._layerOrderChanged=!0,this._layers[_]=y;const P=this.getOwnLayerSourceCache(y),z=!!this.directionalLight&&this.directionalLight.shadowsEnabled();P&&y.canCastShadows()&&z&&(P.castsShadows=!0);const k=this._changes.getRemovedLayer(y);if(k&&y.source&&P&&y.type!=="custom"){this._changes.discardLayerRemoval(y);const D=i.aB(y.source,y.scope);k.type!==y.type?this._changes.updateSourceCache(D,"clear"):(this._changes.updateSourceCache(D,"reload"),P.pause())}this._updateLayer(y),y.onAdd&&y.onAdd(this.map),y.scope=this.scope,this.mergeLayers()}moveLayer(n,s){this._checkLoaded();const p=this._checkLayer(n);if(!p||n===s)return;const _=this._order.indexOf(n);this._order.splice(_,1);let y=this._order.length;if(s){const w=this._order.indexOf(s);if(w===-1)return void this.fire(new i.y(new Error(`Layer with id "${s}" does not exist on this map.`)));p.slot===this._layers[s].slot?y=w:i.w(`Layer with id "${s}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(y,0,n),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(n){this._checkLoaded();const s=this._checkLayer(n);if(!s)return;s.setEventedParent(null);const p=this._order.indexOf(n);this._order.splice(p,1),delete this._layers[n],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(s.fqid),this._changes.removeLayer(s);const _=this.getOwnLayerSourceCache(s);if(_&&_.castsShadows){let y=!1;for(const w in this._layers)if(this._layers[w].source===s.source&&this._layers[w].canCastShadows()){y=!0;break}_.castsShadows=y}s.onRemove&&s.onRemove(this.map),this.mergeLayers()}getOwnLayer(n){return this._layers[n]}hasLayer(n){return n in this._mergedLayers}hasLayerType(n){for(const s in this._layers)if(this._layers[s].type===n)return!0;return!1}setLayerZoomRange(n,s,p){this._checkLoaded();const _=this._checkLayer(n);_&&(_.minzoom===s&&_.maxzoom===p||(s!=null&&(_.minzoom=s),p!=null&&(_.maxzoom=p),this._updateLayer(_)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(n,s){this._checkLoaded();const p=this._checkLayer(n);p&&p.slot!==s&&(p.slot=s,this._updateLayer(p))}setFilter(n,s,p={}){this._checkLoaded();const _=this._checkLayer(n);if(_&&!i.bm(_.filter,s))return s==null?(_.filter=void 0,void this._updateLayer(_)):void(this._validate(K,`layers.${_.id}.filter`,s,{layerType:_.type},p)||(_.filter=i.co(s),this._updateLayer(_)))}getFilter(n){const s=this._checkLayer(n);if(s)return i.co(s.filter)}setLayoutProperty(n,s,p,_={}){this._checkLoaded();const y=this._checkLayer(n);if(y&&!i.bm(y.getLayoutProperty(s),p)){if(p!=null&&(!_||_.validate!==!1)&&Ns(y,de.call(li,{key:`layers.${n}.layout.${s}`,layerType:y.type,objectKey:s,value:p,styleSpec:i.a2,style:{glyphs:!0,sprite:!0}})))return;y.setLayoutProperty(s,p),y.configDependencies.size!==0&&this._configDependentLayers.add(y.fqid),this._updateLayer(y)}}getLayoutProperty(n,s){const p=this._checkLayer(n);if(p)return p.getLayoutProperty(s)}setPaintProperty(n,s,p,_={}){this._checkLoaded();const y=this._checkLayer(n);if(!y||i.bm(y.getPaintProperty(s),p)||p!=null&&(!_||_.validate!==!1)&&Ns(y,he.call(li,{key:`layers.${n}.paint.${s}`,layerType:y.type,objectKey:s,value:p,styleSpec:i.a2})))return;const w=y.setPaintProperty(s,p);y.configDependencies.size!==0&&this._configDependentLayers.add(y.fqid),w&&this._updateLayer(y),this._changes.updatePaintProperties(y)}getPaintProperty(n,s){const p=this._checkLayer(n);if(p)return p.getPaintProperty(s)}setFeatureState(n,s){if(this._checkLoaded(),"target"in n){if("featuresetId"in n.target){const{featuresetId:z,importId:k}=n.target,D=this.getFragmentStyle(k),j=D.getFeaturesetLayers(z);for(const{source:B,sourceLayer:G}of j)D.setFeatureState({id:n.id,source:B,sourceLayer:G},s)}else if("layerId"in n.target){const{layerId:z}=n.target,k=this.getLayer(z);this.setFeatureState({id:n.id,source:k.source,sourceLayer:k.sourceLayer},s)}return}const p=n.source,_=n.sourceLayer,y=this._checkSource(p);if(!y)return;const w=y.type;if(w==="geojson"&&_)return void this.fire(new i.y(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(w==="vector"&&!_)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));n.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided.")));const P=this.getOwnSourceCaches(p);for(const z of P)z.setFeatureState(_,n.id,s)}removeFeatureState(n,s){if(this._checkLoaded(),"target"in n){if("featuresetId"in n.target){const{featuresetId:z,importId:k}=n.target,D=this.getFragmentStyle(k),j=D.getFeaturesetLayers(z);for(const{source:B,sourceLayer:G}of j)D.removeFeatureState({id:n.id,source:B,sourceLayer:G},s)}else if("layerId"in n.target){const{layerId:z}=n.target,k=this.getLayer(z);this.removeFeatureState({id:n.id,source:k.source,sourceLayer:k.sourceLayer},s)}return}const p=n.source,_=this._checkSource(p);if(!_)return;const y=_.type,w=y==="vector"?n.sourceLayer:void 0;if(y==="vector"&&!w)return void this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")));if(s&&typeof n.id!="string"&&typeof n.id!="number")return void this.fire(new i.y(new Error("A feature id is required to remove its specific state property.")));const P=this.getOwnSourceCaches(p);for(const z of P)z.removeFeatureState(w,n.id,s)}getFeatureState(n){if(this._checkLoaded(),"target"in n){let y;if("featuresetId"in n.target){const{featuresetId:w,importId:P}=n.target,z=this.getFragmentStyle(P),k=z.getFeaturesetLayers(w);for(const{source:D,sourceLayer:j}of k){const B=z.getFeatureState({id:n.id,source:D,sourceLayer:j});if(B&&!y)y=B;else if(!i.bm(y,B))return void this.fire(new i.y(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in n.target){const{layerId:w}=n.target,P=this.getLayer(w);y=this.getFeatureState({id:n.id,source:P.source,sourceLayer:P.sourceLayer})}return y}const s=n.source,p=n.sourceLayer,_=this._checkSource(s);if(_){if(_.type!=="vector"||p)return n.id===void 0&&this.fire(new i.y(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(s)[0].getFeatureState(p,n.id);this.fire(new i.y(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(n){return this.stylesheet.transition=i.l({},this.stylesheet.transition,n),this.transition=this.stylesheet.transition,this}getTransition(){return i.l({},this.stylesheet.transition)}serialize(){this._checkLoaded();const n=this.getTerrain(),s=n&&this.terrain&&this.terrain.scope===this.scope?n:this.stylesheet.terrain;return i.cu({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:s,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},p=>p!==void 0)}_updateFilteredLayers(n){for(const s of Object.values(this._mergedLayers))n(s)&&this._updateLayer(s)}_updateLayer(n){this._changes.updateLayer(n);const s=this.getLayerSourceCache(n),p=i.aB(n.source,n.scope),_=this._changes.getUpdatedSourceCaches();n.source&&!_[p]&&s&&s.getSource().type!=="raster"&&(this._changes.updateSourceCache(p,"reload"),s.pause()),n.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(n){const s=P=>this._mergedLayers[P].is3D(),p=this.order,_={},y=[];for(let P=p.length-1;P>=0;P--){const z=p[P];if(s(z)){_[z]=P;for(const k of n){const D=k[z];if(D)for(const j of D)y.push(j)}}}y.sort((P,z)=>z.intersectionZ-P.intersectionZ);const w=[];for(let P=p.length-1;P>=0;P--){const z=p[P];if(s(z))for(let k=y.length-1;k>=0;k--){const D=y[k].feature;if(D.layer&&_[D.layer.id]<P)break;w.push(D),y.pop()}else for(const k of n){const D=k[z];if(D)for(const j of D)w.push(j.feature)}}return w}queryRenderedFeatures(n,s,p){let _;s&&!Array.isArray(s)&&s.filter&&(this._validate(K,"queryRenderedFeatures.filter",s.filter,null,s),_=i.aY(s.filter));const y={},w=D=>{if(Vp.has(D.type))return;const j=this.getOwnLayerSourceCache(D),B=y[j.id]=y[j.id]||{sourceCache:j,layers:{},has3DLayers:!1};D.is3D()&&(B.has3DLayers=!0),B.layers[D.fqid]=B.layers[D.fqid]||{styleLayer:D,targets:[]},B.layers[D.fqid].targets.push({filter:_})};if(s&&s.layers){if(!Array.isArray(s.layers))return this.fire(new i.y(new Error("parameters.layers must be an Array."))),[];for(const D of s.layers){const j=this._layers[D];if(!j)return this.fire(new i.y(new Error(`The layer '${D}' does not exist in the map's style and cannot be queried for features.`))),[];w(j)}}else for(const D in this._layers)w(this._layers[D]);const P=this._queryRenderedFeatures(n,y,p),z=this._flattenAndSortRenderedFeatures(P),k=[];for(const D of z)i.cr(D.layer.id)===this.scope&&k.push(D);return k}queryRenderedFeatureset(n,s,p){let _;s&&!Array.isArray(s)&&s.filter&&(this._validate(K,"queryRenderedFeatures.filter",s.filter,null,s),_=i.aY(s.filter));const y="mock",w=[];if(s&&s.target)w.push({...s,targetId:y,filter:_});else{const k=this.getFeaturesetDescriptors();for(const D of k)w.push({targetId:y,filter:_,target:D});for(const{style:D}of this.fragments){const j=D.getFeaturesetDescriptors();for(const B of j)w.push({targetId:y,filter:_,target:B})}}const P=this.queryRenderedTargets(n,w,p),z=[];for(const k of P)for(const D of k.variants[y])z.push(new i.cv(k,D));return z}queryRenderedTargets(n,s,p){const _={},y=(P,z,k,D)=>{const j=_[z.id]=_[z.id]||{sourceCache:z,layers:{},has3DLayers:!1};j.layers[P.fqid]=j.layers[P.fqid]||{styleLayer:P,targets:[]},P.is3D()&&(j.has3DLayers=!0),j.layers[P.fqid].targets.push(D?{...k,namespace:D.namespace,properties:D.properties}:k)};for(const P of s)if("featuresetId"in P.target){const{featuresetId:z,importId:k}=P.target,D=this.getFragmentStyle(k),j=D.featuresetSelectors[z];if(!j){this.fire(new i.y(new Error(`The featureset '${z}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const B of j){const G=D.getOwnLayer(B.layerId);G&&!Vp.has(G.type)&&y(G,D.getOwnLayerSourceCache(G),P,B)}}else if("layerId"in P.target){const{layerId:z}=P.target,k=this.getLayer(z);if(!k||Vp.has(k.type))continue;y(k,this.getLayerSourceCache(k),P)}const w=this._queryRenderedFeatures(n,_,p);return this._flattenAndSortRenderedFeatures(w)}_queryRenderedFeatures(n,s,p){const _=[],y=!!this.map._showQueryGeometry,w=Qn.createFromScreenPoints(n,p);for(const P in s){const z=Is(w,s[P],this._availableImages,p,y);Object.keys(z).length&&_.push(z)}if(this.placement)for(const P in s){if(!s[P].sourceCache._onlySymbols)continue;const z=ko(w.screenGeometry,s[P],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData);Object.keys(z).length&&_.push(z)}return _}querySourceFeatures(n,s){const p=s&&s.filter;p&&this._validate(K,"querySourceFeatures.filter",p,null,s);let _=[];const y=this.getOwnSourceCaches(n);for(const w of y)_=_.concat(Ps(w,s));return _}addSourceType(n,s,p){return Oa.getSourceType(n)?p(new Error(`A source type called "${n}" already exists.`)):(Oa.setSourceType(n,s),s.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:s.workerSourceURL},p):p(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(n,s,p={}){this._checkLoaded();const _=this.light.getLight();let y=!1;for(const P in n)if(!i.bm(n[P],_[P])){y=!0;break}if(!y)return;const w=this._getTransitionParameters();this.light.setLight(n,s,p),this.light.updateTransitions(w)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=i.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&i.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(n,s=1){if(this._checkLoaded(),!n)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),s===0&&delete this.terrain,n===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let p=n;const _=n.source==null;if(s===1){if(this.disableElevatedTerrain)return;if(typeof p.source=="object"){const P="terrain-dem-src";this.addSource(P,p.source),p=i.co(p),p=i.l(p,{source:P})}const y=i.l({},p),w={};if(this.terrain&&_){y.source=this.terrain.get().source;const P=this.terrain?this.getFragmentStyle(this.terrain.scope):null;P&&(w.style=P.serialize())}if(this._validate(Wi,"terrain",y,w))return}if(!this.terrain||this.terrain.scope!==this.scope&&!_||this.terrain&&s!==this.terrain.drapeRenderMode){if(!p)return;this._createTerrain(p,s),this.fire(new i.z("data",{dataType:"style"}))}else{const y=this.terrain,w=y.get();for(const P of Object.keys(i.a2.terrain))!p.hasOwnProperty(P)&&i.a2.terrain[P].default&&(p[P]=i.a2.terrain[P].default);for(const P in n)if(!i.bm(n[P],w[P])){y.set(n,this.options),this.stylesheet.terrain=n;const z=this._getTransitionParameters({duration:0});y.updateTransitions(z),this.fire(new i.z("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(n){const s=this.fog=new vr(n,this.map.transform,this.scope,this.options);this.stylesheet.fog=s.get();const p=this._getTransitionParameters({duration:0});s.updateTransitions(p)}_createSnow(n){const s=this.snow=new In(n,this.map.transform,this.scope,this.options);this.stylesheet.snow=s.get();const p=this._getTransitionParameters({duration:0});s.updateTransitions(p)}_createRain(n){const s=this.rain=new ii(n,this.map.transform,this.scope,this.options);this.stylesheet.rain=s.get();const p=this._getTransitionParameters({duration:0});s.updateTransitions(p)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const n of this.map._markers)n._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(n){if(this._checkLoaded(),!n)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const s=this.fog;if(!i.bm(s.get(),n)){s.set(n,this.options),this.stylesheet.fog=s.get();const p=this._getTransitionParameters({duration:0});s.updateTransitions(p)}}else this._createFog(n);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(n){if(this._checkLoaded(),!n)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const s=this.snow;if(!i.bm(s.get(),n)){s.set(n,this.options),this.stylesheet.snow=s.get();const p=this._getTransitionParameters({duration:0});s.updateTransitions(p)}}else this._createSnow(n);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(n){if(this._checkLoaded(),!n)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const s=this.rain;if(!i.bm(s.get(),n)){s.set(n,this.options),this.stylesheet.rain=s.get();const p=this._getTransitionParameters({duration:0});s.updateTransitions(p)}}else this._createRain(n);this._markersNeedUpdate=!0}_reloadColorTheme(){const n=()=>{for(const _ in this._layers)this._layers[_].lut=this._styleColorTheme.lut;for(const _ in this._sourceCaches)this._sourceCaches[_].clearTiles()},s=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!s)return this._styleColorTheme.lut=null,void n();const p=this._evaluateColorThemeData(s);this._loadColorTheme(p).then(()=>{this.fire(new i.z("colorthemeset")),n()}).catch(_=>{i.w(`Couldn't set color theme: ${_}`)})}setColorTheme(n){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&i.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=n,this._reloadColorTheme()}setImportColorTheme(n,s){const p=this.getFragmentStyle(n);p&&(p._styleColorTheme.colorThemeOverride=s,p._reloadColorTheme())}_getTransitionParameters(n){return{now:i.q.now(),transition:i.l(this.transition,n)}}updateDrapeFirstLayers(){if(!this.terrain)return;const n=[],s=[];for(const p of this._mergedOrder)this.isLayerDraped(this._mergedLayers[p])?n.push(p):s.push(p);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...n),this._drapedFirstOrder.push(...s)}_createTerrain(n,s){const p=this.terrain=new Ze(n,s,this.scope,this.options);s===1&&(this.stylesheet.terrain=n),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const _=this._getTransitionParameters({duration:0});p.updateTransitions(_)}_force3DLayerUpdate(){for(const n in this._layers){const s=this._layers[n];s.type==="fill-extrusion"&&this._updateLayer(s)}}_forceSymbolLayerUpdate(){for(const n in this._layers){const s=this._layers[n];s.type==="symbol"&&this._updateLayer(s)}}_validate(n,s,p,_,y={}){if(y&&y.validate===!1)return!1;const w=i.l({},this.serialize());return Ns(this,n.call(li,i.l({key:s,style:w,value:p,styleSpec:i.a2},_)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),i.cw.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._mergedLayers)this._mergedLayers[n].setEventedParent(null);for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles(),this._mergedSourceCaches[n].setEventedParent(null);this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.dispatcher.remove())}clearSource(n){const s=this.getSourceCaches(n);for(const p of s)p.clearTiles()}clearSources(){for(const n in this._mergedSourceCaches)this._mergedSourceCaches[n].clearTiles()}reloadSource(n){const s=this.getSourceCaches(n);for(const p of s)p.resume(),p.reload()}reloadSources(){for(const n of this.getSources())n.reload&&n.reload()}updateSources(n){let s;this.directionalLight&&(s=_l(this.directionalLight));for(const p in this._mergedSourceCaches)this._mergedSourceCaches[p].update(n,void 0,void 0,s)}_generateCollisionBoxes(){for(const n in this._sourceCaches){const s=this._sourceCaches[n];s.resume(),s.reload()}}_updatePlacement(n,s,p,_,y,w,P=!1){let z=!1,k=!1;const D={},j={};for(const B of this._mergedOrder){const G=this._mergedLayers[B];if(G.type!=="symbol")continue;const Q=i.aB(G.source,G.scope);let J=D[Q];if(!J){const oe=this.getLayerSourceCache(G);if(!oe)continue;const me=oe.getRenderableIds(!0).map(Se=>oe.getTileByID(Se));j[Q]=me.slice(),J=D[Q]=me.sort((Se,be)=>be.tileID.overscaledZ-Se.tileID.overscaledZ||(Se.tileID.isLessThan(be.tileID)?-1:1))}const ie=this.crossTileSymbolIndex.addLayer(G,J,s.center.lng,s.projection);z=z||ie}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),P=P||this._layerOrderChanged||_===0,this._layerOrderChanged&&this.fire(new i.z("neworder")),(P||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(i.q.now(),s.zoom))&&(this.pauseablePlacement=new vd(s,this._mergedOrder,P,p,_,y,this.placement,this.fog&&s.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,D,j,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(i.q.now()),k=!0),z&&this.pauseablePlacement.placement.setStale()),k||z){this._buildingIndex.onNewFrame(s.zoom);for(let B=0;B<this._mergedOrder.length;B++){const G=this._mergedLayers[this._mergedOrder[B]];if(G.type!=="symbol")continue;const Q=this.isLayerClipped(G);this.placement.updateLayerOpacities(G,D[i.aB(G.source,G.scope)],B,Q?w:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(i.q.now())}}_releaseSymbolFadeTiles(){for(const n in this._sourceCaches)this._sourceCaches[n].releaseSymbolFadeTiles()}addImport(n,s){this._checkLoaded();const p=this.stylesheet.imports=this.stylesheet.imports||[];if(p.findIndex(({id:y})=>y===n.id)!==-1)return void this.fire(new i.y(new Error(`Import with id '${n.id}' already exists in the map's style.`)));if(!s)return p.push(n),this._loadImports([n],!0);const _=p.findIndex(({id:y})=>y===s);return _===-1&&this.fire(new i.y(new Error(`Import with id "${s}" does not exist on this map.`))),this.stylesheet.imports=p.slice(0,_).concat(n).concat(p.slice(_)),this._loadImports([n],!0,s)}updateImport(n,s){this._checkLoaded();const p=this.stylesheet.imports||[],_=this.getImportIndex(n);return _===-1?this:typeof s=="string"?(this.setImportUrl(n,s),this):(s.url&&s.url!==p[_].url&&this.setImportUrl(n,s.url),i.bm(s.config,p[_].config)||this.setImportConfig(n,s.config),i.bm(s.data,p[_].data)||this.setImportData(n,s.data),this)}moveImport(n,s){this._checkLoaded();let p=this.stylesheet.imports||[];const _=this.getImportIndex(n);if(_===-1)return this;const y=this.getImportIndex(s);if(y===-1)return this;const w=p[_],P=this.fragments[_];return p=p.filter(({id:z})=>z!==n),this.fragments=this.fragments.filter(({id:z})=>z!==n),this.stylesheet.imports=p.slice(0,y).concat(w).concat(p.slice(y)),this.fragments=this.fragments.slice(0,y).concat(P).concat(this.fragments.slice(y)),this.mergeLayers(),this}setImportUrl(n,s){this._checkLoaded();const p=this.stylesheet.imports||[],_=this.getImportIndex(n);if(_===-1)return this;p[_].url=s;const y=this.fragments[_];return y.style=this._createFragmentStyle(p[_]),y.style.on("style.import.load",()=>this.mergeAll()),y.style.loadURL(s),this}setImportData(n,s){this._checkLoaded();const p=this.getImportIndex(n),_=this.stylesheet.imports||[];return p===-1?this:s?(this.fragments[p].style.setState(s),this._reloadImports(),this):(delete _[p].data,this.setImportUrl(n,_[p].url))}setImportConfig(n,s){this._checkLoaded();const p=this.getImportIndex(n),_=this.stylesheet.imports||[];if(p===-1)return this;s?_[p].config=s:delete _[p].config;const y=this.fragments[p],w=y.style.stylesheet&&y.style.stylesheet.schema;return y.config=s,y.style.updateConfig(s,w),this.updateConfigDependencies(),this}removeImport(n){this._checkLoaded();const s=this.stylesheet.imports||[],p=this.getImportIndex(n);p!==-1&&(s.splice(p,1),this.fragments[p].style._remove(),this.fragments.splice(p,1),this._reloadImports())}getImportIndex(n){const s=(this.stylesheet.imports||[]).findIndex(p=>p.id===n);return s===-1&&this.fire(new i.y(new Error(`Import '${n}' does not exist in the map's style and cannot be updated.`))),s}getLayer(n){return this._mergedLayers[n]}getSources(){const n=[];for(const s in this._mergedOtherSourceCaches){const p=this._mergedOtherSourceCaches[s];p&&n.push(p.getSource())}return n}getSource(n,s){const p=this.getSourceCache(n,s);return p&&p.getSource()}getLayerSource(n){const s=this.getLayerSourceCache(n);return s&&s.getSource()}getSourceCache(n,s){const p=i.aB(n,s);return this._mergedOtherSourceCaches[p]}getLayerSourceCache(n){const s=i.aB(n.source,n.scope);return n.type==="symbol"?this._mergedSymbolSourceCaches[s]:this._mergedOtherSourceCaches[s]}getSourceCaches(n){if(n==null)return Object.values(this._mergedSourceCaches);const s=[];return this._mergedOtherSourceCaches[n]&&s.push(this._mergedOtherSourceCaches[n]),this._mergedSymbolSourceCaches[n]&&s.push(this._mergedSymbolSourceCaches[n]),s}updateSourceCaches(){const n=this._changes.getUpdatedSourceCaches();for(const s in n){const p=n[s];p==="reload"?this.reloadSource(s):p==="clear"&&this.clearSource(s)}}updateLayers(n){const s=this._changes.getUpdatedPaintProperties();for(const p of s){const _=this.getLayer(p);_&&_.updateTransitions(n)}}getImages(n,s,p){this.imageManager.getImages(s.icons,s.scope,p),this._updateTilesForChangedImages();const _=y=>{y&&y.setDependencies(s.tileID.key,s.type,s.icons)};_(this._otherSourceCaches[s.source]),_(this._symbolSourceCaches[s.source])}rasterizeImages(n,s,p){this.imageManager.rasterizeImages(s,p)}getGlyphs(n,s,p){this.glyphManager.getGlyphs(s.stacks,s.scope,p)}getResource(n,s,p){return i.cx(s,p)}getOwnSourceCache(n){return this._otherSourceCaches[n]}getOwnLayerSourceCache(n){return n.type==="symbol"?this._symbolSourceCaches[n.source]:this._otherSourceCaches[n.source]}getOwnSourceCaches(n){const s=[];return this._otherSourceCaches[n]&&s.push(this._otherSourceCaches[n]),this._symbolSourceCaches[n]&&s.push(this._symbolSourceCaches[n]),s}_isSourceCacheLoaded(n){const s=this.getOwnSourceCaches(n);return s.length===0?(this.fire(new i.y(new Error(`There is no source with ID '${n}'`))),!1):s.every(p=>p.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(n,s){if(!this._clipLayerPresent&&n.type!=="fill-extrusion")return!1;const p=n.type==="fill-extrusion"&&n.sourceLayer==="building";if(n.is3D()){if(p||s&&s.type==="batched-model"||n.type==="model")return!0}else if(n.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(n=>{n.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Oa.getSourceType=function(f){return zi[f]},Oa.setSourceType=function(f,n){zi[f]=n},Oa.registerForPluginStateChange=i.cg;var th=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,o0=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Gp=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,Cd="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",rh=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,Md=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,yl=`highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}
#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,Id=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,Hp=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,Ql=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,Bc=`#ifdef RENDER_SHADOWS
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp vec2 uv=pos.xy;return shadow_sample_1(uv,pos.z-bias);}float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;
#ifdef TEXTURE_GATHER
highp vec2 uv=pos.xy;highp vec4 samples=textureGather(u_shadowmap_0,uv,0);lowp vec4 stepSamples=step(samples,vec4(compare0));
#else
highp vec2 uv00=pos.xy-vec2(0.5*u_shadow_texel_size);highp vec2 uv10=uv00+vec2(u_shadow_texel_size,0.0);highp vec2 uv01=uv00+vec2(0.0,u_shadow_texel_size);highp vec2 uv11=uv01+vec2(u_shadow_texel_size,0.0);lowp vec4 stepSamples=vec4(
shadow_sample_0(uv01,compare0),shadow_sample_0(uv11,compare0),shadow_sample_0(uv10,compare0),shadow_sample_0(uv00,compare0)
);
#endif
vec2 f=fract(pos.xy*u_shadow_map_resolution-vec2(0.5));lowp vec2 lerpx=mix(stepSamples.wx,stepSamples.zy,f.xx);return mix(lerpx.x,lerpx.y,f.y);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {
#ifdef SHADOWS_SINGLE_CASCADE
light_view_pos0.xyz/=light_view_pos0.w;vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);
#else
light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const ec=[];vl(th,ec),vl(Gp,ec),vl(o0,ec);const tc={"_prelude_fog.vertex.glsl":Md,"_prelude_terrain.vertex.glsl":rh,"_prelude_shadow.vertex.glsl":Ql,"_prelude_fog.fragment.glsl":yl,"_prelude_shadow.fragment.glsl":Bc,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":Id,"_prelude_raster_particle.glsl":Hp},js={};Kr("",rh),Kr(yl,Md),Kr(Bc,Ql),Kr(Id,""),Kr(Hp,"");const nh=Kr(o0,Gp),Pd=th;var Wp={background:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float opacity_t=smoothstep((1.0-blur_positive)*antialiased_blur,blur_positive*antialiased_blur,extrude_length-1.0)-smoothstep(0.0,antialiasblur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Kr("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Kr(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Kr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Kr("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Kr("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Kr("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:Kr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:Kr(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:Kr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:Kr(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec4 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec2 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec4 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
halfwidth=(u_width_scale*a_z_offset_width.y)/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
float pattern_len=pattern_size/aspect;float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset > 0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec2 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec4 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec4 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset+0.01*step(0.01,a_z_offset),1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
float a_uv_x=a_packed[0];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:Kr("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:Kr("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:Kr(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:Kr(`#include "_prelude_lighting.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+(u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#else
z+=u_pitch_with_map ? (u_elevation_from_sea ? z_offset : z_offset) : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#endif
}`),terrainRaster:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:Kr("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:Kr(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Cd),skyboxGradient:Kr(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,Cd),skyboxCapture:Kr(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Kr(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:Kr(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:Kr(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:Kr(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:Kr("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:Kr("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:Kr("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:Kr("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function vl(f,n){const s=f.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let p of s)if(p=p.trim(),p[0]==="#"&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const _=p.split(" ");for(const y of _)n.includes(y)||n.push(y)}}function Kr(f,n){const s=/#include\s+"([^"]+)"/g,p=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let _=n.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);_&&(_=_.map(k=>{const D=k.split(" ");return D[D.length-1]}),_=[...new Set(_)]);const y={},w=[],P=[];if(f=f.replace(s,(k,D)=>(P.push(D),"")),(n=n.replace(s,(k,D)=>(w.push(D),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let z=[...ec];vl(f,z),vl(n,z);for(const k of[...w,...P])tc[k]||console.error(`Undefined include: ${k}`),js[k]||(js[k]=[],vl(tc[k],js[k])),z=[...z,...js[k]];return{fragmentSource:f=f.replace(p,(k,D,j,B,G)=>(y[G]=!0,D==="define"?`
#ifndef HAS_UNIFORM_u_${G}
in ${j} ${B} ${G};
#else
uniform ${j} ${B} u_${G};
#endif
`:D==="initialize"?`
#ifdef HAS_UNIFORM_u_${G}
    ${j} ${B} ${G} = u_${G};
#endif
`:D==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${G}
    in ${j} ${B} ${G};
#endif
`:D==="initialize-attribute"?"":void 0)),vertexSource:n=n.replace(p,(k,D,j,B,G)=>{const Q=B==="float"?"vec2":B,J=G.match(/color/)?"color":Q;return D==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${G}
in ${j} ${B} a_${G};
#endif
`:y[G]?D==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
in ${j} ${Q} a_${G};
out ${j} ${B} ${G};
#else
uniform ${j} ${B} u_${G};
#endif
`:D==="initialize"?J==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = a_${G};
#else
    ${j} ${B} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${G} = unpack_mix_${J}(a_${G}, u_${G}_t);
#else
    ${j} ${B} ${G} = u_${G};
#endif
`:D==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${G}
    in ${j} ${B} a_${G};
    out ${j} ${B} ${G};
#endif
`:D==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${G}
    ${G} = a_${G};
#endif
`:void 0:D==="define"?`
#ifndef HAS_UNIFORM_u_${G}
uniform lowp float u_${G}_t;
in ${j} ${Q} a_${G};
#else
uniform ${j} ${B} u_${G};
#endif
`:D==="define-instanced"?J==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${G}0;
in vec4 a_${G}1;
in vec4 a_${G}2;
in vec4 a_${G}3;
#else
uniform ${j} ${B} u_${G};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${j} ${Q} a_${G};
#else
uniform ${j} ${B} u_${G};
#endif
`:D==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${G}
    ${j} ${B} ${G} = a_${G};
#endif
`:J==="vec4"?`
#ifndef HAS_UNIFORM_u_${G}
    ${j} ${B} ${G} = a_${G};
#else
    ${j} ${B} ${G} = u_${G};
#endif
`:`
#ifndef HAS_UNIFORM_u_${G}
    ${j} ${B} ${G} = unpack_mix_${J}(a_${G}, u_${G}_t);
#else
    ${j} ${B} ${G} = u_${G};
#endif
`}),staticAttributes:_,usedDefines:z,vertexIncludes:w,fragmentIncludes:P}}class ih{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(n,s,p,_,y,w,P,z){this.context=n;let k=this.boundPaintVertexBuffers.length!==_.length;for(let j=0;!k&&j<_.length;j++)this.boundPaintVertexBuffers[j]!==_[j]&&(k=!0);let D=this.boundDynamicVertexBuffers.length!==P.length;for(let j=0;!D&&j<P.length;j++)this.boundDynamicVertexBuffers[j]!==P[j]&&(D=!0);if(!this.vao||this.boundProgram!==s||this.boundLayoutVertexBuffer!==p||k||D||this.boundIndexBuffer!==y||this.boundVertexOffset!==w)this.freshBind(s,p,_,y,w,P,z);else{n.bindVertexArrayOES.set(this.vao);for(const j of P)j&&(j.bind(),z&&j.instanceCount&&j.setVertexAttribDivisor(n.gl,s,z));y&&y.dynamicDraw&&y.bind()}}freshBind(n,s,p,_,y,w,P){const z=n.numAttributes,k=this.context,D=k.gl;this.vao&&this.destroy(),this.vao=k.gl.createVertexArray(),k.bindVertexArrayOES.set(this.vao),this.boundProgram=n,this.boundLayoutVertexBuffer=s,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=_,this.boundVertexOffset=y,this.boundDynamicVertexBuffers=w,s.enableAttributes(D,n),s.bind(),s.setVertexAttribPointers(D,n,y);for(const j of p)j.enableAttributes(D,n),j.bind(),j.setVertexAttribPointers(D,n,y);for(const j of w)j&&(j.enableAttributes(D,n),j.bind(),j.setVertexAttribPointers(D,n,y),P&&j.instanceCount&&j.setVertexAttribDivisor(D,n,P));_&&_.bind(),k.currentNumAttributes=z}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function a0(f,n){const s=Math.pow(2,n.canonical.z),p=n.canonical.y;return[new i.a9(0,p/s).toLngLat().lat,new i.a9(0,(p+1)/s).toLngLat().lat]}function s0(f,n,s,p,_,y,w){const P=f.context,z=P.gl,k=s.hillshadeFBO;if(!k)return;f.prepareDrawTile();const D=f.isTileAffectedByFog(n),j=f.getOrCreateProgram("hillshade",{overrideFog:D});P.activeTexture.set(z.TEXTURE0),z.bindTexture(z.TEXTURE_2D,k.colorAttachment.get());const B=((ie,oe,me,Se)=>{const be=me.paint.get("hillshade-shadow-color"),Pe=me.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",Me=me.paint.get("hillshade-highlight-color"),Ie=me.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Ce=me.paint.get("hillshade-accent-color"),De=me.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",$e=me.paint.get("hillshade-emissive-strength");let at=i.ah(me.paint.get("hillshade-illumination-direction"));if(me.paint.get("hillshade-illumination-anchor")==="viewport")at-=ie.transform.angle;else if(ie.style&&ie.style.enable3dLights()&&ie.style.directionalLight){const je=ie.style.directionalLight.properties.get("direction"),qe=i.ca(je.x,je.y,je.z);at=i.ah(qe[1])}const rt=!ie.options.moving;return{u_matrix:Se||ie.transform.calculateProjMatrix(oe.tileID.toUnwrapped(),rt),u_image:0,u_latrange:a0(0,oe.tileID),u_light:[me.paint.get("hillshade-exaggeration"),at],u_shadow:be.toRenderColor(Pe?null:me.lut),u_highlight:Me.toRenderColor(Ie?null:me.lut),u_emissive_strength:$e,u_accent:Ce.toRenderColor(De?null:me.lut)}})(f,s,p,f.terrain?n.projMatrix:null);f.uploadCommonUniforms(P,j,n.toUnwrapped());const{tileBoundsBuffer:G,tileBoundsIndexBuffer:Q,tileBoundsSegments:J}=f.getTileBoundsBuffers(s);j.draw(f,z.TRIANGLES,_,y,w,mr.disabled,B,p.id,G,Q,J)}function qp(f,n,s){if(!n.needsDEMTextureUpload)return;const p=f.context,_=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||f.getTileTexture(s.stride);const y=s.getPixels();n.demTexture?n.demTexture.update(y,{premultiply:!1}):n.demTexture=new i.T(p,y,_.R32F,{premultiply:!1}),n.needsDEMTextureUpload=!1}function Nc(f,n,s){const p=f.context,_=p.gl;if(!n.dem)return;const y=n.dem;if(p.activeTexture.set(_.TEXTURE1),qp(f,n,y),!n.demTexture)return;n.demTexture.bind(_.NEAREST,_.CLAMP_TO_EDGE);const w=y.dim;p.activeTexture.set(_.TEXTURE0);let P=n.hillshadeFBO;if(!P){const B=new i.T(p,{width:w,height:w,data:null},_.RGBA8);B.bind(_.LINEAR,_.CLAMP_TO_EDGE),P=n.hillshadeFBO=p.createFramebuffer(w,w,!0,"renderbuffer"),P.colorAttachment.set(B.texture)}p.bindFramebuffer.set(P.framebuffer),p.viewport.set([0,0,w,w]);const{tileBoundsBuffer:z,tileBoundsIndexBuffer:k,tileBoundsSegments:D}=f.getMercatorTileBoundsBuffers(),j=[];f.linearFloatFilteringSupported()&&j.push("TERRAIN_DEM_FLOAT_FORMAT"),f.getOrCreateProgram("hillshadePrepare",{defines:j}).draw(f,_.TRIANGLES,ir.disabled,Cr.disabled,Br.unblended,mr.disabled,((B,G)=>{const Q=G.stride,J=i.aa.mat4.create();return i.aa.mat4.ortho(J,0,i.af,-i.af,0,0,1),i.aa.mat4.translate(J,J,[0,-i.af,0]),{u_matrix:J,u_image:1,u_dimension:[Q,Q],u_zoom:B.overscaledZ}})(n.tileID,y),s.id,z,k,D),n.needsHillshadePrepare=!1}class Nn{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class kx extends Nn{getDefault(){return i.ai.transparent}set(n){const s=this.current;(n.r!==s.r||n.g!==s.g||n.b!==s.b||n.a!==s.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Dx extends Nn{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Ox extends Nn{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class Zp extends Nn{getDefault(){return[!0,!0,!0,!0]}set(n){const s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||n[3]!==s[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Xp extends Nn{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class Yp extends Nn{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class Kp extends Nn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const s=this.current;(n.func!==s.func||n.ref!==s.ref||n.mask!==s.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class l0 extends Nn{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class c0 extends Nn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;n?s.enable(s.STENCIL_TEST):s.disable(s.STENCIL_TEST),this.current=n,this.dirty=!1}}class Fx extends Nn{getDefault(){return[0,1]}set(n){const s=this.current;(n[0]!==s[0]||n[1]!==s[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class oh extends Nn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;n?s.enable(s.DEPTH_TEST):s.disable(s.DEPTH_TEST),this.current=n,this.dirty=!1}}class ah extends Nn{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class u0 extends Nn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;n?s.enable(s.BLEND):s.disable(s.BLEND),this.current=n,this.dirty=!1}}class Ko extends Nn{getDefault(){const n=this.gl;return[n.ONE,n.ZERO,n.ONE,n.ZERO]}set(n){const s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||n[3]!==s[3]||this.dirty)&&(this.gl.blendFuncSeparate(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Jp extends Nn{getDefault(){return i.ai.transparent}set(n){const s=this.current;(n.r!==s.r||n.g!==s.g||n.b!==s.b||n.a!==s.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Ad extends Nn{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(n,n),this.current=n,this.dirty=!1)}}class Rd extends Nn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;n?s.enable(s.CULL_FACE):s.disable(s.CULL_FACE),this.current=n,this.dirty=!1}}class Qp extends Nn{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class em extends Nn{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}let zd=class extends Nn{getDefault(){return null}set(f){(f!==this.current||this.dirty)&&(this.gl.useProgram(f),this.current=f,this.dirty=!1)}};class tm extends Nn{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class rm extends Nn{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const s=this.current;(n[0]!==s[0]||n[1]!==s[1]||n[2]!==s[2]||n[3]!==s[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Ld extends Nn{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;s.bindFramebuffer(s.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class h0 extends Nn{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;s.bindRenderbuffer(s.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class d0 extends Nn{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;s.bindTexture(s.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class jc extends Nn{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;s.bindBuffer(s.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Bx extends Nn{getDefault(){return null}set(n){const s=this.gl;s.bindBuffer(s.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Nx extends Nn{getDefault(){return null}set(n){this.gl&&(n!==this.current||this.dirty)&&(this.gl.bindVertexArray(n),this.current=n,this.dirty=!1)}}class jx extends Nn{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class $x extends Nn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Vx extends Nn{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const s=this.gl;s.pixelStorei(s.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class nm extends Nn{constructor(n,s){super(n),this.context=n,this.parent=s}getDefault(){return null}}class im extends nm{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class kd extends nm{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferRenderbuffer(s.FRAMEBUFFER,this.attachment(),s.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class f0 extends nm{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const s=this.gl;s.framebufferTexture2D(s.FRAMEBUFFER,this.attachment(),s.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class $c extends kd{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const p0=(f,n,s)=>({u_matrix:f,u_image0:0,u_skirt_height:n,u_ground_shadow_factor:s}),om=(f,n,s,p,_,y,w,P,z,k,D,j,B,G,Q,J)=>({u_proj_matrix:Float32Array.from(f),u_globe_matrix:n,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:s,u_zoom_transition:_,u_merc_center:y,u_image0:0,u_frustum_tl:w,u_frustum_tr:P,u_frustum_br:z,u_frustum_bl:k,u_globe_pos:D,u_globe_radius:j,u_viewport:B,u_grid_matrix:J?Float32Array.from(J):new Float32Array(9),u_skirt_height:G,u_far_z_cutoff:Q});function am(f,n){return f!=null&&n!=null&&!(!f.hasData()||!n.hasData())&&f.demTexture!=null&&n.demTexture!=null&&f.tileID.key!==n.tileID.key}const xl=new class{constructor(){this.operations={}}newMorphing(f,n,s,p,_){if(f in this.operations){const y=this.operations[f];y.to.tileID.key!==s.tileID.key&&(y.queued=s)}else this.operations[f]={startTime:p,phase:0,duration:_,from:n,to:s,queued:null}}getMorphValuesForProxy(f){if(!(f in this.operations))return null;const n=this.operations[f];return{from:n.from,to:n.to,phase:n.phase}}update(f){for(const n in this.operations){const s=this.operations[n];for(s.phase=(f-s.startTime)/s.duration;s.phase>=1||!this._validOp(s);)if(!this._nextOp(s,f)){delete this.operations[n];break}}}_nextOp(f,n){return!!f.queued&&(f.from=f.to,f.to=f.queued,f.queued=null,f.phase=0,f.startTime=n,!0)}_validOp(f){return f.from.hasData()&&f.to.hasData()}},bl={0:null,1:"TERRAIN_VERTEX_MORPHING"};function sm(f,n,s){if(n===0)return 0;const p=n<1&&s===514?.25/n:1;return 6*Math.pow(1.5,22-f)*Math.max(n,1)*p}function wl(f,n){const s=1<<f.z;return!n&&(f.x===0||f.x===s-1)||f.y===0||f.y===s-1}const sh=f=>({u_matrix:f});function Vc(f,n,s,p,_){if(_>0){const y=i.q.now(),w=(y-f.timeAdded)/_,P=n?(y-n.timeAdded)/_:-1,z=s.getSource(),k=p.coveringZoomLevel({tileSize:z.tileSize,roundZoom:z.roundZoom}),D=!n||Math.abs(n.tileID.overscaledZ-k)>Math.abs(f.tileID.overscaledZ-k),j=D&&f.refreshedUponExpiration?1:i.av(D?w:1-P,0,1);return f.refreshedUponExpiration&&w>=1&&(f.refreshedUponExpiration=!1),n?{opacity:1,mix:1-j}:{opacity:j,mix:0}}return{opacity:1,mix:0}}class m0 extends bo{constructor(n){const s={type:"raster-dem",maxzoom:n.transform.maxZoom},p=new i.D(i.ch(),null),_=ss("mock-dem",s,p,n.style);super("mock-dem",_,!1),_.setEventedParent(this),this._sourceLoaded=!0}_loadTile(n,s){n.state="loaded",s(null)}}class g0 extends bo{constructor(n){const s=ss("proxy",{type:"geojson",maxzoom:n.transform.maxZoom},new i.D(i.ch(),null),n.style);super("proxy",s,!1),s.setEventedParent(this),this.map=this.getSource().map=n,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(n,s,p){if(n.freezeTileCoverage)return;this.transform=n;const _=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((y,w)=>{if(y[w.key]="",!this._tiles[w.key]){const P=new ya(w,this._source.tileSize*w.overscaleFactor(),n.tileZoom);P.state="loaded",this._tiles[w.key]=P}return y},{});for(const y in this._tiles)y in _||(this.freeFBO(y),this._tiles[y].unloadVectorData(),delete this._tiles[y])}freeFBO(n){const s=this.proxyCachedFBO[n];if(s!==void 0){const p=Object.values(s);this.renderCachePool.push(...p),delete this.proxyCachedFBO[n]}}deallocRenderCache(){this.renderCache.forEach(n=>n.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Dd extends i.aF{constructor(n,s,p){super(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y),this.proxyTileKey=s,this.projMatrix=p}}class Od extends i.cI{constructor(n,s){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},n.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),n.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),n.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=n,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,_,y]=function(z){const k=new i.b3,D=new i.aT,j=131;k.reserve(17161),D.reserve(33800);const B=i.af/128,G=i.af+B/2,Q=G+B;for(let ie=-B;ie<Q;ie+=B)for(let oe=-B;oe<Q;oe+=B){const me=oe<0||oe>G||ie<0||ie>G?24575:0,Se=i.av(Math.round(oe),0,i.af),be=i.av(Math.round(ie),0,i.af);k.emplaceBack(Se+me,be)}const J=(ie,oe)=>{const me=oe*j+ie;D.emplaceBack(me+1,me,me+j),D.emplaceBack(me+j,me+j+1,me+1)};for(let ie=1;ie<129;ie++)for(let oe=1;oe<129;oe++)J(oe,ie);return[0,129].forEach(ie=>{for(let oe=0;oe<130;oe++)J(oe,ie),J(ie,oe)}),[k,D,32768]}(),w=n.context;this.gridBuffer=w.createVertexBuffer(p,i.b5.members),this.gridIndexBuffer=w.createIndexBuffer(_),this.gridSegments=i.b6.simpleSegment(0,0,p.length,_.length),this.gridNoSkirtSegments=i.b6.simpleSegment(0,0,p.length,y),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new g0(s.map),this.orthoMatrix=i.aa.mat4.create(),i.aa.mat4.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,i.af,0,i.af,0,1);const P=w.gl;this._overlapStencilMode=new Cr({func:P.GEQUAL,mask:255},0,255,P.KEEP,P.KEEP,P.REPLACE),this._previousZoom=n.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=s,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new m0(s.map),this._pendingGroundEffectLayers=[]}set style(n){n.on("data",this._onStyleDataEvent.bind(this)),this._style=n,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(n,s,p){if(n&&n.terrain){this._style!==n&&(this.style=n,this._evaluationZoom=void 0);const _=n.terrain.properties,y=n.terrain.drapeRenderMode===0,w=n.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=i.q.now();const P=n.terrain&&n.terrain.scope,z=_.get("source"),k=y?this._mockSourceCache:n.getSourceCache(z,P);if(!k)return void i.w(`Couldn't find terrain source "${z}".`);if(this.sourceCache=k,this._attenuationRange=n.terrain.getAttenuationRange(),this._exaggeration=w?this.calculateExaggeration(s):_.get("exaggeration"),!s.projection.requiresDraping&&w&&this._exaggeration===0)return void this._disable();this.enabled=!0;const D=()=>{this.sourceCache.used&&i.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const j=this.getScaledDemTileSize();this.sourceCache.update(s,j,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,D(),this._initializing=!0),D(),s.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(s),this._emptyDEMTextureDirty=!0,this._previousZoom=s.zoom}else this._disable()}calculateExaggeration(n){if(this._attenuationRange&&n.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(n.zoom);const s=this._previousCameraAltitude,p=n.getFreeCameraOptions().position.z/n.pixelsPerMeter*n.worldSize;this._previousCameraAltitude=p;const _=s!=null?p-s:Number.MAX_VALUE;if(Math.abs(_)<2)return this._exaggeration;const y=n.zoom,w=this._style.terrain;if(!this._previousUpdateTimestamp)return w.getExaggeration(y);let P=y-this._previousZoom;const z=this._previousUpdateTimestamp;let k=y;this._evaluationZoom!=null&&(k=this._evaluationZoom,Math.abs(y-k)>.5&&(P=.5*(y-k+P)),P*_<0&&(k+=P)),this._evaluationZoom=k;const D=w.getExaggeration(k),j=D===w.getExaggeration(Math.max(0,k-.1));if(j&&Math.abs(D-this._exaggeration)<.01)return D;let B=Math.min(.1,.00375*(this._updateTimestamp-z));return(j||D<.1||Math.abs(P)<1e-4)&&(B=Math.min(.2,4*B)),i.ae(this._exaggeration,D,B)}resetTileLookupCache(n){this._findCoveringTileCache[n]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(n){n.coord&&n.dataType==="source"?this._clearRenderCacheForTile(n.sourceCacheId,n.coord):n.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const n in this._style._mergedSourceCaches)this._style._mergedSourceCaches[n].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(n=>n.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const n=2*this.proxySourceCache.getSource().tileSize;return[n,n]}set useVertexMorphing(n){this._useVertexMorphing=n}updateTileBinding(n){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const s=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=p._centerAltitude===0&&this.getAtPointOrZero(i.a9.fromLngLat(p.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const _=this.proxyCoords=s.getIds().map(z=>{const k=s.getTileByID(z).tileID;return k.projMatrix=p.calculateProjMatrix(k.toUnwrapped()),k});(function(z,k){const D=k.transform.pointCoordinate(k.transform.getCameraPoint()),j=new i.P(D.x,D.y);z.sort((B,G)=>{if(G.overscaledZ-B.overscaledZ)return G.overscaledZ-B.overscaledZ;const Q=new i.P(B.canonical.x+(1<<B.canonical.z)*B.wrap,B.canonical.y),J=new i.P(G.canonical.x+(1<<G.canonical.z)*G.wrap,G.canonical.y),ie=j.mult(1<<B.canonical.z);return ie.x-=.5,ie.y-=.5,ie.distSqr(Q)-ie.distSqr(J)})})(_,this.painter);const y=this.proxyToSource||{};this.proxyToSource={},_.forEach(z=>{this.proxyToSource[z.key]={}}),this.terrainTileForTile={};const w=this._style._mergedSourceCaches;for(const z in w){const k=w[z];if(!k.used||(k!==this.sourceCache&&this.resetTileLookupCache(k.id),this._setupProxiedCoordsForOrtho(k,n[z],y),k.usedForTerrain))continue;const D=n[z];k.getSource().reparseOverscaled&&this._assignTerrainTiles(D)}this.proxiedCoords[s.id]=_.map(z=>new Dd(z,z.key,this.orthoMatrix)),this._assignTerrainTiles(_),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(y),this.renderingToTexture=!1;const P={};this._visibleDemTiles=[];for(const z of this.proxyCoords){const k=this.terrainTileForTile[z.key];if(!k)continue;const D=k.tileID.key;D in P||(this._visibleDemTiles.push(k),P[D]=D)}}_assignTerrainTiles(n){this._initializing||n.forEach(s=>{if(this.terrainTileForTile[s.key])return;const p=this._findTileCoveringTileID(s,this.sourceCache);p&&(this.terrainTileForTile[s.key]=p)})}_prepareDEMTextures(){const n=this.painter.context,s=n.gl;for(const p in this.terrainTileForTile){const _=this.terrainTileForTile[p],y=_.dem;!y||_.demTexture&&!_.needsDEMTextureUpload||(n.activeTexture.set(s.TEXTURE1),qp(this.painter,_,y))}}_prepareDemTileUniforms(n,s,p,_){if(!s||s.demTexture==null)return!1;const y=n.tileID.canonical,w=Math.pow(2,s.tileID.canonical.z-y.z),P=_||"";return p[`u_dem_tl${P}`]=[y.x*w%1,y.y*w%1],p[`u_dem_scale${P}`]=w,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let n=0;const s=this._visibleDemTiles.reduce((p,_)=>{if(!_.dem)return p;const y=_.dem.tree.minimums[0];return y>0&&n++,p+y},0);return n?s/n:0}_updateEmptyDEMTexture(){const n=this.painter.context,s=n.gl;n.activeTexture.set(s.TEXTURE2);const p=this._getLoadedAreaMinimum(),_=new i.cJ({width:1,height:1},new Float32Array([p]));this._emptyDEMTextureDirty=!1;let y=this._emptyDEMTexture;return y?y.update(_,{premultiply:!1}):y=this._emptyDEMTexture=new i.T(n,_,s.R32F,{premultiply:!1}),y}setupElevationDraw(n,s,p){const _=this.painter.context,y=_.gl,w={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};w.u_exaggeration=this.exaggeration();let P=null,z=null,k=1;if(p&&p.morphing&&this._useVertexMorphing){const G=p.morphing.srcDemTile,Q=p.morphing.dstDemTile;k=p.morphing.phase,G&&Q&&(this._prepareDemTileUniforms(n,G,w,"_prev")&&(z=G),this._prepareDemTileUniforms(n,Q,w)&&(P=Q))}const D=G=>G&&G.demTexture&&this.painter.linearFloatFilteringSupported()?y.LINEAR:y.NEAREST;let j=null;var B;if(this.enabled?z&&P?(j=P.demTexture,_.activeTexture.set(y.TEXTURE4),z.demTexture.bind(D(z),y.CLAMP_TO_EDGE),w.u_dem_lerp=k):(P=this.terrainTileForTile[n.tileID.key],j=this._prepareDemTileUniforms(n,P,w)?P.demTexture:this.emptyDEMTexture):j=this.emptyDEMTexture,_.activeTexture.set(y.TEXTURE2),j&&(w.u_dem_size=(B=j).size[0]===1?1:B.size[0]-2,j.bind(D(P),y.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(p&&p.useDepthForOcclusion,s,w),p&&p.useMeterToDem&&P){const G=(1<<P.tileID.canonical.z)*i.bG(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;w.u_meter_to_dem=G}if(p&&p.labelPlaneMatrixInv&&(w.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),s.setTerrainUniformValues(_,w),this.painter.transform.projection.name==="globe"){const G=this.globeUniformValues(this.painter.transform,n.tileID.canonical,p&&p.useDenormalizedUpVectorScale);s.setGlobeUniformValues(_,G)}}globeUniformValues(n,s,p){const _=n.projection;return{u_tile_tl_up:_.upVector(s,0,0),u_tile_tr_up:_.upVector(s,i.af,0),u_tile_br_up:_.upVector(s,i.af,i.af),u_tile_bl_up:_.upVector(s,0,i.af),u_tile_up_scale:p?i.cK(1):_.upVectorScale(s,n.center.lat,n.worldSize).metersToTile}}renderToBackBuffer(n){const s=this.painter,p=this.painter.context;n.length!==0&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,s.width,s.height]),s.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(_,y,w,P,z){if(_.transform.projection.name==="globe")(function(k,D,j,B,G){const Q=k.context,J=Q.gl;let ie,oe;const me=k.transform,Se=i.cB(k,Q,me),be=(je,qe)=>{if(oe===qe)return;const mt=[bl[qe],"PROJECTION_GLOBE_VIEW"];Se&&mt.push("CUSTOM_ANTIALIASING");const Tt=k.isTileAffectedByFog(je);ie=k.getOrCreateProgram("globeRaster",{defines:mt,overrideFog:Tt}),oe=qe},Pe=k.colorModeForRenderPass(),Me=new ir(J.LEQUAL,ir.ReadWrite,k.depthRangeFor3D);xl.update(G);const Ie=i.cC(me),Ce=[i.as(me.center.lng),i.az(me.center.lat)],De=k.globeSharedBuffers,$e=[me.width*i.q.devicePixelRatio,me.height*i.q.devicePixelRatio],at=Float32Array.from(me.globeMatrix),rt={useDenormalizedUpVectorScale:!0};{const je=k.transform,qe=sm(je.zoom,D.exaggeration(),D.sourceCache._source.tileSize);oe=-1;const mt=J.TRIANGLES;for(const Tt of B){const Lt=j.getTile(Tt),et=Cr.disabled,xt=D.prevTerrainTileForTile[Tt.key],st=D.terrainTileForTile[Tt.key];am(xt,st)&&xl.newMorphing(Tt.key,xt,st,G,250),Q.activeTexture.set(J.TEXTURE0),Lt.texture&&Lt.texture.bind(J.LINEAR,J.CLAMP_TO_EDGE);const Rt=xl.getMorphValuesForProxy(Tt.key),bt=Rt?1:0;Rt&&i.H(rt,{morphing:{srcDemTile:Rt.from,dstDemTile:Rt.to,phase:i.cA(Rt.phase)}});const gt=i.cD(Tt.canonical),jt=i.cE(gt.getCenter().lat),Vt=i.cF(Tt.canonical,gt,jt,je.worldSize/je._pixelsPerMercatorPixel),Bt=i.ba(i.cG(Tt.canonical)),Zt=om(je.expandedFarZProjMatrix,at,Ie,Bt,i.ad(je.zoom),Ce,je.frustumCorners.TL,je.frustumCorners.TR,je.frustumCorners.BR,je.frustumCorners.BL,je.globeCenterInViewSpace,je.globeRadius,$e,qe,je._farZ,Vt);if(be(Tt,bt),ie&&(D.setupElevationDraw(Lt,ie,rt),k.uploadCommonUniforms(Q,ie,Tt.toUnwrapped()),De)){const[wr,lr,sr]=De.getGridBuffers(jt,qe!==0);ie.draw(k,mt,Me,et,Pe,mr.backCCW,Zt,"globe_raster",wr,lr,sr)}}}if(De&&(k.renderDefaultNorthPole||k.renderDefaultSouthPole)){const je=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Se&&je.push("CUSTOM_ANTIALIASING"),ie=k.getOrCreateProgram("globeRaster",{defines:je});for(const qe of B){const{x:mt,y:Tt,z:Lt}=qe.canonical,et=Tt===0,xt=Tt===(1<<Lt)-1,[st,Rt,bt,gt]=De.getPoleBuffers(Lt,!1);if(gt&&(et||xt)){const jt=j.getTile(qe);Q.activeTexture.set(J.TEXTURE0),jt.texture&&jt.texture.bind(J.LINEAR,J.CLAMP_TO_EDGE);let Vt=i.cH(Lt,mt,me);const Bt=i.ba(i.cG(qe.canonical)),Zt=(wr,lr)=>wr.draw(k,J.TRIANGLES,Me,Cr.disabled,Pe,mr.disabled,om(me.expandedFarZProjMatrix,Vt,Vt,Bt,0,Ce,me.frustumCorners.TL,me.frustumCorners.TR,me.frustumCorners.BR,me.frustumCorners.BL,me.globeCenterInViewSpace,me.globeRadius,$e,0,me._farZ),"globe_pole_raster",lr,bt,gt);D.setupElevationDraw(jt,ie,rt),k.uploadCommonUniforms(Q,ie,qe.toUnwrapped()),et&&k.renderDefaultNorthPole&&Zt(ie,st),xt&&k.renderDefaultSouthPole&&(Vt=i.aa.mat4.scale(i.aa.mat4.create(),Vt,[1,-1,1]),Zt(ie,Rt))}}}})(_,y,w,P,z);else{const k=_.context,D=k.gl;let j,B;const G=_.shadowRenderer,Q=Fs(_,_.longestCutoffRange),J=Pe=>{if(B===Pe)return;const Me=[];Me.push(bl[Pe]),Q.shouldRenderCutoff&&Me.push("RENDER_CUTOFF"),G&&(Me.push("RENDER_SHADOWS","DEPTH_TEXTURE"),G.useNormalOffset&&Me.push("NORMAL_OFFSET")),j=_.getOrCreateProgram("terrainRaster",{defines:Me}),B=Pe},ie=_.colorModeForRenderPass(),oe=new ir(D.LEQUAL,ir.ReadWrite,_.depthRangeFor3D);xl.update(z);const me=_.transform,Se=sm(me.zoom,y.exaggeration(),y.sourceCache._source.tileSize);let be=[0,0,0];if(G){const Pe=_.style.directionalLight,Me=_.style.ambientLight;Pe&&Me&&(be=Oc(_.style,Pe,Me))}{B=-1;const Pe=D.TRIANGLES,[Me,Ie]=[y.gridIndexBuffer,y.gridSegments];for(const Ce of P){const De=w.getTile(Ce),$e=Cr.disabled,at=y.prevTerrainTileForTile[Ce.key],rt=y.terrainTileForTile[Ce.key];am(at,rt)&&xl.newMorphing(Ce.key,at,rt,z,250),k.activeTexture.set(D.TEXTURE0),De.texture&&De.texture.bind(D.LINEAR,D.CLAMP_TO_EDGE);const je=xl.getMorphValuesForProxy(Ce.key),qe=je?1:0;let mt;je&&(mt={morphing:{srcDemTile:je.from,dstDemTile:je.to,phase:i.cA(je.phase)}});const Tt=p0(Ce.projMatrix,wl(Ce.canonical,me.renderWorldCopies)?Se/10:Se,be);if(J(qe),!j)continue;y.setupElevationDraw(De,j,mt);const Lt=Ce.toUnwrapped();G&&G.setupShadows(Lt,j),_.uploadCommonUniforms(k,j,Lt,null,Q),j.draw(_,Pe,oe,$e,ie,mr.backCCW,Tt,"terrain_raster",y.gridBuffer,Me,Ie)}}}}(s,this,this.proxySourceCache,n,this._updateTimestamp),this.renderingToTexture=!0,s.gpuTimingDeferredRenderEnd(),n.splice(0,n.length))}renderBatch(n){if(this._drapedRenderBatches.length===0)return n+1;this.renderingToTexture=!0;const s=this.painter,p=this.painter.context,_=this.proxySourceCache,y=this.proxiedCoords[_.id],w=this._drapedRenderBatches.shift(),P=s.style.order,z=[];let k=0;for(const D of y){const j=_.getTileByID(D.proxyTileKey),B=_.proxyCachedFBO[D.key]?_.proxyCachedFBO[D.key][n]:void 0,G=B!==void 0?_.renderCache[B]:this.pool[k++],Q=B!==void 0;if(j.texture=G.tex,Q&&!G.dirty){z.push(j.tileID);continue}let J;p.bindFramebuffer.set(G.fb.framebuffer),this.renderedToTile=!1,G.dirty&&(p.clear({color:i.ai.transparent,stencil:0}),G.dirty=!1);for(let ie=w.start;ie<=w.end;++ie){const oe=s.style._mergedLayers[P[ie]];if(oe.isHidden(s.transform.zoom))continue;const me=s.style.getLayerSourceCache(oe),Se=me?this.proxyToSource[D.key][me.id]:[D];if(!Se)continue;const be=Se;p.viewport.set([0,0,G.fb.width,G.fb.height]),J!==(me?me.id:null)&&(this._setupStencil(G,Se,oe,me),J=me?me.id:null),s.renderLayer(s,me,oe,be)}if(this._drapedRenderBatches.length===0)for(const ie of this._pendingGroundEffectLayers){const oe=s.style._mergedLayers[P[ie]];if(oe.isHidden(s.transform.zoom))continue;const me=s.style.getLayerSourceCache(oe),Se=me?this.proxyToSource[D.key][me.id]:[D];if(!Se)continue;const be=Se;p.viewport.set([0,0,G.fb.width,G.fb.height]),J!==(me?me.id:null)&&(this._setupStencil(G,Se,oe,me),J=me?me.id:null),s.renderLayer(s,me,oe,be)}this.renderedToTile?(G.dirty=!0,z.push(j.tileID)):Q||--k,k===5&&(k=0,this.renderToBackBuffer(z))}return this.renderToBackBuffer(z),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,s.width,s.height]),w.end+1}postRender(){}isLayerOrderingCorrect(n){const s=n.order.length;let p=-1,_=s;for(let y=0;y<s;++y)this._style.isLayerDraped(n._mergedLayers[n.order[y]])?p=Math.max(p,y):_=Math.min(_,y);return _>p}getMinElevationBelowMSL(){let n=0;return this._visibleDemTiles.filter(s=>s.dem).forEach(s=>{n=Math.min(n,s.dem.tree.minimums[0])}),n===0?n:(n-30)*this._exaggeration}raycast(n,s,p){if(!this._visibleDemTiles)return null;const _=this._visibleDemTiles.filter(y=>y.dem).map(y=>{const w=y.tileID,P=1<<w.overscaledZ,{x:z,y:k}=w.canonical,D=z/P,j=(z+1)/P,B=k/P,G=(k+1)/P;return{minx:D,miny:B,maxx:j,maxy:G,t:y.dem.tree.raycastRoot(D,B,j,G,n,s,p),tile:y}});_.sort((y,w)=>(y.t!==null?y.t:Number.MAX_VALUE)-(w.t!==null?w.t:Number.MAX_VALUE));for(const y of _){if(y.t==null)return null;const w=y.tile.dem.tree.raycast(y.minx,y.miny,y.maxx,y.maxy,n,s,p);if(w!=null)return w}return null}_createFBO(){const n=this.painter.context,s=n.gl,p=this.drapeBufferSize;n.activeTexture.set(s.TEXTURE0);const _=new i.T(n,{width:p[0],height:p[1],data:null},s.RGBA8);_.bind(s.LINEAR,s.CLAMP_TO_EDGE);const y=n.createFramebuffer(p[0],p[1],!0,null);return y.colorAttachment.set(_.texture),y.depthAttachment=new $c(n,y.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=n.createRenderbuffer(n.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,y.depthAttachment.set(this._sharedDepthStencil),n.clear({stencil:0})):y.depthAttachment.set(this._sharedDepthStencil),n.extTextureFilterAnisotropic&&s.texParameterf(s.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax),{fb:y,tex:_,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const n in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[n].hasTransition())return!0;return this._style.order.some(n=>{const s=this._style._mergedLayers[n],p=s.isHidden(this.painter.transform.zoom);return s.type==="hillshade"||s.type==="custom"?!p&&s.shouldRedrape():!p&&s.hasTransition()})}_clearLineLayersFromRenderCache(){let n=!1;for(const p of this._style.getSources())if(p instanceof Zn){n=!0;break}if(!n)return;const s={};for(let p=0;p<this._style.order.length;++p){const _=this._style._mergedLayers[this._style.order[p]],y=this._style.getLayerSourceCache(_);if(y&&!s[y.id]&&!_.isHidden(this.painter.transform.zoom)&&_.type==="line"&&_.widthExpression()instanceof i.a8){s[y.id]=!0;for(const w of this.proxyCoords){const P=this.proxyToSource[w.key][y.id];if(P)for(const z of P)this._clearRenderCacheForTile(y.id,z)}}}}_clearRasterLayersFromRenderCache(){let n=!1;for(const p in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[p]._source instanceof eo){n=!0;break}if(!n)return;const s={};for(let p=0;p<this._style.order.length;++p){const _=this._style._mergedLayers[this._style.order[p]],y=this._style.getLayerSourceCache(_);if(!y||s[y.id]||_.isHidden(this.painter.transform.zoom)||_.type!=="raster")continue;const w=_.paint.get("raster-fade-duration");for(const P of this.proxyCoords){const z=this.proxyToSource[P.key][y.id];if(z)for(const k of z){const D=Vc(y.getTile(k),y.findLoadedParent(k,0),y,this.painter.transform,w);(D.opacity!==1||D.mix!==0)&&this._clearRenderCacheForTile(y.id,k)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const n=this._style.order,s=n.length;if(s===0)return;const p=[];this._pendingGroundEffectLayers=[];let _,y=0,w=this._style._mergedLayers[n[y]];for(;!this._style.isLayerDraped(w)&&w.isHidden(this.painter.transform.zoom)&&++y<s;)w=this._style._mergedLayers[n[y]];for(;y<s;++y){const P=this._style._mergedLayers[n[y]];P.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(P)?_===void 0&&(_=y):(P.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(y),_!==void 0&&(p.push({start:_,end:y-1}),_=void 0)))}if(_!==void 0&&p.push({start:_,end:y-1}),p.length!==0){const P=p[p.length-1];this._pendingGroundEffectLayers.every(z=>z>P.end)||i.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=p}_setupRenderCache(n){const s=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,s.renderCache.length>s.renderCachePool.length){const w=Object.values(s.proxyCachedFBO);s.proxyCachedFBO={};for(let P=0;P<w.length;++P){const z=Object.values(w[P]);s.renderCachePool.push(...z)}}return}this._clearRasterLayersFromRenderCache();const p=this.proxyCoords,_=this._tilesDirty;for(let w=p.length-1;w>=0;w--){const P=p[w];if(s.getTileByID(P.key),s.proxyCachedFBO[P.key]!==void 0){const z=n[P.key],k=this.proxyToSource[P.key];let D=0;for(const j in k){const B=k[j],G=z[j];if(!G||G.length!==B.length||B.some((Q,J)=>Q!==G[J]||_[j]&&_[j].hasOwnProperty(Q.key))){D=-1;break}++D}for(const j in s.proxyCachedFBO[P.key])s.renderCache[s.proxyCachedFBO[P.key][j]].dirty=D<0||D!==Object.values(z).length}}const y=[...this._drapedRenderBatches];y.sort((w,P)=>P.end-P.start-(w.end-w.start));for(const w of y)for(const P of p){if(s.proxyCachedFBO[P.key])continue;let z=s.renderCachePool.pop();z===void 0&&s.renderCache.length<50&&(z=s.renderCache.length,s.renderCache.push(this._createFBO())),z!==void 0&&(s.proxyCachedFBO[P.key]={},s.proxyCachedFBO[P.key][w.start]=z,s.renderCache[z].dirty=!0)}this._tilesDirty={}}_setupStencil(n,s,p,_){if(!_||!this._sourceTilesOverlap[_.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const y=this.painter.context,w=y.gl;if(s.length<=1)return void(this._overlapStencilType=!1);let P;if(p.isTileClipped())P=s.length,this._overlapStencilMode.test={func:w.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(s[0].overscaledZ>s[s.length-1].overscaledZ))return void(this._overlapStencilType=!1);P=1,this._overlapStencilMode.test={func:w.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+P>255&&(y.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=P,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(s,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(n){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[n.key]),this._overlapStencilMode):Cr.disabled}_renderTileClippingMasks(n,s){const p=this.painter,_=this.painter.context,y=_.gl;p._tileClippingMaskIDs={},_.setColorMode(Br.disabled),_.setDepthMode(ir.disabled);const w=p.getOrCreateProgram("clippingMask");for(const P of n){const z=p._tileClippingMaskIDs[P.key]=--s;w.draw(p,y.TRIANGLES,ir.disabled,new Cr({func:y.ALWAYS,mask:0},z,255,y.KEEP,y.KEEP,y.REPLACE),Br.disabled,mr.disabled,sh(P.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(n){const s=this.painter.transform;if(n.x<0||n.x>s.width||n.y<0||n.y>s.height)return null;const p=[n.x,n.y,1,1];i.aa.vec4.transformMat4(p,p,s.pixelMatrixInverse),i.aa.vec4.scale(p,p,1/p[3]),p[0]/=s.worldSize,p[1]/=s.worldSize;const _=s._camera.position,y=i.bG(1,s.center.lat),w=[_[0],_[1],_[2]/y,0],P=i.aa.vec3.subtract([],p.slice(0,3),w);i.aa.vec3.normalize(P,P);const z=this.raycast(w,P,this._exaggeration);return z!==null&&z?(i.aa.vec3.scaleAndAdd(w,w,P,z),w[3]=w[2],w[2]*=y,w):null}_setupProxiedCoordsForOrtho(n,s,p){if(n.getSource()instanceof i.aI)return this._setupProxiedCoordsForImageSource(n,s,p);this._findCoveringTileCache[n.id]=this._findCoveringTileCache[n.id]||{};const _=this.proxiedCoords[n.id]=[],y=this.proxyCoords;for(let z=0;z<y.length;z++){const k=y[z],D=this._findTileCoveringTileID(k,n);if(D){const j=this._createProxiedId(k,D,p[k.key]&&p[k.key][n.id]);_.push(j),this.proxyToSource[k.key][n.id]=[j]}}let w=!1;const P=new Set;for(let z=0;z<s.length;z++){const k=n.getTile(s[z]);if(!k||!k.hasData())continue;const D=this._findTileCoveringTileID(k.tileID,this.proxySourceCache);if(D&&D.tileID.canonical.z!==k.tileID.canonical.z){const j=this.proxyToSource[D.tileID.key][n.id],B=this._createProxiedId(D.tileID,k,p[D.tileID.key]&&p[D.tileID.key][n.id]);j?j.splice(j.length-1,0,B):this.proxyToSource[D.tileID.key][n.id]=[B];const G=this.proxyToSource[D.tileID.key][n.id];P.has(G)||P.add(G),_.push(B),w=!0}}if(this._sourceTilesOverlap[n.id]=w,w&&this._debugParams.sortTilesHiZFirst)for(const z of P)z.sort((k,D)=>D.overscaledZ-k.overscaledZ)}_setupProxiedCoordsForImageSource(n,s,p){if(!n.getSource().loaded())return;const _=this.proxiedCoords[n.id]=[],y=this.proxyCoords,w=n.getSource(),P=w.tileID;if(!P)return;const z=new i.P(P.x,P.y)._div(1<<P.z),k=w.coordinates.map(i.a9.fromLngLat).reduce((j,B)=>(j.min.x=Math.min(j.min.x,B.x-z.x),j.min.y=Math.min(j.min.y,B.y-z.y),j.max.x=Math.max(j.max.x,B.x-z.x),j.max.y=Math.max(j.max.y,B.y-z.y),j),{min:new i.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new i.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),D=(j,B)=>{const G=j.wrap+j.canonical.x/(1<<j.canonical.z),Q=j.canonical.y/(1<<j.canonical.z),J=i.af/(1<<j.canonical.z),ie=B.wrap+B.canonical.x/(1<<B.canonical.z),oe=B.canonical.y/(1<<B.canonical.z);return G+J<ie+k.min.x||G>ie+k.max.x||Q+J<oe+k.min.y||Q>oe+k.max.y};for(let j=0;j<y.length;j++){const B=y[j];for(let G=0;G<s.length;G++){const Q=n.getTile(s[G]);if(!Q||!Q.hasData()||D(B,Q.tileID))continue;const J=this._createProxiedId(B,Q,p[B.key]&&p[B.key][n.id]),ie=this.proxyToSource[B.key][n.id];ie?ie.push(J):this.proxyToSource[B.key][n.id]=[J],_.push(J)}}}_createProxiedId(n,s,p){let _=this.orthoMatrix;if(p){const y=p.find(w=>w.key===s.tileID.key);if(y)return y}if(s.tileID.key!==n.key){const y=n.canonical.z-s.tileID.canonical.z;let w,P,z;_=i.aa.mat4.create();const k=s.tileID.wrap-n.wrap<<n.overscaledZ;y>0?(w=i.af>>y,P=w*((s.tileID.canonical.x<<y)-n.canonical.x+k),z=w*((s.tileID.canonical.y<<y)-n.canonical.y)):(w=i.af<<-y,P=i.af*(s.tileID.canonical.x-(n.canonical.x+k<<-y)),z=i.af*(s.tileID.canonical.y-(n.canonical.y<<-y))),i.aa.mat4.ortho(_,0,w,0,w,0,1),i.aa.mat4.translate(_,_,[P,z,0])}return new Dd(s.tileID,n.key,_)}_findTileCoveringTileID(n,s){let p=s.getTile(n);if(p&&p.hasData())return p;const _=this._findCoveringTileCache[s.id],y=_[n.key];if(p=y?s.getTileByID(y):null,p&&p.hasData()||y===null)return p;let w=p?p.tileID:n,P=w.overscaledZ;const z=s.getSource().minzoom,k=[];if(!y){const j=s.getSource().maxzoom;if(n.canonical.z>=j){const B=n.canonical.z-j;s.getSource().reparseOverscaled?(P=Math.max(n.canonical.z+2,s.transform.tileZoom),w=new i.aF(P,n.wrap,j,n.canonical.x>>B,n.canonical.y>>B)):B!==0&&(P=j,w=new i.aF(P,n.wrap,j,n.canonical.x>>B,n.canonical.y>>B))}w.key!==n.key&&(k.push(w.key),p=s.getTile(w))}const D=j=>{k.forEach(B=>{_[B]=j}),k.length=0};for(P-=1;P>=z&&(!p||!p.hasData());P--){p&&D(p.tileID.key);const j=w.calculateScaledKey(P);if(p=s.getTileByID(j),p&&p.hasData())break;const B=_[j];if(B===null)break;B===void 0?k.push(j):p=s.getTileByID(B)}return D(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(n){return this.enabled?this._findTileCoveringTileID(n,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(n,s){let p=this._tilesDirty[n];p||(p=this._tilesDirty[n]={}),p[s.key]=!0}}function Ux(f,n,s){const p=function(P,z,k){const D=i.aa.vec3.dot(z,P),j=i.aa.vec3.dot(k,[.2126,.7152,.0722]),B=(Q,J,ie)=>(1-ie)*Q+ie*J,G=B(1-.3*Math.min(j,1),1,Math.min(D+1,1));return B(.92,1,Math.asin(i.av(z[2],-1,1))/Math.PI+.5)*G}(f,[0,0,1],n),_=[0,0,0];i.aa.vec3.scale(_,s.slice(0,3),p);const y=[0,0,0];i.aa.vec3.scale(y,n.slice(0,3),f[2]);const w=[0,0,0];return i.aa.vec3.add(w,_,y),i.ce(w)}const _0=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],lh=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","model","symbol"];class y0{static cacheKey(n,s,p,_){let y=`${s}${_?_.cacheKey:""}`;for(const w of p)n.usedDefines.includes(w)&&(y+=`/${w}`);return y}constructor(n,s,p,_,y,w){const P=n.gl;this.program=P.createProgram(),this.configuration=_,this.name=s,this.fixedDefines=[...w];const z=_?_.getBinderAttributes():[],k=(p.staticAttributes||[]).concat(z);let D=_?_.defines():[];D=D.concat(w.map(ie=>`#define ${ie}`));const j=`#version 300 es
`;let B=j+D.concat("precision mediump float;",Pd,nh.fragmentSource).join(`
`);for(const ie of p.fragmentIncludes)B+=`
${tc[ie]}`;B+=`
${p.fragmentSource}`;let G=j+D.concat("precision highp float;",Pd,nh.vertexSource).join(`
`);for(const ie of p.vertexIncludes)G+=`
${tc[ie]}`;this.forceManualRenderingForInstanceIDShaders=n.forceManualRenderingForInstanceIDShaders&&p.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(G+=`
uniform int u_instanceID;
`),G+=`
${p.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(G=G.replaceAll("gl_InstanceID","u_instanceID"));const Q=P.createShader(P.FRAGMENT_SHADER);if(P.isContextLost())return void(this.failedToCreate=!0);P.shaderSource(Q,B),P.compileShader(Q),P.attachShader(this.program,Q);const J=P.createShader(P.VERTEX_SHADER);if(P.isContextLost())this.failedToCreate=!0;else{P.shaderSource(J,G),P.compileShader(J),P.attachShader(this.program,J),this.attributes={},this.numAttributes=k.length;for(let ie=0;ie<this.numAttributes;ie++)if(k[ie]){const oe=k[ie].startsWith("a_")?k[ie]:`a_${k[ie]}`;P.bindAttribLocation(this.program,ie,oe),this.attributes[oe]=ie}P.linkProgram(this.program),P.deleteShader(J),P.deleteShader(Q),this.fixedUniforms=y(n),this.binderUniforms=_?_.getUniforms(n):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(ie=>({u_instanceID:new i.bM(ie)}))(n)),(w.includes("TERRAIN")||s.indexOf("symbol")!==-1||s.indexOf("circle")!==-1)&&(this.terrainUniforms=(ie=>({u_dem:new i.bM(ie),u_dem_prev:new i.bM(ie),u_dem_tl:new i.bJ(ie),u_dem_scale:new i.bL(ie),u_dem_tl_prev:new i.bJ(ie),u_dem_scale_prev:new i.bL(ie),u_dem_size:new i.bL(ie),u_dem_lerp:new i.bL(ie),u_exaggeration:new i.bL(ie),u_depth:new i.bM(ie),u_depth_size_inv:new i.bJ(ie),u_depth_range_unpack:new i.bJ(ie),u_occluder_half_size:new i.bL(ie),u_occlusion_depth_offset:new i.bL(ie),u_meter_to_dem:new i.bL(ie),u_label_plane_matrix_inv:new i.bI(ie)}))(n)),w.includes("GLOBE")&&(this.globeUniforms=(ie=>({u_tile_tl_up:new i.bK(ie),u_tile_tr_up:new i.bK(ie),u_tile_br_up:new i.bK(ie),u_tile_bl_up:new i.bK(ie),u_tile_up_scale:new i.bL(ie)}))(n)),w.includes("FOG")&&(this.fogUniforms=(ie=>({u_fog_matrix:new i.bI(ie),u_fog_range:new i.bJ(ie),u_fog_color:new i.c9(ie),u_fog_horizon_blend:new i.bL(ie),u_fog_vertical_limit:new i.bJ(ie),u_fog_temporal_offset:new i.bL(ie),u_frustum_tl:new i.bK(ie),u_frustum_tr:new i.bK(ie),u_frustum_br:new i.bK(ie),u_frustum_bl:new i.bK(ie),u_globe_pos:new i.bK(ie),u_globe_radius:new i.bL(ie),u_globe_transition:new i.bL(ie),u_is_globe:new i.bM(ie),u_viewport:new i.bJ(ie)}))(n)),w.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(ie=>({u_cutoff_params:new i.c9(ie)}))(n)),w.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(ie=>({u_lighting_ambient_color:new i.bK(ie),u_lighting_directional_dir:new i.bK(ie),u_lighting_directional_color:new i.bK(ie),u_ground_radiance:new i.bK(ie)}))(n)),w.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(ie=>({u_light_matrix_0:new i.bI(ie),u_light_matrix_1:new i.bI(ie),u_fade_range:new i.bJ(ie),u_shadow_normal_offset:new i.bK(ie),u_shadow_intensity:new i.bL(ie),u_shadow_texel_size:new i.bL(ie),u_shadow_map_resolution:new i.bL(ie),u_shadow_direction:new i.bK(ie),u_shadow_bias:new i.bK(ie),u_shadowmap_0:new i.bM(ie),u_shadowmap_1:new i.bM(ie)}))(n))}}setTerrainUniformValues(n,s){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const _ in s)p[_]&&p[_].set(this.program,_,s[_])}}setGlobeUniformValues(n,s){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const _ in s)p[_]&&p[_].set(this.program,_,s[_])}}setFogUniformValues(n,s){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const _ in s)p[_].set(this.program,_,s[_])}}setCutoffUniformValues(n,s){if(!this.cutoffUniforms)return;const p=this.cutoffUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const _ in s)p[_].set(this.program,_,s[_])}}setLightsUniformValues(n,s){if(!this.lightsUniforms)return;const p=this.lightsUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const _ in s)p[_].set(this.program,_,s[_])}}setShadowUniformValues(n,s){if(this.failedToCreate||!this.shadowUniforms)return;const p=this.shadowUniforms;n.program.set(this.program);for(const _ in s)p[_].set(this.program,_,s[_])}_drawDebugWireframe(n,s,p,_,y,w,P,z,k,D){const j=n.options.wireframe;if(j.terrain===!1&&j.layers2D===!1&&j.layers3D===!1)return;const B=n.context;if(!(()=>!(!j.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!j.layers2D||n._terrain&&n._terrain.renderingToTexture||!_0.includes(this.name))||!(!j.layers3D||!lh.includes(this.name)))())return;const G=B.gl,Q=n.wireframeDebugCache.getLinesFromTrianglesBuffer(n.frameCounter,y,B);if(!Q)return;const J=[...this.fixedDefines];J.push("DEBUG_WIREFRAME");const ie=n.getOrCreateProgram(this.name,{config:this.configuration,defines:J});B.program.set(ie.program);const oe=(be,Pe,Me)=>{if(Pe[be]&&Me[be])for(const Ie in Pe[be])Me[be][Ie]&&Me[be][Ie].set(Me.program,Ie,Pe[be][Ie].current)};k&&k.setUniforms(ie.program,B,ie.binderUniforms,P,{zoom:z}),oe("fixedUniforms",this,ie),oe("terrainUniforms",this,ie),oe("globeUniforms",this,ie),oe("fogUniforms",this,ie),oe("lightsUniforms",this,ie),oe("shadowUniforms",this,ie),Q.bind(),B.setColorMode(new Br([G.ONE,G.ONE_MINUS_SRC_ALPHA,G.ZERO,G.ONE],i.ai.transparent,[!0,!0,!0,!1])),B.setDepthMode(new ir(s.func===G.LESS?G.LEQUAL:s.func,ir.ReadOnly,s.range)),B.setStencilMode(Cr.disabled);const me=3*w.primitiveLength*2,Se=3*w.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const be=D||1;for(let Pe=0;Pe<be;++Pe)ie.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Pe),G.drawElements(G.LINES,me,G.UNSIGNED_SHORT,Se)}else D&&D>1?G.drawElementsInstanced(G.LINES,me,G.UNSIGNED_SHORT,Se,D):G.drawElements(G.LINES,me,G.UNSIGNED_SHORT,Se);y.bind(),B.program.set(this.program),B.setDepthMode(s),B.setStencilMode(p),B.setColorMode(_)}checkUniforms(n,s,p){if(this.fixedDefines.includes(s)){for(const _ of Object.keys(p))if(!p[_].initialized)throw new Error(`Program '${this.name}', from draw '${n}': uniform ${_} not set but required by ${s} being defined`)}}draw(n,s,p,_,y,w,P,z,k,D,j,B,G,Q,J,ie){const oe=n.context,me=oe.gl;if(this.failedToCreate)return;oe.program.set(this.program),oe.setDepthMode(p),oe.setStencilMode(_),oe.setColorMode(y),oe.setCullFace(w);for(const Pe of Object.keys(this.fixedUniforms))this.fixedUniforms[Pe].set(this.program,Pe,P[Pe]);Q&&Q.setUniforms(this.program,oe,this.binderUniforms,B,{zoom:G});const Se={[me.POINTS]:1,[me.LINES]:2,[me.TRIANGLES]:3,[me.LINE_STRIP]:1}[s];this.checkUniforms(z,"RENDER_SHADOWS",this.shadowUniforms);const be=ie&&ie>0?1:void 0;for(const Pe of j.get()){const Me=Pe.vaos||(Pe.vaos={});if((Me[z]||(Me[z]=new ih)).bind(oe,this,k,Q?Q.getPaintVertexBuffers():[],D,Pe.vertexOffset,J||[],be),this.forceManualRenderingForInstanceIDShaders){const Ie=ie||1;for(let Ce=0;Ce<Ie;++Ce)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ce),D?me.drawElements(s,Pe.primitiveLength*Se,me.UNSIGNED_SHORT,Pe.primitiveOffset*Se*2):me.drawArrays(s,Pe.vertexOffset,Pe.vertexLength)}else ie&&ie>1?me.drawElementsInstanced(s,Pe.primitiveLength*Se,me.UNSIGNED_SHORT,Pe.primitiveOffset*Se*2,ie):D?me.drawElements(s,Pe.primitiveLength*Se,me.UNSIGNED_SHORT,Pe.primitiveOffset*Se*2):me.drawArrays(s,Pe.vertexOffset,Pe.vertexLength);s===me.TRIANGLES&&D&&this._drawDebugWireframe(n,p,_,y,D,Pe,B,G,Q,ie)}}}function v0(f,n){const s=Math.pow(2,n.tileID.overscaledZ),p=n.tileSize*Math.pow(2,f.transform.tileZoom)/s,_=p*(n.tileID.canonical.x+n.tileID.wrap*s),y=p*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture?n.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/i.aq(n,1,f.transform.tileZoom),u_pixel_coord_upper:[_>>16,y>>16],u_pixel_coord_lower:[65535&_,65535&y]}}const ch={terrain:0,flat:1},Gx=i.aa.mat4.create(),Fd=(f,n,s,p,_,y,w,P,z,k,D,j,B,G,Q,J,ie,oe)=>{const me=n.style.light,Se=me.properties.get("position"),be=[Se.x,Se.y,Se.z],Pe=i.aa.mat3.create();me.properties.get("anchor")==="viewport"&&(i.aa.mat3.fromRotation(Pe,-n.transform.angle),i.aa.vec3.transformMat3(be,be,Pe));const Me=me.properties.get("color"),Ie=n.transform,Ce={u_matrix:f,u_lightpos:be,u_lightintensity:me.properties.get("intensity"),u_lightcolor:[Me.r,Me.g,Me.b],u_vertical_gradient:+s,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Gx,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:ch[k],u_base_type:ch[D],u_ao:_,u_edge_radius:y,u_width_scale:w,u_flood_light_color:Q,u_vertical_scale:J,u_flood_light_intensity:ie,u_ground_shadow_factor:oe};return Ie.projection.name==="globe"&&(Ce.u_tile_id=[P.canonical.x,P.canonical.y,1<<P.canonical.z],Ce.u_zoom_transition=j,Ce.u_inv_rot_matrix=G,Ce.u_merc_center=B,Ce.u_up_dir=Ie.projection.upVector(new i.bS(0,0,0),B[0]*i.af,B[1]*i.af),Ce.u_height_lift=z),Ce},Bd=(f,n,s,p,_,y)=>({u_matrix:f,u_edge_radius:n,u_width_scale:s,u_vertical_scale:p,u_height_type:ch[_],u_base_type:ch[y]}),uh=(f,n,s,p,_,y,w,P,z,k,D,j,B,G,Q,J,ie)=>{const oe=Fd(f,n,s,p,_,y,w,P,k,D,j,B,G,Q,J,ie,1,[0,0,0]),me={u_height_factor:-Math.pow(2,P.overscaledZ)/z.tileSize/8};return i.l(oe,v0(n,z),me)},Nd=(f,n)=>({u_matrix:f,u_emissive_strength:n}),Uc=(f,n,s,p)=>i.l(Nd(f,n),v0(s,p)),x0=(f,n,s)=>({u_matrix:f,u_world:s,u_emissive_strength:n}),jd=(f,n,s,p,_)=>i.l(Uc(f,n,s,p),{u_world:_}),$d=(f,n,s,p)=>{const _=i.af/s.tileSize;return{u_matrix:f,u_camera_to_center_distance:n.getCameraToCenterDistance(p),u_extrude_scale:[n.pixelsToGLUnits[0]/_,n.pixelsToGLUnits[1]/_]}},Vd=(f,n,s=1)=>({u_matrix:f,u_color:n.toRenderColor(null),u_overlay:0,u_overlay_scale:s}),b0=i.aa.mat4.create(),Hx=(f,n,s,p,_,y,w)=>{const P=f.transform,z=P.projection.name==="globe",k=z?i.cM(P.zoom,n.canonical)*P._pixelsPerMercatorPixel:i.aq(s,1,y),D={u_matrix:n.projMatrix,u_extrude_scale:k,u_intensity:w,u_inv_rot_matrix:b0,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(z){D.u_inv_rot_matrix=p,D.u_merc_center=_,D.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],D.u_zoom_transition=i.ad(P.zoom);const j=_[0]*i.af,B=_[1]*i.af;D.u_up_dir=P.projection.upVector(new i.bS(0,0,0),j,B)}return D};function rc(f,[n,s,p,_],[y,w]){if(y===w)return[0,0,0,0];const P=255*(f-1)/(f*(w-y));return[n*P,s*P,p*P,_*P]}function hh(f,n,[s,p]){return s===p?0:.5/f+(n-s)*(f-1)/(f*(p-s))}const Yt=(f,n,s,p,_,y,w,P,z,k,D,j,B,G,Q,J,ie,oe,me,Se,be)=>({u_matrix:f,u_normalize_matrix:n,u_globe_matrix:s,u_merc_matrix:p,u_grid_matrix:_,u_tl_parent:y,u_scale_parent:k,u_fade_t:D.mix,u_opacity:D.opacity*j.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:j.paint.get("raster-brightness-min"),u_brightness_high:j.paint.get("raster-brightness-max"),u_saturation_factor:i.cN(j.paint.get("raster-saturation")),u_contrast_factor:i.cO(j.paint.get("raster-contrast")),u_spin_weights:w0(j.paint.get("raster-hue-rotate")),u_perspective_transform:B,u_raster_elevation:G,u_zoom_transition:w,u_merc_center:P,u_cutoff_params:z,u_colorization_mix:rc(i.cP,J,oe),u_colorization_offset:hh(i.cP,ie,oe),u_color_ramp:Q,u_texture_offset:[Se/(me+2*Se),me/(me+2*Se)],u_texture_res:[me+2*Se,me+2*Se],u_emissive_strength:be});function w0(f){f*=Math.PI/180;const n=Math.sin(f),s=Math.cos(f);return[(2*s+1)/3,(-Math.sqrt(3)*n-s+1)/3,(Math.sqrt(3)*n-s+1)/3]}const nc=.05,ic=(f,n,s,p,_,y,w,P,z,k,D,j)=>({u_matrix:f,u_normalize_matrix:n,u_globe_matrix:s,u_merc_matrix:p,u_grid_matrix:_,u_tl_parent:y,u_scale_parent:k,u_fade_t:D.mix,u_opacity:D.opacity,u_image0:0,u_image1:1,u_raster_elevation:j,u_zoom_transition:w,u_merc_center:P,u_cutoff_params:z}),oc=(f,n,s,p,_,y,w,P,z,k)=>({u_particle_texture:f,u_particle_texture_side_len:n,u_tile_offset:s,u_velocity:p,u_color_ramp:y,u_velocity_res:_,u_max_speed:w,u_uv_offset:P,u_data_scale:[255*z[0],255*z[1]],u_data_offset:k,u_particle_pos_scale:1.1,u_particle_pos_offset:[nc,nc]}),nr=(f,n,s,p,_,y,w,P,z,k)=>({u_particle_texture:f,u_particle_texture_side_len:n,u_velocity:s,u_velocity_res:p,u_max_speed:_,u_speed_factor:y,u_reset_rate:w,u_rand_seed:Math.random(),u_uv_offset:P,u_data_scale:[255*z[0],255*z[1]],u_data_offset:k,u_particle_pos_scale:1.1,u_particle_pos_offset:[nc,nc]}),Ud=i.aa.mat4.create(),S0=(f,n,s,p,_,y,w,P,z,k,D,j,B,G,Q,J,ie,oe,me,Se,be,Pe)=>{const Me=_.transform,Ie={u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:Me.getCameraToCenterDistance(me),u_rotate_symbol:+s,u_aspect_ratio:Me.width/Me.height,u_fade_change:_.options.fadeDuration?_.symbolFadeChange:1,u_matrix:y,u_label_plane_matrix:w,u_coord_matrix:P,u_is_text:+k,u_elevation_from_sea:z?1:0,u_pitch_with_map:+p,u_texsize:D,u_texsize_icon:j,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ud,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Ud,u_up_vector:[0,-1,0],u_color_adj_mat:Se,u_icon_transition:be||0,u_gamma_scale:p?_.transform.getCameraToCenterDistance(me)*Math.cos(_.terrain?0:_.transform._pitch):1,u_device_pixel_ratio:i.q.devicePixelRatio,u_is_halo:+B,u_scale_factor:Pe||1};return me.name==="globe"&&(Ie.u_tile_id=[G.canonical.x,G.canonical.y,1<<G.canonical.z],Ie.u_zoom_transition=Q,Ie.u_inv_rot_matrix=ie,Ie.u_merc_center=J,Ie.u_camera_forward=Me._camera.forward(),Ie.u_ecef_origin=i.cQ(Me.globeMatrix,G.toUnwrapped()),Ie.u_tile_matrix=Float32Array.from(Me.globeMatrix),Ie.u_up_vector=oe),Ie},E0=(f,n,s,p)=>({u_matrix:f,u_emissive_strength:n,u_opacity:s,u_color:p}),Gd=(f,n,s,p,_,y,w,P,z)=>i.l(function(k,D,j,B,G,Q){const{width:J,height:ie}=B.imageManager.getPixelSize(D),oe=Math.pow(2,Q.tileID.overscaledZ),me=Q.tileSize*Math.pow(2,B.transform.tileZoom)/oe,Se=me*(Q.tileID.canonical.x+Q.tileID.wrap*oe),be=me*Q.tileID.canonical.y;return{u_image:0,u_pattern_tl:j.tl,u_pattern_br:j.br,u_texsize:[J,ie],u_pattern_size:j.displaySize,u_pattern_units_to_pixels:G?[B.transform.width,-1*B.transform.height]:[1/i.aq(Q,1,B.transform.tileZoom),1/i.aq(Q,1,B.transform.tileZoom)],u_pixel_coord_upper:[Se>>16,be>>16],u_pixel_coord_lower:[65535&Se,65535&be]}}(0,y,w,p,P,z),{u_matrix:f,u_emissive_strength:n,u_opacity:s}),Hd=new Float32Array(i.aa.mat4.identity([])),Wd=(f,n,s,p,_,y,w,P,z,k,D,j,B,G=[0,0,0],Q)=>{const J=_.style.light,ie=J.properties.get("position"),oe=[-ie.x,-ie.y,ie.z],me=i.aa.mat3.create();J.properties.get("anchor")==="viewport"&&(i.aa.mat3.fromRotation(me,-_.transform.angle),i.aa.vec3.transformMat3(oe,oe,me));const Se=D.alphaMode==="MASK",be=J.properties.get("color").toRenderColor(null),Pe=B.paint.get("model-ambient-occlusion-intensity"),Me=B.paint.get("model-color").constantOr(i.ai.white).toRenderColor(null),Ie=B.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:f,u_lighting_matrix:n,u_normal_matrix:s,u_node_matrix:p||Hd,u_lightpos:oe,u_lightintensity:J.properties.get("intensity"),u_lightcolor:[be.r,be.g,be.b],u_camera_pos:G,u_opacity:y,u_baseTextureIsAlpha:0,u_alphaMask:+Se,u_alphaCutoff:D.alphaCutoff,u_baseColorFactor:[w.r,w.g,w.b,w.a],u_emissiveFactor:[P[0],P[1],P[2],1],u_metallicFactor:z,u_roughnessFactor:k,u_baseColorTexture:to.BaseColor,u_metallicRoughnessTexture:to.MetallicRoughness,u_normalTexture:to.Normal,u_occlusionTexture:to.Occlusion,u_emissionTexture:to.Emission,u_lutTexture:to.LUT,u_color_mix:[Me.r,Me.g,Me.b,Ie],u_aoIntensity:Pe,u_emissive_strength:j,u_occlusionTextureTransform:Q||[0,0,0,0]}},T0=(f,n=Hd,s=Hd)=>({u_matrix:f,u_instance:n,u_node_matrix:s}),Wx={fillExtrusion:f=>({u_matrix:new i.bI(f),u_lightpos:new i.bK(f),u_lightintensity:new i.bL(f),u_lightcolor:new i.bK(f),u_vertical_gradient:new i.bL(f),u_opacity:new i.bL(f),u_edge_radius:new i.bL(f),u_width_scale:new i.bL(f),u_ao:new i.bJ(f),u_height_type:new i.bM(f),u_base_type:new i.bM(f),u_tile_id:new i.bK(f),u_zoom_transition:new i.bL(f),u_inv_rot_matrix:new i.bI(f),u_merc_center:new i.bJ(f),u_up_dir:new i.bK(f),u_height_lift:new i.bL(f),u_flood_light_color:new i.bK(f),u_vertical_scale:new i.bL(f),u_flood_light_intensity:new i.bL(f),u_ground_shadow_factor:new i.bK(f)}),fillExtrusionDepth:f=>({u_matrix:new i.bI(f),u_edge_radius:new i.bL(f),u_width_scale:new i.bL(f),u_vertical_scale:new i.bL(f),u_height_type:new i.bM(f),u_base_type:new i.bM(f)}),fillExtrusionPattern:f=>({u_matrix:new i.bI(f),u_lightpos:new i.bK(f),u_lightintensity:new i.bL(f),u_lightcolor:new i.bK(f),u_vertical_gradient:new i.bL(f),u_height_factor:new i.bL(f),u_edge_radius:new i.bL(f),u_width_scale:new i.bL(f),u_ao:new i.bJ(f),u_height_type:new i.bM(f),u_base_type:new i.bM(f),u_tile_id:new i.bK(f),u_zoom_transition:new i.bL(f),u_inv_rot_matrix:new i.bI(f),u_merc_center:new i.bJ(f),u_up_dir:new i.bK(f),u_height_lift:new i.bL(f),u_image:new i.bM(f),u_texsize:new i.bJ(f),u_pixel_coord_upper:new i.bJ(f),u_pixel_coord_lower:new i.bJ(f),u_tile_units_to_pixels:new i.bL(f),u_opacity:new i.bL(f)}),fillExtrusionGroundEffect:f=>({u_matrix:new i.bI(f),u_opacity:new i.bL(f),u_ao_pass:new i.bL(f),u_meter_to_tile:new i.bL(f),u_ao:new i.bJ(f),u_flood_light_intensity:new i.bL(f),u_flood_light_color:new i.bK(f),u_attenuation:new i.bL(f),u_edge_radius:new i.bL(f),u_fb:new i.bM(f),u_fb_size:new i.bL(f),u_dynamic_offset:new i.bL(f)}),fill:f=>({u_matrix:new i.bI(f),u_emissive_strength:new i.bL(f)}),fillPattern:f=>({u_matrix:new i.bI(f),u_emissive_strength:new i.bL(f),u_image:new i.bM(f),u_texsize:new i.bJ(f),u_pixel_coord_upper:new i.bJ(f),u_pixel_coord_lower:new i.bJ(f),u_tile_units_to_pixels:new i.bL(f)}),fillOutline:f=>({u_matrix:new i.bI(f),u_emissive_strength:new i.bL(f),u_world:new i.bJ(f)}),fillOutlinePattern:f=>({u_matrix:new i.bI(f),u_emissive_strength:new i.bL(f),u_world:new i.bJ(f),u_image:new i.bM(f),u_texsize:new i.bJ(f),u_pixel_coord_upper:new i.bJ(f),u_pixel_coord_lower:new i.bJ(f),u_tile_units_to_pixels:new i.bL(f)}),circle:i.cR,collisionBox:f=>({u_matrix:new i.bI(f),u_camera_to_center_distance:new i.bL(f),u_extrude_scale:new i.bJ(f)}),collisionCircle:f=>({u_matrix:new i.bI(f),u_inv_matrix:new i.bI(f),u_camera_to_center_distance:new i.bL(f),u_viewport_size:new i.bJ(f)}),debug:f=>({u_color:new i.cy(f),u_matrix:new i.bI(f),u_overlay:new i.bM(f),u_overlay_scale:new i.bL(f)}),clippingMask:f=>({u_matrix:new i.bI(f)}),heatmap:f=>({u_extrude_scale:new i.bL(f),u_intensity:new i.bL(f),u_matrix:new i.bI(f),u_inv_rot_matrix:new i.bI(f),u_merc_center:new i.bJ(f),u_tile_id:new i.bK(f),u_zoom_transition:new i.bL(f),u_up_dir:new i.bK(f)}),heatmapTexture:f=>({u_image:new i.bM(f),u_color_ramp:new i.bM(f),u_opacity:new i.bL(f)}),hillshade:f=>({u_matrix:new i.bI(f),u_image:new i.bM(f),u_latrange:new i.bJ(f),u_light:new i.bJ(f),u_shadow:new i.cy(f),u_highlight:new i.cy(f),u_emissive_strength:new i.bL(f),u_accent:new i.cy(f)}),hillshadePrepare:f=>({u_matrix:new i.bI(f),u_image:new i.bM(f),u_dimension:new i.bJ(f),u_zoom:new i.bL(f)}),line:i.cS,linePattern:i.cT,raster:f=>({u_matrix:new i.bI(f),u_normalize_matrix:new i.bI(f),u_globe_matrix:new i.bI(f),u_merc_matrix:new i.bI(f),u_grid_matrix:new i.cz(f),u_tl_parent:new i.bJ(f),u_scale_parent:new i.bL(f),u_fade_t:new i.bL(f),u_opacity:new i.bL(f),u_image0:new i.bM(f),u_image1:new i.bM(f),u_brightness_low:new i.bL(f),u_brightness_high:new i.bL(f),u_saturation_factor:new i.bL(f),u_contrast_factor:new i.bL(f),u_spin_weights:new i.bK(f),u_perspective_transform:new i.bJ(f),u_raster_elevation:new i.bL(f),u_zoom_transition:new i.bL(f),u_merc_center:new i.bJ(f),u_cutoff_params:new i.c9(f),u_colorization_mix:new i.c9(f),u_colorization_offset:new i.bL(f),u_color_ramp:new i.bM(f),u_texture_offset:new i.bJ(f),u_texture_res:new i.bJ(f),u_emissive_strength:new i.bL(f)}),rasterParticle:f=>({u_matrix:new i.bI(f),u_normalize_matrix:new i.bI(f),u_globe_matrix:new i.bI(f),u_merc_matrix:new i.bI(f),u_grid_matrix:new i.cz(f),u_tl_parent:new i.bJ(f),u_scale_parent:new i.bL(f),u_fade_t:new i.bL(f),u_opacity:new i.bL(f),u_image0:new i.bM(f),u_image1:new i.bM(f),u_raster_elevation:new i.bL(f),u_zoom_transition:new i.bL(f),u_merc_center:new i.bJ(f),u_cutoff_params:new i.c9(f)}),rasterParticleTexture:f=>({u_texture:new i.bM(f),u_opacity:new i.bL(f)}),rasterParticleDraw:f=>({u_particle_texture:new i.bM(f),u_particle_texture_side_len:new i.bL(f),u_tile_offset:new i.bJ(f),u_velocity:new i.bM(f),u_color_ramp:new i.bM(f),u_velocity_res:new i.bJ(f),u_max_speed:new i.bL(f),u_uv_offset:new i.bJ(f),u_data_scale:new i.bJ(f),u_data_offset:new i.bL(f),u_particle_pos_scale:new i.bL(f),u_particle_pos_offset:new i.bJ(f)}),rasterParticleUpdate:f=>({u_particle_texture:new i.bM(f),u_particle_texture_side_len:new i.bL(f),u_velocity:new i.bM(f),u_velocity_res:new i.bJ(f),u_max_speed:new i.bL(f),u_speed_factor:new i.bL(f),u_reset_rate:new i.bL(f),u_rand_seed:new i.bL(f),u_uv_offset:new i.bJ(f),u_data_scale:new i.bJ(f),u_data_offset:new i.bL(f),u_particle_pos_scale:new i.bL(f),u_particle_pos_offset:new i.bJ(f)}),symbol:f=>({u_is_size_zoom_constant:new i.bM(f),u_is_size_feature_constant:new i.bM(f),u_size_t:new i.bL(f),u_size:new i.bL(f),u_camera_to_center_distance:new i.bL(f),u_rotate_symbol:new i.bM(f),u_aspect_ratio:new i.bL(f),u_fade_change:new i.bL(f),u_matrix:new i.bI(f),u_label_plane_matrix:new i.bI(f),u_coord_matrix:new i.bI(f),u_is_text:new i.bM(f),u_elevation_from_sea:new i.bM(f),u_pitch_with_map:new i.bM(f),u_texsize:new i.bJ(f),u_texsize_icon:new i.bJ(f),u_texture:new i.bM(f),u_texture_icon:new i.bM(f),u_gamma_scale:new i.bL(f),u_device_pixel_ratio:new i.bL(f),u_tile_id:new i.bK(f),u_zoom_transition:new i.bL(f),u_inv_rot_matrix:new i.bI(f),u_merc_center:new i.bJ(f),u_camera_forward:new i.bK(f),u_tile_matrix:new i.bI(f),u_up_vector:new i.bK(f),u_ecef_origin:new i.bK(f),u_is_halo:new i.bM(f),u_icon_transition:new i.bL(f),u_color_adj_mat:new i.bI(f),u_scale_factor:new i.bL(f)}),background:f=>({u_matrix:new i.bI(f),u_emissive_strength:new i.bL(f),u_opacity:new i.bL(f),u_color:new i.cy(f)}),backgroundPattern:f=>({u_matrix:new i.bI(f),u_emissive_strength:new i.bL(f),u_opacity:new i.bL(f),u_image:new i.bM(f),u_pattern_tl:new i.bJ(f),u_pattern_br:new i.bJ(f),u_texsize:new i.bJ(f),u_pattern_size:new i.bJ(f),u_pixel_coord_upper:new i.bJ(f),u_pixel_coord_lower:new i.bJ(f),u_pattern_units_to_pixels:new i.bJ(f)}),terrainRaster:f=>({u_matrix:new i.bI(f),u_image0:new i.bM(f),u_skirt_height:new i.bL(f),u_ground_shadow_factor:new i.bK(f)}),skybox:f=>({u_matrix:new i.bI(f),u_sun_direction:new i.bK(f),u_cubemap:new i.bM(f),u_opacity:new i.bL(f),u_temporal_offset:new i.bL(f)}),skyboxGradient:f=>({u_matrix:new i.bI(f),u_color_ramp:new i.bM(f),u_center_direction:new i.bK(f),u_radius:new i.bL(f),u_opacity:new i.bL(f),u_temporal_offset:new i.bL(f)}),skyboxCapture:f=>({u_matrix_3f:new i.cz(f),u_sun_direction:new i.bK(f),u_sun_intensity:new i.bL(f),u_color_tint_r:new i.c9(f),u_color_tint_m:new i.c9(f),u_luminance:new i.bL(f)}),globeRaster:f=>({u_proj_matrix:new i.bI(f),u_globe_matrix:new i.bI(f),u_normalize_matrix:new i.bI(f),u_merc_matrix:new i.bI(f),u_zoom_transition:new i.bL(f),u_merc_center:new i.bJ(f),u_image0:new i.bM(f),u_grid_matrix:new i.cz(f),u_skirt_height:new i.bL(f),u_far_z_cutoff:new i.bL(f),u_frustum_tl:new i.bK(f),u_frustum_tr:new i.bK(f),u_frustum_br:new i.bK(f),u_frustum_bl:new i.bK(f),u_globe_pos:new i.bK(f),u_globe_radius:new i.bL(f),u_viewport:new i.bJ(f)}),globeAtmosphere:f=>({u_frustum_tl:new i.bK(f),u_frustum_tr:new i.bK(f),u_frustum_br:new i.bK(f),u_frustum_bl:new i.bK(f),u_horizon:new i.bL(f),u_transition:new i.bL(f),u_fadeout_range:new i.bL(f),u_color:new i.c9(f),u_high_color:new i.c9(f),u_space_color:new i.c9(f),u_temporal_offset:new i.bL(f),u_horizon_angle:new i.bL(f)}),model:f=>({u_matrix:new i.bI(f),u_lighting_matrix:new i.bI(f),u_normal_matrix:new i.bI(f),u_node_matrix:new i.bI(f),u_lightpos:new i.bK(f),u_lightintensity:new i.bL(f),u_lightcolor:new i.bK(f),u_camera_pos:new i.bK(f),u_opacity:new i.bL(f),u_baseColorFactor:new i.c9(f),u_emissiveFactor:new i.c9(f),u_metallicFactor:new i.bL(f),u_roughnessFactor:new i.bL(f),u_baseTextureIsAlpha:new i.bM(f),u_alphaMask:new i.bM(f),u_alphaCutoff:new i.bL(f),u_baseColorTexture:new i.bM(f),u_metallicRoughnessTexture:new i.bM(f),u_normalTexture:new i.bM(f),u_occlusionTexture:new i.bM(f),u_emissionTexture:new i.bM(f),u_lutTexture:new i.bM(f),u_color_mix:new i.c9(f),u_aoIntensity:new i.bL(f),u_emissive_strength:new i.bL(f),u_occlusionTextureTransform:new i.c9(f)}),modelDepth:f=>({u_matrix:new i.bI(f),u_instance:new i.bI(f),u_node_matrix:new i.bI(f)}),groundShadow:f=>({u_matrix:new i.bI(f),u_ground_shadow_factor:new i.bK(f)}),stars:f=>({u_matrix:new i.bI(f),u_up:new i.bK(f),u_right:new i.bK(f),u_intensity_multiplier:new i.bL(f)}),snowParticle:f=>({u_modelview:new i.bI(f),u_projection:new i.bI(f),u_time:new i.bL(f),u_cam_pos:new i.bK(f),u_velocityConeAperture:new i.bL(f),u_velocity:new i.bL(f),u_horizontalOscillationRadius:new i.bL(f),u_horizontalOscillationRate:new i.bL(f),u_boxSize:new i.bL(f),u_billboardSize:new i.bL(f),u_simpleShapeParameters:new i.bJ(f),u_screenSize:new i.bJ(f),u_thinningCenterPos:new i.bJ(f),u_thinningShape:new i.bK(f),u_thinningAffectedRatio:new i.bL(f),u_thinningParticleOffset:new i.bL(f),u_particleColor:new i.c9(f),u_direction:new i.bK(f)}),rainParticle:f=>({u_modelview:new i.bI(f),u_projection:new i.bI(f),u_time:new i.bL(f),u_cam_pos:new i.bK(f),u_texScreen:new i.bM(f),u_velocityConeAperture:new i.bL(f),u_velocity:new i.bL(f),u_boxSize:new i.bL(f),u_rainDropletSize:new i.bJ(f),u_distortionStrength:new i.bL(f),u_rainDirection:new i.bK(f),u_color:new i.c9(f),u_screenSize:new i.bJ(f),u_thinningCenterPos:new i.bJ(f),u_thinningShape:new i.bK(f),u_thinningAffectedRatio:new i.bL(f),u_thinningParticleOffset:new i.bL(f),u_shapeDirectionalPower:new i.bL(f),u_shapeNormalPower:new i.bL(f),u_mode:new i.bL(f)}),vignette:f=>({u_vignetteShape:new i.bK(f),u_vignetteColor:new i.c9(f)}),occlusion:f=>({u_matrix:new i.bI(f),u_anchorPos:new i.bK(f),u_screenSizePx:new i.bJ(f),u_occluderSizePx:new i.bJ(f),u_color:new i.c9(f)})};class cs{constructor(n,s,p,_){this.id=cs.uniqueIdxCounter,cs.uniqueIdxCounter++,this.context=n;const y=n.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||_||s.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){this.id=cs.uniqueIdxCounter,cs.uniqueIdxCounter++;const s=this.context.gl;this.context.unbindVAO(),this.bind(),s.bufferSubData(s.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}cs.uniqueIdxCounter=0;const lm={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class cm{constructor(n,s,p,_,y,w){this.length=s.length,this.attributes=p,this.itemSize=s.bytesPerElement,this.dynamicDraw=_,this.instanceCount=w,this.context=n;const P=n.gl;this.buffer=P.createBuffer(),n.bindVertexBuffer.set(this.buffer),P.bufferData(P.ARRAY_BUFFER,s.arrayBuffer,this.dynamicDraw?P.DYNAMIC_DRAW:P.STATIC_DRAW),this.dynamicDraw||y||s.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){const s=this.context.gl;this.bind(),s.bufferSubData(s.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,s){for(let p=0;p<this.attributes.length;p++){const _=s.attributes[this.attributes[p].name];_!==void 0&&n.enableVertexAttribArray(_)}}setVertexAttribPointers(n,s,p){for(let _=0;_<this.attributes.length;_++){const y=this.attributes[_],w=s.attributes[y.name];w!==void 0&&n.vertexAttribPointer(w,y.components,n[lm[y.type]],!1,this.itemSize,y.offset+this.itemSize*(p||0))}}setVertexAttribDivisor(n,s,p){for(let _=0;_<this.attributes.length;_++){const y=s.attributes[this.attributes[_].name];y!==void 0&&this.instanceCount&&this.instanceCount>0&&n.vertexAttribDivisor(y,p)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class qd{constructor(n,s,p,_,y){this.context=n,this.width=s,this.height=p;const w=this.framebuffer=n.gl.createFramebuffer();_&&(this.colorAttachment=new im(n,w)),y&&(this.depthAttachmentType=y,this.depthAttachment=y==="renderbuffer"?new kd(n,w):new f0(n,w))}destroy(){const n=this.context.gl;if(this.colorAttachment){const s=this.colorAttachment.get();s&&n.deleteTexture(s)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const s=this.depthAttachment.get();s&&n.deleteRenderbuffer(s)}else{const s=this.depthAttachment.get();s&&n.deleteTexture(s)}n.deleteFramebuffer(this.framebuffer)}}class Jo{constructor(n,s){this.gl=n,this.clearColor=new kx(this),this.clearDepth=new Dx(this),this.clearStencil=new Ox(this),this.colorMask=new Zp(this),this.depthMask=new Xp(this),this.stencilMask=new Yp(this),this.stencilFunc=new Kp(this),this.stencilOp=new l0(this),this.stencilTest=new c0(this),this.depthRange=new Fx(this),this.depthTest=new oh(this),this.depthFunc=new ah(this),this.blend=new u0(this),this.blendFunc=new Ko(this),this.blendColor=new Jp(this),this.blendEquation=new Ad(this),this.cullFace=new Rd(this),this.cullFaceSide=new Qp(this),this.frontFace=new em(this),this.program=new zd(this),this.activeTexture=new tm(this),this.viewport=new rm(this),this.bindFramebuffer=new Ld(this),this.bindRenderbuffer=new h0(this),this.bindTexture=new d0(this),this.bindVertexBuffer=new jc(this),this.bindElementBuffer=new Bx(this),this.bindVertexArrayOES=new Nx(this),this.pixelStoreUnpack=new jx(this),this.pixelStoreUnpackPremultiplyAlpha=new $x(this),this.pixelStoreUnpackFlipY=new Vx(this),this.options=s?{...s}:{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=n.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=n.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=n.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=s&&!!s.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=n.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),this.maxPointSize=n.getParameter(n.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,s,p){return new cs(this,n,s,p)}createVertexBuffer(n,s,p,_,y){return new cm(this,n,s,p,_,y)}createRenderbuffer(n,s,p){const _=this.gl,y=_.createRenderbuffer();return this.bindRenderbuffer.set(y),_.renderbufferStorage(_.RENDERBUFFER,n,s,p),this.bindRenderbuffer.set(null),y}createFramebuffer(n,s,p,_){return new qd(this,n,s,p,_)}clear({color:n,depth:s,stencil:p,colorMask:_}){const y=this.gl;let w=0;n&&(w|=y.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set(_||[!0,!0,!0,!0])),s!==void 0&&(w|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(s),this.depthMask.set(!0)),p!==void 0&&(w|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),y.clear(w)}setCullFace(n){n.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){i.bm(n.blendFunction,Br.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor),n.blendEquation?this.blendEquation.set(n.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(n.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let Fa;function um(f,n,s,p,_,y,w){const P=f.context,z=P.gl,k=f.transform,D=f.getOrCreateProgram("collisionBox"),j=[];let B=0,G=0;for(let be=0;be<p.length;be++){const Pe=p[be],Me=n.getTile(Pe),Ie=Me.getBucket(s);if(!Ie)continue;const Ce=yi(Pe,Ie,k);let De=Ce;_[0]===0&&_[1]===0||(De=f.translatePosMatrix(Ce,Me,_,y));const $e=w?Ie.textCollisionBox:Ie.iconCollisionBox,at=Ie.collisionCircleArray;if(at.length>0){const rt=i.aa.mat4.create(),je=De;i.aa.mat4.mul(rt,Ie.placementInvProjMatrix,k.glCoordMatrix),i.aa.mat4.mul(rt,rt,Ie.placementViewportMatrix),j.push({circleArray:at,circleOffset:G,transform:je,invTransform:rt,projection:Ie.getProjection()}),B+=at.length/4,G=B}$e&&(f.terrain&&f.terrain.setupElevationDraw(Me,D),D.draw(f,z.LINES,ir.disabled,Cr.disabled,f.colorModeForRenderPass(),mr.disabled,$d(De,k,Me,Ie.getProjection()),s.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,null,k.zoom,null,[$e.collisionVertexBuffer,$e.collisionVertexBufferExt]))}if(!w||!j.length)return;const Q=f.getOrCreateProgram("collisionCircle"),J=new i.cU;J.resize(4*B),J._trim();let ie=0;for(const be of j)for(let Pe=0;Pe<be.circleArray.length/4;Pe++){const Me=4*Pe,Ie=be.circleArray[Me+0],Ce=be.circleArray[Me+1],De=be.circleArray[Me+2],$e=be.circleArray[Me+3];J.emplace(ie++,Ie,Ce,De,$e,0),J.emplace(ie++,Ie,Ce,De,$e,1),J.emplace(ie++,Ie,Ce,De,$e,2),J.emplace(ie++,Ie,Ce,De,$e,3)}(!Fa||Fa.length<2*B)&&(Fa=function(be){const Pe=2*be,Me=new i.aT;Me.resize(Pe),Me._trim();for(let Ie=0;Ie<Pe;Ie++){const Ce=6*Ie;Me.uint16[Ce+0]=4*Ie+0,Me.uint16[Ce+1]=4*Ie+1,Me.uint16[Ce+2]=4*Ie+2,Me.uint16[Ce+3]=4*Ie+2,Me.uint16[Ce+4]=4*Ie+3,Me.uint16[Ce+5]=4*Ie+0}return Me}(B));const oe=P.createIndexBuffer(Fa,!0),me=P.createVertexBuffer(J,i.cV.members,!0);for(const be of j){const Pe={u_matrix:be.transform,u_inv_matrix:be.invTransform,u_camera_to_center_distance:(Se=k).getCameraToCenterDistance(be.projection),u_viewport_size:[Se.width,Se.height]};Q.draw(f,z.TRIANGLES,ir.disabled,Cr.disabled,f.colorModeForRenderPass(),mr.disabled,Pe,s.id,me,oe,i.b6.simpleSegment(0,2*be.circleOffset,be.circleArray.length,be.circleArray.length/2),null,k.zoom)}var Se;me.destroy(),oe.destroy()}const Gc=i.aa.mat4.create();function Zd(f){const n=f._camera.getWorldToCamera(f.worldSize,1),s=i.aa.mat4.multiply([],n,f.globeMatrix);i.aa.mat4.invert(s,s);const p=[0,0,0],_=[0,1,0,0];return i.aa.vec4.transformMat4(_,_,s),p[0]=_[0],p[1]=_[1],p[2]=_[2],i.aa.vec3.normalize(p,p),p}function hm({width:f,height:n,anchor:s,textOffset:p,textScale:_},y){const{horizontalAlign:w,verticalAlign:P}=i.bC(s),z=-(w-.5)*f,k=-(P-.5)*n,D=i.bB(s,p);return new i.P((z/_+D[0])*y,(k/_+D[1])*y)}function C0(f,n,s,p,_,y,w,P,z,k,D){const j=f.text.placedSymbolArray,B=f.text.dynamicLayoutVertexArray,G=f.icon.dynamicLayoutVertexArray,Q={},J=f.getProjection(),ie=Yu(P,J,y),oe=y.elevation,me=J.upVectorScale(P.canonical,y.center.lat,y.worldSize).metersToTile;B.clear();for(let Se=0;Se<j.length;Se++){const be=j.get(Se),{tileAnchorX:Pe,tileAnchorY:Me,numGlyphs:Ie}=be,Ce=be.hidden||!be.crossTileID||f.allowVerticalPlacement&&!be.placedOrientation?null:p[be.crossTileID];if(Ce){let De=0,$e=0,at=0;if(oe){const st=oe?oe.getAtTileOffset(P,Pe,Me):0,[Rt,bt,gt]=J.upVector(P.canonical,Pe,Me);De=st*Rt*me,$e=st*bt*me,at=st*gt*me}let[rt,je,qe,mt]=kn(be.projectedAnchorX+De,be.projectedAnchorY+$e,be.projectedAnchorZ+at,s?ie:w);const Tt=Z_(y.getCameraToCenterDistance(J),mt);let Lt=_.evaluateSizeForFeature(f.textSizeData,k,be)*Tt/i.bv;s&&(Lt*=f.tilePixelRatio/z);const et=hm(Ce,Lt);s?({x:rt,y:je,z:qe}=J.projectTilePoint(Pe+et.x,Me+et.y,P.canonical),[rt,je,qe]=kn(rt+De,je+$e,qe+at,w)):(n&&et._rotate(-y.angle),rt+=et.x,je+=et.y,qe=0);const xt=f.allowVerticalPlacement&&be.placedOrientation===i.bp.vertical?Math.PI/2:0;for(let st=0;st<Ie;st++)i.bs(B,rt,je,qe,xt);D&&be.associatedIconIndex>=0&&(Q[be.associatedIconIndex]={x:rt,y:je,z:qe,angle:xt})}else Yl(Ie,B)}if(D){G.clear();const Se=f.icon.placedSymbolArray;for(let be=0;be<Se.length;be++){const Pe=Se.get(be),{numGlyphs:Me}=Pe,Ie=Q[be];if(Pe.hidden||!Ie)Yl(Me,G);else{const{x:Ce,y:De,z:$e,angle:at}=Ie;for(let rt=0;rt<Me;rt++)i.bs(G,Ce,De,$e,at)}}f.icon.dynamicLayoutVertexBuffer.updateData(G)}f.text.dynamicLayoutVertexBuffer.updateData(B)}function Qo(f,n,s,p,_,y,w={}){const P=s.paint.get("icon-translate"),z=s.paint.get("text-translate"),k=s.paint.get("icon-translate-anchor"),D=s.paint.get("text-translate-anchor"),j=s.layout.get("icon-rotation-alignment"),B=s.layout.get("text-rotation-alignment"),G=s.layout.get("icon-pitch-alignment"),Q=s.layout.get("text-pitch-alignment"),J=s.layout.get("icon-keep-upright"),ie=s.layout.get("text-keep-upright"),oe=s.paint.get("icon-color-saturation"),me=s.paint.get("icon-color-contrast"),Se=s.paint.get("icon-color-brightness-min"),be=s.paint.get("icon-color-brightness-max"),Pe=s.layout.get("symbol-elevation-reference")==="sea",Me=f.context,Ie=Me.gl,Ce=f.transform,De=j==="map",$e=B==="map",at=G==="map",rt=Q==="map",je=s.layout.get("symbol-sort-key").constantOr(1)!==void 0;let qe=!1;const mt=f.depthModeForSublayer(0,ir.ReadOnly),Tt=[i.as(Ce.center.lng),i.az(Ce.center.lat)],Lt=s.layout.get("text-variable-anchor"),et=Ce.projection.name==="globe",xt=[],st=[0,-1,0];for(const Rt of p){const bt=n.getTile(Rt),gt=bt.getBucket(s);if(!gt||gt.projection.name==="mercator"&&et||gt.fullyClipped)continue;const jt=gt.projection.name==="globe",Vt=jt?i.ad(Ce.zoom):0,Bt=Yu(Rt,gt.getProjection(),Ce),Zt=Ce.calculatePixelsToTileUnitsMatrix(bt),wr=Lt&&gt.hasTextData(),lr=gt.hasIconTextFit()&&wr&&gt.hasIconData(),sr=gt.getProjection().createInversionMatrix(Ce,Rt.canonical),Er=pr=>{Ce.depthOcclusionForSymbolsAndCircles&&(s.hasInitialOcclusionOpacityProperties||f.terrain)&&(pr.push("DEPTH_D24"),pr.push("DEPTH_OCCLUSION"))},Jr=()=>{const pr=De&&s.layout.get("symbol-placement")!=="point",an=[];Er(an);const ei=pr||lr,$i=s.paint.get("icon-image-cross-fade").constantOr(0);f.terrainRenderModeElevated()&&at&&an.push("PITCH_WITH_MAP_TERRAIN"),jt&&(an.push("PROJECTION_GLOBE_VIEW"),ei&&an.push("PROJECTED_POS_ON_VIEWPORT")),$i>0&&an.push("ICON_TRANSITION"),gt.icon.zOffsetVertexBuffer&&an.push("Z_OFFSET"),oe===0&&me===0&&Se===0&&be===1||an.push("COLOR_ADJUSTMENT"),gt.sdfIcons&&an.push("RENDER_SDF");const ra=gt.icon.programConfigurations.get(s.id),po=f.getOrCreateProgram("symbol",{config:ra,defines:an}),ki=bt.imageAtlasTexture?bt.imageAtlasTexture.size:[0,0],vi=gt.iconSizeData,oi=i.bo(vi,Ce.zoom),On=at||Ce.pitch!==0,Tn=Zo(Bt,bt.tileID.canonical,at,De,Ce,gt.getProjection(),Zt),en=uo(Bt,bt.tileID.canonical,at,De,Ce,gt.getProjection(),Zt),ni=f.translatePosMatrix(en,bt,P,k,!0),Di=f.translatePosMatrix(Bt,bt,P,k),An=ei?Gc:Tn,io=De&&!at&&!pr;let ca=st;!et&&!Ce.mercatorFromTransition||De||(ca=Zd(Ce));const No=jt?ca:st,Ws=s.getColorAdjustmentMatrix(oe,me,Se,be),hs=S0(vi.kind,oi,io,at,f,Di,An,ni,Pe,!1,ki,[0,0],!0,Rt,Vt,Tt,sr,No,gt.getProjection(),Ws,$i),mo=bt.imageAtlasTexture?bt.imageAtlasTexture:null,ua=s.layout.get("icon-size").constantOr(0)!==1||gt.iconsNeedLinear,qs=gt.sdfIcons||f.options.rotating||f.options.zooming||ua||On?Ie.LINEAR:Ie.NEAREST,$a=gt.sdfIcons&&s.paint.get("icon-halo-width").constantOr(1)!==0,dc=f.terrain&&at&&pr?i.aa.mat4.invert(i.aa.mat4.create(),Tn):Gc;if(pr&&gt.icon){const Eh=Ce.elevation,Dm=Eh?Eh.getAtTileOffsetFunc(Rt,Ce.center.lat,Ce.worldSize,gt.getProjection()):null,ff=Zl(Bt,bt.tileID.canonical,at,De,Ce,gt.getProjection(),Zt);pd(gt,Bt,f,!1,ff,en,at,J,Dm,Rt)}return{program:po,buffers:gt.icon,uniformValues:hs,atlasTexture:mo,atlasTextureIcon:null,atlasInterpolation:qs,atlasInterpolationIcon:null,isSDF:gt.sdfIcons,hasHalo:$a,tile:bt,labelPlaneMatrixInv:dc}},Or=()=>{const pr=$e&&s.layout.get("symbol-placement")!=="point",an=[],ei=pr||Lt||lr;f.terrainRenderModeElevated()&&rt&&an.push("PITCH_WITH_MAP_TERRAIN"),jt&&(an.push("PROJECTION_GLOBE_VIEW"),ei&&an.push("PROJECTED_POS_ON_VIEWPORT")),gt.text.zOffsetVertexBuffer&&an.push("Z_OFFSET"),gt.iconsInText&&an.push("RENDER_TEXT_AND_SYMBOL"),an.push("RENDER_SDF"),Er(an);const $i=gt.text.programConfigurations.get(s.id),ra=f.getOrCreateProgram("symbol",{config:$i,defines:an});let po,ki=[0,0],vi=null;const oi=gt.textSizeData;gt.iconsInText&&(ki=bt.imageAtlasTexture?bt.imageAtlasTexture.size:[0,0],vi=bt.imageAtlasTexture?bt.imageAtlasTexture:null,po=rt||Ce.pitch!==0||f.options.rotating||f.options.zooming||oi.kind==="composite"||oi.kind==="camera"?Ie.LINEAR:Ie.NEAREST);const On=bt.glyphAtlasTexture?bt.glyphAtlasTexture.size:[0,0],Tn=s.layout.get("text-size-scale-range"),en=i.av(f.scaleFactor,Tn[0],Tn[1]),ni=i.bo(oi,Ce.zoom,en),Di=Zo(Bt,bt.tileID.canonical,rt,$e,Ce,gt.getProjection(),Zt),An=uo(Bt,bt.tileID.canonical,rt,$e,Ce,gt.getProjection(),Zt),io=f.translatePosMatrix(An,bt,z,D,!0),ca=f.translatePosMatrix(Bt,bt,z,D),No=ei?Gc:Di,Ws=$e&&!rt&&!pr;let hs=st;!et&&!Ce.mercatorFromTransition||$e||(hs=Zd(Ce));const mo=S0(oi.kind,ni,Ws,rt,f,ca,No,io,Pe,!0,On,ki,!0,Rt,Vt,Tt,sr,jt?hs:st,gt.getProjection(),null,null,en),ua=bt.glyphAtlasTexture?bt.glyphAtlasTexture:null,qs=Ie.LINEAR,$a=s.paint.get("text-halo-width").constantOr(1)!==0,dc=f.terrain&&rt&&pr?i.aa.mat4.invert(i.aa.mat4.create(),Di):Gc;if(pr&&gt.text){const Eh=Ce.elevation,Dm=Eh?Eh.getAtTileOffsetFunc(Rt,Ce.center.lat,Ce.worldSize,gt.getProjection()):null,ff=Zl(Bt,bt.tileID.canonical,rt,$e,Ce,gt.getProjection(),Zt);pd(gt,Bt,f,!0,ff,An,rt,ie,Dm,Rt)}return{program:ra,buffers:gt.text,uniformValues:mo,atlasTexture:ua,atlasTextureIcon:vi,atlasInterpolation:qs,atlasInterpolationIcon:po,isSDF:!0,hasHalo:$a,tile:bt,labelPlaneMatrixInv:dc}},jn=gt.icon.segments.get().length,Pn=gt.text.segments.get().length,un=jn&&!w.onlyText?Jr():null,yn=Pn&&!w.onlyIcons?Or():null,Fr=s.paint.get("icon-opacity").constantOr(1),Qr=s.paint.get("text-opacity").constantOr(1);if(je&&gt.canOverlap){qe=!0;const pr=Fr&&!w.onlyText?gt.icon.segments.get():[],an=Qr&&!w.onlyIcons?gt.text.segments.get():[];for(const ei of pr)xt.push({segments:new i.b6([ei]),sortKey:ei.sortKey,state:un});for(const ei of an)xt.push({segments:new i.b6([ei]),sortKey:ei.sortKey,state:yn})}else w.onlyText||xt.push({segments:Fr?gt.icon.segments:new i.b6([]),sortKey:0,state:un}),w.onlyIcons||xt.push({segments:Qr?gt.text.segments:new i.b6([]),sortKey:0,state:yn})}qe&&xt.sort((Rt,bt)=>Rt.sortKey-bt.sortKey);for(const Rt of xt){const bt=Rt.state;if(bt)if(f.terrain?f.terrain.setupElevationDraw(bt.tile,bt.program,{useDepthForOcclusion:Ce.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:bt.labelPlaneMatrixInv}):f.setupDepthForOcclusion(Ce.depthOcclusionForSymbolsAndCircles,bt.program),Me.activeTexture.set(Ie.TEXTURE0),bt.atlasTexture&&bt.atlasTexture.bind(bt.atlasInterpolation,Ie.CLAMP_TO_EDGE,!0),bt.atlasTextureIcon&&(Me.activeTexture.set(Ie.TEXTURE1),bt.atlasTextureIcon&&bt.atlasTextureIcon.bind(bt.atlasInterpolationIcon,Ie.CLAMP_TO_EDGE,!0)),f.uploadCommonLightUniforms(f.context,bt.program),bt.hasHalo){const gt=bt.uniformValues;gt.u_is_halo=1,Vn(bt.buffers,Rt.segments,s,f,bt.program,mt,_,y,gt,2),gt.u_is_halo=0}else{if(bt.isSDF){const gt=bt.uniformValues;bt.hasHalo&&(gt.u_is_halo=1,Vn(bt.buffers,Rt.segments,s,f,bt.program,mt,_,y,gt,1)),gt.u_is_halo=0}Vn(bt.buffers,Rt.segments,s,f,bt.program,mt,_,y,bt.uniformValues,1)}}}function Vn(f,n,s,p,_,y,w,P,z,k){const D=[f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer,f.iconTransitioningVertexBuffer,f.globeExtVertexBuffer,f.zOffsetVertexBuffer];_.draw(p,p.context.gl.TRIANGLES,y,w,P,mr.disabled,z,s.id,f.layoutVertexBuffer,f.indexBuffer,n,s.paint,p.transform.zoom,f.programConfigurations.get(s.id),D,k)}function dh(f,n,s,p,_,y,w){const P=f.context.gl,z=s.paint.get("fill-pattern"),k=s.is3D(),D=k?f.stencilModeFor3D():Cr.disabled,j=z&&z.constantOr(1);let B,G,Q,J,ie;w?(G=j&&!s.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",B=P.LINES):(G=j?"fillPattern":"fill",B=P.TRIANGLES);for(const oe of p){const me=n.getTile(oe);if(j&&!me.patternsLoaded())continue;const Se=me.getBucket(s);if(!Se)continue;f.prepareDrawTile();const be=Se.programConfigurations.get(s.id),Pe=f.isTileAffectedByFog(oe),Me=f.getOrCreateProgram(G,{config:be,overrideFog:Pe});j&&(f.context.activeTexture.set(P.TEXTURE0),me.imageAtlasTexture&&me.imageAtlasTexture.bind(P.LINEAR,P.CLAMP_TO_EDGE),be.updatePaintBuffers());const Ie=z.constantOr(null);if(Ie&&me.imageAtlas){const $e=me.imageAtlas,at=i.c_.from(Ie),rt=$e.patternPositions[at.getSerializedPrimary()];rt&&be.setConstantPatternPositions(rt)}const Ce=f.translatePosMatrix(oe.projMatrix,me,s.paint.get("fill-translate"),s.paint.get("fill-translate-anchor")),De=s.paint.get("fill-emissive-strength");if(w){J=Se.indexBuffer2,ie=Se.segments2;const $e=f.terrain&&f.terrain.renderingToTexture?f.terrain.drapeBufferSize:[P.drawingBufferWidth,P.drawingBufferHeight];Q=G==="fillOutlinePattern"&&j?jd(Ce,De,f,me,$e):x0(Ce,De,$e)}else J=Se.indexBuffer,ie=Se.segments,Q=j?Uc(Ce,De,f,me):Nd(Ce,De);f.uploadCommonUniforms(f.context,Me,oe.toUnwrapped()),Me.draw(f,B,_,k?D:f.stencilModeForClipping(oe),y,mr.disabled,Q,s.id,Se.layoutVertexBuffer,J,ie,s.paint,f.transform.zoom,be,void 0)}}function Hc(f,n,s,p,_,y,w,P){s.resetLayerRenderingStats(f);const z=f.context,k=z.gl,D=f.transform,j=s.paint.get("fill-extrusion-pattern"),B=j.constantOr(1),G=s.paint.get("fill-extrusion-opacity"),Q=f.style.enable3dLights(),J=s.paint.get(Q&&!B?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),ie=[s.paint.get("fill-extrusion-ambient-occlusion-intensity"),J],oe=s.layout.get("fill-extrusion-edge-radius"),me=oe>0&&!s.paint.get("fill-extrusion-rounded-roof"),Se=me?0:oe,be=D.projection.name==="globe"?i.d3():0,Pe=D.projection.name==="globe",Me=Pe?i.ad(D.zoom):0,Ie=[i.as(D.center.lng),i.az(D.center.lat)],Ce=s.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",De=s.paint.get("fill-extrusion-flood-light-color").toRenderColor(Ce?null:s.lut).toArray01().slice(0,3),$e=s.paint.get("fill-extrusion-flood-light-intensity"),at=s.paint.get("fill-extrusion-vertical-scale"),rt=s.paint.get("fill-extrusion-line-width").constantOr(1)!==0,je=s.paint.get("fill-extrusion-height-alignment"),qe=s.paint.get("fill-extrusion-base-alignment"),mt=Fs(f,s.paint.get("fill-extrusion-cutoff-fade-range")),Tt=[];let Lt;Pe&&Tt.push("PROJECTION_GLOBE_VIEW"),ie[0]>0&&Tt.push("FAUX_AO"),me&&Tt.push("ZERO_ROOF_RADIUS"),P&&Tt.push("HAS_CENTROID"),$e>0&&Tt.push("FLOOD_LIGHT"),mt.shouldRenderCutoff&&Tt.push("RENDER_CUTOFF"),rt&&Tt.push("RENDER_WALL_MODE");const et=f.renderPass==="shadow",xt=f.shadowRenderer,st=et&&!!xt;f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!0);let Rt=[0,0,0];if(xt){const jt=f.style.directionalLight,Vt=f.style.ambientLight;jt&&Vt&&(Rt=Oc(f.style,jt,Vt)),et||(Tt.push("RENDER_SHADOWS","DEPTH_TEXTURE"),xt.useNormalOffset&&Tt.push("NORMAL_OFFSET")),Lt=Tt.concat(["SHADOWS_SINGLE_CASCADE"])}const bt=st?"fillExtrusionDepth":B?"fillExtrusionPattern":"fillExtrusion",gt=s.getLayerRenderingStats();for(const jt of p){const Vt=n.getTile(jt),Bt=Vt.getBucket(s);if(!Bt||Bt.projection.name!==D.projection.name)continue;let Zt=!1;xt&&(Zt=xt.getMaxCascadeForTile(jt.toUnwrapped())===0);const wr=f.isTileAffectedByFog(jt),lr=Bt.programConfigurations.get(s.id),sr=f.getOrCreateProgram(bt,{config:lr,defines:Zt?Lt:Tt,overrideFog:wr});if(f.terrain&&f.terrain.setupElevationDraw(Vt,sr,{useMeterToDem:!0}),!Bt.centroidVertexBuffer){const yn=sr.attributes.a_centroid_pos;yn!==void 0&&k.vertexAttrib2f(yn,0,0)}!et&&xt&&xt.setupShadows(Vt.tileID.toUnwrapped(),sr,"vector-tile",Vt.tileID.overscaledZ),B&&(f.context.activeTexture.set(k.TEXTURE0),Vt.imageAtlasTexture&&Vt.imageAtlasTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),lr.updatePaintBuffers());const Er=j.constantOr(null);if(Er&&Vt.imageAtlas){const yn=Vt.imageAtlas,Fr=i.c_.from(Er),Qr=yn.patternPositions[Fr.getSerializedPrimary()];Qr&&lr.setConstantPatternPositions(Qr)}const Jr=s.paint.get("fill-extrusion-vertical-gradient"),Or=1/Bt.tileToMeter;let jn;if(et&&xt){if(qc(Vt.tileID,Bt,f))continue;const yn=xt.calculateShadowPassMatrixFromTile(Vt.tileID.toUnwrapped());jn=Bd(yn,Se,Or,at,je,qe)}else{const yn=f.translatePosMatrix(jt.expandedProjMatrix,Vt,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),Fr=D.projection.createInversionMatrix(D,jt.canonical);jn=B?uh(yn,f,Jr,G,ie,Se,Or,jt,Vt,be,je,qe,Me,Ie,Fr,De,at):Fd(yn,f,Jr,G,ie,Se,Or,jt,be,je,qe,Me,Ie,Fr,De,at,$e,Rt)}f.uploadCommonUniforms(z,sr,jt.toUnwrapped(),null,mt);let Pn=Bt.segments;if(D.projection.name==="mercator"&&!et&&(Pn=Bt.getVisibleSegments(Vt.tileID,f.terrain,f.transform.getFrustum(0)),!Pn.get().length))continue;if(gt)if(et)for(const yn of Pn.get())gt.numRenderedVerticesInShadowPass+=yn.primitiveLength;else for(const yn of Pn.get())gt.numRenderedVerticesInTransparentPass+=yn.primitiveLength;const un=[];(f.terrain||P)&&un.push(Bt.centroidVertexBuffer),Pe&&un.push(Bt.layoutVertexExtBuffer),rt&&un.push(Bt.wallVertexBuffer),sr.draw(f,z.gl.TRIANGLES,_,y,w,mr.backCCW,jn,s.id,Bt.layoutVertexBuffer,Bt.indexBuffer,Pn,s.paint,f.transform.zoom,lr,un)}f.shadowRenderer&&(f.shadowRenderer.useNormalOffset=!1)}function ac(f,n,s,p,_,y,w,P,z,k,D,j,B,G,Q,J,ie,oe,me){const Se=f.context,be=Se.gl,Pe=f.transform,Me=f.transform.zoom,Ie=[],Ce=Fs(f,s.paint.get("fill-extrusion-cutoff-fade-range"));k==="clear"?(Ie.push("CLEAR_SUBPASS"),me&&(Ie.push("CLEAR_FROM_TEXTURE"),Se.activeTexture.set(be.TEXTURE0),me.bind(be.LINEAR,be.CLAMP_TO_EDGE))):k==="sdf"&&Ie.push("SDF_SUBPASS"),ie&&Ie.push("HAS_CENTROID"),Ce.shouldRenderCutoff&&Ie.push("RENDER_CUTOFF");const De=s.layout.get("fill-extrusion-edge-radius"),$e=(at,rt,je,qe,mt)=>{const Tt=rt.programConfigurations.get(s.id),Lt=f.isTileAffectedByFog(at),et=f.getOrCreateProgram("fillExtrusionGroundEffect",{config:Tt,defines:Ie,overrideFog:Lt}),xt=((Rt,bt,gt,jt,Vt,Bt,Zt,wr,lr,sr,Er)=>({u_matrix:bt,u_opacity:gt,u_ao_pass:jt?1:0,u_meter_to_tile:Vt,u_ao:Bt,u_flood_light_intensity:Zt,u_flood_light_color:wr,u_attenuation:lr,u_edge_radius:sr,u_fb:0,u_fb_size:Er,u_dynamic_offset:1}))(0,qe,D,z,mt,[j,B*mt],G,Q,J,Me>=17?0:De*mt,me?me.size[0]:0),st=[];ie&&st.push(rt.hiddenByLandmarkVertexBuffer),f.uploadCommonUniforms(Se,et,at.toUnwrapped(),null,Ce),et.draw(f,Se.gl.TRIANGLES,_,y,w,P,xt,s.id,rt.vertexBuffer,rt.indexBuffer,je,s.paint,Me,Tt,st)};for(const at of p){const rt=n.getTile(at),je=rt.getBucket(s);if(!je||je.projection.name!==Pe.projection.name||!je.groundEffect||je.groundEffect&&!je.groundEffect.hasData())continue;const qe=je.groundEffect,mt=1/je.tileToMeter;{const Tt=f.translatePosMatrix(at.projMatrix,rt,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),Lt=qe.getDefaultSegment();$e(at,qe,Lt,Tt,mt)}if(oe)for(let Tt=0;Tt<4;Tt++){const Lt=i.d4[Tt](at),et=n.getTile(Lt);if(!et)continue;const xt=et.getBucket(s);if(!xt||xt.projection.name!==Pe.projection.name||!xt.groundEffect||xt.groundEffect&&!xt.groundEffect.hasData())continue;const st=xt.groundEffect;let Rt,bt;Tt===0?(Rt=[-i.af,0,0],bt=1):Tt===1?(Rt=[i.af,0,0],bt=0):Tt===2?(Rt=[0,-i.af,0],bt=3):(Rt=[0,i.af,0],bt=2);const gt=st.regionSegments[bt];if(!gt)continue;const jt=new Float32Array(16);i.aa.mat4.translate(jt,at.projMatrix,Rt),$e(at,st,gt,f.translatePosMatrix(jt,rt,s.paint.get("fill-extrusion-translate"),s.paint.get("fill-extrusion-translate-anchor")),mt)}}}function M0(f,n,s,p,_,y,w){p.centroidVertexArray.length===0&&p.createCentroidsBuffer();const P=y?y.findDEMTileFor(s):null;if(!(P&&P.dem||w))return;y&&P&&P.dem&&p.selfDEMTileTimestamp!==P.dem._timestamp&&(p.borderDoneWithNeighborZ=[-1,-1,-1,-1],p.selfDEMTileTimestamp=P.dem._timestamp);const z=oe=>new i.P(Math.ceil((oe+i.d7)*i.d8),0),k=oe=>{const me=n.getSource().minzoom,Se=Pe=>{const Me=n.getTileByID(Pe);if(Me&&Me.hasData())return Me.getBucket(_)},be=[0,-1,1];for(const Pe of be){if(oe.overscaledZ+Pe<me)continue;const Me=Se(oe.calculateScaledKey(oe.overscaledZ+Pe));if(Me)return Me}},D=[0,0,0],j=(oe,me)=>(D[0]=Math.min(oe.min.y,me.min.y),D[1]=Math.max(oe.max.y,me.max.y),D[2]=i.af-me.min.x>oe.max.x?me.min.x-i.af:oe.max.x,D),B=(oe,me)=>(D[0]=Math.min(oe.min.x,me.min.x),D[1]=Math.max(oe.max.x,me.max.x),D[2]=i.af-me.min.y>oe.max.y?me.min.y-i.af:oe.max.y,D),G=[(oe,me)=>j(oe,me),(oe,me)=>j(me,oe),(oe,me)=>B(oe,me),(oe,me)=>B(me,oe)],Q=(oe,me,Se,be,Pe,Me,Ie)=>{if(!y)return 0;const Ce=[[Me?Se:oe,Me?oe:Se,0],[Me?Se:me,Me?me:Se,0]],De=Ie<0?i.af+Ie:Ie,$e=[Me?De:(oe+me)/2,Me?(oe+me)/2:De,0];return Se===0&&Ie<0||Se!==0&&Ie>0?y.getForTilePoints(Pe,[$e],!0,be):Ce.push($e),y.getForTilePoints(s,Ce,!0,P),Math.max(Ce[0][2],Ce[1][2],$e[2])/y.exaggeration()};for(let oe=0;oe<4;oe++){const me=p.borderFeatureIndices[oe];if(me.length===0)continue;const Se=i.d4[oe](s),be=k(Se);if(!(be&&be instanceof i.d5))continue;const Pe=y?y.findDEMTileFor(Se):null;if(!(Pe&&Pe.dem||w)||(y&&Pe&&Pe.dem&&p.borderDEMTileTimestamp[oe]!==Pe.dem._timestamp&&(p.borderDoneWithNeighborZ[oe]=-1,p.borderDEMTileTimestamp[oe]=Pe.dem._timestamp),p.borderDoneWithNeighborZ[oe]===be.canonical.z))continue;be.centroidVertexArray.length===0&&be.createCentroidsBuffer();const Me=(oe<2?1:5)-oe,Ie=be.borderDoneWithNeighborZ[Me]!==p.canonical.z,Ce=be.borderFeatureIndices[Me];let De=0;if(p.canonical.z!==be.canonical.z){for(const $e of me)p.showCentroid(p.featuresOnBorder[$e]);if(Ie)for(const $e of Ce)be.showCentroid(be.featuresOnBorder[$e]);p.borderDoneWithNeighborZ[oe]=be.canonical.z,be.borderDoneWithNeighborZ[Me]=p.canonical.z}for(const $e of me){const at=p.featuresOnBorder[$e],rt=p.centroidData[at.centroidDataIndex],je=at.borders[oe];let qe;for(;De<Ce.length;){qe=be.featuresOnBorder[Ce[De]];const mt=qe.borders[Me];if(mt[1]>je[0]+3||mt[0]>je[0]-3)break;be.showCentroid(qe),De++}if(qe&&De<Ce.length){const mt=De;let Tt=0;for(;!(qe.borders[Me][0]>je[1]-3)&&(Tt++,++De!==Ce.length);)qe=be.featuresOnBorder[Ce[De]];qe=be.featuresOnBorder[Ce[mt]];let Lt=!1;if(Tt>=1){const st=qe.borders[Me];Math.abs(je[0]-st[0])<3&&Math.abs(je[1]-st[1])<3&&(Tt=1,Lt=!0,De=mt+1)}else if(Tt===0){p.showCentroid(at);continue}const et=be.centroidData[qe.centroidDataIndex];w&&Lt&&(((J=rt).flags|(ie=et).flags)&i.d6?(J.flags|=i.d6,ie.flags|=i.d6):(J.flags&=~i.d6,ie.flags&=~i.d6));const xt=at.intersectsCount()>1||qe.intersectsCount()>1;if(Tt>1)De=mt,rt.centroidXY=et.centroidXY=new i.P(0,0);else if(Pe&&Pe.dem&&!xt){const st=G[oe](rt,et),Rt=oe%2?i.af-1:0,bt=Q(st[0],Math.min(i.af-1,st[1]),Rt,Pe,Se,oe<2,st[2]);rt.centroidXY=et.centroidXY=z(bt)}else xt?rt.centroidXY=et.centroidXY=new i.P(0,0):(rt.centroidXY=p.encodeBorderCentroid(at),et.centroidXY=be.encodeBorderCentroid(qe));p.writeCentroidToBuffer(rt),be.writeCentroidToBuffer(et)}else p.showCentroid(at)}p.borderDoneWithNeighborZ[oe]=be.canonical.z,be.borderDoneWithNeighborZ[Me]=p.canonical.z}var J,ie;(p.needsCentroidUpdate||!p.centroidVertexBuffer&&p.centroidVertexArray.length!==0)&&p.uploadCentroid(f)}const I0=[1,0,0],qx=[0,1,0],Wc=[0,0,1];function qc(f,n,s){const p=s.transform,_=s.shadowRenderer;if(!_)return!0;const y=f.toUnwrapped(),w=p.tileSize*_._cascades[s.currentShadowCascade].scale;let P=n.maxHeight;if(p.elevation){const J=p.elevation.getMinMaxForTile(f);J&&(P+=J.max)}const z=[..._.shadowDirection];z[2]=-z[2];const k=_.computeSimplifiedTileShadowVolume(y,P,w,z);if(!k)return!1;const D=[I0,qx,Wc,z,[z[0],0,z[2]],[0,z[1],z[2]]],j=p.projection.name==="globe",B=p.scaleZoom(w),G=i.bQ.fromInvProjectionMatrix(p.invProjMatrix,p.worldSize,B,!j),Q=_.getCurrentCascadeFrustum();return G.intersectsPrecise(k.vertices,k.planes,D)===0||Q.intersectsPrecise(k.vertices,k.planes,D)===0}function zt(f){return[f[0]*i.d9,f[1]*i.d9,f[2]*i.d9,0]}function Ht(f,n,s,p,_,y,w,P,z){const k=p.getSource(),D=s.globeSharedBuffers;if(!D)return;let j,B,G;if(n&&(j=p.getTile(n)),k instanceof i.aI?(B=k.texture,G=i.cH(0,0,s.transform)):j&&n&&(B=j.texture,G=i.cH(n.canonical.z,n.canonical.x,s.transform)),!B||!G)return;f||(G=i.aa.mat4.scale(i.aa.mat4.create(),G,[1,-1,1]));const Q=s.context,J=Q.gl,ie=_.paint.get("raster-resampling")==="nearest"?J.NEAREST:J.LINEAR,oe=s.colorModeForDrapableLayerRenderPass(y),me=w.defines;me.push("GLOBE_POLES");const Se=new ir(J.LEQUAL,ir.ReadWrite,s.depthRangeFor3D),be=Float32Array.from(s.transform.expandedFarZProjMatrix),Pe=Float32Array.from(i.ba(i.cG(new i.bS(0,0,0))));s.terrain&&s.terrain.prepareDrawTile(),Q.activeTexture.set(J.TEXTURE0),B.bind(ie,J.CLAMP_TO_EDGE),Q.activeTexture.set(J.TEXTURE1),B.bind(ie,J.CLAMP_TO_EDGE),B.useMipmap&&Q.extTextureFilterAnisotropic&&s.transform.pitch>20&&J.texParameterf(J.TEXTURE_2D,Q.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,Q.extTextureFilterAnisotropicMax);const[Me,Ie,Ce,De]=n?D.getPoleBuffers(n.canonical.z,!1):D.getPoleBuffers(0,!0),$e=_.paint.get("raster-elevation");let at;f?(at=Me,s.renderDefaultNorthPole=$e!==0):(at=Ie,s.renderDefaultSouthPole=$e!==0);const rt=zt(w.mix),je=((mt,Tt,Lt,et,xt,st,Rt,bt,gt,jt,Vt,Bt,Zt)=>Yt(mt,Tt,Lt,new Float32Array(16),new Float32Array(9),[0,0],et,[0,0],[0,0,0,0],1,{opacity:1,mix:0},st,[0,0],bt,2,jt,Vt,Bt,1,0,Zt))(be,Pe,G,i.ad(s.transform.zoom),0,_,0,$e,0,rt,w.offset,w.range,y),qe=s.getOrCreateProgram("raster",{defines:me});s.uploadCommonUniforms(Q,qe,null),qe.draw(s,J.TRIANGLES,Se,z,oe,P,je,_.id,at,Ce,De)}function Zc(f){const n=f._nearZ,s=f.projection.farthestPixelDistance(f),p=s-n,_=.2*f.height,y=n+_;return[n,s,(y-_-n)/p,(y-n)/p]}function ti(f,n,s,p){if(f)return n instanceof Si&&f instanceof ml?n.getTextureDescriptor(f,s,!0):{texture:f.texture,mix:zt(p.mix),offset:p.offset,buffer:0,tileSize:1}}var nt=i.da([{name:"a_index",type:"Int16",components:1}]);class P0{constructor(n,s,p,_){const y={width:p[0],height:p[1],data:null},w=n.gl;this.targetColorTexture=new i.T(n,y,w.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new i.T(n,y,w.RGBA8,{useMipmap:!1}),this.context=n,this.updateParticleTexture(s,_),this.lastInvalidatedAt=0}updateParticleTexture(n,s){if(this.particleTextureDimension===s.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const p=this.context.gl,_=s.width*s.height;this.particleTexture0=new i.T(this.context,s,p.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new i.T(this.context,s,p.RGBA8,{premultiply:!1,useMipmap:!1});const y=new i.db;y.reserve(_);for(let w=0;w<_;w++)y.emplaceBack(w);this.particleIndexBuffer=this.context.createVertexBuffer(y,nt.members,!0),this.particleSegment=i.b6.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=s.width}update(n){return!(this.lastInvalidatedAt<n&&(this.lastInvalidatedAt=i.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function Xd(f,n,s){if(!f)return null;const p=n.getTextureDescriptor(f,s,!0);if(!p)return null;let{texture:_,mix:y,offset:w,tileSize:P,buffer:z,format:k}=p;if(!_||!k)return null;let D=!1;return k==="uint32"&&(D=!0,y[3]=0,y=rc(i.dc,y,[0,s.paint.get("raster-particle-max-speed")]),w=hh(i.dc,w,[0,s.paint.get("raster-particle-max-speed")])),{texture:_,textureOffset:[z/(P+2*z),P/(P+2*z)],tileSize:P,scalarData:D,scale:y,offset:w,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[k]]}}function dm(f){const n=f._nearZ,s=f.projection.farthestPixelDistance(f),p=s-n,_=.2*f.height,y=n+_;return[n,s,(y-_-n)/p,(y-n)/p]}const A0=new i.ai(1,0,0,1),R0=new i.ai(0,1,0,1),z0=new i.ai(0,0,1,1),Xc=new i.ai(1,0,1,1),Zx=new i.ai(0,1,1,1);function Yc(f,n,s,p,_,y,w){const P=f.context,z=f.transform,k=P.gl,D=z.projection.name==="globe",j=D?["PROJECTION_GLOBE_VIEW"]:[];let B=i.aa.mat4.clone(s.projMatrix);if(D&&i.ad(z.zoom)>0){const rt=i.b9(s.canonical,z),je=i.dd(rt);B=i.aa.mat4.multiply(new Float32Array(16),z.globeMatrix,je),i.aa.mat4.multiply(B,z.projMatrix,B)}const G=i.aa.mat4.create();G[12]+=2*_/(i.q.devicePixelRatio*z.width),G[13]+=2*y/(i.q.devicePixelRatio*z.height),i.aa.mat4.multiply(B,G,B);const Q=f.getOrCreateProgram("debug",{defines:j}),J=n.getTileByID(s.key);f.terrain&&f.terrain.setupElevationDraw(J,Q);const ie=ir.disabled,oe=Cr.disabled,me=f.colorModeForRenderPass(),Se="$debug";P.activeTexture.set(k.TEXTURE0),f.emptyTexture.bind(k.LINEAR,k.CLAMP_TO_EDGE),D?J._makeGlobeTileDebugBuffers(f.context,z):J._makeDebugTileBoundsBuffers(f.context,z.projection);const be=J._tileDebugBuffer||f.debugBuffer,Pe=J._tileDebugIndexBuffer||f.debugIndexBuffer,Me=J._tileDebugSegments||f.debugSegments;if(Q.draw(f,k.LINE_STRIP,ie,oe,me,mr.disabled,Vd(B,p),Se,be,Pe,Me,null,null,null,[J._globeTileDebugBorderBuffer]),w){const rt=J.latestRawTileData,je=Math.floor((rt&&rt.byteLength||0)/1024);let qe=s.canonical.toString();s.overscaledZ!==s.canonical.z&&(qe+=` => ${s.overscaledZ}`),qe+=` ${J.state}`,qe+=` ${je}kb`,function(mt,Tt){mt.initDebugOverlayCanvas();const Lt=mt.debugOverlayCanvas,et=mt.context.gl,xt=mt.debugOverlayCanvas.getContext("2d");xt.clearRect(0,0,Lt.width,Lt.height),xt.shadowColor="white",xt.shadowBlur=2,xt.lineWidth=1.5,xt.strokeStyle="white",xt.textBaseline="top",xt.font="bold 36px Open Sans, sans-serif",xt.fillText(Tt,5,5),xt.strokeText(Tt,5,5),mt.debugOverlayTexture.update(Lt),mt.debugOverlayTexture.bind(et.LINEAR,et.CLAMP_TO_EDGE)}(f,qe)}const Ie=n.getTile(s).tileSize,Ce=512/Math.min(Ie,512)*(s.overscaledZ/z.zoom)*.5,De=J._tileDebugTextBuffer||f.debugBuffer,$e=J._tileDebugTextIndexBuffer||f.quadTriangleIndexBuffer,at=J._tileDebugTextSegments||f.debugSegments;Q.draw(f,k.TRIANGLES,ie,oe,Br.alphaBlended,mr.disabled,Vd(B,i.ai.transparent,Ce),Se,De,$e,at,null,null,null,[J._globeTileDebugTextBuffer])}function fm(f,n,s,p){Kc(f,0,n+s/2,f.transform.width,s,p)}function fh(f,n,s,p){Kc(f,n-s/2,0,s,f.transform.height,p)}function Kc(f,n,s,p,_,y){const w=f.context,P=w.gl;P.enable(P.SCISSOR_TEST),P.scissor(n*i.q.devicePixelRatio,s*i.q.devicePixelRatio,p*i.q.devicePixelRatio,_*i.q.devicePixelRatio),w.clear({color:y}),P.disable(P.SCISSOR_TEST)}const L0=i.da([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:k0}=L0;function Ba(f,n,s,p){f.emplaceBack(n,s,p)}class ph{constructor(n){this.vertexArray=new i.de,this.indices=new i.aT,Ba(this.vertexArray,-1,-1,1),Ba(this.vertexArray,1,-1,1),Ba(this.vertexArray,-1,1,1),Ba(this.vertexArray,1,1,1),Ba(this.vertexArray,-1,-1,-1),Ba(this.vertexArray,1,-1,-1),Ba(this.vertexArray,-1,1,-1),Ba(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=n.createVertexBuffer(this.vertexArray,k0),this.indexBuffer=n.createIndexBuffer(this.indices),this.segment=i.b6.simpleSegment(0,0,36,12)}}function Fo(f,n,s,p,_,y){const w=f.context.gl,P=n.paint.get("sky-atmosphere-color"),z=n.paint.get("sky-atmosphere-halo-color"),k=n.paint.get("sky-atmosphere-sun-intensity"),D=((j,B,G,Q,J)=>({u_matrix_3f:j,u_sun_direction:B,u_sun_intensity:G,u_color_tint_r:[Q.r,Q.g,Q.b,Q.a],u_color_tint_m:[J.r,J.g,J.b,J.a],u_luminance:5e-5}))(i.aa.mat3.fromMat4(i.aa.mat3.create(),p),_,k,P,z);w.framebufferTexture2D(w.FRAMEBUFFER,w.COLOR_ATTACHMENT0,w.TEXTURE_CUBE_MAP_POSITIVE_X+y,n.skyboxTexture,0),s.draw(f,w.TRIANGLES,ir.disabled,Cr.disabled,Br.unblended,mr.frontCW,D,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const D0=i.da([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class Xx{constructor(n){const s=new i.df;s.emplaceBack(-1,1,1,0,0),s.emplaceBack(1,1,1,1,0),s.emplaceBack(1,-1,1,1,1),s.emplaceBack(-1,-1,1,0,1);const p=new i.aT;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=n.createVertexBuffer(s,D0.members),this.indexBuffer=n.createIndexBuffer(p),this.segments=i.b6.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Bo=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class Yx{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class mh{constructor(n){this.colorModeAlphaBlendedWriteRGB=new Br([1,zc,1,zc],i.ai.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Br([1,0,1,0],i.ai.transparent,[!1,!1,!1,!0]),this.params=new Yx,this.updateNeeded=!0,n.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),n.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),n.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),n.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(n){const s=n.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new Xx(s);const p=this.params.sizeRange,_=this.params.intensityRange,y=function(D){const j=i.di(30),B=[];for(let G=0;G<D;++G){const Q=2*Math.PI*j(),J=Math.acos(1-2*j())-.5*Math.PI;B.push(i.aa.vec3.fromValues(Math.cos(J)*Math.cos(Q),Math.cos(J)*Math.sin(Q),Math.sin(J)))}return B}(this.params.starsCount),w=i.di(300),P=new i.dg,z=new i.aT;let k=0;for(let D=0;D<y.length;++D){const j=i.aa.vec3.scale([],y[D],200),B=Math.max(0,1+.01*p*(1*w()-.5)),G=Math.max(0,1+.01*_*(1*w()-.5));P.emplaceBack(j[0],j[1],j[2],-1,-1,B,G),P.emplaceBack(j[0],j[1],j[2],1,-1,B,G),P.emplaceBack(j[0],j[1],j[2],1,1,B,G),P.emplaceBack(j[0],j[1],j[2],-1,1,B,G),z.emplaceBack(k+0,k+1,k+2),z.emplaceBack(k+0,k+2,k+3),k+=4}this.starsVx=s.createVertexBuffer(P,Bo.members),this.starsIdx=s.createIndexBuffer(z),this.starsSegments=i.b6.simpleSegment(0,0,P.length,z.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(n,s){const p=n.context,_=p.gl,y=n.transform,w=new ir(_.LEQUAL,ir.ReadOnly,[0,1]),P=i.ad(y.zoom),z=n.style.getLut(s.scope),k=s.properties.get("color-use-theme")==="none",D=s.properties.get("color").toRenderColor(k?null:z).toArray01(),j=s.properties.get("high-color-use-theme")==="none",B=s.properties.get("high-color").toRenderColor(j?null:z).toArray01(),G=s.properties.get("space-color-use-theme")==="none",Q=s.properties.get("space-color").toRenderColor(G?null:z).toArray01PremultipliedAlpha(),J=5e-4,ie=i.dh(s.properties.get("horizon-blend"),0,1,J,.25),oe=i.cB(n,p,y)&&ie===J?y.worldSize/(2*Math.PI*1.025)-1:y.globeRadius,me=n.frameCounter/1e3%1,Se=i.aa.vec3.length(y.globeCenterInViewSpace),be=Math.sqrt(Math.pow(Se,2)-Math.pow(oe,2)),Pe=Math.acos(be/Se),Me=Ie=>{const Ce=y.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];Ie&&Ce.push("ALPHA_PASS");const De=n.getOrCreateProgram("globeAtmosphere",{defines:Ce}),$e=((rt,je,qe,mt,Tt,Lt,et,xt,st,Rt,bt,gt)=>({u_frustum_tl:rt,u_frustum_tr:je,u_frustum_br:qe,u_frustum_bl:mt,u_horizon:Tt,u_transition:Lt,u_fadeout_range:et,u_color:xt,u_high_color:st,u_space_color:Rt,u_temporal_offset:bt,u_horizon_angle:gt}))(y.frustumCorners.TL,y.frustumCorners.TR,y.frustumCorners.BR,y.frustumCorners.BL,y.frustumCorners.horizon,P,ie,D,B,Q,me,Pe);n.uploadCommonUniforms(p,De);const at=this.atmosphereBuffer;at&&De.draw(n,_.TRIANGLES,w,Cr.disabled,Ie?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,mr.backCW,$e,Ie?"atmosphere_glow_alpha":"atmosphere_glow",at.vertexBuffer,at.indexBuffer,at.segments)};Me(!1),Me(!0)}drawStars(n,s){const p=i.av(s.properties.get("star-intensity"),0,1);if(p===0)return;const _=n.context,y=_.gl,w=n.transform,P=n.getOrCreateProgram("stars"),z=i.aa.quat.identity([]);i.aa.quat.rotateX(z,z,-w._pitch),i.aa.quat.rotateZ(z,z,-w.angle),i.aa.quat.rotateX(z,z,i.ah(w._center.lat)),i.aa.quat.rotateY(z,z,-i.ah(w._center.lng));const k=i.aa.mat4.fromQuat(new Float32Array(16),z),D=i.aa.mat4.multiply([],w.starsProjMatrix,k),j=i.aa.mat3.fromMat4([],k),B=i.aa.mat3.invert([],j),G=[0,1,0];i.aa.vec3.transformMat3(G,G,B),i.aa.vec3.scale(G,G,this.params.sizeMultiplier);const Q=[1,0,0];i.aa.vec3.transformMat3(Q,Q,B),i.aa.vec3.scale(Q,Q,this.params.sizeMultiplier);const J=(ie=G,oe=Q,me=p,{u_matrix:Float32Array.from(D),u_up:ie,u_right:oe,u_intensity_multiplier:me});var ie,oe,me;n.uploadCommonUniforms(_,P),this.starsVx&&this.starsIdx&&P.draw(n,y.TRIANGLES,ir.disabled,Cr.disabled,this.colorModeAlphaBlendedWriteRGB,mr.disabled,J,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Dn(f,n){const s=[...f],p=n.cameraWorldSizeForFog/n.worldSize,_=i.aa.mat4.identity([]);return i.aa.mat4.scale(_,_,[p,p,1]),i.aa.mat4.multiply(s,_,s),i.aa.mat4.multiply(s,n.worldToFogMatrix,s),s}function on(f,n,s,p,_){const y=s.material,w=p.context,{baseColorTexture:P,metallicRoughnessTexture:z}=y.pbrMetallicRoughness,{normalTexture:k,occlusionTexture:D,emissionTexture:j}=y;function B(Q,J,ie){if(Q&&(f.push(J),w.activeTexture.set(w.gl.TEXTURE0+ie),Q.gfxTexture)){const{minFilter:oe,magFilter:me,wrapS:Se,wrapT:be}=Q.sampler;Q.gfxTexture.bindExtraParam(oe,me,Se,be)}}B(P,"HAS_TEXTURE_u_baseColorTexture",to.BaseColor),B(z,"HAS_TEXTURE_u_metallicRoughnessTexture",to.MetallicRoughness),B(k,"HAS_TEXTURE_u_normalTexture",to.Normal),B(D,"HAS_TEXTURE_u_occlusionTexture",to.Occlusion),B(j,"HAS_TEXTURE_u_emissionTexture",to.Emission),_&&(_.texture||(_.texture=new i.dk(p.context,_.image,[_.image.height,_.image.height,_.image.height],w.gl.RGBA8)),w.activeTexture.set(w.gl.TEXTURE0+to.LUT),_.texture&&_.texture.bind(w.gl.LINEAR,w.gl.CLAMP_TO_EDGE),f.push("APPLY_LUT_ON_GPU")),s.texcoordBuffer&&(f.push("HAS_ATTRIBUTE_a_uv_2f"),n.push(s.texcoordBuffer)),s.colorBuffer&&(f.push(s.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),n.push(s.colorBuffer)),s.normalBuffer&&(f.push("HAS_ATTRIBUTE_a_normal_3f"),n.push(s.normalBuffer)),s.pbrBuffer&&(f.push("HAS_ATTRIBUTE_a_pbr"),f.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),n.push(s.pbrBuffer)),y.alphaMode!=="OPAQUE"&&y.alphaMode!=="MASK"||f.push("UNPREMULT_TEXTURE_IN_SHADER"),y.defined||f.push("DIFFUSE_SHADED"),f.push("USE_STANDARD_DERIVATIVES");const G=p.shadowRenderer;G&&(f.push("RENDER_SHADOWS","DEPTH_TEXTURE"),G.useNormalOffset&&f.push("NORMAL_OFFSET"))}function gh(f,n,s,p,_,y){const w=s.paint.get("model-opacity").constantOr(1),P=n.context,z=new ir(n.context.gl.LEQUAL,ir.ReadWrite,n.depthRangeFor3D),k=n.transform,D=f.mesh,j=D.material,B=j.pbrMetallicRoughness,G=n.style.fog;let Q;Q=n.transform.projection.zAxisUnit==="pixels"?[...f.nodeModelMatrix]:i.aa.mat4.multiply([],p.zScaleMatrix,f.nodeModelMatrix),i.aa.mat4.multiply(Q,p.negCameraPosMatrix,Q);const J=i.aa.mat4.invert([],Q);i.aa.mat4.transpose(J,J);const ie=s.paint.get("model-color-use-theme").constantOr("default")==="none",oe=s.paint.get("model-emissive-strength").constantOr(0),me=Wd(new Float32Array(f.worldViewProjection),new Float32Array(Q),new Float32Array(J),null,n,w,B.baseColorFactor.toRenderColor(null),j.emissiveFactor,B.metallicFactor,B.roughnessFactor,j,oe,s),Se={defines:[]},be=[],Pe=n.shadowRenderer;Pe&&(Pe.useNormalOffset=!1),on(Se.defines,be,D,n,ie?null:s.lut);let Me=null;if(G){const De=Dn(f.nodeModelMatrix,n.transform);if(Me=new Float32Array(De),k.projection.name!=="globe"){const $e=D.aabb.min,at=D.aabb.max,[rt,je]=G.getOpacityForBounds(De,$e[0],$e[1],at[0],at[1]);Se.overrideFog=rt>=St||je>=St}}const Ie=Fs(n,s.paint.get("model-cutoff-fade-range"));Ie.shouldRenderCutoff&&Se.defines.push("RENDER_CUTOFF");const Ce=n.getOrCreateProgram("model",Se);n.uploadCommonUniforms(P,Ce,null,Me,Ie),n.renderPass!=="shadow"&&Pe&&Pe.setupShadowsFromMatrix(f.nodeModelMatrix,Ce),Ce.draw(n,P.gl.TRIANGLES,z,_,y,D.material.doubleSided?mr.disabled:mr.backCCW,me,s.id,D.vertexBuffer,D.indexBuffer,D.segments,s.paint,n.transform.zoom,void 0,be)}function $s(f,n,s,p,_,y,w){let P;P=f.projection.name==="globe"?i.dl(s,f):[...s],i.aa.mat4.multiply(P,P,n.matrix);const z=i.aa.mat4.multiply([],p,P);if(n.meshes)for(const k of n.meshes){if(k.material.alphaMode!=="BLEND"){w.push({mesh:k,depth:0,modelIndex:_,worldViewProjection:z,nodeModelMatrix:P});continue}const D=i.aa.vec3.transformMat4([],k.centroid,z);D[2]>0&&y.push({mesh:k,depth:D[2],modelIndex:_,worldViewProjection:z,nodeModelMatrix:P})}if(n.children)for(const k of n.children)$s(f,k,s,p,_,y,w)}function Jc(f,n,s,p){const _=s.shadowRenderer;if(!_)return;const y=_.getShadowPassDepthMode(),w=_.getShadowPassColorMode(),P=_.calculateShadowPassMatrixFromMatrix(n),z=T0(P);s.getOrCreateProgram("modelDepth",{defines:s._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(s,s.context.gl.TRIANGLES,y,Cr.disabled,w,mr.backCCW,z,p.id,f.vertexBuffer,f.indexBuffer,f.segments,p.paint,s.transform.zoom,void 0,void 0)}function Qc(f,n,s){const p=n.updateZoomBasedPaintProperties(),_=function(y,w,P){let z,k,D,j=y.terrain?y.terrain.exaggeration():0;if(y.terrain&&j>0){const B=y.terrain,G=B.findDEMTileFor(P);G&&G.dem?z=i.dn.create(B,P,G):j=0}if(j===0&&(w.terrainElevationMin=0,w.terrainElevationMax=0),j===w.validForExaggeration&&(j===0||z&&z._demTile&&z._demTile.tileID===w.validForDEMTile.id&&z._dem._timestamp===w.validForDEMTile.timestamp))return!1;for(const B in w.instancesPerModel){const G=w.instancesPerModel[B];for(let Q=0;Q<G.instancedDataArray.length;++Q){const J=(z?j*z.getElevationAt(0|G.instancedDataArray.float32[16*Q],0|G.instancedDataArray.float32[16*Q+1],!0,!0):0)+G.instancesEvaluatedElevation[Q];G.instancedDataArray.float32[16*Q+6]=J,k=k?Math.min(w.terrainElevationMin,J):J,D=D?Math.max(w.terrainElevationMax,J):J}}return w.terrainElevationMin=k||0,w.terrainElevationMax=D||0,w.validForExaggeration=j,w.validForDEMTile=z&&z._demTile?{id:z._demTile.tileID,timestamp:z._dem._timestamp}:{id:void 0,timestamp:0},!0}(f,n,s);(p||_)&&(n.uploaded=!1,n.upload(f.context))}const Sa={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new i.cc([0,0,0],[i.af,i.af,0])};function pm(f,n){const s=1<<f.canonical.z,p=n.getFreeCameraOptions().position,_=n.elevation,y=f.canonical.x/s,w=(f.canonical.x+1)/s,P=f.canonical.y/s,z=(f.canonical.y+1)/s;let k=n._centerAltitude;if(_){const G=_.getMinMaxForTile(f);G&&G.max>k&&(k=G.max)}const D=i.av(p.x,y,w)-p.x,j=i.av(p.y,P,z)-p.y,B=i.bG(k,n.center.lat)-p.z;return n._zoomFromMercatorZ(Math.sqrt(D*D+j*j+B*B))}function Vs(f,n,s,p,_,y,w){const P=f.context,z=f.renderPass==="shadow",k=f.shadowRenderer,D=z&&k?k.getShadowPassDepthMode():new ir(P.gl.LEQUAL,ir.ReadWrite,f.depthRangeFor3D),j=f.isTileAffectedByFog(y);if(s.meshes)for(const B of s.meshes){const G=["MODEL_POSITION_ON_GPU"],Q=[];let J,ie,oe;p.instancedDataArray.length>20&&G.push("INSTANCED_ARRAYS");const me=Fs(f,n.paint.get("model-cutoff-fade-range"));if(me.shouldRenderCutoff&&G.push("RENDER_CUTOFF"),z&&k)J=f.getOrCreateProgram("modelDepth",{defines:G}),ie=T0(w.shadowTileMatrix,w.shadowTileMatrix,Float32Array.from(s.matrix)),oe=k.getShadowPassColorMode();else{on(G,Q,B,f,n.paint.get("model-color-use-theme").constantOr("default")==="none"?null:n.lut),J=f.getOrCreateProgram("model",{defines:G,overrideFog:j});const be=B.material,Pe=be.pbrMetallicRoughness,Me=n.paint.get("model-opacity").constantOr(1),Ie=n.paint.get("model-emissive-strength").constantOr(0);ie=Wd(y.expandedProjMatrix,Float32Array.from(s.matrix),new Float32Array(16),null,f,Me,Pe.baseColorFactor.toRenderColor(null),be.emissiveFactor,Pe.metallicFactor,Pe.roughnessFactor,be,Ie,n,_),k&&(w.shadowUniformsInitialized?J.setShadowUniformValues(P,k.getShadowUniformValues()):(k.setupShadows(y.toUnwrapped(),J,"model-tile",y.overscaledZ),w.shadowUniformsInitialized=!0)),oe=me.shouldRenderCutoff||Me<1||be.alphaMode!=="OPAQUE"?Br.alphaBlended:Br.unblended}f.uploadCommonUniforms(P,J,y.toUnwrapped(),null,me);const Se=B.material.doubleSided?mr.disabled:mr.backCCW;if(p.instancedDataArray.length>20)Q.push(p.instancedDataBuffer),J.draw(f,P.gl.TRIANGLES,D,Cr.disabled,oe,Se,ie,n.id,B.vertexBuffer,B.indexBuffer,B.segments,n.paint,f.transform.zoom,void 0,Q,p.instancedDataArray.length);else{const be=z?"u_instance":"u_normal_matrix";for(let Pe=0;Pe<p.instancedDataArray.length;++Pe)ie[be]=new Float32Array(p.instancedDataArray.arrayBuffer,64*Pe,16),J.draw(f,P.gl.TRIANGLES,D,Cr.disabled,oe,Se,ie,n.id,B.vertexBuffer,B.indexBuffer,B.segments,n.paint,f.transform.zoom,void 0,Q)}}if(s.children)for(const B of s.children)Vs(f,n,B,p,_,y,w)}const Sl=[1,-1,1];function El(f,n,s,p){if(!s.modelManager)return!0;const _=s.modelManager;if(!s.shadowRenderer)return!0;const y=s.shadowRenderer,w=n.aabb;let P=!0,z=f.maxHeight;if(z===0){let D=0;for(const j in f.instancesPerModel){const B=_.getModel(j,p);B?D=Math.max(D,Math.max(Math.max(B.aabb.max[0],B.aabb.max[1]),B.aabb.max[2])):P=!1}z=f.maxScale*D*1.41+f.maxVerticalOffset,P&&(f.maxHeight=z)}w.max[2]=z,w.min[2]+=f.terrainElevationMin,w.max[2]+=f.terrainElevationMax,i.aa.vec3.transformMat4(w.min,w.min,n.tileMatrix),i.aa.vec3.transformMat4(w.max,w.max,n.tileMatrix);const k=w.intersects(y.getCurrentCascadeFrustum());return s.currentShadowCascade===0&&(f.isInsideFirstShadowMapFrustum=k===2),k===0}function Yd(f,n){const s=f.uniformValues.u_cutoff_params[0],p=f.uniformValues.u_cutoff_params[1],_=f.uniformValues.u_cutoff_params[2],y=f.uniformValues.u_cutoff_params[3];return p===s||y===_?1:i.av(((n-s)/(p-s)-_)/(y-_),0,1)}function Kd(f,n,s,p){if(n.pitch<20)return 1;const _=n.getWorldToCameraMatrix();i.aa.mat4.multiply(_,_,f);const y=i.aa.vec4.fromValues(s.min[0],s.min[1],s.min[2],1);let w=i.aa.vec4.transformMat4(i.aa.vec4.create(),y,_),P=w,z=w;y[1]=s.max[1],w=i.aa.vec4.transformMat4(i.aa.vec4.create(),y,_),P=w[1]<P[1]?w:P,z=w[1]>z[1]?w:z,y[0]=s.max[0],w=i.aa.vec4.transformMat4(i.aa.vec4.create(),y,_),P=w[1]<P[1]?w:P,z=w[1]>z[1]?w:z,y[1]=s.min[1],w=i.aa.vec4.transformMat4(i.aa.vec4.create(),y,_),P=w[1]<P[1]?w:P,z=w[1]>z[1]?w:z;const k=i.av(p[0],0,1),D=100*n.pixelsPerMeter*i.av(p[1],0,1),j=i.av(p[2],0,1),B=i.aa.vec4.lerp(i.aa.vec4.create(),P,z,k),G=Math.tan(.5*n.fovX),Q=-B[2]*G;if(D===0)return B[1]<-Math.abs(Q)?j:1;const J=(-Math.abs(Q)-B[1])/D,ie=(me,Se,be)=>(1-be)*me+be*Se,oe=i.av(ie(1,j,J),j,1);return ie(1,oe,i.av((n.pitch-20)/20,0,1))}class mm{}class gm{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(n,s,p){{const j=this._storage.get(s.id);if(j)return j.lastUsedFrameIdx=n,j.buf}const _=p.gl,y=_.getBufferParameter(_.ELEMENT_ARRAY_BUFFER,_.BUFFER_SIZE),w=new ArrayBuffer(y),P=new Int16Array(w);_.getBufferSubData(_.ELEMENT_ARRAY_BUFFER,0,new Int16Array(w));const z=new i.dq;for(let j=0;j<y/2;j+=3){const B=P[j],G=P[j+1],Q=P[j+2];z.emplaceBack(B,G),z.emplaceBack(G,Q),z.emplaceBack(Q,B)}const k=p.bindVertexArrayOES.current,D=new mm;return D.buf=new cs(p,z),D.lastUsedFrameIdx=n,this._storage.set(s.id,D),p.bindVertexArrayOES.set(k),D.buf}update(n){for(const[s,p]of this._storage)n-p.lastUsedFrameIdx>30&&(p.buf.destroy(),this._storage.delete(s))}destroy(){for(const[n,s]of this._storage)s.buf.destroy(),this._storage.delete(n)}}class _m{constructor(n){this.occluderSize=30,this.depthOffset=-1e-4,n.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),n.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Tl=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class ym{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class _h{constructor(n,s){this.revealStart=11,this.revealRange=2,n.registerParameter(this,[...s,"Reveal"],"revealStart",{min:0,max:17,step:.05}),n.registerParameter(this,[...s,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const vm=i.da([{type:"Float32",name:"a_pos_2f",components:2}]);class xm{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(n,s){const p=n.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const w=new i.dr,P=new i.aT;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(1,1),w.emplaceBack(-1,1),P.emplaceBack(0,1,2),P.emplaceBack(0,2,3),this.vignetteVx=n.context.createVertexBuffer(w,vm.members),this.vignetteIdx=n.context.createIndexBuffer(P)}const _=i.b6.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){n.uploadCommonUniforms(n.context,p);const w={u_vignetteShape:(y={vignetteShape:[s.start,s.range,Math.pow(10,s.fadePower)],vignetteColor:[s.color.r,s.color.g,s.color.b,s.color.a*s.strength]}).vignetteShape,u_vignetteColor:y.vignetteColor};p.draw(n,n.context.gl.TRIANGLES,ir.disabled,Cr.disabled,Br.alphaBlended,mr.disabled,w,"vignette",this.vignetteVx,this.vignetteIdx,_,{})}var y}}class no{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(n,s){const p=n.getFreeCameraOptions().position,_=p.toAltitude(),y=p.toLngLat(),w=i.ah(y.lng),P=i.ah(y.lat),z=n.pixelsPerMeter/s,k=w*i.ds,D=i.ds*Math.log(Math.tan(Math.PI/4+P/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const j=-this._offsetYPrev+D,B=-this._elevationPrev+_;this._accumulatedOffsetX+=(-this._offsetXPrev+k)*z,this._accumulatedOffsetY+=j*z,this._accumulatedElevation+=B*z,this._offsetXPrev=k,this._offsetYPrev=D,this._elevationPrev=_}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function Jd(f,n){return[-(f[0]-Math.floor(f[0]/n)*n),-(f[1]-Math.floor(f[1]/n)*n),-(f[2]-Math.floor(f[2]/n)*n)]}function Qd(f){const n=i.di(1323123451230),s=[];for(let p=0;p<f;++p){const _=2*n()-1,y=2*n()-1,w=2*n()-1;s.push(i.aa.vec3.fromValues(_,y,w))}return s}function Ea(f,n,s,p,_){const y=i.av((_-s)/(p-s),0,1);return(1-y)*f+y*n}class Cl{constructor(n){this._movement=new no,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new xm,this._ppmScaleFactor=n}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(n,s){const p=n.transform;this._movement.update(p,this._ppmScaleFactor);const _=p.starsProjMatrix,y=i.aa.quat.identity([]);i.aa.quat.rotateX(y,y,i.ah(90)-p._pitch),i.aa.quat.rotateZ(y,y,-p.angle);const w=i.aa.mat4.fromQuat(new Float32Array(16),y),P=i.aa.mat4.fromValues(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),z=i.aa.mat4.transpose([],P),k=i.aa.mat4.multiply([],z,w),D=Date.now()/1e3;return this._accumulatedTimeFromStart+=(D-this._prevTime)*s,this._prevTime=D,{projectionMatrix:_,modelviewMatrix:k}}}class bm extends Cl{constructor(n){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new _h(n.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(n){const s=n.context;if(!this.particlesVx){const p=Qd(this.particlesCount),_=new i.dt,y=new i.aT;let w=0;const P=i.di(1323123451230);for(let z=0;z<p.length;++z){const k=p[z],D=[2*P()-1,P(),P(),P()];_.emplaceBack(k[0],k[1],k[2],-1,-1,...D),_.emplaceBack(k[0],k[1],k[2],1,-1,...D),_.emplaceBack(k[0],k[1],k[2],1,1,...D),_.emplaceBack(k[0],k[1],k[2],-1,1,...D),y.emplaceBack(w+0,w+1,w+2),y.emplaceBack(w+0,w+2,w+3),w+=4}this.particlesVx=s.createVertexBuffer(_,Tl.members),this.particlesIdx=s.createIndexBuffer(y)}}draw(n){if(!this._params.overrideStyleParameters&&!n.style.rain)return;const s=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},p=n.transform.zoom;if(s.revealStart>p)return;const _=Ea(0,1,s.revealStart,s.revealStart+s.revealRange,p);if(!this.particlesVx||!this.particlesIdx)return;const y=structuredClone(this._params);let w=[-y.direction.x,y.direction.y,-100];i.aa.vec3.normalize(w,w);const P=structuredClone(this._vignetteParams);P.strength*=_,y.overrideStyleParameters||(y.intensity=n.style.rain.state.density,y.timeFactor=n.style.rain.state.intensity,y.color=structuredClone(n.style.rain.state.color),w=structuredClone(n.style.rain.state.direction),y.screenThinning.intensity=n.style.rain.state.centerThinning,y.dropletSizeX=n.style.rain.state.dropletSize[0],y.dropletSizeYScale=n.style.rain.state.dropletSize[1]/n.style.rain.state.dropletSize[0],y.distortionStrength=100*n.style.rain.state.distortionStrength,P.strength=1,P.color=structuredClone(n.style.rain.state.vignetteColor));const z=this.updateOnRender(n,y.timeFactor),k=n.context,D=k.gl,j=n.transform;this.screenTexture&&this.screenTexture.size[0]===n.width&&this.screenTexture.size[1]===n.height||(this.screenTexture=new i.T(k,{width:n.width,height:n.height,data:null},D.RGBA8)),y.distortionStrength>0&&(k.activeTexture.set(D.TEXTURE0),this.screenTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),D.copyTexSubImage2D(D.TEXTURE_2D,0,0,0,0,0,n.width,n.height));const B=n.getOrCreateProgram("rainParticle");n.uploadCommonUniforms(k,B),k.activeTexture.set(D.TEXTURE0),this.screenTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE);const G=[y.color.r,y.color.g,y.color.b,y.color.a],Q=(J,ie)=>{const oe=Jd(this._movement.getPosition(),J),me=y.dropletSizeX,Se=y.dropletSizeX*y.dropletSizeYScale,be=n.width/2,Pe=n.height/2,Me=Ea(0,y.screenThinning.start,0,1,y.screenThinning.intensity),Ie=Ea(.001,y.screenThinning.range,0,1,y.screenThinning.intensity),Ce=Ea(0,y.screenThinning.particleOffset,0,1,y.screenThinning.intensity),De=($e={modelview:z.modelviewMatrix,projection:z.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:oe,velocityConeAperture:y.velocityConeAperture,velocity:y.velocity,boxSize:J,rainDropletSize:[me,Se],distortionStrength:y.distortionStrength,rainDirection:w,color:G,screenSize:[j.width,j.height],thinningCenterPos:[be,Pe],thinningShape:[Me,Ie,Math.pow(10,y.screenThinning.fadePower)],thinningAffectedRatio:y.screenThinning.affectedRatio,thinningParticleOffset:Ce,shapeDirectionalPower:y.shapeDirPower,shapeNormalPower:y.shapeNormalPower,mode:ie?0:1},{u_modelview:Float32Array.from($e.modelview),u_projection:Float32Array.from($e.projection),u_time:$e.time,u_cam_pos:$e.camPos,u_texScreen:0,u_velocityConeAperture:$e.velocityConeAperture,u_velocity:$e.velocity,u_boxSize:$e.boxSize,u_rainDropletSize:$e.rainDropletSize,u_distortionStrength:$e.distortionStrength,u_rainDirection:$e.rainDirection,u_color:$e.color,u_screenSize:$e.screenSize,u_thinningCenterPos:$e.thinningCenterPos,u_thinningShape:$e.thinningShape,u_thinningAffectedRatio:$e.thinningAffectedRatio,u_thinningParticleOffset:$e.thinningParticleOffset,u_shapeDirectionalPower:$e.shapeDirectionalPower,u_shapeNormalPower:$e.shapeNormalPower,u_mode:$e.mode});var $e;const at=Math.round(_*y.intensity*this.particlesCount),rt=i.b6.simpleSegment(0,0,4*at,2*at);B.draw(n,D.TRIANGLES,ir.disabled,Cr.disabled,Br.alphaBlended,mr.disabled,De,"rain_particles",this.particlesVx,this.particlesIdx,rt,{})};y.distortionStrength>0&&Q(y.boxSize,!0),Q(y.boxSize,!1),this._vignette.draw(n,P)}}const wm=i.da([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class Sm extends Cl{constructor(n){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new _h(n.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(n){const s=n.context;if(!this.particlesVx){const p=Qd(this.particlesCount),_=new i.du,y=new i.aT;let w=0;const P=i.di(1323123451230);for(let z=0;z<p.length;++z){const k=p[z],D=P(),j=P(),B=P(),G=[z/p.length,D,j,B],Q=[P(),P()];_.emplaceBack(k[0],k[1],k[2],-1,-1,...G,...Q),_.emplaceBack(k[0],k[1],k[2],1,-1,...G,...Q),_.emplaceBack(k[0],k[1],k[2],1,1,...G,...Q),_.emplaceBack(k[0],k[1],k[2],-1,1,...G,...Q),y.emplaceBack(w+0,w+1,w+2),y.emplaceBack(w+0,w+2,w+3),w+=4}this.particlesVx=s.createVertexBuffer(_,wm.members),this.particlesIdx=s.createIndexBuffer(y)}}draw(n){if(!this._params.overrideStyleParameters&&!n.style.snow)return;const s=structuredClone(this._params);let p=[-s.direction.x,s.direction.y,-100];i.aa.vec3.normalize(p,p);const _=structuredClone(this._vignetteParams),y=s.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},w=n.transform.zoom;if(y.revealStart>w)return;const P=Ea(0,1,y.revealStart,y.revealStart+y.revealRange,w);_.strength*=P,s.overrideStyleParameters||(s.intensity=n.style.snow.state.density,s.timeFactor=n.style.snow.state.intensity,s.color=structuredClone(n.style.snow.state.color),p=structuredClone(n.style.snow.state.direction),s.screenThinning.intensity=n.style.snow.state.centerThinning,s.billboardSize=2.79*n.style.snow.state.flakeSize,_.strength=1,_.color=structuredClone(n.style.snow.state.vignetteColor));const z=this.updateOnRender(n,s.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const k=n.context,D=k.gl,j=n.transform,B=n.getOrCreateProgram("snowParticle");n.uploadCommonUniforms(k,B),((G,Q,J)=>{const ie=Jd(this._movement.getPosition(),G),oe=j.width/2,me=j.height/2,Se=Ea(0,J.screenThinning.start,0,1,J.screenThinning.intensity),be=Ea(.001,J.screenThinning.range,0,1,J.screenThinning.intensity),Pe=Ea(0,J.screenThinning.particleOffset,0,1,J.screenThinning.intensity),Me=(Ie={modelview:z.modelviewMatrix,projection:z.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ie,velocityConeAperture:J.velocityConeAperture,velocity:J.velocity,horizontalOscillationRadius:J.horizontalOscillationRadius,horizontalOscillationRate:J.horizontalOscillationRate,boxSize:G,billboardSize:1*J.billboardSize,simpleShapeParameters:[J.shapeFadeStart,J.shapeFadePower],screenSize:[j.width,j.height],thinningCenterPos:[oe,me],thinningShape:[Se,be,Math.pow(10,J.screenThinning.fadePower)],thinningAffectedRatio:J.screenThinning.affectedRatio,thinningParticleOffset:Pe,color:[J.color.r,J.color.g,J.color.b,J.color.a],direction:p},{u_modelview:Float32Array.from(Ie.modelview),u_projection:Float32Array.from(Ie.projection),u_time:Ie.time,u_cam_pos:Ie.camPos,u_velocityConeAperture:Ie.velocityConeAperture,u_velocity:Ie.velocity,u_horizontalOscillationRadius:Ie.horizontalOscillationRadius,u_horizontalOscillationRate:Ie.horizontalOscillationRate,u_boxSize:Ie.boxSize,u_billboardSize:Ie.billboardSize,u_simpleShapeParameters:Ie.simpleShapeParameters,u_screenSize:Ie.screenSize,u_thinningCenterPos:Ie.thinningCenterPos,u_thinningShape:Ie.thinningShape,u_thinningAffectedRatio:Ie.thinningAffectedRatio,u_thinningParticleOffset:Ie.thinningParticleOffset,u_particleColor:Ie.color,u_direction:Ie.direction});var Ie;const Ce=Math.round(P*J.intensity*this.particlesCount),De=i.b6.simpleSegment(0,0,4*Ce,2*Ce);this.particlesVx&&this.particlesIdx&&B.draw(n,D.TRIANGLES,ir.disabled,Cr.disabled,Br.alphaBlended,mr.disabled,Me,"snow_particles",this.particlesVx,this.particlesIdx,De,{})})(s.boxSize,0,s),this._vignette.draw(n,_)}}const Us={symbol:function(f,n,s,p,_){if(f.renderPass!=="translucent")return;const y=Cr.disabled,w=f.colorModeForRenderPass(),P=s.layout.get("text-variable-anchor"),z=s.layout.get("text-size-scale-range"),k=i.av(f.scaleFactor,z[0],z[1]);P&&function(B,G,Q,J,ie,oe,me,Se){const be=G.transform,Pe=ie==="map",Me=oe==="map";for(const Ie of B){const Ce=J.getTile(Ie),De=Ce.getBucket(Q);if(!De||!De.text||!De.text.segments.get().length)continue;const $e=i.bo(De.textSizeData,be.zoom,Se),at=Yu(Ie,De.getProjection(),be),rt=be.calculatePixelsToTileUnitsMatrix(Ce),je=Zo(at,Ce.tileID.canonical,Me,Pe,be,De.getProjection(),rt),qe=De.hasIconTextFit()&&De.hasIconData();if($e){const mt=Math.pow(2,be.zoom-Ce.tileID.overscaledZ);C0(De,Pe,Me,me,i.cW,be,je,Ie,mt,$e,qe)}}}(p,f,s,n,s.layout.get("text-rotation-alignment"),s.layout.get("text-pitch-alignment"),_,k);const D=s.paint.get("icon-opacity").constantOr(1)!==0,j=s.paint.get("text-opacity").constantOr(1)!==0;s.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(D||j)?Qo(f,n,s,p,y,w):(D&&Qo(f,n,s,p,y,w,{onlyIcons:!0}),j&&Qo(f,n,s,p,y,w,{onlyText:!0})),n.map.showCollisionBoxes&&(um(f,n,s,p,s.paint.get("text-translate"),s.paint.get("text-translate-anchor"),!0),um(f,n,s,p,s.paint.get("icon-translate"),s.paint.get("icon-translate-anchor"),!1))},circle:function(f,n,s,p){if(f.renderPass!=="translucent")return;const _=s.paint.get("circle-opacity"),y=s.paint.get("circle-stroke-width"),w=s.paint.get("circle-stroke-opacity"),P=s.layout.get("circle-sort-key").constantOr(1)!==void 0,z=s.paint.get("circle-emissive-strength");if(_.constantOr(1)===0&&(y.constantOr(1)===0||w.constantOr(1)===0))return;const k=f.context,D=k.gl,j=f.transform,B=f.depthModeForSublayer(0,ir.ReadOnly),G=Cr.disabled,Q=f.colorModeForDrapableLayerRenderPass(z),J=j.projection.name==="globe",ie=[i.as(j.center.lng),i.az(j.center.lat)],oe=[];for(let Se=0;Se<p.length;Se++){const be=p[Se],Pe=n.getTile(be),Me=Pe.getBucket(s);if(!Me||Me.projection.name!==j.projection.name)continue;const Ie=Me.programConfigurations.get(s.id),Ce=i.cX(s),De=f.isTileAffectedByFog(be);J&&Ce.push("PROJECTION_GLOBE_VIEW"),Ce.push("DEPTH_D24"),f.terrain&&j.depthOcclusionForSymbolsAndCircles&&Ce.push("DEPTH_OCCLUSION");const $e=f.getOrCreateProgram("circle",{config:Ie,defines:Ce,overrideFog:De}),at=Me.layoutVertexBuffer,rt=Me.globeExtVertexBuffer,je=Me.indexBuffer,qe=j.projection.createInversionMatrix(j,be.canonical),mt={programConfiguration:Ie,program:$e,layoutVertexBuffer:at,globeExtVertexBuffer:rt,indexBuffer:je,uniformValues:i.cY(f,be,Pe,qe,ie,s),tile:Pe};if(P){const Tt=Me.segments.get();for(const Lt of Tt)oe.push({segments:new i.b6([Lt]),sortKey:Lt.sortKey,state:mt})}else oe.push({segments:Me.segments,sortKey:0,state:mt})}P&&oe.sort((Se,be)=>Se.sortKey-be.sortKey);const me={useDepthForOcclusion:j.depthOcclusionForSymbolsAndCircles};for(const Se of oe){const{programConfiguration:be,program:Pe,layoutVertexBuffer:Me,globeExtVertexBuffer:Ie,indexBuffer:Ce,uniformValues:De,tile:$e}=Se.state,at=Se.segments;f.terrain&&f.terrain.setupElevationDraw($e,Pe,me),f.uploadCommonUniforms(k,Pe,$e.tileID.toUnwrapped()),Pe.draw(f,D.TRIANGLES,B,G,Q,mr.disabled,De,s.id,Me,Ce,at,s.paint,j.zoom,be,[Ie])}},heatmap:function(f,n,s,p){if(s.paint.get("heatmap-opacity")!==0)if(f.renderPass==="offscreen"){const _=f.context,y=_.gl,w=Cr.disabled,P=new Br([y.ONE,y.ONE,y.ONE,y.ONE],i.ai.transparent,[!0,!0,!0,!0]);(function(G,Q,J,ie){const oe=G.gl,me=Q.width*ie,Se=Q.height*ie;G.activeTexture.set(oe.TEXTURE1),G.viewport.set([0,0,me,Se]);let be=J.heatmapFbo;if(!be||be&&(be.width!==me||be.height!==Se)){be&&be.destroy();const Pe=oe.createTexture();oe.bindTexture(oe.TEXTURE_2D,Pe),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_WRAP_S,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_WRAP_T,oe.CLAMP_TO_EDGE),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_MIN_FILTER,oe.LINEAR),oe.texParameteri(oe.TEXTURE_2D,oe.TEXTURE_MAG_FILTER,oe.LINEAR),be=J.heatmapFbo=G.createFramebuffer(me,Se,!0,null),function(Me,Ie,Ce,De,$e,at){const rt=Me.gl;rt.texImage2D(rt.TEXTURE_2D,0,Me.extRenderToTextureHalfFloat?rt.RGBA16F:rt.RGBA,$e,at,0,rt.RGBA,Me.extRenderToTextureHalfFloat?rt.HALF_FLOAT:rt.UNSIGNED_BYTE,null),De.colorAttachment.set(Ce)}(G,0,Pe,be,me,Se)}else oe.bindTexture(oe.TEXTURE_2D,be.colorAttachment.get()),G.bindFramebuffer.set(be.framebuffer)})(_,f,s,f.transform.projection.name==="globe"?.5:.25),_.clear({color:i.ai.transparent});const z=f.transform,k=z.projection.name==="globe",D=k?["PROJECTION_GLOBE_VIEW"]:[],j=k?mr.frontCCW:mr.disabled,B=[i.as(z.center.lng),i.az(z.center.lat)];for(let G=0;G<p.length;G++){const Q=p[G];if(n.hasRenderableParent(Q))continue;const J=n.getTile(Q),ie=J.getBucket(s);if(!ie||ie.projection.name!==z.projection.name)continue;const oe=f.isTileAffectedByFog(Q),me=ie.programConfigurations.get(s.id),Se=f.getOrCreateProgram("heatmap",{config:me,defines:D,overrideFog:oe}),{zoom:be}=f.transform;f.terrain&&f.terrain.setupElevationDraw(J,Se),f.uploadCommonUniforms(_,Se,Q.toUnwrapped());const Pe=z.projection.createInversionMatrix(z,Q.canonical);Se.draw(f,y.TRIANGLES,ir.disabled,w,P,j,Hx(f,Q,J,Pe,B,be,s.paint.get("heatmap-intensity")),s.id,ie.layoutVertexBuffer,ie.indexBuffer,ie.segments,s.paint,f.transform.zoom,me,k?[ie.globeExtVertexBuffer]:null)}_.viewport.set([0,0,f.width,f.height])}else f.renderPass==="translucent"&&(f.context.setColorMode(f.colorModeForRenderPass()),function(_,y){const w=_.context,P=w.gl,z=y.heatmapFbo;if(!z)return;w.activeTexture.set(P.TEXTURE0),P.bindTexture(P.TEXTURE_2D,z.colorAttachment.get()),w.activeTexture.set(P.TEXTURE1);let k=y.colorRampTexture;k||(k=y.colorRampTexture=new i.T(w,y.colorRamp,P.RGBA8)),k.bind(P.LINEAR,P.CLAMP_TO_EDGE),_.getOrCreateProgram("heatmapTexture").draw(_,P.TRIANGLES,ir.disabled,Cr.disabled,_.colorModeForRenderPass(),mr.disabled,((D,j,B,G)=>({u_image:0,u_color_ramp:1,u_opacity:j.paint.get("heatmap-opacity")}))(0,y),y.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments,y.paint,_.transform.zoom)}(f,s))},line:function(f,n,s,p){if(f.renderPass!=="translucent")return;const _=s.paint.get("line-opacity"),y=s.paint.get("line-width");if(_.constantOr(1)===0||y.constantOr(1)===0)return;const w=s.paint.get("line-emissive-strength"),P=s.paint.get("line-occlusion-opacity"),z=s.layout.get("line-elevation-reference"),k=s.layout.get("line-width-unit")==="meters",D=z==="sea",j=f.context,B=j.gl,G=!s.isDraped();if(G&&f.transform.projection.name==="globe")return;const Q=s.layout.get("line-cross-slope"),J=Q!==void 0,ie=Q<1,oe=G?new ir(f.depthOcclusion?B.GREATER:B.LEQUAL,ir.ReadOnly,f.depthRangeFor3D):f.depthModeForSublayer(0,ir.ReadOnly),me=f.colorModeForDrapableLayerRenderPass(w),Se=f.terrain&&f.terrain.renderingToTexture,be=Se?1:i.q.devicePixelRatio,Pe=s.paint.get("line-dasharray"),Me=Pe.constantOr(1),Ie=s.layout.get("line-cap"),Ce=Pe.constantOr(null),De=Ie.constantOr(null),$e=s.paint.get("line-pattern"),at=$e.constantOr(1),rt=$e.constantOr(null),je=s.paint.get("line-opacity").constantOr(1);let qe=!at&&je!==1||f.depthOcclusion&&P>0&&P<1;const mt=s.paint.get("line-gradient"),Tt=at?"linePattern":"line",Lt=i.cZ(s);let et;if(Se&&f.terrain&&f.terrain.clipOrMaskOverlapStencilType()&&(qe=!1),P!==0&&f.depthOcclusion){const st=s.paint._values["line-opacity"];st&&st.value&&st.value.kind==="constant"?et=st.value:i.w(`Occlusion opacity for layer ${s.id} is supported only when line-opacity isn't data-driven.`)}if(G&&(f.forceTerrainMode=!0),!G&&P!==0&&f.terrain&&!Se)return void i.w(`Occlusion opacity for layer ${s.id} is supported on terrain only if the layer has line-z-offset enabled.`);const xt=qe&&G?f.stencilModeFor3D():Cr.disabled;G&&(Lt.push("ELEVATED"),J&&Lt.push(ie?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),D&&Lt.push("ELEVATION_REFERENCE_SEA")),y.value.kind!=="constant"&&y.value.isLineProgressConstant===!1&&Lt.push("VARIABLE_LINE_WIDTH");for(const st of p){const Rt=n.getTile(st);if(at&&!Rt.patternsLoaded())continue;const bt=Rt.getBucket(s);if(!bt)continue;f.prepareDrawTile();const gt=bt.programConfigurations.get(s.id),jt=f.isTileAffectedByFog(st),Vt=f.getOrCreateProgram(Tt,{config:gt,defines:Lt,overrideFog:jt,overrideRtt:!G&&void 0});if(rt&&Rt.imageAtlas){const Or=i.c_.from(rt),jn=Rt.imageAtlas.patternPositions[Or.getSerializedPrimary()];jn&&gt.setConstantPatternPositions(jn)}if(!at&&Ce&&De&&Rt.lineAtlas){const Or=Rt.lineAtlas.getDash(Ce,De);Or&&gt.setConstantPatternPositions(Or)}let[Bt,Zt]=s.paint.get("line-trim-offset");(De==="round"||De==="square")&&Bt!==Zt&&(Bt===0&&(Bt-=1),Zt===1&&(Zt+=1));const wr=Se?st.projMatrix:null,lr=k?1/bt.tileToMeter/i.aq(Rt,1,f.transform.zoom):1,sr=k?1/bt.tileToMeter/i.aq(Rt,1,Math.floor(f.transform.zoom)):1,Er=at?i.c$(f,Rt,s,wr,be,lr,sr,[Bt,Zt]):i.d0(f,Rt,s,wr,bt.lineClipsArray.length,be,lr,sr,[Bt,Zt]);if(mt){const Or=bt.gradients[s.id];let jn=Or.texture;if(s.gradientVersion!==Or.version){let Pn=256;if(s.stepInterpolant){const un=n.getSource().maxzoom,yn=st.canonical.z===un?Math.ceil(1<<f.transform.maxZoom-st.canonical.z):1;Pn=i.av(i.d1(bt.maxLineLength/i.af*1024*yn),256,j.maxTextureSize)}Or.gradient=i.d2({expression:s.gradientExpression(),evaluationKey:"lineProgress",resolution:Pn,image:Or.gradient||void 0,clips:bt.lineClipsArray}),Or.texture?Or.texture.update(Or.gradient):Or.texture=new i.T(j,Or.gradient,B.RGBA8),Or.version=s.gradientVersion,jn=Or.texture}j.activeTexture.set(B.TEXTURE1),jn.bind(s.stepInterpolant?B.NEAREST:B.LINEAR,B.CLAMP_TO_EDGE)}Me&&(j.activeTexture.set(B.TEXTURE0),Rt.lineAtlasTexture&&Rt.lineAtlasTexture.bind(B.LINEAR,B.REPEAT),gt.updatePaintBuffers()),at&&(j.activeTexture.set(B.TEXTURE0),Rt.imageAtlasTexture&&Rt.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),gt.updatePaintBuffers()),G&&!D&&f.terrain.setupElevationDraw(Rt,Vt),f.uploadCommonUniforms(j,Vt,st.toUnwrapped());const Jr=Or=>{et!=null&&(et.value=je*P),Vt.draw(f,B.TRIANGLES,oe,Or,me,mr.disabled,Er,s.id,bt.layoutVertexBuffer,bt.indexBuffer,bt.segments,s.paint,f.transform.zoom,gt,[bt.layoutVertexBuffer2,bt.patternVertexBuffer,bt.zOffsetVertexBuffer]),et!=null&&(et.value=je)};if(qe&&!G){const Or=f.stencilModeForClipping(st).ref;Or===0&&Se&&j.clear({stencil:0});const jn={func:B.EQUAL,mask:255};Er.u_alpha_discard_threshold=.8,Jr(new Cr(jn,Or,255,B.KEEP,B.KEEP,B.INVERT)),Er.u_alpha_discard_threshold=0,Jr(new Cr(jn,Or,255,B.KEEP,B.KEEP,B.KEEP))}else qe&&G&&(Er.u_alpha_discard_threshold=.001),Jr(G?xt:f.stencilModeForClipping(st))}G&&(f.forceTerrainMode=!1),qe&&(f.resetStencilClippingMasks(),Se&&j.clear({stencil:0})),P===0||f.depthOcclusion||Se||f.layersWithOcclusionOpacity.push(f.currentLayer)},fill:function(f,n,s,p){const _=s.paint.get("fill-color"),y=s.paint.get("fill-opacity"),w=s.is3D(),P=new ir(f.context.gl.LEQUAL,ir.ReadWrite,f.depthRangeFor3D);if(y.constantOr(1)===0)return;const z=s.paint.get("fill-emissive-strength"),k=f.colorModeForDrapableLayerRenderPass(z),D=s.paint.get("fill-pattern"),j=f.opaquePassEnabledForLayer()&&!D.constantOr(1)&&_.constantOr(i.ai.transparent).a===1&&y.constantOr(0)===1?"opaque":"translucent";if(f.renderPass===j){const B=w?P:f.depthModeForSublayer(1,f.renderPass==="opaque"?ir.ReadWrite:ir.ReadOnly);dh(f,n,s,p,B,k,!1)}if(!w&&f.renderPass==="translucent"&&s.paint.get("fill-antialias")){const B=w?P:f.depthModeForSublayer(s.getPaintProperty("fill-outline-color")?2:0,ir.ReadOnly);dh(f,n,s,p,B,k,!0)}},"fill-extrusion":function(f,n,s,p){const _=s.paint.get("fill-extrusion-opacity"),y=f.context,w=y.gl,P=f.terrain,z=P&&P.renderingToTexture;if(_===0)return;const k=f.conflationActive&&f.style.isLayerClipped(s,n.getSource()),D=f.style.order.indexOf(s.fqid);if(k&&function(j,B,G,Q,J){for(const ie of Q){const oe=B.getTile(ie).getBucket(G);oe&&(oe.updateReplacement(ie,j.replacementSource,J),oe.uploadCentroid(j.context))}}(f,n,s,p,D),P||k)for(const j of p){const B=n.getTile(j).getBucket(s);B&&M0(f.context,n,j,B,s,P,k)}if(f.renderPass==="shadow"&&f.shadowRenderer){const j=f.shadowRenderer;if(P&&_<.65&&s._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof i.a8)return;const B=j.getShadowPassDepthMode(),G=j.getShadowPassColorMode();Hc(f,n,s,p,B,Cr.disabled,G,k)}else if(f.renderPass==="translucent"){const j=!s.paint.get("fill-extrusion-pattern").constantOr(1),B=s.paint.get("fill-extrusion-color").constantOr(i.ai.white);if(!z&&B.a!==0){const G=new ir(f.context.gl.LEQUAL,ir.ReadWrite,f.depthRangeFor3D);_===1&&j?Hc(f,n,s,p,G,Cr.disabled,Br.unblended,k):(Hc(f,n,s,p,G,Cr.disabled,Br.disabled,k),Hc(f,n,s,p,G,f.stencilModeFor3D(),f.colorModeForRenderPass(),k),f.resetStencilClippingMasks())}if(f.style.enable3dLights()&&j&&(!P&&f.transform.projection.name!=="globe"||z)){const G=s.paint.get("fill-extrusion-opacity"),Q=s.paint.get("fill-extrusion-ambient-occlusion-intensity"),J=s.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),ie=s.paint.get("fill-extrusion-flood-light-intensity"),oe=s.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",me=s.paint.get("fill-extrusion-flood-light-color").toRenderColor(oe?null:s.lut).toArray01().slice(0,3),Se=Q>0&&J>0,be=ie>0,Pe=(Ie,Ce,De)=>(1-De)*Ie+De*Ce,Me=Ie=>{const Ce=f.depthModeForSublayer(1,ir.ReadOnly,w.LEQUAL,!0),De=s.paint.get(Ie?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),$e=Pe(.1,3,De),at=f._showOverdrawInspector;if(!at){const rt=new Cr({func:w.ALWAYS,mask:255},255,255,w.KEEP,w.KEEP,w.REPLACE),je=new Br([w.ONE,w.ONE,w.ONE,w.ONE],i.ai.transparent,[!1,!1,!1,!0],w.MIN);ac(f,n,s,p,Ce,rt,je,mr.disabled,Ie,"sdf",G,Q,J,ie,me,$e,k,!1)}{const rt=at?Cr.disabled:new Cr({func:w.EQUAL,mask:255},255,255,w.KEEP,w.DECR,w.DECR),je=at?f.colorModeForRenderPass():new Br([w.ONE_MINUS_DST_ALPHA,w.DST_ALPHA,w.ONE,w.ONE],i.ai.transparent,[!0,!0,!0,!0]);ac(f,n,s,p,Ce,rt,je,mr.disabled,Ie,"color",G,Q,J,ie,me,$e,k,!1)}};if(z){const Ie=(Ce,De,$e)=>{const at=f.depthModeForSublayer(1,ir.ReadOnly,w.LEQUAL,!1),rt=s.paint.get(Ce?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),je=Pe(.1,3,rt);{const qe=new Br([w.ONE,w.ONE,w.ONE,w.ONE],i.ai.transparent,[!1,!1,!1,!0]);ac(f,n,s,p,at,Cr.disabled,qe,mr.disabled,Ce,"clear",G,Q,J,ie,me,je,k,De)}{const qe=new Cr({func:w.ALWAYS,mask:255},255,255,w.KEEP,w.KEEP,w.REPLACE),mt=new Br([w.ONE,w.ONE,w.ONE,w.ONE],i.ai.transparent,[!1,!1,!1,!0],w.MIN);ac(f,n,s,p,at,qe,mt,mr.disabled,Ce,"sdf",G,Q,J,ie,me,je,k,De)}{const qe=Ce?w.ZERO:w.ONE_MINUS_DST_ALPHA,mt=new Cr({func:w.EQUAL,mask:255},255,255,w.KEEP,w.DECR,w.DECR),Tt=new Br([qe,w.DST_ALPHA,w.ONE_MINUS_DST_ALPHA,w.ZERO],i.ai.transparent,[!0,!0,!0,!0]);ac(f,n,s,p,at,mt,Tt,mr.disabled,Ce,"color",G,Q,J,ie,me,je,k,De)}{const qe=new Br([w.ONE,w.ONE,w.ONE,Ce?w.ZERO:w.ONE],i.ai.transparent,[!1,!1,!1,!0],Ce?w.FUNC_ADD:w.MAX);ac(f,n,s,p,at,Cr.disabled,qe,mr.disabled,Ce,"clear",G,Q,J,ie,me,je,k,De,$e)}};if(Se||be){let Ce;if(f.prepareDrawTile(),P){const De=P.drapeBufferSize[0],$e=P.drapeBufferSize[1];Ce=P.framebufferCopyTexture,Ce&&(!Ce||Ce.size[0]===De&&Ce.size[1]===$e)||(Ce&&Ce.destroy(),Ce=P.framebufferCopyTexture=new i.T(y,new i.r({width:De,height:$e}),w.RGBA8)),Ce.bind(w.LINEAR,w.CLAMP_TO_EDGE),w.copyTexSubImage2D(w.TEXTURE_2D,0,0,0,0,0,De,$e)}Se&&Ie(!0,!1,Ce),be&&Ie(!1,!0,Ce)}}else Se&&Me(!0),be&&Me(!1),(Se||be)&&f.resetStencilClippingMasks()}}},hillshade:function(f,n,s,p){if(f.renderPass!=="offscreen"&&f.renderPass!=="translucent"||f.style.disableElevatedTerrain)return;const _=f.context,y=f.terrain&&f.terrain.renderingToTexture,[w,P]=f.renderPass!=="translucent"||y?[{},p]:f.stencilConfigForOverlap(p);for(const z of P){const k=n.getTile(z);if(k.needsHillshadePrepare&&f.renderPass==="offscreen")Nc(f,k,s);else if(f.renderPass==="translucent"){const D=f.depthModeForSublayer(0,ir.ReadOnly),j=s.paint.get("hillshade-emissive-strength"),B=f.colorModeForDrapableLayerRenderPass(j),G=y&&f.terrain?f.terrain.stencilModeForRTTOverlap(z):w[z.overscaledZ];s0(f,z,k,s,D,G,B)}}_.viewport.set([0,0,f.width,f.height]),f.resetStencilClippingMasks()},raster:function(f,n,s,p,_,y){if(f.renderPass!=="translucent"||s.paint.get("raster-opacity")===0)return;const w=f.transform.projection.name==="globe",P=s.paint.get("raster-elevation")!==0,z=P&&w;if(f.renderElevatedRasterBackface&&!z)return;const k=f.context,D=k.gl,j=n.getSource(),B=function(Me,Ie,Ce,De){const $e=Ie.paint.get("raster-color"),at=Me.type==="raster-array",rt=[],je=Ie.paint.get("raster-resampling"),qe=Ie.paint.get("raster-color-mix");let mt=Ie.paint.get("raster-color-range");const Tt=[qe[0],qe[1],qe[2],0],Lt=qe[3];let et=je==="nearest"?De.NEAREST:De.LINEAR;if(at&&(rt.push("RASTER_ARRAY"),$e||rt.push("RASTER_COLOR"),je==="linear"&&rt.push("RASTER_ARRAY_LINEAR"),et=De.NEAREST,!mt&&Me.rasterLayers)){const xt=Me.rasterLayers.find(({id:st})=>st===Ie.sourceLayer);xt&&xt.fields&&xt.fields.range&&(mt=xt.fields.range)}if(mt=mt||[0,1],$e){rt.push("RASTER_COLOR"),Ce.activeTexture.set(De.TEXTURE2),Ie.updateColorRamp(mt);let xt=Ie.colorRampTexture;xt||(xt=Ie.colorRampTexture=new i.T(Ce,Ie.colorRamp,De.RGBA8)),xt.bind(De.LINEAR,De.CLAMP_TO_EDGE)}return{mix:Tt,range:mt,offset:Lt,defines:rt,resampling:et}}(j,s,k,D);if(j instanceof i.aI&&!p.length&&!w)return;const G=s.paint.get("raster-emissive-strength"),Q=f.colorModeForDrapableLayerRenderPass(G),J=f.terrain&&f.terrain.renderingToTexture,ie=!f.options.moving,oe=s.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;if(j instanceof i.aI&&!p.length&&(j.onNorthPole||j.onSouthPole)){const Me=P?f.stencilModeFor3D():Cr.disabled;return void Ht(!!j.onNorthPole,null,f,n,s,G,B,mr.disabled,Me)}if(!p.length)return;const[me,Se]=j instanceof i.aI||J?[{},p]:f.stencilConfigForOverlap(p),be=Se[Se.length-1].overscaledZ;z&&B.defines.push("PROJECTION_GLOBE_VIEW"),P&&B.defines.push("RENDER_CUTOFF");const Pe=(Me,Ie,Ce)=>{for(const De of Me){const $e=De.toUnwrapped(),at=n.getTile(De);if(J&&(!at||!at.hasData()))continue;k.activeTexture.set(D.TEXTURE0);const rt=ti(at,j,s,B);if(!rt||!rt.texture)continue;const{texture:je,mix:qe,offset:mt,tileSize:Tt,buffer:Lt}=rt;let et,xt;J?(et=ir.disabled,xt=De.projMatrix):P?(et=new ir(D.LEQUAL,ir.ReadWrite,f.depthRangeFor3D),xt=w?Float32Array.from(f.transform.expandedFarZProjMatrix):f.transform.calculateProjMatrix($e,ie)):(et=f.depthModeForSublayer(De.overscaledZ-be,s.paint.get("raster-opacity")===1?ir.ReadWrite:ir.ReadOnly,D.LESS),xt=f.transform.calculateProjMatrix($e,ie));const st=f.terrain&&J?f.terrain.stencilModeForRTTOverlap(De):me[De.overscaledZ],Rt=y?0:s.paint.get("raster-fade-duration");at.registerFadeDuration(Rt);const bt=n.findLoadedParent(De,0),gt=Vc(at,bt,n,f.transform,Rt);let jt,Vt;f.terrain&&f.terrain.prepareDrawTile(),k.activeTexture.set(D.TEXTURE0),je.bind(oe,D.CLAMP_TO_EDGE),k.activeTexture.set(D.TEXTURE1),bt?(bt.texture&&bt.texture.bind(oe,D.CLAMP_TO_EDGE),jt=Math.pow(2,bt.tileID.overscaledZ-at.tileID.overscaledZ),Vt=[at.tileID.canonical.x*jt%1,at.tileID.canonical.y*jt%1]):je.bind(oe,D.CLAMP_TO_EDGE),je.useMipmap&&k.extTextureFilterAnisotropic&&f.transform.pitch>20&&D.texParameterf(D.TEXTURE_2D,k.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,k.extTextureFilterAnisotropicMax);const Bt=f.transform;let Zt;const wr=P?Zc(Bt):[0,0,0,0];let lr,sr,Er,Jr,Or,jn=0;if(z&&j instanceof i.aI&&j.coordinates.length>3)lr=Float32Array.from(i.ba(i.cG(new i.bS(0,0,0)))),sr=Float32Array.from(Bt.globeMatrix),Er=Float32Array.from(i.cC(Bt)),Jr=[i.as(Bt.center.lng),i.az(Bt.center.lat)],Zt=j.elevatedGlobePerspectiveTransform,Or=j.elevatedGlobeGridMatrix||new Float32Array(9);else if(z){const Fr=i.cD(De.canonical);jn=i.cE(Fr.getCenter().lat),lr=Float32Array.from(i.ba(i.cG(De.canonical))),sr=Float32Array.from(Bt.globeMatrix),Er=Float32Array.from(i.cC(Bt)),Jr=[i.as(Bt.center.lng),i.az(Bt.center.lat)],Zt=[0,0],Or=Float32Array.from(i.cF(De.canonical,Fr,jn,Bt.worldSize/Bt._pixelsPerMercatorPixel))}else Zt=j instanceof i.aI?j.perspectiveTransform:[0,0],lr=new Float32Array(16),sr=new Float32Array(9),Er=new Float32Array(16),Jr=[0,0],Or=new Float32Array(9);const Pn=Yt(xt,lr,sr,Er,Or,Vt||[0,0],i.ad(f.transform.zoom),Jr,wr,jt||1,gt,s,Zt,P?s.paint.get("raster-elevation"):0,2,qe,mt,B.range,Tt,Lt,G),un=f.isTileAffectedByFog(De),yn=f.getOrCreateProgram("raster",{defines:B.defines,overrideFog:un});if(f.uploadCommonUniforms(k,yn,$e),j instanceof i.aI){const Fr=j.elevatedGlobeVertexBuffer,Qr=j.elevatedGlobeIndexBuffer;if(J||!w)j.boundsBuffer&&j.boundsSegments&&yn.draw(f,D.TRIANGLES,et,Cr.disabled,Q,mr.disabled,Pn,s.id,j.boundsBuffer,f.quadTriangleIndexBuffer,j.boundsSegments);else if(Fr&&Qr){const pr=Bt.zoom<=i.c5?j.elevatedGlobeSegments:j.getSegmentsForLongitude(Bt.center.lng);pr&&yn.draw(f,D.TRIANGLES,et,Cr.disabled,Q,Ie,Pn,s.id,Fr,Qr,pr)}}else if(z){et=new ir(D.LEQUAL,ir.ReadOnly,f.depthRangeFor3D);const Fr=f.globeSharedBuffers;if(Fr){const[Qr,pr,an]=Fr.getGridBuffers(jn,!1);yn.draw(f,D.TRIANGLES,et,Ce||st,f.colorModeForRenderPass(),Ie,Pn,s.id,Qr,pr,an)}}else{const{tileBoundsBuffer:Fr,tileBoundsIndexBuffer:Qr,tileBoundsSegments:pr}=f.getTileBoundsBuffers(at);yn.draw(f,D.TRIANGLES,et,st,Q,mr.disabled,Pn,s.id,Fr,Qr,pr)}}if(!(j instanceof i.aI)&&z)for(const De of Me){const $e=De.canonical.y===(1<<De.canonical.z)-1;De.canonical.y===0&&Ht(!0,De,f,n,s,G,B,Ie,Ce||Cr.disabled),$e&&Ht(!1,De,f,n,s,G,B,Ie===mr.frontCW?mr.backCW:mr.frontCW,Ce||Cr.disabled)}};z?Pe(Se,f.renderElevatedRasterBackface?mr.backCW:mr.frontCW,f.stencilModeFor3D()):Pe(Se,mr.disabled,void 0),f.resetStencilClippingMasks()},"raster-particle":function(f,n,s,p,_,y){f.renderPass==="offscreen"&&function(w,P,z,k){if(!k.length)return;const D=w.context,j=D.gl,B=P.getSource();if(!(B instanceof Si))return;const G=Math.ceil(Math.sqrt(z.paint.get("raster-particle-count")));let Q=z.particlePositionRGBAImage;if(!Q||Q.width!==G){const Se=function(be){const Pe=be*be,Me=new Uint8Array(4*Pe),Ie=function(De){return De|=0,De=Math.imul(2747636419^De,2654435769),De=Math.imul(De^De>>>16,2654435769),((De=Math.imul(De^De>>>16,2654435769))>>>0)/4294967296},Ce=1/1.1;for(let De=0;De<Pe;De++){const $e=Ce*(Ie(2*De+0)+nc),at=Ce*(Ie(2*De+1)+nc),rt=255*$e%1,je=255*at%1,qe=rt,mt=at-je/255,Tt=je;Me[4*De+0]=255*($e-rt/255),Me[4*De+1]=255*qe,Me[4*De+2]=255*mt,Me[4*De+3]=255*Tt}return Me}(G);Q=z.particlePositionRGBAImage=new i.r({width:G,height:G},Se)}let J=z.particleFramebuffer;J?J.width!==G&&(J.destroy(),J=z.particleFramebuffer=D.createFramebuffer(G,G,!0,null)):J=z.particleFramebuffer=D.createFramebuffer(G,G,!0,null);const ie=[];for(const Se of k){const be=P.getTile(Se);if(!(be instanceof ml))continue;const Pe=Xd(be,B,z);if(!Pe)continue;const Me=[be.tileSize,be.tileSize];let Ie=z.tileFramebuffer;Ie||(Ie=z.tileFramebuffer=D.createFramebuffer(Me[0],Me[1],!0,null));let Ce=be.rasterParticleState;Ce||(Ce=be.rasterParticleState=new P0(D,Se,Me,Q));const De=Ce.update(z.lastInvalidatedAt);Ce.particleTextureDimension!==G&&Ce.updateParticleTexture(Se,Q);const $e=Ce.targetColorTexture;Ce.targetColorTexture=Ce.backgroundColorTexture,Ce.backgroundColorTexture=$e;const at=Ce.particleTexture0;Ce.particleTexture0=Ce.particleTexture1,Ce.particleTexture1=at,ie.push([Se,Pe,Ce,De])}if(ie.length===0)return;const oe=i.q.now(),me=z.previousDrawTimestamp?.001*(oe-z.previousDrawTimestamp):.0167;if(z.previousDrawTimestamp=oe,z.hasColorMap()){D.activeTexture.set(j.TEXTURE0+2);let Se=z.colorRampTexture;Se||(Se=z.colorRampTexture=new i.T(D,z.colorRamp,j.RGBA8)),Se.bind(j.LINEAR,j.CLAMP_TO_EDGE)}D.bindFramebuffer.set(z.tileFramebuffer.framebuffer),function(Se,be,Pe){const Me=Se.context,Ie=Me.gl,Ce=be.tileFramebuffer;Me.activeTexture.set(Ie.TEXTURE0);const De={u_texture:0,u_opacity:1.05*(at=be.paint.get("raster-particle-fade-opacity-factor"))/(at+.05)},$e=Se.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var at;for(const rt of Pe){const[,,je,qe]=rt;Ce.colorAttachment.set(je.targetColorTexture.texture),Me.viewport.set([0,0,Ce.width,Ce.height]),Me.clear({color:i.ai.transparent}),qe&&(je.backgroundColorTexture.bind(Ie.NEAREST,Ie.CLAMP_TO_EDGE),$e.draw(Se,Ie.TRIANGLES,ir.disabled,Cr.disabled,Br.alphaBlended,mr.disabled,De,be.id,Se.viewportBuffer,Se.quadTriangleIndexBuffer,Se.viewportSegments))}}(w,z,ie),function(Se,be,Pe,Me){const Ie=Se.context,Ce=Ie.gl,De=Pe.tileFramebuffer,$e=Se.transform.projection.name==="globe",at=Pe.paint.get("raster-particle-max-speed");for(const rt of Me){const[je,qe,mt]=rt;Ie.activeTexture.set(Ce.TEXTURE0+0),qe.texture.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE),De.colorAttachment.set(mt.targetColorTexture.texture);const Tt=Se.getOrCreateProgram("rasterParticleDraw",{defines:qe.defines,overrideFog:!1});Ie.activeTexture.set(Ce.TEXTURE0+1);const Lt=qe.scalarData?[]:[0,1,2,3].map(st=>i.d4[st](je));Lt.push(je);const et=je.canonical.x,xt=je.canonical.y;for(const st of Lt){const Rt=be.getTile($e?st.wrapped():st);if(!Rt)continue;const bt=Rt.rasterParticleState;if(!bt)continue;const gt=st.canonical.x+(1<<st.canonical.z)*(st.wrap-je.wrap),jt=st.canonical.y;bt.particleTexture0.bind(Ce.NEAREST,Ce.CLAMP_TO_EDGE);const Vt=oc(1,bt.particleTexture0.size[0],[gt-et,jt-xt],0,qe.texture.size,2,at,qe.textureOffset,qe.scale,qe.offset);Tt.draw(Se,Ce.POINTS,ir.disabled,Cr.disabled,Br.alphaBlended,mr.disabled,Vt,Pe.id,bt.particleIndexBuffer,void 0,bt.particleSegment)}}}(w,P,z,ie),D.bindFramebuffer.set(z.particleFramebuffer.framebuffer),function(Se,be,Pe,Me){const Ie=Se.context,Ce=Ie.gl,De=be.paint.get("raster-particle-max-speed"),$e=Me*be.paint.get("raster-particle-speed-factor")*.15,at=function(je){return Math.pow(je,6)}(.01+1*be.paint.get("raster-particle-reset-rate-factor")),rt=be.particleFramebuffer;Ie.viewport.set([0,0,rt.width,rt.height]);for(const je of Pe){const[,qe,mt]=je;Ie.activeTexture.set(Ce.TEXTURE0+0),qe.texture.bind(Ce.LINEAR,Ce.CLAMP_TO_EDGE),Ie.activeTexture.set(Ce.TEXTURE0+1);const Tt=mt.particleTexture0;Tt.bind(Ce.NEAREST,Ce.CLAMP_TO_EDGE);const Lt=nr(1,Tt.size[0],0,qe.texture.size,De,$e,at,qe.textureOffset,qe.scale,qe.offset);rt.colorAttachment.set(mt.particleTexture1.texture),Ie.clear({color:i.ai.transparent}),Se.getOrCreateProgram("rasterParticleUpdate",{defines:qe.defines}).draw(Se,Ce.TRIANGLES,ir.disabled,Cr.disabled,Br.unblended,mr.disabled,Lt,be.id,Se.viewportBuffer,Se.quadTriangleIndexBuffer,Se.viewportSegments)}}(w,z,ie,me)}(f,n,s,p),f.renderPass==="translucent"&&(function(w,P,z,k,D){const j=w.context,B=j.gl,G=P.getSource().tileSize,Q=5*(1-i.ab(i.bX,i.bX+1,w.transform.zoom))*G+z.paint.get("raster-particle-elevation"),J=!w.options.moving,ie=w.transform.projection.name==="globe";if(!k.length)return;const[oe,me]=w.stencilConfigForOverlap(k),Se=[];ie&&Se.push("PROJECTION_GLOBE_VIEW");const be=w.stencilModeFor3D();for(const Pe of me){const Me=Pe.toUnwrapped(),Ie=P.getTile(Pe);if(!Ie.rasterParticleState)continue;const Ce=Ie.rasterParticleState,De=100;Ie.registerFadeDuration(De);const $e=P.findLoadedParent(Pe,0),at=Vc(Ie,$e,P,w.transform,De);let rt,je;w.terrain&&w.terrain.prepareDrawTile(),j.activeTexture.set(B.TEXTURE0),Ce.targetColorTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),j.activeTexture.set(B.TEXTURE1),$e&&$e.rasterParticleState?($e.rasterParticleState.targetColorTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),rt=Math.pow(2,$e.tileID.overscaledZ-Ie.tileID.overscaledZ),je=[Ie.tileID.canonical.x*rt%1,Ie.tileID.canonical.y*rt%1]):Ce.targetColorTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE);const qe=ie?Float32Array.from(w.transform.expandedFarZProjMatrix):w.transform.calculateProjMatrix(Me,J),mt=w.transform,Tt=dm(mt),Lt=i.cD(Pe.canonical),et=i.cE(Lt.getCenter().lat);let xt,st,Rt,bt,gt;ie?(xt=Float32Array.from(i.ba(i.cG(Pe.canonical))),st=Float32Array.from(mt.globeMatrix),Rt=Float32Array.from(i.cC(mt)),bt=[i.as(mt.center.lng),i.az(mt.center.lat)],gt=Float32Array.from(i.cF(Pe.canonical,Lt,et,mt.worldSize/mt._pixelsPerMercatorPixel))):(xt=new Float32Array(16),st=new Float32Array(9),Rt=new Float32Array(16),bt=[0,0],gt=new Float32Array(9));const jt=ic(qe,xt,st,Rt,gt,je||[0,0],i.ad(w.transform.zoom),bt,Tt,rt||1,at,Q),Vt=w.isTileAffectedByFog(Pe),Bt=w.getOrCreateProgram("rasterParticle",{defines:Se,overrideFog:Vt});if(w.uploadCommonUniforms(j,Bt,Me),ie){const Zt=new ir(B.LEQUAL,ir.ReadOnly,w.depthRangeFor3D),wr=0,lr=w.globeSharedBuffers;if(lr){const[sr,Er,Jr]=lr.getGridBuffers(et,wr!==0);Bt.draw(w,B.TRIANGLES,Zt,be,Br.alphaBlended,w.renderElevatedRasterBackface?mr.frontCCW:mr.backCCW,jt,z.id,sr,Er,Jr)}}else{const Zt=w.depthModeForSublayer(0,ir.ReadOnly),wr=oe[Pe.overscaledZ],{tileBoundsBuffer:lr,tileBoundsIndexBuffer:sr,tileBoundsSegments:Er}=w.getTileBoundsBuffers(Ie);Bt.draw(w,B.TRIANGLES,Zt,wr,Br.alphaBlended,mr.disabled,jt,z.id,lr,sr,Er)}}w.resetStencilClippingMasks()}(f,n,s,p),f.style.map.triggerRepaint())},background:function(f,n,s,p){const _=s.paint.get("background-color"),y=s.paint.get("background-color-use-theme").constantOr("default")==="none",w=s.paint.get("background-opacity"),P=s.paint.get("background-emissive-strength"),z=s.paint.get("background-pitch-alignment")==="viewport";if(w===0)return;const k=f.context,D=k.gl,j=f.transform,B=j.tileSize,G=s.paint.get("background-pattern");let Q;if(G!==void 0&&(G===null||(Q=f.imageManager.getPattern(G.toString(),s.scope,f.style.getLut(s.scope)),!Q)))return;const J=!G&&_.a===1&&w===1&&f.opaquePassEnabledForLayer()?"opaque":"translucent";if(f.renderPass!==J)return;const ie=Cr.disabled,oe=f.depthModeForSublayer(0,J==="opaque"?ir.ReadWrite:ir.ReadOnly),me=f.colorModeForDrapableLayerRenderPass(P),Se=G?"backgroundPattern":"background";let be,Pe=p;if(Pe||(be=f.getBackgroundTiles(),Pe=Object.values(be).map(Me=>Me.tileID)),G&&(k.activeTexture.set(D.TEXTURE0),f.imageManager.bind(f.context,s.scope)),z){const Me=f.getOrCreateProgram(Se,{overrideFog:!1,overrideRtt:!0}),Ie=new Float32Array(i.aa.mat4.identity([])),Ce=new i.aF(0,0,0,0,0),De=G?Gd(Ie,P,w,f,0,s.scope,Q,z,{tileID:Ce,tileSize:B}):E0(Ie,P,w,_.toRenderColor(y?null:s.lut));Me.draw(f,D.TRIANGLES,oe,ie,me,mr.disabled,De,s.id,f.viewportBuffer,f.quadTriangleIndexBuffer,f.viewportSegments)}else for(const Me of Pe){const Ie=f.isTileAffectedByFog(Me),Ce=f.getOrCreateProgram(Se,{overrideFog:Ie}),De=Me.toUnwrapped(),$e=p?Me.projMatrix:f.transform.calculateProjMatrix(De);f.prepareDrawTile();const at=n?n.getTile(Me):be?be[Me.key]:new ya(Me,B,j.zoom,f),rt=G?Gd($e,P,w,f,0,s.scope,Q,z,{tileID:Me,tileSize:B}):E0($e,P,w,_.toRenderColor(y?null:s.lut));f.uploadCommonUniforms(k,Ce,De);const{tileBoundsBuffer:je,tileBoundsIndexBuffer:qe,tileBoundsSegments:mt}=f.getTileBoundsBuffers(at);Ce.draw(f,D.TRIANGLES,oe,ie,me,mr.disabled,rt,s.id,je,qe,mt)}},sky:function(f,n,s){const p=f._atmosphere?i.ad(f.transform.zoom):1,_=s.paint.get("sky-opacity")*p;if(_===0)return;const y=f.context,w=s.paint.get("sky-type"),P=new ir(y.gl.LEQUAL,ir.ReadOnly,[0,1]),z=f.frameCounter/1e3%1;w==="atmosphere"?f.renderPass==="offscreen"?s.needsSkyboxCapture(f)&&(function(k,D,j,B){const G=k.context,Q=G.gl;let J=D.skyboxFbo;if(!J){J=D.skyboxFbo=G.createFramebuffer(32,32,!0,null),D.skyboxGeometry=new ph(G),D.skyboxTexture=G.gl.createTexture(),Q.bindTexture(Q.TEXTURE_CUBE_MAP,D.skyboxTexture),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_MIN_FILTER,Q.LINEAR),Q.texParameteri(Q.TEXTURE_CUBE_MAP,Q.TEXTURE_MAG_FILTER,Q.LINEAR);for(let Se=0;Se<6;++Se)Q.texImage2D(Q.TEXTURE_CUBE_MAP_POSITIVE_X+Se,0,Q.RGBA,32,32,0,Q.RGBA,Q.UNSIGNED_BYTE,null)}G.bindFramebuffer.set(J.framebuffer),G.viewport.set([0,0,32,32]);const ie=D.getCenter(k,!0),oe=k.getOrCreateProgram("skyboxCapture"),me=new Float64Array(16);i.aa.mat4.identity(me),i.aa.mat4.rotateY(me,me,.5*-Math.PI),Fo(k,D,oe,me,ie,0),i.aa.mat4.identity(me),i.aa.mat4.rotateY(me,me,.5*Math.PI),Fo(k,D,oe,me,ie,1),i.aa.mat4.identity(me),i.aa.mat4.rotateX(me,me,.5*-Math.PI),Fo(k,D,oe,me,ie,2),i.aa.mat4.identity(me),i.aa.mat4.rotateX(me,me,.5*Math.PI),Fo(k,D,oe,me,ie,3),i.aa.mat4.identity(me),Fo(k,D,oe,me,ie,4),i.aa.mat4.identity(me),i.aa.mat4.rotateY(me,me,Math.PI),Fo(k,D,oe,me,ie,5),G.viewport.set([0,0,k.width,k.height])}(f,s),s.markSkyboxValid(f)):f.renderPass==="sky"&&function(k,D,j,B,G){const Q=k.context,J=Q.gl,ie=k.transform,oe=k.getOrCreateProgram("skybox");Q.activeTexture.set(J.TEXTURE0),J.bindTexture(J.TEXTURE_CUBE_MAP,D.skyboxTexture);const me=((Se,be,Pe,Me,Ie)=>({u_matrix:Se,u_sun_direction:be,u_cubemap:0,u_opacity:Me,u_temporal_offset:Ie}))(ie.skyboxMatrix,D.getCenter(k,!1),0,B,G);k.uploadCommonUniforms(Q,oe),oe.draw(k,J.TRIANGLES,j,Cr.disabled,k.colorModeForRenderPass(),mr.backCW,me,"skybox",D.skyboxGeometry.vertexBuffer,D.skyboxGeometry.indexBuffer,D.skyboxGeometry.segment)}(f,s,P,_,z):w==="gradient"&&f.renderPass==="sky"&&function(k,D,j,B,G){const Q=k.context,J=Q.gl,ie=k.transform,oe=k.getOrCreateProgram("skyboxGradient");D.skyboxGeometry||(D.skyboxGeometry=new ph(Q)),Q.activeTexture.set(J.TEXTURE0);let me=D.colorRampTexture;me||(me=D.colorRampTexture=new i.T(Q,D.colorRamp,J.RGBA8)),me.bind(J.LINEAR,J.CLAMP_TO_EDGE);const Se=((be,Pe,Me,Ie,Ce)=>({u_matrix:be,u_color_ramp:0,u_center_direction:Pe,u_radius:i.ah(Me),u_opacity:Ie,u_temporal_offset:Ce}))(ie.skyboxMatrix,D.getCenter(k,!1),D.paint.get("sky-gradient-radius"),B,G);k.uploadCommonUniforms(Q,oe),oe.draw(k,J.TRIANGLES,j,Cr.disabled,k.colorModeForRenderPass(),mr.backCW,Se,"skyboxGradient",D.skyboxGeometry.vertexBuffer,D.skyboxGeometry.indexBuffer,D.skyboxGeometry.segment)}(f,s,P,_,z)},debug:function(f,n,s,p,_,y){for(let w=0;w<s.length;w++)if(_){const k=new i.ai(p.r*.8,p.g*.8,p.b*.8,1);Yc(f,n,s[w],p,-1,-1,y),Yc(f,n,s[w],p,-1,1,y),Yc(f,n,s[w],p,1,1,y),Yc(f,n,s[w],p,1,-1,y),Yc(f,n,s[w],k,0,0,y)}else Yc(f,n,s[w],p,0,0,y)},custom:function(f,n,s,p){const _=f.context,y=s.implementation;if(!f.transform.projection.unsupportedLayers||!f.transform.projection.unsupportedLayers.includes("custom")||f.terrain&&(f.terrain.renderingToTexture||f.renderPass==="offscreen")&&s.isDraped(n)){if(f.renderPass==="offscreen"){const w=y.prerender;if(w){if(f.setCustomLayerDefaults(),_.setColorMode(f.colorModeForRenderPass()),f.transform.projection.name==="globe"){const P=f.transform.pointMerc;w.call(y,_.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),i.ad(f.transform.zoom),[P.x,P.y],f.transform.pixelsPerMeterRatio)}else w.call(y,_.gl,f.transform.customLayerMatrix());_.setDirty(),f.setBaseState()}}else if(f.renderPass==="translucent"){if(f.terrain&&f.terrain.renderingToTexture){const P=y.renderToTile;if(P){const z=p[0].canonical,k=new i.a9(z.x+p[0].wrap*(1<<z.z),z.y,z.z);_.setDepthMode(ir.disabled),_.setStencilMode(Cr.disabled),_.setColorMode(f.colorModeForRenderPass()),f.setCustomLayerDefaults(),P.call(y,_.gl,k),_.setDirty(),f.setBaseState()}return}f.setCustomLayerDefaults(),_.setColorMode(f.colorModeForRenderPass()),_.setStencilMode(Cr.disabled);const w=y.renderingMode==="3d"?new ir(f.context.gl.LEQUAL,ir.ReadWrite,f.depthRangeFor3D):f.depthModeForSublayer(0,ir.ReadOnly);if(_.setDepthMode(w),f.transform.projection.name==="globe"){const P=f.transform.pointMerc;y.render(_.gl,f.transform.customLayerMatrix(),f.transform.getProjection(),f.transform.globeToMercatorMatrix(),i.ad(f.transform.zoom),[P.x,P.y],f.transform.pixelsPerMeterRatio)}else y.render(_.gl,f.transform.customLayerMatrix());_.setDirty(),f.setBaseState(),_.bindFramebuffer.set(null)}}else i.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(f,n,s,p){if(f.renderPass==="opaque")return;const _=s.paint.get("model-opacity").constantOr(1);if(_===0)return;const y=s.paint.get("model-cast-shadows");if(f.renderPass==="shadow"&&(!y||f.terrain&&_<.65&&s._transitionablePaint._values["model-opacity"].value.expression instanceof i.a8))return;const w=f.shadowRenderer,P=s.paint.get("model-receive-shadows");w&&(w.useNormalOffset=!0,P||(w.enabled=!1));const z=()=>{w&&(w.useNormalOffset=!0,P||(w.enabled=!0))},k=n.getSource();if(f.renderPass==="light-beam"&&k.type!=="batched-model")return;if(k.type==="vector"||k.type==="geojson")return function(oe,me,Se,be,Pe){const Me=oe.transform;if(Me.projection.name!=="mercator")return void i.w(`Drawing 3D models for ${Me.projection.name} projection is not yet implemented`);const Ie=Me.getFreeCameraOptions().position;if(!oe.modelManager)return;const Ce=oe.modelManager;Se.modelManager=Ce;const De=oe.shadowRenderer;if(!Se._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const $e=Se._unevaluatedLayout._values["model-id"],at={...Se.layout.get("model-id").parameters},rt=oe.style.order.indexOf(Se.fqid);for(const je of be){const qe=me.getTile(je).getBucket(Se);if(!qe||qe.projection.name!==Me.projection.name)continue;const mt=qe.getModelUris();mt&&!qe.modelsRequested&&(Ce.addModelsFromBucket(mt,Pe),qe.modelsRequested=!0);const Tt=pm(je,Me);at.zoom=Tt;const Lt=$e.possiblyEvaluate(at);if(Qc(oe,qe,je),Sa.shadowUniformsInitialized=!1,Sa.useSingleShadowCascade=!!De&&De.getMaxCascadeForTile(je.toUnwrapped())===0,oe.renderPass==="shadow"&&De){if(oe.currentShadowCascade===1&&qe.isInsideFirstShadowMapFrustum)continue;const st=Me.calculatePosMatrix(je.toUnwrapped(),Me.worldSize);if(Sa.tileMatrix.set(st),Sa.shadowTileMatrix=Float32Array.from(De.calculateShadowPassMatrixFromMatrix(st)),Sa.aabb.min.fill(0),Sa.aabb.max[0]=Sa.aabb.max[1]=i.af,Sa.aabb.max[2]=0,El(qe,Sa,oe,Se.scope))continue}const et=1<<je.canonical.z,xt=[((Ie.x-je.wrap)*et-je.canonical.x)*i.af,(Ie.y*et-je.canonical.y)*i.af,Ie.z*et*i.af];oe.conflationActive&&Object.keys(qe.instancesPerModel).length>0&&oe.style.isLayerClipped(Se,me.getSource())&&qe.updateReplacement(je,oe.replacementSource,rt,Pe)&&(qe.uploaded=!1,qe.upload(oe.context));for(let st in qe.instancesPerModel){const Rt=qe.instancesPerModel[st];Rt.features.length>0&&(st=Lt.evaluate(Rt.features[0].feature,{}));const bt=Ce.getModel(st,Pe);if(bt&&bt.uploaded)for(const gt of bt.nodes)Vs(oe,Se,gt,Rt,xt,je,Sa)}}}(f,n,s,p,k.type==="vector"?s.scope:""),void z();if(!k.loaded())return;if(k.type==="batched-model")return function(oe,me,Se,be){Se.resetLayerRenderingStats(oe);const Pe=oe.context,Me=oe.transform,Ie=oe.style.fog,Ce=oe.shadowRenderer;if(Me.projection.name!=="mercator")return void i.w(`Drawing 3D landmark models for ${Me.projection.name} projection is not yet implemented`);const De=oe.transform.getFreeCameraOptions().position,$e=i.aa.vec3.scale([],[De.x,De.y,De.z],oe.transform.worldSize),at=i.aa.vec3.negate([],$e),rt=i.aa.mat4.identity([]),je=i.dj(Me.center.lat,Me.zoom),qe=i.aa.mat4.fromScaling([],[1,1,1/je]);i.aa.mat4.translate(rt,rt,at);const mt=Se.paint.get("model-opacity").constantOr(1),Tt=new ir(Pe.gl.LEQUAL,ir.ReadWrite,oe.depthRangeFor3D),Lt=new ir(Pe.gl.LEQUAL,ir.ReadOnly,oe.depthRangeFor3D),et=new i.cc([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),xt=oe.renderPass==="shadow",st=xt&&Ce?Ce.getCurrentCascadeFrustum():Me.getFrustum(Me.scaleZoom(Me.worldSize)),Rt=Se.paint.get("model-front-cutoff"),bt=Rt[2]<1,gt=Fs(oe,Se.paint.get("model-cutoff-fade-range")),jt=Se.getLayerRenderingStats();(function(Vt,Bt,Zt,wr){const lr=Vt.terrain?Vt.terrain.exaggeration():0,sr=Vt.transform.zoom;for(const Er of wr){const Jr=Bt.getTile(Er).getBucket(Zt);Jr&&(Vt.conflationActive&&Jr.updateReplacement(Er,Vt.replacementSource),Jr.evaluateScale(Vt,Zt),Vt.terrain&&lr>0&&Jr.elevationUpdate(Vt.terrain,lr,Er,Zt.source),Jr.needsReEvaluation(Vt,sr,Zt)&&Jr.evaluate(Zt))}})(oe,me,Se,be),function(){let Vt,Bt,Zt;bt?(Vt=be.length-1,Bt=-1,Zt=-1):(Vt=0,Bt=be.length,Zt=1);const wr=new Float64Array(16),lr=i.aa.vec3.create(),sr=new i.P(0,0);for(let Er=Vt;Er!==Bt;Er+=Zt){const Jr=be[Er],Or=me.getTile(Jr).getBucket(Se);if(!Or||!Or.uploaded)continue;let jn=!1;Ce&&(jn=Ce.getMaxCascadeForTile(Jr.toUnwrapped())===0);const Pn=Me.calculatePosMatrix(Jr.toUnwrapped(),Me.worldSize),un=Or.modelTraits;!xt&&bt&&(i.aa.mat4.invert(wr,Pn),i.aa.vec3.transformMat4(lr,$e,wr),sr.x=lr[0],sr.y=lr[1]);const yn=[];for(const Fr of Or.getNodesInfo()){if(Fr.hiddenByReplacement||!Fr.node.meshes)continue;const Qr=Fr.node;let pr=0;oe.terrain&&Qr.elevation&&(pr=Qr.elevation*oe.terrain.exaggeration());const an=(()=>{const en=Fr.aabb;return et.min=[...en.min],et.max=[...en.max],et.min[2]+=pr,et.max[2]+=pr,i.aa.vec3.transformMat4(et.min,et.min,Pn),i.aa.vec3.transformMat4(et.max,et.max,Pn),et})(),ei=Fr.evaluatedScale;if(ei[0]<=1&&ei[1]<=1&&ei[2]<=1&&an.intersects(st)===0)continue;if(!xt&&bt){const en=.16666666666666666;Fr.cameraCollisionOpacity=$e[0]>an.min[0]&&$e[0]<an.max[0]&&$e[1]>an.min[1]&&$e[1]<an.max[1]&&$e[2]*je<an.max[2]&&Qr.footprint&&i.bz(sr,Qr.footprint)?Math.max(Fr.cameraCollisionOpacity-en,0):Math.min(1,Fr.cameraCollisionOpacity+en)}const $i=[...Pn],ra=Qr.anchor?Qr.anchor[0]:0,po=Qr.anchor?Qr.anchor[1]:0;i.aa.mat4.translate($i,$i,[ra*(ei[0]-1),po*(ei[1]-1),pr]),i.aa.vec3.exactEquals(ei,i.dm)||i.aa.mat4.scale($i,$i,ei);const ki=i.aa.mat4.multiply([],$i,Qr.matrix),vi=i.aa.mat4.multiply([],Me.expandedFarZProjMatrix,ki),oi=i.aa.mat4.multiply([],Me.expandedFarZProjMatrix,$i),On=i.aa.vec4.transformMat4([],[ra,po,pr,1],vi)[2];Qr.hidden=!1;let Tn=mt;xt||(bt&&(Tn*=Fr.cameraCollisionOpacity,Tn*=Kd($i,Me,Fr.aabb,Rt)),Tn*=Yd(gt,On)),Tn!==0?yn.push({nodeInfo:Fr,depth:On,opacity:Tn,wvpForNode:vi,wvpForTile:oi,nodeModelMatrix:ki,tileModelMatrix:$i}):Qr.hidden=!0}xt||yn.sort((Fr,Qr)=>!bt||Fr.opacity===1&&Qr.opacity===1?Fr.depth<Qr.depth?-1:1:Fr.opacity===1?-1:Qr.opacity===1?1:Fr.depth>Qr.depth?-1:1);for(const Fr of yn){const Qr=Fr.nodeInfo,pr=Qr.node;let an=i.aa.mat4.multiply([],qe,Fr.tileModelMatrix);i.aa.mat4.multiply(an,rt,an);const ei=i.aa.mat4.invert([],an);i.aa.mat4.transpose(ei,ei),i.aa.mat4.scale(ei,ei,Sl),an=i.aa.mat4.multiply(an,an,pr.matrix);const $i=oe.renderPass==="light-beam",ra=Se.paint.get("model-color-use-theme").constantOr("default")==="none",po=un&i.dp.HasMapboxMeshFeatures,ki=po?0:Qr.evaluatedRMEA[0][2];for(let vi=0;vi<pr.meshes.length;++vi){const oi=pr.meshes[vi],On=vi===pr.lightMeshIndex;let Tn=Fr.wvpForNode;if(On){if(!$i&&!oe.terrain&&oe.shadowRenderer){oe.currentLayer<oe.firstLightBeamLayer&&(oe.firstLightBeamLayer=oe.currentLayer);continue}Tn=Fr.wvpForTile}else if($i)continue;const en={defines:[]},ni=[];if(!xt&&Ce&&(Ce.useNormalOffset=!!oi.normalBuffer),on(en.defines,ni,oi,oe,ra?null:Se.lut),po||en.defines.push("DIFFUSE_SHADED"),jn&&en.defines.push("SHADOWS_SINGLE_CASCADE"),jt&&(xt?jt.numRenderedVerticesInShadowPass+=oi.vertexArray.length:jt.numRenderedVerticesInTransparentPass+=oi.vertexArray.length),xt){Jc(oi,Fr.nodeModelMatrix,oe,Se);continue}let Di=null;if(Ie){const hs=Dn(Fr.nodeModelMatrix,oe.transform);if(Di=new Float32Array(hs),Me.projection.name!=="globe"){const mo=oi.aabb.min,ua=oi.aabb.max,[qs,$a]=Ie.getOpacityForBounds(hs,mo[0],mo[1],ua[0],ua[1]);en.overrideFog=qs>=St||$a>=St}}const An=oi.material;let io;An.occlusionTexture&&An.occlusionTexture.offsetScale&&(io=An.occlusionTexture.offsetScale,en.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const ca=oe.getOrCreateProgram("model",en);!xt&&Ce&&Ce.setupShadowsFromMatrix(Fr.tileModelMatrix,ca,Ce.useNormalOffset),oe.uploadCommonUniforms(Pe,ca,null,Di);const No=An.pbrMetallicRoughness;No.metallicFactor=.9,No.roughnessFactor=.5;const Ws=Wd(new Float32Array(Tn),new Float32Array(an),new Float32Array(ei),new Float32Array(pr.matrix),oe,Fr.opacity,No.baseColorFactor.toRenderColor(null),An.emissiveFactor,No.metallicFactor,No.roughnessFactor,An,ki,Se,[0,0,0],io);!On&&(Qr.hasTranslucentParts||Fr.opacity<1)&&ca.draw(oe,Pe.gl.TRIANGLES,Tt,Cr.disabled,Br.disabled,mr.backCCW,Ws,Se.id,oi.vertexBuffer,oi.indexBuffer,oi.segments,Se.paint,oe.transform.zoom,void 0,ni),ca.draw(oe,Pe.gl.TRIANGLES,On?Lt:Tt,Cr.disabled,On||Fr.opacity<1||Qr.hasTranslucentParts?Br.alphaBlended:Br.unblended,mr.backCCW,Ws,Se.id,oi.vertexBuffer,oi.indexBuffer,oi.segments,Se.paint,oe.transform.zoom,void 0,ni)}}}}()}(f,n,s,p),void z();if(k.type!=="model")return;const D=k.getModels(),j=[],B=f.transform.getFreeCameraOptions().position,G=i.aa.vec3.scale([],[B.x,B.y,B.z],f.transform.worldSize);i.aa.vec3.negate(G,G);const Q=[],J=[];let ie=0;for(const oe of D){const me=s.paint.get("model-rotation").constantOr(null),Se=s.paint.get("model-scale").constantOr(null),be=s.paint.get("model-translation").constantOr(null);oe.computeModelMatrix(f,me,Se,be,!0,!0,!1);const Pe=i.aa.mat4.identity([]),Me=i.dj(oe.position.lat,f.transform.zoom),Ie=i.aa.mat4.fromScaling([],[1,1,1/Me]);i.aa.mat4.translate(Pe,Pe,G),j.push({zScaleMatrix:Ie,negCameraPosMatrix:Pe});for(const Ce of oe.nodes)$s(f.transform,Ce,oe.matrix,f.transform.expandedFarZProjMatrix,ie,Q,J);ie++}if(Q.sort((oe,me)=>me.depth-oe.depth),f.renderPass!=="shadow"){if(_===1)for(const oe of J)gh(oe,f,s,j[oe.modelIndex],Cr.disabled,f.colorModeForRenderPass());else{for(const oe of J)gh(oe,f,s,j[oe.modelIndex],Cr.disabled,Br.disabled);for(const oe of J)gh(oe,f,s,j[oe.modelIndex],f.stencilModeFor3D(),f.colorModeForRenderPass());f.resetStencilClippingMasks()}for(const oe of Q)gh(oe,f,s,j[oe.modelIndex],Cr.disabled,f.colorModeForRenderPass());z()}else{for(const oe of J)Jc(oe.mesh,oe.nodeModelMatrix,f,s);for(const oe of Q)Jc(oe.mesh,oe.nodeModelMatrix,f,s);z()}}},ef={model:function(f,n,s){const p=n.getSource();if(!p.loaded())return;if(p.type==="vector"||p.type==="geojson")return void(s.modelManager&&s.modelManager.upload(s,p.type==="vector"?f.scope:""));if(p.type==="batched-model"||p.type!=="model")return;const _=p.getModels();for(const y of _)y.upload(s.context)},raster:function(f,n,s){const p=n.getSource();if(!(p instanceof Si&&p.loaded()))return;const _=f.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!_)return;const y=f.paint.get("raster-array-band")||p.getInitialBand(_);if(y==null)return;const w=n.getIds().map(P=>n.getTileByID(P));for(const P of w)P.updateNeeded(_,y)&&p.prepareTile(P,_,y)},"raster-particle":function(f,n,s){const p=n.getSource();if(!(p instanceof Si&&p.loaded()))return;const _=f.sourceLayer||p.rasterLayerIds&&p.rasterLayerIds[0];if(!_)return;const y=f.paint.get("raster-particle-array-band")||p.getInitialBand(_);if(y==null)return;const w=n.getIds().map(P=>n.getTileByID(P));for(const P of w)P.updateNeeded(_,y)&&p.prepareTile(P,_,y)}};class Em{constructor(n,s,p,_,y){this.context=new Jo(n,s),this.transform=p,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=y,this._timeStamp=i.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const w=["fill","line","symbol","circle","heatmap","fill-extrusion","raster","raster-particle","hillshade","model","background","sky"];for(const z of w)this._debugParams.enabledLayers[z]=!0;y.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),y.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),y.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),y.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),y.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),y.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const z of w)y.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],z);this.occlusionParams=new _m(y),this.setup(),this.numSublayers=bo.maxUnderzooming+bo.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new i.dv,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Bs(this),this._wireframeDebugCache=new gm,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const P=new i.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new i.T(this.context,P,n.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=_}updateTerrain(n,s){const p=!!n&&!!n.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Od(this,n));const _=this._terrain;this.transform.elevation=p?_:null,_.update(n,this.transform,s),this.transform.elevation&&!_.enabled&&(this.transform.elevation=null)}_updateFog(n){const s=n.fog;if(!s||this.transform.projection.name==="globe"||s.getOpacity(this.transform.pitch)<1||s.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,_]=s.getFovAdjustedRange(this.transform._fov);if(p>_)return void(this.transform.fogCullDistSq=null);const y=p+.78*(_-p);this.transform.fogCullDistSq=y*y}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(n){n&&!this._terrain&&(this._terrain=new Od(this,this.style)),this._forceTerrainMode=n}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(n,s){if(this.width=n*i.q.devicePixelRatio,this.height=s*i.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._mergedLayers[p].resize()}setup(){const n=this.context,s=new i.b3;s.emplaceBack(0,0),s.emplaceBack(i.af,0),s.emplaceBack(0,i.af),s.emplaceBack(i.af,i.af),this.tileExtentBuffer=n.createVertexBuffer(s,i.b5.members),this.tileExtentSegments=i.b6.simpleSegment(0,0,4,2);const p=new i.b3;p.emplaceBack(0,0),p.emplaceBack(i.af,0),p.emplaceBack(0,i.af),p.emplaceBack(i.af,i.af),this.debugBuffer=n.createVertexBuffer(p,i.b5.members),this.debugSegments=i.b6.simpleSegment(0,0,4,5);const _=new i.b3;_.emplaceBack(-1,-1),_.emplaceBack(1,-1),_.emplaceBack(-1,1),_.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(_,i.b5.members),this.viewportSegments=i.b6.simpleSegment(0,0,4,2);const y=new i.aS;y.emplaceBack(0,0,0,0),y.emplaceBack(i.af,0,i.af,0),y.emplaceBack(0,i.af,0,i.af),y.emplaceBack(i.af,i.af,i.af,i.af),this.mercatorBoundsBuffer=n.createVertexBuffer(y,i.b8.members),this.mercatorBoundsSegments=i.b6.simpleSegment(0,0,4,2);const w=new i.aT;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(w);const P=new i.b4;for(const k of[0,1,3,2,0])P.emplaceBack(k);this.debugIndexBuffer=n.createIndexBuffer(P),this.emptyTexture=new i.T(n,new i.r({width:1,height:1},Uint8Array.of(0,0,0,0)),n.gl.RGBA8),this.identityMat=i.aa.mat4.create();const z=this.context.gl;this.stencilClearMode=new Cr({func:z.ALWAYS,mask:0},0,255,z.ZERO,z.ZERO,z.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(n){return n._makeTileBoundsBuffers(this.context,this.transform.projection),n._tileBoundsBuffer?{tileBoundsBuffer:n._tileBoundsBuffer,tileBoundsIndexBuffer:n._tileBoundsIndexBuffer,tileBoundsSegments:n._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const n=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,n.TRIANGLES,ir.disabled,this.stencilClearMode,Br.disabled,mr.disabled,sh(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(n,s,p){if(!s||this.currentStencilSource===s.id||!n.isTileClipped()||!p||p.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let P=!1;for(const z of p)if(this._tileClippingMaskIDs[z.key]===void 0){P=!0;break}if(!P)return}this.currentStencilSource=s.id;const _=this.context,y=_.gl;this.nextStencilID+p.length>256&&this.clearStencil(),_.setColorMode(Br.disabled),_.setDepthMode(ir.disabled);const w=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const P of p){const z=s.getTile(P),k=this._tileClippingMaskIDs[P.key]=this.nextStencilID++,{tileBoundsBuffer:D,tileBoundsIndexBuffer:j,tileBoundsSegments:B}=this.getTileBoundsBuffers(z);w.draw(this,y.TRIANGLES,ir.disabled,new Cr({func:y.ALWAYS,mask:0},k,255,y.KEEP,y.KEEP,y.REPLACE),Br.disabled,mr.disabled,sh(P.projMatrix),"$clipping",D,j,B)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,s=this.context.gl;return new Cr({func:s.NOTEQUAL,mask:255},n,255,s.KEEP,s.KEEP,s.REPLACE)}stencilModeForClipping(n){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(n);const s=this.context.gl;return new Cr({func:s.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,s.KEEP,s.KEEP,s.REPLACE)}stencilConfigForOverlap(n){const s=this.context.gl,p=n.sort((w,P)=>P.overscaledZ-w.overscaledZ),_=p[p.length-1].overscaledZ,y=p[0].overscaledZ-_+1;if(y>1){this.currentStencilSource=void 0,this.nextStencilID+y>256&&this.clearStencil();const w={};for(let P=0;P<y;P++)w[P+_]=new Cr({func:s.GEQUAL,mask:255},P+this.nextStencilID,255,s.KEEP,s.KEEP,s.REPLACE);return this.nextStencilID+=y,[w,p]}return[{[_]:Cr.disabled},p]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new Br([n.CONSTANT_COLOR,n.ONE,n.CONSTANT_COLOR,n.ONE],new i.ai(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Br.unblended:Br.alphaBlended}colorModeForDrapableLayerRenderPass(n){const s=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture)()&&this.renderPass==="translucent"?new Br([s.ONE,s.ONE_MINUS_SRC_ALPHA,s.CONSTANT_ALPHA,s.ONE_MINUS_SRC_ALPHA],new i.ai(0,0,0,n===void 0?0:n),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(n,s,p,_=!1){if(this.depthOcclusion)return new ir(this.context.gl.GREATER,ir.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!_)return ir.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new ir(p||this.context.gl.LEQUAL,s,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const n=this.context.gl,s=Math.ceil(this.width),p=Math.ceil(this.height),_=this.context.bindFramebuffer.get(),y=n.getParameter(n.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===s&&this.depthFBO.height===p||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),s!==0&&p!==0&&(this.depthFBO=new qd(this.context,s,p,!1,"texture"),this.depthTexture=new i.T(this.context,{width:s,height:p,data:null},n.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(_),n.bindTexture(n.TEXTURE_2D,y),this.depthFBO&&(n.bindFramebuffer(n.READ_FRAMEBUFFER,null),n.bindFramebuffer(n.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),n.blitFramebuffer(0,0,s,p,0,0,s,p,n.DEPTH_BUFFER_BIT,n.NEAREST),n.bindFramebuffer(n.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((n,s)=>n+s/this._fpsHistory.length,0))}render(n,s){const p=i.q.now();this._dt=p-this._timeStamp,this._timeStamp=p,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=n.map.repaint,this.style=n,this.options=s;const _=this.style._mergedLayers,y=this.style._getOrder(!(!this.terrain||!this.terrain.enabled)).filter(je=>{const qe=_[je];return!(qe.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[qe.type]});let w=!1,P=!1;for(const je of y){const qe=_[je];qe.type==="circle"&&(w=!0),qe.type==="symbol"&&(qe.hasInitialOcclusionOpacityProperties?P=!0:w=!0)}const z=y.map(je=>_[je]),k=this.style._mergedSourceCaches;this.imageManager=n.imageManager,this.modelManager=n.modelManager,this.symbolFadeChange=n.placement.symbolFadeChange(i.q.now()),this.imageManager.beginFrame();let D=0,j=!1;for(const je in k){const qe=k[je];qe.used&&(qe.prepare(this.context),qe.getSource().usedInConflation&&++D)}let B=!1;for(const je of z)je.isHidden(this.transform.zoom)||(je.type==="clip"&&(B=!0),this.prepareLayer(je));const G={},Q={},J={},ie={},oe={};for(const je in k){const qe=k[je];G[je]=qe.getVisibleCoordinates(),Q[je]=G[je].slice().reverse(),J[je]=qe.getVisibleCoordinates(!0).reverse(),ie[je]=qe.getShadowCasterCoordinates(),oe[je]=qe.sortCoordinatesByDistance(G[je])}const me=je=>{const qe=this.style.getLayerSourceCache(je);return qe&&qe.used?qe.getSource():null};if(D||B||this._clippingActiveLastFrame){const je=[],qe=[];let mt=0;for(const Tt of z)this.isSourceForClippingOrConflation(Tt,me(Tt))&&(je.push(Tt),qe.push(mt)),mt++;if(je&&(B||je.length>1)||this._clippingActiveLastFrame){B=!1;const Tt=[];for(let Lt=0;Lt<je.length;Lt++){const et=je[Lt],xt=qe[Lt],st=this.style.getLayerSourceCache(et);if(!st||!st.used||!st.getSource().usedInConflation&&et.type!=="clip")continue;let Rt=i.dx,bt=i.bx.None;const gt=[];let jt=!0;if(et.type==="clip"){Rt=xt;for(const Vt of et.layout.get("clip-layer-types"))bt|=Vt==="model"?i.bx.Model:Vt==="symbol"?i.bx.Symbol:i.bx.FillExtrusion;for(const Vt of et.layout.get("clip-layer-scope"))gt.push(Vt);et.isHidden(this.transform.zoom)?jt=!1:B=!0}jt&&Tt.push({layer:et.fqid,cache:st,order:Rt,clipMask:bt,clipScope:gt})}this.replacementSource.setSources(Tt),j=!0}}this._clippingActiveLastFrame=B,j||this.replacementSource.clear(),this.conflationActive=j,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let je=0;je<z.length;je++){const qe=z[je],mt=qe.cutoffRange();if(this.longestCutoffRange=Math.max(mt,this.longestCutoffRange),mt>0){const Tt=me(qe);Tt&&(this.minCutoffZoom=Math.max(Tt.minzoom,this.minCutoffZoom)),qe.minzoom&&(this.minCutoffZoom=Math.max(qe.minzoom,this.minCutoffZoom))}qe.is3D()&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=je),this._lastOcclusionLayer=je)}const Se=this.style&&this.style.fog;Se?(this._fogVisible=Se.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Se.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(J),this.opaquePassCutoff=0);const be=this._shadowRenderer;if(be){be.updateShadowParameters(this.transform,this.style.directionalLight);for(const je in k)for(const qe of G[je]){let mt={min:0,max:0};this.terrain&&(mt=this.terrain.getMinMaxForTile(qe)||mt),be.addShadowReceiver(qe.toUnwrapped(),mt.min,mt.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new i.dw(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new mh(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const Pe=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Me=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(Pe&&!this._snow&&(this._snow=new Sm(this)),!Pe&&this._snow&&(this._snow.destroy(),delete this._snow),Me&&!this._rain&&(this._rain=new bm(this)),!Me&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!Lr.has(this.context.gl))return;this.renderPass="offscreen";for(const je of z){const qe=n.getLayerSourceCache(je);if(!je.hasOffscreenPass()||je.isHidden(this.transform.zoom))continue;const mt=qe?Q[qe.id]:void 0;(je.type==="custom"||je.type==="raster"||je.type==="raster-particle"||je.isSky()||mt&&mt.length)&&this.renderLayer(this,qe,je,mt)}this.depthRangeFor3D=[0,1-(z.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,ie)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const Ie=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),Ce=(()=>{if(s.showOverdrawInspector)return i.ai.black;const je=this.style.fog;if(je&&this.transform.projection.supportsFog){const qe=this.style.getLut(je.scope);if(!Ie){const mt=je.properties.get("color-use-theme")==="none",Tt=je.properties.get("color").toRenderColor(mt?null:qe).toArray01();return new i.ai(...Tt)}if(Ie){const mt=je.properties.get("space-color-use-theme")==="none",Tt=je.properties.get("space-color").toRenderColor(mt?null:qe).toArray01();return new i.ai(...Tt)}}return i.ai.transparent})();if(this.context.clear({color:Ce,depth:1}),this.clearStencil(),this._showOverdrawInspector=s.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ie&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const je=z[this.currentLayer],qe=n.getLayerSourceCache(je);if(je.isSky())continue;const mt=qe?(je.is3D()?oe:Q)[qe.id]:void 0;this._renderTileClippingMasks(je,qe,mt),this.renderLayer(this,qe,je,mt)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&Ie&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||i.ad(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const je=z[this.currentLayer],qe=n.getLayerSourceCache(je);je.isSky()&&this.renderLayer(this,qe,je,qe?Q[qe.id]:void 0)}function De(je,qe){let mt;return qe&&(mt=(je.type==="symbol"?J:je.is3D()?oe:Q)[qe.id]),mt}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<y.length;){const je=z[this.currentLayer];if(je.type==="raster"||je.type==="raster-particle"){const qe=n.getLayerSourceCache(je);this.renderLayer(this,qe,je,De(je,qe))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let $e=0;be&&($e=be.getShadowCastingLayerCount());let at=!1,rt=-1;for(let je=0;je<y.length;++je){const qe=z[je];qe.isHidden(this.transform.zoom)||qe.is3D()&&(rt=je)}for(P&&rt===-1&&(w=!0);this.currentLayer<y.length;){const je=z[this.currentLayer],qe=n.getLayerSourceCache(je);if(je.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(je)){if(je.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(w&&!at&&this.terrain&&!this.transform.isOrthographic&&(at=!0,this.blitDepth()),P&&rt!==-1&&this.currentLayer===rt+1&&!this.transform.isOrthographic&&this.blitDepth(),je.is3D()||this.terrain||this._renderTileClippingMasks(je,qe,qe?G[qe.id]:void 0),this.renderLayer(this,qe,je,De(je,qe)),!this.terrain&&be&&$e>0&&je.hasShadowPass()&&--$e==0&&(be.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const mt=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=mt;this.currentLayer++){const Tt=z[this.currentLayer];if(!Tt.hasLightBeamPass())continue;const Lt=n.getLayerSourceCache(Tt);this.renderLayer(this,Lt,Tt,Lt?Q[Lt.id]:void 0)}this.currentLayer=mt,this.renderPass="translucent"}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const mt=this.currentLayer;this.depthOcclusion=!0;for(const Tt of this.layersWithOcclusionOpacity){this.currentLayer=Tt;const Lt=z[this.currentLayer],et=n.getLayerSourceCache(Lt),xt=et?Q[et.id]:void 0;Lt.is3D()||this.terrain||this._renderTileClippingMasks(Lt,et,et?G[et.id]:void 0),this.renderLayer(this,et,Lt,xt)}this.depthOcclusion=!1,this.currentLayer=mt,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let je=null;z.forEach(qe=>{const mt=n.getLayerSourceCache(qe);mt&&!qe.isHidden(this.transform.zoom)&&mt.getVisibleCoordinates().length&&(!je||je.getSource().maxzoom<mt.getSource().maxzoom)&&(je=mt)}),je&&this.options.showTileBoundaries&&Us.debug(this,je,je.getVisibleCoordinates(),i.ai.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&Us.debug(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new i.ai(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(je){const qe=je.transform.padding;fm(je,je.transform.height-(qe.top||0),3,A0),fm(je,qe.bottom||0,3,R0),fh(je,qe.left||0,3,z0),fh(je,je.transform.width-(qe.right||0),3,Xc);const mt=je.transform.centerPoint;(function(Tt,Lt,et,xt){Kc(Tt,Lt-1,et-10,2,20,xt),Kc(Tt,Lt-10,et-1,20,2,xt)})(je,mt.x,je.transform.height-mt.y,Zx)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),j||(this.conflationActive=!1)}prepareLayer(n){this.gpuTimingStart(n);const{unsupportedLayers:s}=this.transform.projection,p=!s||!s.includes(n.type);if(ef[n.type]&&(p||this.terrain&&n.type==="custom")){const _=this.style.getLayerSourceCache(n);ef[n.type](n,_,this)}this.gpuTimingEnd()}renderLayer(n,s,p,_){p.isHidden(this.transform.zoom)||(p.type==="background"||p.type==="sky"||p.type==="custom"||p.type==="model"||p.type==="raster"||p.type==="raster-particle"||_&&_.length)&&(this.id=p.id,this.gpuTimingStart(p),n.transform.projection.unsupportedLayers&&n.transform.projection.unsupportedLayers.includes(p.type)&&(!n.terrain||p.type!=="custom")||p.type==="clip"||Us[p.type](n,s,p,_,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const s=this.context.extTimerQuery,p=this.context.gl;let _=this.gpuTimers[n.id];_||(_=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:p.createQuery()}),_.calls++,p.beginQuery(s.TIME_ELAPSED_EXT,_.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const n=this.context.extTimerQuery,s=this.context.gl,p=s.createQuery();this.deferredRenderGpuTimeQueries.push(p),s.beginQuery(n.TIME_ELAPSED_EXT,p)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}collectDeferredRenderGpuQueries(){const n=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],n}queryGpuTimers(n){const s={};for(const p in n){const _=n[p],y=this.context.extTimerQuery,w=y.getQueryParameter(_.query,this.context.gl.QUERY_RESULT)/1e6;y.deleteQueryEXT(_.query),s[p]=w}return s}queryGpuTimeDeferredRender(n){if(!this.options.gpuTimingDeferredRender)return 0;const s=this.context.gl;let p=0;for(const _ of n)p+=s.getQueryParameter(_,s.QUERY_RESULT)/1e6,s.deleteQuery(_);return p}translatePosMatrix(n,s,p,_,y){if(!p[0]&&!p[1])return n;const w=y?_==="map"?this.transform.angle:0:_==="viewport"?-this.transform.angle:0;if(w){const k=Math.sin(w),D=Math.cos(w);p=[p[0]*D-p[1]*k,p[0]*k+p[1]*D]}const P=[y?p[0]:i.aq(s,p[0],this.transform.zoom),y?p[1]:i.aq(s,p[1],this.transform.zoom),0],z=new Float32Array(16);return i.aa.mat4.translate(z,n,P),z}saveTileTexture(n){const s=n.size[0],p=this._tileTextures[s];p?p.push(n):this._tileTextures[s]=[n]}getTileTexture(n){const s=this._tileTextures[n];return s&&s.length>0?s.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(n,s,p){const _=p===void 0?this.terrain&&this.terrain.renderingToTexture:p,y=[];return this.style&&this.style.enable3dLights()&&(n==="globeRaster"||n==="terrainRaster"?(y.push("LIGHTING_3D_MODE"),y.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):_||y.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||y.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(y.push("TERRAIN"),this.linearFloatFilteringSupported()&&y.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&y.push("GLOBE"),!this._fogVisible||_||s!==void 0&&!s||y.push("FOG","FOG_DITHERING"),_&&y.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&y.push("OVERDRAW_INSPECTOR"),y}getOrCreateProgram(n,s){this.cache=this.cache||{};const p=s&&s.defines||[],_=s&&s.config,y=this.currentGlobalDefines(n,s&&s.overrideFog,s&&s.overrideRtt).concat(p),w=y0.cacheKey(Wp[n],n,y,_);return this.cache[w]||(this.cache[w]=new y0(this.context,n,Wp[n],_,Wx[n],y)),this.cache[w]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new i.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(n,s){if(this.style.enable3dLights()){const p=this.style.directionalLight,_=this.style.ambientLight;if(p&&_){const y=((w,P,z)=>{const k=w.properties.get("direction"),D=w.properties.get("color-use-theme")==="none",j=w.properties.get("color").toRenderColor(D?null:z.getLut(w.scope)).toArray01(),B=w.properties.get("intensity"),G=P.properties.get("color-use-theme")==="none",Q=P.properties.get("color").toRenderColor(G?null:z.getLut(P.scope)).toArray01(),J=P.properties.get("intensity"),ie=[k.x,k.y,k.z],oe=i.cL(Q,J),me=i.cL(j,B);return{u_lighting_ambient_color:oe,u_lighting_directional_dir:ie,u_lighting_directional_color:me,u_ground_radiance:Ux(ie,me,oe)}})(p,_,this.style);s.setLightsUniformValues(n,y)}}}uploadCommonUniforms(n,s,p,_,y){if(this.uploadCommonLightUniforms(n,s),this.terrain&&this.terrain.renderingToTexture)return;const w=this.style.fog;if(w){const P=w.getOpacity(this.transform.pitch),z=((k,D,j,B,G,Q,J,ie,oe,me,Se,be)=>{const Pe=k.transform,Me=D.properties.get("color-use-theme")==="none",Ie=D.properties.get("color").toRenderColor(Me?null:k.style.getLut(D.scope)).toArray01();Ie[3]=B;const Ce=k.frameCounter/1e3%1,[De,$e]=D.properties.get("vertical-range");return{u_fog_matrix:j?Pe.calculateFogTileMatrix(j):be||k.identityMat,u_fog_range:D.getFovAdjustedRange(Pe._fov),u_fog_color:Ie,u_fog_horizon_blend:D.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(De,$e),$e],u_fog_temporal_offset:Ce,u_frustum_tl:G,u_frustum_tr:Q,u_frustum_br:J,u_frustum_bl:ie,u_globe_pos:oe,u_globe_radius:me,u_viewport:Se,u_globe_transition:i.ad(Pe.zoom),u_is_globe:+(Pe.projection.name==="globe")}})(this,w,p,P,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*i.q.devicePixelRatio,this.transform.height*i.q.devicePixelRatio],_);s.setFogUniformValues(n,z)}y&&s.setCutoffUniformValues(n,y.uniformValues)}setTileLoadedFlag(n){this.tileLoaded=n}saveCanvasCopy(){const n=this.canvasCopy();n&&(this.frameCopies.push(n),this.tileLoaded=!1)}canvasCopy(){const n=this.context.gl,s=n.createTexture();return n.bindTexture(n.TEXTURE_2D,s),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,0,0,n.drawingBufferWidth,n.drawingBufferHeight,0),s}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const n=this.style&&this.style.fog;return!!n&&n.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const n=this._backgroundTiles,s=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const _ of p)s[_.key]=n[_.key]||new ya(_,512,this.transform.tileZoom,this);return s}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(n,s){return!(!n.is3D()||n.type!=="clip"&&(n.minzoom&&n.minzoom>this.transform.zoom||(this.style._clipLayerPresent||n.sourceLayer!=="building")&&(!s||s.type!=="batched-model")))}isTileAffectedByFog(n){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let s=this._cachedTileFogOpacities[n.key];return s||(this._cachedTileFogOpacities[n.key]=s=this.style.fog.getOpacityForTile(n)),s[0]>=St||s[1]>=St}setupDepthForOcclusion(n,s,p){const _=this.context,y=_.gl,w=!!p;var P;p||(p={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),_.activeTexture.set(y.TEXTURE3),n&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE),p.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],p.u_depth_range_unpack=[2/((P=this.depthRangeFor3D)[1]-P[0]),-1-2*P[0]/(P[1]-P[0])],p.u_occluder_half_size=.5*this.occlusionParams.occluderSize,p.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(y.NEAREST,y.CLAMP_TO_EDGE),_.activeTexture.set(y.TEXTURE0),w||s.setTerrainUniformValues(_,p)}}function tf(f,n){let s=!1,p=null;const _=()=>{p=null,s&&(f(),p=setTimeout(_,n),s=!1)};return()=>(s=!0,p||_(),p)}class rf{constructor(n){this._hashName=n&&encodeURIComponent(n),i.aO(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=tf(this._updateHashUnthrottled.bind(this),300)}addTo(n){return this._map=n,window.addEventListener("hashchange",this._onHashChange,!1),n.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const n=this._map;if(!n)return"";const s=nf(n);if(this._hashName){const p=this._hashName;let _=!1;const y=location.hash.slice(1).split("&").map(w=>{const P=w.split("=")[0];return P===p?(_=!0,`${P}=${s}`):w}).filter(w=>w);return _||y.push(`${p}=${s}`),`#${y.join("&")}`}return`#${s}`}_getCurrentHash(){const n=location.hash.replace("#","");if(this._hashName){let s;return n.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(s=p)}),(s&&s[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._map;if(!n)return!1;const s=this._getCurrentHash();if(s.length>=3&&!s.some(p=>isNaN(p))){const p=n.dragRotate.isEnabled()&&n.touchZoomRotate.isEnabled()?+(s[3]||0):n.getBearing();return n.jumpTo({center:[+s[2],+s[1]],zoom:+s[0],bearing:p,pitch:+(s[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function nf(f,n){const s=f.getCenter(),p=Math.round(100*f.getZoom())/100,_=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),y=Math.pow(10,_),w=Math.round(s.lng*y)/y,P=Math.round(s.lat*y)/y,z=f.getBearing(),k=f.getPitch();let D=n?`/${w}/${P}/${p}`:`${p}/${P}/${w}`;return(z||k)&&(D+="/"+Math.round(10*z)/10),k&&(D+=`/${Math.round(k)}`),D}const eu={linearity:.3,easing:i.dy(0,0,.3,1)},O0=i.l({deceleration:2500,maxSpeed:1400},eu),F0=i.l({deceleration:20,maxSpeed:1400},eu),B0=i.l({deceleration:1e3,maxSpeed:360},eu),N0=i.l({deceleration:1e3,maxSpeed:90},eu);class j0{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:i.q.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,s=i.q.now();for(;n.length>0&&s-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const s={zoom:0,bearing:0,pitch:0,pan:new i.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:y}of this._inertiaBuffer)s.zoom+=y.zoomDelta||0,s.bearing+=y.bearingDelta||0,s.pitch+=y.pitchDelta||0,y.panDelta&&s.pan._add(y.panDelta),y.around&&(s.around=y.around),y.pinchAround&&(s.pinchAround=y.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,_={};if(s.pan.mag()){const y=vh(s.pan.mag(),p,i.l({},O0,n||{}));_.offset=s.pan.mult(y.amount/s.pan.mag()),_.center=this._map.transform.center,yh(_,y)}if(s.zoom){const y=vh(s.zoom,p,F0);_.zoom=this._map.transform.zoom+y.amount,yh(_,y)}if(s.bearing){const y=vh(s.bearing,p,B0);_.bearing=this._map.transform.bearing+i.av(y.amount,-179,179),yh(_,y)}if(s.pitch){const y=vh(s.pitch,p,N0);_.pitch=this._map.transform.pitch+y.amount,yh(_,y)}if(_.zoom||_.bearing){const y=s.pinchAround===void 0?s.around:s.pinchAround;_.around=y?this._map.unproject(y):this._map.getCenter()}return this.clear(),_.noMoveStart=!0,_}}function yh(f,n){(!f.duration||f.duration<n.duration)&&(f.duration=n.duration,f.easing=n.easing)}function vh(f,n,s){const{maxSpeed:p,linearity:_,deceleration:y}=s,w=i.av(f*_/(n/1e3),-p,p),P=Math.abs(w)/(y*_);return{easing:s.easing,duration:1e3*P,amount:w*(P/2)}}class ea extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,s,p,_={}){const y=Ne(s.getCanvasContainer(),p),w=s.unproject(y);super(n,i.l({point:y,lngLat:w,originalEvent:p},_)),this._defaultPrevented=!1,this.target=s}}class xh extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,s,p){const _=n==="touchend"?p.changedTouches:p.touches,y=Xe(s.getCanvasContainer(),_),w=y.map(z=>s.unproject(z)),P=y.reduce((z,k,D,j)=>z.add(k.div(j.length)),new i.P(0,0));super(n,{points:y,point:P,lngLats:w,lngLat:s.unproject(P),originalEvent:p}),this._defaultPrevented=!1}}class $0 extends i.z{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,s){super("wheel",{originalEvent:s}),this._defaultPrevented=!1}}class V0{constructor(n,s){this._map=n,this._clickTolerance=s.clickTolerance}reset(){this._mousedownPos=void 0}wheel(n){return this._firePreventable(new $0(this._map,n))}mousedown(n,s){return this._mousedownPos=s,this._firePreventable(new ea(n.type,this._map,n))}mouseup(n){this._map.fire(new ea(n.type,this._map,n))}preclick(n){const s=i.l({},n);s.type="preclick",this._map.fire(new ea(s.type,this._map,s))}click(n,s){this._mousedownPos&&this._mousedownPos.dist(s)>=this._clickTolerance||(this.preclick(n),this._map.fire(new ea(n.type,this._map,n)))}dblclick(n){return this._firePreventable(new ea(n.type,this._map,n))}mouseover(n){this._map.fire(new ea(n.type,this._map,n))}mouseout(n){this._map.fire(new ea(n.type,this._map,n))}touchstart(n){return this._firePreventable(new xh(n.type,this._map,n))}touchmove(n){this._map.fire(new xh(n.type,this._map,n))}touchend(n){this._map.fire(new xh(n.type,this._map,n))}touchcancel(n){this._map.fire(new xh(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class U0{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(n){this._map.fire(new ea(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ea("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new ea(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class G0{constructor(n,s){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=s.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,s){this.isEnabled()&&n.shiftKey&&n.button===0&&(ve(),this._startPos=this._lastPos=s,this._active=!0)}mousemoveWindow(n,s){if(!this._active)return;const p=s,_=this._startPos,y=this._lastPos;if(!_||!y||y.equals(p)||!this._box&&p.dist(_)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=ue("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const w=Math.min(_.x,p.x),P=Math.max(_.x,p.x),z=Math.min(_.y,p.y),k=Math.max(_.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${w}px,${z}px)`,this._box.style.width=P-w+"px",this._box.style.height=k-z+"px")})}mouseupWindow(n,s){if(!this._active)return;const p=this._startPos,_=s;if(p&&n.button===0){if(this.reset(),Ee(),p.x!==_.x||p.y!==_.y)return this._map.fire(new i.z("boxzoomend",{originalEvent:n})),{cameraAnimation:y=>y.fitScreenCoordinates(p,_,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",n)}}keydown(n){this._active&&n.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",n))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Te(),delete this._startPos,delete this._lastPos}_fireEvent(n,s){return this._map.fire(new i.z(n,{originalEvent:s}))}}function Tm(f,n){const s={};for(let p=0;p<f.length;p++)s[f[p].identifier]=n[p];return s}class Kx{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(n,s,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=n.timeStamp),p.length===this.numTouches&&(this.centroid=function(_){const y=new i.P(0,0);for(const w of _)y._add(w);return y.div(_.length)}(s),this.touches=Tm(p,s)))}touchmove(n,s,p){if(this.aborted||!this.centroid)return;const _=Tm(p,s);for(const y in this.touches){const w=_[y];(!w||w.dist(this.touches[y])>30)&&(this.aborted=!0)}}touchend(n,s,p){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),p.length===0){const _=!this.aborted&&this.centroid;if(this.reset(),_)return _}}}class ri{constructor(n){this.singleTap=new Kx(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(n,s,p){this.singleTap.touchstart(n,s,p)}touchmove(n,s,p){this.singleTap.touchmove(n,s,p)}touchend(n,s,p){const _=this.singleTap.touchend(n,s,p);if(_){const y=n.timeStamp-this.lastTime<500,w=!this.lastTap||this.lastTap.dist(_)<30;if(y&&w||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=_,this.count===this.numTaps)return this.reset(),_}}}class H0{constructor(){this._zoomIn=new ri({numTouches:1,numTaps:2}),this._zoomOut=new ri({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,s,p){this._zoomIn.touchstart(n,s,p),this._zoomOut.touchstart(n,s,p)}touchmove(n,s,p){this._zoomIn.touchmove(n,s,p),this._zoomOut.touchmove(n,s,p)}touchend(n,s,p){const _=this._zoomIn.touchend(n,s,p),y=this._zoomOut.touchend(n,s,p);return _?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()+1,around:w.unproject(_)},{originalEvent:n})}):y?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:w.getZoom()-1,around:w.unproject(y)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Jx={0:1,2:2};class Cm{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(n,s){return!1}_move(n,s){return{}}mousedown(n,s){if(this._lastPoint)return;const p=Fe(n);this._correctButton(n,p)&&(this._lastPoint=s,this._eventButton=p)}mousemoveWindow(n,s){const p=this._lastPoint;if(p){if(n.preventDefault(),this._eventButton!=null&&function(_,y){const w=Jx[y];return _.buttons===void 0||(_.buttons&w)!==w}(n,this._eventButton))this.reset();else if(this._moved||!(s.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=s,this._move(p,s)}}mouseupWindow(n){this._lastPoint&&Fe(n)===this._eventButton&&(this._moved&&Ee(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class bh extends Cm{mousedown(n,s){super.mousedown(n,s),this._lastPoint&&(this._active=!0)}_correctButton(n,s){return s===0&&!n.ctrlKey}_move(n,s){return{around:s,panDelta:s.sub(n)}}}class Mm extends Cm{_correctButton(n,s){return s===0&&n.ctrlKey||s===2}_move(n,s){const p=.8*(s.x-n.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(n){n.preventDefault()}}class of extends Cm{_correctButton(n,s){return s===0&&n.ctrlKey||s===2}_move(n,s){const p=-.5*(s.y-n.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(n){n.preventDefault()}}class af{constructor(n,s){this._map=n,this._el=n.getCanvasContainer(),this._minTouches=1,this._clickTolerance=s.clickTolerance||1,this.reset(),i.aO(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new i.P(0,0)}touchstart(n,s,p){return this._calculateTransform(n,s,p)}touchmove(n,s,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(p.length===1&&!i.dz())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return n.cancelable&&n.preventDefault(),this._calculateTransform(n,s,p)}}touchend(n,s,p){this._calculateTransform(n,s,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,s,p){p.length>0&&(this._active=!0);const _=Tm(p,s),y=new i.P(0,0),w=new i.P(0,0);let P=0;for(const k in _){const D=_[k],j=this._touches[k];j&&(y._add(D),w._add(D.sub(j)),P++,_[k]=D)}if(this._touches=_,P<this._minTouches||!w.mag())return;const z=w.div(P);return this._sum._add(z),this._sum.mag()<this._clickTolerance?void 0:{around:y.div(P),panDelta:z}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ue("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Na{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(n){}_move(n,s,p){return{}}touchstart(n,s,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([s[0],s[1]]))}touchmove(n,s,p){const _=this._firstTwoTouches;if(!_)return;n.preventDefault();const[y,w]=_,P=sc(p,s,y),z=sc(p,s,w);if(!P||!z)return;const k=this._aroundCenter?null:P.add(z).div(2);return this._move([P,z],k,n)}touchend(n,s,p){if(!this._firstTwoTouches)return;const[_,y]=this._firstTwoTouches,w=sc(p,s,_),P=sc(p,s,y);w&&P||(this._active&&Ee(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&n.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function sc(f,n,s){for(let p=0;p<f.length;p++)if(f[p].identifier===s)return n[p]}function ci(f,n){return Math.log(f/n)/Math.LN2}class us extends Na{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,s){const p=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(ci(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ci(this._distance,p),pinchAround:s}}}function sf(f,n){return 180*f.angleWith(n)/Math.PI}class lf extends Na{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,s){const p=this._vector;if(this._vector=n[0].sub(n[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:sf(this._vector,p),pinchAround:s}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const s=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const _=sf(n,p);return Math.abs(_)<s}}function cf(f){return Math.abs(f.y)>Math.abs(f.x)}class Qx extends Na{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(n){this._lastPoints=n,cf(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,s,p){const _=this._lastPoints;if(!_)return;const y=n[0].sub(_[0]),w=n[1].sub(_[1]);return this._map._cooperativeGestures&&!i.dz()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(y,w,p.timeStamp),!this._valid)?void 0:(this._lastPoints=n,this._active=!0,{pitchDelta:(y.y+w.y)/2*-.5})}gestureBeginsVertically(n,s,p){if(this._valid!==void 0)return this._valid;const _=n.mag()>=2,y=s.mag()>=2;if(!_&&!y)return;if(!_||!y)return this._firstMove==null&&(this._firstMove=p),p-this._firstMove<100&&void 0;const w=n.y>0==s.y>0;return cf(n)&&cf(s)&&w}}const wh={panStep:100,bearingStep:15,pitchStep:10};class eb{constructor(){const n=wh;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let s=0,p=0,_=0,y=0,w=0;switch(n.keyCode){case 61:case 107:case 171:case 187:s=1;break;case 189:case 109:case 173:s=-1;break;case 37:n.shiftKey?p=-1:(n.preventDefault(),y=-1);break;case 39:n.shiftKey?p=1:(n.preventDefault(),y=1);break;case 38:n.shiftKey?_=1:(n.preventDefault(),w=-1);break;case 40:n.shiftKey?_=-1:(n.preventDefault(),w=1);break;default:return}return this._rotationDisabled&&(p=0,_=0),{cameraAnimation:P=>{const z=P.getZoom();P.easeTo({duration:300,easeId:"keyboardHandler",easing:tb,zoom:s?Math.round(z)+s*(n.shiftKey?2:1):z,bearing:P.getBearing()+p*this._bearingStep,pitch:P.getPitch()+_*this._pitchStep,offset:[-y*this._panStep,-w*this._panStep],center:P.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function tb(f){return f*(2-f)}const uf=4.000244140625,Im=1/450;class tu{constructor(n,s){this._map=n,this._el=n.getCanvasContainer(),this._handler=s,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Im,i.aO(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&n.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(n.ctrlKey||n.metaKey||this.isZooming()||i.dz()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let s=n.deltaMode===WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const p=i.q.now(),_=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,s!==0&&s%uf==0?this._type="wheel":s!==0&&Math.abs(s)<4?this._type="trackpad":_>400?(this._type=null,this._lastValue=s,this._timeout=window.setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(_*s)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,s+=this._lastValue)),n.shiftKey&&s&&(s/=4),this._type&&(this._lastWheelEvent=n,this._delta-=s,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const s=Ne(this._el,n);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:s,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform;this._type==="wheel"&&n.projection.wrap&&(n._center.lng>=180||n._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const s=()=>n._terrainEnabled()&&this._aroundCoord?n.computeZoomRelativeTo(this._aroundCoord):n.zoom;if(this._delta!==0){const k=this._type==="wheel"&&Math.abs(this._delta)>uf?this._wheelZoomRate:this._defaultZoomRate;let D=2/(1+Math.exp(-Math.abs(this._delta*k)));this._delta<0&&D!==0&&(D=1/D);const j=s(),B=Math.pow(2,j),G=typeof this._targetZoom=="number"?n.zoomScale(this._targetZoom):B;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(G*D))),this._type==="wheel"&&(this._startZoom=j,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const p=typeof this._targetZoom=="number"?this._targetZoom:s(),_=this._startZoom,y=this._easing;let w,P=!1;if(this._type==="wheel"&&_&&y){const k=Math.min((i.q.now()-this._lastWheelEventTime)/200,1),D=y(k);w=i.ae(_,p,D),k<1?this._frameId||(this._frameId=!0):P=!0}else w=p,P=!0;this._active=!0,P&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let z=w-s();return z*this._lastDelta<0&&(z=0),{noInertia:!0,needsRenderFrame:!P,zoomDelta:z,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let s=i.dA;if(this._prevEase){const p=this._prevEase,_=(i.q.now()-p.start)/p.duration,y=p.easing(_+.01)-p.easing(_),w=.27/Math.sqrt(y*y+1e-4)*.01,P=Math.sqrt(.0729-w*w);s=i.dy(w,P,.25,1)}return this._prevEase={start:i.q.now(),duration:n,easing:s},s}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=ue("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class ru{constructor(n,s){this._clickZoom=n,this._tapZoom=s}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Gs{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(n,s){return n.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(n.shiftKey?-1:1),around:p.unproject(s)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ja{constructor(){this._tap=new ri({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(n,s,p){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=s[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(n,s,p))}touchmove(n,s,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const _=s[0],y=_.y-this._swipePoint.y;return this._swipePoint=_,n.preventDefault(),this._active=!0,{zoomDelta:y/128}}}else this._tap.touchmove(n,s,p)}touchend(n,s,p){this._tapTime?this._swipePoint&&p.length===0&&this.reset():this._tap.touchend(n,s,p)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ml{constructor(n,s,p){this._el=n,this._mousePan=s,this._touchPan=p}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class lc{constructor(n,s,p){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=s,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Il{constructor(n,s,p,_){this._el=n,this._touchZoom=s,this._touchRotate=p,this._tapDragZoom=_,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const hf=f=>f.zoom||f.drag||f.pitch||f.rotate;class rb extends i.z{}class nb{constructor(){this.constants=[1,1,.01],this.radius=0}setup(n,s){const p=i.aa.vec3.sub([],s,n);this.radius=i.aa.vec3.length(p[2]<0?i.aa.vec3.div([],p,this.constants):[p[0],p[1],0])}projectRay(n){i.aa.vec3.div(n,n,this.constants),i.aa.vec3.normalize(n,n),i.aa.vec3.mul(n,n,this.constants);const s=i.aa.vec3.scale([],n,this.radius);if(s[2]>0){const p=i.aa.vec3.scale([],[0,0,1],i.aa.vec3.dot(s,[0,0,1])),_=i.aa.vec3.scale([],i.aa.vec3.normalize([],[s[0],s[1],0]),this.radius),y=i.aa.vec3.add([],s,i.aa.vec3.scale([],i.aa.vec3.sub([],i.aa.vec3.add([],_,p),s),2));s[0]=y[0],s[1]=y[1]}return s}}function df(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class W0{constructor(n,s){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new j0(n),this._bearingSnap=s.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new nb,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(s),i.aO(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[window,"blur",void 0]];for(const[_,y,w]of this._listeners){const P=_===document?this.handleWindowEvent:this.handleEvent;_.addEventListener(y,P,w)}}destroy(){for(const[n,s,p]of this._listeners){const _=n===document?this.handleWindowEvent:this.handleEvent;n.removeEventListener(s,_,p)}}_addDefaultHandlers(n){const s=this._map,p=s.getCanvasContainer();this._add("mapEvent",new V0(s,n));const _=s.boxZoom=new G0(s,n);this._add("boxZoom",_);const y=new H0,w=new Gs;s.doubleClickZoom=new ru(w,y),this._add("tapZoom",y),this._add("clickZoom",w);const P=new ja;this._add("tapDragZoom",P);const z=s.touchPitch=new Qx(s);this._add("touchPitch",z);const k=new Mm(n),D=new of(n);s.dragRotate=new lc(n,k,D),this._add("mouseRotate",k,["mousePitch"]),this._add("mousePitch",D,["mouseRotate"]);const j=new bh(n),B=new af(s,n);s.dragPan=new Ml(p,j,B),this._add("mousePan",j),this._add("touchPan",B,["touchZoom","touchRotate"]);const G=new lf,Q=new us;s.touchZoomRotate=new Il(p,Q,G,P),this._add("touchRotate",G,["touchPan","touchZoom"]),this._add("touchZoom",Q,["touchPan","touchRotate"]),this._add("blockableMapEvent",new U0(s));const J=s.scrollZoom=new tu(s,this);this._add("scrollZoom",J,["mousePan"]);const ie=s.keyboard=new eb;this._add("keyboard",ie);for(const oe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[oe]&&s[oe].enable(n[oe])}_add(n,s,p){this._handlers.push({handlerName:n,handler:s,allowed:p}),this._handlersById[n]=s}stop(n){if(!this._updatingCamera){for(const{handler:s}of this._handlers)s.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!hf(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(n,s,p){for(const _ in n)if(_!==p&&(!s||s.indexOf(_)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const s=[];for(const p of n)this._el.contains(p.target)&&s.push(p);return s}handleEvent(n,s){this._updatingCamera=!0;const p=n.type==="renderFrame",_=p?void 0:n,y={needsRenderFrame:!1},w={},P={},z=n.touches?this._getMapTouches(n.touches):void 0,k=z?Xe(this._el,z):p?void 0:Ne(this._el,n);for(const{handlerName:B,handler:G,allowed:Q}of this._handlers){if(!G.isEnabled())continue;let J;this._blockedByActive(P,Q,B)?G.reset():G[s||n.type]&&(J=G[s||n.type](n,k,z),this.mergeHandlerResult(y,w,J,B,_),J&&J.needsRenderFrame&&this._triggerRenderFrame()),(J||G.isActive())&&(P[B]=G)}const D={};for(const B in this._previousActiveHandlers)P[B]||(D[B]=_);this._previousActiveHandlers=P,(Object.keys(D).length||df(y))&&(this._changes.push([y,w,D]),this._triggerRenderFrame()),(Object.keys(P).length||df(y))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:j}=y;j&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],j(this._map))}mergeHandlerResult(n,s,p,_,y){if(!p)return;i.l(n,p);const w={handlerName:_,originalEvent:p.originalEvent||y};p.zoomDelta!==void 0&&(s.zoom=w),p.panDelta!==void 0&&(s.drag=w),p.pitchDelta!==void 0&&(s.pitch=w),p.bearingDelta!==void 0&&(s.rotate=w)}_applyChanges(){const n={},s={},p={};for(const[_,y,w]of this._changes)_.panDelta&&(n.panDelta=(n.panDelta||new i.P(0,0))._add(_.panDelta)),_.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+_.zoomDelta),_.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+_.bearingDelta),_.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+_.pitchDelta),_.around!==void 0&&(n.around=_.around),_.aroundCoord!==void 0&&(n.aroundCoord=_.aroundCoord),_.pinchAround!==void 0&&(n.pinchAround=_.pinchAround),_.noInertia&&(n.noInertia=_.noInertia),i.l(s,y),i.l(p,w);this._updateMapTransform(n,s,p),this._changes=[]}_updateMapTransform(n,s,p){const _=this._map,y=_.transform,w=me=>[me.x,me.y,me.z];if((me=>{const Se=this._eventsInProgress.drag;return Se&&!this._handlersById[Se.handlerName].isActive()})()&&!df(n)){const me=y.zoom;y.cameraElevationReference="sea",this._originalZoom!=null&&y._orthographicProjectionAtLowPitch&&y.projection.name!=="globe"&&y.pitch===0?(y.cameraElevationReference="ground",y.zoom=this._originalZoom):(y.recenterOnTerrain(),y.cameraElevationReference="ground"),me!==y.zoom&&this._map._update(!0)}if(y._isCameraConstrained&&_._stop(!0),!df(n))return void this._fireEvents(s,p,!0);let{panDelta:P,zoomDelta:z,bearingDelta:k,pitchDelta:D,around:j,aroundCoord:B,pinchAround:G}=n;y._isCameraConstrained&&(z>0&&(z=0),y._isCameraConstrained=!1),G!==void 0&&(j=G),(z||(me=>s[me]&&!this._eventsInProgress[me])("drag"))&&j&&(this._dragOrigin=w(y.pointCoordinate3D(j)),this._originalZoom=y.zoom,this._trackingEllipsoid.setup(y._camera.position,this._dragOrigin)),y.cameraElevationReference="sea",_._stop(!0),j=j||_.transform.centerPoint,k&&(y.bearing+=k),D&&(y.pitch+=D),y._updateCameraState();const Q=[0,0,0];if(P)if(y.projection.name==="mercator"){const me=this._trackingEllipsoid.projectRay(y.screenPointToMercatorRay(j).dir),Se=this._trackingEllipsoid.projectRay(y.screenPointToMercatorRay(j.sub(P)).dir);Q[0]=Se[0]-me[0],Q[1]=Se[1]-me[1]}else{const me=y.pointCoordinate(j);if(y.projection.name==="globe"){P=P.rotate(-y.angle);const Se=y._pixelsPerMercatorPixel/y.worldSize;Q[0]=-P.x*i.dB(i.aR(me.y))*Se,Q[1]=-P.y*i.dB(y.center.lat)*Se}else{const Se=y.pointCoordinate(j.sub(P));me&&Se&&(Q[0]=Se.x-me.x,Q[1]=Se.y-me.y)}}const J=y.zoom,ie=[0,0,0];if(z){const me=w(B||y.pointCoordinate3D(j)),Se={dir:i.aa.vec3.normalize([],i.aa.vec3.sub([],me,y._camera.position))};if(Se.dir[2]<0){const be=y.zoomDeltaToMovement(me,z);i.aa.vec3.scale(ie,Se.dir,be)}}const oe=i.aa.vec3.add(Q,Q,ie);y._translateCameraConstrained(oe),z&&Math.abs(y.zoom-J)>1e-4&&y.recenterOnTerrain(),y.cameraElevationReference="ground",this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(s,p,!0)}_fireEvents(n,s,p){const _=hf(this._eventsInProgress),y=hf(n),w={};for(const D in n){const{originalEvent:j}=n[D];this._eventsInProgress[D]||(w[`${D}start`]=j),this._eventsInProgress[D]=n[D]}!_&&y&&this._fireEvent("movestart",y.originalEvent);for(const D in w)this._fireEvent(D,w[D]);y&&this._fireEvent("move",y.originalEvent);for(const D in n){const{originalEvent:j}=n[D];this._fireEvent(D,j)}const P={};let z;for(const D in this._eventsInProgress){const{handlerName:j,originalEvent:B}=this._eventsInProgress[D];this._handlersById[j].isActive()||(delete this._eventsInProgress[D],z=s[j]||B,P[`${D}end`]=z)}for(const D in P)this._fireEvent(D,P[D]);const k=hf(this._eventsInProgress);if(p&&(_||y)&&!k){this._updatingCamera=!0;const D=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),j=B=>B!==0&&-this._bearingSnap<B&&B<this._bearingSnap;D?(j(D.bearing||this._map.getBearing())&&(D.bearing=0),this._map.easeTo(D,{originalEvent:z})):(this._map.fire(new i.z("moveend",{originalEvent:z})),j(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,s){this._map.fire(new i.z(n,s?{originalEvent:s}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{this._frameId=void 0,this.handleEvent(new rb("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const fo="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Pm extends i.E{constructor(n,s){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=s.bearingSnap,this._respectPrefersReducedMotion=s.respectPrefersReducedMotion!==!1,i.aO(["_renderFrameCallback"],this)}getCenter(){return new i.bN(this.transform.center.lng,this.transform.center.lat)}setCenter(n,s){return this.jumpTo({center:n},s)}panBy(n,s,p){return n=i.P.convert(n).mult(-1),this.panTo(this.transform.center,i.l({offset:n},s),p)}panTo(n,s,p){return this.easeTo(i.l({center:n},s),p)}getZoom(){return this.transform.zoom}setZoom(n,s){return this.jumpTo({zoom:n},s),this}zoomTo(n,s,p){return this.easeTo(i.l({zoom:n},s),p)}zoomIn(n,s){return this.zoomTo(this.getZoom()+1,n,s),this}zoomOut(n,s){return this.zoomTo(this.getZoom()-1,n,s),this}getBearing(){return this.transform.bearing}setBearing(n,s){return this.jumpTo({bearing:n},s),this}getPadding(){return this.transform.padding}setPadding(n,s){return this.jumpTo({padding:n},s),this}rotateTo(n,s,p){return this.easeTo(i.l({bearing:n},s),p)}resetNorth(n,s){return this.rotateTo(0,i.l({duration:1e3},n),s),this}resetNorthPitch(n,s){return this.easeTo(i.l({bearing:0,pitch:0,duration:1e3},n),s),this}snapToNorth(n,s){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,s):this}getPitch(){return this.transform.pitch}setPitch(n,s){return this.jumpTo({pitch:n},s),this}cameraForBounds(n,s){n=i.ay.convert(n);const p=s&&s.bearing||0,_=s&&s.pitch||0,y=n.getNorthWest(),w=n.getSouthEast();return this._cameraForBounds(this.transform,y,w,p,_,s)}_extendPadding(n){const s={top:0,right:0,bottom:0,left:0};return n==null?i.l({},s,this.transform.padding):typeof n=="number"?{top:n,bottom:n,right:n,left:n}:i.l({},s,n)}_extendCameraOptions(n){return(n=i.l({offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding=this._extendPadding(n.padding),n}_minimumAABBFrustumDistance(n,s){const p=s.max[0]-s.min[0],_=s.max[1]-s.min[1];return p/_>n.aspect?p/(2*Math.tan(.5*n.fovX)*n.aspect):_/(2*Math.tan(.5*n.fovY)*n.aspect)}_cameraForBoundsOnGlobe(n,s,p,_,y,w){const P=n.clone(),z=this._extendCameraOptions(w);P.bearing=_,P.pitch=y;const k=i.bN.convert(s),D=i.bN.convert(p),j=.5*(k.lat+D.lat),B=.5*(k.lng+D.lng),G=i.dC(j,B),Q=i.aa.vec3.normalize([],G),J=i.aa.vec3.normalize([],i.aa.vec3.cross([],Q,[0,1,0])),ie=i.aa.vec3.cross([],J,Q),oe=[J[0],J[1],J[2],0,ie[0],ie[1],ie[2],0,Q[0],Q[1],Q[2],0,0,0,0,1],me=[G,i.dC(k.lat,k.lng),i.dC(D.lat,k.lng),i.dC(D.lat,D.lng),i.dC(k.lat,D.lng),i.dC(j,k.lng),i.dC(j,D.lng),i.dC(k.lat,B),i.dC(D.lat,B)];let Se=i.cc.fromPoints(me.map(st=>[i.aa.vec3.dot(J,st),i.aa.vec3.dot(ie,st),i.aa.vec3.dot(Q,st)]));const be=i.aa.vec3.transformMat4([],Se.center,oe);i.aa.vec3.squaredLength(be)===0&&i.aa.vec3.set(be,0,0,1),i.aa.vec3.normalize(be,be),i.aa.vec3.scale(be,be,i.aw),P.center=i.dD(be);const Pe=P.getWorldToCameraMatrix(),Me=i.aa.mat4.invert(new Float64Array(16),Pe);Se=i.cc.applyTransform(Se,i.aa.mat4.multiply([],Pe,oe));const Ie=this._extendAABB(Se,P,z,_);if(!Ie)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Se=Ie,i.aa.vec3.transformMat4(be,be,Pe);const Ce=.5*(Se.max[2]-Se.min[2]),De=this._minimumAABBFrustumDistance(P,Se),$e=i.aa.vec3.scale([],[0,0,1],Ce),at=i.aa.vec3.add($e,be,$e),rt=De+(P.pitch===0?0:i.aa.vec3.distance(be,at)),je=P.globeCenterInViewSpace,qe=i.aa.vec3.sub([],be,[je[0],je[1],je[2]]);i.aa.vec3.normalize(qe,qe),i.aa.vec3.scale(qe,qe,rt);const mt=i.aa.vec3.add([],be,qe);i.aa.vec3.transformMat4(mt,mt,Me);const Tt=i.ds/i.aw,Lt=i.aa.vec3.length(mt),et=i.bG(Math.max(Lt*Tt-i.ds,Number.EPSILON),0),xt=Math.min(P.zoomFromMercatorZAdjusted(et),z.maxZoom);return xt>.5*(i.c5+i.bX)?(P.setProjection({name:"mercator"}),P.zoom=xt,this._cameraForBounds(P,s,p,_,y,w)):{center:P.center,zoom:xt,bearing:_,pitch:y}}_extendAABB(n,s,p,_){const y=.5*((p.padding.left||0)+(p.padding.right||0)),w=.5*((p.padding.top||0)+(p.padding.bottom||0)),P=w,z=y,k=y,D=w,j=s.width-(z+k),B=s.height-(P+D),G=i.aa.vec3.sub([],n.max,n.min),Q=Math.min(j/G[0],B/G[1]),J=Math.min(s.scaleZoom(s.scale*Q),p.maxZoom);if(isNaN(J))return null;const ie=s.scale/s.zoomScale(J),oe=new i.cc([n.min[0]-z*ie,n.min[1]-D*ie,n.min[2]],[n.max[0]+k*ie,n.max[1]+P*ie,n.max[2]]),me=(typeof p.offset.x=="number"&&typeof p.offset.y=="number"?new i.P(p.offset.x,p.offset.y):i.P.convert(p.offset)).rotate(-i.ah(_));return oe.center[0]-=me.x*ie,oe.center[1]+=me.y*ie,oe}queryTerrainElevation(n,s){const p=this.transform.elevation;return p?(s=i.l({},{exaggerated:!0},s),p.getAtPoint(i.a9.fromLngLat(n),null,s.exaggerated)):null}_cameraForBounds(n,s,p,_,y,w){if(n.projection.name==="globe")return this._cameraForBoundsOnGlobe(n,s,p,_,y,w);const P=n.clone(),z=this._extendCameraOptions(w);P.bearing=_,P.pitch=y;const k=i.bN.convert(s),D=i.bN.convert(p),j=new i.bN(k.lng,D.lat),B=new i.bN(D.lng,k.lat),G=P.project(k),Q=P.project(D),J=this.queryTerrainElevation(k),ie=this.queryTerrainElevation(D),oe=this.queryTerrainElevation(j),me=this.queryTerrainElevation(B),Se=[[G.x,G.y,Math.min(J||0,ie||0,oe||0,me||0)],[Q.x,Q.y,Math.max(J||0,ie||0,oe||0,me||0)]];let be=i.cc.fromPoints(Se);const Pe=P.getWorldToCameraMatrix(),Me=i.aa.mat4.invert(new Float64Array(16),Pe);be=i.cc.applyTransform(be,Pe);const Ie=this._extendAABB(be,P,z,_);if(!Ie)return void i.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");be=Ie;const Ce=.5*i.aa.vec3.sub([],be.max,be.min)[2],De=this._minimumAABBFrustumDistance(P,be),$e=[0,0,1,0];i.aa.vec4.transformMat4($e,$e,Pe),i.aa.vec4.normalize($e,$e);const at=i.aa.vec3.scale([],$e,De+Ce),rt=i.aa.vec3.add([],be.center,at);i.aa.vec3.transformMat4(be.center,be.center,Me),i.aa.vec3.transformMat4(rt,rt,Me);const je=P.unproject(new i.P(be.center[0],be.center[1])),qe=i.dE(P.projection,je),mt=Math.pow(2,qe),Tt=Math.min(P._zoomFromMercatorZ(rt[2]*P.pixelsPerMeter*mt/P.worldSize),z.maxZoom);return P.mercatorFromTransition&&Tt<.5*(i.c5+i.bX)?(P.setProjection({name:"globe"}),P.zoom=Tt,this._cameraForBounds(P,s,p,_,y,w)):{center:je,zoom:Tt,bearing:_,pitch:y}}fitBounds(n,s,p){const _=this.cameraForBounds(n,s);return this._fitInternal(_,s,p)}fitScreenCoordinates(n,s,p,_,y){const w=i.P.convert(n),P=i.P.convert(s),z=new i.P(Math.min(w.x,P.x),Math.min(w.y,P.y)),k=new i.P(Math.max(w.x,P.x),Math.max(w.y,P.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(w,P))return this;const D=this.transform.pointLocation3D(z),j=this.transform.pointLocation3D(k),B=this.transform.pointLocation3D(new i.P(z.x,k.y)),G=this.transform.pointLocation3D(new i.P(k.x,z.y)),Q=[Math.min(D.lng,j.lng,B.lng,G.lng),Math.min(D.lat,j.lat,B.lat,G.lat)],J=[Math.max(D.lng,j.lng,B.lng,G.lng),Math.max(D.lat,j.lat,B.lat,G.lat)],ie=_&&_.pitch?_.pitch:this.getPitch(),oe=this._cameraForBounds(this.transform,Q,J,p,ie,_);return this._fitInternal(oe,_,y)}_fitInternal(n,s,p){return n?(s=i.l(n,s)).linear?this.easeTo(s,p):this.flyTo(s,p):this}jumpTo(n,s){this.stop();const p=n.preloadOnly?this.transform.clone():this.transform;let _=!1,y=!1,w=!1;"zoom"in n&&p.zoom!==+n.zoom&&(_=!0,p.zoom=+n.zoom),n.center!==void 0&&(p.center=i.bN.convert(n.center)),"bearing"in n&&p.bearing!==+n.bearing&&(y=!0,p.bearing=+n.bearing),"pitch"in n&&p.pitch!==+n.pitch&&(w=!0,p.pitch=+n.pitch);const P=typeof n.padding=="number"?this._extendPadding(n.padding):n.padding;if(n.padding!=null&&!p.isPaddingEqual(P))if(n.retainPadding===!1){const z=p.clone();z.padding=P,p.setLocationAtPoint(p.center,z.centerPoint)}else p.padding=P;return n.preloadOnly?(this._preloadTiles(p),this):(this.fire(new i.z("movestart",s)).fire(new i.z("move",s)),_&&this.fire(new i.z("zoomstart",s)).fire(new i.z("zoom",s)).fire(new i.z("zoomend",s)),y&&this.fire(new i.z("rotatestart",s)).fire(new i.z("rotate",s)).fire(new i.z("rotateend",s)),w&&this.fire(new i.z("pitchstart",s)).fire(new i.z("pitch",s)).fire(new i.z("pitchend",s)),this.fire(new i.z("moveend",s)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||i.w(fo),this.transform.getFreeCameraOptions()}setFreeCameraOptions(n,s){const p=this.transform;if(!p.projection.supportsFreeCamera)return i.w(fo),this;this.stop();const _=p.zoom,y=p.pitch,w=p.bearing;p.setFreeCameraOptions(n);const P=_!==p.zoom,z=y!==p.pitch,k=w!==p.bearing;return this.fire(new i.z("movestart",s)).fire(new i.z("move",s)),P&&this.fire(new i.z("zoomstart",s)).fire(new i.z("zoom",s)).fire(new i.z("zoomend",s)),k&&this.fire(new i.z("rotatestart",s)).fire(new i.z("rotate",s)).fire(new i.z("rotateend",s)),z&&this.fire(new i.z("pitchstart",s)).fire(new i.z("pitch",s)).fire(new i.z("pitchend",s)),this.fire(new i.z("moveend",s)),this}easeTo(n,s){this._stop(!1,n.easeId),((n=i.l({offset:[0,0],duration:500,easing:i.dA},n)).animate===!1||this._prefersReducedMotion(n))&&(n.duration=0);const p=this.transform,_=this.getZoom(),y=this.getBearing(),w=this.getPitch(),P=this.getPadding(),z="zoom"in n?+n.zoom:_,k="bearing"in n?this._normalizeBearing(n.bearing,y):y,D="pitch"in n?+n.pitch:w,j=this._extendPadding(n.padding),B=i.P.convert(n.offset);let G,Q,J;if(p.projection.name==="globe"){const $e=i.a9.fromLngLat(p.center),at=B.rotate(-p.angle);$e.x+=at.x/p.worldSize,$e.y+=at.y/p.worldSize;const rt=$e.toLngLat(),je=i.bN.convert(n.center||rt);this._normalizeCenter(je),G=p.centerPoint.add(at),Q=new i.P($e.x,$e.y).mult(p.worldSize),J=new i.P(i.as(je.lng),i.az(je.lat)).mult(p.worldSize).sub(Q)}else{G=p.centerPoint.add(B);const $e=p.pointLocation(G),at=i.bN.convert(n.center||$e);this._normalizeCenter(at),Q=p.project($e),J=p.project(at).sub(Q)}const ie=p.zoomScale(z-_);let oe,me;n.around&&(oe=i.bN.convert(n.around),me=p.locationPoint(oe));const Se=this._zooming||z!==_,be=this._rotating||y!==k,Pe=this._pitching||D!==w,Me=!p.isPaddingEqual(j),Ie=n.retainPadding===!1?p.clone():p,Ce=$e=>at=>{if(Se&&($e.zoom=i.ae(_,z,at)),be&&($e.bearing=i.ae(y,k,at)),Pe&&($e.pitch=i.ae(w,D,at)),Me&&(Ie.interpolatePadding(P,j,at),G=Ie.centerPoint.add(B)),oe)$e.setLocationAtPoint(oe,me);else{const rt=$e.zoomScale($e.zoom-_),je=z>_?Math.min(2,ie):Math.max(.5,ie),qe=Math.pow(je,1-at),mt=$e.unproject(Q.add(J.mult(at*qe)).mult(rt));$e.setLocationAtPoint($e.renderWorldCopies?mt.wrap():mt,G)}return n.preloadOnly||this._fireMoveEvents(s),$e};if(n.preloadOnly){const $e=this._emulate(Ce,n.duration,p);return this._preloadTiles($e),this}const De={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Se,this._rotating=be,this._pitching=Pe,this._padding=Me,this._easeId=n.easeId,this._prepareEase(s,n.noMoveStart,De),this._ease(Ce(p),$e=>{p.cameraElevationReference==="sea"&&p.recenterOnTerrain(),this._afterEase(s,$e)},n),this}_prepareEase(n,s,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),s||p.moving||this.fire(new i.z("movestart",n)),this._zooming&&!p.zooming&&this.fire(new i.z("zoomstart",n)),this._rotating&&!p.rotating&&this.fire(new i.z("rotatestart",n)),this._pitching&&!p.pitching&&this.fire(new i.z("pitchstart",n))}_fireMoveEvents(n){this.fire(new i.z("move",n)),this._zooming&&this.fire(new i.z("zoom",n)),this._rotating&&this.fire(new i.z("rotate",n)),this._pitching&&this.fire(new i.z("pitch",n))}_afterEase(n,s){if(this._easeId&&s&&this._easeId===s)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,_=this._rotating,y=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new i.z("zoomend",n)),_&&this.fire(new i.z("rotateend",n)),y&&this.fire(new i.z("pitchend",n)),this.fire(new i.z("moveend",n))}flyTo(n,s){if(this._prefersReducedMotion(n)){const st=i.ax(n,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(st,s)}this.stop(),n=i.l({offset:[0,0],speed:1.2,curve:1.42,easing:i.dA},n);const p=this.transform,_=this.getZoom(),y=this.getBearing(),w=this.getPitch(),P=this.getPadding(),z="zoom"in n?i.av(+n.zoom,p.minZoom,p.maxZoom):_,k="bearing"in n?this._normalizeBearing(n.bearing,y):y,D="pitch"in n?+n.pitch:w,j=this._extendPadding(n.padding),B=p.zoomScale(z-_),G=i.P.convert(n.offset);let Q=p.centerPoint.add(G);const J=p.pointLocation(Q),ie=i.bN.convert(n.center||J);this._normalizeCenter(ie);const oe=p.project(J),me=p.project(ie).sub(oe);let Se=n.curve;const be=Math.max(p.width,p.height),Pe=be/B,Me=me.mag();if("minZoom"in n){const st=i.av(Math.min(n.minZoom,_,z),p.minZoom,p.maxZoom),Rt=be/p.zoomScale(st-_);Se=Math.sqrt(Rt/Me*2)}const Ie=Se*Se;function Ce(st){const Rt=(Pe*Pe-be*be+(st?-1:1)*Ie*Ie*Me*Me)/(2*(st?Pe:be)*Ie*Me);return Math.log(Math.sqrt(Rt*Rt+1)-Rt)}function De(st){return(Math.exp(st)-Math.exp(-st))/2}function $e(st){return(Math.exp(st)+Math.exp(-st))/2}const at=Ce(0);let rt=function(st){return $e(at)/$e(at+Se*st)},je=function(st){return be*(($e(at)*(De(Rt=at+Se*st)/$e(Rt))-De(at))/Ie)/Me;var Rt},qe=(Ce(1)-at)/Se;if(Math.abs(Me)<1e-6||!isFinite(qe)){if(Math.abs(be-Pe)<1e-6)return this.easeTo(n,s);const st=Pe<be?-1:1;qe=Math.abs(Math.log(Pe/be))/Se,je=function(){return 0},rt=function(Rt){return Math.exp(st*Se*Rt)}}n.duration="duration"in n?+n.duration:1e3*qe/("screenSpeed"in n?+n.screenSpeed/Se:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0);const mt=y!==k,Tt=D!==w,Lt=!p.isPaddingEqual(j),et=n.retainPadding===!1?p.clone():p,xt=st=>Rt=>{const bt=Rt*qe,gt=1/rt(bt);st.zoom=Rt===1?z:_+st.scaleZoom(gt),mt&&(st.bearing=i.ae(y,k,Rt)),Tt&&(st.pitch=i.ae(w,D,Rt)),Lt&&(et.interpolatePadding(P,j,Rt),Q=et.centerPoint.add(G));const jt=Rt===1?ie:st.unproject(oe.add(me.mult(je(bt))).mult(gt));return st.setLocationAtPoint(st.renderWorldCopies?jt.wrap():jt,Q),st._updateCameraOnTerrain(),n.preloadOnly||this._fireMoveEvents(s),st};if(n.preloadOnly){const st=this._emulate(xt,n.duration,p);return this._preloadTiles(st),this}return this._zooming=!0,this._rotating=mt,this._pitching=Tt,this._padding=Lt,this._prepareEase(s,!1),this._ease(xt(p),()=>this._afterEase(s),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(n){}_cancelRenderFrame(n){}_stop(n,s){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,s)}if(!n){const p=this.handlers;p&&p.stop(!1)}return this}_ease(n,s,p){p.animate===!1||p.duration===0?(n(1),s()):(this._easeStart=i.q.now(),this._easeOptions=p,this._onEaseFrame=n,this._onEaseEnd=s,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((i.q.now()-this._easeStart)/this._easeOptions.duration,1),s=this._onEaseFrame;s&&s(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,s){n=i.bE(n,-180,180);const p=Math.abs(n-s);return Math.abs(n-360-s)<p&&(n-=360),Math.abs(n+360-s)<p&&(n+=360),n}_normalizeCenter(n){const s=this.transform;if(s.maxBounds||s.projection.name!=="globe"&&!s.renderWorldCopies)return;const p=n.lng-s.center.lng;n.lng+=p>180?-360:p<-180?360:0}_prefersReducedMotion(n){return this._respectPrefersReducedMotion&&i.q.prefersReducedMotion&&!(n&&n.essential)}_emulate(n,s,p){const _=Math.ceil(15*s/1e3),y=[],w=n(p.clone());for(let P=0;P<=_;P++){const z=w(P/_);y.push(z.clone())}return y}_preloadTiles(n,s){}}class Am{constructor(n={}){this.options=n,i.aO(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){const s=this.options&&this.options.compact,p=n._getUIString("AttributionControl.ToggleAttribution");this._map=n,this._container=ue("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=ue("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",p);const _=ue("span","mapboxgl-ctrl-icon",this._compactButton);return _.setAttribute("aria-hidden","true"),_.setAttribute("title",p),this._innerContainer=ue("div","mapboxgl-ctrl-attrib-inner",this._container),s&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),s===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));const s=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||i.e.ACCESS_TOKEN}];if(n){const p=s.reduce((_,y,w)=>(y.value&&(_+=`${y.key}=${y.value}${w<s.length-1?"&":""}`),_),"?");n.href=`${i.e.FEEDBACK_URL}/${p}#${nf(this._map,!0)}`,n.rel="noopener nofollow"}}_updateData(n){!n||n.sourceDataType!=="metadata"&&n.sourceDataType!=="visibility"&&n.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let n=[];if(this._map.style.stylesheet){const _=this._map.style.stylesheet;this.styleOwner=_.owner,this.styleId=_.id}const s=this._map.style._mergedSourceCaches;for(const _ in s){const y=s[_];if(y.used){const w=y.getSource();w.attribution&&n.indexOf(w.attribution)<0&&n.push(w.attribution)}}n.sort((_,y)=>_.length-y.length),n=n.filter((_,y)=>{for(let w=y+1;w<n.length;w++)if(n[w].indexOf(_)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=[...this.options.customAttribution,...n]:n.unshift(this.options.customAttribution));const p=n.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,n.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class q0{constructor(){i.aO(["_updateLogo","_updateCompact"],this)}onAdd(n){this._map=n,this._container=ue("div","mapboxgl-ctrl");const s=ue("a","mapboxgl-ctrl-logo");return s.target="_blank",s.rel="noopener nofollow",s.href="https://www.mapbox.com/",s.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),s.setAttribute("rel","noopener nofollow"),this._container.appendChild(s),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(n){n&&n.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const n=this._map.style._sourceCaches;if(Object.entries(n).length===0)return!0;for(const s in n){const p=n[s].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const n=this._container.children;if(n.length){const s=n[0];this._map.getCanvasContainer().offsetWidth<250?s.classList.add("mapboxgl-compact"):s.classList.remove("mapboxgl-compact")}}}class cc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const s=++this._id;return this._queue.push({callback:n,id:s,cancelled:!1}),s}remove(n){const s=this._currentlyRunning,p=s?this._queue.concat(s):this._queue;for(const _ of p)if(_.id===n)return void(_.cancelled=!0)}run(n=0){const s=this._currentlyRunning=this._queue;this._queue=[];for(const p of s)if(!p.cancelled&&(p.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class Rm{constructor(n){this.jumpTo(n)}getValue(n){if(n<=this._startTime)return this._start;if(n>=this._endTime)return this._end;const s=i.cA((n-this._startTime)/(this._endTime-this._startTime));return this._start*(1-s)+this._end*s}isEasing(n){return n>=this._startTime&&n<=this._endTime}jumpTo(n){this._startTime=-1/0,this._endTime=-1/0,this._start=n,this._end=n}easeTo(n,s,p){this._start=this.getValue(s),this._end=n,this._startTime=s,this._endTime=s+p}}const Ta={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Ca=["mouseenter","mouseover","mouseleave","mouseout"];class uc extends i.z{constructor(n,s,p,_){const{point:y,lngLat:w,originalEvent:P,target:z}=n;super(n.type,{point:y,lngLat:w,originalEvent:P,target:z}),this.preventDefault=()=>{n.preventDefault()},this.id=s,this.interaction=p,this.feature=_}}class hc{constructor(n){this.map=n,this.interactionsByType=new Map,this.typeById=new Map,this.filters=new Map,this.delegatedHandlers=new Map,this.handleType=this.handleType.bind(this)}add(n,s){if(this.typeById.has(n))throw new Error(`Interaction id "${n}" already exists.`);const{type:p,filter:_}=s;_&&this.filters.set(n,i.aY(_));const y=this.interactionsByType.get(p)||new Map;if(y.size===0){if(Ca.includes(p)){const{mousemove:w,mouseout:P}=this._createDelegatedHandlers(n,s);this.map.on("mousemove",w),this.map.on("mouseout",P),this.delegatedHandlers.set(n,{mousemove:w,mouseout:P})}else this.map.on(p,this.handleType);this.interactionsByType.set(p,y)}y.set(n,s),this.typeById.set(n,p)}get(n){const s=this.typeById.get(n);if(!s)return;const p=this.interactionsByType.get(s);return p?p.get(n):void 0}remove(n){const s=this.typeById.get(n);if(!s)return;this.typeById.delete(n),this.filters.delete(n);const p=this.interactionsByType.get(s);if(p){if(p.delete(n),this.delegatedHandlers.has(n)){const{mousemove:_,mouseout:y}=this.delegatedHandlers.get(n);this.map.off("mousemove",_),this.map.off("mouseout",y),this.delegatedHandlers.delete(n)}p.size===0&&this.map.off(s,this.handleType)}}queryTargets(n,s){const p=[];for(const[_,y]of s)y.target&&p.push({targetId:_,target:y.target,filter:this.filters.get(_)});return this.map.style.queryRenderedTargets(n,p,this.map.transform)}handleType(n,s){const p=this.interactionsByType.get(n.type),_=Array.from(p).reverse();s=s||this.queryTargets(n.point,_);let y=!1;for(const w of s){for(const[P,z]of _){if(!z.target)continue;const k=w.variants?w.variants[P]:null;if(k){for(const D of k){const j=new i.cv(w,D);if(z.handler(new uc(n,P,z,j))!==!1){y=!0;break}}if(y)break}}if(y)break}if(!y)for(const[w,P]of _){const{handler:z,target:k}=P;if(!k&&z(new uc(n,w,P,null))!==!1)break}}_createDelegatedHandlers(n,s){switch(s.type){case"mouseenter":case"mouseover":{let p=!1,_=new Set;return{mousemove:y=>{const w=this.queryTargets(y.point,[[n,s]]),P=new Set;if(!w.length)return p=!1,void _.clear();const z=[];for(const k of w)_.has(k.id)||(P.add(k.id),z.push(k));p&&!z.length||(p=!0,_=P,y.type=s.type,this.handleType(y,z))},mouseout:()=>{p=!1,_.clear()}}}case"mouseleave":case"mouseout":{let p=[];return{mousemove:_=>{const y=this.queryTargets(_.point,[[n,s]]);if(!y.length)return _.type=s.type,this.handleType(_,p),void(p=y);const w=[],P=new Set(y.map(z=>z.id));for(const z of p)P.has(z.id)||w.push(z);w.length&&(_.type=s.type,this.handleType(_,w)),p=y},mouseout:_=>{p.length&&(_.type=s.type,this.handleType(_,p),p=[])}}}}}}function nu(f,n){if(Array.isArray(f)&&Array.isArray(n)){const s=new Set(f),p=new Set(n);return s.size===p.size&&f.every(_=>p.has(_))}return i.bm(f,n)}const zm={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},rn={showCompass:!0,showZoom:!0,visualizePitch:!1};class Pl{constructor(n,s,p=!1){this._clickTolerance=10,this.element=s,this.mouseRotate=new Mm({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,p&&(this.mousePitch=new of({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),i.aO(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),s.addEventListener("mousedown",this.mousedown),s.addEventListener("touchstart",this.touchstart,{passive:!1}),s.addEventListener("touchmove",this.touchmove),s.addEventListener("touchend",this.touchend),s.addEventListener("touchcancel",this.reset)}down(n,s){this.mouseRotate.mousedown(n,s),this.mousePitch&&this.mousePitch.mousedown(n,s),ve()}move(n,s){const p=this.map,_=this.mouseRotate.mousemoveWindow(n,s),y=_&&_.bearingDelta;if(y&&p.setBearing(p.getBearing()+y),this.mousePitch){const w=this.mousePitch.mousemoveWindow(n,s),P=w&&w.pitchDelta;P&&p.setPitch(p.getPitch()+P)}}off(){const n=this.element;n.removeEventListener("mousedown",this.mousedown),n.removeEventListener("touchstart",this.touchstart,{passive:!1}),n.removeEventListener("touchmove",this.touchmove),n.removeEventListener("touchend",this.touchend),n.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Te(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(n){this.down(i.l({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),Ne(this.element,n)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(n){this.move(n,Ne(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){n.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Xe(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){n.targetTouches.length!==1?this.reset():(this._lastPos=Xe(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){n.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function Z0(f,n,s){if(f=new i.bN(f.lng,f.lat),n){const p=new i.bN(f.lng-360,f.lat),_=new i.bN(f.lng+360,f.lat),y=360*Math.ceil(Math.abs(f.lng-s.center.lng)/360),w=s.locationPoint(f).distSqr(n),P=n.x<0||n.y<0||n.x>s.width||n.y>s.height;s.locationPoint(p).distSqr(n)<w&&(P||Math.abs(p.lng-s.center.lng)<y)?f=p:s.locationPoint(_).distSqr(n)<w&&(P||Math.abs(_.lng-s.center.lng)<y)&&(f=_)}for(;Math.abs(f.lng-s.center.lng)>180;){const p=s.locationPoint(f);if(p.x>=0&&p.y>=0&&p.x<=s.width&&p.y<=s.height)break;f.lng>s.center.lng?f.lng-=360:f.lng+=360}return f}const Lm={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Sh extends i.E{constructor(n,s){if(super(),(n instanceof HTMLElement||s)&&(n=i.l({element:n},s)),i.aO(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=n&&n.occludedOpacity||.2,n&&n.element)this._element=n.element,this._offset=i.P.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=ue("div");const y=41,w=27,P=fe("svg",{display:"block",height:y*this._scale+"px",width:w*this._scale+"px",viewBox:`0 0 ${w} ${y}`},this._element),z=fe("radialGradient",{id:"shadowGradient"},fe("defs",{},P));fe("stop",{offset:"10%","stop-opacity":.4},z),fe("stop",{offset:"100%","stop-opacity":.05},z),fe("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},P),fe("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},P),fe("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},P),fe("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},P),this._offset=i.P.convert(n&&n.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",y=>{y.preventDefault()}),this._element.addEventListener("mousedown",y=>{y.preventDefault()});const p=this._element.classList;for(const y in Lm)p.remove(`mapboxgl-marker-anchor-${y}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`);const _=n&&n.className?n.className.trim().split(/\s+/):[];p.add(..._),this._popup=null}addTo(n){return n===this._map||(this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._updateMoving),n.on("moveend",this._update),n.on("remove",this._clearFadeTimer),n._addMarker(this),this.setDraggable(this._draggable),this._update(),n.on("click",this._onMapClick)),this}remove(){const n=this._map;return n&&(n.off("click",this._onMapClick),n.off("move",this._updateMoving),n.off("moveend",this._update),n.off("mousedown",this._addDragHandler),n.off("touchstart",this._addDragHandler),n.off("mouseup",this._onUp),n.off("touchend",this._onUp),n.off("mousemove",this._onMove),n.off("touchmove",this._onMove),n.off("remove",this._clearFadeTimer),n._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=i.bN.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const _=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[_,-1*(38.1-13.5+_)],"bottom-right":[-_,-1*(38.1-13.5+_)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=n,n._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(n){const s=n.code,p=n.charCode||n.keyCode;s!=="Space"&&s!=="Enter"&&p!==32&&p!==13||this.togglePopup()}_onMapClick(n){const s=n.originalEvent.target,p=this._element;this._popup&&(s===p||p.contains(s))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?(n.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(n.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const n=this._map,s=this._pos;if(!n||!s)return!1;const p=n.unproject(s),_=n.getFreeCameraOptions();if(!_.position)return!1;const y=_.position.toLngLat();return y.distanceTo(p)<.9*y.distanceTo(this._lngLat)}_evaluateOpacity(){const n=this._map;if(!n)return;const s=this._pos;if(!s||s.x<0||s.x>n.transform.width||s.y<0||s.y>n.transform.height)return void this._clearFadeTimer();const p=n.unproject(s);let _;n._showingGlobe()&&i.dH(n.transform,this._lngLat)?_=0:(_=1-n._queryFogOpacity(p),n.transform._terrainEnabled()&&n.getTerrain()&&this._behindTerrain()&&(_*=this._occludedOpacity)),this._element.style.opacity=`${_}`,this._element.style.pointerEvents=_>0?"auto":"none",this._popup&&this._popup._setOpacity(_),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const n=this._pos;if(!n||!this._map)return;const s=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${n.x}px,${n.y}px)
            ${Lm[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${s.x}px,${s.y}px)
        `}_calculateXYTransform(){const n=this._pos,s=this._map,p=this.getPitchAlignment();if(!s||!n||p!=="map")return"";if(!s._showingGlobe()){const z=s.getPitch();return z?`rotateX(${z}deg)`:""}const _=i.c3(i.dI(s.transform,this._lngLat)),y=n.sub(i.dJ(s.transform)),w=Math.abs(y.x)+Math.abs(y.y);if(w===0)return"";const P=_/w;return`rotateX(${-y.y*P}deg) rotateY(${y.x*P}deg)`}_calculateZTransform(){const n=this._pos,s=this._map;if(!s||!n)return"";let p=0;const _=this.getRotationAlignment();if(_==="map")if(s._showingGlobe()){const y=s.project(new i.bN(this._lngLat.lng,this._lngLat.lat+.001)),w=s.project(new i.bN(this._lngLat.lng,this._lngLat.lat-.001)).sub(y);p=i.c3(Math.atan2(w.y,w.x))-90}else p=-s.getBearing();else if(_==="horizon"){const y=i.ab(4,6,s.getZoom()),w=i.dJ(s.transform);w.y+=y*s.transform.height;const P=n.sub(w),z=i.c3(Math.atan2(P.y,P.x));p=(z>90?z-270:z+90)*(1-y)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(n){cancelAnimationFrame(this._updateFrameId);const s=this._map;s&&(s.transform.renderWorldCopies&&(this._lngLat=Z0(this._lngLat,this._pos,s.transform)),this._pos=s.project(this._lngLat),n===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),s._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(s._showingGlobe()||s.getTerrain()||s.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(n){return this._offset=i.P.convert(n),this._update(),this}addClassName(n){return this._element.classList.add(n),this}removeClassName(n){return this._element.classList.remove(n),this}toggleClassName(n){return this._element.classList.toggle(n)}_onMove(n){const s=this._map;if(!s)return;const p=this._pointerdownPos,_=this._positionDelta;if(p&&_){if(!this._isDragging){const y=this._clickTolerance||s._clickTolerance;if(n.point.dist(p)<y)return;this._isDragging=!0}this._pos=n.point.sub(_),this._lngLat=s.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new i.z("dragstart"))),this.fire(new i.z("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const n=this._map;n&&(n.off("mousemove",this._onMove),n.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new i.z("dragend")),this._state="inactive"}_addDragHandler(n){const s=this._map,p=this._pos;s&&p&&this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(p),this._pointerdownPos=n.point,this._state="pending",s.on("mousemove",this._onMove),s.on("touchmove",this._onMove),s.once("mouseup",this._onUp),s.once("touchend",this._onUp))}setDraggable(n){this._draggable=!!n;const s=this._map;return s&&(n?(s.on("mousedown",this._addDragHandler),s.on("touchstart",this._addDragHandler)):(s.off("mousedown",this._addDragHandler),s.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(n){return this._occludedOpacity=n||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Al={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Hs={maxWidth:100,unit:"metric"},wo={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},ta={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Zi=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function km(f=new i.P(0,0),n="bottom"){if(typeof f=="number"){const s=Math.round(Math.sqrt(.5*Math.pow(f,2)));switch(n){case"top":return new i.P(0,f);case"top-left":return new i.P(s,s);case"top-right":return new i.P(-s,s);case"bottom":return new i.P(0,-f);case"bottom-left":return new i.P(s,-s);case"bottom-right":return new i.P(-s,-s);case"left":return new i.P(f,0);case"right":return new i.P(-f,0)}return new i.P(0,0)}return f instanceof i.P||Array.isArray(f)?i.P.convert(f):i.P.convert(f[n]||[0,0])}return{version:L,supported:ce.supported,setRTLTextPlugin:i.dK,getRTLTextPluginStatus:i.dL,Map:class extends Pm{constructor(f){U.mark(N.create);const n=f;if((f=i.l({},zm,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(f.antialias&&i.dF(window)&&(f.antialias=!1,i.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ed(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),f),this._repaint=!!f.repaint,this._interactive=f.interactive,this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=f.crossSourceCollisions,this._collectResourceTiming=f.collectResourceTiming,this._language=this._parseLanguage(f.language),this._worldview=f.worldview,this._renderTaskQueue=new cc,this._domRenderTaskQueue=new cc,this._controls=[],this._markers=[],this._popups=[],this._mapId=i.aU(),this._locale=i.l({},Ta,f.locale),this._clickTolerance=f.clickTolerance,this._cooperativeGestures=f.cooperativeGestures,this._performanceMetricsCollection=f.performanceMetricsCollection,this._tessellationStep=f.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=f.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Rm(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=f.scaleFactor,this._requestManager=new yt(f.transformRequest,f.accessToken,f.testMode),this._silenceAuthErrors=!!f.testMode,this._contextCreateOptions=f.contextCreateOptions?{...f.contextCreateOptions}:{},typeof f.container=="string"){const s=document.getElementById(f.container);if(!s)throw new Error(`Container '${f.container.toString()}' not found.`);this._container=s}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(this._container.childNodes.length>0&&i.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),f.maxBounds&&this.setMaxBounds(f.maxBounds),this._spriteFormat=f.spriteFormat,i.aO(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new ym),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new W0(this,f),this._localFontFamily=f.localFontFamily,this._localIdeographFontFamily=f.localIdeographFontFamily,(f.style||!f.testMode)&&this.setStyle(f.style||i.e.DEFAULT_STYLE,{config:f.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),f.projection&&this.setProjection(f.projection),this.indoor=new r0(this),f.hash&&(this._hash=new rf(typeof f.hash=="string"&&f.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){n.center==null&&n.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch});const s=f.bounds;s&&(this.resize(),this.fitBounds(s,i.l({},f.fitBoundsOptions,{duration:0})))}this.resize(),f.attributionControl&&this.addControl(new Am({customAttribution:f.customAttribution})),this._logoControl=new q0,this.addControl(this._logoControl,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",s=>{this._update(s.dataType==="style"),this.fire(new i.z(`${s.dataType}data`,s))}),this.on("dataloading",s=>{this.fire(new i.z(`${s.dataType}dataloading`,s))}),this._interactions=new hc(this)}_getMapId(){return this._mapId}addControl(f,n){if(n===void 0&&(n=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new i.y(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const s=f.onAdd(this);this._controls.push(f);const p=this._controlPositions[n];return n.indexOf("bottom")!==-1?p.insertBefore(s,p.firstChild):p.appendChild(s),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new i.y(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(f);return n>-1&&this._controls.splice(n,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(f){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new i.z("movestart",f)).fire(new i.z("move",f)),this.fire(new i.z("resize",f)),n&&this.fire(new i.z("moveend",f)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(f){return this.transform.setMaxBounds(i.ay.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f?this.setZoom(f):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f?this.setZoom(f):this.fire(new i.z("zoomstart")).fire(new i.z("zoom")).fire(new i.z("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f?this.setPitch(f):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f?this.setPitch(f):this.fire(new i.z("pitchstart")).fire(new i.z("pitch")).fire(new i.z("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(f){return this._scaleFactor=f,this.painter.scaleFactor=f,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(n=>n.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(f){return f==="auto"?navigator.language:Array.isArray(f)?f.length===0?void 0:f.map(n=>n==="auto"?navigator.language:n):f}setLanguage(f){const n=this._parseLanguage(f);if(!this.style||n===this._language)return this;this._language=n,this.style.reloadSources();for(const s of this._controls)s._setLanguage&&s._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(f){return this.style&&f!==this._worldview?(this._worldview=f,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(f){return this._lazyInitEmptyStyle(),f?typeof f=="string"&&(f={name:f}):f=null,this._useExplicitProjection=!!f,this._prioritizeAndUpdateProjection(f,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const f=this.transform,n=f.projection.name;let s;n==="globe"&&f.zoom>=i.bX?(f.setMercatorFromTransition(),s=!0):n==="mercator"&&f.zoom<i.bX&&(f.setProjection({name:"globe"}),s=!0),s&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(f,n){return this._updateProjection(f||n||{name:"mercator"})}_updateProjection(f){let n;return n=f.name==="globe"&&this.transform.zoom>=i.bX?this.transform.setMercatorFromTransition():this.transform.setProjection(f),this.style.applyProjectionUpdate(),n&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(f){return this.transform.locationPoint3D(i.bN.convert(f))}unproject(f){return this.transform.pointLocation3D(i.P.convert(f))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(f,n,s){const p=_=>{let y=[];if(Array.isArray(n)){const w=n.filter(P=>this.getLayer(P));y=w.length?this.queryRenderedFeatures(_,{layers:w}):[]}else y=this.queryRenderedFeatures(_,{target:n});return y};if(f==="mouseenter"||f==="mouseover"){let _=!1;return{listener:s,targets:n,delegates:{mousemove:w=>{const P=p(w.point);P.length?_||(_=!0,s.call(this,new ea(f,this,w.originalEvent,{features:P}))):_=!1},mouseout:()=>{_=!1}}}}if(f==="mouseleave"||f==="mouseout"){let _=!1;return{listener:s,targets:n,delegates:{mousemove:P=>{p(P.point).length?_=!0:_&&(_=!1,s.call(this,new ea(f,this,P.originalEvent)))},mouseout:P=>{_&&(_=!1,s.call(this,new ea(f,this,P.originalEvent)))}}}}{const _=y=>{const w=p(y.point);w.length&&(y.features=w,s.call(this,y),delete y.features)};return{listener:s,targets:n,delegates:{[f]:_}}}}on(f,n,s){if(typeof n=="function"||s===void 0)return super.on(f,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const p=this._createDelegatedListener(f,n,s);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(p);for(const _ in p.delegates)this.on(_,p.delegates[_]);return this}once(f,n,s){if(typeof n=="function"||s===void 0)return super.once(f,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const p=this._createDelegatedListener(f,n,s);for(const _ in p.delegates)this.once(_,p.delegates[_]);return this}off(f,n,s){if(typeof n=="function"||s===void 0)return super.off(f,n);if(typeof n=="string"&&(n=[n]),!this._areTargetsValid(n))return this;const p=this._delegatedListeners?this._delegatedListeners[f]:void 0;return p&&(_=>{for(let y=0;y<_.length;y++){const w=_[y];if(w.listener===s&&nu(w.targets,n)){for(const P in w.delegates)this.off(P,w.delegates[P]);return _.splice(y,1),this}}})(p),this}queryRenderedFeatures(f,n){if(!this.style)return[];if(f===void 0||f instanceof i.P||Array.isArray(f)||n!==void 0||(n=f,f=void 0),f=f||[[0,0],[this.transform.width,this.transform.height]],!n){const y=this.style.queryRenderedFeatures(f,void 0,this.transform),w=this.style.queryRenderedFeatureset(f,void 0,this.transform);return y.concat(w)}let s=!0;if(n.target&&(s=this._isTargetValid(n.target),s&&!n.layers))return this.style.queryRenderedFeatureset(f,n,this.transform);let p=!0;if(n.layers&&Array.isArray(n.layers)){for(const y of n.layers)if(!this._isValidId(y)){p=!1;break}if(p&&!n.target)return this.style.queryRenderedFeatures(f,n,this.transform)}let _=[];return p&&(_=_.concat(this.style.queryRenderedFeatures(f,n,this.transform))),s&&(_=_.concat(this.style.queryRenderedFeatureset(f,n,this.transform))),_}querySourceFeatures(f,n){return!f||typeof f=="string"&&!this._isValidId(f)?[]:this.style.querySourceFeatures(f,n)}isPointOnSurface(f){const{name:n}=this.transform.projection;return n!=="globe"&&n!=="mercator"&&i.w(`${n} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(i.P.convert(f))}addInteraction(f,n){return this._interactions.add(f,n),this}removeInteraction(f){return this._interactions.remove(f),this}setStyle(f,n){return n=i.l({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n),this.style&&f&&n.diff!==!1&&n.localFontFamily===this._localFontFamily&&n.localIdeographFontFamily===this._localIdeographFontFamily&&!n.config?(this.style._diffStyle(f,(s,p)=>{s?(i.w(`Unable to perform style diff: ${String(s.message||s.error||s)}. Rebuilding the style from scratch.`),this._updateStyle(f,n)):p&&this._update(!0)},()=>{this._postStyleLoadEvent()}),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(f,n))}_getUIString(f){const n=this._locale[f];if(n==null)throw new Error(`Missing UI string '${f}'`);return n}_updateStyle(f,n){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),f){const s=i.l({},n);n&&n.config&&(s.initialConfig=n.config,delete s.config),this.style=new Oa(this,s).load(f),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Oa(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(i.w("There is no style added to the map."),!1)}_isValidId(f){return f==null?(this.fire(new i.y(new Error("IDs can't be empty."))),!1):!i.cq(f)||(this.fire(new i.y(new Error(`IDs can't contain special symbols: "${f}".`))),!1)}_isTargetValid(f){return"featuresetId"in f?this._isValidId("importId"in f?f.importId:f.featuresetId):"layerId"in f&&this._isValidId(f.layerId)}_areTargetsValid(f){if(Array.isArray(f)){for(const n of f)if(!this._isValidId(n))return!1;return!0}return this._isTargetValid(f)}addSource(f,n){return this._isValidId(f)?(this._lazyInitEmptyStyle(),this.style.addSource(f,n),this._update(!0)):this}isSourceLoaded(f){return!!this._isValidId(f)&&!!this.style&&this.style._isSourceCacheLoaded(f)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(f,n,s){this._lazyInitEmptyStyle(),this.style.addSourceType(f,n,s)}removeSource(f){return this._isValidId(f)?(this.style.removeSource(f),this._updateTerrain(),this._update(!0)):this}getSource(f){return this._isValidId(f)?this.style.getOwnSource(f):null}addImage(f,n,{pixelRatio:s=1,sdf:p=!1,stretchX:_,stretchY:y,content:w}={}){if(this._lazyInitEmptyStyle(),n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap){const{width:P,height:z,data:k}=i.q.getImageData(n);this.style.addImage(f,{data:new i.r({width:P,height:z},k),pixelRatio:s,stretchX:_,stretchY:y,content:w,sdf:p,version:0,usvg:!1})}else if(n.width===void 0||n.height===void 0)this.fire(new i.y(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:P,height:z}=n,k=n;this.style.addImage(f,{data:new i.r({width:P,height:z},new Uint8Array(k.data)),pixelRatio:s,stretchX:_,stretchY:y,content:w,sdf:p,usvg:!1,version:0,userImage:k}),k.onAdd&&k.onAdd(this,f)}}updateImage(f,n){this._lazyInitEmptyStyle();const s=this.style.getImage(f);if(!s)return void this.fire(new i.y(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap?i.q.getImageData(n):n,{width:_,height:y,data:w}=p;if(_===void 0||y===void 0)return void this.fire(new i.y(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(_!==(s.usvg?s.icon.usvg_tree.width:s.data.width)||y!==(s.usvg?s.icon.usvg_tree.height:s.data.height))return void this.fire(new i.y(new Error(`The width and height of the updated image (${_}, ${y})
                must be that same as the previous version of the image
                (${s.data.width}, ${s.data.height})`)));const P=!(n instanceof HTMLImageElement||ImageBitmap&&n instanceof ImageBitmap);let z=!1;s.usvg?(s.data=new i.r({width:_,height:y},new Uint8Array(w)),s.usvg=!1,s.icon=void 0,z=!0):s.data.replace(w,P),this.style.updateImage(f,s,z)}hasImage(f){return f?!!this.style&&!!this.style.getImage(f):(this.fire(new i.y(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,n){i.o(this._requestManager.transformRequest(f,i.R.Image),(s,p)=>{n(s,p instanceof HTMLImageElement?i.q.getImageData(p):p)})}listImages(){return this.style.listImages()}addModel(f,n){this._lazyInitEmptyStyle(),this.style.addModel(f,n)}hasModel(f){return f?this.style.hasModel(f):(this.fire(new i.y(new Error("Missing required model id"))),!1)}removeModel(f){this.style.removeModel(f)}listModels(){return this.style.listModels()}addLayer(f,n){return this._isValidId(f.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(f,n),this._update(!0)):this}getSlot(f){const n=this.getLayer(f);return n&&n.slot||null}setSlot(f,n){return this.style.setSlot(f,n),this.style.mergeLayers(),this._update(!0)}addImport(f,n){return this.style.addImport(f,n),this}updateImport(f,n){return typeof n!="string"&&n.id!==f?(this.removeImport(f),this.addImport(n)):(this.style.updateImport(f,n),this._update(!0))}removeImport(f){return this.style.removeImport(f),this}moveImport(f,n){return this.style.moveImport(f,n),this._update(!0)}moveLayer(f,n){return this._isValidId(f)?(this.style.moveLayer(f,n),this._update(!0)):this}removeLayer(f){return this._isValidId(f)?(this.style.removeLayer(f),this._update(!0)):this}getLayer(f){if(!this._isValidId(f))return null;const n=this.style.getOwnLayer(f);return n?n.type==="custom"?n.implementation:n.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(f,n,s){return this._isValidId(f)?(this.style.setLayerZoomRange(f,n,s),this._update(!0)):this}setFilter(f,n,s={}){return this._isValidId(f)?(this.style.setFilter(f,n,s),this._update(!0)):this}getFilter(f){return this._isValidId(f)?this.style.getFilter(f):null}setPaintProperty(f,n,s,p={}){return this._isValidId(f)?(this.style.setPaintProperty(f,n,s,p),this._update(!0)):this}getPaintProperty(f,n){return this._isValidId(f)?this.style.getPaintProperty(f,n):null}setLayoutProperty(f,n,s,p={}){return this._isValidId(f)?(this.style.setLayoutProperty(f,n,s,p),this._update(!0)):this}getLayoutProperty(f,n){return this._isValidId(f)?this.style.getLayoutProperty(f,n):null}getSchema(f){return this.style.getSchema(f)}setSchema(f,n){return this.style.setSchema(f,n),this._update(!0)}getConfig(f){return this.style.getConfig(f)}setConfig(f,n){return this.style.setConfig(f,n),this._update(!0)}getConfigProperty(f,n){return this.style.getConfigProperty(f,n)}setConfigProperty(f,n,s){return this.style.setConfigProperty(f,n,s),this._update(!0)}getFeaturesetDescriptors(f){return this.style.getFeaturesetDescriptors(f)}setLights(f){if(this._lazyInitEmptyStyle(),f&&f.length===1&&f[0].type==="flat"){const n=f[0];n.properties?this.style.setFlatLight(n.properties,n.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(f),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const f=this.style.getLights()||[];return f.length===0&&f.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),f}setLight(f,n={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:f}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(f){return this._lazyInitEmptyStyle(),!f&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(f),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(f){return this._lazyInitEmptyStyle(),this.style.setFog(f),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(f){return this._lazyInitEmptyStyle(),this.style.setSnow(f),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(f){return this._lazyInitEmptyStyle(),this.style.setRain(f),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(f){return this._lazyInitEmptyStyle(),this.style.setColorTheme(f),this._update(!0)}setImportColorTheme(f,n){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(f,n),this._update(!0)}setCamera(f){return this.style.setCamera(f),this._triggerCameraUpdate(f)}_triggerCameraUpdate(f){return this._update(this.transform.setOrthographicProjectionAtLowPitch(f["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(f){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(i.bN.convert(f),this.transform):0}setFeatureState(f,n){return f.source&&!this._isValidId(f.source)?this:(this.style.setFeatureState(f,n),this._update())}removeFeatureState(f,n){return f.source&&!this._isValidId(f.source)?this:(this.style.removeFeatureState(f,n),this._update())}getFeatureState(f){return f.source&&!this._isValidId(f.source)?null:this.style.getFeatureState(f)}_updateContainerDimensions(){if(!this._container)return;const f=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let s,p,_,y=this._container;for(;y&&(!p||!_);){const w=window.getComputedStyle(y).transform;w&&w!=="none"&&(s=w.match(/matrix.*\((.+)\)/)[1].split(", "),s[0]&&s[0]!=="0"&&s[0]!=="1"&&(p=s[0]),s[3]&&s[3]!=="0"&&s[3]!=="1"&&(_=s[3])),y=y.parentElement}this._containerWidth=p?Math.abs(f/p):f,this._containerHeight=_?Math.abs(n/_):n}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&i.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const f=this._container;f.classList.add("mapboxgl-map"),(this._missingCSSCanary=ue("div","mapboxgl-canary",f)).style.visibility="hidden",this._detectMissingCSS();const n=this._canvasContainer=ue("div","mapboxgl-canvas-container",f);this._canvas=ue("canvas","mapboxgl-canvas",n),this._interactive&&(n.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const s=this._controlContainer=ue("div","mapboxgl-control-container",f),p=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(_=>{p[_]=ue("div",`mapboxgl-ctrl-${_}`,s)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(f,n){const s=i.q.devicePixelRatio||1;this._canvas.width=s*Math.ceil(f),this._canvas.height=s*Math.ceil(n),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${n}px`}_addMarker(f){this._markers.push(f)}_removeMarker(f){const n=this._markers.indexOf(f);n!==-1&&this._markers.splice(n,1)}_addPopup(f){this._popups.push(f)}_removePopup(f){const n=this._popups.indexOf(f);n!==-1&&this._popups.splice(n,1)}_setupPainter(){const f=i.l({},ce.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl2",f);n?($r(n,!0),this.painter=new Em(n,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp),this.on("data",s=>{s.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),i.m.testSupport(n)):this.fire(new i.y(new Error("Failed to initialize WebGL")))}_contextLost(f){f.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new i.z("webglcontextlost",{originalEvent:f}))}_contextRestored(f){this._setupPainter(),this.resize(),this._update(),this.fire(new i.z("webglcontextrestored",{originalEvent:f}))}_onMapScroll(f){if(f.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(f){return this.style?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_requestDomTask(f){!this.loaded()||this.loaded()&&!this.isMoving()?f():this._domRenderTaskQueue.add(f)}_render(f){let n;this.fire(new i.z("renderstart")),++this._frameId;const s=this.painter.context.extTimerQuery,p=i.q.now(),_=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(n=_.createQuery(),_.beginQuery(s.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(f),this._domRenderTaskQueue.run(f),this._removed)return;this._updateProjectionTransition();const y=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const k=this.transform.zoom,D=this.transform.pitch,j=i.q.now(),B=new i.a7(k,{now:j,fadeDuration:y,pitch:D,transition:this.style.transition});this.style.update(B)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let w=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),w=this._updateAverageElevation(p),this.style.updateSources(this.transform),this._forceMarkerAndPopupUpdate()):w=this._updateAverageElevation(p);const P=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,y,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),P&&(this._placementDirty=P.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:y,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new i.z("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,U.mark(N.load),this.fire(new i.z("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const k=i.q.now()-p;_.endQuery(s.TIME_ELAPSED_EXT),setTimeout(()=>{const D=_.getQueryParameter(n,_.QUERY_RESULT)/1e6;_.deleteQuery(n),this.fire(new i.z("gpu-timing-frame",{cpuTime:k,gpuTime:D}))},50)}if(this.listens("gpu-timing-layer")){const k=this.painter.collectGpuTimers();setTimeout(()=>{const D=this.painter.queryGpuTimers(k);this.fire(new i.z("gpu-timing-layer",{layerTimes:D}))},50)}if(this.listens("gpu-timing-deferred-render")){const k=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const D=this.painter.queryGpuTimeDeferredRender(k);this.fire(new i.z("gpu-timing-deferred-render",{gpuTime:D}))},50)}const z=this._sourcesDirty||this._styleDirty||this._placementDirty||w;if(z||this._repaint)this.triggerRepaint();else{const k=this.idle();if(k&&(w=this._updateAverageElevation(p,!0)),w)this.triggerRepaint();else if(this._triggerFrame(!1),k&&(this.fire(new i.z("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const D=this._calculateSpeedIndex();this.fire(new i.z("speedindexcompleted",{speedIndex:D})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||z||(this._fullyLoaded=!0,U.mark(N.fullLoad),this._performanceMetricsCollection&&qr(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(f){for(const n of this._markers)f&&!this.getRenderWorldCopies()&&(n._lngLat=n._lngLat.wrap()),n._update();for(const n of this._popups)!f||this.getRenderWorldCopies()||n._trackPointer||(n._lngLat=n._lngLat.wrap()),n._update()}_updateAverageElevation(f,n=!1){const s=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&s(0);const p=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(p||(n||f-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(f)){const _=this.transform.averageElevation;let y=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(y)?y=0:this._averageElevationLastSampledAt=f;const w=Math.abs(_-y);if(w>1){if(this._isInitialLoad||p)return this._averageElevation.jumpTo(y),s(y);this._averageElevation.easeTo(y,f,300)}else if(w>1e-4)return this._averageElevation.jumpTo(y),s(y)}return!!this._averageElevation.isEasing(f)&&s(this._averageElevation.getValue(f))}_authenticate(){Ae(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,f=>{if(f&&(f.message===ft||f.status===401)){const n=this.painter.context.gl;$r(n,!1),this._logoControl instanceof q0&&this._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new i.y(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),qt(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&cr(this._requestManager._customAccessToken,{map:this,skuToken:this._requestManager._skuToken,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const f=this._isDragging();this.painter.updateTerrain(this.style,f)}_calculateSpeedIndex(){const f=this.painter.canvasCopy(),n=this.painter.getCanvasCopiesAndTimestamps();n.timeStamps.push(performance.now());const s=this.painter.context.gl,p=s.createFramebuffer();function _(y){s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.TEXTURE_2D,y,0);const w=new Uint8Array(s.drawingBufferWidth*s.drawingBufferHeight*4);return s.readPixels(0,0,s.drawingBufferWidth,s.drawingBufferHeight,s.RGBA,s.UNSIGNED_BYTE,w),w}return s.bindFramebuffer(s.FRAMEBUFFER,p),this._canvasPixelComparison(_(f),n.canvasCopies.map(_),n.timeStamps)}_canvasPixelComparison(f,n,s){let p=s[1]-s[0];const _=f.length/4;for(let y=0;y<n.length;y++){const w=n[y];let P=0;for(let z=0;z<w.length;z+=4)w[z]===f[z]&&w[z+1]===f[z+1]&&w[z+2]===f[z+2]&&w[z+3]===f[z+3]&&(P+=1);p+=(s[y+2]-s[y+1])*(1-P/_)}return p}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const f=this.painter.context.gl.getExtension("WEBGL_lose_context");f&&f.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Lr.delete(this.painter.context.gl),yr.remove(),Pt.remove(),this._removed=!0,this.fire(new i.z("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(f){this._renderNextFrame=this._renderNextFrame||f,this.style&&!this._frame&&(this._frame=i.q.frame(n=>{const s=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,s&&this._render(n)}))}_preloadTiles(f){const n=this.style?this.style.getSourceCaches():[];return i.bk(n,(s,p)=>s._preloadTiles(f,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(f){this._trackResize&&this.resize({originalEvent:f})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(f){this._showParseStatus!==f&&(this._showParseStatus=f,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(f){this._showTerrainWireframe!==f&&(this._showTerrainWireframe=f,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(f){this._showLayers2DWireframe!==f&&(this._showLayers2DWireframe=f,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(f){this._showLayers3DWireframe!==f&&(this._showLayers3DWireframe=f,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(f){this._speedIndexTiming!==f&&(this._speedIndexTiming=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,this._tp.refreshUI(),f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(f){this._showTileAABBs!==f&&(this._showTileAABBs=f,this._tp.refreshUI(),f&&this._update())}_setCacheLimits(f,n){i.dG(f,n)}get version(){return L}},NavigationControl:class{constructor(f={}){this.options=i.l({},rn,f),this._container=ue("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(i.aO(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",n=>{this._map&&this._map.zoomIn({},{originalEvent:n})}),ue("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",n=>{this._map&&this._map.zoomOut({},{originalEvent:n})}),ue("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(i.aO(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",n=>{const s=this._map;s&&(this.options.visualizePitch?s.resetNorthPitch({},{originalEvent:n}):s.resetNorth({},{originalEvent:n}))}),this._compassIcon=ue("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const f=this._map;if(!f)return;const n=f.getZoom(),s=n===f.getMaxZoom(),p=n===f.getMinZoom();this._zoomInButton.disabled=s,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",s.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const f=this._map;if(!f)return;const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(f.transform.pitch*(Math.PI/180)),.5)}) rotateX(${f.transform.pitch}deg) rotateZ(${f.transform.angle*(180/Math.PI)}deg)`:`rotate(${f.transform.angle*(180/Math.PI)}deg)`;f._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=n)})}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),f.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&f.on("pitch",this._rotateCompassArrow),f.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Pl(f,this._compass,this.options.visualizePitch)),this._container}onRemove(){const f=this._map;f&&(this._container.remove(),this.options.showZoom&&f.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&f.off("pitch",this._rotateCompassArrow),f.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(f,n){const s=ue("button",f,this._container);return s.type="button",s.addEventListener("click",n),s}_setButtonTitle(f,n){if(!this._map)return;const s=this._map._getUIString(`NavigationControl.${n}`);f.setAttribute("aria-label",s),f.firstElementChild&&f.firstElementChild.setAttribute("title",s)}},GeolocateControl:class extends i.E{constructor(f={}){super();const n=navigator.geolocation;this.options=i.l({geolocation:n},Al,f),i.aO(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=tf(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(f){return this._map=f,this._container=ue("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(f){const n=(s=!!this.options.geolocation)=>{this._supportsGeolocation=s,f(s)};this._supportsGeolocation!==void 0?f(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(s=>n(s.state!=="denied")).catch(()=>n()):n()}_isOutOfMapMaxBounds(f){const n=this._map.getMaxBounds(),s=f.coords;return!!n&&(s.longitude<n.getWest()||s.longitude>n.getEast()||s.latitude<n.getSouth()||s.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(f){if(this._map){if(this._isOutOfMapMaxBounds(f))return this._setErrorState(),this.fire(new i.z("outofmaxbounds",f)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=f,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(f),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(f),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("geolocate",f)),this._finish()}}_updateCamera(f){const n=new i.bN(f.coords.longitude,f.coords.latitude),s=f.coords.accuracy,p=this._map.getBearing(),_=i.l({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(s),_,{geolocateSource:!0})}_updateMarker(f){if(f){const n=new i.bN(f.coords.longitude,f.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=f.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const f=this._map.transform,n=i.bG(1,f._center.lat)*f.worldSize,s=Math.ceil(2*this._accuracy*n);this._circleElement.style.width=`${s}px`,this._circleElement.style.height=`${s}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(f){if(this._map){if(this.options.trackUserLocation)if(f.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(f.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new i.z("error",f)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(f){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=ue("button","mapboxgl-ctrl-geolocate",this._container),ue("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",f===!1){i.w("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=ue("div","mapboxgl-user-location"),this._dotElement.appendChild(ue("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(ue("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Sh({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=ue("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Sh({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||this._watchState!=="ACTIVE_LOCK"||n.originalEvent&&n.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new i.z("trackuserlocationend")))})}}_onDeviceOrientation(f){this._userLocationDotMarker&&(f.webkitCompassHeading?this._heading=f.webkitCompassHeading:f.absolute===!0&&(this._heading=-1*f.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return i.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new i.z("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new i.z("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new i.z("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(f={maximumAge:6e5,timeout:0},this._noTimeout=!0):(f=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,f),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const f=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(n=>{n==="granted"&&f()}).catch(console.error):f()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Am,ScaleControl:class{constructor(f={}){this.options=i.l({},Hs,f),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),i.aO(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const f=this.options.maxWidth||100,n=this._map,s=n._containerHeight/2,p=n._containerWidth/2-f/2,_=n.unproject([p,s]),y=n.unproject([p+f,s]),w=_.distanceTo(y);if(this.options.unit==="imperial"){const P=3.2808*w;P>5280?this._setScale(f,P/5280,"mile"):this._setScale(f,P,"foot")}else this.options.unit==="nautical"?this._setScale(f,w/1852,"nautical-mile"):w>=1e3?this._setScale(f,w/1e3,"kilometer"):this._setScale(f,w,"meter")}_setScale(f,n,s){this._map._requestDomTask(()=>{const p=function(y){const w=Math.pow(10,`${Math.floor(y)}`.length-1);let P=y/w;return P=P>=10?10:P>=5?5:P>=3?3:P>=2?2:P>=1?1:function(z){const k=Math.pow(10,Math.ceil(-Math.log(z)/Math.LN10));return Math.round(z*k)/k}(P),w*P}(n),_=p/n;this._container.innerHTML=this._isNumberFormatSupported&&s!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:s}).format(p):`${p}&nbsp;${wo[s]}`,this._container.style.width=f*_+"px"})}onAdd(f){return this._map=f,this._language=f.getLanguage(),this._container=ue("div","mapboxgl-ctrl mapboxgl-ctrl-scale",f.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(f){this._language=f,this._update()}setUnit(f){this.options.unit=f,this._update()}},FullscreenControl:class{constructor(f={}){this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:i.w("Full screen control 'container' must be a DOM element.")),i.aO(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=ue("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",i.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const f=this._fullscreenButton=ue("button","mapboxgl-ctrl-fullscreen",this._controlContainer);ue("span","mapboxgl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",f)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends i.E{constructor(f){super(),this.options=i.l(Object.create(ta),f),i.aO(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(f&&f.className?f.className.trim().split(/\s+/):[])}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&f.on("preclick",this._onClose),this.options.closeOnMove&&f.on("move",this._onClose),f.on("remove",this.remove),this._update(),f._addPopup(this),this._focusFirstElement(),this._trackPointer?(f.on("mousemove",this._onMouseEvent),f.on("mouseup",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")):f.on("move",this._update),this.fire(new i.z("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const f=this._map;return f&&(f.off("move",this._update),f.off("move",this._onClose),f.off("preclick",this._onClose),f.off("click",this._onClose),f.off("remove",this.remove),f.off("mousemove",this._onMouseEvent),f.off("mouseup",this._onMouseEvent),f.off("drag",this._onMouseEvent),f._canvasContainer&&f._canvasContainer.classList.remove("mapboxgl-track-pointer"),f._removePopup(this),this._map=void 0),this.fire(new i.z("close")),this}getLngLat(){return this._lngLat}setLngLat(f){this._lngLat=i.bN.convert(f),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const f=this._map;return f&&(f.off("move",this._update),f.on("mousemove",this._onMouseEvent),f.on("drag",this._onMouseEvent),f._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const n=document.createDocumentFragment(),s=document.createElement("body");let p;for(s.innerHTML=f;p=s.firstChild,p;)n.appendChild(p);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){let n=this._content;if(n)for(;n.hasChildNodes();)n.firstChild&&n.removeChild(n.firstChild);else n=this._content=ue("div","mapboxgl-popup-content",this._container||void 0);if(n.appendChild(f),this.options.closeButton){const s=this._closeButton=ue("button","mapboxgl-popup-close-button",n);s.type="button",s.setAttribute("aria-label","Close popup"),s.setAttribute("aria-hidden","true"),s.innerHTML="&#215;",s.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(f){return this._classList.add(f),this._updateClassList(),this}removeClassName(f){return this._classList.delete(f),this._updateClassList(),this}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){let n;return this._classList.delete(f)?n=!1:(this._classList.add(f),n=!0),this._updateClassList(),n}_onMouseEvent(f){this._update(f.point)}_getAnchor(f){if(this.options.anchor)return this.options.anchor;const n=this._map,s=this._container,p=this._pos;if(!n||!s||!p)return"bottom";const _=s.offsetWidth,y=s.offsetHeight,w=p.x<_/2,P=p.x>n.transform.width-_/2;if(p.y+f<y)return w?"top-left":P?"top-right":"top";if(p.y>n.transform.height-y){if(w)return"bottom-left";if(P)return"bottom-right"}return w?"left":P?"right":"bottom"}_updateClassList(){const f=this._container;if(!f)return;const n=[...this._classList];n.push("mapboxgl-popup"),this._anchor&&n.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&n.push("mapboxgl-popup-track-pointer"),f.className=n.join(" ")}_update(f){const n=this._map,s=this._content;if(!n||!this._lngLat&&!this._trackPointer||!s)return;let p=this._container;if(p||(p=this._container=ue("div","mapboxgl-popup",n.getContainer()),this._tip=ue("div","mapboxgl-popup-tip",p),p.appendChild(s)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Z0(this._lngLat,this._pos,n.transform)),!this._trackPointer||f){const _=this._pos=this._trackPointer&&f instanceof i.P?f:n.project(this._lngLat),y=km(this.options.offset),w=this._anchor=this._getAnchor(y.y),P=km(this.options.offset,w),z=_.add(P).round();n._requestDomTask(()=>{this._container&&w&&(this._container.style.transform=`${Lm[w]} translate(${z.x}px,${z.y}px)`)})}if(!this._marker&&n._showingGlobe()){const _=i.dH(n.transform,this._lngLat)?0:1;this._setOpacity(_)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Zi);f&&f.focus()}_onClose(){this.remove()}_setOpacity(f){this._container&&(this._container.style.opacity=`${f}`),this._content&&(this._content.style.pointerEvents=f?"auto":"none")}},Marker:Sh,Style:Oa,LngLat:i.bN,LngLatBounds:i.ay,Point:i.P,MercatorCoordinate:i.a9,FreeCameraOptions:kc,Evented:i.E,config:i.e,prewarm:i.dM,clearPrewarmedResources:i.dN,get accessToken(){return i.e.ACCESS_TOKEN},set accessToken(f){i.e.ACCESS_TOKEN=f},get baseApiUrl(){return i.e.API_URL},set baseApiUrl(f){i.e.API_URL=f},get workerCount(){return i.dO.workerCount},set workerCount(f){i.dO.workerCount=f},get maxParallelImageRequests(){return i.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(f){i.e.MAX_PARALLEL_IMAGE_REQUESTS=f},clearStorage(f){i.dP(f)},get workerUrl(){return i.dQ.workerUrl},set workerUrl(f){i.dQ.workerUrl=f},get workerClass(){return i.dQ.workerClass},set workerClass(f){i.dQ.workerClass=f},get workerParams(){return i.dQ.workerParams},set workerParams(f){i.dQ.workerParams=f},get dracoUrl(){return i.dR()},set dracoUrl(f){i.dS(f)},get meshoptUrl(){return i.dT()},set meshoptUrl(f){i.dU(f)},setNow:i.q.setNow,restoreNow:i.q.restoreNow}});var T=d;return T})})(fk);var v3=fk.exports;const Xh=P_(v3);var vY=Object.defineProperty,xY=(e,r,a)=>r in e?vY(e,r,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[r]=a,bY=(e,r,a)=>(xY(e,typeof r!="symbol"?r+"":r,a),a);let wY=class extends Xh.Map{constructor(r){super(r),bY(this,"_groupLayers",new Map)}getGroupLayer(r){return this._groupLayers.get(r)}addGroupLayer(r,a){if(this.getGroupLayer(r))throw new Error(`The groupLayer '${r}' has already existed.`);const{sources:c={},layers:d=[],bounds:x,fitBoundsOptions:T={padding:{top:20,bottom:20,left:20,right:20}},flyToOptions:i}=a;for(const L in c)Object.prototype.hasOwnProperty.call(c,L)&&(this.getSource(L)?console.warn(`The source '${L}' has already existed.`):this.addSource(L,c[L]));for(const L of d){if(this.getLayer(L.id))throw new Error(`The layer '${L.id}' has already existed.`);{const N=L.metadata||{},U=N.before?this._getBeforeLayerId(L.id,N.before):void 0;L.metadata={...N,grouplayer:r},this.addLayer(L,U),this._setLayerCursor(L)}}return x?this.fitBounds(x,T):i&&this.flyTo(i),this._groupLayers.set(r,a),this}removeGroupLayer(r,a=!0){const c=this.getGroupLayer(r);if(c){const{sources:d={},layers:x=[]}=c;for(const T of x){const i=T.id;this.getLayer(i)&&this.removeLayer(i),T.source&&typeof T.source=="object"&&a&&this.getSource(i)&&this.removeSource(i)}a&&Object.keys(d).map(T=>{this.getSource(T)&&this.removeSource(T)}),this._groupLayers.delete(r)}return this}removeGroupLayers(r=!0){return this._groupLayers.forEach((a,c)=>{this.removeGroupLayer(c,r)}),this}setBasemapStyle(r,a=!0,c){this.setStyle(r,c);const d=a?new Map(this._groupLayers):void 0;this._groupLayers.clear(),d&&this.once("styledata",()=>{d.forEach((x,T)=>{this.addGroupLayer(T,x)})})}_getBeforeLayerIdByString(r){const a=this.getGroupLayer(r);return a&&a.layers.length>0?a.layers[0].id:this.getLayer(r)?r:void 0}_getBeforeLayerId(r,a){let c;if(typeof a=="string")c=this._getBeforeLayerIdByString(a);else if(Array.isArray(a)){for(const d of a)if(c=this._getBeforeLayerIdByString(d),c)break}return c||console.warn(`Layer with id "${a}" does not exist on this map. The layer with id "${r}" will be appended to the end of the layers array and appear visually above all other layers.`),c}_setLayerCursor(r){const a=r.metadata||{},c=r.id;a&&a.cursor&&(this.on("mouseenter",c,()=>{this.getCanvas().style.cursor=a.cursor}),this.on("mouseleave",c,()=>{this.getCanvas().style.cursor=""}))}};const tA=e=>{let r;const a=new Set,c=(U,q)=>{const X=typeof U=="function"?U(r):U;if(!Object.is(X,r)){const se=r;r=q??(typeof X!="object"||X===null)?X:Object.assign({},r,X),a.forEach(ce=>ce(r,se))}},d=()=>r,L={setState:c,getState:d,getInitialState:()=>N,subscribe:U=>(a.add(U),()=>a.delete(U)),destroy:()=>{a.clear()}},N=r=e(c,d,L);return L},SY=e=>e?tA(e):tA;var mk={exports:{}},gk={},_k={exports:{}},yk={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Cp=$;function EY(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var TY=typeof Object.is=="function"?Object.is:EY,CY=Cp.useState,MY=Cp.useEffect,IY=Cp.useLayoutEffect,PY=Cp.useDebugValue;function AY(e,r){var a=r(),c=CY({inst:{value:a,getSnapshot:r}}),d=c[0].inst,x=c[1];return IY(function(){d.value=a,d.getSnapshot=r,C2(d)&&x({inst:d})},[e,a,r]),MY(function(){return C2(d)&&x({inst:d}),e(function(){C2(d)&&x({inst:d})})},[e]),PY(a),a}function C2(e){var r=e.getSnapshot;e=e.value;try{var a=r();return!TY(e,a)}catch{return!0}}function RY(e,r){return r()}var zY=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?RY:AY;yk.useSyncExternalStore=Cp.useSyncExternalStore!==void 0?Cp.useSyncExternalStore:zY;_k.exports=yk;var LY=_k.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Sx=$,kY=LY;function DY(e,r){return e===r&&(e!==0||1/e===1/r)||e!==e&&r!==r}var OY=typeof Object.is=="function"?Object.is:DY,FY=kY.useSyncExternalStore,BY=Sx.useRef,NY=Sx.useEffect,jY=Sx.useMemo,$Y=Sx.useDebugValue;gk.useSyncExternalStoreWithSelector=function(e,r,a,c,d){var x=BY(null);if(x.current===null){var T={hasValue:!1,value:null};x.current=T}else T=x.current;x=jY(function(){function L(se){if(!N){if(N=!0,U=se,se=c(se),d!==void 0&&T.hasValue){var ce=T.value;if(d(ce,se))return q=ce}return q=se}if(ce=q,OY(U,se))return ce;var ue=c(se);return d!==void 0&&d(ce,ue)?ce:(U=se,q=ue)}var N=!1,U,q,X=a===void 0?null:a;return[function(){return L(r())},X===null?void 0:function(){return L(X())}]},[r,a,c,d]);var i=FY(e,x[0],x[1]);return NY(function(){T.hasValue=!0,T.value=i},[i]),$Y(i),i};mk.exports=gk;var VY=mk.exports;const UY=P_(VY),{useDebugValue:GY}=sn,{useSyncExternalStoreWithSelector:HY}=UY;const WY=e=>e;function qY(e,r=WY,a){const c=HY(e.subscribe,e.getState,e.getServerState||e.getInitialState,r,a);return GY(c),c}const rA=e=>{const r=typeof e=="function"?SY(e):e,a=(c,d)=>qY(r,c,d);return Object.assign(a,r),a},ZY=e=>e?rA(e):rA,Np=ZY()((e,r)=>({map:void 0,setMap:a=>e({map:a}),removeMap:()=>{e({map:void 0})},addGroupLayer(a,c){const d=r().map;d&&d.addGroupLayer(a,c)},removeGroupLayer(a,c){const d=r().map;d&&d.removeGroupLayer(a,c)},removeGroupLayers(){const a=r().map;a&&a.removeGroupLayers()},getSource(a){const c=r().map;if(c)return c.getSource(a)},addSource(a,c){const d=r().map;d&&d.addSource(a,c)},removeSource(a){const c=r().map;c&&c.removeSource(a)},getLayer(a){const c=r().map;if(c)return c.getLayer(a)},addLayer(a,c){const d=r().map;d&&d.addLayer(a,c)},removeLayer(a){const c=r().map;c&&c.removeLayer(a)},setBasemapStyle(a,c,d){const x=r().map;x&&x.setBasemapStyle(a,c,d)},clear:a=>{const c=r().map;if(c&&c.getStyle())if(Array.isArray(a))for(let d=0,x=a.length;d<x;d++){const T=a[d];c.removeGroupLayer(T),c.getLayer(T)&&c.removeLayer(T),c.getSource(T)&&c.removeSource(T)}else{if(a.groupLayerIds)for(let d=0,x=a.groupLayerIds.length;d<x;d++)c.removeGroupLayer(a.groupLayerIds[d]);if(a.layerIds)for(let d=0,x=a.layerIds.length;d<x;d++)c.removeLayer(a.layerIds[d]);if(a.sourceIds)for(let d=0,x=a.sourceIds.length;d<x;d++)c.removeSource(a.sourceIds[d])}}})),XY=e=>{const{setMap:r,removeMap:a}=Np(),c=$.useRef(null),[d]=$.useState(Math.random().toString(16).substring(2));Xh.accessToken="pk.eyJ1IjoiaHVhbmdsaWkiLCJhIjoiY2wwM2E4a2drMDVrZjNrcGRucHIxOHo0cyJ9.0ecG5KGQE6R-SmhxvLvhHg";const T=Object.assign({},{style:"./data/standard-beta.json",container:d,center:[106.576247,29.56087],zoom:9,attributionControl:!1,locale:{"NavigationControl.ResetBearing":"指北","NavigationControl.ZoomIn":"放大","NavigationControl.ZoomOut":"缩小","GeolocateControl.FindMyLocation":"定位","GeolocateControl.LocationNotAvailable":"定位不可用"}},e.mapboxOptions);return $.useEffect(()=>{const i=new wY(T);return i.addControl(new v3.NavigationControl({visualizePitch:!0})),i.addControl(new v3.GeolocateControl({trackUserLocation:!0,showUserHeading:!0})),i.addControl(new Xh.AttributionControl({customAttribution:`v${Xh.version}`})),i.loadImage("./i-marker.png",(L,N)=>{if(L)throw L;N&&!i.hasImage("marker")&&i.addImage("marker",N,{sdf:!0})}),i.loadImage("./i-arrow.png",(L,N)=>{if(L)throw L;N&&!i.hasImage("arrow")&&i.addImage("arrow",N,{sdf:!0})}),i.on("load",()=>{if(r(i),e.onMapLoaded&&e.onMapLoaded(i),e.sprites)for(const L in e.sprites){const N=e.sprites[L];i.loadImage(N,(U,q)=>{if(U)throw U;q&&!i.hasImage(L)&&i.addImage(L,q)})}}),i.on("remove",()=>{a()}),()=>i.remove()},[]),Wt.jsx("div",{id:d,className:e.className,style:{width:"100%",height:"100%"},ref:c})},YY=()=>Wt.jsx("aside",{className:"w-28 p-2","aria-label":"Sidebar",children:Wt.jsx("div",{className:"overflow-y-auto p-2 rounded bg-gray-800",children:Wt.jsx("div",{className:"sidebar-menu space-y-1",children:wk.map((e,r)=>Wt.jsx(pY,{to:e.path,children:e.name},r))})})});const KY=()=>Wt.jsx("div",{className:"bg-gray-900 h-[100vh] flex flex-col",children:Wt.jsxs("div",{className:"flex flex-auto",children:[Wt.jsx(YY,{}),Wt.jsxs("div",{className:"flex-1 relative",children:[Wt.jsx(XY,{}),Wt.jsx(WX,{})]})]})}),JY=Wt.jsx(FE,{style:{fontSize:24},spin:!0}),lT=e=>{const{map:r}=Np();return Wt.jsx("div",{className:`widget bg-gray-800 bg-opacity-50 ${e.className}`,children:Wt.jsx(Mq,{spinning:!r,indicator:JY,children:e.children})})},QY=Object.prototype.hasOwnProperty,kh=typeof Symbol<"u"?Symbol.toStringTag:void 0;function eK(e){if(e===null)return e===void 0?"[object Undefined]":"[object Null]";if(!(kh&&kh in Object(e)))return toString.call(e);const r=QY.call(e,kh),a=e[kh];let c=!1;try{e[kh]=void 0,c=!0}catch{}const d=Object.prototype.toString.call(e);return c&&(r?e[kh]=a:delete e[kh]),d}function Pg(e){if(!rK(e))return!1;const r=eK(e);return r==="[object Function]"||r==="[object AsyncFunction]"||r==="[object GeneratorFunction]"||r==="[object Proxy]"}function tK(e){return e===null?!1:typeof e=="string"||e.constructor!==null&&e.constructor===String}function rK(e){const r=typeof e;return e!==null&&(r==="object"||r==="function")}function nK(e){return Object.prototype.toString.call(e)==="[object Number]"&&!isNaN(e)}function iK(e,r){console.warn(`${r||"wind-layer"}: ${e}`)}const nA={};function oK(e,r){nA[r]||(iK(r,e),nA[r]=!0)}function aK(e,r){return e-r*Math.floor(e/r)}function Dl(e){return e!=null&&!isNaN(e)}function sK(e,r={}){let a,c;if(console.time("format-data"),e.forEach(function(T){switch(T.header.parameterCategory+","+T.header.parameterNumber){case"1,2":case"2,2":a=T;break;case"1,3":case"2,3":c=T;break}}),!c||!a)return;const d=a.header,x=new vk({xmin:d.lo1,ymin:d.la1,xmax:d.lo2,ymax:d.la2,deltaX:d.dx,deltaY:d.dy,cols:d.nx,rows:d.ny,us:a.data,vs:c.data,...r});return console.timeEnd("format-data"),x}class iA{constructor(r,a){wn(this,"u");wn(this,"v");wn(this,"m");this.u=r,this.v=a,this.m=this.magnitude()}magnitude(){return Math.sqrt(this.u**2+this.v**2)}directionTo(){let a=Math.atan2(this.u,this.v)*(180/Math.PI);return a<0&&(a+=360),a}directionFrom(){return(this.directionTo()+180)%360}}class vk{constructor(r){wn(this,"xmin");wn(this,"xmax");wn(this,"ymin");wn(this,"ymax");wn(this,"cols");wn(this,"rows");wn(this,"us");wn(this,"vs");wn(this,"isContinuous");wn(this,"deltaY");wn(this,"deltaX");wn(this,"translateX");wn(this,"isFields");wn(this,"flipY");wn(this,"grid");wn(this,"range");wn(this,"wrapX");this.grid=[],this.xmin=r.xmin,this.xmax=r.xmax,this.ymin=r.ymin,this.ymax=r.ymax,this.cols=r.cols,this.rows=r.rows,this.us=r.us,this.vs=r.vs,this.deltaX=r.deltaX,this.deltaY=r.deltaY,this.flipY=!!r.flipY,this.ymin=Math.min(r.ymax,r.ymin),this.ymax=Math.max(r.ymax,r.ymin),this.deltaY<0&&this.ymin<this.ymax||(r.flipY===void 0&&(this.flipY=!0),console.warn("[wind-core]: The data is flipY")),this.isFields=!0;const a=Math.ceil((this.xmax-this.xmin)/r.deltaX),c=Math.ceil((this.ymax-this.ymin)/r.deltaY);(a!==this.cols||c!==this.rows)&&console.warn("[wind-core]: The data grid not equal"),this.isContinuous=Math.floor(this.cols*r.deltaX)>=360,this.translateX="translateX"in r?r.translateX:this.xmax>180,"wrappedX"in r&&oK("[wind-core]: ","`wrappedX` namespace will deprecated please use `translateX` instead！"),this.wrapX=!!r.wrapX,this.grid=this.buildGrid(),this.range=this.calculateRange()}buildGrid(){const r=[];let a=0;const{rows:c,cols:d,us:x,vs:T}=this;for(let i=0;i<c;i++){const L=[];for(let N=0;N<d;N++,a++){const U=x[a],q=T[a],X=this.isValid(U)&&this.isValid(q);L[N]=X?new iA(U,q):null}this.isContinuous&&L.push(L[0]),r[i]=L}return r}release(){this.grid=[]}extent(){return[this.xmin,this.ymin,this.xmax,this.ymax]}bilinearInterpolateVector(r,a,c,d,x,T){const i=1-r,L=1-a,N=i*L,U=r*L,q=i*a,X=r*a,se=c.u*N+d.u*U+x.u*q+T.u*X,ce=c.v*N+d.v*U+x.v*q+T.v*X;return new iA(se,ce)}calculateRange(){if(!this.grid||!this.grid[0])return;const r=this.grid.length,a=this.grid[0].length;let c,d;for(let x=0;x<r;x++)for(let T=0;T<a;T++){const i=this.grid[x][T];if(i!==null){const L=i.m||i.magnitude();c===void 0?c=L:d===void 0?(d=L,c=Math.min(c,d),d=Math.max(c,d)):(c=Math.min(L,c),d=Math.max(L,d))}}return[c,d]}isValid(r){return r!=null}getWrappedLongitudes(){let r=this.xmin,a=this.xmax;return this.translateX&&(this.isContinuous?(r=-180,a=180):(a=this.xmax-360,r=this.xmin-360)),[r,a]}contains(r,a){const[c,d]=this.getWrappedLongitudes();d>180&&r>=-180&&r<=d-360?r+=360:c<-180&&r<=180&&r>=c+360&&(r-=360);const x=r>=c&&r<=d;let T;return this.deltaY>=0?T=a>=this.ymin&&a<=this.ymax:T=a>=this.ymax&&a<=this.ymin,x&&T}getDecimalIndexes(r,a){const c=aK(r-this.xmin,360)/this.deltaX;if(this.flipY){const d=(this.ymax-a)/this.deltaY;return[c,d]}else{const d=(this.ymin+a)/this.deltaY;return[c,d]}}valueAt(r,a){let c=!1;if((this.wrapX||this.contains(r,a))&&(c=!0),!c)return null;const d=this.getDecimalIndexes(r,a),x=Math.floor(d[0]),T=Math.floor(d[1]),i=this.clampColumnIndex(x),L=this.clampRowIndex(T);return this.valueAtIndexes(i,L)}interpolatedValueAt(r,a){let c=!1;if((this.wrapX&&a>=this.ymin&&a<=this.ymax||this.contains(r,a))&&(c=!0),!c)return null;const[d,x]=this.getDecimalIndexes(r,a);return this.interpolatePoint(d,x)}hasValueAt(r,a){return this.valueAt(r,a)!==null}interpolatePoint(r,a){const c=this.getFourSurroundingIndexes(r,a),[d,x,T,i]=c,L=this.getFourSurroundingValues(d,x,T,i);if(L){const[N,U,q,X]=L;return this.bilinearInterpolateVector(r-d,a-T,N,U,q,X)}return null}clampColumnIndex(r){let a=r;r<0&&(a=0);const c=this.cols-1;return r>c&&(a=c),a}clampRowIndex(r){let a=r;r<0&&(a=0);const c=this.rows-1;return r>c&&(a=c),a}getFourSurroundingIndexes(r,a){const c=Math.floor(r);let d=c+1;this.isContinuous&&d>=this.cols&&(d=0),d=this.clampColumnIndex(d);const x=this.clampRowIndex(Math.floor(a)),T=this.clampRowIndex(x+1);return[c,d,x,T]}getFourSurroundingValues(r,a,c,d){let x;if(x=this.grid[c]){const T=x[r],i=x[a];if(this.isValid(T)&&this.isValid(i)&&(x=this.grid[d])){const L=x[r],N=x[a];if(this.isValid(L)&&this.isValid(N))return[T,i,L,N]}}return null}valueAtIndexes(r,a){return this.grid[a][r]}lonLatAtIndexes(r,a){const c=this.longitudeAtX(r),d=this.latitudeAtY(a);return[c,d]}longitudeAtX(r){const a=this.deltaX/2;let c=this.xmin+a+r*this.deltaX;return this.translateX&&(c=c>180?c-360:c),c}latitudeAtY(r){const a=this.deltaY/2;return this.ymax-a-r*this.deltaY}randomize(r={},a,c,d){const x=Math.random()*(a||this.cols)|0,T=Math.random()*(c||this.rows)|0,i=d([x,T]);return i!==null?(r.x=i[0],r.y=i[1]):(r.x=this.longitudeAtX(x),r.y=this.latitudeAtY(T)),r}checkFields(){return this.isFields}}const xk={globalAlpha:.9,lineWidth:2,colorScale:["rgba(0, 213, 255, 1)","rgba(102, 255, 154, 1)","rgba(19, 255, 37, 1)","rgba(127, 255, 0, 1)","rgba(205, 255, 0, 1)","rgba(255, 255, 0, 1)","rgba(232, 213, 5, 1)","rgba(232, 147, 5, 1)","rgba(232, 95, 5, 1)","rgba(200, 32, 12, 1)","rgba(165, 0, 1, 1)"],velocityScale:1e-5,maxAge:90,paths:1500,frameRate:20,useCoordsDraw:!0};function oA(e,r,a,c){return Math.max(0,Math.min(c.length-1,Math.round((e-r)/(a-r)*(c.length-1))))}class bk{constructor(r,a,c){wn(this,"forceStop",!1);wn(this,"ctx");wn(this,"options");wn(this,"field");wn(this,"particles",[]);wn(this,"animationLoop");wn(this,"then",Date.now());wn(this,"generated",!1);wn(this,"starting",!1);if(this.ctx=r,!this.ctx)throw new Error("ctx error");this.animate=this.animate.bind(this),this.setOptions(a),c&&this.updateData(c)}setOptions(r){this.options={...xk,...r};const{width:a,height:c}=this.ctx.canvas;r.particleAge&&!("maxAge"in r)&&(this.options.maxAge=r.particleAge),r.particleMultiplier&&!("paths"in r)&&(this.options.paths=Math.round(a*c*r.particleMultiplier)),this.prerender()}getOptions(){return this.options}updateData(r){this.field=r,this.generated&&(this.particles=this.prepareParticlePaths())}project(r){throw new Error("not implemented")}unproject(r){throw new Error("not implemented")}intersectsCoordinate(r){throw new Error("not implemented")}clearCanvas(){this.stop(),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.forceStop=!1}isStop(){return!this.starting}start(){this.starting=!0,this.forceStop=!1,this.then=Date.now(),this.animate()}stop(){this.animationLoop&&cancelAnimationFrame(this.animationLoop),this.starting=!1,this.forceStop=!0}animate(){this.animationLoop&&cancelAnimationFrame(this.animationLoop),this.animationLoop=requestAnimationFrame(this.animate);const r=Date.now(),a=r-this.then;a>this.options.frameRate&&(this.then=r-a%this.options.frameRate,this.render())}prerender(){this.generated=!1,this.field&&(this.particles=this.prepareParticlePaths(),this.generated=!0,!this.starting&&!this.forceStop&&(this.starting=!0,this.then=Date.now(),this.animate()))}render(){this.moveParticles(),this.drawParticles(),this.postrender()}postrender(){}moveParticles(){if(!this.field)return;const{width:r,height:a}=this.ctx.canvas,c=this.particles,d=this.options.maxAge,x=Pg(this.options.velocityScale)?this.options.velocityScale():this.options.velocityScale;let T=0;const i=c.length;for(;T<i;T++){const L=c[T];L.age>d&&(L.age=0,this.field.randomize(L,r,a,this.unproject));const N=L.x,U=L.y,q=this.field.interpolatedValueAt(N,U);if(q===null)L.age=d;else{const X=N+q.u*x,se=U+q.v*x;this.field.hasValueAt(X,se)?(L.xt=X,L.yt=se,L.m=q.m):(L.x=X,L.y=se,L.age=d)}L.age++}}fadeIn(){const r=this.ctx.globalCompositeOperation;this.ctx.globalCompositeOperation="destination-in",this.ctx.fillRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.globalCompositeOperation=r}drawParticles(){const r=this.particles;this.fadeIn(),this.ctx.globalAlpha=this.options.globalAlpha,this.ctx.fillStyle=`rgba(0, 0, 0, ${this.options.globalAlpha})`,this.ctx.lineWidth=nK(this.options.lineWidth)?this.options.lineWidth:1,this.ctx.strokeStyle=tK(this.options.colorScale)?this.options.colorScale:"#fff";let a=0;const c=r.length;if(this.field&&c>0){let d,x;for(Dl(this.options.minVelocity)&&Dl(this.options.maxVelocity)?(d=this.options.minVelocity,x=this.options.maxVelocity):[d,x]=this.field.range;a<c;a++)this[this.options.useCoordsDraw?"drawCoordsParticle":"drawPixelParticle"](r[a],d,x)}}drawPixelParticle(r,a,c){const d=[r.x,r.y],x=[r.xt,r.yt];if(x&&d&&Dl(x[0])&&Dl(x[1])&&Dl(d[0])&&Dl(d[1])&&r.age<=this.options.maxAge){if(this.ctx.beginPath(),this.ctx.moveTo(d[0],d[1]),this.ctx.lineTo(x[0],x[1]),Pg(this.options.colorScale))this.ctx.strokeStyle=this.options.colorScale(r.m);else if(Array.isArray(this.options.colorScale)){const T=oA(r.m,a,c,this.options.colorScale);this.ctx.strokeStyle=this.options.colorScale[T]}Pg(this.options.lineWidth)&&(this.ctx.lineWidth=this.options.lineWidth(r.m)),r.x=r.xt,r.y=r.yt,this.ctx.stroke()}}drawCoordsParticle(r,a,c){const d=[r.x,r.y],x=[r.xt,r.yt];if(x&&d&&Dl(x[0])&&Dl(x[1])&&Dl(d[0])&&Dl(d[1])&&this.intersectsCoordinate(x)&&r.age<=this.options.maxAge){const T=this.project(d),i=this.project(x);if(T&&i){if(this.ctx.beginPath(),this.ctx.moveTo(T[0],T[1]),this.ctx.lineTo(i[0],i[1]),r.x=r.xt,r.y=r.yt,Pg(this.options.colorScale))this.ctx.strokeStyle=this.options.colorScale(r.m);else if(Array.isArray(this.options.colorScale)){const L=oA(r.m,a,c,this.options.colorScale);this.ctx.strokeStyle=this.options.colorScale[L]}Pg(this.options.lineWidth)&&(this.ctx.lineWidth=this.options.lineWidth(r.m)),this.ctx.stroke()}}}prepareParticlePaths(){const{width:r,height:a}=this.ctx.canvas,c=typeof this.options.paths=="function"?this.options.paths(this):this.options.paths,d=[];if(!this.field)return[];let x=0;for(;x<c;x++)d.push(this.field.randomize({age:this.randomize()},r,a,this.unproject));return d}randomize(){return Math.floor(Math.random()*this.options.maxAge)}}wn(bk,"Field",vk);const lK={0:.05,1:.05,2:.04,3:.03,4:.02,5:.01,6:.005,7:.003,8:.002,9:.001,10:5e-4,11:3e-4,12:15e-5,13:1e-4,14:5e-5,15:25e-6,16:1e-5,17:5e-6,18:2e-6,19:1e-6,20:5e-7,21:2e-7,22:1e-7},cK={0:2e3,1:1800,2:1600,3:1400,4:1200,5:800,6:600,7:400,8:200,9:180,10:170,11:160,12:150,13:140,14:130,15:120,16:110,17:100,18:90,19:80,20:70,21:60,22:50};function aA(e,r){const a=Math.floor(e);if(r[e])return r[e];if(a>22)return r[22];{const c=e%1,d=r[a],x=r[a+1];return d+(x-d)*c}}class uK{constructor(r,a,c){wn(this,"id");wn(this,"type");wn(this,"renderingMode");wn(this,"map");wn(this,"windOptions");wn(this,"canvas");wn(this,"devicePixelRatio");wn(this,"wind");wn(this,"field");this.id=r,this.type="custom",this.renderingMode="2d",this.map=null,this.windOptions=Object.assign({},xk,c==null?void 0:c.windOptions),this.canvas=null,this.devicePixelRatio=window.devicePixelRatio,this.wind=null,this.field=sK(a,c==null?void 0:c.fieldOptions),this.handleResize=this.handleResize.bind(this),this.handleZoomEnd=this.handleZoomEnd.bind(this)}onAdd(r){this.map=r,this.canvas=this.initializeCanvas(),this.windOptions.velocityScale===999999&&(this.windOptions.velocityScale=()=>{const a=r.getZoom();return aA(a,lK)}),this.windOptions.paths===999999&&(this.windOptions.paths=()=>{const a=r.getZoom();return aA(a,cK)}),this.map.on("zoomend",this.handleZoomEnd),this.map.on("resize",this.handleResize),this.render()}onRemove(){var r,a;this.wind&&this.wind.stop(),this.canvas&&(this.canvas&&this.canvas.parentNode&&this.canvas.parentNode.removeChild(this.canvas),this.canvas=null),(r=this.map)==null||r.off("zoomend",this.handleZoomEnd),(a=this.map)==null||a.off("resize",this.handleResize)}handleZoomEnd(){var r;(r=this.wind)==null||r.prerender()}handleResize(){if(this.map&&this.canvas){const r=this.map.getCanvas(),{width:a,height:c}=this.map.transform,d=this.devicePixelRatio;this.canvas.width=a*d,this.canvas.height=c*d,this.canvas.style.width=r.style.width,this.canvas.style.height=r.style.height}this.render()}stop(){this.wind&&this.wind.clearCanvas()}render(){if(!(!this.map||!this.canvas)&&!this.wind){const r=this.canvas.getContext("2d");if(!r)throw new Error("create canvas context failed");this.wind=new bk(r,this.windOptions,this.field),this.wind.project=this.project.bind(this),this.wind.unproject=this.unproject.bind(this),this.wind.intersectsCoordinate=this.intersectsCoordinate.bind(this),this.wind.postrender=()=>{},this.wind.prerender(),this.wind.render()}}initializeCanvas(){if(!this.map)return null;const r=this.map.getCanvasContainer(),a=this.map.getCanvas(),c=document.createElement("canvas"),{width:d,height:x}=this.map.transform,T=this.devicePixelRatio;return c.width=d*T,c.height=x*T,c.style.position="absolute",c.className="maplibre-overlay-canvas",c.style.width=a.style.width,c.style.height=a.style.height,r.appendChild(c),c}project(r){if(this.map!==void 0){const a=this.map.project(new Xh.LngLat(r[0],r[1])),c=a.x,d=a.y;return[c*this.devicePixelRatio,d*this.devicePixelRatio]}return r}unproject(r){if(this.map){const a=this.map.unproject(new Xh.Point(r[0],r[1]));return[a.lng,a.lat]}return r}intersectsCoordinate(r){if(this.map){const a=this.map.getBounds(),c=this.map.transform.latRange;return c&&(r[1]>c[1]||r[1]<c[0])?!1:a.contains(new Xh.LngLat(r[0],r[1]))}return!1}}const hK={showPlaceLabels:!0,showRoadLabels:!1,showPointOfInterestLabels:!1,showTransitLabels:!1,lightPreset:"night"},dK=()=>{const{map:e,addGroupLayer:r,removeGroupLayer:a,removeGroupLayers:c}=Np();$.useEffect(()=>(e&&(e.setConfigProperty("basemap","lightPreset","night"),e.setConfigProperty("basemap","showRoadLabels",!1),e.setConfigProperty("basemap","showPointOfInterestLabels",!1),e.setConfigProperty("basemap","showTransitLabels",!1),e.flyTo({center:[106.579747,29.56365],zoom:15.4,bearing:-119.4,pitch:67}),e.on("click",X=>{var se;console.log((se=e.getBounds())==null?void 0:se.toArray())}),x()),()=>{c()}),[e]);const d=X=>{const se=Object.keys(X)[0];e==null||e.setConfigProperty("basemap",se,X[se])},x=()=>{const X="building";a(X),r(X,{sources:{building:{type:"vector",tiles:["https://fw.cqzhitian.cn/geoserver/gwc/service/wmts/rest/other:building_footprint_cq/EPSG:900913/EPSG:900913:{z}/{y}/{x}?format=application/vnd.mapbox-vector-tile"],bounds:[106.209511,29.212572,106.821617,29.83123]},point:{type:"vector",url:"mapbox://huanglii.6otli0cq"},line:{type:"vector",url:"mapbox://huanglii.1rmek3pl"},grid:{type:"vector",url:"mapbox://huanglii.30eo9eac"}},layers:[{id:"building",type:"fill-extrusion",metadata:{"mapbox:group":"3d buildings"},source:"building","source-layer":"building_footprint_cq",minzoom:14,layout:{"fill-extrusion-edge-radius":1,visibility:"visible"},paint:{"fill-extrusion-ambient-occlusion-intensity":.15,"fill-extrusion-color":"hsl(23, 100%, 97%)","fill-extrusion-ambient-occlusion-ground-radius":["step",["zoom"],0,17,5],"fill-extrusion-height":["*",["get","floor"],3.3],"fill-extrusion-opacity":["interpolate",["linear"],["zoom"],14,0,15.3,1],"fill-extrusion-flood-light-intensity":["interpolate",["linear"],["measure-light","brightness"],.015,.3,.026,0],"fill-extrusion-vertical-scale":["interpolate",["linear"],["zoom"],14,0,15.3,1],"fill-extrusion-flood-light-wall-radius":["case",[">",["number",["*",["get","floor"],3.3]],200],["/",["number",["*",["get","floor"],3.3]],3],0],"fill-extrusion-flood-light-ground-radius":["step",["number",["*",["get","floor"],3.3]],0,30,["random",30,100,["id"]]],"fill-extrusion-flood-light-color":"hsl(30, 79%, 81%)"}},{id:"grid",type:"fill",source:"grid","source-layer":"la_grid-49kui3",layout:{visibility:"none"},paint:{"fill-emissive-strength":1,"fill-color":"rgba(100, 100, 100, 0.25)","fill-outline-color":"rgba(255, 255, 255, 0.25)"}},{id:"line",type:"line",source:"line","source-layer":"la_line-56zykj",filter:["==",["get","fid"],1],layout:{"line-cap":"round","line-join":"round",visibility:"none"},paint:{"line-emissive-strength":1,"line-width":10,"line-color":"#1890ff","line-opacity":.65}},{id:"line-arrow",type:"symbol",source:"line","source-layer":"la_line-56zykj",filter:["==",["get","fid"],1],layout:{"symbol-placement":"line","symbol-spacing":3,"icon-image":"arrow","icon-size":.4,visibility:"none"},paint:{"icon-color":"#fff","icon-opacity":.5}},{id:"point",type:"symbol",source:"point","source-layer":"la_point-78w37p",layout:{"icon-image":"marker","icon-size":.2,"icon-anchor":"bottom","icon-offset":[0,24],"icon-allow-overlap":!0,"icon-ignore-placement":!0,visibility:"none"},paint:{"icon-color":"#1890ff"}}]})},T=()=>{e==null||e.fitBounds([106.54911,29.54589,106.59044,29.58105],{padding:50,duration:2e3})},i=X=>{e!=null&&e.getLayer("wind-layer")?e.removeLayer("wind-layer"):fetch("/data/wind.json").then(se=>se.json()).then(se=>{const ce=new uK("wind-layer",se,{fieldOptions:{wrapX:!0}});e==null||e.addLayer(ce)})},L=()=>{e&&(T(),e.setLayoutProperty("grid","visibility","visible"),e.setPaintProperty("grid","fill-color","rgba(100, 100, 100, 0.25)"),e.setLayoutProperty("line","visibility","none"),e.setLayoutProperty("line-arrow","visibility","none"),e.setLayoutProperty("point","visibility","none"))},N=()=>{e&&(T(),e.fitBounds([106.54911,29.54589,106.59044,29.58105],{padding:50}),e.setFilter("line",["==",["get","fid"],1]),e.setFilter("line-arrow",["==",["get","fid"],1]),e.setLayoutProperty("line","visibility","visible"),e.setLayoutProperty("line-arrow","visibility","visible"),e.setLayoutProperty("point","visibility","visible"),e.setLayoutProperty("grid","visibility","visible"),e.setPaintProperty("grid","fill-color",["case",["==",["get","route"],!0],"rgba(46, 173, 131, 0.6)","rgba(100, 102, 115, 0.5)"]))},U=()=>{e&&(T(),e.setLayoutProperty("grid","visibility","visible"),e.setLayoutProperty("line","visibility","visible"),e.setLayoutProperty("line-arrow","visibility","visible"),e.setLayoutProperty("point","visibility","visible"),e.setFilter("line",["==",["get","fid"],2]),e.setFilter("line-arrow",["==",["get","fid"],2]),e.setPaintProperty("grid","fill-color",["match",["get","risk"],0,"rgba(17, 172, 125, 0.5)",[1],"rgba(247, 196, 94, 0.5)",[2],"rgba(250, 10, 10, 0.5)","rgba(100, 102, 115, 0.5)"]))},q=()=>{e&&(e.flyTo({center:[106.579747,29.56365],zoom:15.4,bearing:-119.4,pitch:67}),e.setLayoutProperty("grid","visibility","none"),e.setLayoutProperty("line","visibility","none"),e.setLayoutProperty("line-arrow","visibility","none"),e.setLayoutProperty("point","visibility","none"))};return Wt.jsxs(lT,{className:"w-[380px]",children:[Wt.jsxs(To,{initialValues:hK,labelCol:{span:5},wrapperCol:{span:19},onValuesChange:d,children:[Wt.jsx(To.Item,{label:"地名注记",name:"showPlaceLabels",children:Wt.jsxs(cn.Group,{children:[Wt.jsx(cn,{value:!0,children:"开启"}),Wt.jsx(cn,{value:!1,children:"关闭"})]})}),Wt.jsx(To.Item,{label:"道路注记",name:"showRoadLabels",children:Wt.jsxs(cn.Group,{children:[Wt.jsx(cn,{value:!0,children:"开启"}),Wt.jsx(cn,{value:!1,children:"关闭"})]})}),Wt.jsx(To.Item,{label:"POI 注记",name:"showPointOfInterestLabels",children:Wt.jsxs(cn.Group,{children:[Wt.jsx(cn,{value:!0,children:"开启"}),Wt.jsx(cn,{value:!1,children:"关闭"})]})}),Wt.jsx(To.Item,{label:"交通注记",name:"showTransitLabels",children:Wt.jsxs(cn.Group,{children:[Wt.jsx(cn,{value:!0,children:"开启"}),Wt.jsx(cn,{value:!1,children:"关闭"})]})}),Wt.jsx(To.Item,{label:"预设灯光",name:"lightPreset",children:Wt.jsxs(cn.Group,{children:[Wt.jsx(cn,{value:"day",children:"白天"}),Wt.jsx(cn,{value:"night",children:"晚上"}),Wt.jsx(cn,{value:"dusk",children:"黄昏"}),Wt.jsx(cn,{value:"dawn",children:"黎明"})]})})]}),Wt.jsx(QE,{style:{margin:"6px 0"}}),Wt.jsx(To,{labelCol:{span:5},wrapperCol:{span:19},children:Wt.jsx(To.Item,{label:"气象要素",children:Wt.jsx(xP,{children:Wt.jsx(XH,{onChange:i,children:"风场"})})})}),Wt.jsx(To,{labelCol:{span:5},wrapperCol:{span:19},children:Wt.jsx(To.Item,{label:"路径规划",children:Wt.jsxs(xP,{size:5,children:[Wt.jsx(np,{type:"primary",size:"small",onClick:L,children:"飞行区域"}),Wt.jsx(np,{type:"primary",size:"small",onClick:N,children:"路径规划"}),Wt.jsx(np,{type:"primary",size:"small",onClick:U,children:"天气风险"}),Wt.jsx(np,{size:"small",onClick:q,children:"重置"})]})})})]})},fK=()=>{const{map:e,addGroupLayer:r,removeGroupLayers:a}=Np();return $.useEffect(()=>{const c=[[0,"#f00"],[1,"#0f0"]],d=[.5,1];return console.log(...c.map(([x,T])=>[d[0]+(d[1]-d[0])*x,T])),r("raster-terrain",{sources:{"raster-terrain":{type:"raster",tiles:["http://localhost:8600/geoserver/gwc/service/wmts/rest/test:dem/EPSG:900913/EPSG:900913:{z}/{y}/{x}?format=image/png"],maxzoom:14,tileSize:256}},layers:[{id:"raster-terrain",type:"raster",slot:"bottom",source:"raster-terrain",paint:{"raster-opacity":1,"raster-color-range":d,"raster-color":["interpolate",["linear"],["raster-value"],...c.map(([x,T])=>[d[0]+(d[1]-d[0])*x,T]).flat()]}}]}),()=>{a()}},[e]),Wt.jsx(Wt.Fragment,{})},pK={showPlaceLabels:!0,showRoadLabels:!0,showPointOfInterestLabels:!0,showTransitLabels:!0,lightPreset:"day"},gv="maine",mK=()=>{const{map:e,addGroupLayer:r,removeGroupLayers:a}=Np();$.useEffect(()=>(e&&e.flyTo({center:[-68.137343,45.137451],zoom:6.5}),()=>{a()}),[e]);const c=x=>{const T=Object.keys(x)[0];e==null||e.setConfigProperty("basemap",T,x[T])},d=x=>{a(),r(gv,{sources:{[gv]:{type:"geojson",data:"./data/maine.geojson"}},layers:[{id:gv,slot:x,source:gv,type:"fill",paint:{"fill-color":"#0080ff","fill-opacity":.5}}]})};return Wt.jsxs(lT,{className:"w-[380px]",children:[Wt.jsxs(To,{initialValues:pK,labelCol:{span:5},wrapperCol:{span:19},onValuesChange:c,children:[Wt.jsx(To.Item,{label:"地名注记",name:"showPlaceLabels",children:Wt.jsxs(cn.Group,{children:[Wt.jsx(cn,{value:!0,children:"开启"}),Wt.jsx(cn,{value:!1,children:"关闭"})]})}),Wt.jsx(To.Item,{label:"道路注记",name:"showRoadLabels",children:Wt.jsxs(cn.Group,{children:[Wt.jsx(cn,{value:!0,children:"开启"}),Wt.jsx(cn,{value:!1,children:"关闭"})]})}),Wt.jsx(To.Item,{label:"POI 注记",name:"showPointOfInterestLabels",children:Wt.jsxs(cn.Group,{children:[Wt.jsx(cn,{value:!0,children:"开启"}),Wt.jsx(cn,{value:!1,children:"关闭"})]})}),Wt.jsx(To.Item,{label:"交通注记",name:"showTransitLabels",children:Wt.jsxs(cn.Group,{children:[Wt.jsx(cn,{value:!0,children:"开启"}),Wt.jsx(cn,{value:!1,children:"关闭"})]})}),Wt.jsx(To.Item,{label:"预设灯光",name:"lightPreset",children:Wt.jsxs(cn.Group,{children:[Wt.jsx(cn,{value:"day",children:"白天"}),Wt.jsx(cn,{value:"night",children:"晚上"}),Wt.jsx(cn,{value:"dusk",children:"黄昏"}),Wt.jsx(cn,{value:"dawn",children:"黎明"})]})})]}),Wt.jsx(QE,{style:{margin:"6px 0"}}),Wt.jsx(To,{labelCol:{span:5},wrapperCol:{span:19},children:Wt.jsx(To.Item,{label:"图层插槽",children:Wt.jsxs(cn.Group,{onChange:x=>{d(x.target.value)},children:[Wt.jsx(cn,{value:"bottom",children:"面上方"}),Wt.jsx(cn,{value:"middle",children:"线上方"}),Wt.jsx(cn,{value:"none",children:"最上方"})]})})})]})},gK=[{id:"1",title:"朝天门",camera:{center:[106.583,29.5667],zoom:15.78,bearing:-41.38,pitch:45.12}},{id:"2",title:"东方明珠",camera:{center:[121.4968,31.2402],zoom:16.06,bearing:137.6,pitch:63.5}},{id:"3",title:"Statue of Liberty",camera:{center:[-74.04546645789205,40.68964503655931],zoom:17,bearing:-60,pitch:70}},{id:"4",title:"New York",camera:{center:[-74.00825,40.70836],zoom:14.6523,bearing:63,pitch:62}}],_K=()=>{const{map:e}=Np();return Wt.jsxs(lT,{children:[Wt.jsxs(cn.Group,{onChange:r=>{const a=r.target.value;e==null||e.setConfigProperty("basemap","lightPreset",a)},children:[Wt.jsx(cn,{value:"day",children:"白天"}),Wt.jsx(cn,{value:"night",children:"晚上"}),Wt.jsx(cn,{value:"dusk",children:"黄昏"}),Wt.jsx(cn,{value:"dawn",children:"黎明"})]}),Wt.jsx(QE,{style:{margin:"6px 0"}}),Wt.jsx(cn.Group,{onChange:r=>{const a=r.target.value;e==null||e.flyTo(a.camera)},children:gK.map(r=>Wt.jsx(cn,{value:r,children:r.title},r.id))})]})},wk=[{name:"标准样式",path:"standard-style",element:Wt.jsx(mK,{})},{index:!0,name:"建筑模型",path:"3d-taste",element:Wt.jsx(_K,{})},{name:"栅格颜色",path:"raster-color",element:Wt.jsx(fK,{})},{name:"低空模拟",path:"low-altitude",element:Wt.jsx(dK,{})}],yK=eY([{id:"root",path:"/",element:Wt.jsx(KY,{}),errorElement:Wt.jsx(_Y,{}),children:wk},{path:"*",element:Wt.jsx(yY,{})}]);function vK(){return Wt.jsx(cY,{router:yK,fallbackElement:Wt.jsx(gY,{})})}const xK=(e,r)=>console.log(`%c ${e} %c v${r} `,"padding: 2px 1px; border-radius: 3px 0 0 3px; color: #fff; background: #606060; font-weight: bold;","padding: 2px 1px; border-radius: 0 3px 3px 0; color: #fff; background: #42c02e; font-weight: bold;");m3.createRoot(document.getElementById("root")).render(Wt.jsx(Dj,{locale:Y6,theme:{algorithm:oZ.darkAlgorithm},children:Wt.jsx(vK,{})}));xK("version:",zZ.version);
