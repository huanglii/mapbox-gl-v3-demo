function XP(n,o){for(var l=0;l<o.length;l++){const h=o[l];if(typeof h!="string"&&!Array.isArray(h)){for(const f in h)if(f!=="default"&&!(f in n)){const g=Object.getOwnPropertyDescriptor(h,f);g&&Object.defineProperty(n,f,g.get?g:{enumerable:!0,get:()=>h[f]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const f of document.querySelectorAll('link[rel="modulepreload"]'))h(f);new MutationObserver(f=>{for(const g of f)if(g.type==="childList")for(const x of g.addedNodes)x.tagName==="LINK"&&x.rel==="modulepreload"&&h(x)}).observe(document,{childList:!0,subtree:!0});function l(f){const g={};return f.integrity&&(g.integrity=f.integrity),f.referrerPolicy&&(g.referrerPolicy=f.referrerPolicy),f.crossOrigin==="use-credentials"?g.credentials="include":f.crossOrigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function h(f){if(f.ep)return;f.ep=!0;const g=l(f);fetch(f.href,g)}})();var Sf=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Gh(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var YP={exports:{}},v_={},KP={exports:{}},Zr={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xp=Symbol.for("react.element"),Jj=Symbol.for("react.portal"),Qj=Symbol.for("react.fragment"),e$=Symbol.for("react.strict_mode"),t$=Symbol.for("react.profiler"),r$=Symbol.for("react.provider"),n$=Symbol.for("react.context"),i$=Symbol.for("react.forward_ref"),o$=Symbol.for("react.suspense"),a$=Symbol.for("react.memo"),s$=Symbol.for("react.lazy"),$A=Symbol.iterator;function l$(n){return n===null||typeof n!="object"?null:(n=$A&&n[$A]||n["@@iterator"],typeof n=="function"?n:null)}var JP={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},QP=Object.assign,ek={};function Wh(n,o,l){this.props=n,this.context=o,this.refs=ek,this.updater=l||JP}Wh.prototype.isReactComponent={};Wh.prototype.setState=function(n,o){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,o,"setState")};Wh.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function tk(){}tk.prototype=Wh.prototype;function zw(n,o,l){this.props=n,this.context=o,this.refs=ek,this.updater=l||JP}var Dw=zw.prototype=new tk;Dw.constructor=zw;QP(Dw,Wh.prototype);Dw.isPureReactComponent=!0;var VA=Array.isArray,rk=Object.prototype.hasOwnProperty,Lw={current:null},nk={key:!0,ref:!0,__self:!0,__source:!0};function ik(n,o,l){var h,f={},g=null,x=null;if(o!=null)for(h in o.ref!==void 0&&(x=o.ref),o.key!==void 0&&(g=""+o.key),o)rk.call(o,h)&&!nk.hasOwnProperty(h)&&(f[h]=o[h]);var E=arguments.length-2;if(E===1)f.children=l;else if(1<E){for(var w=Array(E),I=0;I<E;I++)w[I]=arguments[I+2];f.children=w}if(n&&n.defaultProps)for(h in E=n.defaultProps,E)f[h]===void 0&&(f[h]=E[h]);return{$$typeof:xp,type:n,key:g,ref:x,props:f,_owner:Lw.current}}function c$(n,o){return{$$typeof:xp,type:n.type,key:o,ref:n.ref,props:n.props,_owner:n._owner}}function Ow(n){return typeof n=="object"&&n!==null&&n.$$typeof===xp}function u$(n){var o={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(l){return o[l]})}var UA=/\/+/g;function Hx(n,o){return typeof n=="object"&&n!==null&&n.key!=null?u$(""+n.key):o.toString(36)}function p0(n,o,l,h,f){var g=typeof n;(g==="undefined"||g==="boolean")&&(n=null);var x=!1;if(n===null)x=!0;else switch(g){case"string":case"number":x=!0;break;case"object":switch(n.$$typeof){case xp:case Jj:x=!0}}if(x)return x=n,f=f(x),n=h===""?"."+Hx(x,0):h,VA(f)?(l="",n!=null&&(l=n.replace(UA,"$&/")+"/"),p0(f,o,l,"",function(I){return I})):f!=null&&(Ow(f)&&(f=c$(f,l+(!f.key||x&&x.key===f.key?"":(""+f.key).replace(UA,"$&/")+"/")+n)),o.push(f)),1;if(x=0,h=h===""?".":h+":",VA(n))for(var E=0;E<n.length;E++){g=n[E];var w=h+Hx(g,E);x+=p0(g,o,l,w,f)}else if(w=l$(n),typeof w=="function")for(n=w.call(n),E=0;!(g=n.next()).done;)g=g.value,w=h+Hx(g,E++),x+=p0(g,o,l,w,f);else if(g==="object")throw o=String(n),Error("Objects are not valid as a React child (found: "+(o==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":o)+"). If you meant to render a collection of children, use an array instead.");return x}function Og(n,o,l){if(n==null)return n;var h=[],f=0;return p0(n,h,"","",function(g){return o.call(l,g,f++)}),h}function h$(n){if(n._status===-1){var o=n._result;o=o(),o.then(function(l){(n._status===0||n._status===-1)&&(n._status=1,n._result=l)},function(l){(n._status===0||n._status===-1)&&(n._status=2,n._result=l)}),n._status===-1&&(n._status=0,n._result=o)}if(n._status===1)return n._result.default;throw n._result}var Fi={current:null},m0={transition:null},d$={ReactCurrentDispatcher:Fi,ReactCurrentBatchConfig:m0,ReactCurrentOwner:Lw};Zr.Children={map:Og,forEach:function(n,o,l){Og(n,function(){o.apply(this,arguments)},l)},count:function(n){var o=0;return Og(n,function(){o++}),o},toArray:function(n){return Og(n,function(o){return o})||[]},only:function(n){if(!Ow(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};Zr.Component=Wh;Zr.Fragment=Qj;Zr.Profiler=t$;Zr.PureComponent=zw;Zr.StrictMode=e$;Zr.Suspense=o$;Zr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=d$;Zr.cloneElement=function(n,o,l){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var h=QP({},n.props),f=n.key,g=n.ref,x=n._owner;if(o!=null){if(o.ref!==void 0&&(g=o.ref,x=Lw.current),o.key!==void 0&&(f=""+o.key),n.type&&n.type.defaultProps)var E=n.type.defaultProps;for(w in o)rk.call(o,w)&&!nk.hasOwnProperty(w)&&(h[w]=o[w]===void 0&&E!==void 0?E[w]:o[w])}var w=arguments.length-2;if(w===1)h.children=l;else if(1<w){E=Array(w);for(var I=0;I<w;I++)E[I]=arguments[I+2];h.children=E}return{$$typeof:xp,type:n.type,key:f,ref:g,props:h,_owner:x}};Zr.createContext=function(n){return n={$$typeof:n$,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:r$,_context:n},n.Consumer=n};Zr.createElement=ik;Zr.createFactory=function(n){var o=ik.bind(null,n);return o.type=n,o};Zr.createRef=function(){return{current:null}};Zr.forwardRef=function(n){return{$$typeof:i$,render:n}};Zr.isValidElement=Ow;Zr.lazy=function(n){return{$$typeof:s$,_payload:{_status:-1,_result:n},_init:h$}};Zr.memo=function(n,o){return{$$typeof:a$,type:n,compare:o===void 0?null:o}};Zr.startTransition=function(n){var o=m0.transition;m0.transition={};try{n()}finally{m0.transition=o}};Zr.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};Zr.useCallback=function(n,o){return Fi.current.useCallback(n,o)};Zr.useContext=function(n){return Fi.current.useContext(n)};Zr.useDebugValue=function(){};Zr.useDeferredValue=function(n){return Fi.current.useDeferredValue(n)};Zr.useEffect=function(n,o){return Fi.current.useEffect(n,o)};Zr.useId=function(){return Fi.current.useId()};Zr.useImperativeHandle=function(n,o,l){return Fi.current.useImperativeHandle(n,o,l)};Zr.useInsertionEffect=function(n,o){return Fi.current.useInsertionEffect(n,o)};Zr.useLayoutEffect=function(n,o){return Fi.current.useLayoutEffect(n,o)};Zr.useMemo=function(n,o){return Fi.current.useMemo(n,o)};Zr.useReducer=function(n,o,l){return Fi.current.useReducer(n,o,l)};Zr.useRef=function(n){return Fi.current.useRef(n)};Zr.useState=function(n){return Fi.current.useState(n)};Zr.useSyncExternalStore=function(n,o,l){return Fi.current.useSyncExternalStore(n,o,l)};Zr.useTransition=function(){return Fi.current.useTransition()};Zr.version="18.2.0";KP.exports=Zr;var A=KP.exports;const xn=Gh(A),x_=XP({__proto__:null,default:xn},[A]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$=A,p$=Symbol.for("react.element"),m$=Symbol.for("react.fragment"),g$=Object.prototype.hasOwnProperty,_$=f$.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,y$={key:!0,ref:!0,__self:!0,__source:!0};function ok(n,o,l){var h,f={},g=null,x=null;l!==void 0&&(g=""+l),o.key!==void 0&&(g=""+o.key),o.ref!==void 0&&(x=o.ref);for(h in o)g$.call(o,h)&&!y$.hasOwnProperty(h)&&(f[h]=o[h]);if(n&&n.defaultProps)for(h in o=n.defaultProps,o)f[h]===void 0&&(f[h]=o[h]);return{$$typeof:p$,type:n,key:g,ref:x,props:f,_owner:_$.current}}v_.Fragment=m$;v_.jsx=ok;v_.jsxs=ok;YP.exports=v_;var Ct=YP.exports;function Va(n,o){if(!(n instanceof o))throw new TypeError("Cannot call a class as a function")}function bn(n){"@babel/helpers - typeof";return bn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(o){return typeof o}:function(o){return o&&typeof Symbol=="function"&&o.constructor===Symbol&&o!==Symbol.prototype?"symbol":typeof o},bn(n)}function v$(n,o){if(bn(n)!=="object"||n===null)return n;var l=n[Symbol.toPrimitive];if(l!==void 0){var h=l.call(n,o||"default");if(bn(h)!=="object")return h;throw new TypeError("@@toPrimitive must return a primitive value.")}return(o==="string"?String:Number)(n)}function ak(n){var o=v$(n,"string");return bn(o)==="symbol"?o:String(o)}function GA(n,o){for(var l=0;l<o.length;l++){var h=o[l];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(n,ak(h.key),h)}}function Ua(n,o,l){return o&&GA(n.prototype,o),l&&GA(n,l),Object.defineProperty(n,"prototype",{writable:!1}),n}function Xb(n,o){return Xb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,f){return h.__proto__=f,h},Xb(n,o)}function b_(n,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(o&&o.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),o&&Xb(n,o)}function z0(n){return z0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(l){return l.__proto__||Object.getPrototypeOf(l)},z0(n)}function x$(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function D0(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function b$(n,o){if(o&&(bn(o)==="object"||typeof o=="function"))return o;if(o!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return D0(n)}function w_(n){var o=x$();return function(){var h=z0(n),f;if(o){var g=z0(this).constructor;f=Reflect.construct(h,arguments,g)}else f=h.apply(this,arguments);return b$(this,f)}}var sk={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(n){(function(){var o={}.hasOwnProperty;function l(){for(var h=[],f=0;f<arguments.length;f++){var g=arguments[f];if(g){var x=typeof g;if(x==="string"||x==="number")h.push(g);else if(Array.isArray(g)){if(g.length){var E=l.apply(null,g);E&&h.push(E)}}else if(x==="object"){if(g.toString!==Object.prototype.toString&&!g.toString.toString().includes("[native code]")){h.push(g.toString());continue}for(var w in g)o.call(g,w)&&g[w]&&h.push(w)}}}return h.join(" ")}n.exports?(l.default=l,n.exports=l):window.classNames=l})()})(sk);var w$=sk.exports;const $t=Gh(w$);function ui(){return ui=Object.assign?Object.assign.bind():function(n){for(var o=1;o<arguments.length;o++){var l=arguments[o];for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&(n[h]=l[h])}return n},ui.apply(this,arguments)}var lk={exports:{}},pn={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mi=typeof Symbol=="function"&&Symbol.for,Fw=mi?Symbol.for("react.element"):60103,Bw=mi?Symbol.for("react.portal"):60106,E_=mi?Symbol.for("react.fragment"):60107,S_=mi?Symbol.for("react.strict_mode"):60108,T_=mi?Symbol.for("react.profiler"):60114,M_=mi?Symbol.for("react.provider"):60109,C_=mi?Symbol.for("react.context"):60110,Nw=mi?Symbol.for("react.async_mode"):60111,A_=mi?Symbol.for("react.concurrent_mode"):60111,I_=mi?Symbol.for("react.forward_ref"):60112,P_=mi?Symbol.for("react.suspense"):60113,E$=mi?Symbol.for("react.suspense_list"):60120,k_=mi?Symbol.for("react.memo"):60115,R_=mi?Symbol.for("react.lazy"):60116,S$=mi?Symbol.for("react.block"):60121,T$=mi?Symbol.for("react.fundamental"):60117,M$=mi?Symbol.for("react.responder"):60118,C$=mi?Symbol.for("react.scope"):60119;function So(n){if(typeof n=="object"&&n!==null){var o=n.$$typeof;switch(o){case Fw:switch(n=n.type,n){case Nw:case A_:case E_:case T_:case S_:case P_:return n;default:switch(n=n&&n.$$typeof,n){case C_:case I_:case R_:case k_:case M_:return n;default:return o}}case Bw:return o}}}function ck(n){return So(n)===A_}pn.AsyncMode=Nw;pn.ConcurrentMode=A_;pn.ContextConsumer=C_;pn.ContextProvider=M_;pn.Element=Fw;pn.ForwardRef=I_;pn.Fragment=E_;pn.Lazy=R_;pn.Memo=k_;pn.Portal=Bw;pn.Profiler=T_;pn.StrictMode=S_;pn.Suspense=P_;pn.isAsyncMode=function(n){return ck(n)||So(n)===Nw};pn.isConcurrentMode=ck;pn.isContextConsumer=function(n){return So(n)===C_};pn.isContextProvider=function(n){return So(n)===M_};pn.isElement=function(n){return typeof n=="object"&&n!==null&&n.$$typeof===Fw};pn.isForwardRef=function(n){return So(n)===I_};pn.isFragment=function(n){return So(n)===E_};pn.isLazy=function(n){return So(n)===R_};pn.isMemo=function(n){return So(n)===k_};pn.isPortal=function(n){return So(n)===Bw};pn.isProfiler=function(n){return So(n)===T_};pn.isStrictMode=function(n){return So(n)===S_};pn.isSuspense=function(n){return So(n)===P_};pn.isValidElementType=function(n){return typeof n=="string"||typeof n=="function"||n===E_||n===A_||n===T_||n===S_||n===P_||n===E$||typeof n=="object"&&n!==null&&(n.$$typeof===R_||n.$$typeof===k_||n.$$typeof===M_||n.$$typeof===C_||n.$$typeof===I_||n.$$typeof===T$||n.$$typeof===M$||n.$$typeof===C$||n.$$typeof===S$)};pn.typeOf=So;lk.exports=pn;var uk=lk.exports;function Wf(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=[];return xn.Children.forEach(n,function(h){h==null&&!o.keepEmpty||(Array.isArray(h)?l=l.concat(Wf(h)):uk.isFragment(h)&&h.props?l=l.concat(Wf(h.props.children,o)):l.push(h))}),l}var Yb={},A$=function(o){};function I$(n,o){}function P$(n,o){}function k$(){Yb={}}function hk(n,o,l){!o&&!Yb[l]&&(n(!1,l),Yb[l]=!0)}function xo(n,o){hk(I$,n,o)}function R$(n,o){hk(P$,n,o)}xo.preMessage=A$;xo.resetWarned=k$;xo.noteOnce=R$;function $r(n,o,l){return o=ak(o),o in n?Object.defineProperty(n,o,{value:l,enumerable:!0,configurable:!0,writable:!0}):n[o]=l,n}function WA(n,o){var l=Object.keys(n);if(Object.getOwnPropertySymbols){var h=Object.getOwnPropertySymbols(n);o&&(h=h.filter(function(f){return Object.getOwnPropertyDescriptor(n,f).enumerable})),l.push.apply(l,h)}return l}function ft(n){for(var o=1;o<arguments.length;o++){var l=arguments[o]!=null?arguments[o]:{};o%2?WA(Object(l),!0).forEach(function(h){$r(n,h,l[h])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(l)):WA(Object(l)).forEach(function(h){Object.defineProperty(n,h,Object.getOwnPropertyDescriptor(l,h))})}return n}function jw(n,o,l){var h=A.useRef({});return(!("value"in h.current)||l(h.current.condition,o))&&(h.current.value=n(),h.current.condition=o),h.current.value}function $w(n,o){typeof n=="function"?n(o):bn(n)==="object"&&n&&"current"in n&&(n.current=o)}function Bc(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];var h=o.filter(function(f){return f});return h.length<=1?h[0]:function(f){o.forEach(function(g){$w(g,f)})}}function dk(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];return jw(function(){return Bc.apply(void 0,o)},o,function(h,f){return h.length!==f.length||h.every(function(g,x){return g!==f[x]})})}function Hh(n){var o,l,h=uk.isMemo(n)?n.type.type:n.type;return!(typeof h=="function"&&!((o=h.prototype)!==null&&o!==void 0&&o.render)||typeof n=="function"&&!((l=n.prototype)!==null&&l!==void 0&&l.render))}var fk={exports:{}},To={},pk={exports:{}},mk={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function o(Re,He){var Xe=Re.length;Re.push(He);e:for(;0<Xe;){var ze=Xe-1>>>1,at=Re[ze];if(0<f(at,He))Re[ze]=He,Re[Xe]=at,Xe=ze;else break e}}function l(Re){return Re.length===0?null:Re[0]}function h(Re){if(Re.length===0)return null;var He=Re[0],Xe=Re.pop();if(Xe!==He){Re[0]=Xe;e:for(var ze=0,at=Re.length,Pt=at>>>1;ze<Pt;){var mt=2*(ze+1)-1,kt=Re[mt],Oe=mt+1,qt=Re[Oe];if(0>f(kt,Xe))Oe<at&&0>f(qt,kt)?(Re[ze]=qt,Re[Oe]=Xe,ze=Oe):(Re[ze]=kt,Re[mt]=Xe,ze=mt);else if(Oe<at&&0>f(qt,Xe))Re[ze]=qt,Re[Oe]=Xe,ze=Oe;else break e}}return He}function f(Re,He){var Xe=Re.sortIndex-He.sortIndex;return Xe!==0?Xe:Re.id-He.id}if(typeof performance=="object"&&typeof performance.now=="function"){var g=performance;n.unstable_now=function(){return g.now()}}else{var x=Date,E=x.now();n.unstable_now=function(){return x.now()-E}}var w=[],I=[],R=1,D=null,F=3,q=!1,G=!1,j=!1,te=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function V(Re){for(var He=l(I);He!==null;){if(He.callback===null)h(I);else if(He.startTime<=Re)h(I),He.sortIndex=He.expirationTime,o(w,He);else break;He=l(I)}}function U(Re){if(j=!1,V(Re),!G)if(l(w)!==null)G=!0,Ne(ae);else{var He=l(I);He!==null&&it(U,He.startTime-Re)}}function ae(Re,He){G=!1,j&&(j=!1,N(de),de=-1),q=!0;var Xe=F;try{for(V(He),D=l(w);D!==null&&(!(D.expirationTime>He)||Re&&!xe());){var ze=D.callback;if(typeof ze=="function"){D.callback=null,F=D.priorityLevel;var at=ze(D.expirationTime<=He);He=n.unstable_now(),typeof at=="function"?D.callback=at:D===l(w)&&h(w),V(He)}else h(w);D=l(w)}if(D!==null)var Pt=!0;else{var mt=l(I);mt!==null&&it(U,mt.startTime-He),Pt=!1}return Pt}finally{D=null,F=Xe,q=!1}}var le=!1,ne=null,de=-1,$=5,ue=-1;function xe(){return!(n.unstable_now()-ue<$)}function ce(){if(ne!==null){var Re=n.unstable_now();ue=Re;var He=!0;try{He=ne(!0,Re)}finally{He?se():(le=!1,ne=null)}}else le=!1}var se;if(typeof O=="function")se=function(){O(ce)};else if(typeof MessageChannel<"u"){var ke=new MessageChannel,$e=ke.port2;ke.port1.onmessage=ce,se=function(){$e.postMessage(null)}}else se=function(){te(ce,0)};function Ne(Re){ne=Re,le||(le=!0,se())}function it(Re,He){de=te(function(){Re(n.unstable_now())},He)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(Re){Re.callback=null},n.unstable_continueExecution=function(){G||q||(G=!0,Ne(ae))},n.unstable_forceFrameRate=function(Re){0>Re||125<Re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<Re?Math.floor(1e3/Re):5},n.unstable_getCurrentPriorityLevel=function(){return F},n.unstable_getFirstCallbackNode=function(){return l(w)},n.unstable_next=function(Re){switch(F){case 1:case 2:case 3:var He=3;break;default:He=F}var Xe=F;F=He;try{return Re()}finally{F=Xe}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(Re,He){switch(Re){case 1:case 2:case 3:case 4:case 5:break;default:Re=3}var Xe=F;F=Re;try{return He()}finally{F=Xe}},n.unstable_scheduleCallback=function(Re,He,Xe){var ze=n.unstable_now();switch(typeof Xe=="object"&&Xe!==null?(Xe=Xe.delay,Xe=typeof Xe=="number"&&0<Xe?ze+Xe:ze):Xe=ze,Re){case 1:var at=-1;break;case 2:at=250;break;case 5:at=1073741823;break;case 4:at=1e4;break;default:at=5e3}return at=Xe+at,Re={id:R++,callback:He,priorityLevel:Re,startTime:Xe,expirationTime:at,sortIndex:-1},Xe>ze?(Re.sortIndex=Xe,o(I,Re),l(w)===null&&Re===l(I)&&(j?(N(de),de=-1):j=!0,it(U,Xe-ze))):(Re.sortIndex=at,o(w,Re),G||q||(G=!0,Ne(ae))),Re},n.unstable_shouldYield=xe,n.unstable_wrapCallback=function(Re){var He=F;return function(){var Xe=F;F=He;try{return Re.apply(this,arguments)}finally{F=Xe}}}})(mk);pk.exports=mk;var z$=pk.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gk=A,wo=z$;function ut(n){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+n,l=1;l<arguments.length;l++)o+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+n+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _k=new Set,Hf={};function Nc(n,o){Rh(n,o),Rh(n+"Capture",o)}function Rh(n,o){for(Hf[n]=o,n=0;n<o.length;n++)_k.add(o[n])}var xs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Kb=Object.prototype.hasOwnProperty,D$=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,HA={},qA={};function L$(n){return Kb.call(qA,n)?!0:Kb.call(HA,n)?!1:D$.test(n)?qA[n]=!0:(HA[n]=!0,!1)}function O$(n,o,l,h){if(l!==null&&l.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return h?!1:l!==null?!l.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function F$(n,o,l,h){if(o===null||typeof o>"u"||O$(n,o,l,h))return!0;if(h)return!1;if(l!==null)switch(l.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function Bi(n,o,l,h,f,g,x){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=h,this.attributeNamespace=f,this.mustUseProperty=l,this.propertyName=n,this.type=o,this.sanitizeURL=g,this.removeEmptyString=x}var xi={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){xi[n]=new Bi(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var o=n[0];xi[o]=new Bi(o,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){xi[n]=new Bi(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){xi[n]=new Bi(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){xi[n]=new Bi(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){xi[n]=new Bi(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){xi[n]=new Bi(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){xi[n]=new Bi(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){xi[n]=new Bi(n,5,!1,n.toLowerCase(),null,!1,!1)});var Vw=/[\-:]([a-z])/g;function Uw(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var o=n.replace(Vw,Uw);xi[o]=new Bi(o,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var o=n.replace(Vw,Uw);xi[o]=new Bi(o,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var o=n.replace(Vw,Uw);xi[o]=new Bi(o,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){xi[n]=new Bi(n,1,!1,n.toLowerCase(),null,!1,!1)});xi.xlinkHref=new Bi("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){xi[n]=new Bi(n,1,!1,n.toLowerCase(),null,!0,!0)});function Gw(n,o,l,h){var f=xi.hasOwnProperty(o)?xi[o]:null;(f!==null?f.type!==0:h||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(F$(o,l,f,h)&&(l=null),h||f===null?L$(o)&&(l===null?n.removeAttribute(o):n.setAttribute(o,""+l)):f.mustUseProperty?n[f.propertyName]=l===null?f.type===3?!1:"":l:(o=f.attributeName,h=f.attributeNamespace,l===null?n.removeAttribute(o):(f=f.type,l=f===3||f===4&&l===!0?"":""+l,h?n.setAttributeNS(h,o,l):n.setAttribute(o,l))))}var Ms=gk.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Fg=Symbol.for("react.element"),ah=Symbol.for("react.portal"),sh=Symbol.for("react.fragment"),Ww=Symbol.for("react.strict_mode"),Jb=Symbol.for("react.profiler"),yk=Symbol.for("react.provider"),vk=Symbol.for("react.context"),Hw=Symbol.for("react.forward_ref"),Qb=Symbol.for("react.suspense"),e2=Symbol.for("react.suspense_list"),qw=Symbol.for("react.memo"),gl=Symbol.for("react.lazy"),xk=Symbol.for("react.offscreen"),ZA=Symbol.iterator;function uf(n){return n===null||typeof n!="object"?null:(n=ZA&&n[ZA]||n["@@iterator"],typeof n=="function"?n:null)}var Un=Object.assign,qx;function Tf(n){if(qx===void 0)try{throw Error()}catch(l){var o=l.stack.trim().match(/\n( *(at )?)/);qx=o&&o[1]||""}return`
`+qx+n}var Zx=!1;function Xx(n,o){if(!n||Zx)return"";Zx=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(I){var h=I}Reflect.construct(n,[],o)}else{try{o.call()}catch(I){h=I}n.call(o.prototype)}else{try{throw Error()}catch(I){h=I}n()}}catch(I){if(I&&h&&typeof I.stack=="string"){for(var f=I.stack.split(`
`),g=h.stack.split(`
`),x=f.length-1,E=g.length-1;1<=x&&0<=E&&f[x]!==g[E];)E--;for(;1<=x&&0<=E;x--,E--)if(f[x]!==g[E]){if(x!==1||E!==1)do if(x--,E--,0>E||f[x]!==g[E]){var w=`
`+f[x].replace(" at new "," at ");return n.displayName&&w.includes("<anonymous>")&&(w=w.replace("<anonymous>",n.displayName)),w}while(1<=x&&0<=E);break}}}finally{Zx=!1,Error.prepareStackTrace=l}return(n=n?n.displayName||n.name:"")?Tf(n):""}function B$(n){switch(n.tag){case 5:return Tf(n.type);case 16:return Tf("Lazy");case 13:return Tf("Suspense");case 19:return Tf("SuspenseList");case 0:case 2:case 15:return n=Xx(n.type,!1),n;case 11:return n=Xx(n.type.render,!1),n;case 1:return n=Xx(n.type,!0),n;default:return""}}function t2(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case sh:return"Fragment";case ah:return"Portal";case Jb:return"Profiler";case Ww:return"StrictMode";case Qb:return"Suspense";case e2:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case vk:return(n.displayName||"Context")+".Consumer";case yk:return(n._context.displayName||"Context")+".Provider";case Hw:var o=n.render;return n=n.displayName,n||(n=o.displayName||o.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case qw:return o=n.displayName||null,o!==null?o:t2(n.type)||"Memo";case gl:o=n._payload,n=n._init;try{return t2(n(o))}catch{}}return null}function N$(n){var o=n.type;switch(n.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=o.render,n=n.displayName||n.name||"",o.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return t2(o);case 8:return o===Ww?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Rl(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function bk(n){var o=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function j$(n){var o=bk(n)?"checked":"value",l=Object.getOwnPropertyDescriptor(n.constructor.prototype,o),h=""+n[o];if(!n.hasOwnProperty(o)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var f=l.get,g=l.set;return Object.defineProperty(n,o,{configurable:!0,get:function(){return f.call(this)},set:function(x){h=""+x,g.call(this,x)}}),Object.defineProperty(n,o,{enumerable:l.enumerable}),{getValue:function(){return h},setValue:function(x){h=""+x},stopTracking:function(){n._valueTracker=null,delete n[o]}}}}function Bg(n){n._valueTracker||(n._valueTracker=j$(n))}function wk(n){if(!n)return!1;var o=n._valueTracker;if(!o)return!0;var l=o.getValue(),h="";return n&&(h=bk(n)?n.checked?"true":"false":n.value),n=h,n!==l?(o.setValue(n),!0):!1}function L0(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function r2(n,o){var l=o.checked;return Un({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??n._wrapperState.initialChecked})}function XA(n,o){var l=o.defaultValue==null?"":o.defaultValue,h=o.checked!=null?o.checked:o.defaultChecked;l=Rl(o.value!=null?o.value:l),n._wrapperState={initialChecked:h,initialValue:l,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function Ek(n,o){o=o.checked,o!=null&&Gw(n,"checked",o,!1)}function n2(n,o){Ek(n,o);var l=Rl(o.value),h=o.type;if(l!=null)h==="number"?(l===0&&n.value===""||n.value!=l)&&(n.value=""+l):n.value!==""+l&&(n.value=""+l);else if(h==="submit"||h==="reset"){n.removeAttribute("value");return}o.hasOwnProperty("value")?i2(n,o.type,l):o.hasOwnProperty("defaultValue")&&i2(n,o.type,Rl(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(n.defaultChecked=!!o.defaultChecked)}function YA(n,o,l){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var h=o.type;if(!(h!=="submit"&&h!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+n._wrapperState.initialValue,l||o===n.value||(n.value=o),n.defaultValue=o}l=n.name,l!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,l!==""&&(n.name=l)}function i2(n,o,l){(o!=="number"||L0(n.ownerDocument)!==n)&&(l==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+l&&(n.defaultValue=""+l))}var Mf=Array.isArray;function Sh(n,o,l,h){if(n=n.options,o){o={};for(var f=0;f<l.length;f++)o["$"+l[f]]=!0;for(l=0;l<n.length;l++)f=o.hasOwnProperty("$"+n[l].value),n[l].selected!==f&&(n[l].selected=f),f&&h&&(n[l].defaultSelected=!0)}else{for(l=""+Rl(l),o=null,f=0;f<n.length;f++){if(n[f].value===l){n[f].selected=!0,h&&(n[f].defaultSelected=!0);return}o!==null||n[f].disabled||(o=n[f])}o!==null&&(o.selected=!0)}}function o2(n,o){if(o.dangerouslySetInnerHTML!=null)throw Error(ut(91));return Un({},o,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function KA(n,o){var l=o.value;if(l==null){if(l=o.children,o=o.defaultValue,l!=null){if(o!=null)throw Error(ut(92));if(Mf(l)){if(1<l.length)throw Error(ut(93));l=l[0]}o=l}o==null&&(o=""),l=o}n._wrapperState={initialValue:Rl(l)}}function Sk(n,o){var l=Rl(o.value),h=Rl(o.defaultValue);l!=null&&(l=""+l,l!==n.value&&(n.value=l),o.defaultValue==null&&n.defaultValue!==l&&(n.defaultValue=l)),h!=null&&(n.defaultValue=""+h)}function JA(n){var o=n.textContent;o===n._wrapperState.initialValue&&o!==""&&o!==null&&(n.value=o)}function Tk(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function a2(n,o){return n==null||n==="http://www.w3.org/1999/xhtml"?Tk(o):n==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Ng,Mk=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,l,h,f){MSApp.execUnsafeLocalFunction(function(){return n(o,l,h,f)})}:n}(function(n,o){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=o;else{for(Ng=Ng||document.createElement("div"),Ng.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Ng.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;o.firstChild;)n.appendChild(o.firstChild)}});function qf(n,o){if(o){var l=n.firstChild;if(l&&l===n.lastChild&&l.nodeType===3){l.nodeValue=o;return}}n.textContent=o}var Pf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},$$=["Webkit","ms","Moz","O"];Object.keys(Pf).forEach(function(n){$$.forEach(function(o){o=o+n.charAt(0).toUpperCase()+n.substring(1),Pf[o]=Pf[n]})});function Ck(n,o,l){return o==null||typeof o=="boolean"||o===""?"":l||typeof o!="number"||o===0||Pf.hasOwnProperty(n)&&Pf[n]?(""+o).trim():o+"px"}function Ak(n,o){n=n.style;for(var l in o)if(o.hasOwnProperty(l)){var h=l.indexOf("--")===0,f=Ck(l,o[l],h);l==="float"&&(l="cssFloat"),h?n.setProperty(l,f):n[l]=f}}var V$=Un({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function s2(n,o){if(o){if(V$[n]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(ut(137,n));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(ut(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(ut(61))}if(o.style!=null&&typeof o.style!="object")throw Error(ut(62))}}function l2(n,o){if(n.indexOf("-")===-1)return typeof o.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var c2=null;function Zw(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var u2=null,Th=null,Mh=null;function QA(n){if(n=Ep(n)){if(typeof u2!="function")throw Error(ut(280));var o=n.stateNode;o&&(o=F_(o),u2(n.stateNode,n.type,o))}}function Ik(n){Th?Mh?Mh.push(n):Mh=[n]:Th=n}function Pk(){if(Th){var n=Th,o=Mh;if(Mh=Th=null,QA(n),o)for(n=0;n<o.length;n++)QA(o[n])}}function kk(n,o){return n(o)}function Rk(){}var Yx=!1;function zk(n,o,l){if(Yx)return n(o,l);Yx=!0;try{return kk(n,o,l)}finally{Yx=!1,(Th!==null||Mh!==null)&&(Rk(),Pk())}}function Zf(n,o){var l=n.stateNode;if(l===null)return null;var h=F_(l);if(h===null)return null;l=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(n=n.type,h=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!h;break e;default:n=!1}if(n)return null;if(l&&typeof l!="function")throw Error(ut(231,o,typeof l));return l}var h2=!1;if(xs)try{var hf={};Object.defineProperty(hf,"passive",{get:function(){h2=!0}}),window.addEventListener("test",hf,hf),window.removeEventListener("test",hf,hf)}catch{h2=!1}function U$(n,o,l,h,f,g,x,E,w){var I=Array.prototype.slice.call(arguments,3);try{o.apply(l,I)}catch(R){this.onError(R)}}var kf=!1,O0=null,F0=!1,d2=null,G$={onError:function(n){kf=!0,O0=n}};function W$(n,o,l,h,f,g,x,E,w){kf=!1,O0=null,U$.apply(G$,arguments)}function H$(n,o,l,h,f,g,x,E,w){if(W$.apply(this,arguments),kf){if(kf){var I=O0;kf=!1,O0=null}else throw Error(ut(198));F0||(F0=!0,d2=I)}}function jc(n){var o=n,l=n;if(n.alternate)for(;o.return;)o=o.return;else{n=o;do o=n,o.flags&4098&&(l=o.return),n=o.return;while(n)}return o.tag===3?l:null}function Dk(n){if(n.tag===13){var o=n.memoizedState;if(o===null&&(n=n.alternate,n!==null&&(o=n.memoizedState)),o!==null)return o.dehydrated}return null}function e6(n){if(jc(n)!==n)throw Error(ut(188))}function q$(n){var o=n.alternate;if(!o){if(o=jc(n),o===null)throw Error(ut(188));return o!==n?null:n}for(var l=n,h=o;;){var f=l.return;if(f===null)break;var g=f.alternate;if(g===null){if(h=f.return,h!==null){l=h;continue}break}if(f.child===g.child){for(g=f.child;g;){if(g===l)return e6(f),n;if(g===h)return e6(f),o;g=g.sibling}throw Error(ut(188))}if(l.return!==h.return)l=f,h=g;else{for(var x=!1,E=f.child;E;){if(E===l){x=!0,l=f,h=g;break}if(E===h){x=!0,h=f,l=g;break}E=E.sibling}if(!x){for(E=g.child;E;){if(E===l){x=!0,l=g,h=f;break}if(E===h){x=!0,h=g,l=f;break}E=E.sibling}if(!x)throw Error(ut(189))}}if(l.alternate!==h)throw Error(ut(190))}if(l.tag!==3)throw Error(ut(188));return l.stateNode.current===l?n:o}function Lk(n){return n=q$(n),n!==null?Ok(n):null}function Ok(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var o=Ok(n);if(o!==null)return o;n=n.sibling}return null}var Fk=wo.unstable_scheduleCallback,t6=wo.unstable_cancelCallback,Z$=wo.unstable_shouldYield,X$=wo.unstable_requestPaint,Kn=wo.unstable_now,Y$=wo.unstable_getCurrentPriorityLevel,Xw=wo.unstable_ImmediatePriority,Bk=wo.unstable_UserBlockingPriority,B0=wo.unstable_NormalPriority,K$=wo.unstable_LowPriority,Nk=wo.unstable_IdlePriority,z_=null,ja=null;function J$(n){if(ja&&typeof ja.onCommitFiberRoot=="function")try{ja.onCommitFiberRoot(z_,n,void 0,(n.current.flags&128)===128)}catch{}}var ma=Math.clz32?Math.clz32:tV,Q$=Math.log,eV=Math.LN2;function tV(n){return n>>>=0,n===0?32:31-(Q$(n)/eV|0)|0}var jg=64,$g=4194304;function Cf(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function N0(n,o){var l=n.pendingLanes;if(l===0)return 0;var h=0,f=n.suspendedLanes,g=n.pingedLanes,x=l&268435455;if(x!==0){var E=x&~f;E!==0?h=Cf(E):(g&=x,g!==0&&(h=Cf(g)))}else x=l&~f,x!==0?h=Cf(x):g!==0&&(h=Cf(g));if(h===0)return 0;if(o!==0&&o!==h&&!(o&f)&&(f=h&-h,g=o&-o,f>=g||f===16&&(g&4194240)!==0))return o;if(h&4&&(h|=l&16),o=n.entangledLanes,o!==0)for(n=n.entanglements,o&=h;0<o;)l=31-ma(o),f=1<<l,h|=n[l],o&=~f;return h}function rV(n,o){switch(n){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nV(n,o){for(var l=n.suspendedLanes,h=n.pingedLanes,f=n.expirationTimes,g=n.pendingLanes;0<g;){var x=31-ma(g),E=1<<x,w=f[x];w===-1?(!(E&l)||E&h)&&(f[x]=rV(E,o)):w<=o&&(n.expiredLanes|=E),g&=~E}}function f2(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function jk(){var n=jg;return jg<<=1,!(jg&4194240)&&(jg=64),n}function Kx(n){for(var o=[],l=0;31>l;l++)o.push(n);return o}function bp(n,o,l){n.pendingLanes|=o,o!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,o=31-ma(o),n[o]=l}function iV(n,o){var l=n.pendingLanes&~o;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=o,n.mutableReadLanes&=o,n.entangledLanes&=o,o=n.entanglements;var h=n.eventTimes;for(n=n.expirationTimes;0<l;){var f=31-ma(l),g=1<<f;o[f]=0,h[f]=-1,n[f]=-1,l&=~g}}function Yw(n,o){var l=n.entangledLanes|=o;for(n=n.entanglements;l;){var h=31-ma(l),f=1<<h;f&o|n[h]&o&&(n[h]|=o),l&=~f}}var fn=0;function $k(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var Vk,Kw,Uk,Gk,Wk,p2=!1,Vg=[],Sl=null,Tl=null,Ml=null,Xf=new Map,Yf=new Map,yl=[],oV="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function r6(n,o){switch(n){case"focusin":case"focusout":Sl=null;break;case"dragenter":case"dragleave":Tl=null;break;case"mouseover":case"mouseout":Ml=null;break;case"pointerover":case"pointerout":Xf.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Yf.delete(o.pointerId)}}function df(n,o,l,h,f,g){return n===null||n.nativeEvent!==g?(n={blockedOn:o,domEventName:l,eventSystemFlags:h,nativeEvent:g,targetContainers:[f]},o!==null&&(o=Ep(o),o!==null&&Kw(o)),n):(n.eventSystemFlags|=h,o=n.targetContainers,f!==null&&o.indexOf(f)===-1&&o.push(f),n)}function aV(n,o,l,h,f){switch(o){case"focusin":return Sl=df(Sl,n,o,l,h,f),!0;case"dragenter":return Tl=df(Tl,n,o,l,h,f),!0;case"mouseover":return Ml=df(Ml,n,o,l,h,f),!0;case"pointerover":var g=f.pointerId;return Xf.set(g,df(Xf.get(g)||null,n,o,l,h,f)),!0;case"gotpointercapture":return g=f.pointerId,Yf.set(g,df(Yf.get(g)||null,n,o,l,h,f)),!0}return!1}function Hk(n){var o=mc(n.target);if(o!==null){var l=jc(o);if(l!==null){if(o=l.tag,o===13){if(o=Dk(l),o!==null){n.blockedOn=o,Wk(n.priority,function(){Uk(l)});return}}else if(o===3&&l.stateNode.current.memoizedState.isDehydrated){n.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}n.blockedOn=null}function g0(n){if(n.blockedOn!==null)return!1;for(var o=n.targetContainers;0<o.length;){var l=m2(n.domEventName,n.eventSystemFlags,o[0],n.nativeEvent);if(l===null){l=n.nativeEvent;var h=new l.constructor(l.type,l);c2=h,l.target.dispatchEvent(h),c2=null}else return o=Ep(l),o!==null&&Kw(o),n.blockedOn=l,!1;o.shift()}return!0}function n6(n,o,l){g0(n)&&l.delete(o)}function sV(){p2=!1,Sl!==null&&g0(Sl)&&(Sl=null),Tl!==null&&g0(Tl)&&(Tl=null),Ml!==null&&g0(Ml)&&(Ml=null),Xf.forEach(n6),Yf.forEach(n6)}function ff(n,o){n.blockedOn===o&&(n.blockedOn=null,p2||(p2=!0,wo.unstable_scheduleCallback(wo.unstable_NormalPriority,sV)))}function Kf(n){function o(f){return ff(f,n)}if(0<Vg.length){ff(Vg[0],n);for(var l=1;l<Vg.length;l++){var h=Vg[l];h.blockedOn===n&&(h.blockedOn=null)}}for(Sl!==null&&ff(Sl,n),Tl!==null&&ff(Tl,n),Ml!==null&&ff(Ml,n),Xf.forEach(o),Yf.forEach(o),l=0;l<yl.length;l++)h=yl[l],h.blockedOn===n&&(h.blockedOn=null);for(;0<yl.length&&(l=yl[0],l.blockedOn===null);)Hk(l),l.blockedOn===null&&yl.shift()}var Ch=Ms.ReactCurrentBatchConfig,j0=!0;function lV(n,o,l,h){var f=fn,g=Ch.transition;Ch.transition=null;try{fn=1,Jw(n,o,l,h)}finally{fn=f,Ch.transition=g}}function cV(n,o,l,h){var f=fn,g=Ch.transition;Ch.transition=null;try{fn=4,Jw(n,o,l,h)}finally{fn=f,Ch.transition=g}}function Jw(n,o,l,h){if(j0){var f=m2(n,o,l,h);if(f===null)sb(n,o,h,$0,l),r6(n,h);else if(aV(f,n,o,l,h))h.stopPropagation();else if(r6(n,h),o&4&&-1<oV.indexOf(n)){for(;f!==null;){var g=Ep(f);if(g!==null&&Vk(g),g=m2(n,o,l,h),g===null&&sb(n,o,h,$0,l),g===f)break;f=g}f!==null&&h.stopPropagation()}else sb(n,o,h,null,l)}}var $0=null;function m2(n,o,l,h){if($0=null,n=Zw(h),n=mc(n),n!==null)if(o=jc(n),o===null)n=null;else if(l=o.tag,l===13){if(n=Dk(o),n!==null)return n;n=null}else if(l===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;n=null}else o!==n&&(n=null);return $0=n,null}function qk(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Y$()){case Xw:return 1;case Bk:return 4;case B0:case K$:return 16;case Nk:return 536870912;default:return 16}default:return 16}}var xl=null,Qw=null,_0=null;function Zk(){if(_0)return _0;var n,o=Qw,l=o.length,h,f="value"in xl?xl.value:xl.textContent,g=f.length;for(n=0;n<l&&o[n]===f[n];n++);var x=l-n;for(h=1;h<=x&&o[l-h]===f[g-h];h++);return _0=f.slice(n,1<h?1-h:void 0)}function y0(n){var o=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&o===13&&(n=13)):n=o,n===10&&(n=13),32<=n||n===13?n:0}function Ug(){return!0}function i6(){return!1}function Mo(n){function o(l,h,f,g,x){this._reactName=l,this._targetInst=f,this.type=h,this.nativeEvent=g,this.target=x,this.currentTarget=null;for(var E in n)n.hasOwnProperty(E)&&(l=n[E],this[E]=l?l(g):g[E]);return this.isDefaultPrevented=(g.defaultPrevented!=null?g.defaultPrevented:g.returnValue===!1)?Ug:i6,this.isPropagationStopped=i6,this}return Un(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ug)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ug)},persist:function(){},isPersistent:Ug}),o}var qh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},e3=Mo(qh),wp=Un({},qh,{view:0,detail:0}),uV=Mo(wp),Jx,Qx,pf,D_=Un({},wp,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:t3,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==pf&&(pf&&n.type==="mousemove"?(Jx=n.screenX-pf.screenX,Qx=n.screenY-pf.screenY):Qx=Jx=0,pf=n),Jx)},movementY:function(n){return"movementY"in n?n.movementY:Qx}}),o6=Mo(D_),hV=Un({},D_,{dataTransfer:0}),dV=Mo(hV),fV=Un({},wp,{relatedTarget:0}),eb=Mo(fV),pV=Un({},qh,{animationName:0,elapsedTime:0,pseudoElement:0}),mV=Mo(pV),gV=Un({},qh,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),_V=Mo(gV),yV=Un({},qh,{data:0}),a6=Mo(yV),vV={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},xV={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bV={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wV(n){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(n):(n=bV[n])?!!o[n]:!1}function t3(){return wV}var EV=Un({},wp,{key:function(n){if(n.key){var o=vV[n.key]||n.key;if(o!=="Unidentified")return o}return n.type==="keypress"?(n=y0(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?xV[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:t3,charCode:function(n){return n.type==="keypress"?y0(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?y0(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),SV=Mo(EV),TV=Un({},D_,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),s6=Mo(TV),MV=Un({},wp,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:t3}),CV=Mo(MV),AV=Un({},qh,{propertyName:0,elapsedTime:0,pseudoElement:0}),IV=Mo(AV),PV=Un({},D_,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),kV=Mo(PV),RV=[9,13,27,32],r3=xs&&"CompositionEvent"in window,Rf=null;xs&&"documentMode"in document&&(Rf=document.documentMode);var zV=xs&&"TextEvent"in window&&!Rf,Xk=xs&&(!r3||Rf&&8<Rf&&11>=Rf),l6=String.fromCharCode(32),c6=!1;function Yk(n,o){switch(n){case"keyup":return RV.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Kk(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var lh=!1;function DV(n,o){switch(n){case"compositionend":return Kk(o);case"keypress":return o.which!==32?null:(c6=!0,l6);case"textInput":return n=o.data,n===l6&&c6?null:n;default:return null}}function LV(n,o){if(lh)return n==="compositionend"||!r3&&Yk(n,o)?(n=Zk(),_0=Qw=xl=null,lh=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Xk&&o.locale!=="ko"?null:o.data;default:return null}}var OV={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function u6(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o==="input"?!!OV[n.type]:o==="textarea"}function Jk(n,o,l,h){Ik(h),o=V0(o,"onChange"),0<o.length&&(l=new e3("onChange","change",null,l,h),n.push({event:l,listeners:o}))}var zf=null,Jf=null;function FV(n){cR(n,0)}function L_(n){var o=hh(n);if(wk(o))return n}function BV(n,o){if(n==="change")return o}var Qk=!1;if(xs){var tb;if(xs){var rb="oninput"in document;if(!rb){var h6=document.createElement("div");h6.setAttribute("oninput","return;"),rb=typeof h6.oninput=="function"}tb=rb}else tb=!1;Qk=tb&&(!document.documentMode||9<document.documentMode)}function d6(){zf&&(zf.detachEvent("onpropertychange",eR),Jf=zf=null)}function eR(n){if(n.propertyName==="value"&&L_(Jf)){var o=[];Jk(o,Jf,n,Zw(n)),zk(FV,o)}}function NV(n,o,l){n==="focusin"?(d6(),zf=o,Jf=l,zf.attachEvent("onpropertychange",eR)):n==="focusout"&&d6()}function jV(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return L_(Jf)}function $V(n,o){if(n==="click")return L_(o)}function VV(n,o){if(n==="input"||n==="change")return L_(o)}function UV(n,o){return n===o&&(n!==0||1/n===1/o)||n!==n&&o!==o}var ya=typeof Object.is=="function"?Object.is:UV;function Qf(n,o){if(ya(n,o))return!0;if(typeof n!="object"||n===null||typeof o!="object"||o===null)return!1;var l=Object.keys(n),h=Object.keys(o);if(l.length!==h.length)return!1;for(h=0;h<l.length;h++){var f=l[h];if(!Kb.call(o,f)||!ya(n[f],o[f]))return!1}return!0}function f6(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function p6(n,o){var l=f6(n);n=0;for(var h;l;){if(l.nodeType===3){if(h=n+l.textContent.length,n<=o&&h>=o)return{node:l,offset:o-n};n=h}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=f6(l)}}function tR(n,o){return n&&o?n===o?!0:n&&n.nodeType===3?!1:o&&o.nodeType===3?tR(n,o.parentNode):"contains"in n?n.contains(o):n.compareDocumentPosition?!!(n.compareDocumentPosition(o)&16):!1:!1}function rR(){for(var n=window,o=L0();o instanceof n.HTMLIFrameElement;){try{var l=typeof o.contentWindow.location.href=="string"}catch{l=!1}if(l)n=o.contentWindow;else break;o=L0(n.document)}return o}function n3(n){var o=n&&n.nodeName&&n.nodeName.toLowerCase();return o&&(o==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||o==="textarea"||n.contentEditable==="true")}function GV(n){var o=rR(),l=n.focusedElem,h=n.selectionRange;if(o!==l&&l&&l.ownerDocument&&tR(l.ownerDocument.documentElement,l)){if(h!==null&&n3(l)){if(o=h.start,n=h.end,n===void 0&&(n=o),"selectionStart"in l)l.selectionStart=o,l.selectionEnd=Math.min(n,l.value.length);else if(n=(o=l.ownerDocument||document)&&o.defaultView||window,n.getSelection){n=n.getSelection();var f=l.textContent.length,g=Math.min(h.start,f);h=h.end===void 0?g:Math.min(h.end,f),!n.extend&&g>h&&(f=h,h=g,g=f),f=p6(l,g);var x=p6(l,h);f&&x&&(n.rangeCount!==1||n.anchorNode!==f.node||n.anchorOffset!==f.offset||n.focusNode!==x.node||n.focusOffset!==x.offset)&&(o=o.createRange(),o.setStart(f.node,f.offset),n.removeAllRanges(),g>h?(n.addRange(o),n.extend(x.node,x.offset)):(o.setEnd(x.node,x.offset),n.addRange(o)))}}for(o=[],n=l;n=n.parentNode;)n.nodeType===1&&o.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<o.length;l++)n=o[l],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var WV=xs&&"documentMode"in document&&11>=document.documentMode,ch=null,g2=null,Df=null,_2=!1;function m6(n,o,l){var h=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;_2||ch==null||ch!==L0(h)||(h=ch,"selectionStart"in h&&n3(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Df&&Qf(Df,h)||(Df=h,h=V0(g2,"onSelect"),0<h.length&&(o=new e3("onSelect","select",null,o,l),n.push({event:o,listeners:h}),o.target=ch)))}function Gg(n,o){var l={};return l[n.toLowerCase()]=o.toLowerCase(),l["Webkit"+n]="webkit"+o,l["Moz"+n]="moz"+o,l}var uh={animationend:Gg("Animation","AnimationEnd"),animationiteration:Gg("Animation","AnimationIteration"),animationstart:Gg("Animation","AnimationStart"),transitionend:Gg("Transition","TransitionEnd")},nb={},nR={};xs&&(nR=document.createElement("div").style,"AnimationEvent"in window||(delete uh.animationend.animation,delete uh.animationiteration.animation,delete uh.animationstart.animation),"TransitionEvent"in window||delete uh.transitionend.transition);function O_(n){if(nb[n])return nb[n];if(!uh[n])return n;var o=uh[n],l;for(l in o)if(o.hasOwnProperty(l)&&l in nR)return nb[n]=o[l];return n}var iR=O_("animationend"),oR=O_("animationiteration"),aR=O_("animationstart"),sR=O_("transitionend"),lR=new Map,g6="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ol(n,o){lR.set(n,o),Nc(o,[n])}for(var ib=0;ib<g6.length;ib++){var ob=g6[ib],HV=ob.toLowerCase(),qV=ob[0].toUpperCase()+ob.slice(1);Ol(HV,"on"+qV)}Ol(iR,"onAnimationEnd");Ol(oR,"onAnimationIteration");Ol(aR,"onAnimationStart");Ol("dblclick","onDoubleClick");Ol("focusin","onFocus");Ol("focusout","onBlur");Ol(sR,"onTransitionEnd");Rh("onMouseEnter",["mouseout","mouseover"]);Rh("onMouseLeave",["mouseout","mouseover"]);Rh("onPointerEnter",["pointerout","pointerover"]);Rh("onPointerLeave",["pointerout","pointerover"]);Nc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Nc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Nc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Nc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Nc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Nc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Af="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ZV=new Set("cancel close invalid load scroll toggle".split(" ").concat(Af));function _6(n,o,l){var h=n.type||"unknown-event";n.currentTarget=l,H$(h,o,void 0,n),n.currentTarget=null}function cR(n,o){o=(o&4)!==0;for(var l=0;l<n.length;l++){var h=n[l],f=h.event;h=h.listeners;e:{var g=void 0;if(o)for(var x=h.length-1;0<=x;x--){var E=h[x],w=E.instance,I=E.currentTarget;if(E=E.listener,w!==g&&f.isPropagationStopped())break e;_6(f,E,I),g=w}else for(x=0;x<h.length;x++){if(E=h[x],w=E.instance,I=E.currentTarget,E=E.listener,w!==g&&f.isPropagationStopped())break e;_6(f,E,I),g=w}}}if(F0)throw n=d2,F0=!1,d2=null,n}function In(n,o){var l=o[w2];l===void 0&&(l=o[w2]=new Set);var h=n+"__bubble";l.has(h)||(uR(o,n,2,!1),l.add(h))}function ab(n,o,l){var h=0;o&&(h|=4),uR(l,n,h,o)}var Wg="_reactListening"+Math.random().toString(36).slice(2);function ep(n){if(!n[Wg]){n[Wg]=!0,_k.forEach(function(l){l!=="selectionchange"&&(ZV.has(l)||ab(l,!1,n),ab(l,!0,n))});var o=n.nodeType===9?n:n.ownerDocument;o===null||o[Wg]||(o[Wg]=!0,ab("selectionchange",!1,o))}}function uR(n,o,l,h){switch(qk(o)){case 1:var f=lV;break;case 4:f=cV;break;default:f=Jw}l=f.bind(null,o,l,n),f=void 0,!h2||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(f=!0),h?f!==void 0?n.addEventListener(o,l,{capture:!0,passive:f}):n.addEventListener(o,l,!0):f!==void 0?n.addEventListener(o,l,{passive:f}):n.addEventListener(o,l,!1)}function sb(n,o,l,h,f){var g=h;if(!(o&1)&&!(o&2)&&h!==null)e:for(;;){if(h===null)return;var x=h.tag;if(x===3||x===4){var E=h.stateNode.containerInfo;if(E===f||E.nodeType===8&&E.parentNode===f)break;if(x===4)for(x=h.return;x!==null;){var w=x.tag;if((w===3||w===4)&&(w=x.stateNode.containerInfo,w===f||w.nodeType===8&&w.parentNode===f))return;x=x.return}for(;E!==null;){if(x=mc(E),x===null)return;if(w=x.tag,w===5||w===6){h=g=x;continue e}E=E.parentNode}}h=h.return}zk(function(){var I=g,R=Zw(l),D=[];e:{var F=lR.get(n);if(F!==void 0){var q=e3,G=n;switch(n){case"keypress":if(y0(l)===0)break e;case"keydown":case"keyup":q=SV;break;case"focusin":G="focus",q=eb;break;case"focusout":G="blur",q=eb;break;case"beforeblur":case"afterblur":q=eb;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":q=o6;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":q=dV;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":q=CV;break;case iR:case oR:case aR:q=mV;break;case sR:q=IV;break;case"scroll":q=uV;break;case"wheel":q=kV;break;case"copy":case"cut":case"paste":q=_V;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":q=s6}var j=(o&4)!==0,te=!j&&n==="scroll",N=j?F!==null?F+"Capture":null:F;j=[];for(var O=I,V;O!==null;){V=O;var U=V.stateNode;if(V.tag===5&&U!==null&&(V=U,N!==null&&(U=Zf(O,N),U!=null&&j.push(tp(O,U,V)))),te)break;O=O.return}0<j.length&&(F=new q(F,G,null,l,R),D.push({event:F,listeners:j}))}}if(!(o&7)){e:{if(F=n==="mouseover"||n==="pointerover",q=n==="mouseout"||n==="pointerout",F&&l!==c2&&(G=l.relatedTarget||l.fromElement)&&(mc(G)||G[bs]))break e;if((q||F)&&(F=R.window===R?R:(F=R.ownerDocument)?F.defaultView||F.parentWindow:window,q?(G=l.relatedTarget||l.toElement,q=I,G=G?mc(G):null,G!==null&&(te=jc(G),G!==te||G.tag!==5&&G.tag!==6)&&(G=null)):(q=null,G=I),q!==G)){if(j=o6,U="onMouseLeave",N="onMouseEnter",O="mouse",(n==="pointerout"||n==="pointerover")&&(j=s6,U="onPointerLeave",N="onPointerEnter",O="pointer"),te=q==null?F:hh(q),V=G==null?F:hh(G),F=new j(U,O+"leave",q,l,R),F.target=te,F.relatedTarget=V,U=null,mc(R)===I&&(j=new j(N,O+"enter",G,l,R),j.target=V,j.relatedTarget=te,U=j),te=U,q&&G)t:{for(j=q,N=G,O=0,V=j;V;V=Zu(V))O++;for(V=0,U=N;U;U=Zu(U))V++;for(;0<O-V;)j=Zu(j),O--;for(;0<V-O;)N=Zu(N),V--;for(;O--;){if(j===N||N!==null&&j===N.alternate)break t;j=Zu(j),N=Zu(N)}j=null}else j=null;q!==null&&y6(D,F,q,j,!1),G!==null&&te!==null&&y6(D,te,G,j,!0)}}e:{if(F=I?hh(I):window,q=F.nodeName&&F.nodeName.toLowerCase(),q==="select"||q==="input"&&F.type==="file")var ae=BV;else if(u6(F))if(Qk)ae=VV;else{ae=jV;var le=NV}else(q=F.nodeName)&&q.toLowerCase()==="input"&&(F.type==="checkbox"||F.type==="radio")&&(ae=$V);if(ae&&(ae=ae(n,I))){Jk(D,ae,l,R);break e}le&&le(n,F,I),n==="focusout"&&(le=F._wrapperState)&&le.controlled&&F.type==="number"&&i2(F,"number",F.value)}switch(le=I?hh(I):window,n){case"focusin":(u6(le)||le.contentEditable==="true")&&(ch=le,g2=I,Df=null);break;case"focusout":Df=g2=ch=null;break;case"mousedown":_2=!0;break;case"contextmenu":case"mouseup":case"dragend":_2=!1,m6(D,l,R);break;case"selectionchange":if(WV)break;case"keydown":case"keyup":m6(D,l,R)}var ne;if(r3)e:{switch(n){case"compositionstart":var de="onCompositionStart";break e;case"compositionend":de="onCompositionEnd";break e;case"compositionupdate":de="onCompositionUpdate";break e}de=void 0}else lh?Yk(n,l)&&(de="onCompositionEnd"):n==="keydown"&&l.keyCode===229&&(de="onCompositionStart");de&&(Xk&&l.locale!=="ko"&&(lh||de!=="onCompositionStart"?de==="onCompositionEnd"&&lh&&(ne=Zk()):(xl=R,Qw="value"in xl?xl.value:xl.textContent,lh=!0)),le=V0(I,de),0<le.length&&(de=new a6(de,n,null,l,R),D.push({event:de,listeners:le}),ne?de.data=ne:(ne=Kk(l),ne!==null&&(de.data=ne)))),(ne=zV?DV(n,l):LV(n,l))&&(I=V0(I,"onBeforeInput"),0<I.length&&(R=new a6("onBeforeInput","beforeinput",null,l,R),D.push({event:R,listeners:I}),R.data=ne))}cR(D,o)})}function tp(n,o,l){return{instance:n,listener:o,currentTarget:l}}function V0(n,o){for(var l=o+"Capture",h=[];n!==null;){var f=n,g=f.stateNode;f.tag===5&&g!==null&&(f=g,g=Zf(n,l),g!=null&&h.unshift(tp(n,g,f)),g=Zf(n,o),g!=null&&h.push(tp(n,g,f))),n=n.return}return h}function Zu(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function y6(n,o,l,h,f){for(var g=o._reactName,x=[];l!==null&&l!==h;){var E=l,w=E.alternate,I=E.stateNode;if(w!==null&&w===h)break;E.tag===5&&I!==null&&(E=I,f?(w=Zf(l,g),w!=null&&x.unshift(tp(l,w,E))):f||(w=Zf(l,g),w!=null&&x.push(tp(l,w,E)))),l=l.return}x.length!==0&&n.push({event:o,listeners:x})}var XV=/\r\n?/g,YV=/\u0000|\uFFFD/g;function v6(n){return(typeof n=="string"?n:""+n).replace(XV,`
`).replace(YV,"")}function Hg(n,o,l){if(o=v6(o),v6(n)!==o&&l)throw Error(ut(425))}function U0(){}var y2=null,v2=null;function x2(n,o){return n==="textarea"||n==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var b2=typeof setTimeout=="function"?setTimeout:void 0,KV=typeof clearTimeout=="function"?clearTimeout:void 0,x6=typeof Promise=="function"?Promise:void 0,JV=typeof queueMicrotask=="function"?queueMicrotask:typeof x6<"u"?function(n){return x6.resolve(null).then(n).catch(QV)}:b2;function QV(n){setTimeout(function(){throw n})}function lb(n,o){var l=o,h=0;do{var f=l.nextSibling;if(n.removeChild(l),f&&f.nodeType===8)if(l=f.data,l==="/$"){if(h===0){n.removeChild(f),Kf(o);return}h--}else l!=="$"&&l!=="$?"&&l!=="$!"||h++;l=f}while(l);Kf(o)}function Cl(n){for(;n!=null;n=n.nextSibling){var o=n.nodeType;if(o===1||o===3)break;if(o===8){if(o=n.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return n}function b6(n){n=n.previousSibling;for(var o=0;n;){if(n.nodeType===8){var l=n.data;if(l==="$"||l==="$!"||l==="$?"){if(o===0)return n;o--}else l==="/$"&&o++}n=n.previousSibling}return null}var Zh=Math.random().toString(36).slice(2),Na="__reactFiber$"+Zh,rp="__reactProps$"+Zh,bs="__reactContainer$"+Zh,w2="__reactEvents$"+Zh,eU="__reactListeners$"+Zh,tU="__reactHandles$"+Zh;function mc(n){var o=n[Na];if(o)return o;for(var l=n.parentNode;l;){if(o=l[bs]||l[Na]){if(l=o.alternate,o.child!==null||l!==null&&l.child!==null)for(n=b6(n);n!==null;){if(l=n[Na])return l;n=b6(n)}return o}n=l,l=n.parentNode}return null}function Ep(n){return n=n[Na]||n[bs],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function hh(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(ut(33))}function F_(n){return n[rp]||null}var E2=[],dh=-1;function Fl(n){return{current:n}}function Pn(n){0>dh||(n.current=E2[dh],E2[dh]=null,dh--)}function Cn(n,o){dh++,E2[dh]=n.current,n.current=o}var zl={},Mi=Fl(zl),Ji=Fl(!1),Ac=zl;function zh(n,o){var l=n.type.contextTypes;if(!l)return zl;var h=n.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===o)return h.__reactInternalMemoizedMaskedChildContext;var f={},g;for(g in l)f[g]=o[g];return h&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=o,n.__reactInternalMemoizedMaskedChildContext=f),f}function Qi(n){return n=n.childContextTypes,n!=null}function G0(){Pn(Ji),Pn(Mi)}function w6(n,o,l){if(Mi.current!==zl)throw Error(ut(168));Cn(Mi,o),Cn(Ji,l)}function hR(n,o,l){var h=n.stateNode;if(o=o.childContextTypes,typeof h.getChildContext!="function")return l;h=h.getChildContext();for(var f in h)if(!(f in o))throw Error(ut(108,N$(n)||"Unknown",f));return Un({},l,h)}function W0(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||zl,Ac=Mi.current,Cn(Mi,n),Cn(Ji,Ji.current),!0}function E6(n,o,l){var h=n.stateNode;if(!h)throw Error(ut(169));l?(n=hR(n,o,Ac),h.__reactInternalMemoizedMergedChildContext=n,Pn(Ji),Pn(Mi),Cn(Mi,n)):Pn(Ji),Cn(Ji,l)}var ps=null,B_=!1,cb=!1;function dR(n){ps===null?ps=[n]:ps.push(n)}function rU(n){B_=!0,dR(n)}function Bl(){if(!cb&&ps!==null){cb=!0;var n=0,o=fn;try{var l=ps;for(fn=1;n<l.length;n++){var h=l[n];do h=h(!0);while(h!==null)}ps=null,B_=!1}catch(f){throw ps!==null&&(ps=ps.slice(n+1)),Fk(Xw,Bl),f}finally{fn=o,cb=!1}}return null}var fh=[],ph=0,H0=null,q0=0,jo=[],$o=0,Ic=null,gs=1,_s="";function hc(n,o){fh[ph++]=q0,fh[ph++]=H0,H0=n,q0=o}function fR(n,o,l){jo[$o++]=gs,jo[$o++]=_s,jo[$o++]=Ic,Ic=n;var h=gs;n=_s;var f=32-ma(h)-1;h&=~(1<<f),l+=1;var g=32-ma(o)+f;if(30<g){var x=f-f%5;g=(h&(1<<x)-1).toString(32),h>>=x,f-=x,gs=1<<32-ma(o)+f|l<<f|h,_s=g+n}else gs=1<<g|l<<f|h,_s=n}function i3(n){n.return!==null&&(hc(n,1),fR(n,1,0))}function o3(n){for(;n===H0;)H0=fh[--ph],fh[ph]=null,q0=fh[--ph],fh[ph]=null;for(;n===Ic;)Ic=jo[--$o],jo[$o]=null,_s=jo[--$o],jo[$o]=null,gs=jo[--$o],jo[$o]=null}var bo=null,yo=null,Fn=!1,fa=null;function pR(n,o){var l=Vo(5,null,null,0);l.elementType="DELETED",l.stateNode=o,l.return=n,o=n.deletions,o===null?(n.deletions=[l],n.flags|=16):o.push(l)}function S6(n,o){switch(n.tag){case 5:var l=n.type;return o=o.nodeType!==1||l.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(n.stateNode=o,bo=n,yo=Cl(o.firstChild),!0):!1;case 6:return o=n.pendingProps===""||o.nodeType!==3?null:o,o!==null?(n.stateNode=o,bo=n,yo=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(l=Ic!==null?{id:gs,overflow:_s}:null,n.memoizedState={dehydrated:o,treeContext:l,retryLane:1073741824},l=Vo(18,null,null,0),l.stateNode=o,l.return=n,n.child=l,bo=n,yo=null,!0):!1;default:return!1}}function S2(n){return(n.mode&1)!==0&&(n.flags&128)===0}function T2(n){if(Fn){var o=yo;if(o){var l=o;if(!S6(n,o)){if(S2(n))throw Error(ut(418));o=Cl(l.nextSibling);var h=bo;o&&S6(n,o)?pR(h,l):(n.flags=n.flags&-4097|2,Fn=!1,bo=n)}}else{if(S2(n))throw Error(ut(418));n.flags=n.flags&-4097|2,Fn=!1,bo=n}}}function T6(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;bo=n}function qg(n){if(n!==bo)return!1;if(!Fn)return T6(n),Fn=!0,!1;var o;if((o=n.tag!==3)&&!(o=n.tag!==5)&&(o=n.type,o=o!=="head"&&o!=="body"&&!x2(n.type,n.memoizedProps)),o&&(o=yo)){if(S2(n))throw mR(),Error(ut(418));for(;o;)pR(n,o),o=Cl(o.nextSibling)}if(T6(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(ut(317));e:{for(n=n.nextSibling,o=0;n;){if(n.nodeType===8){var l=n.data;if(l==="/$"){if(o===0){yo=Cl(n.nextSibling);break e}o--}else l!=="$"&&l!=="$!"&&l!=="$?"||o++}n=n.nextSibling}yo=null}}else yo=bo?Cl(n.stateNode.nextSibling):null;return!0}function mR(){for(var n=yo;n;)n=Cl(n.nextSibling)}function Dh(){yo=bo=null,Fn=!1}function a3(n){fa===null?fa=[n]:fa.push(n)}var nU=Ms.ReactCurrentBatchConfig;function la(n,o){if(n&&n.defaultProps){o=Un({},o),n=n.defaultProps;for(var l in n)o[l]===void 0&&(o[l]=n[l]);return o}return o}var Z0=Fl(null),X0=null,mh=null,s3=null;function l3(){s3=mh=X0=null}function c3(n){var o=Z0.current;Pn(Z0),n._currentValue=o}function M2(n,o,l){for(;n!==null;){var h=n.alternate;if((n.childLanes&o)!==o?(n.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),n===l)break;n=n.return}}function Ah(n,o){X0=n,s3=mh=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&o&&(Ki=!0),n.firstContext=null)}function Go(n){var o=n._currentValue;if(s3!==n)if(n={context:n,memoizedValue:o,next:null},mh===null){if(X0===null)throw Error(ut(308));mh=n,X0.dependencies={lanes:0,firstContext:n}}else mh=mh.next=n;return o}var gc=null;function u3(n){gc===null?gc=[n]:gc.push(n)}function gR(n,o,l,h){var f=o.interleaved;return f===null?(l.next=l,u3(o)):(l.next=f.next,f.next=l),o.interleaved=l,ws(n,h)}function ws(n,o){n.lanes|=o;var l=n.alternate;for(l!==null&&(l.lanes|=o),l=n,n=n.return;n!==null;)n.childLanes|=o,l=n.alternate,l!==null&&(l.childLanes|=o),l=n,n=n.return;return l.tag===3?l.stateNode:null}var _l=!1;function h3(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function _R(n,o){n=n.updateQueue,o.updateQueue===n&&(o.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function ys(n,o){return{eventTime:n,lane:o,tag:0,payload:null,callback:null,next:null}}function Al(n,o,l){var h=n.updateQueue;if(h===null)return null;if(h=h.shared,Jr&2){var f=h.pending;return f===null?o.next=o:(o.next=f.next,f.next=o),h.pending=o,ws(n,l)}return f=h.interleaved,f===null?(o.next=o,u3(h)):(o.next=f.next,f.next=o),h.interleaved=o,ws(n,l)}function v0(n,o,l){if(o=o.updateQueue,o!==null&&(o=o.shared,(l&4194240)!==0)){var h=o.lanes;h&=n.pendingLanes,l|=h,o.lanes=l,Yw(n,l)}}function M6(n,o){var l=n.updateQueue,h=n.alternate;if(h!==null&&(h=h.updateQueue,l===h)){var f=null,g=null;if(l=l.firstBaseUpdate,l!==null){do{var x={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};g===null?f=g=x:g=g.next=x,l=l.next}while(l!==null);g===null?f=g=o:g=g.next=o}else f=g=o;l={baseState:h.baseState,firstBaseUpdate:f,lastBaseUpdate:g,shared:h.shared,effects:h.effects},n.updateQueue=l;return}n=l.lastBaseUpdate,n===null?l.firstBaseUpdate=o:n.next=o,l.lastBaseUpdate=o}function Y0(n,o,l,h){var f=n.updateQueue;_l=!1;var g=f.firstBaseUpdate,x=f.lastBaseUpdate,E=f.shared.pending;if(E!==null){f.shared.pending=null;var w=E,I=w.next;w.next=null,x===null?g=I:x.next=I,x=w;var R=n.alternate;R!==null&&(R=R.updateQueue,E=R.lastBaseUpdate,E!==x&&(E===null?R.firstBaseUpdate=I:E.next=I,R.lastBaseUpdate=w))}if(g!==null){var D=f.baseState;x=0,R=I=w=null,E=g;do{var F=E.lane,q=E.eventTime;if((h&F)===F){R!==null&&(R=R.next={eventTime:q,lane:0,tag:E.tag,payload:E.payload,callback:E.callback,next:null});e:{var G=n,j=E;switch(F=o,q=l,j.tag){case 1:if(G=j.payload,typeof G=="function"){D=G.call(q,D,F);break e}D=G;break e;case 3:G.flags=G.flags&-65537|128;case 0:if(G=j.payload,F=typeof G=="function"?G.call(q,D,F):G,F==null)break e;D=Un({},D,F);break e;case 2:_l=!0}}E.callback!==null&&E.lane!==0&&(n.flags|=64,F=f.effects,F===null?f.effects=[E]:F.push(E))}else q={eventTime:q,lane:F,tag:E.tag,payload:E.payload,callback:E.callback,next:null},R===null?(I=R=q,w=D):R=R.next=q,x|=F;if(E=E.next,E===null){if(E=f.shared.pending,E===null)break;F=E,E=F.next,F.next=null,f.lastBaseUpdate=F,f.shared.pending=null}}while(1);if(R===null&&(w=D),f.baseState=w,f.firstBaseUpdate=I,f.lastBaseUpdate=R,o=f.shared.interleaved,o!==null){f=o;do x|=f.lane,f=f.next;while(f!==o)}else g===null&&(f.shared.lanes=0);kc|=x,n.lanes=x,n.memoizedState=D}}function C6(n,o,l){if(n=o.effects,o.effects=null,n!==null)for(o=0;o<n.length;o++){var h=n[o],f=h.callback;if(f!==null){if(h.callback=null,h=l,typeof f!="function")throw Error(ut(191,f));f.call(h)}}}var yR=new gk.Component().refs;function C2(n,o,l,h){o=n.memoizedState,l=l(h,o),l=l==null?o:Un({},o,l),n.memoizedState=l,n.lanes===0&&(n.updateQueue.baseState=l)}var N_={isMounted:function(n){return(n=n._reactInternals)?jc(n)===n:!1},enqueueSetState:function(n,o,l){n=n._reactInternals;var h=Li(),f=Pl(n),g=ys(h,f);g.payload=o,l!=null&&(g.callback=l),o=Al(n,g,f),o!==null&&(ga(o,n,f,h),v0(o,n,f))},enqueueReplaceState:function(n,o,l){n=n._reactInternals;var h=Li(),f=Pl(n),g=ys(h,f);g.tag=1,g.payload=o,l!=null&&(g.callback=l),o=Al(n,g,f),o!==null&&(ga(o,n,f,h),v0(o,n,f))},enqueueForceUpdate:function(n,o){n=n._reactInternals;var l=Li(),h=Pl(n),f=ys(l,h);f.tag=2,o!=null&&(f.callback=o),o=Al(n,f,h),o!==null&&(ga(o,n,h,l),v0(o,n,h))}};function A6(n,o,l,h,f,g,x){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(h,g,x):o.prototype&&o.prototype.isPureReactComponent?!Qf(l,h)||!Qf(f,g):!0}function vR(n,o,l){var h=!1,f=zl,g=o.contextType;return typeof g=="object"&&g!==null?g=Go(g):(f=Qi(o)?Ac:Mi.current,h=o.contextTypes,g=(h=h!=null)?zh(n,f):zl),o=new o(l,g),n.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=N_,n.stateNode=o,o._reactInternals=n,h&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=f,n.__reactInternalMemoizedMaskedChildContext=g),o}function I6(n,o,l,h){n=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(l,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(l,h),o.state!==n&&N_.enqueueReplaceState(o,o.state,null)}function A2(n,o,l,h){var f=n.stateNode;f.props=l,f.state=n.memoizedState,f.refs=yR,h3(n);var g=o.contextType;typeof g=="object"&&g!==null?f.context=Go(g):(g=Qi(o)?Ac:Mi.current,f.context=zh(n,g)),f.state=n.memoizedState,g=o.getDerivedStateFromProps,typeof g=="function"&&(C2(n,o,g,l),f.state=n.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof f.getSnapshotBeforeUpdate=="function"||typeof f.UNSAFE_componentWillMount!="function"&&typeof f.componentWillMount!="function"||(o=f.state,typeof f.componentWillMount=="function"&&f.componentWillMount(),typeof f.UNSAFE_componentWillMount=="function"&&f.UNSAFE_componentWillMount(),o!==f.state&&N_.enqueueReplaceState(f,f.state,null),Y0(n,l,f,h),f.state=n.memoizedState),typeof f.componentDidMount=="function"&&(n.flags|=4194308)}function mf(n,o,l){if(n=l.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(ut(309));var h=l.stateNode}if(!h)throw Error(ut(147,n));var f=h,g=""+n;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===g?o.ref:(o=function(x){var E=f.refs;E===yR&&(E=f.refs={}),x===null?delete E[g]:E[g]=x},o._stringRef=g,o)}if(typeof n!="string")throw Error(ut(284));if(!l._owner)throw Error(ut(290,n))}return n}function Zg(n,o){throw n=Object.prototype.toString.call(o),Error(ut(31,n==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":n))}function P6(n){var o=n._init;return o(n._payload)}function xR(n){function o(N,O){if(n){var V=N.deletions;V===null?(N.deletions=[O],N.flags|=16):V.push(O)}}function l(N,O){if(!n)return null;for(;O!==null;)o(N,O),O=O.sibling;return null}function h(N,O){for(N=new Map;O!==null;)O.key!==null?N.set(O.key,O):N.set(O.index,O),O=O.sibling;return N}function f(N,O){return N=kl(N,O),N.index=0,N.sibling=null,N}function g(N,O,V){return N.index=V,n?(V=N.alternate,V!==null?(V=V.index,V<O?(N.flags|=2,O):V):(N.flags|=2,O)):(N.flags|=1048576,O)}function x(N){return n&&N.alternate===null&&(N.flags|=2),N}function E(N,O,V,U){return O===null||O.tag!==6?(O=gb(V,N.mode,U),O.return=N,O):(O=f(O,V),O.return=N,O)}function w(N,O,V,U){var ae=V.type;return ae===sh?R(N,O,V.props.children,U,V.key):O!==null&&(O.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===gl&&P6(ae)===O.type)?(U=f(O,V.props),U.ref=mf(N,O,V),U.return=N,U):(U=T0(V.type,V.key,V.props,null,N.mode,U),U.ref=mf(N,O,V),U.return=N,U)}function I(N,O,V,U){return O===null||O.tag!==4||O.stateNode.containerInfo!==V.containerInfo||O.stateNode.implementation!==V.implementation?(O=_b(V,N.mode,U),O.return=N,O):(O=f(O,V.children||[]),O.return=N,O)}function R(N,O,V,U,ae){return O===null||O.tag!==7?(O=Ec(V,N.mode,U,ae),O.return=N,O):(O=f(O,V),O.return=N,O)}function D(N,O,V){if(typeof O=="string"&&O!==""||typeof O=="number")return O=gb(""+O,N.mode,V),O.return=N,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case Fg:return V=T0(O.type,O.key,O.props,null,N.mode,V),V.ref=mf(N,null,O),V.return=N,V;case ah:return O=_b(O,N.mode,V),O.return=N,O;case gl:var U=O._init;return D(N,U(O._payload),V)}if(Mf(O)||uf(O))return O=Ec(O,N.mode,V,null),O.return=N,O;Zg(N,O)}return null}function F(N,O,V,U){var ae=O!==null?O.key:null;if(typeof V=="string"&&V!==""||typeof V=="number")return ae!==null?null:E(N,O,""+V,U);if(typeof V=="object"&&V!==null){switch(V.$$typeof){case Fg:return V.key===ae?w(N,O,V,U):null;case ah:return V.key===ae?I(N,O,V,U):null;case gl:return ae=V._init,F(N,O,ae(V._payload),U)}if(Mf(V)||uf(V))return ae!==null?null:R(N,O,V,U,null);Zg(N,V)}return null}function q(N,O,V,U,ae){if(typeof U=="string"&&U!==""||typeof U=="number")return N=N.get(V)||null,E(O,N,""+U,ae);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case Fg:return N=N.get(U.key===null?V:U.key)||null,w(O,N,U,ae);case ah:return N=N.get(U.key===null?V:U.key)||null,I(O,N,U,ae);case gl:var le=U._init;return q(N,O,V,le(U._payload),ae)}if(Mf(U)||uf(U))return N=N.get(V)||null,R(O,N,U,ae,null);Zg(O,U)}return null}function G(N,O,V,U){for(var ae=null,le=null,ne=O,de=O=0,$=null;ne!==null&&de<V.length;de++){ne.index>de?($=ne,ne=null):$=ne.sibling;var ue=F(N,ne,V[de],U);if(ue===null){ne===null&&(ne=$);break}n&&ne&&ue.alternate===null&&o(N,ne),O=g(ue,O,de),le===null?ae=ue:le.sibling=ue,le=ue,ne=$}if(de===V.length)return l(N,ne),Fn&&hc(N,de),ae;if(ne===null){for(;de<V.length;de++)ne=D(N,V[de],U),ne!==null&&(O=g(ne,O,de),le===null?ae=ne:le.sibling=ne,le=ne);return Fn&&hc(N,de),ae}for(ne=h(N,ne);de<V.length;de++)$=q(ne,N,de,V[de],U),$!==null&&(n&&$.alternate!==null&&ne.delete($.key===null?de:$.key),O=g($,O,de),le===null?ae=$:le.sibling=$,le=$);return n&&ne.forEach(function(xe){return o(N,xe)}),Fn&&hc(N,de),ae}function j(N,O,V,U){var ae=uf(V);if(typeof ae!="function")throw Error(ut(150));if(V=ae.call(V),V==null)throw Error(ut(151));for(var le=ae=null,ne=O,de=O=0,$=null,ue=V.next();ne!==null&&!ue.done;de++,ue=V.next()){ne.index>de?($=ne,ne=null):$=ne.sibling;var xe=F(N,ne,ue.value,U);if(xe===null){ne===null&&(ne=$);break}n&&ne&&xe.alternate===null&&o(N,ne),O=g(xe,O,de),le===null?ae=xe:le.sibling=xe,le=xe,ne=$}if(ue.done)return l(N,ne),Fn&&hc(N,de),ae;if(ne===null){for(;!ue.done;de++,ue=V.next())ue=D(N,ue.value,U),ue!==null&&(O=g(ue,O,de),le===null?ae=ue:le.sibling=ue,le=ue);return Fn&&hc(N,de),ae}for(ne=h(N,ne);!ue.done;de++,ue=V.next())ue=q(ne,N,de,ue.value,U),ue!==null&&(n&&ue.alternate!==null&&ne.delete(ue.key===null?de:ue.key),O=g(ue,O,de),le===null?ae=ue:le.sibling=ue,le=ue);return n&&ne.forEach(function(ce){return o(N,ce)}),Fn&&hc(N,de),ae}function te(N,O,V,U){if(typeof V=="object"&&V!==null&&V.type===sh&&V.key===null&&(V=V.props.children),typeof V=="object"&&V!==null){switch(V.$$typeof){case Fg:e:{for(var ae=V.key,le=O;le!==null;){if(le.key===ae){if(ae=V.type,ae===sh){if(le.tag===7){l(N,le.sibling),O=f(le,V.props.children),O.return=N,N=O;break e}}else if(le.elementType===ae||typeof ae=="object"&&ae!==null&&ae.$$typeof===gl&&P6(ae)===le.type){l(N,le.sibling),O=f(le,V.props),O.ref=mf(N,le,V),O.return=N,N=O;break e}l(N,le);break}else o(N,le);le=le.sibling}V.type===sh?(O=Ec(V.props.children,N.mode,U,V.key),O.return=N,N=O):(U=T0(V.type,V.key,V.props,null,N.mode,U),U.ref=mf(N,O,V),U.return=N,N=U)}return x(N);case ah:e:{for(le=V.key;O!==null;){if(O.key===le)if(O.tag===4&&O.stateNode.containerInfo===V.containerInfo&&O.stateNode.implementation===V.implementation){l(N,O.sibling),O=f(O,V.children||[]),O.return=N,N=O;break e}else{l(N,O);break}else o(N,O);O=O.sibling}O=_b(V,N.mode,U),O.return=N,N=O}return x(N);case gl:return le=V._init,te(N,O,le(V._payload),U)}if(Mf(V))return G(N,O,V,U);if(uf(V))return j(N,O,V,U);Zg(N,V)}return typeof V=="string"&&V!==""||typeof V=="number"?(V=""+V,O!==null&&O.tag===6?(l(N,O.sibling),O=f(O,V),O.return=N,N=O):(l(N,O),O=gb(V,N.mode,U),O.return=N,N=O),x(N)):l(N,O)}return te}var Lh=xR(!0),bR=xR(!1),Sp={},$a=Fl(Sp),np=Fl(Sp),ip=Fl(Sp);function _c(n){if(n===Sp)throw Error(ut(174));return n}function d3(n,o){switch(Cn(ip,o),Cn(np,n),Cn($a,Sp),n=o.nodeType,n){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:a2(null,"");break;default:n=n===8?o.parentNode:o,o=n.namespaceURI||null,n=n.tagName,o=a2(o,n)}Pn($a),Cn($a,o)}function Oh(){Pn($a),Pn(np),Pn(ip)}function wR(n){_c(ip.current);var o=_c($a.current),l=a2(o,n.type);o!==l&&(Cn(np,n),Cn($a,l))}function f3(n){np.current===n&&(Pn($a),Pn(np))}var $n=Fl(0);function K0(n){for(var o=n;o!==null;){if(o.tag===13){var l=o.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if(o.flags&128)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var ub=[];function p3(){for(var n=0;n<ub.length;n++)ub[n]._workInProgressVersionPrimary=null;ub.length=0}var x0=Ms.ReactCurrentDispatcher,hb=Ms.ReactCurrentBatchConfig,Pc=0,Vn=null,li=null,fi=null,J0=!1,Lf=!1,op=0,iU=0;function wi(){throw Error(ut(321))}function m3(n,o){if(o===null)return!1;for(var l=0;l<o.length&&l<n.length;l++)if(!ya(n[l],o[l]))return!1;return!0}function g3(n,o,l,h,f,g){if(Pc=g,Vn=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,x0.current=n===null||n.memoizedState===null?lU:cU,n=l(h,f),Lf){g=0;do{if(Lf=!1,op=0,25<=g)throw Error(ut(301));g+=1,fi=li=null,o.updateQueue=null,x0.current=uU,n=l(h,f)}while(Lf)}if(x0.current=Q0,o=li!==null&&li.next!==null,Pc=0,fi=li=Vn=null,J0=!1,o)throw Error(ut(300));return n}function _3(){var n=op!==0;return op=0,n}function Fa(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fi===null?Vn.memoizedState=fi=n:fi=fi.next=n,fi}function Wo(){if(li===null){var n=Vn.alternate;n=n!==null?n.memoizedState:null}else n=li.next;var o=fi===null?Vn.memoizedState:fi.next;if(o!==null)fi=o,li=n;else{if(n===null)throw Error(ut(310));li=n,n={memoizedState:li.memoizedState,baseState:li.baseState,baseQueue:li.baseQueue,queue:li.queue,next:null},fi===null?Vn.memoizedState=fi=n:fi=fi.next=n}return fi}function ap(n,o){return typeof o=="function"?o(n):o}function db(n){var o=Wo(),l=o.queue;if(l===null)throw Error(ut(311));l.lastRenderedReducer=n;var h=li,f=h.baseQueue,g=l.pending;if(g!==null){if(f!==null){var x=f.next;f.next=g.next,g.next=x}h.baseQueue=f=g,l.pending=null}if(f!==null){g=f.next,h=h.baseState;var E=x=null,w=null,I=g;do{var R=I.lane;if((Pc&R)===R)w!==null&&(w=w.next={lane:0,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null}),h=I.hasEagerState?I.eagerState:n(h,I.action);else{var D={lane:R,action:I.action,hasEagerState:I.hasEagerState,eagerState:I.eagerState,next:null};w===null?(E=w=D,x=h):w=w.next=D,Vn.lanes|=R,kc|=R}I=I.next}while(I!==null&&I!==g);w===null?x=h:w.next=E,ya(h,o.memoizedState)||(Ki=!0),o.memoizedState=h,o.baseState=x,o.baseQueue=w,l.lastRenderedState=h}if(n=l.interleaved,n!==null){f=n;do g=f.lane,Vn.lanes|=g,kc|=g,f=f.next;while(f!==n)}else f===null&&(l.lanes=0);return[o.memoizedState,l.dispatch]}function fb(n){var o=Wo(),l=o.queue;if(l===null)throw Error(ut(311));l.lastRenderedReducer=n;var h=l.dispatch,f=l.pending,g=o.memoizedState;if(f!==null){l.pending=null;var x=f=f.next;do g=n(g,x.action),x=x.next;while(x!==f);ya(g,o.memoizedState)||(Ki=!0),o.memoizedState=g,o.baseQueue===null&&(o.baseState=g),l.lastRenderedState=g}return[g,h]}function ER(){}function SR(n,o){var l=Vn,h=Wo(),f=o(),g=!ya(h.memoizedState,f);if(g&&(h.memoizedState=f,Ki=!0),h=h.queue,y3(CR.bind(null,l,h,n),[n]),h.getSnapshot!==o||g||fi!==null&&fi.memoizedState.tag&1){if(l.flags|=2048,sp(9,MR.bind(null,l,h,f,o),void 0,null),pi===null)throw Error(ut(349));Pc&30||TR(l,o,f)}return f}function TR(n,o,l){n.flags|=16384,n={getSnapshot:o,value:l},o=Vn.updateQueue,o===null?(o={lastEffect:null,stores:null},Vn.updateQueue=o,o.stores=[n]):(l=o.stores,l===null?o.stores=[n]:l.push(n))}function MR(n,o,l,h){o.value=l,o.getSnapshot=h,AR(o)&&IR(n)}function CR(n,o,l){return l(function(){AR(o)&&IR(n)})}function AR(n){var o=n.getSnapshot;n=n.value;try{var l=o();return!ya(n,l)}catch{return!0}}function IR(n){var o=ws(n,1);o!==null&&ga(o,n,1,-1)}function k6(n){var o=Fa();return typeof n=="function"&&(n=n()),o.memoizedState=o.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ap,lastRenderedState:n},o.queue=n,n=n.dispatch=sU.bind(null,Vn,n),[o.memoizedState,n]}function sp(n,o,l,h){return n={tag:n,create:o,destroy:l,deps:h,next:null},o=Vn.updateQueue,o===null?(o={lastEffect:null,stores:null},Vn.updateQueue=o,o.lastEffect=n.next=n):(l=o.lastEffect,l===null?o.lastEffect=n.next=n:(h=l.next,l.next=n,n.next=h,o.lastEffect=n)),n}function PR(){return Wo().memoizedState}function b0(n,o,l,h){var f=Fa();Vn.flags|=n,f.memoizedState=sp(1|o,l,void 0,h===void 0?null:h)}function j_(n,o,l,h){var f=Wo();h=h===void 0?null:h;var g=void 0;if(li!==null){var x=li.memoizedState;if(g=x.destroy,h!==null&&m3(h,x.deps)){f.memoizedState=sp(o,l,g,h);return}}Vn.flags|=n,f.memoizedState=sp(1|o,l,g,h)}function R6(n,o){return b0(8390656,8,n,o)}function y3(n,o){return j_(2048,8,n,o)}function kR(n,o){return j_(4,2,n,o)}function RR(n,o){return j_(4,4,n,o)}function zR(n,o){if(typeof o=="function")return n=n(),o(n),function(){o(null)};if(o!=null)return n=n(),o.current=n,function(){o.current=null}}function DR(n,o,l){return l=l!=null?l.concat([n]):null,j_(4,4,zR.bind(null,o,n),l)}function v3(){}function LR(n,o){var l=Wo();o=o===void 0?null:o;var h=l.memoizedState;return h!==null&&o!==null&&m3(o,h[1])?h[0]:(l.memoizedState=[n,o],n)}function OR(n,o){var l=Wo();o=o===void 0?null:o;var h=l.memoizedState;return h!==null&&o!==null&&m3(o,h[1])?h[0]:(n=n(),l.memoizedState=[n,o],n)}function FR(n,o,l){return Pc&21?(ya(l,o)||(l=jk(),Vn.lanes|=l,kc|=l,n.baseState=!0),o):(n.baseState&&(n.baseState=!1,Ki=!0),n.memoizedState=l)}function oU(n,o){var l=fn;fn=l!==0&&4>l?l:4,n(!0);var h=hb.transition;hb.transition={};try{n(!1),o()}finally{fn=l,hb.transition=h}}function BR(){return Wo().memoizedState}function aU(n,o,l){var h=Pl(n);if(l={lane:h,action:l,hasEagerState:!1,eagerState:null,next:null},NR(n))jR(o,l);else if(l=gR(n,o,l,h),l!==null){var f=Li();ga(l,n,h,f),$R(l,o,h)}}function sU(n,o,l){var h=Pl(n),f={lane:h,action:l,hasEagerState:!1,eagerState:null,next:null};if(NR(n))jR(o,f);else{var g=n.alternate;if(n.lanes===0&&(g===null||g.lanes===0)&&(g=o.lastRenderedReducer,g!==null))try{var x=o.lastRenderedState,E=g(x,l);if(f.hasEagerState=!0,f.eagerState=E,ya(E,x)){var w=o.interleaved;w===null?(f.next=f,u3(o)):(f.next=w.next,w.next=f),o.interleaved=f;return}}catch{}finally{}l=gR(n,o,f,h),l!==null&&(f=Li(),ga(l,n,h,f),$R(l,o,h))}}function NR(n){var o=n.alternate;return n===Vn||o!==null&&o===Vn}function jR(n,o){Lf=J0=!0;var l=n.pending;l===null?o.next=o:(o.next=l.next,l.next=o),n.pending=o}function $R(n,o,l){if(l&4194240){var h=o.lanes;h&=n.pendingLanes,l|=h,o.lanes=l,Yw(n,l)}}var Q0={readContext:Go,useCallback:wi,useContext:wi,useEffect:wi,useImperativeHandle:wi,useInsertionEffect:wi,useLayoutEffect:wi,useMemo:wi,useReducer:wi,useRef:wi,useState:wi,useDebugValue:wi,useDeferredValue:wi,useTransition:wi,useMutableSource:wi,useSyncExternalStore:wi,useId:wi,unstable_isNewReconciler:!1},lU={readContext:Go,useCallback:function(n,o){return Fa().memoizedState=[n,o===void 0?null:o],n},useContext:Go,useEffect:R6,useImperativeHandle:function(n,o,l){return l=l!=null?l.concat([n]):null,b0(4194308,4,zR.bind(null,o,n),l)},useLayoutEffect:function(n,o){return b0(4194308,4,n,o)},useInsertionEffect:function(n,o){return b0(4,2,n,o)},useMemo:function(n,o){var l=Fa();return o=o===void 0?null:o,n=n(),l.memoizedState=[n,o],n},useReducer:function(n,o,l){var h=Fa();return o=l!==void 0?l(o):o,h.memoizedState=h.baseState=o,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:o},h.queue=n,n=n.dispatch=aU.bind(null,Vn,n),[h.memoizedState,n]},useRef:function(n){var o=Fa();return n={current:n},o.memoizedState=n},useState:k6,useDebugValue:v3,useDeferredValue:function(n){return Fa().memoizedState=n},useTransition:function(){var n=k6(!1),o=n[0];return n=oU.bind(null,n[1]),Fa().memoizedState=n,[o,n]},useMutableSource:function(){},useSyncExternalStore:function(n,o,l){var h=Vn,f=Fa();if(Fn){if(l===void 0)throw Error(ut(407));l=l()}else{if(l=o(),pi===null)throw Error(ut(349));Pc&30||TR(h,o,l)}f.memoizedState=l;var g={value:l,getSnapshot:o};return f.queue=g,R6(CR.bind(null,h,g,n),[n]),h.flags|=2048,sp(9,MR.bind(null,h,g,l,o),void 0,null),l},useId:function(){var n=Fa(),o=pi.identifierPrefix;if(Fn){var l=_s,h=gs;l=(h&~(1<<32-ma(h)-1)).toString(32)+l,o=":"+o+"R"+l,l=op++,0<l&&(o+="H"+l.toString(32)),o+=":"}else l=iU++,o=":"+o+"r"+l.toString(32)+":";return n.memoizedState=o},unstable_isNewReconciler:!1},cU={readContext:Go,useCallback:LR,useContext:Go,useEffect:y3,useImperativeHandle:DR,useInsertionEffect:kR,useLayoutEffect:RR,useMemo:OR,useReducer:db,useRef:PR,useState:function(){return db(ap)},useDebugValue:v3,useDeferredValue:function(n){var o=Wo();return FR(o,li.memoizedState,n)},useTransition:function(){var n=db(ap)[0],o=Wo().memoizedState;return[n,o]},useMutableSource:ER,useSyncExternalStore:SR,useId:BR,unstable_isNewReconciler:!1},uU={readContext:Go,useCallback:LR,useContext:Go,useEffect:y3,useImperativeHandle:DR,useInsertionEffect:kR,useLayoutEffect:RR,useMemo:OR,useReducer:fb,useRef:PR,useState:function(){return fb(ap)},useDebugValue:v3,useDeferredValue:function(n){var o=Wo();return li===null?o.memoizedState=n:FR(o,li.memoizedState,n)},useTransition:function(){var n=fb(ap)[0],o=Wo().memoizedState;return[n,o]},useMutableSource:ER,useSyncExternalStore:SR,useId:BR,unstable_isNewReconciler:!1};function Fh(n,o){try{var l="",h=o;do l+=B$(h),h=h.return;while(h);var f=l}catch(g){f=`
Error generating stack: `+g.message+`
`+g.stack}return{value:n,source:o,stack:f,digest:null}}function pb(n,o,l){return{value:n,source:null,stack:l??null,digest:o??null}}function I2(n,o){try{console.error(o.value)}catch(l){setTimeout(function(){throw l})}}var hU=typeof WeakMap=="function"?WeakMap:Map;function VR(n,o,l){l=ys(-1,l),l.tag=3,l.payload={element:null};var h=o.value;return l.callback=function(){t_||(t_=!0,N2=h),I2(n,o)},l}function UR(n,o,l){l=ys(-1,l),l.tag=3;var h=n.type.getDerivedStateFromError;if(typeof h=="function"){var f=o.value;l.payload=function(){return h(f)},l.callback=function(){I2(n,o)}}var g=n.stateNode;return g!==null&&typeof g.componentDidCatch=="function"&&(l.callback=function(){I2(n,o),typeof h!="function"&&(Il===null?Il=new Set([this]):Il.add(this));var x=o.stack;this.componentDidCatch(o.value,{componentStack:x!==null?x:""})}),l}function z6(n,o,l){var h=n.pingCache;if(h===null){h=n.pingCache=new hU;var f=new Set;h.set(o,f)}else f=h.get(o),f===void 0&&(f=new Set,h.set(o,f));f.has(l)||(f.add(l),n=TU.bind(null,n,o,l),o.then(n,n))}function D6(n){do{var o;if((o=n.tag===13)&&(o=n.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return n;n=n.return}while(n!==null);return null}function L6(n,o,l,h,f){return n.mode&1?(n.flags|=65536,n.lanes=f,n):(n===o?n.flags|=65536:(n.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(o=ys(-1,1),o.tag=2,Al(l,o,1))),l.lanes|=1),n)}var dU=Ms.ReactCurrentOwner,Ki=!1;function zi(n,o,l,h){o.child=n===null?bR(o,null,l,h):Lh(o,n.child,l,h)}function O6(n,o,l,h,f){l=l.render;var g=o.ref;return Ah(o,f),h=g3(n,o,l,h,g,f),l=_3(),n!==null&&!Ki?(o.updateQueue=n.updateQueue,o.flags&=-2053,n.lanes&=~f,Es(n,o,f)):(Fn&&l&&i3(o),o.flags|=1,zi(n,o,h,f),o.child)}function F6(n,o,l,h,f){if(n===null){var g=l.type;return typeof g=="function"&&!C3(g)&&g.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(o.tag=15,o.type=g,GR(n,o,g,h,f)):(n=T0(l.type,null,h,o,o.mode,f),n.ref=o.ref,n.return=o,o.child=n)}if(g=n.child,!(n.lanes&f)){var x=g.memoizedProps;if(l=l.compare,l=l!==null?l:Qf,l(x,h)&&n.ref===o.ref)return Es(n,o,f)}return o.flags|=1,n=kl(g,h),n.ref=o.ref,n.return=o,o.child=n}function GR(n,o,l,h,f){if(n!==null){var g=n.memoizedProps;if(Qf(g,h)&&n.ref===o.ref)if(Ki=!1,o.pendingProps=h=g,(n.lanes&f)!==0)n.flags&131072&&(Ki=!0);else return o.lanes=n.lanes,Es(n,o,f)}return P2(n,o,l,h,f)}function WR(n,o,l){var h=o.pendingProps,f=h.children,g=n!==null?n.memoizedState:null;if(h.mode==="hidden")if(!(o.mode&1))o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cn(_h,_o),_o|=l;else{if(!(l&1073741824))return n=g!==null?g.baseLanes|l:l,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:n,cachePool:null,transitions:null},o.updateQueue=null,Cn(_h,_o),_o|=n,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=g!==null?g.baseLanes:l,Cn(_h,_o),_o|=h}else g!==null?(h=g.baseLanes|l,o.memoizedState=null):h=l,Cn(_h,_o),_o|=h;return zi(n,o,f,l),o.child}function HR(n,o){var l=o.ref;(n===null&&l!==null||n!==null&&n.ref!==l)&&(o.flags|=512,o.flags|=2097152)}function P2(n,o,l,h,f){var g=Qi(l)?Ac:Mi.current;return g=zh(o,g),Ah(o,f),l=g3(n,o,l,h,g,f),h=_3(),n!==null&&!Ki?(o.updateQueue=n.updateQueue,o.flags&=-2053,n.lanes&=~f,Es(n,o,f)):(Fn&&h&&i3(o),o.flags|=1,zi(n,o,l,f),o.child)}function B6(n,o,l,h,f){if(Qi(l)){var g=!0;W0(o)}else g=!1;if(Ah(o,f),o.stateNode===null)w0(n,o),vR(o,l,h),A2(o,l,h,f),h=!0;else if(n===null){var x=o.stateNode,E=o.memoizedProps;x.props=E;var w=x.context,I=l.contextType;typeof I=="object"&&I!==null?I=Go(I):(I=Qi(l)?Ac:Mi.current,I=zh(o,I));var R=l.getDerivedStateFromProps,D=typeof R=="function"||typeof x.getSnapshotBeforeUpdate=="function";D||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(E!==h||w!==I)&&I6(o,x,h,I),_l=!1;var F=o.memoizedState;x.state=F,Y0(o,h,x,f),w=o.memoizedState,E!==h||F!==w||Ji.current||_l?(typeof R=="function"&&(C2(o,l,R,h),w=o.memoizedState),(E=_l||A6(o,l,E,h,F,w,I))?(D||typeof x.UNSAFE_componentWillMount!="function"&&typeof x.componentWillMount!="function"||(typeof x.componentWillMount=="function"&&x.componentWillMount(),typeof x.UNSAFE_componentWillMount=="function"&&x.UNSAFE_componentWillMount()),typeof x.componentDidMount=="function"&&(o.flags|=4194308)):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=w),x.props=h,x.state=w,x.context=I,h=E):(typeof x.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{x=o.stateNode,_R(n,o),E=o.memoizedProps,I=o.type===o.elementType?E:la(o.type,E),x.props=I,D=o.pendingProps,F=x.context,w=l.contextType,typeof w=="object"&&w!==null?w=Go(w):(w=Qi(l)?Ac:Mi.current,w=zh(o,w));var q=l.getDerivedStateFromProps;(R=typeof q=="function"||typeof x.getSnapshotBeforeUpdate=="function")||typeof x.UNSAFE_componentWillReceiveProps!="function"&&typeof x.componentWillReceiveProps!="function"||(E!==D||F!==w)&&I6(o,x,h,w),_l=!1,F=o.memoizedState,x.state=F,Y0(o,h,x,f);var G=o.memoizedState;E!==D||F!==G||Ji.current||_l?(typeof q=="function"&&(C2(o,l,q,h),G=o.memoizedState),(I=_l||A6(o,l,I,h,F,G,w)||!1)?(R||typeof x.UNSAFE_componentWillUpdate!="function"&&typeof x.componentWillUpdate!="function"||(typeof x.componentWillUpdate=="function"&&x.componentWillUpdate(h,G,w),typeof x.UNSAFE_componentWillUpdate=="function"&&x.UNSAFE_componentWillUpdate(h,G,w)),typeof x.componentDidUpdate=="function"&&(o.flags|=4),typeof x.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof x.componentDidUpdate!="function"||E===n.memoizedProps&&F===n.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&F===n.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=G),x.props=h,x.state=G,x.context=w,h=I):(typeof x.componentDidUpdate!="function"||E===n.memoizedProps&&F===n.memoizedState||(o.flags|=4),typeof x.getSnapshotBeforeUpdate!="function"||E===n.memoizedProps&&F===n.memoizedState||(o.flags|=1024),h=!1)}return k2(n,o,l,h,g,f)}function k2(n,o,l,h,f,g){HR(n,o);var x=(o.flags&128)!==0;if(!h&&!x)return f&&E6(o,l,!1),Es(n,o,g);h=o.stateNode,dU.current=o;var E=x&&typeof l.getDerivedStateFromError!="function"?null:h.render();return o.flags|=1,n!==null&&x?(o.child=Lh(o,n.child,null,g),o.child=Lh(o,null,E,g)):zi(n,o,E,g),o.memoizedState=h.state,f&&E6(o,l,!0),o.child}function qR(n){var o=n.stateNode;o.pendingContext?w6(n,o.pendingContext,o.pendingContext!==o.context):o.context&&w6(n,o.context,!1),d3(n,o.containerInfo)}function N6(n,o,l,h,f){return Dh(),a3(f),o.flags|=256,zi(n,o,l,h),o.child}var R2={dehydrated:null,treeContext:null,retryLane:0};function z2(n){return{baseLanes:n,cachePool:null,transitions:null}}function ZR(n,o,l){var h=o.pendingProps,f=$n.current,g=!1,x=(o.flags&128)!==0,E;if((E=x)||(E=n!==null&&n.memoizedState===null?!1:(f&2)!==0),E?(g=!0,o.flags&=-129):(n===null||n.memoizedState!==null)&&(f|=1),Cn($n,f&1),n===null)return T2(o),n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(o.mode&1?n.data==="$!"?o.lanes=8:o.lanes=1073741824:o.lanes=1,null):(x=h.children,n=h.fallback,g?(h=o.mode,g=o.child,x={mode:"hidden",children:x},!(h&1)&&g!==null?(g.childLanes=0,g.pendingProps=x):g=U_(x,h,0,null),n=Ec(n,h,l,null),g.return=o,n.return=o,g.sibling=n,o.child=g,o.child.memoizedState=z2(l),o.memoizedState=R2,n):x3(o,x));if(f=n.memoizedState,f!==null&&(E=f.dehydrated,E!==null))return fU(n,o,x,h,E,f,l);if(g){g=h.fallback,x=o.mode,f=n.child,E=f.sibling;var w={mode:"hidden",children:h.children};return!(x&1)&&o.child!==f?(h=o.child,h.childLanes=0,h.pendingProps=w,o.deletions=null):(h=kl(f,w),h.subtreeFlags=f.subtreeFlags&14680064),E!==null?g=kl(E,g):(g=Ec(g,x,l,null),g.flags|=2),g.return=o,h.return=o,h.sibling=g,o.child=h,h=g,g=o.child,x=n.child.memoizedState,x=x===null?z2(l):{baseLanes:x.baseLanes|l,cachePool:null,transitions:x.transitions},g.memoizedState=x,g.childLanes=n.childLanes&~l,o.memoizedState=R2,h}return g=n.child,n=g.sibling,h=kl(g,{mode:"visible",children:h.children}),!(o.mode&1)&&(h.lanes=l),h.return=o,h.sibling=null,n!==null&&(l=o.deletions,l===null?(o.deletions=[n],o.flags|=16):l.push(n)),o.child=h,o.memoizedState=null,h}function x3(n,o){return o=U_({mode:"visible",children:o},n.mode,0,null),o.return=n,n.child=o}function Xg(n,o,l,h){return h!==null&&a3(h),Lh(o,n.child,null,l),n=x3(o,o.pendingProps.children),n.flags|=2,o.memoizedState=null,n}function fU(n,o,l,h,f,g,x){if(l)return o.flags&256?(o.flags&=-257,h=pb(Error(ut(422))),Xg(n,o,x,h)):o.memoizedState!==null?(o.child=n.child,o.flags|=128,null):(g=h.fallback,f=o.mode,h=U_({mode:"visible",children:h.children},f,0,null),g=Ec(g,f,x,null),g.flags|=2,h.return=o,g.return=o,h.sibling=g,o.child=h,o.mode&1&&Lh(o,n.child,null,x),o.child.memoizedState=z2(x),o.memoizedState=R2,g);if(!(o.mode&1))return Xg(n,o,x,null);if(f.data==="$!"){if(h=f.nextSibling&&f.nextSibling.dataset,h)var E=h.dgst;return h=E,g=Error(ut(419)),h=pb(g,h,void 0),Xg(n,o,x,h)}if(E=(x&n.childLanes)!==0,Ki||E){if(h=pi,h!==null){switch(x&-x){case 4:f=2;break;case 16:f=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:f=32;break;case 536870912:f=268435456;break;default:f=0}f=f&(h.suspendedLanes|x)?0:f,f!==0&&f!==g.retryLane&&(g.retryLane=f,ws(n,f),ga(h,n,f,-1))}return M3(),h=pb(Error(ut(421))),Xg(n,o,x,h)}return f.data==="$?"?(o.flags|=128,o.child=n.child,o=MU.bind(null,n),f._reactRetry=o,null):(n=g.treeContext,yo=Cl(f.nextSibling),bo=o,Fn=!0,fa=null,n!==null&&(jo[$o++]=gs,jo[$o++]=_s,jo[$o++]=Ic,gs=n.id,_s=n.overflow,Ic=o),o=x3(o,h.children),o.flags|=4096,o)}function j6(n,o,l){n.lanes|=o;var h=n.alternate;h!==null&&(h.lanes|=o),M2(n.return,o,l)}function mb(n,o,l,h,f){var g=n.memoizedState;g===null?n.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:l,tailMode:f}:(g.isBackwards=o,g.rendering=null,g.renderingStartTime=0,g.last=h,g.tail=l,g.tailMode=f)}function XR(n,o,l){var h=o.pendingProps,f=h.revealOrder,g=h.tail;if(zi(n,o,h.children,l),h=$n.current,h&2)h=h&1|2,o.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=o.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&j6(n,l,o);else if(n.tag===19)j6(n,l,o);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===o)break e;for(;n.sibling===null;){if(n.return===null||n.return===o)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}h&=1}if(Cn($n,h),!(o.mode&1))o.memoizedState=null;else switch(f){case"forwards":for(l=o.child,f=null;l!==null;)n=l.alternate,n!==null&&K0(n)===null&&(f=l),l=l.sibling;l=f,l===null?(f=o.child,o.child=null):(f=l.sibling,l.sibling=null),mb(o,!1,f,l,g);break;case"backwards":for(l=null,f=o.child,o.child=null;f!==null;){if(n=f.alternate,n!==null&&K0(n)===null){o.child=f;break}n=f.sibling,f.sibling=l,l=f,f=n}mb(o,!0,l,null,g);break;case"together":mb(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function w0(n,o){!(o.mode&1)&&n!==null&&(n.alternate=null,o.alternate=null,o.flags|=2)}function Es(n,o,l){if(n!==null&&(o.dependencies=n.dependencies),kc|=o.lanes,!(l&o.childLanes))return null;if(n!==null&&o.child!==n.child)throw Error(ut(153));if(o.child!==null){for(n=o.child,l=kl(n,n.pendingProps),o.child=l,l.return=o;n.sibling!==null;)n=n.sibling,l=l.sibling=kl(n,n.pendingProps),l.return=o;l.sibling=null}return o.child}function pU(n,o,l){switch(o.tag){case 3:qR(o),Dh();break;case 5:wR(o);break;case 1:Qi(o.type)&&W0(o);break;case 4:d3(o,o.stateNode.containerInfo);break;case 10:var h=o.type._context,f=o.memoizedProps.value;Cn(Z0,h._currentValue),h._currentValue=f;break;case 13:if(h=o.memoizedState,h!==null)return h.dehydrated!==null?(Cn($n,$n.current&1),o.flags|=128,null):l&o.child.childLanes?ZR(n,o,l):(Cn($n,$n.current&1),n=Es(n,o,l),n!==null?n.sibling:null);Cn($n,$n.current&1);break;case 19:if(h=(l&o.childLanes)!==0,n.flags&128){if(h)return XR(n,o,l);o.flags|=128}if(f=o.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),Cn($n,$n.current),h)break;return null;case 22:case 23:return o.lanes=0,WR(n,o,l)}return Es(n,o,l)}var YR,D2,KR,JR;YR=function(n,o){for(var l=o.child;l!==null;){if(l.tag===5||l.tag===6)n.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===o)break;for(;l.sibling===null;){if(l.return===null||l.return===o)return;l=l.return}l.sibling.return=l.return,l=l.sibling}};D2=function(){};KR=function(n,o,l,h){var f=n.memoizedProps;if(f!==h){n=o.stateNode,_c($a.current);var g=null;switch(l){case"input":f=r2(n,f),h=r2(n,h),g=[];break;case"select":f=Un({},f,{value:void 0}),h=Un({},h,{value:void 0}),g=[];break;case"textarea":f=o2(n,f),h=o2(n,h),g=[];break;default:typeof f.onClick!="function"&&typeof h.onClick=="function"&&(n.onclick=U0)}s2(l,h);var x;l=null;for(I in f)if(!h.hasOwnProperty(I)&&f.hasOwnProperty(I)&&f[I]!=null)if(I==="style"){var E=f[I];for(x in E)E.hasOwnProperty(x)&&(l||(l={}),l[x]="")}else I!=="dangerouslySetInnerHTML"&&I!=="children"&&I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&I!=="autoFocus"&&(Hf.hasOwnProperty(I)?g||(g=[]):(g=g||[]).push(I,null));for(I in h){var w=h[I];if(E=f!=null?f[I]:void 0,h.hasOwnProperty(I)&&w!==E&&(w!=null||E!=null))if(I==="style")if(E){for(x in E)!E.hasOwnProperty(x)||w&&w.hasOwnProperty(x)||(l||(l={}),l[x]="");for(x in w)w.hasOwnProperty(x)&&E[x]!==w[x]&&(l||(l={}),l[x]=w[x])}else l||(g||(g=[]),g.push(I,l)),l=w;else I==="dangerouslySetInnerHTML"?(w=w?w.__html:void 0,E=E?E.__html:void 0,w!=null&&E!==w&&(g=g||[]).push(I,w)):I==="children"?typeof w!="string"&&typeof w!="number"||(g=g||[]).push(I,""+w):I!=="suppressContentEditableWarning"&&I!=="suppressHydrationWarning"&&(Hf.hasOwnProperty(I)?(w!=null&&I==="onScroll"&&In("scroll",n),g||E===w||(g=[])):(g=g||[]).push(I,w))}l&&(g=g||[]).push("style",l);var I=g;(o.updateQueue=I)&&(o.flags|=4)}};JR=function(n,o,l,h){l!==h&&(o.flags|=4)};function gf(n,o){if(!Fn)switch(n.tailMode){case"hidden":o=n.tail;for(var l=null;o!==null;)o.alternate!==null&&(l=o),o=o.sibling;l===null?n.tail=null:l.sibling=null;break;case"collapsed":l=n.tail;for(var h=null;l!==null;)l.alternate!==null&&(h=l),l=l.sibling;h===null?o||n.tail===null?n.tail=null:n.tail.sibling=null:h.sibling=null}}function Ei(n){var o=n.alternate!==null&&n.alternate.child===n.child,l=0,h=0;if(o)for(var f=n.child;f!==null;)l|=f.lanes|f.childLanes,h|=f.subtreeFlags&14680064,h|=f.flags&14680064,f.return=n,f=f.sibling;else for(f=n.child;f!==null;)l|=f.lanes|f.childLanes,h|=f.subtreeFlags,h|=f.flags,f.return=n,f=f.sibling;return n.subtreeFlags|=h,n.childLanes=l,o}function mU(n,o,l){var h=o.pendingProps;switch(o3(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ei(o),null;case 1:return Qi(o.type)&&G0(),Ei(o),null;case 3:return h=o.stateNode,Oh(),Pn(Ji),Pn(Mi),p3(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(n===null||n.child===null)&&(qg(o)?o.flags|=4:n===null||n.memoizedState.isDehydrated&&!(o.flags&256)||(o.flags|=1024,fa!==null&&(V2(fa),fa=null))),D2(n,o),Ei(o),null;case 5:f3(o);var f=_c(ip.current);if(l=o.type,n!==null&&o.stateNode!=null)KR(n,o,l,h,f),n.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!h){if(o.stateNode===null)throw Error(ut(166));return Ei(o),null}if(n=_c($a.current),qg(o)){h=o.stateNode,l=o.type;var g=o.memoizedProps;switch(h[Na]=o,h[rp]=g,n=(o.mode&1)!==0,l){case"dialog":In("cancel",h),In("close",h);break;case"iframe":case"object":case"embed":In("load",h);break;case"video":case"audio":for(f=0;f<Af.length;f++)In(Af[f],h);break;case"source":In("error",h);break;case"img":case"image":case"link":In("error",h),In("load",h);break;case"details":In("toggle",h);break;case"input":XA(h,g),In("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!g.multiple},In("invalid",h);break;case"textarea":KA(h,g),In("invalid",h)}s2(l,g),f=null;for(var x in g)if(g.hasOwnProperty(x)){var E=g[x];x==="children"?typeof E=="string"?h.textContent!==E&&(g.suppressHydrationWarning!==!0&&Hg(h.textContent,E,n),f=["children",E]):typeof E=="number"&&h.textContent!==""+E&&(g.suppressHydrationWarning!==!0&&Hg(h.textContent,E,n),f=["children",""+E]):Hf.hasOwnProperty(x)&&E!=null&&x==="onScroll"&&In("scroll",h)}switch(l){case"input":Bg(h),YA(h,g,!0);break;case"textarea":Bg(h),JA(h);break;case"select":case"option":break;default:typeof g.onClick=="function"&&(h.onclick=U0)}h=f,o.updateQueue=h,h!==null&&(o.flags|=4)}else{x=f.nodeType===9?f:f.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=Tk(l)),n==="http://www.w3.org/1999/xhtml"?l==="script"?(n=x.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof h.is=="string"?n=x.createElement(l,{is:h.is}):(n=x.createElement(l),l==="select"&&(x=n,h.multiple?x.multiple=!0:h.size&&(x.size=h.size))):n=x.createElementNS(n,l),n[Na]=o,n[rp]=h,YR(n,o,!1,!1),o.stateNode=n;e:{switch(x=l2(l,h),l){case"dialog":In("cancel",n),In("close",n),f=h;break;case"iframe":case"object":case"embed":In("load",n),f=h;break;case"video":case"audio":for(f=0;f<Af.length;f++)In(Af[f],n);f=h;break;case"source":In("error",n),f=h;break;case"img":case"image":case"link":In("error",n),In("load",n),f=h;break;case"details":In("toggle",n),f=h;break;case"input":XA(n,h),f=r2(n,h),In("invalid",n);break;case"option":f=h;break;case"select":n._wrapperState={wasMultiple:!!h.multiple},f=Un({},h,{value:void 0}),In("invalid",n);break;case"textarea":KA(n,h),f=o2(n,h),In("invalid",n);break;default:f=h}s2(l,f),E=f;for(g in E)if(E.hasOwnProperty(g)){var w=E[g];g==="style"?Ak(n,w):g==="dangerouslySetInnerHTML"?(w=w?w.__html:void 0,w!=null&&Mk(n,w)):g==="children"?typeof w=="string"?(l!=="textarea"||w!=="")&&qf(n,w):typeof w=="number"&&qf(n,""+w):g!=="suppressContentEditableWarning"&&g!=="suppressHydrationWarning"&&g!=="autoFocus"&&(Hf.hasOwnProperty(g)?w!=null&&g==="onScroll"&&In("scroll",n):w!=null&&Gw(n,g,w,x))}switch(l){case"input":Bg(n),YA(n,h,!1);break;case"textarea":Bg(n),JA(n);break;case"option":h.value!=null&&n.setAttribute("value",""+Rl(h.value));break;case"select":n.multiple=!!h.multiple,g=h.value,g!=null?Sh(n,!!h.multiple,g,!1):h.defaultValue!=null&&Sh(n,!!h.multiple,h.defaultValue,!0);break;default:typeof f.onClick=="function"&&(n.onclick=U0)}switch(l){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return Ei(o),null;case 6:if(n&&o.stateNode!=null)JR(n,o,n.memoizedProps,h);else{if(typeof h!="string"&&o.stateNode===null)throw Error(ut(166));if(l=_c(ip.current),_c($a.current),qg(o)){if(h=o.stateNode,l=o.memoizedProps,h[Na]=o,(g=h.nodeValue!==l)&&(n=bo,n!==null))switch(n.tag){case 3:Hg(h.nodeValue,l,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Hg(h.nodeValue,l,(n.mode&1)!==0)}g&&(o.flags|=4)}else h=(l.nodeType===9?l:l.ownerDocument).createTextNode(h),h[Na]=o,o.stateNode=h}return Ei(o),null;case 13:if(Pn($n),h=o.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Fn&&yo!==null&&o.mode&1&&!(o.flags&128))mR(),Dh(),o.flags|=98560,g=!1;else if(g=qg(o),h!==null&&h.dehydrated!==null){if(n===null){if(!g)throw Error(ut(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(ut(317));g[Na]=o}else Dh(),!(o.flags&128)&&(o.memoizedState=null),o.flags|=4;Ei(o),g=!1}else fa!==null&&(V2(fa),fa=null),g=!0;if(!g)return o.flags&65536?o:null}return o.flags&128?(o.lanes=l,o):(h=h!==null,h!==(n!==null&&n.memoizedState!==null)&&h&&(o.child.flags|=8192,o.mode&1&&(n===null||$n.current&1?ci===0&&(ci=3):M3())),o.updateQueue!==null&&(o.flags|=4),Ei(o),null);case 4:return Oh(),D2(n,o),n===null&&ep(o.stateNode.containerInfo),Ei(o),null;case 10:return c3(o.type._context),Ei(o),null;case 17:return Qi(o.type)&&G0(),Ei(o),null;case 19:if(Pn($n),g=o.memoizedState,g===null)return Ei(o),null;if(h=(o.flags&128)!==0,x=g.rendering,x===null)if(h)gf(g,!1);else{if(ci!==0||n!==null&&n.flags&128)for(n=o.child;n!==null;){if(x=K0(n),x!==null){for(o.flags|=128,gf(g,!1),h=x.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),o.subtreeFlags=0,h=l,l=o.child;l!==null;)g=l,n=h,g.flags&=14680066,x=g.alternate,x===null?(g.childLanes=0,g.lanes=n,g.child=null,g.subtreeFlags=0,g.memoizedProps=null,g.memoizedState=null,g.updateQueue=null,g.dependencies=null,g.stateNode=null):(g.childLanes=x.childLanes,g.lanes=x.lanes,g.child=x.child,g.subtreeFlags=0,g.deletions=null,g.memoizedProps=x.memoizedProps,g.memoizedState=x.memoizedState,g.updateQueue=x.updateQueue,g.type=x.type,n=x.dependencies,g.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),l=l.sibling;return Cn($n,$n.current&1|2),o.child}n=n.sibling}g.tail!==null&&Kn()>Bh&&(o.flags|=128,h=!0,gf(g,!1),o.lanes=4194304)}else{if(!h)if(n=K0(x),n!==null){if(o.flags|=128,h=!0,l=n.updateQueue,l!==null&&(o.updateQueue=l,o.flags|=4),gf(g,!0),g.tail===null&&g.tailMode==="hidden"&&!x.alternate&&!Fn)return Ei(o),null}else 2*Kn()-g.renderingStartTime>Bh&&l!==1073741824&&(o.flags|=128,h=!0,gf(g,!1),o.lanes=4194304);g.isBackwards?(x.sibling=o.child,o.child=x):(l=g.last,l!==null?l.sibling=x:o.child=x,g.last=x)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=Kn(),o.sibling=null,l=$n.current,Cn($n,h?l&1|2:l&1),o):(Ei(o),null);case 22:case 23:return T3(),h=o.memoizedState!==null,n!==null&&n.memoizedState!==null!==h&&(o.flags|=8192),h&&o.mode&1?_o&1073741824&&(Ei(o),o.subtreeFlags&6&&(o.flags|=8192)):Ei(o),null;case 24:return null;case 25:return null}throw Error(ut(156,o.tag))}function gU(n,o){switch(o3(o),o.tag){case 1:return Qi(o.type)&&G0(),n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 3:return Oh(),Pn(Ji),Pn(Mi),p3(),n=o.flags,n&65536&&!(n&128)?(o.flags=n&-65537|128,o):null;case 5:return f3(o),null;case 13:if(Pn($n),n=o.memoizedState,n!==null&&n.dehydrated!==null){if(o.alternate===null)throw Error(ut(340));Dh()}return n=o.flags,n&65536?(o.flags=n&-65537|128,o):null;case 19:return Pn($n),null;case 4:return Oh(),null;case 10:return c3(o.type._context),null;case 22:case 23:return T3(),null;case 24:return null;default:return null}}var Yg=!1,Si=!1,_U=typeof WeakSet=="function"?WeakSet:Set,Lt=null;function gh(n,o){var l=n.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(h){Gn(n,o,h)}else l.current=null}function L2(n,o,l){try{l()}catch(h){Gn(n,o,h)}}var $6=!1;function yU(n,o){if(y2=j0,n=rR(),n3(n)){if("selectionStart"in n)var l={start:n.selectionStart,end:n.selectionEnd};else e:{l=(l=n.ownerDocument)&&l.defaultView||window;var h=l.getSelection&&l.getSelection();if(h&&h.rangeCount!==0){l=h.anchorNode;var f=h.anchorOffset,g=h.focusNode;h=h.focusOffset;try{l.nodeType,g.nodeType}catch{l=null;break e}var x=0,E=-1,w=-1,I=0,R=0,D=n,F=null;t:for(;;){for(var q;D!==l||f!==0&&D.nodeType!==3||(E=x+f),D!==g||h!==0&&D.nodeType!==3||(w=x+h),D.nodeType===3&&(x+=D.nodeValue.length),(q=D.firstChild)!==null;)F=D,D=q;for(;;){if(D===n)break t;if(F===l&&++I===f&&(E=x),F===g&&++R===h&&(w=x),(q=D.nextSibling)!==null)break;D=F,F=D.parentNode}D=q}l=E===-1||w===-1?null:{start:E,end:w}}else l=null}l=l||{start:0,end:0}}else l=null;for(v2={focusedElem:n,selectionRange:l},j0=!1,Lt=o;Lt!==null;)if(o=Lt,n=o.child,(o.subtreeFlags&1028)!==0&&n!==null)n.return=o,Lt=n;else for(;Lt!==null;){o=Lt;try{var G=o.alternate;if(o.flags&1024)switch(o.tag){case 0:case 11:case 15:break;case 1:if(G!==null){var j=G.memoizedProps,te=G.memoizedState,N=o.stateNode,O=N.getSnapshotBeforeUpdate(o.elementType===o.type?j:la(o.type,j),te);N.__reactInternalSnapshotBeforeUpdate=O}break;case 3:var V=o.stateNode.containerInfo;V.nodeType===1?V.textContent="":V.nodeType===9&&V.documentElement&&V.removeChild(V.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ut(163))}}catch(U){Gn(o,o.return,U)}if(n=o.sibling,n!==null){n.return=o.return,Lt=n;break}Lt=o.return}return G=$6,$6=!1,G}function Of(n,o,l){var h=o.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var f=h=h.next;do{if((f.tag&n)===n){var g=f.destroy;f.destroy=void 0,g!==void 0&&L2(o,l,g)}f=f.next}while(f!==h)}}function $_(n,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var l=o=o.next;do{if((l.tag&n)===n){var h=l.create;l.destroy=h()}l=l.next}while(l!==o)}}function O2(n){var o=n.ref;if(o!==null){var l=n.stateNode;switch(n.tag){case 5:n=l;break;default:n=l}typeof o=="function"?o(n):o.current=n}}function QR(n){var o=n.alternate;o!==null&&(n.alternate=null,QR(o)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(o=n.stateNode,o!==null&&(delete o[Na],delete o[rp],delete o[w2],delete o[eU],delete o[tU])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function ez(n){return n.tag===5||n.tag===3||n.tag===4}function V6(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||ez(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function F2(n,o,l){var h=n.tag;if(h===5||h===6)n=n.stateNode,o?l.nodeType===8?l.parentNode.insertBefore(n,o):l.insertBefore(n,o):(l.nodeType===8?(o=l.parentNode,o.insertBefore(n,l)):(o=l,o.appendChild(n)),l=l._reactRootContainer,l!=null||o.onclick!==null||(o.onclick=U0));else if(h!==4&&(n=n.child,n!==null))for(F2(n,o,l),n=n.sibling;n!==null;)F2(n,o,l),n=n.sibling}function B2(n,o,l){var h=n.tag;if(h===5||h===6)n=n.stateNode,o?l.insertBefore(n,o):l.appendChild(n);else if(h!==4&&(n=n.child,n!==null))for(B2(n,o,l),n=n.sibling;n!==null;)B2(n,o,l),n=n.sibling}var _i=null,ca=!1;function dl(n,o,l){for(l=l.child;l!==null;)tz(n,o,l),l=l.sibling}function tz(n,o,l){if(ja&&typeof ja.onCommitFiberUnmount=="function")try{ja.onCommitFiberUnmount(z_,l)}catch{}switch(l.tag){case 5:Si||gh(l,o);case 6:var h=_i,f=ca;_i=null,dl(n,o,l),_i=h,ca=f,_i!==null&&(ca?(n=_i,l=l.stateNode,n.nodeType===8?n.parentNode.removeChild(l):n.removeChild(l)):_i.removeChild(l.stateNode));break;case 18:_i!==null&&(ca?(n=_i,l=l.stateNode,n.nodeType===8?lb(n.parentNode,l):n.nodeType===1&&lb(n,l),Kf(n)):lb(_i,l.stateNode));break;case 4:h=_i,f=ca,_i=l.stateNode.containerInfo,ca=!0,dl(n,o,l),_i=h,ca=f;break;case 0:case 11:case 14:case 15:if(!Si&&(h=l.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){f=h=h.next;do{var g=f,x=g.destroy;g=g.tag,x!==void 0&&(g&2||g&4)&&L2(l,o,x),f=f.next}while(f!==h)}dl(n,o,l);break;case 1:if(!Si&&(gh(l,o),h=l.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=l.memoizedProps,h.state=l.memoizedState,h.componentWillUnmount()}catch(E){Gn(l,o,E)}dl(n,o,l);break;case 21:dl(n,o,l);break;case 22:l.mode&1?(Si=(h=Si)||l.memoizedState!==null,dl(n,o,l),Si=h):dl(n,o,l);break;default:dl(n,o,l)}}function U6(n){var o=n.updateQueue;if(o!==null){n.updateQueue=null;var l=n.stateNode;l===null&&(l=n.stateNode=new _U),o.forEach(function(h){var f=CU.bind(null,n,h);l.has(h)||(l.add(h),h.then(f,f))})}}function aa(n,o){var l=o.deletions;if(l!==null)for(var h=0;h<l.length;h++){var f=l[h];try{var g=n,x=o,E=x;e:for(;E!==null;){switch(E.tag){case 5:_i=E.stateNode,ca=!1;break e;case 3:_i=E.stateNode.containerInfo,ca=!0;break e;case 4:_i=E.stateNode.containerInfo,ca=!0;break e}E=E.return}if(_i===null)throw Error(ut(160));tz(g,x,f),_i=null,ca=!1;var w=f.alternate;w!==null&&(w.return=null),f.return=null}catch(I){Gn(f,o,I)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)rz(o,n),o=o.sibling}function rz(n,o){var l=n.alternate,h=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(aa(o,n),Oa(n),h&4){try{Of(3,n,n.return),$_(3,n)}catch(j){Gn(n,n.return,j)}try{Of(5,n,n.return)}catch(j){Gn(n,n.return,j)}}break;case 1:aa(o,n),Oa(n),h&512&&l!==null&&gh(l,l.return);break;case 5:if(aa(o,n),Oa(n),h&512&&l!==null&&gh(l,l.return),n.flags&32){var f=n.stateNode;try{qf(f,"")}catch(j){Gn(n,n.return,j)}}if(h&4&&(f=n.stateNode,f!=null)){var g=n.memoizedProps,x=l!==null?l.memoizedProps:g,E=n.type,w=n.updateQueue;if(n.updateQueue=null,w!==null)try{E==="input"&&g.type==="radio"&&g.name!=null&&Ek(f,g),l2(E,x);var I=l2(E,g);for(x=0;x<w.length;x+=2){var R=w[x],D=w[x+1];R==="style"?Ak(f,D):R==="dangerouslySetInnerHTML"?Mk(f,D):R==="children"?qf(f,D):Gw(f,R,D,I)}switch(E){case"input":n2(f,g);break;case"textarea":Sk(f,g);break;case"select":var F=f._wrapperState.wasMultiple;f._wrapperState.wasMultiple=!!g.multiple;var q=g.value;q!=null?Sh(f,!!g.multiple,q,!1):F!==!!g.multiple&&(g.defaultValue!=null?Sh(f,!!g.multiple,g.defaultValue,!0):Sh(f,!!g.multiple,g.multiple?[]:"",!1))}f[rp]=g}catch(j){Gn(n,n.return,j)}}break;case 6:if(aa(o,n),Oa(n),h&4){if(n.stateNode===null)throw Error(ut(162));f=n.stateNode,g=n.memoizedProps;try{f.nodeValue=g}catch(j){Gn(n,n.return,j)}}break;case 3:if(aa(o,n),Oa(n),h&4&&l!==null&&l.memoizedState.isDehydrated)try{Kf(o.containerInfo)}catch(j){Gn(n,n.return,j)}break;case 4:aa(o,n),Oa(n);break;case 13:aa(o,n),Oa(n),f=n.child,f.flags&8192&&(g=f.memoizedState!==null,f.stateNode.isHidden=g,!g||f.alternate!==null&&f.alternate.memoizedState!==null||(E3=Kn())),h&4&&U6(n);break;case 22:if(R=l!==null&&l.memoizedState!==null,n.mode&1?(Si=(I=Si)||R,aa(o,n),Si=I):aa(o,n),Oa(n),h&8192){if(I=n.memoizedState!==null,(n.stateNode.isHidden=I)&&!R&&n.mode&1)for(Lt=n,R=n.child;R!==null;){for(D=Lt=R;Lt!==null;){switch(F=Lt,q=F.child,F.tag){case 0:case 11:case 14:case 15:Of(4,F,F.return);break;case 1:gh(F,F.return);var G=F.stateNode;if(typeof G.componentWillUnmount=="function"){h=F,l=F.return;try{o=h,G.props=o.memoizedProps,G.state=o.memoizedState,G.componentWillUnmount()}catch(j){Gn(h,l,j)}}break;case 5:gh(F,F.return);break;case 22:if(F.memoizedState!==null){W6(D);continue}}q!==null?(q.return=F,Lt=q):W6(D)}R=R.sibling}e:for(R=null,D=n;;){if(D.tag===5){if(R===null){R=D;try{f=D.stateNode,I?(g=f.style,typeof g.setProperty=="function"?g.setProperty("display","none","important"):g.display="none"):(E=D.stateNode,w=D.memoizedProps.style,x=w!=null&&w.hasOwnProperty("display")?w.display:null,E.style.display=Ck("display",x))}catch(j){Gn(n,n.return,j)}}}else if(D.tag===6){if(R===null)try{D.stateNode.nodeValue=I?"":D.memoizedProps}catch(j){Gn(n,n.return,j)}}else if((D.tag!==22&&D.tag!==23||D.memoizedState===null||D===n)&&D.child!==null){D.child.return=D,D=D.child;continue}if(D===n)break e;for(;D.sibling===null;){if(D.return===null||D.return===n)break e;R===D&&(R=null),D=D.return}R===D&&(R=null),D.sibling.return=D.return,D=D.sibling}}break;case 19:aa(o,n),Oa(n),h&4&&U6(n);break;case 21:break;default:aa(o,n),Oa(n)}}function Oa(n){var o=n.flags;if(o&2){try{e:{for(var l=n.return;l!==null;){if(ez(l)){var h=l;break e}l=l.return}throw Error(ut(160))}switch(h.tag){case 5:var f=h.stateNode;h.flags&32&&(qf(f,""),h.flags&=-33);var g=V6(n);B2(n,g,f);break;case 3:case 4:var x=h.stateNode.containerInfo,E=V6(n);F2(n,E,x);break;default:throw Error(ut(161))}}catch(w){Gn(n,n.return,w)}n.flags&=-3}o&4096&&(n.flags&=-4097)}function vU(n,o,l){Lt=n,nz(n)}function nz(n,o,l){for(var h=(n.mode&1)!==0;Lt!==null;){var f=Lt,g=f.child;if(f.tag===22&&h){var x=f.memoizedState!==null||Yg;if(!x){var E=f.alternate,w=E!==null&&E.memoizedState!==null||Si;E=Yg;var I=Si;if(Yg=x,(Si=w)&&!I)for(Lt=f;Lt!==null;)x=Lt,w=x.child,x.tag===22&&x.memoizedState!==null?H6(f):w!==null?(w.return=x,Lt=w):H6(f);for(;g!==null;)Lt=g,nz(g),g=g.sibling;Lt=f,Yg=E,Si=I}G6(n)}else f.subtreeFlags&8772&&g!==null?(g.return=f,Lt=g):G6(n)}}function G6(n){for(;Lt!==null;){var o=Lt;if(o.flags&8772){var l=o.alternate;try{if(o.flags&8772)switch(o.tag){case 0:case 11:case 15:Si||$_(5,o);break;case 1:var h=o.stateNode;if(o.flags&4&&!Si)if(l===null)h.componentDidMount();else{var f=o.elementType===o.type?l.memoizedProps:la(o.type,l.memoizedProps);h.componentDidUpdate(f,l.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var g=o.updateQueue;g!==null&&C6(o,g,h);break;case 3:var x=o.updateQueue;if(x!==null){if(l=null,o.child!==null)switch(o.child.tag){case 5:l=o.child.stateNode;break;case 1:l=o.child.stateNode}C6(o,x,l)}break;case 5:var E=o.stateNode;if(l===null&&o.flags&4){l=E;var w=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":w.autoFocus&&l.focus();break;case"img":w.src&&(l.src=w.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var I=o.alternate;if(I!==null){var R=I.memoizedState;if(R!==null){var D=R.dehydrated;D!==null&&Kf(D)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ut(163))}Si||o.flags&512&&O2(o)}catch(F){Gn(o,o.return,F)}}if(o===n){Lt=null;break}if(l=o.sibling,l!==null){l.return=o.return,Lt=l;break}Lt=o.return}}function W6(n){for(;Lt!==null;){var o=Lt;if(o===n){Lt=null;break}var l=o.sibling;if(l!==null){l.return=o.return,Lt=l;break}Lt=o.return}}function H6(n){for(;Lt!==null;){var o=Lt;try{switch(o.tag){case 0:case 11:case 15:var l=o.return;try{$_(4,o)}catch(w){Gn(o,l,w)}break;case 1:var h=o.stateNode;if(typeof h.componentDidMount=="function"){var f=o.return;try{h.componentDidMount()}catch(w){Gn(o,f,w)}}var g=o.return;try{O2(o)}catch(w){Gn(o,g,w)}break;case 5:var x=o.return;try{O2(o)}catch(w){Gn(o,x,w)}}}catch(w){Gn(o,o.return,w)}if(o===n){Lt=null;break}var E=o.sibling;if(E!==null){E.return=o.return,Lt=E;break}Lt=o.return}}var xU=Math.ceil,e_=Ms.ReactCurrentDispatcher,b3=Ms.ReactCurrentOwner,Uo=Ms.ReactCurrentBatchConfig,Jr=0,pi=null,ni=null,yi=0,_o=0,_h=Fl(0),ci=0,lp=null,kc=0,V_=0,w3=0,Ff=null,Yi=null,E3=0,Bh=1/0,fs=null,t_=!1,N2=null,Il=null,Kg=!1,bl=null,r_=0,Bf=0,j2=null,E0=-1,S0=0;function Li(){return Jr&6?Kn():E0!==-1?E0:E0=Kn()}function Pl(n){return n.mode&1?Jr&2&&yi!==0?yi&-yi:nU.transition!==null?(S0===0&&(S0=jk()),S0):(n=fn,n!==0||(n=window.event,n=n===void 0?16:qk(n.type)),n):1}function ga(n,o,l,h){if(50<Bf)throw Bf=0,j2=null,Error(ut(185));bp(n,l,h),(!(Jr&2)||n!==pi)&&(n===pi&&(!(Jr&2)&&(V_|=l),ci===4&&vl(n,yi)),eo(n,h),l===1&&Jr===0&&!(o.mode&1)&&(Bh=Kn()+500,B_&&Bl()))}function eo(n,o){var l=n.callbackNode;nV(n,o);var h=N0(n,n===pi?yi:0);if(h===0)l!==null&&t6(l),n.callbackNode=null,n.callbackPriority=0;else if(o=h&-h,n.callbackPriority!==o){if(l!=null&&t6(l),o===1)n.tag===0?rU(q6.bind(null,n)):dR(q6.bind(null,n)),JV(function(){!(Jr&6)&&Bl()}),l=null;else{switch($k(h)){case 1:l=Xw;break;case 4:l=Bk;break;case 16:l=B0;break;case 536870912:l=Nk;break;default:l=B0}l=hz(l,iz.bind(null,n))}n.callbackPriority=o,n.callbackNode=l}}function iz(n,o){if(E0=-1,S0=0,Jr&6)throw Error(ut(327));var l=n.callbackNode;if(Ih()&&n.callbackNode!==l)return null;var h=N0(n,n===pi?yi:0);if(h===0)return null;if(h&30||h&n.expiredLanes||o)o=n_(n,h);else{o=h;var f=Jr;Jr|=2;var g=az();(pi!==n||yi!==o)&&(fs=null,Bh=Kn()+500,wc(n,o));do try{EU();break}catch(E){oz(n,E)}while(1);l3(),e_.current=g,Jr=f,ni!==null?o=0:(pi=null,yi=0,o=ci)}if(o!==0){if(o===2&&(f=f2(n),f!==0&&(h=f,o=$2(n,f))),o===1)throw l=lp,wc(n,0),vl(n,h),eo(n,Kn()),l;if(o===6)vl(n,h);else{if(f=n.current.alternate,!(h&30)&&!bU(f)&&(o=n_(n,h),o===2&&(g=f2(n),g!==0&&(h=g,o=$2(n,g))),o===1))throw l=lp,wc(n,0),vl(n,h),eo(n,Kn()),l;switch(n.finishedWork=f,n.finishedLanes=h,o){case 0:case 1:throw Error(ut(345));case 2:dc(n,Yi,fs);break;case 3:if(vl(n,h),(h&130023424)===h&&(o=E3+500-Kn(),10<o)){if(N0(n,0)!==0)break;if(f=n.suspendedLanes,(f&h)!==h){Li(),n.pingedLanes|=n.suspendedLanes&f;break}n.timeoutHandle=b2(dc.bind(null,n,Yi,fs),o);break}dc(n,Yi,fs);break;case 4:if(vl(n,h),(h&4194240)===h)break;for(o=n.eventTimes,f=-1;0<h;){var x=31-ma(h);g=1<<x,x=o[x],x>f&&(f=x),h&=~g}if(h=f,h=Kn()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*xU(h/1960))-h,10<h){n.timeoutHandle=b2(dc.bind(null,n,Yi,fs),h);break}dc(n,Yi,fs);break;case 5:dc(n,Yi,fs);break;default:throw Error(ut(329))}}}return eo(n,Kn()),n.callbackNode===l?iz.bind(null,n):null}function $2(n,o){var l=Ff;return n.current.memoizedState.isDehydrated&&(wc(n,o).flags|=256),n=n_(n,o),n!==2&&(o=Yi,Yi=l,o!==null&&V2(o)),n}function V2(n){Yi===null?Yi=n:Yi.push.apply(Yi,n)}function bU(n){for(var o=n;;){if(o.flags&16384){var l=o.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var h=0;h<l.length;h++){var f=l[h],g=f.getSnapshot;f=f.value;try{if(!ya(g(),f))return!1}catch{return!1}}}if(l=o.child,o.subtreeFlags&16384&&l!==null)l.return=o,o=l;else{if(o===n)break;for(;o.sibling===null;){if(o.return===null||o.return===n)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function vl(n,o){for(o&=~w3,o&=~V_,n.suspendedLanes|=o,n.pingedLanes&=~o,n=n.expirationTimes;0<o;){var l=31-ma(o),h=1<<l;n[l]=-1,o&=~h}}function q6(n){if(Jr&6)throw Error(ut(327));Ih();var o=N0(n,0);if(!(o&1))return eo(n,Kn()),null;var l=n_(n,o);if(n.tag!==0&&l===2){var h=f2(n);h!==0&&(o=h,l=$2(n,h))}if(l===1)throw l=lp,wc(n,0),vl(n,o),eo(n,Kn()),l;if(l===6)throw Error(ut(345));return n.finishedWork=n.current.alternate,n.finishedLanes=o,dc(n,Yi,fs),eo(n,Kn()),null}function S3(n,o){var l=Jr;Jr|=1;try{return n(o)}finally{Jr=l,Jr===0&&(Bh=Kn()+500,B_&&Bl())}}function Rc(n){bl!==null&&bl.tag===0&&!(Jr&6)&&Ih();var o=Jr;Jr|=1;var l=Uo.transition,h=fn;try{if(Uo.transition=null,fn=1,n)return n()}finally{fn=h,Uo.transition=l,Jr=o,!(Jr&6)&&Bl()}}function T3(){_o=_h.current,Pn(_h)}function wc(n,o){n.finishedWork=null,n.finishedLanes=0;var l=n.timeoutHandle;if(l!==-1&&(n.timeoutHandle=-1,KV(l)),ni!==null)for(l=ni.return;l!==null;){var h=l;switch(o3(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&G0();break;case 3:Oh(),Pn(Ji),Pn(Mi),p3();break;case 5:f3(h);break;case 4:Oh();break;case 13:Pn($n);break;case 19:Pn($n);break;case 10:c3(h.type._context);break;case 22:case 23:T3()}l=l.return}if(pi=n,ni=n=kl(n.current,null),yi=_o=o,ci=0,lp=null,w3=V_=kc=0,Yi=Ff=null,gc!==null){for(o=0;o<gc.length;o++)if(l=gc[o],h=l.interleaved,h!==null){l.interleaved=null;var f=h.next,g=l.pending;if(g!==null){var x=g.next;g.next=f,h.next=x}l.pending=h}gc=null}return n}function oz(n,o){do{var l=ni;try{if(l3(),x0.current=Q0,J0){for(var h=Vn.memoizedState;h!==null;){var f=h.queue;f!==null&&(f.pending=null),h=h.next}J0=!1}if(Pc=0,fi=li=Vn=null,Lf=!1,op=0,b3.current=null,l===null||l.return===null){ci=1,lp=o,ni=null;break}e:{var g=n,x=l.return,E=l,w=o;if(o=yi,E.flags|=32768,w!==null&&typeof w=="object"&&typeof w.then=="function"){var I=w,R=E,D=R.tag;if(!(R.mode&1)&&(D===0||D===11||D===15)){var F=R.alternate;F?(R.updateQueue=F.updateQueue,R.memoizedState=F.memoizedState,R.lanes=F.lanes):(R.updateQueue=null,R.memoizedState=null)}var q=D6(x);if(q!==null){q.flags&=-257,L6(q,x,E,g,o),q.mode&1&&z6(g,I,o),o=q,w=I;var G=o.updateQueue;if(G===null){var j=new Set;j.add(w),o.updateQueue=j}else G.add(w);break e}else{if(!(o&1)){z6(g,I,o),M3();break e}w=Error(ut(426))}}else if(Fn&&E.mode&1){var te=D6(x);if(te!==null){!(te.flags&65536)&&(te.flags|=256),L6(te,x,E,g,o),a3(Fh(w,E));break e}}g=w=Fh(w,E),ci!==4&&(ci=2),Ff===null?Ff=[g]:Ff.push(g),g=x;do{switch(g.tag){case 3:g.flags|=65536,o&=-o,g.lanes|=o;var N=VR(g,w,o);M6(g,N);break e;case 1:E=w;var O=g.type,V=g.stateNode;if(!(g.flags&128)&&(typeof O.getDerivedStateFromError=="function"||V!==null&&typeof V.componentDidCatch=="function"&&(Il===null||!Il.has(V)))){g.flags|=65536,o&=-o,g.lanes|=o;var U=UR(g,E,o);M6(g,U);break e}}g=g.return}while(g!==null)}lz(l)}catch(ae){o=ae,ni===l&&l!==null&&(ni=l=l.return);continue}break}while(1)}function az(){var n=e_.current;return e_.current=Q0,n===null?Q0:n}function M3(){(ci===0||ci===3||ci===2)&&(ci=4),pi===null||!(kc&268435455)&&!(V_&268435455)||vl(pi,yi)}function n_(n,o){var l=Jr;Jr|=2;var h=az();(pi!==n||yi!==o)&&(fs=null,wc(n,o));do try{wU();break}catch(f){oz(n,f)}while(1);if(l3(),Jr=l,e_.current=h,ni!==null)throw Error(ut(261));return pi=null,yi=0,ci}function wU(){for(;ni!==null;)sz(ni)}function EU(){for(;ni!==null&&!Z$();)sz(ni)}function sz(n){var o=uz(n.alternate,n,_o);n.memoizedProps=n.pendingProps,o===null?lz(n):ni=o,b3.current=null}function lz(n){var o=n;do{var l=o.alternate;if(n=o.return,o.flags&32768){if(l=gU(l,o),l!==null){l.flags&=32767,ni=l;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{ci=6,ni=null;return}}else if(l=mU(l,o,_o),l!==null){ni=l;return}if(o=o.sibling,o!==null){ni=o;return}ni=o=n}while(o!==null);ci===0&&(ci=5)}function dc(n,o,l){var h=fn,f=Uo.transition;try{Uo.transition=null,fn=1,SU(n,o,l,h)}finally{Uo.transition=f,fn=h}return null}function SU(n,o,l,h){do Ih();while(bl!==null);if(Jr&6)throw Error(ut(327));l=n.finishedWork;var f=n.finishedLanes;if(l===null)return null;if(n.finishedWork=null,n.finishedLanes=0,l===n.current)throw Error(ut(177));n.callbackNode=null,n.callbackPriority=0;var g=l.lanes|l.childLanes;if(iV(n,g),n===pi&&(ni=pi=null,yi=0),!(l.subtreeFlags&2064)&&!(l.flags&2064)||Kg||(Kg=!0,hz(B0,function(){return Ih(),null})),g=(l.flags&15990)!==0,l.subtreeFlags&15990||g){g=Uo.transition,Uo.transition=null;var x=fn;fn=1;var E=Jr;Jr|=4,b3.current=null,yU(n,l),rz(l,n),GV(v2),j0=!!y2,v2=y2=null,n.current=l,vU(l),X$(),Jr=E,fn=x,Uo.transition=g}else n.current=l;if(Kg&&(Kg=!1,bl=n,r_=f),g=n.pendingLanes,g===0&&(Il=null),J$(l.stateNode),eo(n,Kn()),o!==null)for(h=n.onRecoverableError,l=0;l<o.length;l++)f=o[l],h(f.value,{componentStack:f.stack,digest:f.digest});if(t_)throw t_=!1,n=N2,N2=null,n;return r_&1&&n.tag!==0&&Ih(),g=n.pendingLanes,g&1?n===j2?Bf++:(Bf=0,j2=n):Bf=0,Bl(),null}function Ih(){if(bl!==null){var n=$k(r_),o=Uo.transition,l=fn;try{if(Uo.transition=null,fn=16>n?16:n,bl===null)var h=!1;else{if(n=bl,bl=null,r_=0,Jr&6)throw Error(ut(331));var f=Jr;for(Jr|=4,Lt=n.current;Lt!==null;){var g=Lt,x=g.child;if(Lt.flags&16){var E=g.deletions;if(E!==null){for(var w=0;w<E.length;w++){var I=E[w];for(Lt=I;Lt!==null;){var R=Lt;switch(R.tag){case 0:case 11:case 15:Of(8,R,g)}var D=R.child;if(D!==null)D.return=R,Lt=D;else for(;Lt!==null;){R=Lt;var F=R.sibling,q=R.return;if(QR(R),R===I){Lt=null;break}if(F!==null){F.return=q,Lt=F;break}Lt=q}}}var G=g.alternate;if(G!==null){var j=G.child;if(j!==null){G.child=null;do{var te=j.sibling;j.sibling=null,j=te}while(j!==null)}}Lt=g}}if(g.subtreeFlags&2064&&x!==null)x.return=g,Lt=x;else e:for(;Lt!==null;){if(g=Lt,g.flags&2048)switch(g.tag){case 0:case 11:case 15:Of(9,g,g.return)}var N=g.sibling;if(N!==null){N.return=g.return,Lt=N;break e}Lt=g.return}}var O=n.current;for(Lt=O;Lt!==null;){x=Lt;var V=x.child;if(x.subtreeFlags&2064&&V!==null)V.return=x,Lt=V;else e:for(x=O;Lt!==null;){if(E=Lt,E.flags&2048)try{switch(E.tag){case 0:case 11:case 15:$_(9,E)}}catch(ae){Gn(E,E.return,ae)}if(E===x){Lt=null;break e}var U=E.sibling;if(U!==null){U.return=E.return,Lt=U;break e}Lt=E.return}}if(Jr=f,Bl(),ja&&typeof ja.onPostCommitFiberRoot=="function")try{ja.onPostCommitFiberRoot(z_,n)}catch{}h=!0}return h}finally{fn=l,Uo.transition=o}}return!1}function Z6(n,o,l){o=Fh(l,o),o=VR(n,o,1),n=Al(n,o,1),o=Li(),n!==null&&(bp(n,1,o),eo(n,o))}function Gn(n,o,l){if(n.tag===3)Z6(n,n,l);else for(;o!==null;){if(o.tag===3){Z6(o,n,l);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Il===null||!Il.has(h))){n=Fh(l,n),n=UR(o,n,1),o=Al(o,n,1),n=Li(),o!==null&&(bp(o,1,n),eo(o,n));break}}o=o.return}}function TU(n,o,l){var h=n.pingCache;h!==null&&h.delete(o),o=Li(),n.pingedLanes|=n.suspendedLanes&l,pi===n&&(yi&l)===l&&(ci===4||ci===3&&(yi&130023424)===yi&&500>Kn()-E3?wc(n,0):w3|=l),eo(n,o)}function cz(n,o){o===0&&(n.mode&1?(o=$g,$g<<=1,!($g&130023424)&&($g=4194304)):o=1);var l=Li();n=ws(n,o),n!==null&&(bp(n,o,l),eo(n,l))}function MU(n){var o=n.memoizedState,l=0;o!==null&&(l=o.retryLane),cz(n,l)}function CU(n,o){var l=0;switch(n.tag){case 13:var h=n.stateNode,f=n.memoizedState;f!==null&&(l=f.retryLane);break;case 19:h=n.stateNode;break;default:throw Error(ut(314))}h!==null&&h.delete(o),cz(n,l)}var uz;uz=function(n,o,l){if(n!==null)if(n.memoizedProps!==o.pendingProps||Ji.current)Ki=!0;else{if(!(n.lanes&l)&&!(o.flags&128))return Ki=!1,pU(n,o,l);Ki=!!(n.flags&131072)}else Ki=!1,Fn&&o.flags&1048576&&fR(o,q0,o.index);switch(o.lanes=0,o.tag){case 2:var h=o.type;w0(n,o),n=o.pendingProps;var f=zh(o,Mi.current);Ah(o,l),f=g3(null,o,h,n,f,l);var g=_3();return o.flags|=1,typeof f=="object"&&f!==null&&typeof f.render=="function"&&f.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,Qi(h)?(g=!0,W0(o)):g=!1,o.memoizedState=f.state!==null&&f.state!==void 0?f.state:null,h3(o),f.updater=N_,o.stateNode=f,f._reactInternals=o,A2(o,h,n,l),o=k2(null,o,h,!0,g,l)):(o.tag=0,Fn&&g&&i3(o),zi(null,o,f,l),o=o.child),o;case 16:h=o.elementType;e:{switch(w0(n,o),n=o.pendingProps,f=h._init,h=f(h._payload),o.type=h,f=o.tag=IU(h),n=la(h,n),f){case 0:o=P2(null,o,h,n,l);break e;case 1:o=B6(null,o,h,n,l);break e;case 11:o=O6(null,o,h,n,l);break e;case 14:o=F6(null,o,h,la(h.type,n),l);break e}throw Error(ut(306,h,""))}return o;case 0:return h=o.type,f=o.pendingProps,f=o.elementType===h?f:la(h,f),P2(n,o,h,f,l);case 1:return h=o.type,f=o.pendingProps,f=o.elementType===h?f:la(h,f),B6(n,o,h,f,l);case 3:e:{if(qR(o),n===null)throw Error(ut(387));h=o.pendingProps,g=o.memoizedState,f=g.element,_R(n,o),Y0(o,h,null,l);var x=o.memoizedState;if(h=x.element,g.isDehydrated)if(g={element:h,isDehydrated:!1,cache:x.cache,pendingSuspenseBoundaries:x.pendingSuspenseBoundaries,transitions:x.transitions},o.updateQueue.baseState=g,o.memoizedState=g,o.flags&256){f=Fh(Error(ut(423)),o),o=N6(n,o,h,l,f);break e}else if(h!==f){f=Fh(Error(ut(424)),o),o=N6(n,o,h,l,f);break e}else for(yo=Cl(o.stateNode.containerInfo.firstChild),bo=o,Fn=!0,fa=null,l=bR(o,null,h,l),o.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Dh(),h===f){o=Es(n,o,l);break e}zi(n,o,h,l)}o=o.child}return o;case 5:return wR(o),n===null&&T2(o),h=o.type,f=o.pendingProps,g=n!==null?n.memoizedProps:null,x=f.children,x2(h,f)?x=null:g!==null&&x2(h,g)&&(o.flags|=32),HR(n,o),zi(n,o,x,l),o.child;case 6:return n===null&&T2(o),null;case 13:return ZR(n,o,l);case 4:return d3(o,o.stateNode.containerInfo),h=o.pendingProps,n===null?o.child=Lh(o,null,h,l):zi(n,o,h,l),o.child;case 11:return h=o.type,f=o.pendingProps,f=o.elementType===h?f:la(h,f),O6(n,o,h,f,l);case 7:return zi(n,o,o.pendingProps,l),o.child;case 8:return zi(n,o,o.pendingProps.children,l),o.child;case 12:return zi(n,o,o.pendingProps.children,l),o.child;case 10:e:{if(h=o.type._context,f=o.pendingProps,g=o.memoizedProps,x=f.value,Cn(Z0,h._currentValue),h._currentValue=x,g!==null)if(ya(g.value,x)){if(g.children===f.children&&!Ji.current){o=Es(n,o,l);break e}}else for(g=o.child,g!==null&&(g.return=o);g!==null;){var E=g.dependencies;if(E!==null){x=g.child;for(var w=E.firstContext;w!==null;){if(w.context===h){if(g.tag===1){w=ys(-1,l&-l),w.tag=2;var I=g.updateQueue;if(I!==null){I=I.shared;var R=I.pending;R===null?w.next=w:(w.next=R.next,R.next=w),I.pending=w}}g.lanes|=l,w=g.alternate,w!==null&&(w.lanes|=l),M2(g.return,l,o),E.lanes|=l;break}w=w.next}}else if(g.tag===10)x=g.type===o.type?null:g.child;else if(g.tag===18){if(x=g.return,x===null)throw Error(ut(341));x.lanes|=l,E=x.alternate,E!==null&&(E.lanes|=l),M2(x,l,o),x=g.sibling}else x=g.child;if(x!==null)x.return=g;else for(x=g;x!==null;){if(x===o){x=null;break}if(g=x.sibling,g!==null){g.return=x.return,x=g;break}x=x.return}g=x}zi(n,o,f.children,l),o=o.child}return o;case 9:return f=o.type,h=o.pendingProps.children,Ah(o,l),f=Go(f),h=h(f),o.flags|=1,zi(n,o,h,l),o.child;case 14:return h=o.type,f=la(h,o.pendingProps),f=la(h.type,f),F6(n,o,h,f,l);case 15:return GR(n,o,o.type,o.pendingProps,l);case 17:return h=o.type,f=o.pendingProps,f=o.elementType===h?f:la(h,f),w0(n,o),o.tag=1,Qi(h)?(n=!0,W0(o)):n=!1,Ah(o,l),vR(o,h,f),A2(o,h,f,l),k2(null,o,h,!0,n,l);case 19:return XR(n,o,l);case 22:return WR(n,o,l)}throw Error(ut(156,o.tag))};function hz(n,o){return Fk(n,o)}function AU(n,o,l,h){this.tag=n,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vo(n,o,l,h){return new AU(n,o,l,h)}function C3(n){return n=n.prototype,!(!n||!n.isReactComponent)}function IU(n){if(typeof n=="function")return C3(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Hw)return 11;if(n===qw)return 14}return 2}function kl(n,o){var l=n.alternate;return l===null?(l=Vo(n.tag,o,n.key,n.mode),l.elementType=n.elementType,l.type=n.type,l.stateNode=n.stateNode,l.alternate=n,n.alternate=l):(l.pendingProps=o,l.type=n.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=n.flags&14680064,l.childLanes=n.childLanes,l.lanes=n.lanes,l.child=n.child,l.memoizedProps=n.memoizedProps,l.memoizedState=n.memoizedState,l.updateQueue=n.updateQueue,o=n.dependencies,l.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},l.sibling=n.sibling,l.index=n.index,l.ref=n.ref,l}function T0(n,o,l,h,f,g){var x=2;if(h=n,typeof n=="function")C3(n)&&(x=1);else if(typeof n=="string")x=5;else e:switch(n){case sh:return Ec(l.children,f,g,o);case Ww:x=8,f|=8;break;case Jb:return n=Vo(12,l,o,f|2),n.elementType=Jb,n.lanes=g,n;case Qb:return n=Vo(13,l,o,f),n.elementType=Qb,n.lanes=g,n;case e2:return n=Vo(19,l,o,f),n.elementType=e2,n.lanes=g,n;case xk:return U_(l,f,g,o);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case yk:x=10;break e;case vk:x=9;break e;case Hw:x=11;break e;case qw:x=14;break e;case gl:x=16,h=null;break e}throw Error(ut(130,n==null?n:typeof n,""))}return o=Vo(x,l,o,f),o.elementType=n,o.type=h,o.lanes=g,o}function Ec(n,o,l,h){return n=Vo(7,n,h,o),n.lanes=l,n}function U_(n,o,l,h){return n=Vo(22,n,h,o),n.elementType=xk,n.lanes=l,n.stateNode={isHidden:!1},n}function gb(n,o,l){return n=Vo(6,n,null,o),n.lanes=l,n}function _b(n,o,l){return o=Vo(4,n.children!==null?n.children:[],n.key,o),o.lanes=l,o.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},o}function PU(n,o,l,h,f){this.tag=o,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kx(0),this.expirationTimes=Kx(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kx(0),this.identifierPrefix=h,this.onRecoverableError=f,this.mutableSourceEagerHydrationData=null}function A3(n,o,l,h,f,g,x,E,w){return n=new PU(n,o,l,E,w),o===1?(o=1,g===!0&&(o|=8)):o=0,g=Vo(3,null,null,o),n.current=g,g.stateNode=n,g.memoizedState={element:h,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},h3(g),n}function kU(n,o,l){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ah,key:h==null?null:""+h,children:n,containerInfo:o,implementation:l}}function dz(n){if(!n)return zl;n=n._reactInternals;e:{if(jc(n)!==n||n.tag!==1)throw Error(ut(170));var o=n;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(Qi(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(ut(171))}if(n.tag===1){var l=n.type;if(Qi(l))return hR(n,l,o)}return o}function fz(n,o,l,h,f,g,x,E,w){return n=A3(l,h,!0,n,f,g,x,E,w),n.context=dz(null),l=n.current,h=Li(),f=Pl(l),g=ys(h,f),g.callback=o??null,Al(l,g,f),n.current.lanes=f,bp(n,f,h),eo(n,h),n}function G_(n,o,l,h){var f=o.current,g=Li(),x=Pl(f);return l=dz(l),o.context===null?o.context=l:o.pendingContext=l,o=ys(g,x),o.payload={element:n},h=h===void 0?null:h,h!==null&&(o.callback=h),n=Al(f,o,x),n!==null&&(ga(n,f,x,g),v0(n,f,x)),x}function i_(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function X6(n,o){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var l=n.retryLane;n.retryLane=l!==0&&l<o?l:o}}function I3(n,o){X6(n,o),(n=n.alternate)&&X6(n,o)}function RU(){return null}var pz=typeof reportError=="function"?reportError:function(n){console.error(n)};function P3(n){this._internalRoot=n}W_.prototype.render=P3.prototype.render=function(n){var o=this._internalRoot;if(o===null)throw Error(ut(409));G_(n,o,null,null)};W_.prototype.unmount=P3.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var o=n.containerInfo;Rc(function(){G_(null,n,null,null)}),o[bs]=null}};function W_(n){this._internalRoot=n}W_.prototype.unstable_scheduleHydration=function(n){if(n){var o=Gk();n={blockedOn:null,target:n,priority:o};for(var l=0;l<yl.length&&o!==0&&o<yl[l].priority;l++);yl.splice(l,0,n),l===0&&Hk(n)}};function k3(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function H_(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Y6(){}function zU(n,o,l,h,f){if(f){if(typeof h=="function"){var g=h;h=function(){var I=i_(x);g.call(I)}}var x=fz(o,h,n,0,null,!1,!1,"",Y6);return n._reactRootContainer=x,n[bs]=x.current,ep(n.nodeType===8?n.parentNode:n),Rc(),x}for(;f=n.lastChild;)n.removeChild(f);if(typeof h=="function"){var E=h;h=function(){var I=i_(w);E.call(I)}}var w=A3(n,0,!1,null,null,!1,!1,"",Y6);return n._reactRootContainer=w,n[bs]=w.current,ep(n.nodeType===8?n.parentNode:n),Rc(function(){G_(o,w,l,h)}),w}function q_(n,o,l,h,f){var g=l._reactRootContainer;if(g){var x=g;if(typeof f=="function"){var E=f;f=function(){var w=i_(x);E.call(w)}}G_(o,x,n,f)}else x=zU(l,o,n,f,h);return i_(x)}Vk=function(n){switch(n.tag){case 3:var o=n.stateNode;if(o.current.memoizedState.isDehydrated){var l=Cf(o.pendingLanes);l!==0&&(Yw(o,l|1),eo(o,Kn()),!(Jr&6)&&(Bh=Kn()+500,Bl()))}break;case 13:Rc(function(){var h=ws(n,1);if(h!==null){var f=Li();ga(h,n,1,f)}}),I3(n,1)}};Kw=function(n){if(n.tag===13){var o=ws(n,134217728);if(o!==null){var l=Li();ga(o,n,134217728,l)}I3(n,134217728)}};Uk=function(n){if(n.tag===13){var o=Pl(n),l=ws(n,o);if(l!==null){var h=Li();ga(l,n,o,h)}I3(n,o)}};Gk=function(){return fn};Wk=function(n,o){var l=fn;try{return fn=n,o()}finally{fn=l}};u2=function(n,o,l){switch(o){case"input":if(n2(n,l),o=l.name,l.type==="radio"&&o!=null){for(l=n;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<l.length;o++){var h=l[o];if(h!==n&&h.form===n.form){var f=F_(h);if(!f)throw Error(ut(90));wk(h),n2(h,f)}}}break;case"textarea":Sk(n,l);break;case"select":o=l.value,o!=null&&Sh(n,!!l.multiple,o,!1)}};kk=S3;Rk=Rc;var DU={usingClientEntryPoint:!1,Events:[Ep,hh,F_,Ik,Pk,S3]},_f={findFiberByHostInstance:mc,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},LU={bundleType:_f.bundleType,version:_f.version,rendererPackageName:_f.rendererPackageName,rendererConfig:_f.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ms.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=Lk(n),n===null?null:n.stateNode},findFiberByHostInstance:_f.findFiberByHostInstance||RU,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jg.isDisabled&&Jg.supportsFiber)try{z_=Jg.inject(LU),ja=Jg}catch{}}To.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DU;To.createPortal=function(n,o){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!k3(o))throw Error(ut(200));return kU(n,o,null,l)};To.createRoot=function(n,o){if(!k3(n))throw Error(ut(299));var l=!1,h="",f=pz;return o!=null&&(o.unstable_strictMode===!0&&(l=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onRecoverableError!==void 0&&(f=o.onRecoverableError)),o=A3(n,1,!1,null,null,l,!1,h,f),n[bs]=o.current,ep(n.nodeType===8?n.parentNode:n),new P3(o)};To.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var o=n._reactInternals;if(o===void 0)throw typeof n.render=="function"?Error(ut(188)):(n=Object.keys(n).join(","),Error(ut(268,n)));return n=Lk(o),n=n===null?null:n.stateNode,n};To.flushSync=function(n){return Rc(n)};To.hydrate=function(n,o,l){if(!H_(o))throw Error(ut(200));return q_(null,n,o,!0,l)};To.hydrateRoot=function(n,o,l){if(!k3(n))throw Error(ut(405));var h=l!=null&&l.hydratedSources||null,f=!1,g="",x=pz;if(l!=null&&(l.unstable_strictMode===!0&&(f=!0),l.identifierPrefix!==void 0&&(g=l.identifierPrefix),l.onRecoverableError!==void 0&&(x=l.onRecoverableError)),o=fz(o,null,n,1,l??null,f,!1,g,x),n[bs]=o.current,ep(n),h)for(n=0;n<h.length;n++)l=h[n],f=l._getVersion,f=f(l._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[l,f]:o.mutableSourceEagerHydrationData.push(l,f);return new W_(o)};To.render=function(n,o,l){if(!H_(o))throw Error(ut(200));return q_(null,n,o,!1,l)};To.unmountComponentAtNode=function(n){if(!H_(n))throw Error(ut(40));return n._reactRootContainer?(Rc(function(){q_(null,null,n,!1,function(){n._reactRootContainer=null,n[bs]=null})}),!0):!1};To.unstable_batchedUpdates=S3;To.unstable_renderSubtreeIntoContainer=function(n,o,l,h){if(!H_(l))throw Error(ut(200));if(n==null||n._reactInternals===void 0)throw Error(ut(38));return q_(n,o,l,!1,h)};To.version="18.2.0-next-9e3b772b8-20220608";function mz(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(mz)}catch(n){console.error(n)}}mz(),fk.exports=To;var Tp=fk.exports;const gz=Gh(Tp),OU=XP({__proto__:null,default:gz},[Tp]);function o_(n){return n instanceof HTMLElement||n instanceof SVGElement}function U2(n){return o_(n)?n:n instanceof xn.Component?gz.findDOMNode(n):null}var _z=function(){if(typeof Map<"u")return Map;function n(o,l){var h=-1;return o.some(function(f,g){return f[0]===l?(h=g,!0):!1}),h}return function(){function o(){this.__entries__=[]}return Object.defineProperty(o.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),o.prototype.get=function(l){var h=n(this.__entries__,l),f=this.__entries__[h];return f&&f[1]},o.prototype.set=function(l,h){var f=n(this.__entries__,l);~f?this.__entries__[f][1]=h:this.__entries__.push([l,h])},o.prototype.delete=function(l){var h=this.__entries__,f=n(h,l);~f&&h.splice(f,1)},o.prototype.has=function(l){return!!~n(this.__entries__,l)},o.prototype.clear=function(){this.__entries__.splice(0)},o.prototype.forEach=function(l,h){h===void 0&&(h=null);for(var f=0,g=this.__entries__;f<g.length;f++){var x=g[f];l.call(h,x[1],x[0])}},o}()}(),G2=typeof window<"u"&&typeof document<"u"&&window.document===document,a_=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),FU=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(a_):function(n){return setTimeout(function(){return n(Date.now())},1e3/60)}}(),BU=2;function NU(n,o){var l=!1,h=!1,f=0;function g(){l&&(l=!1,n()),h&&E()}function x(){FU(g)}function E(){var w=Date.now();if(l){if(w-f<BU)return;h=!0}else l=!0,h=!1,setTimeout(x,o);f=w}return E}var jU=20,$U=["top","right","bottom","left","width","height","size","weight"],VU=typeof MutationObserver<"u",UU=function(){function n(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=NU(this.refresh.bind(this),jU)}return n.prototype.addObserver=function(o){~this.observers_.indexOf(o)||this.observers_.push(o),this.connected_||this.connect_()},n.prototype.removeObserver=function(o){var l=this.observers_,h=l.indexOf(o);~h&&l.splice(h,1),!l.length&&this.connected_&&this.disconnect_()},n.prototype.refresh=function(){var o=this.updateObservers_();o&&this.refresh()},n.prototype.updateObservers_=function(){var o=this.observers_.filter(function(l){return l.gatherActive(),l.hasActive()});return o.forEach(function(l){return l.broadcastActive()}),o.length>0},n.prototype.connect_=function(){!G2||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),VU?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},n.prototype.disconnect_=function(){!G2||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},n.prototype.onTransitionEnd_=function(o){var l=o.propertyName,h=l===void 0?"":l,f=$U.some(function(g){return!!~h.indexOf(g)});f&&this.refresh()},n.getInstance=function(){return this.instance_||(this.instance_=new n),this.instance_},n.instance_=null,n}(),yz=function(n,o){for(var l=0,h=Object.keys(o);l<h.length;l++){var f=h[l];Object.defineProperty(n,f,{value:o[f],enumerable:!1,writable:!1,configurable:!0})}return n},Nh=function(n){var o=n&&n.ownerDocument&&n.ownerDocument.defaultView;return o||a_},vz=Z_(0,0,0,0);function s_(n){return parseFloat(n)||0}function K6(n){for(var o=[],l=1;l<arguments.length;l++)o[l-1]=arguments[l];return o.reduce(function(h,f){var g=n["border-"+f+"-width"];return h+s_(g)},0)}function GU(n){for(var o=["top","right","bottom","left"],l={},h=0,f=o;h<f.length;h++){var g=f[h],x=n["padding-"+g];l[g]=s_(x)}return l}function WU(n){var o=n.getBBox();return Z_(0,0,o.width,o.height)}function HU(n){var o=n.clientWidth,l=n.clientHeight;if(!o&&!l)return vz;var h=Nh(n).getComputedStyle(n),f=GU(h),g=f.left+f.right,x=f.top+f.bottom,E=s_(h.width),w=s_(h.height);if(h.boxSizing==="border-box"&&(Math.round(E+g)!==o&&(E-=K6(h,"left","right")+g),Math.round(w+x)!==l&&(w-=K6(h,"top","bottom")+x)),!ZU(n)){var I=Math.round(E+g)-o,R=Math.round(w+x)-l;Math.abs(I)!==1&&(E-=I),Math.abs(R)!==1&&(w-=R)}return Z_(f.left,f.top,E,w)}var qU=function(){return typeof SVGGraphicsElement<"u"?function(n){return n instanceof Nh(n).SVGGraphicsElement}:function(n){return n instanceof Nh(n).SVGElement&&typeof n.getBBox=="function"}}();function ZU(n){return n===Nh(n).document.documentElement}function XU(n){return G2?qU(n)?WU(n):HU(n):vz}function YU(n){var o=n.x,l=n.y,h=n.width,f=n.height,g=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,x=Object.create(g.prototype);return yz(x,{x:o,y:l,width:h,height:f,top:l,right:o+h,bottom:f+l,left:o}),x}function Z_(n,o,l,h){return{x:n,y:o,width:l,height:h}}var KU=function(){function n(o){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Z_(0,0,0,0),this.target=o}return n.prototype.isActive=function(){var o=XU(this.target);return this.contentRect_=o,o.width!==this.broadcastWidth||o.height!==this.broadcastHeight},n.prototype.broadcastRect=function(){var o=this.contentRect_;return this.broadcastWidth=o.width,this.broadcastHeight=o.height,o},n}(),JU=function(){function n(o,l){var h=YU(l);yz(this,{target:o,contentRect:h})}return n}(),QU=function(){function n(o,l,h){if(this.activeObservations_=[],this.observations_=new _z,typeof o!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=o,this.controller_=l,this.callbackCtx_=h}return n.prototype.observe=function(o){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(o instanceof Nh(o).Element))throw new TypeError('parameter 1 is not of type "Element".');var l=this.observations_;l.has(o)||(l.set(o,new KU(o)),this.controller_.addObserver(this),this.controller_.refresh())}},n.prototype.unobserve=function(o){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(o instanceof Nh(o).Element))throw new TypeError('parameter 1 is not of type "Element".');var l=this.observations_;l.has(o)&&(l.delete(o),l.size||this.controller_.removeObserver(this))}},n.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},n.prototype.gatherActive=function(){var o=this;this.clearActive(),this.observations_.forEach(function(l){l.isActive()&&o.activeObservations_.push(l)})},n.prototype.broadcastActive=function(){if(this.hasActive()){var o=this.callbackCtx_,l=this.activeObservations_.map(function(h){return new JU(h.target,h.broadcastRect())});this.callback_.call(o,l,o),this.clearActive()}},n.prototype.clearActive=function(){this.activeObservations_.splice(0)},n.prototype.hasActive=function(){return this.activeObservations_.length>0},n}(),xz=typeof WeakMap<"u"?new WeakMap:new _z,bz=function(){function n(o){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var l=UU.getInstance(),h=new QU(o,l,this);xz.set(this,h)}return n}();["observe","unobserve","disconnect"].forEach(function(n){bz.prototype[n]=function(){var o;return(o=xz.get(this))[n].apply(o,arguments)}});var eG=function(){return typeof a_.ResizeObserver<"u"?a_.ResizeObserver:bz}(),wl=new Map;function tG(n){n.forEach(function(o){var l,h=o.target;(l=wl.get(h))===null||l===void 0||l.forEach(function(f){return f(h)})})}var wz=new eG(tG);function rG(n,o){wl.has(n)||(wl.set(n,new Set),wz.observe(n)),wl.get(n).add(o)}function nG(n,o){wl.has(n)&&(wl.get(n).delete(o),wl.get(n).size||(wz.unobserve(n),wl.delete(n)))}var iG=function(n){b_(l,n);var o=w_(l);function l(){return Va(this,l),o.apply(this,arguments)}return Ua(l,[{key:"render",value:function(){return this.props.children}}]),l}(A.Component),W2=A.createContext(null);function oG(n){var o=n.children,l=n.onBatchResize,h=A.useRef(0),f=A.useRef([]),g=A.useContext(W2),x=A.useCallback(function(E,w,I){h.current+=1;var R=h.current;f.current.push({size:E,element:w,data:I}),Promise.resolve().then(function(){R===h.current&&(l==null||l(f.current),f.current=[])}),g==null||g(E,w,I)},[l,g]);return A.createElement(W2.Provider,{value:x},o)}function aG(n,o){var l=n.children,h=n.disabled,f=A.useRef(null),g=A.useRef(null),x=A.useContext(W2),E=typeof l=="function",w=E?l(f):l,I=A.useRef({width:-1,height:-1,offsetWidth:-1,offsetHeight:-1}),R=!E&&A.isValidElement(w)&&Hh(w),D=R?w.ref:null,F=A.useMemo(function(){return Bc(D,f)},[D,f]),q=function(){return U2(f.current)||U2(g.current)};A.useImperativeHandle(o,function(){return q()});var G=A.useRef(n);G.current=n;var j=A.useCallback(function(te){var N=G.current,O=N.onResize,V=N.data,U=te.getBoundingClientRect(),ae=U.width,le=U.height,ne=te.offsetWidth,de=te.offsetHeight,$=Math.floor(ae),ue=Math.floor(le);if(I.current.width!==$||I.current.height!==ue||I.current.offsetWidth!==ne||I.current.offsetHeight!==de){var xe={width:$,height:ue,offsetWidth:ne,offsetHeight:de};I.current=xe;var ce=ne===Math.round(ae)?ae:ne,se=de===Math.round(le)?le:de,ke=ft(ft({},xe),{},{offsetWidth:ce,offsetHeight:se});x==null||x(ke,te,V),O&&Promise.resolve().then(function(){O(ke,te)})}},[]);return A.useEffect(function(){var te=q();return te&&!h&&rG(te,j),function(){return nG(te,j)}},[f.current,h]),A.createElement(iG,{ref:g},R?A.cloneElement(w,{ref:F}):w)}var sG=A.forwardRef(aG),lG="rc-observer-key";function cG(n,o){var l=n.children,h=typeof l=="function"?[l]:Wf(l);return h.map(function(f,g){var x=(f==null?void 0:f.key)||"".concat(lG,"-").concat(g);return A.createElement(sG,ui({},n,{key:x,ref:g===0?o:void 0}),f)})}var R3=A.forwardRef(cG);R3.Collection=oG;function $c(n,o){var l=ft({},n);return Array.isArray(o)&&o.forEach(function(h){delete l[h]}),l}function H2(n,o){(o==null||o>n.length)&&(o=n.length);for(var l=0,h=new Array(o);l<o;l++)h[l]=n[l];return h}function uG(n){if(Array.isArray(n))return H2(n)}function Ez(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function z3(n,o){if(n){if(typeof n=="string")return H2(n,o);var l=Object.prototype.toString.call(n).slice(8,-1);if(l==="Object"&&n.constructor&&(l=n.constructor.name),l==="Map"||l==="Set")return Array.from(n);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return H2(n,o)}}function hG(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Jt(n){return uG(n)||Ez(n)||z3(n)||hG()}var Sz=function(o){return+setTimeout(o,16)},Tz=function(o){return clearTimeout(o)};typeof window<"u"&&"requestAnimationFrame"in window&&(Sz=function(o){return window.requestAnimationFrame(o)},Tz=function(o){return window.cancelAnimationFrame(o)});var J6=0,D3=new Map;function Mz(n){D3.delete(n)}var va=function(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;J6+=1;var h=J6;function f(g){if(g===0)Mz(h),o();else{var x=Sz(function(){f(g-1)});D3.set(h,x)}}return f(l),h};va.cancel=function(n){var o=D3.get(n);return Mz(o),Tz(o)};function L3(n){for(var o=0,l,h=0,f=n.length;f>=4;++h,f-=4)l=n.charCodeAt(h)&255|(n.charCodeAt(++h)&255)<<8|(n.charCodeAt(++h)&255)<<16|(n.charCodeAt(++h)&255)<<24,l=(l&65535)*1540483477+((l>>>16)*59797<<16),l^=l>>>24,o=(l&65535)*1540483477+((l>>>16)*59797<<16)^(o&65535)*1540483477+((o>>>16)*59797<<16);switch(f){case 3:o^=(n.charCodeAt(h+2)&255)<<16;case 2:o^=(n.charCodeAt(h+1)&255)<<8;case 1:o^=n.charCodeAt(h)&255,o=(o&65535)*1540483477+((o>>>16)*59797<<16)}return o^=o>>>13,o=(o&65535)*1540483477+((o>>>16)*59797<<16),((o^o>>>15)>>>0).toString(36)}function dG(n,o){if(n==null)return{};var l={},h=Object.keys(n),f,g;for(g=0;g<h.length;g++)f=h[g],!(o.indexOf(f)>=0)&&(l[f]=n[f]);return l}function xa(n,o){if(n==null)return{};var l=dG(n,o),h,f;if(Object.getOwnPropertySymbols){var g=Object.getOwnPropertySymbols(n);for(f=0;f<g.length;f++)h=g[f],!(o.indexOf(h)>=0)&&Object.prototype.propertyIsEnumerable.call(n,h)&&(l[h]=n[h])}return l}function Cz(n,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,h=new Set;function f(g,x){var E=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,w=h.has(g);if(xo(!w,"Warning: There may be circular references"),w)return!1;if(g===x)return!0;if(l&&E>1)return!1;h.add(g);var I=E+1;if(Array.isArray(g)){if(!Array.isArray(x)||g.length!==x.length)return!1;for(var R=0;R<g.length;R++)if(!f(g[R],x[R],I))return!1;return!0}if(g&&x&&bn(g)==="object"&&bn(x)==="object"){var D=Object.keys(g);return D.length!==Object.keys(x).length?!1:D.every(function(F){return f(g[F],x[F],I)})}return!1}return f(n,o)}var Q6="%",fG=function(){function n(o){Va(this,n),$r(this,"instanceId",void 0),$r(this,"cache",new Map),this.instanceId=o}return Ua(n,[{key:"get",value:function(l){return this.cache.get(l.join(Q6))||null}},{key:"update",value:function(l,h){var f=l.join(Q6),g=this.cache.get(f),x=h(g);x===null?this.cache.delete(f):this.cache.set(f,x)}}]),n}(),q2="data-token-hash",Sc="data-css-hash",yh="__cssinjs_instance__";function pG(){var n=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){var o=document.body.querySelectorAll("style[".concat(Sc,"]"))||[],l=document.head.firstChild;Array.from(o).forEach(function(f){f[yh]=f[yh]||n,f[yh]===n&&document.head.insertBefore(f,l)});var h={};Array.from(document.querySelectorAll("style[".concat(Sc,"]"))).forEach(function(f){var g=f.getAttribute(Sc);if(h[g]){if(f[yh]===n){var x;(x=f.parentNode)===null||x===void 0||x.removeChild(f)}}else h[g]=!0})}return new fG(n)}var O3=A.createContext({hashPriority:"low",cache:pG(),defaultCache:!0});function Oi(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function mG(n,o){if(!n)return!1;if(n.contains)return n.contains(o);for(var l=o;l;){if(l===n)return!0;l=l.parentNode}return!1}var eI="data-rc-order",tI="data-rc-priority",gG="rc-util-key",Z2=new Map;function Az(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},o=n.mark;return o?o.startsWith("data-")?o:"data-".concat(o):gG}function X_(n){if(n.attachTo)return n.attachTo;var o=document.querySelector("head");return o||document.body}function _G(n){return n==="queue"?"prependQueue":n?"prepend":"append"}function Iz(n){return Array.from((Z2.get(n)||n).children).filter(function(o){return o.tagName==="STYLE"})}function Pz(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!Oi())return null;var l=o.csp,h=o.prepend,f=o.priority,g=f===void 0?0:f,x=_G(h),E=x==="prependQueue",w=document.createElement("style");w.setAttribute(eI,x),E&&g&&w.setAttribute(tI,"".concat(g)),l!=null&&l.nonce&&(w.nonce=l==null?void 0:l.nonce),w.innerHTML=n;var I=X_(o),R=I.firstChild;if(h){if(E){var D=Iz(I).filter(function(F){if(!["prepend","prependQueue"].includes(F.getAttribute(eI)))return!1;var q=Number(F.getAttribute(tI)||0);return g>=q});if(D.length)return I.insertBefore(w,D[D.length-1].nextSibling),w}I.insertBefore(w,R)}else I.appendChild(w);return w}function kz(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=X_(o);return Iz(l).find(function(h){return h.getAttribute(Az(o))===n})}function l_(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=kz(n,o);if(l){var h=X_(o);h.removeChild(l)}}function yG(n,o){var l=Z2.get(n);if(!l||!mG(document,l)){var h=Pz("",o),f=h.parentNode;Z2.set(n,f),n.removeChild(h)}}function jh(n,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=X_(l);yG(h,l);var f=kz(o,l);if(f){var g,x;if((g=l.csp)!==null&&g!==void 0&&g.nonce&&f.nonce!==((x=l.csp)===null||x===void 0?void 0:x.nonce)){var E;f.nonce=(E=l.csp)===null||E===void 0?void 0:E.nonce}return f.innerHTML!==n&&(f.innerHTML=n),f}var w=Pz(n,l);return w.setAttribute(Az(l),o),w}function Rz(n){if(Array.isArray(n))return n}function vG(n,o){var l=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(l!=null){var h,f,g,x,E=[],w=!0,I=!1;try{if(g=(l=l.call(n)).next,o===0){if(Object(l)!==l)return;w=!1}else for(;!(w=(h=g.call(l)).done)&&(E.push(h.value),E.length!==o);w=!0);}catch(R){I=!0,f=R}finally{try{if(!w&&l.return!=null&&(x=l.return(),Object(x)!==x))return}finally{if(I)throw f}}return E}}function zz(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ht(n,o){return Rz(n)||vG(n,o)||z3(n,o)||zz()}function xG(n,o){if(n.length!==o.length)return!1;for(var l=0;l<n.length;l++)if(n[l]!==o[l])return!1;return!0}var F3=function(){function n(){Va(this,n),$r(this,"cache",void 0),$r(this,"keys",void 0),$r(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return Ua(n,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(l){var h,f,g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,x={map:this.cache};return l.forEach(function(E){if(!x)x=void 0;else{var w,I;x=(w=x)===null||w===void 0||(I=w.map)===null||I===void 0?void 0:I.get(E)}}),(h=x)!==null&&h!==void 0&&h.value&&g&&(x.value[1]=this.cacheCallTimes++),(f=x)===null||f===void 0?void 0:f.value}},{key:"get",value:function(l){var h;return(h=this.internalGet(l,!0))===null||h===void 0?void 0:h[0]}},{key:"has",value:function(l){return!!this.internalGet(l)}},{key:"set",value:function(l,h){var f=this;if(!this.has(l)){if(this.size()+1>n.MAX_CACHE_SIZE+n.MAX_CACHE_OFFSET){var g=this.keys.reduce(function(I,R){var D=Ht(I,2),F=D[1];return f.internalGet(R)[1]<F?[R,f.internalGet(R)[1]]:I},[this.keys[0],this.cacheCallTimes]),x=Ht(g,1),E=x[0];this.delete(E)}this.keys.push(l)}var w=this.cache;l.forEach(function(I,R){if(R===l.length-1)w.set(I,{value:[h,f.cacheCallTimes++]});else{var D=w.get(I);D?D.map||(D.map=new Map):w.set(I,{map:new Map}),w=w.get(I).map}})}},{key:"deleteByPath",value:function(l,h){var f=l.get(h[0]);if(h.length===1){var g;return f.map?l.set(h[0],{map:f.map}):l.delete(h[0]),(g=f.value)===null||g===void 0?void 0:g[0]}var x=this.deleteByPath(f.map,h.slice(1));return(!f.map||f.map.size===0)&&!f.value&&l.delete(h[0]),x}},{key:"delete",value:function(l){if(this.has(l))return this.keys=this.keys.filter(function(h){return!xG(h,l)}),this.deleteByPath(this.cache,l)}}]),n}();$r(F3,"MAX_CACHE_SIZE",20);$r(F3,"MAX_CACHE_OFFSET",5);var rI=0,Dz=function(){function n(o){Va(this,n),$r(this,"derivatives",void 0),$r(this,"id",void 0),this.derivatives=Array.isArray(o)?o:[o],this.id=rI,o.length===0&&(o.length>0,void 0),rI+=1}return Ua(n,[{key:"getDerivativeToken",value:function(l){return this.derivatives.reduce(function(h,f){return f(l,h)},void 0)}}]),n}(),yb=new F3;function cp(n){var o=Array.isArray(n)?n:[n];return yb.has(o)||yb.set(o,new Dz(o)),yb.get(o)}function c_(n){var o="";return Object.keys(n).forEach(function(l){var h=n[l];o+=l,h instanceof Dz?o+=h.id:h&&bn(h)==="object"?o+=c_(h):o+=h}),o}function bG(n,o){return L3("".concat(o,"_").concat(c_(n)))}var Nf="random-".concat(Date.now(),"-").concat(Math.random()).replace(/\./g,""),Lz="_bAmBoO_";function wG(n,o,l){if(Oi()){var h,f;jh(n,Nf);var g=document.createElement("div");g.style.position="fixed",g.style.left="0",g.style.top="0",o==null||o(g),document.body.appendChild(g);var x=l?l(g):(h=getComputedStyle(g).content)===null||h===void 0?void 0:h.includes(Lz);return(f=g.parentNode)===null||f===void 0||f.removeChild(g),l_(Nf),x}return!1}var vb=void 0;function EG(){return vb===void 0&&(vb=wG("@layer ".concat(Nf," { .").concat(Nf,' { content: "').concat(Lz,'"!important; } }'),function(n){n.className=Nf})),vb}var nI=Oi()?A.useLayoutEffect:A.useEffect,Ti=function(o,l){var h=A.useRef(!0);nI(function(){return o(h.current)},l),nI(function(){return h.current=!1,function(){h.current=!0}},[])},iI=function(o,l){Ti(function(h){if(!h)return o()},l)},SG=ft({},x_),oI=SG.useInsertionEffect,TG=function(o,l,h){A.useMemo(o,h),Ti(function(){return l(!0)},h)},MG=oI?function(n,o,l){return oI(function(){return n(),o()},l)}:TG;function Oz(n,o,l,h,f){var g=A.useContext(O3),x=g.cache,E=[n].concat(Jt(o)),w=E.join("_"),I=function(q){x.update(E,function(G){var j=G||[],te=Ht(j,2),N=te[0],O=N===void 0?0:N,V=te[1],U=V,ae=U||l(),le=[O,ae];return q?q(le):le})};A.useMemo(function(){I()},[w]);var R=x.get(E),D=R[1];return MG(function(){f==null||f(D)},function(F){return I(function(q){var G=Ht(q,2),j=G[0],te=G[1];return F&&j===0&&(f==null||f(D)),[j+1,te]}),function(){x.update(E,function(q){var G=q||[],j=Ht(G,2),te=j[0],N=te===void 0?0:te,O=j[1],V=N-1;return V===0?(h==null||h(O,!1),null):[N-1,O]})}},[w]),D}var CG={},AG="css",pc=new Map;function IG(n){pc.set(n,(pc.get(n)||0)+1)}function PG(n,o){if(typeof document<"u"){var l=document.querySelectorAll("style[".concat(q2,'="').concat(n,'"]'));l.forEach(function(h){if(h[yh]===o){var f;(f=h.parentNode)===null||f===void 0||f.removeChild(h)}})}}var kG=0;function RG(n,o){pc.set(n,(pc.get(n)||0)-1);var l=Array.from(pc.keys()),h=l.filter(function(f){var g=pc.get(f)||0;return g<=0});l.length-h.length>kG&&h.forEach(function(f){PG(f,o),pc.delete(f)})}var Fz=function(o,l,h,f){var g=h.getDerivativeToken(o),x=ft(ft({},g),l);return f&&(x=f(x)),x};function zG(n,o){var l=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},h=A.useContext(O3),f=h.cache.instanceId,g=l.salt,x=g===void 0?"":g,E=l.override,w=E===void 0?CG:E,I=l.formatToken,R=l.getComputedToken,D=A.useMemo(function(){return Object.assign.apply(Object,[{}].concat(Jt(o)))},[o]),F=A.useMemo(function(){return c_(D)},[D]),q=A.useMemo(function(){return c_(w)},[w]),G=Oz("token",[x,n.id,F,q],function(){var j=R?R(D,w,n):Fz(D,w,n,I),te=bG(j,x);j._tokenKey=te,IG(te);var N="".concat(AG,"-").concat(L3(te));return j._hashId=N,[j,N]},function(j){RG(j[0]._tokenKey,f)});return G}var DG={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Bz="comm",Nz="rule",jz="decl",LG="@import",OG="@keyframes",FG="@layer",BG=Math.abs,B3=String.fromCharCode;function $z(n){return n.trim()}function M0(n,o,l){return n.replace(o,l)}function NG(n,o){return n.indexOf(o)}function up(n,o){return n.charCodeAt(o)|0}function hp(n,o,l){return n.slice(o,l)}function ms(n){return n.length}function jG(n){return n.length}function Qg(n,o){return o.push(n),n}var Y_=1,$h=1,Vz=0,Ho=0,ri=0,Xh="";function N3(n,o,l,h,f,g,x,E){return{value:n,root:o,parent:l,type:h,props:f,children:g,line:Y_,column:$h,length:x,return:"",siblings:E}}function $G(){return ri}function VG(){return ri=Ho>0?up(Xh,--Ho):0,$h--,ri===10&&($h=1,Y_--),ri}function _a(){return ri=Ho<Vz?up(Xh,Ho++):0,$h++,ri===10&&($h=1,Y_++),ri}function Tc(){return up(Xh,Ho)}function C0(){return Ho}function K_(n,o){return hp(Xh,n,o)}function X2(n){switch(n){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function UG(n){return Y_=$h=1,Vz=ms(Xh=n),Ho=0,[]}function GG(n){return Xh="",n}function xb(n){return $z(K_(Ho-1,Y2(n===91?n+2:n===40?n+1:n)))}function WG(n){for(;(ri=Tc())&&ri<33;)_a();return X2(n)>2||X2(ri)>3?"":" "}function HG(n,o){for(;--o&&_a()&&!(ri<48||ri>102||ri>57&&ri<65||ri>70&&ri<97););return K_(n,C0()+(o<6&&Tc()==32&&_a()==32))}function Y2(n){for(;_a();)switch(ri){case n:return Ho;case 34:case 39:n!==34&&n!==39&&Y2(ri);break;case 40:n===41&&Y2(n);break;case 92:_a();break}return Ho}function qG(n,o){for(;_a()&&n+ri!==47+10;)if(n+ri===42+42&&Tc()===47)break;return"/*"+K_(o,Ho-1)+"*"+B3(n===47?n:_a())}function ZG(n){for(;!X2(Tc());)_a();return K_(n,Ho)}function XG(n){return GG(A0("",null,null,null,[""],n=UG(n),0,[0],n))}function A0(n,o,l,h,f,g,x,E,w){for(var I=0,R=0,D=x,F=0,q=0,G=0,j=1,te=1,N=1,O=0,V="",U=f,ae=g,le=h,ne=V;te;)switch(G=O,O=_a()){case 40:if(G!=108&&up(ne,D-1)==58){NG(ne+=M0(xb(O),"&","&\f"),"&\f")!=-1&&(N=-1);break}case 34:case 39:case 91:ne+=xb(O);break;case 9:case 10:case 13:case 32:ne+=WG(G);break;case 92:ne+=HG(C0()-1,7);continue;case 47:switch(Tc()){case 42:case 47:Qg(YG(qG(_a(),C0()),o,l,w),w);break;default:ne+="/"}break;case 123*j:E[I++]=ms(ne)*N;case 125*j:case 59:case 0:switch(O){case 0:case 125:te=0;case 59+R:N==-1&&(ne=M0(ne,/\f/g,"")),q>0&&ms(ne)-D&&Qg(q>32?sI(ne+";",h,l,D-1,w):sI(M0(ne," ","")+";",h,l,D-2,w),w);break;case 59:ne+=";";default:if(Qg(le=aI(ne,o,l,I,R,f,E,V,U=[],ae=[],D,g),g),O===123)if(R===0)A0(ne,o,le,le,U,g,D,E,ae);else switch(F===99&&up(ne,3)===110?100:F){case 100:case 108:case 109:case 115:A0(n,le,le,h&&Qg(aI(n,le,le,0,0,f,E,V,f,U=[],D,ae),ae),f,ae,D,E,h?U:ae);break;default:A0(ne,le,le,le,[""],ae,0,E,ae)}}I=R=q=0,j=N=1,V=ne="",D=x;break;case 58:D=1+ms(ne),q=G;default:if(j<1){if(O==123)--j;else if(O==125&&j++==0&&VG()==125)continue}switch(ne+=B3(O),O*j){case 38:N=R>0?1:(ne+="\f",-1);break;case 44:E[I++]=(ms(ne)-1)*N,N=1;break;case 64:Tc()===45&&(ne+=xb(_a())),F=Tc(),R=D=ms(V=ne+=ZG(C0())),O++;break;case 45:G===45&&ms(ne)==2&&(j=0)}}return g}function aI(n,o,l,h,f,g,x,E,w,I,R,D){for(var F=f-1,q=f===0?g:[""],G=jG(q),j=0,te=0,N=0;j<h;++j)for(var O=0,V=hp(n,F+1,F=BG(te=x[j])),U=n;O<G;++O)(U=$z(te>0?q[O]+" "+V:M0(V,/&\f/g,q[O])))&&(w[N++]=U);return N3(n,o,l,f===0?Nz:E,w,I,R,D)}function YG(n,o,l,h){return N3(n,o,l,Bz,B3($G()),hp(n,2,-2),0,h)}function sI(n,o,l,h,f){return N3(n,o,l,jz,hp(n,0,h),hp(n,h+1,-1),h,f)}function K2(n,o){for(var l="",h=0;h<n.length;h++)l+=o(n[h],h,n,o)||"";return l}function KG(n,o,l,h){switch(n.type){case FG:if(n.children.length)break;case LG:case jz:return n.return=n.return||n.value;case Bz:return"";case OG:return n.return=n.value+"{"+K2(n.children,h)+"}";case Nz:if(!ms(n.value=n.props.join(",")))return""}return ms(l=K2(n.children,h))?n.return=n.value+"{"+l+"}":""}var lI="data-ant-cssinjs-cache-path",Uz="_FILE_STYLE__",Mc,Gz=!0;function JG(){if(!Mc&&(Mc={},Oi())){var n=document.createElement("div");n.className=lI,n.style.position="fixed",n.style.visibility="hidden",n.style.top="-9999px",document.body.appendChild(n);var o=getComputedStyle(n).content||"";o=o.replace(/^"/,"").replace(/"$/,""),o.split(";").forEach(function(f){var g=f.split(":"),x=Ht(g,2),E=x[0],w=x[1];Mc[E]=w});var l=document.querySelector("style[".concat(lI,"]"));if(l){var h;Gz=!1,(h=l.parentNode)===null||h===void 0||h.removeChild(l)}document.body.removeChild(n)}}function QG(n){return JG(),!!Mc[n]}function eW(n){var o=Mc[n],l=null;if(o&&Oi())if(Gz)l=Uz;else{var h=document.querySelector("style[".concat(Sc,'="').concat(Mc[n],'"]'));h?l=h.innerHTML:delete Mc[n]}return[l,o]}var cI=Oi(),tW="_skip_check_",Wz="_multi_value_";function uI(n){var o=K2(XG(n),KG);return o.replace(/\{%%%\:[^;];}/g,";")}function rW(n){return bn(n)==="object"&&n&&(tW in n||Wz in n)}function nW(n,o,l){if(!o)return n;var h=".".concat(o),f=l==="low"?":where(".concat(h,")"):h,g=n.split(",").map(function(x){var E,w=x.trim().split(/\s+/),I=w[0]||"",R=((E=I.match(/^\w+/))===null||E===void 0?void 0:E[0])||"";return I="".concat(R).concat(f).concat(I.slice(R.length)),[I].concat(Jt(w.slice(1))).join(" ")});return g.join(",")}var iW=function n(o){var l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]},f=h.root,g=h.injectHash,x=h.parentSelectors,E=l.hashId,w=l.layer;l.path;var I=l.hashPriority,R=l.transformers,D=R===void 0?[]:R;l.linters;var F="",q={};function G(V){var U=V.getName(E);if(!q[U]){var ae=n(V.style,l,{root:!1,parentSelectors:x}),le=Ht(ae,1),ne=le[0];q[U]="@keyframes ".concat(V.getName(E)).concat(ne)}}function j(V){var U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return V.forEach(function(ae){Array.isArray(ae)?j(ae,U):ae&&U.push(ae)}),U}var te=j(Array.isArray(o)?o:[o]);if(te.forEach(function(V){var U=typeof V=="string"&&!f?{}:V;if(typeof U=="string")F+="".concat(U,`
`);else if(U._keyframe)G(U);else{var ae=D.reduce(function(le,ne){var de;return(ne==null||(de=ne.visit)===null||de===void 0?void 0:de.call(ne,le))||le},U);Object.keys(ae).forEach(function(le){var ne=ae[le];if(bn(ne)==="object"&&ne&&(le!=="animationName"||!ne._keyframe)&&!rW(ne)){var de=!1,$=le.trim(),ue=!1;(f||g)&&E?$.startsWith("@")?de=!0:$=nW(le,E,I):f&&!E&&($==="&"||$==="")&&($="",ue=!0);var xe=n(ne,l,{root:ue,injectHash:de,parentSelectors:[].concat(Jt(x),[$])}),ce=Ht(xe,2),se=ce[0],ke=ce[1];q=ft(ft({},q),ke),F+="".concat($).concat(se)}else{let Re=function(He,Xe){var ze=He.replace(/[A-Z]/g,function(Pt){return"-".concat(Pt.toLowerCase())}),at=Xe;!DG[He]&&typeof at=="number"&&at!==0&&(at="".concat(at,"px")),He==="animationName"&&Xe!==null&&Xe!==void 0&&Xe._keyframe&&(G(Xe),at=Xe.getName(E)),F+="".concat(ze,":").concat(at,";")};var it=Re,$e,Ne=($e=ne==null?void 0:ne.value)!==null&&$e!==void 0?$e:ne;bn(ne)==="object"&&ne!==null&&ne!==void 0&&ne[Wz]&&Array.isArray(Ne)?Ne.forEach(function(He){Re(le,He)}):Re(le,Ne)}})}}),!f)F="{".concat(F,"}");else if(w&&EG()){var N=w.split(","),O=N[N.length-1].trim();F="@layer ".concat(O," {").concat(F,"}"),N.length>1&&(F="@layer ".concat(w,"{%%%:%}").concat(F))}return[F,q]};function oW(n,o){return L3("".concat(n.join("%")).concat(o))}function aW(){return null}function J2(n,o){var l=n.token,h=n.path,f=n.hashId,g=n.layer,x=n.nonce,E=n.clientOnly,w=n.order,I=w===void 0?0:w,R=A.useContext(O3),D=R.autoClear;R.mock;var F=R.defaultCache,q=R.hashPriority,G=R.container,j=R.ssrInline,te=R.transformers,N=R.linters,O=R.cache,V=l._tokenKey,U=[V].concat(Jt(h)),ae=cI,le=Oz("style",U,function(){var xe=U.join("|");if(QG(xe)){var ce=eW(xe),se=Ht(ce,2),ke=se[0],$e=se[1];if(ke)return[ke,V,$e,{},E,I]}var Ne=o(),it=iW(Ne,{hashId:f,hashPriority:q,layer:g,path:h.join("-"),transformers:te,linters:N}),Re=Ht(it,2),He=Re[0],Xe=Re[1],ze=uI(He),at=oW(U,ze);return[ze,V,at,Xe,E,I]},function(xe,ce){var se=Ht(xe,3),ke=se[2];(ce||D)&&cI&&l_(ke,{mark:Sc})},function(xe){var ce=Ht(xe,4),se=ce[0];ce[1];var ke=ce[2],$e=ce[3];if(ae&&se!==Uz){var Ne={mark:Sc,prepend:"queue",attachTo:G,priority:I},it=typeof x=="function"?x():x;it&&(Ne.csp={nonce:it});var Re=jh(se,ke,Ne);Re[yh]=O.instanceId,Re.setAttribute(q2,V),Object.keys($e).forEach(function(He){jh(uI($e[He]),"_effect-".concat(He),Ne)})}}),ne=Ht(le,3),de=ne[0],$=ne[1],ue=ne[2];return function(xe){var ce;if(!j||ae||!F)ce=A.createElement(aW,null);else{var se;ce=A.createElement("style",ui({},(se={},$r(se,q2,$),$r(se,Sc,ue),se),{dangerouslySetInnerHTML:{__html:de}}))}return A.createElement(A.Fragment,null,ce,xe)}}var Ni=function(){function n(o,l){Va(this,n),$r(this,"name",void 0),$r(this,"style",void 0),$r(this,"_keyframe",!0),this.name=o,this.style=l}return Ua(n,[{key:"getName",value:function(){var l=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return l?"".concat(l,"-").concat(this.name):this.name}}]),n}();function Xu(n){return n.notSplit=!0,n}Xu(["borderTop","borderBottom"]),Xu(["borderTop"]),Xu(["borderBottom"]),Xu(["borderLeft","borderRight"]),Xu(["borderLeft"]),Xu(["borderRight"]);var sW=A.createContext({});const j3=sW;function lW(n){return Rz(n)||Ez(n)||z3(n)||zz()}function pa(n,o){for(var l=n,h=0;h<o.length;h+=1){if(l==null)return;l=l[o[h]]}return l}function Hz(n,o,l,h){if(!o.length)return l;var f=lW(o),g=f[0],x=f.slice(1),E;return!n&&typeof g=="number"?E=[]:Array.isArray(n)?E=Jt(n):E=ft({},n),h&&l===void 0&&x.length===1?delete E[g][x[0]]:E[g]=Hz(E[g],x,l,h),E}function ua(n,o,l){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return o.length&&h&&l===void 0&&!pa(n,o.slice(0,-1))?n:Hz(n,o,l,h)}function cW(n){return bn(n)==="object"&&n!==null&&Object.getPrototypeOf(n)===Object.prototype}function hI(n){return Array.isArray(n)?[]:{}}var uW=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function vh(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];var h=hI(o[0]);return o.forEach(function(f){function g(x,E){var w=new Set(E),I=pa(f,x),R=Array.isArray(I);if(R||cW(I)){if(!w.has(I)){w.add(I);var D=pa(h,x);R?h=ua(h,x,[]):(!D||bn(D)!=="object")&&(h=ua(h,x,hI(I))),uW(I).forEach(function(F){g([].concat(Jt(x),[F]),w)})}}else h=ua(h,x,I)}g([])}),h}const qz=A.createContext(void 0),hW={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"};var dW={locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"};const fW={placeholder:"Select time",rangePlaceholder:["Start time","End time"]},Zz=fW,pW={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},dW),timePickerLocale:Object.assign({},Zz)},dI=pW,fo="${label} is not a valid ${type}",mW={locale:"en",Pagination:hW,DatePicker:dI,TimePicker:Zz,Calendar:dI,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},PageHeader:{back:"Back"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:fo,method:fo,array:fo,object:fo,number:fo,date:fo,boolean:fo,integer:fo,float:fo,regexp:fo,email:fo,url:fo,hex:fo},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh"},ColorPicker:{presetEmpty:"Empty"}},zc=mW;Object.assign({},zc.Modal);let I0=[];const fI=()=>I0.reduce((n,o)=>Object.assign(Object.assign({},n),o),zc.Modal);function gW(n){if(n){const o=Object.assign({},n);return I0.push(o),fI(),()=>{I0=I0.filter(l=>l!==o),fI()}}Object.assign({},zc.Modal)}const _W=A.createContext(void 0),$3=_W,yW=(n,o)=>{const l=A.useContext($3),h=A.useMemo(()=>{var g;const x=o||zc[n],E=(g=l==null?void 0:l[n])!==null&&g!==void 0?g:{};return Object.assign(Object.assign({},typeof x=="function"?x():x),E||{})},[n,o,l]),f=A.useMemo(()=>{const g=l==null?void 0:l.locale;return l!=null&&l.exist&&!g?zc.locale:g},[l]);return[h,f]},vW=yW,xW="internalMark",bW=n=>{const{locale:o={},children:l,_ANT_MARK__:h}=n;A.useEffect(()=>gW(o&&o.Modal),[o]);const f=A.useMemo(()=>Object.assign(Object.assign({},o),{exist:!0}),[o]);return A.createElement($3.Provider,{value:f},l)},wW=bW,u_=["blue","purple","cyan","green","magenta","pink","red","orange","yellow","volcano","geekblue","lime","gold"],EW="5.8.2";function vi(n,o){SW(n)&&(n="100%");var l=TW(n);return n=o===360?n:Math.min(o,Math.max(0,parseFloat(n))),l&&(n=parseInt(String(n*o),10)/100),Math.abs(n-o)<1e-6?1:(o===360?n=(n<0?n%o+o:n%o)/parseFloat(String(o)):n=n%o/parseFloat(String(o)),n)}function e0(n){return Math.min(1,Math.max(0,n))}function SW(n){return typeof n=="string"&&n.indexOf(".")!==-1&&parseFloat(n)===1}function TW(n){return typeof n=="string"&&n.indexOf("%")!==-1}function Xz(n){return n=parseFloat(n),(isNaN(n)||n<0||n>1)&&(n=1),n}function t0(n){return n<=1?"".concat(Number(n)*100,"%"):n}function yc(n){return n.length===1?"0"+n:String(n)}function MW(n,o,l){return{r:vi(n,255)*255,g:vi(o,255)*255,b:vi(l,255)*255}}function pI(n,o,l){n=vi(n,255),o=vi(o,255),l=vi(l,255);var h=Math.max(n,o,l),f=Math.min(n,o,l),g=0,x=0,E=(h+f)/2;if(h===f)x=0,g=0;else{var w=h-f;switch(x=E>.5?w/(2-h-f):w/(h+f),h){case n:g=(o-l)/w+(o<l?6:0);break;case o:g=(l-n)/w+2;break;case l:g=(n-o)/w+4;break}g/=6}return{h:g,s:x,l:E}}function bb(n,o,l){return l<0&&(l+=1),l>1&&(l-=1),l<1/6?n+(o-n)*(6*l):l<1/2?o:l<2/3?n+(o-n)*(2/3-l)*6:n}function CW(n,o,l){var h,f,g;if(n=vi(n,360),o=vi(o,100),l=vi(l,100),o===0)f=l,g=l,h=l;else{var x=l<.5?l*(1+o):l+o-l*o,E=2*l-x;h=bb(E,x,n+1/3),f=bb(E,x,n),g=bb(E,x,n-1/3)}return{r:h*255,g:f*255,b:g*255}}function Q2(n,o,l){n=vi(n,255),o=vi(o,255),l=vi(l,255);var h=Math.max(n,o,l),f=Math.min(n,o,l),g=0,x=h,E=h-f,w=h===0?0:E/h;if(h===f)g=0;else{switch(h){case n:g=(o-l)/E+(o<l?6:0);break;case o:g=(l-n)/E+2;break;case l:g=(n-o)/E+4;break}g/=6}return{h:g,s:w,v:x}}function AW(n,o,l){n=vi(n,360)*6,o=vi(o,100),l=vi(l,100);var h=Math.floor(n),f=n-h,g=l*(1-o),x=l*(1-f*o),E=l*(1-(1-f)*o),w=h%6,I=[l,x,g,g,E,l][w],R=[E,l,l,x,g,g][w],D=[g,g,E,l,l,x][w];return{r:I*255,g:R*255,b:D*255}}function ew(n,o,l,h){var f=[yc(Math.round(n).toString(16)),yc(Math.round(o).toString(16)),yc(Math.round(l).toString(16))];return h&&f[0].startsWith(f[0].charAt(1))&&f[1].startsWith(f[1].charAt(1))&&f[2].startsWith(f[2].charAt(1))?f[0].charAt(0)+f[1].charAt(0)+f[2].charAt(0):f.join("")}function IW(n,o,l,h,f){var g=[yc(Math.round(n).toString(16)),yc(Math.round(o).toString(16)),yc(Math.round(l).toString(16)),yc(PW(h))];return f&&g[0].startsWith(g[0].charAt(1))&&g[1].startsWith(g[1].charAt(1))&&g[2].startsWith(g[2].charAt(1))&&g[3].startsWith(g[3].charAt(1))?g[0].charAt(0)+g[1].charAt(0)+g[2].charAt(0)+g[3].charAt(0):g.join("")}function PW(n){return Math.round(parseFloat(n)*255).toString(16)}function mI(n){return go(n)/255}function go(n){return parseInt(n,16)}function kW(n){return{r:n>>16,g:(n&65280)>>8,b:n&255}}var tw={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};function rh(n){var o={r:0,g:0,b:0},l=1,h=null,f=null,g=null,x=!1,E=!1;return typeof n=="string"&&(n=DW(n)),typeof n=="object"&&(hs(n.r)&&hs(n.g)&&hs(n.b)?(o=MW(n.r,n.g,n.b),x=!0,E=String(n.r).substr(-1)==="%"?"prgb":"rgb"):hs(n.h)&&hs(n.s)&&hs(n.v)?(h=t0(n.s),f=t0(n.v),o=AW(n.h,h,f),x=!0,E="hsv"):hs(n.h)&&hs(n.s)&&hs(n.l)&&(h=t0(n.s),g=t0(n.l),o=CW(n.h,h,g),x=!0,E="hsl"),Object.prototype.hasOwnProperty.call(n,"a")&&(l=n.a)),l=Xz(l),{ok:x,format:n.format||E,r:Math.min(255,Math.max(o.r,0)),g:Math.min(255,Math.max(o.g,0)),b:Math.min(255,Math.max(o.b,0)),a:l}}var RW="[-\\+]?\\d+%?",zW="[-\\+]?\\d*\\.\\d+%?",El="(?:".concat(zW,")|(?:").concat(RW,")"),wb="[\\s|\\(]+(".concat(El,")[,|\\s]+(").concat(El,")[,|\\s]+(").concat(El,")\\s*\\)?"),Eb="[\\s|\\(]+(".concat(El,")[,|\\s]+(").concat(El,")[,|\\s]+(").concat(El,")[,|\\s]+(").concat(El,")\\s*\\)?"),sa={CSS_UNIT:new RegExp(El),rgb:new RegExp("rgb"+wb),rgba:new RegExp("rgba"+Eb),hsl:new RegExp("hsl"+wb),hsla:new RegExp("hsla"+Eb),hsv:new RegExp("hsv"+wb),hsva:new RegExp("hsva"+Eb),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function DW(n){if(n=n.trim().toLowerCase(),n.length===0)return!1;var o=!1;if(tw[n])n=tw[n],o=!0;else if(n==="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var l=sa.rgb.exec(n);return l?{r:l[1],g:l[2],b:l[3]}:(l=sa.rgba.exec(n),l?{r:l[1],g:l[2],b:l[3],a:l[4]}:(l=sa.hsl.exec(n),l?{h:l[1],s:l[2],l:l[3]}:(l=sa.hsla.exec(n),l?{h:l[1],s:l[2],l:l[3],a:l[4]}:(l=sa.hsv.exec(n),l?{h:l[1],s:l[2],v:l[3]}:(l=sa.hsva.exec(n),l?{h:l[1],s:l[2],v:l[3],a:l[4]}:(l=sa.hex8.exec(n),l?{r:go(l[1]),g:go(l[2]),b:go(l[3]),a:mI(l[4]),format:o?"name":"hex8"}:(l=sa.hex6.exec(n),l?{r:go(l[1]),g:go(l[2]),b:go(l[3]),format:o?"name":"hex"}:(l=sa.hex4.exec(n),l?{r:go(l[1]+l[1]),g:go(l[2]+l[2]),b:go(l[3]+l[3]),a:mI(l[4]+l[4]),format:o?"name":"hex8"}:(l=sa.hex3.exec(n),l?{r:go(l[1]+l[1]),g:go(l[2]+l[2]),b:go(l[3]+l[3]),format:o?"name":"hex"}:!1)))))))))}function hs(n){return!!sa.CSS_UNIT.exec(String(n))}var Di=function(){function n(o,l){o===void 0&&(o=""),l===void 0&&(l={});var h;if(o instanceof n)return o;typeof o=="number"&&(o=kW(o)),this.originalInput=o;var f=rh(o);this.originalInput=o,this.r=f.r,this.g=f.g,this.b=f.b,this.a=f.a,this.roundA=Math.round(100*this.a)/100,this.format=(h=l.format)!==null&&h!==void 0?h:f.format,this.gradientType=l.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=f.ok}return n.prototype.isDark=function(){return this.getBrightness()<128},n.prototype.isLight=function(){return!this.isDark()},n.prototype.getBrightness=function(){var o=this.toRgb();return(o.r*299+o.g*587+o.b*114)/1e3},n.prototype.getLuminance=function(){var o=this.toRgb(),l,h,f,g=o.r/255,x=o.g/255,E=o.b/255;return g<=.03928?l=g/12.92:l=Math.pow((g+.055)/1.055,2.4),x<=.03928?h=x/12.92:h=Math.pow((x+.055)/1.055,2.4),E<=.03928?f=E/12.92:f=Math.pow((E+.055)/1.055,2.4),.2126*l+.7152*h+.0722*f},n.prototype.getAlpha=function(){return this.a},n.prototype.setAlpha=function(o){return this.a=Xz(o),this.roundA=Math.round(100*this.a)/100,this},n.prototype.isMonochrome=function(){var o=this.toHsl().s;return o===0},n.prototype.toHsv=function(){var o=Q2(this.r,this.g,this.b);return{h:o.h*360,s:o.s,v:o.v,a:this.a}},n.prototype.toHsvString=function(){var o=Q2(this.r,this.g,this.b),l=Math.round(o.h*360),h=Math.round(o.s*100),f=Math.round(o.v*100);return this.a===1?"hsv(".concat(l,", ").concat(h,"%, ").concat(f,"%)"):"hsva(".concat(l,", ").concat(h,"%, ").concat(f,"%, ").concat(this.roundA,")")},n.prototype.toHsl=function(){var o=pI(this.r,this.g,this.b);return{h:o.h*360,s:o.s,l:o.l,a:this.a}},n.prototype.toHslString=function(){var o=pI(this.r,this.g,this.b),l=Math.round(o.h*360),h=Math.round(o.s*100),f=Math.round(o.l*100);return this.a===1?"hsl(".concat(l,", ").concat(h,"%, ").concat(f,"%)"):"hsla(".concat(l,", ").concat(h,"%, ").concat(f,"%, ").concat(this.roundA,")")},n.prototype.toHex=function(o){return o===void 0&&(o=!1),ew(this.r,this.g,this.b,o)},n.prototype.toHexString=function(o){return o===void 0&&(o=!1),"#"+this.toHex(o)},n.prototype.toHex8=function(o){return o===void 0&&(o=!1),IW(this.r,this.g,this.b,this.a,o)},n.prototype.toHex8String=function(o){return o===void 0&&(o=!1),"#"+this.toHex8(o)},n.prototype.toHexShortString=function(o){return o===void 0&&(o=!1),this.a===1?this.toHexString(o):this.toHex8String(o)},n.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},n.prototype.toRgbString=function(){var o=Math.round(this.r),l=Math.round(this.g),h=Math.round(this.b);return this.a===1?"rgb(".concat(o,", ").concat(l,", ").concat(h,")"):"rgba(".concat(o,", ").concat(l,", ").concat(h,", ").concat(this.roundA,")")},n.prototype.toPercentageRgb=function(){var o=function(l){return"".concat(Math.round(vi(l,255)*100),"%")};return{r:o(this.r),g:o(this.g),b:o(this.b),a:this.a}},n.prototype.toPercentageRgbString=function(){var o=function(l){return Math.round(vi(l,255)*100)};return this.a===1?"rgb(".concat(o(this.r),"%, ").concat(o(this.g),"%, ").concat(o(this.b),"%)"):"rgba(".concat(o(this.r),"%, ").concat(o(this.g),"%, ").concat(o(this.b),"%, ").concat(this.roundA,")")},n.prototype.toName=function(){if(this.a===0)return"transparent";if(this.a<1)return!1;for(var o="#"+ew(this.r,this.g,this.b,!1),l=0,h=Object.entries(tw);l<h.length;l++){var f=h[l],g=f[0],x=f[1];if(o===x)return g}return!1},n.prototype.toString=function(o){var l=!!o;o=o??this.format;var h=!1,f=this.a<1&&this.a>=0,g=!l&&f&&(o.startsWith("hex")||o==="name");return g?o==="name"&&this.a===0?this.toName():this.toRgbString():(o==="rgb"&&(h=this.toRgbString()),o==="prgb"&&(h=this.toPercentageRgbString()),(o==="hex"||o==="hex6")&&(h=this.toHexString()),o==="hex3"&&(h=this.toHexString(!0)),o==="hex4"&&(h=this.toHex8String(!0)),o==="hex8"&&(h=this.toHex8String()),o==="name"&&(h=this.toName()),o==="hsl"&&(h=this.toHslString()),o==="hsv"&&(h=this.toHsvString()),h||this.toHexString())},n.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},n.prototype.clone=function(){return new n(this.toString())},n.prototype.lighten=function(o){o===void 0&&(o=10);var l=this.toHsl();return l.l+=o/100,l.l=e0(l.l),new n(l)},n.prototype.brighten=function(o){o===void 0&&(o=10);var l=this.toRgb();return l.r=Math.max(0,Math.min(255,l.r-Math.round(255*-(o/100)))),l.g=Math.max(0,Math.min(255,l.g-Math.round(255*-(o/100)))),l.b=Math.max(0,Math.min(255,l.b-Math.round(255*-(o/100)))),new n(l)},n.prototype.darken=function(o){o===void 0&&(o=10);var l=this.toHsl();return l.l-=o/100,l.l=e0(l.l),new n(l)},n.prototype.tint=function(o){return o===void 0&&(o=10),this.mix("white",o)},n.prototype.shade=function(o){return o===void 0&&(o=10),this.mix("black",o)},n.prototype.desaturate=function(o){o===void 0&&(o=10);var l=this.toHsl();return l.s-=o/100,l.s=e0(l.s),new n(l)},n.prototype.saturate=function(o){o===void 0&&(o=10);var l=this.toHsl();return l.s+=o/100,l.s=e0(l.s),new n(l)},n.prototype.greyscale=function(){return this.desaturate(100)},n.prototype.spin=function(o){var l=this.toHsl(),h=(l.h+o)%360;return l.h=h<0?360+h:h,new n(l)},n.prototype.mix=function(o,l){l===void 0&&(l=50);var h=this.toRgb(),f=new n(o).toRgb(),g=l/100,x={r:(f.r-h.r)*g+h.r,g:(f.g-h.g)*g+h.g,b:(f.b-h.b)*g+h.b,a:(f.a-h.a)*g+h.a};return new n(x)},n.prototype.analogous=function(o,l){o===void 0&&(o=6),l===void 0&&(l=30);var h=this.toHsl(),f=360/l,g=[this];for(h.h=(h.h-(f*o>>1)+720)%360;--o;)h.h=(h.h+f)%360,g.push(new n(h));return g},n.prototype.complement=function(){var o=this.toHsl();return o.h=(o.h+180)%360,new n(o)},n.prototype.monochromatic=function(o){o===void 0&&(o=6);for(var l=this.toHsv(),h=l.h,f=l.s,g=l.v,x=[],E=1/o;o--;)x.push(new n({h,s:f,v:g})),g=(g+E)%1;return x},n.prototype.splitcomplement=function(){var o=this.toHsl(),l=o.h;return[this,new n({h:(l+72)%360,s:o.s,l:o.l}),new n({h:(l+216)%360,s:o.s,l:o.l})]},n.prototype.onBackground=function(o){var l=this.toRgb(),h=new n(o).toRgb(),f=l.a+h.a*(1-l.a);return new n({r:(l.r*l.a+h.r*h.a*(1-l.a))/f,g:(l.g*l.a+h.g*h.a*(1-l.a))/f,b:(l.b*l.a+h.b*h.a*(1-l.a))/f,a:f})},n.prototype.triad=function(){return this.polyad(3)},n.prototype.tetrad=function(){return this.polyad(4)},n.prototype.polyad=function(o){for(var l=this.toHsl(),h=l.h,f=[this],g=360/o,x=1;x<o;x++)f.push(new n({h:(h+x*g)%360,s:l.s,l:l.l}));return f},n.prototype.equals=function(o){return this.toRgbString()===new n(o).toRgbString()},n}(),r0=2,gI=.16,LW=.05,OW=.05,FW=.15,Yz=5,Kz=4,BW=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function _I(n){var o=n.r,l=n.g,h=n.b,f=Q2(o,l,h);return{h:f.h*360,s:f.s,v:f.v}}function n0(n){var o=n.r,l=n.g,h=n.b;return"#".concat(ew(o,l,h,!1))}function NW(n,o,l){var h=l/100,f={r:(o.r-n.r)*h+n.r,g:(o.g-n.g)*h+n.g,b:(o.b-n.b)*h+n.b};return f}function yI(n,o,l){var h;return Math.round(n.h)>=60&&Math.round(n.h)<=240?h=l?Math.round(n.h)-r0*o:Math.round(n.h)+r0*o:h=l?Math.round(n.h)+r0*o:Math.round(n.h)-r0*o,h<0?h+=360:h>=360&&(h-=360),h}function vI(n,o,l){if(n.h===0&&n.s===0)return n.s;var h;return l?h=n.s-gI*o:o===Kz?h=n.s+gI:h=n.s+LW*o,h>1&&(h=1),l&&o===Yz&&h>.1&&(h=.1),h<.06&&(h=.06),Number(h.toFixed(2))}function xI(n,o,l){var h;return l?h=n.v+OW*o:h=n.v-FW*o,h>1&&(h=1),Number(h.toFixed(2))}function Ss(n){for(var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},l=[],h=rh(n),f=Yz;f>0;f-=1){var g=_I(h),x=n0(rh({h:yI(g,f,!0),s:vI(g,f,!0),v:xI(g,f,!0)}));l.push(x)}l.push(n0(h));for(var E=1;E<=Kz;E+=1){var w=_I(h),I=n0(rh({h:yI(w,E),s:vI(w,E),v:xI(w,E)}));l.push(I)}return o.theme==="dark"?BW.map(function(R){var D=R.index,F=R.opacity,q=n0(NW(rh(o.backgroundColor||"#141414"),rh(l[D]),F*100));return q}):l}var Sb={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},P0={},Tb={};Object.keys(Sb).forEach(function(n){P0[n]=Ss(Sb[n]),P0[n].primary=P0[n][5],Tb[n]=Ss(Sb[n],{theme:"dark",backgroundColor:"#141414"}),Tb[n].primary=Tb[n][5]});var jW=P0.blue;const $W=n=>{const{controlHeight:o}=n;return{controlHeightSM:o*.75,controlHeightXS:o*.5,controlHeightLG:o*1.25}},Jz=$W;function VW(n){const{sizeUnit:o,sizeStep:l}=n;return{sizeXXL:o*(l+8),sizeXL:o*(l+4),sizeLG:o*(l+2),sizeMD:o*(l+1),sizeMS:o*l,size:o*l,sizeSM:o*(l-1),sizeXS:o*(l-2),sizeXXS:o*(l-3)}}const V3={blue:"#1677ff",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#eb2f96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},Mp=Object.assign(Object.assign({},V3),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0});function Qz(n,o){let{generateColorPalettes:l,generateNeutralColorPalettes:h}=o;const{colorSuccess:f,colorWarning:g,colorError:x,colorInfo:E,colorPrimary:w,colorBgBase:I,colorTextBase:R}=n,D=l(w),F=l(f),q=l(g),G=l(x),j=l(E),te=h(I,R),N=n.colorLink||n.colorInfo,O=l(N);return Object.assign(Object.assign({},te),{colorPrimaryBg:D[1],colorPrimaryBgHover:D[2],colorPrimaryBorder:D[3],colorPrimaryBorderHover:D[4],colorPrimaryHover:D[5],colorPrimary:D[6],colorPrimaryActive:D[7],colorPrimaryTextHover:D[8],colorPrimaryText:D[9],colorPrimaryTextActive:D[10],colorSuccessBg:F[1],colorSuccessBgHover:F[2],colorSuccessBorder:F[3],colorSuccessBorderHover:F[4],colorSuccessHover:F[4],colorSuccess:F[6],colorSuccessActive:F[7],colorSuccessTextHover:F[8],colorSuccessText:F[9],colorSuccessTextActive:F[10],colorErrorBg:G[1],colorErrorBgHover:G[2],colorErrorBorder:G[3],colorErrorBorderHover:G[4],colorErrorHover:G[5],colorError:G[6],colorErrorActive:G[7],colorErrorTextHover:G[8],colorErrorText:G[9],colorErrorTextActive:G[10],colorWarningBg:q[1],colorWarningBgHover:q[2],colorWarningBorder:q[3],colorWarningBorderHover:q[4],colorWarningHover:q[4],colorWarning:q[6],colorWarningActive:q[7],colorWarningTextHover:q[8],colorWarningText:q[9],colorWarningTextActive:q[10],colorInfoBg:j[1],colorInfoBgHover:j[2],colorInfoBorder:j[3],colorInfoBorderHover:j[4],colorInfoHover:j[4],colorInfo:j[6],colorInfoActive:j[7],colorInfoTextHover:j[8],colorInfoText:j[9],colorInfoTextActive:j[10],colorLinkHover:O[4],colorLink:O[6],colorLinkActive:O[7],colorBgMask:new Di("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}const UW=n=>{let o=n,l=n,h=n,f=n;return n<6&&n>=5?o=n+1:n<16&&n>=6?o=n+2:n>=16&&(o=16),n<7&&n>=5?l=4:n<8&&n>=7?l=5:n<14&&n>=8?l=6:n<16&&n>=14?l=7:n>=16&&(l=8),n<6&&n>=2?h=1:n>=6&&(h=2),n>4&&n<8?f=4:n>=8&&(f=6),{borderRadius:n>16?16:n,borderRadiusXS:h,borderRadiusSM:l,borderRadiusLG:o,borderRadiusOuter:f}},GW=UW;function WW(n){const{motionUnit:o,motionBase:l,borderRadius:h,lineWidth:f}=n;return Object.assign({motionDurationFast:`${(l+o).toFixed(1)}s`,motionDurationMid:`${(l+o*2).toFixed(1)}s`,motionDurationSlow:`${(l+o*3).toFixed(1)}s`,lineWidthBold:f+1},GW(h))}const ds=(n,o)=>new Di(n).setAlpha(o).toRgbString(),yf=(n,o)=>new Di(n).darken(o).toHexString(),HW=n=>{const o=Ss(n);return{1:o[0],2:o[1],3:o[2],4:o[3],5:o[4],6:o[5],7:o[6],8:o[4],9:o[5],10:o[6]}},qW=(n,o)=>{const l=n||"#fff",h=o||"#000";return{colorBgBase:l,colorTextBase:h,colorText:ds(h,.88),colorTextSecondary:ds(h,.65),colorTextTertiary:ds(h,.45),colorTextQuaternary:ds(h,.25),colorFill:ds(h,.15),colorFillSecondary:ds(h,.06),colorFillTertiary:ds(h,.04),colorFillQuaternary:ds(h,.02),colorBgLayout:yf(l,4),colorBgContainer:yf(l,0),colorBgElevated:yf(l,0),colorBgSpotlight:ds(h,.85),colorBorder:yf(l,15),colorBorderSecondary:yf(l,6)}};function ZW(n){const o=new Array(10).fill(null).map((l,h)=>{const f=h-1,g=n*Math.pow(2.71828,f/5),x=h>1?Math.floor(g):Math.ceil(g);return Math.floor(x/2)*2});return o[1]=n,o.map(l=>{const h=l+8;return{size:l,lineHeight:h/l}})}const XW=n=>{const o=ZW(n),l=o.map(f=>f.size),h=o.map(f=>f.lineHeight);return{fontSizeSM:l[0],fontSize:l[1],fontSizeLG:l[2],fontSizeXL:l[3],fontSizeHeading1:l[6],fontSizeHeading2:l[5],fontSizeHeading3:l[4],fontSizeHeading4:l[3],fontSizeHeading5:l[2],lineHeight:h[1],lineHeightLG:h[2],lineHeightSM:h[0],lineHeightHeading1:h[6],lineHeightHeading2:h[5],lineHeightHeading3:h[4],lineHeightHeading4:h[3],lineHeightHeading5:h[2]}},e8=XW;function Cp(n){const o=Object.keys(V3).map(l=>{const h=Ss(n[l]);return new Array(10).fill(1).reduce((f,g,x)=>(f[`${l}-${x+1}`]=h[x],f[`${l}${x+1}`]=h[x],f),{})}).reduce((l,h)=>(l=Object.assign(Object.assign({},l),h),l),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},n),o),Qz(n,{generateColorPalettes:HW,generateNeutralColorPalettes:qW})),e8(n.fontSize)),VW(n)),Jz(n)),WW(n))}const t8=cp(Cp),h_={token:Mp,hashed:!0},r8=xn.createContext(h_);function Mb(n){return n>=0&&n<=255}function i0(n,o){const{r:l,g:h,b:f,a:g}=new Di(n).toRgb();if(g<1)return n;const{r:x,g:E,b:w}=new Di(o).toRgb();for(let I=.01;I<=1;I+=.01){const R=Math.round((l-x*(1-I))/I),D=Math.round((h-E*(1-I))/I),F=Math.round((f-w*(1-I))/I);if(Mb(R)&&Mb(D)&&Mb(F))return new Di({r:R,g:D,b:F,a:Math.round(I*100)/100}).toRgbString()}return new Di({r:l,g:h,b:f,a:1}).toRgbString()}var YW=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};function n8(n){const{override:o}=n,l=YW(n,["override"]),h=Object.assign({},o);Object.keys(Mp).forEach(F=>{delete h[F]});const f=Object.assign(Object.assign({},l),h),g=480,x=576,E=768,w=992,I=1200,R=1600;if(f.motion===!1){const F="0s";f.motionDurationFast=F,f.motionDurationMid=F,f.motionDurationSlow=F}return Object.assign(Object.assign(Object.assign({},f),{colorFillContent:f.colorFillSecondary,colorFillContentHover:f.colorFill,colorFillAlter:f.colorFillQuaternary,colorBgContainerDisabled:f.colorFillTertiary,colorBorderBg:f.colorBgContainer,colorSplit:i0(f.colorBorderSecondary,f.colorBgContainer),colorTextPlaceholder:f.colorTextQuaternary,colorTextDisabled:f.colorTextQuaternary,colorTextHeading:f.colorText,colorTextLabel:f.colorTextSecondary,colorTextDescription:f.colorTextTertiary,colorTextLightSolid:f.colorWhite,colorHighlight:f.colorError,colorBgTextHover:f.colorFillSecondary,colorBgTextActive:f.colorFill,colorIcon:f.colorTextTertiary,colorIconHover:f.colorText,colorErrorOutline:i0(f.colorErrorBg,f.colorBgContainer),colorWarningOutline:i0(f.colorWarningBg,f.colorBgContainer),fontSizeIcon:f.fontSizeSM,lineWidthFocus:f.lineWidth*4,lineWidth:f.lineWidth,controlOutlineWidth:f.lineWidth*2,controlInteractiveSize:f.controlHeight/2,controlItemBgHover:f.colorFillTertiary,controlItemBgActive:f.colorPrimaryBg,controlItemBgActiveHover:f.colorPrimaryBgHover,controlItemBgActiveDisabled:f.colorFill,controlTmpOutline:f.colorFillQuaternary,controlOutline:i0(f.colorPrimaryBg,f.colorBgContainer),lineType:f.lineType,borderRadius:f.borderRadius,borderRadiusXS:f.borderRadiusXS,borderRadiusSM:f.borderRadiusSM,borderRadiusLG:f.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:f.sizeXXS,paddingXS:f.sizeXS,paddingSM:f.sizeSM,padding:f.size,paddingMD:f.sizeMD,paddingLG:f.sizeLG,paddingXL:f.sizeXL,paddingContentHorizontalLG:f.sizeLG,paddingContentVerticalLG:f.sizeMS,paddingContentHorizontal:f.sizeMS,paddingContentVertical:f.sizeSM,paddingContentHorizontalSM:f.size,paddingContentVerticalSM:f.sizeXS,marginXXS:f.sizeXXS,marginXS:f.sizeXS,marginSM:f.sizeSM,margin:f.size,marginMD:f.sizeMD,marginLG:f.sizeLG,marginXL:f.sizeXL,marginXXL:f.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:g,screenXSMin:g,screenXSMax:x-1,screenSM:x,screenSMMin:x,screenSMMax:E-1,screenMD:E,screenMDMin:E,screenMDMax:w-1,screenLG:w,screenLGMin:w,screenLGMax:I-1,screenXL:I,screenXLMin:I,screenXLMax:R-1,screenXXL:R,screenXXLMin:R,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new Di("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new Di("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new Di("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),h)}var bI=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};const i8=(n,o,l)=>{const h=l.getDerivativeToken(n),{override:f}=o,g=bI(o,["override"]);let x=Object.assign(Object.assign({},h),{override:f});return x=n8(x),g&&Object.entries(g).forEach(E=>{let[w,I]=E;const{theme:R}=I,D=bI(I,["theme"]);let F=D;R&&(F=i8(Object.assign(Object.assign({},x),D),{override:D},R)),x[w]=F}),x};function Vc(){const{token:n,hashed:o,theme:l,components:h}=xn.useContext(r8),f=`${EW}-${o||""}`,g=l||t8,[x,E]=zG(g,[Mp,n],{salt:f,override:Object.assign({override:n},h),getComputedToken:i8});return[g,x,o?E:""]}function Ba(n){var o=A.useRef();o.current=n;var l=A.useCallback(function(){for(var h,f=arguments.length,g=new Array(f),x=0;x<f;x++)g[x]=arguments[x];return(h=o.current)===null||h===void 0?void 0:h.call.apply(h,[o].concat(g))},[]);return l}function Cc(n){var o=A.useRef(!1),l=A.useState(n),h=Ht(l,2),f=h[0],g=h[1];A.useEffect(function(){return o.current=!1,function(){o.current=!0}},[]);function x(E,w){w&&o.current||g(E)}return[f,x]}function Cb(n){return n!==void 0}function U3(n,o){var l=o||{},h=l.defaultValue,f=l.value,g=l.onChange,x=l.postState,E=Cc(function(){return Cb(f)?f:Cb(h)?typeof h=="function"?h():h:typeof n=="function"?n():n}),w=Ht(E,2),I=w[0],R=w[1],D=f!==void 0?f:I,F=x?x(D):D,q=Ba(g),G=Cc([D]),j=Ht(G,2),te=j[0],N=j[1];iI(function(){var V=te[0];I!==V&&q(I,V)},[te]),iI(function(){Cb(f)||R(f)},[f]);var O=Ba(function(V,U){R(V,U),N([D],U)});return[F,O]}const o8="anticon",KW=(n,o)=>o||(n?`ant-${n}`:"ant"),wn=A.createContext({getPrefixCls:KW,iconPrefixCls:o8}),JW=(n,o,l,h,f)=>{const g=n/2,x=0,E=g,w=l*1/Math.sqrt(2),I=g-l*(1-1/Math.sqrt(2)),R=g-o*(1/Math.sqrt(2)),D=l*(Math.sqrt(2)-1)+o*(1/Math.sqrt(2)),F=2*g-R,q=D,G=2*g-w,j=I,te=2*g-x,N=E,O=g*Math.sqrt(2)+l*(Math.sqrt(2)-2),V=l*(Math.sqrt(2)-1);return{pointerEvents:"none",width:n,height:n,overflow:"hidden","&::before":{position:"absolute",bottom:0,insetInlineStart:0,width:n,height:n/2,background:h,clipPath:{_multi_value_:!0,value:[`polygon(${V}px 100%, 50% ${V}px, ${2*g-V}px 100%, ${V}px 100%)`,`path('M ${x} ${E} A ${l} ${l} 0 0 0 ${w} ${I} L ${R} ${D} A ${o} ${o} 0 0 1 ${F} ${q} L ${G} ${j} A ${l} ${l} 0 0 0 ${te} ${N} Z')`]},content:'""'},"&::after":{content:'""',position:"absolute",width:O,height:O,bottom:0,insetInline:0,margin:"auto",borderRadius:{_skip_check_:!0,value:`0 0 ${o}px 0`},transform:"translateY(50%) rotate(-135deg)",boxShadow:f,zIndex:0,background:"transparent"}}},Dl=n=>({boxSizing:"border-box",margin:0,padding:0,color:n.colorText,fontSize:n.fontSize,lineHeight:n.lineHeight,listStyle:"none",fontFamily:n.fontFamily}),QW=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),eH=n=>({a:{color:n.colorLink,textDecoration:n.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${n.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:n.colorLinkHover},"&:active":{color:n.colorLinkActive},"&:active,\n  &:hover":{textDecoration:n.linkHoverDecoration,outline:0},"&:focus":{textDecoration:n.linkFocusDecoration,outline:0},"&[disabled]":{color:n.colorTextDisabled,cursor:"not-allowed"}}}),tH=(n,o)=>{const{fontFamily:l,fontSize:h}=n,f=`[class^="${o}"], [class*=" ${o}"]`;return{[f]:{fontFamily:l,fontSize:h,boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"},[f]:{boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}}}}},G3=n=>({outline:`${n.lineWidthFocus}px solid ${n.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"}),rH=n=>({"&:focus-visible":Object.assign({},G3(n))}),a8=typeof CSSINJS_STATISTIC<"u";let rw=!0;function to(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];if(!a8)return Object.assign.apply(Object,[{}].concat(o));rw=!1;const h={};return o.forEach(f=>{Object.keys(f).forEach(x=>{Object.defineProperty(h,x,{configurable:!0,enumerable:!0,get:()=>f[x]})})}),rw=!0,h}function nH(){}function iH(n){let o,l=n,h=nH;return a8&&(o=new Set,l=new Proxy(n,{get(f,g){return rw&&o.add(g),f[g]}}),h=(f,g)=>{Array.from(o)}),{token:l,keys:o,flush:h}}function ba(n,o,l,h){return f=>{const[g,x,E]=Vc(),{getPrefixCls:w,iconPrefixCls:I,csp:R}=A.useContext(wn),D=w(),F={theme:g,token:x,hashId:E,nonce:()=>R==null?void 0:R.nonce,clientOnly:h==null?void 0:h.clientOnly,order:-999};return J2(Object.assign(Object.assign({},F),{clientOnly:!1,path:["Shared",D]}),()=>[{"&":eH(x)}]),[J2(Object.assign(Object.assign({},F),{path:[n,f,I]}),()=>{const{token:q,flush:G}=iH(x),j=Object.assign({},x[n]);if(h!=null&&h.deprecatedTokens){const{deprecatedTokens:ae}=h;ae.forEach(le=>{let[ne,de]=le;var $;(j!=null&&j[ne]||j!=null&&j[de])&&(($=j[de])!==null&&$!==void 0||(j[de]=j==null?void 0:j[ne]))})}const te=typeof l=="function"?l(to(q,j??{})):l,N=Object.assign(Object.assign({},te),j),O=`.${f}`,V=to(q,{componentCls:O,prefixCls:f,iconCls:`.${I}`,antCls:`.${D}`},N),U=o(V,{hashId:E,prefixCls:f,rootPrefixCls:D,iconPrefixCls:I,overrideComponentToken:j});return G(n,N),[(h==null?void 0:h.resetStyle)===!1?null:tH(x,f),U]}),E]}}function oH(n,o){return u_.reduce((l,h)=>{const f=n[`${h}1`],g=n[`${h}3`],x=n[`${h}6`],E=n[`${h}7`];return Object.assign(Object.assign({},l),o(h,{lightColor:f,lightBorderColor:g,darkColor:x,textColor:E}))},{})}const aH=`-ant-${Date.now()}-${Math.random()}`;function sH(n,o){const l={},h=(x,E)=>{let w=x.clone();return w=(E==null?void 0:E(w))||w,w.toRgbString()},f=(x,E)=>{const w=new Di(x),I=Ss(w.toRgbString());l[`${E}-color`]=h(w),l[`${E}-color-disabled`]=I[1],l[`${E}-color-hover`]=I[4],l[`${E}-color-active`]=I[6],l[`${E}-color-outline`]=w.clone().setAlpha(.2).toRgbString(),l[`${E}-color-deprecated-bg`]=I[0],l[`${E}-color-deprecated-border`]=I[2]};if(o.primaryColor){f(o.primaryColor,"primary");const x=new Di(o.primaryColor),E=Ss(x.toRgbString());E.forEach((I,R)=>{l[`primary-${R+1}`]=I}),l["primary-color-deprecated-l-35"]=h(x,I=>I.lighten(35)),l["primary-color-deprecated-l-20"]=h(x,I=>I.lighten(20)),l["primary-color-deprecated-t-20"]=h(x,I=>I.tint(20)),l["primary-color-deprecated-t-50"]=h(x,I=>I.tint(50)),l["primary-color-deprecated-f-12"]=h(x,I=>I.setAlpha(I.getAlpha()*.12));const w=new Di(E[0]);l["primary-color-active-deprecated-f-30"]=h(w,I=>I.setAlpha(I.getAlpha()*.3)),l["primary-color-active-deprecated-d-02"]=h(w,I=>I.darken(2))}return o.successColor&&f(o.successColor,"success"),o.warningColor&&f(o.warningColor,"warning"),o.errorColor&&f(o.errorColor,"error"),o.infoColor&&f(o.infoColor,"info"),`
  :root {
    ${Object.keys(l).map(x=>`--${n}-${x}: ${l[x]};`).join(`
`)}
  }
  `.trim()}function lH(n,o){const l=sH(n,o);Oi()&&jh(l,`${aH}-dynamic-theme`)}const nw=A.createContext(!1),s8=n=>{let{children:o,disabled:l}=n;const h=A.useContext(nw);return A.createElement(nw.Provider,{value:l??h},o)},J_=nw,iw=A.createContext(void 0),l8=n=>{let{children:o,size:l}=n;const h=A.useContext(iw);return A.createElement(iw.Provider,{value:l||h},o)},Q_=iw;function cH(){const n=A.useContext(J_),o=A.useContext(Q_);return{componentDisabled:n,componentSize:o}}function uH(n,o){const l=n||{},h=l.inherit===!1||!o?h_:o;return jw(()=>{if(!n)return o;const f=Object.assign({},h.components);return Object.keys(n.components||{}).forEach(g=>{f[g]=Object.assign(Object.assign({},f[g]),n.components[g])}),Object.assign(Object.assign(Object.assign({},h),l),{token:Object.assign(Object.assign({},h.token),l.token),components:f})},[l,h],(f,g)=>f.some((x,E)=>{const w=g[E];return!Cz(x,w,!0)}))}var hH=["children"],c8=A.createContext({});function dH(n){var o=n.children,l=xa(n,hH);return A.createElement(c8.Provider,{value:l},o)}var fH=function(n){b_(l,n);var o=w_(l);function l(){return Va(this,l),o.apply(this,arguments)}return Ua(l,[{key:"render",value:function(){return this.props.children}}]),l}(A.Component),fc="none",o0="appear",a0="enter",s0="leave",wI="none",ha="prepare",xh="start",bh="active",W3="end",u8="prepared";function EI(n,o){var l={};return l[n.toLowerCase()]=o.toLowerCase(),l["Webkit".concat(n)]="webkit".concat(o),l["Moz".concat(n)]="moz".concat(o),l["ms".concat(n)]="MS".concat(o),l["O".concat(n)]="o".concat(o.toLowerCase()),l}function pH(n,o){var l={animationend:EI("Animation","AnimationEnd"),transitionend:EI("Transition","TransitionEnd")};return n&&("AnimationEvent"in o||delete l.animationend.animation,"TransitionEvent"in o||delete l.transitionend.transition),l}var mH=pH(Oi(),typeof window<"u"?window:{}),h8={};if(Oi()){var gH=document.createElement("div");h8=gH.style}var l0={};function d8(n){if(l0[n])return l0[n];var o=mH[n];if(o)for(var l=Object.keys(o),h=l.length,f=0;f<h;f+=1){var g=l[f];if(Object.prototype.hasOwnProperty.call(o,g)&&g in h8)return l0[n]=o[g],l0[n]}return""}var f8=d8("animationend"),p8=d8("transitionend"),m8=!!(f8&&p8),SI=f8||"animationend",TI=p8||"transitionend";function MI(n,o){if(!n)return null;if(bn(n)==="object"){var l=o.replace(/-\w/g,function(h){return h[1].toUpperCase()});return n[l]}return"".concat(n,"-").concat(o)}const _H=function(n){var o=A.useRef(),l=A.useRef(n);l.current=n;var h=A.useCallback(function(x){l.current(x)},[]);function f(x){x&&(x.removeEventListener(TI,h),x.removeEventListener(SI,h))}function g(x){o.current&&o.current!==x&&f(o.current),x&&x!==o.current&&(x.addEventListener(TI,h),x.addEventListener(SI,h),o.current=x)}return A.useEffect(function(){return function(){f(o.current)}},[]),[g,f]};var g8=Oi()?A.useLayoutEffect:A.useEffect;const yH=function(){var n=A.useRef(null);function o(){va.cancel(n.current)}function l(h){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;o();var g=va(function(){f<=1?h({isCanceled:function(){return g!==n.current}}):l(h,f-1)});n.current=g}return A.useEffect(function(){return function(){o()}},[]),[l,o]};var vH=[ha,xh,bh,W3],xH=[ha,u8],_8=!1,bH=!0;function y8(n){return n===bh||n===W3}const wH=function(n,o,l){var h=Cc(wI),f=Ht(h,2),g=f[0],x=f[1],E=yH(),w=Ht(E,2),I=w[0],R=w[1];function D(){x(ha,!0)}var F=o?xH:vH;return g8(function(){if(g!==wI&&g!==W3){var q=F.indexOf(g),G=F[q+1],j=l(g);j===_8?x(G,!0):G&&I(function(te){function N(){te.isCanceled()||x(G,!0)}j===!0?N():Promise.resolve(j).then(N)})}},[n,g]),A.useEffect(function(){return function(){R()}},[]),[D,g]};function EH(n,o,l,h){var f=h.motionEnter,g=f===void 0?!0:f,x=h.motionAppear,E=x===void 0?!0:x,w=h.motionLeave,I=w===void 0?!0:w,R=h.motionDeadline,D=h.motionLeaveImmediately,F=h.onAppearPrepare,q=h.onEnterPrepare,G=h.onLeavePrepare,j=h.onAppearStart,te=h.onEnterStart,N=h.onLeaveStart,O=h.onAppearActive,V=h.onEnterActive,U=h.onLeaveActive,ae=h.onAppearEnd,le=h.onEnterEnd,ne=h.onLeaveEnd,de=h.onVisibleChanged,$=Cc(),ue=Ht($,2),xe=ue[0],ce=ue[1],se=Cc(fc),ke=Ht(se,2),$e=ke[0],Ne=ke[1],it=Cc(null),Re=Ht(it,2),He=Re[0],Xe=Re[1],ze=A.useRef(!1),at=A.useRef(null);function Pt(){return l()}var mt=A.useRef(!1);function kt(){Ne(fc,!0),Xe(null,!0)}function Oe(re){var we=Pt();if(!(re&&!re.deadline&&re.target!==we)){var Ie=mt.current,Qe;$e===o0&&Ie?Qe=ae==null?void 0:ae(we,re):$e===a0&&Ie?Qe=le==null?void 0:le(we,re):$e===s0&&Ie&&(Qe=ne==null?void 0:ne(we,re)),$e!==fc&&Ie&&Qe!==!1&&kt()}}var qt=_H(Oe),Sr=Ht(qt,1),Ir=Sr[0],Xr=function(we){var Ie,Qe,tt;switch(we){case o0:return Ie={},$r(Ie,ha,F),$r(Ie,xh,j),$r(Ie,bh,O),Ie;case a0:return Qe={},$r(Qe,ha,q),$r(Qe,xh,te),$r(Qe,bh,V),Qe;case s0:return tt={},$r(tt,ha,G),$r(tt,xh,N),$r(tt,bh,U),tt;default:return{}}},Ur=A.useMemo(function(){return Xr($e)},[$e]),pr=wH($e,!n,function(re){if(re===ha){var we=Ur[ha];return we?we(Pt()):_8}if(xr in Ur){var Ie;Xe(((Ie=Ur[xr])===null||Ie===void 0?void 0:Ie.call(Ur,Pt(),null))||null)}return xr===bh&&(Ir(Pt()),R>0&&(clearTimeout(at.current),at.current=setTimeout(function(){Oe({deadline:!0})},R))),xr===u8&&kt(),bH}),ar=Ht(pr,2),hr=ar[0],xr=ar[1],Fe=y8(xr);mt.current=Fe,g8(function(){ce(o);var re=ze.current;ze.current=!0;var we;!re&&o&&E&&(we=o0),re&&o&&g&&(we=a0),(re&&!o&&I||!re&&D&&!o&&I)&&(we=s0);var Ie=Xr(we);we&&(n||Ie[ha])?(Ne(we),hr()):Ne(fc)},[o]),A.useEffect(function(){($e===o0&&!E||$e===a0&&!g||$e===s0&&!I)&&Ne(fc)},[E,g,I]),A.useEffect(function(){return function(){ze.current=!1,clearTimeout(at.current)}},[]);var Y=A.useRef(!1);A.useEffect(function(){xe&&(Y.current=!0),xe!==void 0&&$e===fc&&((Y.current||xe)&&(de==null||de(xe)),Y.current=!0)},[xe,$e]);var ee=He;return Ur[ha]&&xr===xh&&(ee=ft({transition:"none"},ee)),[$e,xr,ee,xe??o]}function SH(n){var o=n;bn(n)==="object"&&(o=n.transitionSupport);function l(f,g){return!!(f.motionName&&o&&g!==!1)}var h=A.forwardRef(function(f,g){var x=f.visible,E=x===void 0?!0:x,w=f.removeOnLeave,I=w===void 0?!0:w,R=f.forceRender,D=f.children,F=f.motionName,q=f.leavedClassName,G=f.eventProps,j=A.useContext(c8),te=j.motion,N=l(f,te),O=A.useRef(),V=A.useRef();function U(){try{return O.current instanceof HTMLElement?O.current:U2(V.current)}catch{return null}}var ae=EH(N,E,U,f),le=Ht(ae,4),ne=le[0],de=le[1],$=le[2],ue=le[3],xe=A.useRef(ue);ue&&(xe.current=!0);var ce=A.useCallback(function(Xe){O.current=Xe,$w(g,Xe)},[g]),se,ke=ft(ft({},G),{},{visible:E});if(!D)se=null;else if(ne===fc)ue?se=D(ft({},ke),ce):!I&&xe.current&&q?se=D(ft(ft({},ke),{},{className:q}),ce):R||!I&&!q?se=D(ft(ft({},ke),{},{style:{display:"none"}}),ce):se=null;else{var $e,Ne;de===ha?Ne="prepare":y8(de)?Ne="active":de===xh&&(Ne="start");var it=MI(F,"".concat(ne,"-").concat(Ne));se=D(ft(ft({},ke),{},{className:$t(MI(F,ne),($e={},$r($e,it,it&&Ne),$r($e,F,typeof F=="string"),$e)),style:$}),ce)}if(A.isValidElement(se)&&Hh(se)){var Re=se,He=Re.ref;He||(se=A.cloneElement(se,{ref:ce}))}return A.createElement(fH,{ref:V},se)});return h.displayName="CSSMotion",h}const Yh=SH(m8);var ow="add",aw="keep",sw="remove",Ab="removed";function TH(n){var o;return n&&bn(n)==="object"&&"key"in n?o=n:o={key:n},ft(ft({},o),{},{key:String(o.key)})}function lw(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return n.map(TH)}function MH(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=[],h=0,f=o.length,g=lw(n),x=lw(o);g.forEach(function(I){for(var R=!1,D=h;D<f;D+=1){var F=x[D];if(F.key===I.key){h<D&&(l=l.concat(x.slice(h,D).map(function(q){return ft(ft({},q),{},{status:ow})})),h=D),l.push(ft(ft({},F),{},{status:aw})),h+=1,R=!0;break}}R||l.push(ft(ft({},I),{},{status:sw}))}),h<f&&(l=l.concat(x.slice(h).map(function(I){return ft(ft({},I),{},{status:ow})})));var E={};l.forEach(function(I){var R=I.key;E[R]=(E[R]||0)+1});var w=Object.keys(E).filter(function(I){return E[I]>1});return w.forEach(function(I){l=l.filter(function(R){var D=R.key,F=R.status;return D!==I||F!==sw}),l.forEach(function(R){R.key===I&&(R.status=aw)})}),l}var CH=["component","children","onVisibleChanged","onAllRemoved"],AH=["status"],IH=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function PH(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Yh,l=function(h){b_(g,h);var f=w_(g);function g(){var x;Va(this,g);for(var E=arguments.length,w=new Array(E),I=0;I<E;I++)w[I]=arguments[I];return x=f.call.apply(f,[this].concat(w)),$r(D0(x),"state",{keyEntities:[]}),$r(D0(x),"removeKey",function(R){var D=x.state.keyEntities,F=D.map(function(q){return q.key!==R?q:ft(ft({},q),{},{status:Ab})});return x.setState({keyEntities:F}),F.filter(function(q){var G=q.status;return G!==Ab}).length}),x}return Ua(g,[{key:"render",value:function(){var E=this,w=this.state.keyEntities,I=this.props,R=I.component,D=I.children,F=I.onVisibleChanged,q=I.onAllRemoved,G=xa(I,CH),j=R||A.Fragment,te={};return IH.forEach(function(N){te[N]=G[N],delete G[N]}),delete G.keys,A.createElement(j,G,w.map(function(N){var O=N.status,V=xa(N,AH),U=O===ow||O===aw;return A.createElement(o,ui({},te,{key:V.key,visible:U,eventProps:V,onVisibleChanged:function(le){if(F==null||F(le,{key:V.key}),!le){var ne=E.removeKey(V.key);ne===0&&q&&q()}}}),D)}))}}],[{key:"getDerivedStateFromProps",value:function(E,w){var I=E.keys,R=w.keyEntities,D=lw(I),F=MH(R,D);return{keyEntities:F.filter(function(q){var G=R.find(function(j){var te=j.key;return q.key===te});return!(G&&G.status===Ab&&q.status===sw)})}}}]),g}(A.Component);return $r(l,"defaultProps",{component:"div"}),l}const kH=PH(m8);function RH(n){const{children:o}=n,[,l]=Vc(),{motion:h}=l,f=A.useRef(!1);return f.current=f.current||h===!1,f.current?A.createElement(dH,{motion:h},o):o}const zH=(n,o)=>{const[l,h]=Vc();return J2({theme:l,token:h,hashId:"",path:["ant-design-icons",n],nonce:()=>o==null?void 0:o.nonce},()=>[{[`.${n}`]:Object.assign(Object.assign({},QW()),{[`.${n} .${n}-icon`]:{display:"block"}})}])},DH=zH;var LH=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};const OH=["getTargetContainer","getPopupContainer","renderEmpty","pageHeader","input","pagination","form","select","button"],FH="ant";let v8;function BH(){return v8||FH}function NH(n){return Object.keys(n).some(o=>o.endsWith("Color"))}const jH=n=>{let{prefixCls:o,iconPrefixCls:l,theme:h}=n;o!==void 0&&(v8=o),h&&NH(h)&&lH(BH(),h)},$H=n=>{const{children:o,csp:l,autoInsertSpaceInButton:h,alert:f,anchor:g,form:x,locale:E,componentSize:w,direction:I,space:R,virtual:D,dropdownMatchSelectWidth:F,popupMatchSelectWidth:q,popupOverflow:G,legacyLocale:j,parentContext:te,iconPrefixCls:N,theme:O,componentDisabled:V,segmented:U,statistic:ae,spin:le,calendar:ne,carousel:de,cascader:$,collapse:ue,typography:xe,checkbox:ce,descriptions:se,divider:ke,drawer:$e,skeleton:Ne,steps:it,image:Re,layout:He,list:Xe,mentions:ze,modal:at,progress:Pt,result:mt,slider:kt,breadcrumb:Oe,menu:qt,pagination:Sr,input:Ir,empty:Xr,badge:Ur,radio:pr,rate:ar,switch:hr,transfer:xr,avatar:Fe,message:Y,tag:ee,table:re,card:we,tabs:Ie,timeline:Qe,timePicker:tt,upload:Be,notification:gt,tree:Tt,colorPicker:At,datePicker:mr,wave:nn}=n,Pr=A.useCallback((ye,be)=>{const{prefixCls:Me}=n;if(be)return be;const De=Me||te.getPrefixCls("");return ye?`${De}-${ye}`:De},[te.getPrefixCls,n.prefixCls]),Cr=N||te.iconPrefixCls||o8,Yr=Cr!==te.iconPrefixCls,br=l||te.csp,Te=DH(Cr,br),Pe=uH(O,te.theme),et={csp:br,autoInsertSpaceInButton:h,alert:f,anchor:g,locale:E||j,direction:I,space:R,virtual:D,popupMatchSelectWidth:q??F,popupOverflow:G,getPrefixCls:Pr,iconPrefixCls:Cr,theme:Pe,segmented:U,statistic:ae,spin:le,calendar:ne,carousel:de,cascader:$,collapse:ue,typography:xe,checkbox:ce,descriptions:se,divider:ke,drawer:$e,skeleton:Ne,steps:it,image:Re,input:Ir,layout:He,list:Xe,mentions:ze,modal:at,progress:Pt,result:mt,slider:kt,breadcrumb:Oe,menu:qt,pagination:Sr,empty:Xr,badge:Ur,radio:pr,rate:ar,switch:hr,transfer:xr,avatar:Fe,message:Y,tag:ee,table:re,card:we,tabs:Ie,timeline:Qe,timePicker:tt,upload:Be,notification:gt,tree:Tt,colorPicker:At,datePicker:mr,wave:nn},_t=Object.assign({},te);Object.keys(et).forEach(ye=>{et[ye]!==void 0&&(_t[ye]=et[ye])}),OH.forEach(ye=>{const be=n[ye];be&&(_t[ye]=be)});const Rt=jw(()=>_t,_t,(ye,be)=>{const Me=Object.keys(ye),De=Object.keys(be);return Me.length!==De.length||Me.some(Le=>ye[Le]!==be[Le])}),bt=A.useMemo(()=>({prefixCls:Cr,csp:br}),[Cr,br]);let ct=Yr?Te(o):o;const It=A.useMemo(()=>{var ye,be,Me,De;return vh(((ye=zc.Form)===null||ye===void 0?void 0:ye.defaultValidateMessages)||{},((Me=(be=Rt.locale)===null||be===void 0?void 0:be.Form)===null||Me===void 0?void 0:Me.defaultValidateMessages)||{},((De=Rt.form)===null||De===void 0?void 0:De.validateMessages)||{},(x==null?void 0:x.validateMessages)||{})},[Rt,x==null?void 0:x.validateMessages]);Object.keys(It).length>0&&(ct=A.createElement(qz.Provider,{value:It},o)),E&&(ct=A.createElement(wW,{locale:E,_ANT_MARK__:xW},ct)),(Cr||br)&&(ct=A.createElement(j3.Provider,{value:bt},ct)),w&&(ct=A.createElement(l8,{size:w},ct)),ct=A.createElement(RH,null,ct);const Mt=A.useMemo(()=>{const ye=Pe||{},{algorithm:be,token:Me,components:De}=ye,Le=LH(ye,["algorithm","token","components"]),qe=be&&(!Array.isArray(be)||be.length>0)?cp(be):t8,Ue={};return Object.entries(De||{}).forEach(Ze=>{let[ot,We]=Ze;const xt=Object.assign({},We);"algorithm"in xt&&(xt.algorithm===!0?xt.theme=qe:(Array.isArray(xt.algorithm)||typeof xt.algorithm=="function")&&(xt.theme=cp(xt.algorithm)),delete xt.algorithm),Ue[ot]=xt}),Object.assign(Object.assign({},Le),{theme:qe,token:Object.assign(Object.assign({},Mp),Me),components:Ue})},[Pe]);return O&&(ct=A.createElement(r8.Provider,{value:Mt},ct)),V!==void 0&&(ct=A.createElement(s8,{disabled:V},ct)),A.createElement(wn.Provider,{value:Rt},ct)},Kh=n=>{const o=A.useContext(wn),l=A.useContext($3);return A.createElement($H,Object.assign({parentContext:o,legacyLocale:l},n))};Kh.ConfigContext=wn;Kh.SizeContext=Q_;Kh.config=jH;Kh.useConfig=cH;Object.defineProperty(Kh,"SizeContext",{get:()=>Q_});const VH=Kh;var UH={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm193.5 301.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.2 0 19.9 4.9 25.9 13.3l71.2 98.8 157.2-218c6-8.3 15.6-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.5 12.7z"}}]},name:"check-circle",theme:"filled"};const GH=UH;var WH=1/0,HH="[object Symbol]",qH=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ZH=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ey="\\ud800-\\udfff",x8="\\u0300-\\u036f\\ufe20-\\ufe23",b8="\\u20d0-\\u20f0",w8="\\u2700-\\u27bf",E8="a-z\\xdf-\\xf6\\xf8-\\xff",XH="\\xac\\xb1\\xd7\\xf7",YH="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",KH="\\u2000-\\u206f",JH=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",S8="A-Z\\xc0-\\xd6\\xd8-\\xde",T8="\\ufe0e\\ufe0f",M8=XH+YH+KH+JH,H3="['’]",QH="["+ey+"]",CI="["+M8+"]",d_="["+x8+b8+"]",C8="\\d+",eq="["+w8+"]",A8="["+E8+"]",I8="[^"+ey+M8+C8+w8+E8+S8+"]",cw="\\ud83c[\\udffb-\\udfff]",tq="(?:"+d_+"|"+cw+")",P8="[^"+ey+"]",q3="(?:\\ud83c[\\udde6-\\uddff]){2}",Z3="[\\ud800-\\udbff][\\udc00-\\udfff]",nh="["+S8+"]",k8="\\u200d",AI="(?:"+A8+"|"+I8+")",rq="(?:"+nh+"|"+I8+")",II="(?:"+H3+"(?:d|ll|m|re|s|t|ve))?",PI="(?:"+H3+"(?:D|LL|M|RE|S|T|VE))?",R8=tq+"?",z8="["+T8+"]?",nq="(?:"+k8+"(?:"+[P8,q3,Z3].join("|")+")"+z8+R8+")*",D8=z8+R8+nq,iq="(?:"+[eq,q3,Z3].join("|")+")"+D8,oq="(?:"+[P8+d_+"?",d_,q3,Z3,QH].join("|")+")",aq=RegExp(H3,"g"),sq=RegExp(d_,"g"),lq=RegExp(cw+"(?="+cw+")|"+oq+D8,"g"),cq=RegExp([nh+"?"+A8+"+"+II+"(?="+[CI,nh,"$"].join("|")+")",rq+"+"+PI+"(?="+[CI,nh+AI,"$"].join("|")+")",nh+"?"+AI+"+"+II,nh+"+"+PI,C8,iq].join("|"),"g"),uq=RegExp("["+k8+ey+x8+b8+T8+"]"),hq=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,dq={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"ss"},fq=typeof Sf=="object"&&Sf&&Sf.Object===Object&&Sf,pq=typeof self=="object"&&self&&self.Object===Object&&self,mq=fq||pq||Function("return this")();function gq(n,o,l,h){var f=-1,g=n?n.length:0;for(h&&g&&(l=n[++f]);++f<g;)l=o(l,n[f],f,n);return l}function _q(n){return n.split("")}function yq(n){return n.match(qH)||[]}function vq(n){return function(o){return n==null?void 0:n[o]}}var xq=vq(dq);function L8(n){return uq.test(n)}function bq(n){return hq.test(n)}function wq(n){return L8(n)?Eq(n):_q(n)}function Eq(n){return n.match(lq)||[]}function Sq(n){return n.match(cq)||[]}var Tq=Object.prototype,Mq=Tq.toString,kI=mq.Symbol,RI=kI?kI.prototype:void 0,zI=RI?RI.toString:void 0;function Cq(n,o,l){var h=-1,f=n.length;o<0&&(o=-o>f?0:f+o),l=l>f?f:l,l<0&&(l+=f),f=o>l?0:l-o>>>0,o>>>=0;for(var g=Array(f);++h<f;)g[h]=n[h+o];return g}function Aq(n){if(typeof n=="string")return n;if(zq(n))return zI?zI.call(n):"";var o=n+"";return o=="0"&&1/n==-WH?"-0":o}function Iq(n,o,l){var h=n.length;return l=l===void 0?h:l,!o&&l>=h?n:Cq(n,o,l)}function Pq(n){return function(o){o=ty(o);var l=L8(o)?wq(o):void 0,h=l?l[0]:o.charAt(0),f=l?Iq(l,1).join(""):o.slice(1);return h[n]()+f}}function kq(n){return function(o){return gq(Bq(Oq(o).replace(aq,"")),n,"")}}function Rq(n){return!!n&&typeof n=="object"}function zq(n){return typeof n=="symbol"||Rq(n)&&Mq.call(n)==HH}function ty(n){return n==null?"":Aq(n)}var Dq=kq(function(n,o,l){return o=o.toLowerCase(),n+(l?Lq(o):o)});function Lq(n){return Fq(ty(n).toLowerCase())}function Oq(n){return n=ty(n),n&&n.replace(ZH,xq).replace(sq,"")}var Fq=Pq("toUpperCase");function Bq(n,o,l){return n=ty(n),o=l?void 0:o,o===void 0?bq(n)?Sq(n):yq(n):n.match(o)||[]}var Nq=Dq;const jq=Gh(Nq);function O8(n){var o;return n==null||(o=n.getRootNode)===null||o===void 0?void 0:o.call(n)}function $q(n){return O8(n)instanceof ShadowRoot}function f_(n){return $q(n)?O8(n):null}function Vq(n,o){xo(n,"[@ant-design/icons] ".concat(o))}function DI(n){return bn(n)==="object"&&typeof n.name=="string"&&typeof n.theme=="string"&&(bn(n.icon)==="object"||typeof n.icon=="function")}function LI(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return Object.keys(n).reduce(function(o,l){var h=n[l];switch(l){case"class":o.className=h,delete o.class;break;default:delete o[l],o[jq(l)]=h}return o},{})}function uw(n,o,l){return l?xn.createElement(n.tag,ft(ft({key:o},LI(n.attrs)),l),(n.children||[]).map(function(h,f){return uw(h,"".concat(o,"-").concat(n.tag,"-").concat(f))})):xn.createElement(n.tag,ft({key:o},LI(n.attrs)),(n.children||[]).map(function(h,f){return uw(h,"".concat(o,"-").concat(n.tag,"-").concat(f))}))}function F8(n){return Ss(n)[0]}function B8(n){return n?Array.isArray(n)?n:[n]:[]}var Uq=`
.anticon {
  display: inline-block;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
`,Gq=function(o){var l=A.useContext(j3),h=l.csp,f=l.prefixCls,g=Uq;f&&(g=g.replace(/anticon/g,f)),A.useEffect(function(){var x=o.current,E=f_(x);jh(g,"@ant-design-icons",{prepend:!0,csp:h,attachTo:E})},[])},Wq=["icon","className","onClick","style","primaryColor","secondaryColor"],jf={primaryColor:"#333",secondaryColor:"#E6E6E6",calculated:!1};function Hq(n){var o=n.primaryColor,l=n.secondaryColor;jf.primaryColor=o,jf.secondaryColor=l||F8(o),jf.calculated=!!l}function qq(){return ft({},jf)}var ry=function(o){var l=o.icon,h=o.className,f=o.onClick,g=o.style,x=o.primaryColor,E=o.secondaryColor,w=xa(o,Wq),I=A.useRef(),R=jf;if(x&&(R={primaryColor:x,secondaryColor:E||F8(x)}),Gq(I),Vq(DI(l),"icon should be icon definiton, but got ".concat(l)),!DI(l))return null;var D=l;return D&&typeof D.icon=="function"&&(D=ft(ft({},D),{},{icon:D.icon(R.primaryColor,R.secondaryColor)})),uw(D.icon,"svg-".concat(D.name),ft(ft({className:h,onClick:f,style:g,"data-icon":D.name,width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true"},w),{},{ref:I}))};ry.displayName="IconReact";ry.getTwoToneColors=qq;ry.setTwoToneColors=Hq;const X3=ry;function N8(n){var o=B8(n),l=Ht(o,2),h=l[0],f=l[1];return X3.setTwoToneColors({primaryColor:h,secondaryColor:f})}function Zq(){var n=X3.getTwoToneColors();return n.calculated?[n.primaryColor,n.secondaryColor]:n.primaryColor}var Xq=["className","icon","spin","rotate","tabIndex","onClick","twoToneColor"];N8(jW.primary);var ny=A.forwardRef(function(n,o){var l,h=n.className,f=n.icon,g=n.spin,x=n.rotate,E=n.tabIndex,w=n.onClick,I=n.twoToneColor,R=xa(n,Xq),D=A.useContext(j3),F=D.prefixCls,q=F===void 0?"anticon":F,G=D.rootClassName,j=$t(G,q,(l={},$r(l,"".concat(q,"-").concat(f.name),!!f.name),$r(l,"".concat(q,"-spin"),!!g||f.name==="loading"),l),h),te=E;te===void 0&&w&&(te=-1);var N=x?{msTransform:"rotate(".concat(x,"deg)"),transform:"rotate(".concat(x,"deg)")}:void 0,O=B8(I),V=Ht(O,2),U=V[0],ae=V[1];return A.createElement("span",ui({role:"img","aria-label":f.name},R,{ref:o,tabIndex:te,onClick:w,className:j}),A.createElement(X3,{icon:f,primaryColor:U,secondaryColor:ae,style:N}))});ny.displayName="AntdIcon";ny.getTwoToneColor=Zq;ny.setTwoToneColor=N8;const Uc=ny;var Yq=function(o,l){return A.createElement(Uc,ui({},o,{ref:l,icon:GH}))};const j8=A.forwardRef(Yq);var Kq={icon:{tag:"svg",attrs:{"fill-rule":"evenodd",viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64c247.4 0 448 200.6 448 448S759.4 960 512 960 64 759.4 64 512 264.6 64 512 64zm127.98 274.82h-.04l-.08.06L512 466.75 384.14 338.88c-.04-.05-.06-.06-.08-.06a.12.12 0 00-.07 0c-.03 0-.05.01-.09.05l-45.02 45.02a.2.2 0 00-.05.09.12.12 0 000 .07v.02a.27.27 0 00.06.06L466.75 512 338.88 639.86c-.05.04-.06.06-.06.08a.12.12 0 000 .07c0 .03.01.05.05.09l45.02 45.02a.2.2 0 00.09.05.12.12 0 00.07 0c.02 0 .04-.01.08-.05L512 557.25l127.86 127.87c.04.04.06.05.08.05a.12.12 0 00.07 0c.03 0 .05-.01.09-.05l45.02-45.02a.2.2 0 00.05-.09.12.12 0 000-.07v-.02a.27.27 0 00-.05-.06L557.25 512l127.87-127.86c.04-.04.05-.06.05-.08a.12.12 0 000-.07c0-.03-.01-.05-.05-.09l-45.02-45.02a.2.2 0 00-.09-.05.12.12 0 00-.07 0z"}}]},name:"close-circle",theme:"filled"};const Jq=Kq;var Qq=function(o,l){return A.createElement(Uc,ui({},o,{ref:l,icon:Jq}))};const $8=A.forwardRef(Qq);var eZ={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm-32 232c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v272c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V296zm32 440a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"exclamation-circle",theme:"filled"};const tZ=eZ;var rZ=function(o,l){return A.createElement(Uc,ui({},o,{ref:l,icon:tZ}))};const V8=A.forwardRef(rZ);var nZ=`accept acceptCharset accessKey action allowFullScreen allowTransparency
    alt async autoComplete autoFocus autoPlay capture cellPadding cellSpacing challenge
    charSet checked classID className colSpan cols content contentEditable contextMenu
    controls coords crossOrigin data dateTime default defer dir disabled download draggable
    encType form formAction formEncType formMethod formNoValidate formTarget frameBorder
    headers height hidden high href hrefLang htmlFor httpEquiv icon id inputMode integrity
    is keyParams keyType kind label lang list loop low manifest marginHeight marginWidth max maxLength media
    mediaGroup method min minLength multiple muted name noValidate nonce open
    optimum pattern placeholder poster preload radioGroup readOnly rel required
    reversed role rowSpan rows sandbox scope scoped scrolling seamless selected
    shape size sizes span spellCheck src srcDoc srcLang srcSet start step style
    summary tabIndex target title type useMap value width wmode wrap`,iZ=`onCopy onCut onPaste onCompositionEnd onCompositionStart onCompositionUpdate onKeyDown
    onKeyPress onKeyUp onFocus onBlur onChange onInput onSubmit onClick onContextMenu onDoubleClick
    onDrag onDragEnd onDragEnter onDragExit onDragLeave onDragOver onDragStart onDrop onMouseDown
    onMouseEnter onMouseLeave onMouseMove onMouseOut onMouseOver onMouseUp onSelect onTouchCancel
    onTouchEnd onTouchMove onTouchStart onScroll onWheel onAbort onCanPlay onCanPlayThrough
    onDurationChange onEmptied onEncrypted onEnded onError onLoadedData onLoadedMetadata
    onLoadStart onPause onPlay onPlaying onProgress onRateChange onSeeked onSeeking onStalled onSuspend onTimeUpdate onVolumeChange onWaiting onLoad onError`,oZ="".concat(nZ," ").concat(iZ).split(/[\s\n]+/),aZ="aria-",sZ="data-";function OI(n,o){return n.indexOf(o)===0}function lZ(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,l;o===!1?l={aria:!0,data:!0,attr:!0}:o===!0?l={aria:!0}:l=ft({},o);var h={};return Object.keys(n).forEach(function(f){(l.aria&&(f==="role"||OI(f,aZ))||l.data&&OI(f,sZ)||l.attr&&oZ.includes(f))&&(h[f]=n[f])}),h}const{isValidElement:Vh}=x_;function U8(n){return n&&Vh(n)&&n.type===A.Fragment}function cZ(n,o,l){return Vh(n)?A.cloneElement(n,typeof l=="function"?l(n.props||{}):l):o}function Dc(n,o){return cZ(n,n,o)}const FI=n=>typeof n=="object"&&n!=null&&n.nodeType===1,BI=(n,o)=>(!o||n!=="hidden")&&n!=="visible"&&n!=="clip",Ib=(n,o)=>{if(n.clientHeight<n.scrollHeight||n.clientWidth<n.scrollWidth){const l=getComputedStyle(n,null);return BI(l.overflowY,o)||BI(l.overflowX,o)||(h=>{const f=(g=>{if(!g.ownerDocument||!g.ownerDocument.defaultView)return null;try{return g.ownerDocument.defaultView.frameElement}catch{return null}})(h);return!!f&&(f.clientHeight<h.scrollHeight||f.clientWidth<h.scrollWidth)})(n)}return!1},c0=(n,o,l,h,f,g,x,E)=>g<n&&x>o||g>n&&x<o?0:g<=n&&E<=l||x>=o&&E>=l?g-n-h:x>o&&E<l||g<n&&E>l?x-o+f:0,uZ=n=>{const o=n.parentElement;return o??(n.getRootNode().host||null)},NI=(n,o)=>{var l,h,f,g;if(typeof document>"u")return[];const{scrollMode:x,block:E,inline:w,boundary:I,skipOverflowHiddenElements:R}=o,D=typeof I=="function"?I:ce=>ce!==I;if(!FI(n))throw new TypeError("Invalid target");const F=document.scrollingElement||document.documentElement,q=[];let G=n;for(;FI(G)&&D(G);){if(G=uZ(G),G===F){q.push(G);break}G!=null&&G===document.body&&Ib(G)&&!Ib(document.documentElement)||G!=null&&Ib(G,R)&&q.push(G)}const j=(h=(l=window.visualViewport)==null?void 0:l.width)!=null?h:innerWidth,te=(g=(f=window.visualViewport)==null?void 0:f.height)!=null?g:innerHeight,{scrollX:N,scrollY:O}=window,{height:V,width:U,top:ae,right:le,bottom:ne,left:de}=n.getBoundingClientRect();let $=E==="start"||E==="nearest"?ae:E==="end"?ne:ae+V/2,ue=w==="center"?de+U/2:w==="end"?le:de;const xe=[];for(let ce=0;ce<q.length;ce++){const se=q[ce],{height:ke,width:$e,top:Ne,right:it,bottom:Re,left:He}=se.getBoundingClientRect();if(x==="if-needed"&&ae>=0&&de>=0&&ne<=te&&le<=j&&ae>=Ne&&ne<=Re&&de>=He&&le<=it)return xe;const Xe=getComputedStyle(se),ze=parseInt(Xe.borderLeftWidth,10),at=parseInt(Xe.borderTopWidth,10),Pt=parseInt(Xe.borderRightWidth,10),mt=parseInt(Xe.borderBottomWidth,10);let kt=0,Oe=0;const qt="offsetWidth"in se?se.offsetWidth-se.clientWidth-ze-Pt:0,Sr="offsetHeight"in se?se.offsetHeight-se.clientHeight-at-mt:0,Ir="offsetWidth"in se?se.offsetWidth===0?0:$e/se.offsetWidth:0,Xr="offsetHeight"in se?se.offsetHeight===0?0:ke/se.offsetHeight:0;if(F===se)kt=E==="start"?$:E==="end"?$-te:E==="nearest"?c0(O,O+te,te,at,mt,O+$,O+$+V,V):$-te/2,Oe=w==="start"?ue:w==="center"?ue-j/2:w==="end"?ue-j:c0(N,N+j,j,ze,Pt,N+ue,N+ue+U,U),kt=Math.max(0,kt+O),Oe=Math.max(0,Oe+N);else{kt=E==="start"?$-Ne-at:E==="end"?$-Re+mt+Sr:E==="nearest"?c0(Ne,Re,ke,at,mt+Sr,$,$+V,V):$-(Ne+ke/2)+Sr/2,Oe=w==="start"?ue-He-ze:w==="center"?ue-(He+$e/2)+qt/2:w==="end"?ue-it+Pt+qt:c0(He,it,$e,ze,Pt+qt,ue,ue+U,U);const{scrollLeft:Ur,scrollTop:pr}=se;kt=Math.max(0,Math.min(pr+kt/Xr,se.scrollHeight-ke/Xr+Sr)),Oe=Math.max(0,Math.min(Ur+Oe/Ir,se.scrollWidth-$e/Ir+qt)),$+=pr-kt,ue+=Ur-Oe}xe.push({el:se,top:kt,left:Oe})}return xe},hZ=n=>n===!1?{block:"end",inline:"nearest"}:(o=>o===Object(o)&&Object.keys(o).length!==0)(n)?n:{block:"start",inline:"nearest"};function dZ(n,o){if(!n.isConnected||!(h=>{let f=h;for(;f&&f.parentNode;){if(f.parentNode===document)return!0;f=f.parentNode instanceof ShadowRoot?f.parentNode.host:f.parentNode}return!1})(n))return;if((h=>typeof h=="object"&&typeof h.behavior=="function")(o))return o.behavior(NI(n,o));const l=typeof o=="boolean"||o==null?void 0:o.behavior;for(const{el:h,top:f,left:g}of NI(n,hZ(o)))h.scroll({top:f,left:g,behavior:l})}var fZ={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 00-94.3-139.9 437.71 437.71 0 00-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}}]},name:"loading",theme:"outlined"};const pZ=fZ;var mZ=function(o,l){return A.createElement(Uc,ui({},o,{ref:l,icon:pZ}))};const Y3=A.forwardRef(mZ);function Eo(){Eo=function(){return n};var n={},o=Object.prototype,l=o.hasOwnProperty,h=Object.defineProperty||function(xe,ce,se){xe[ce]=se.value},f=typeof Symbol=="function"?Symbol:{},g=f.iterator||"@@iterator",x=f.asyncIterator||"@@asyncIterator",E=f.toStringTag||"@@toStringTag";function w(xe,ce,se){return Object.defineProperty(xe,ce,{value:se,enumerable:!0,configurable:!0,writable:!0}),xe[ce]}try{w({},"")}catch{w=function(se,ke,$e){return se[ke]=$e}}function I(xe,ce,se,ke){var $e=ce&&ce.prototype instanceof F?ce:F,Ne=Object.create($e.prototype),it=new $(ke||[]);return h(Ne,"_invoke",{value:ae(xe,se,it)}),Ne}function R(xe,ce,se){try{return{type:"normal",arg:xe.call(ce,se)}}catch(ke){return{type:"throw",arg:ke}}}n.wrap=I;var D={};function F(){}function q(){}function G(){}var j={};w(j,g,function(){return this});var te=Object.getPrototypeOf,N=te&&te(te(ue([])));N&&N!==o&&l.call(N,g)&&(j=N);var O=G.prototype=F.prototype=Object.create(j);function V(xe){["next","throw","return"].forEach(function(ce){w(xe,ce,function(se){return this._invoke(ce,se)})})}function U(xe,ce){function se($e,Ne,it,Re){var He=R(xe[$e],xe,Ne);if(He.type!=="throw"){var Xe=He.arg,ze=Xe.value;return ze&&bn(ze)=="object"&&l.call(ze,"__await")?ce.resolve(ze.__await).then(function(at){se("next",at,it,Re)},function(at){se("throw",at,it,Re)}):ce.resolve(ze).then(function(at){Xe.value=at,it(Xe)},function(at){return se("throw",at,it,Re)})}Re(He.arg)}var ke;h(this,"_invoke",{value:function(Ne,it){function Re(){return new ce(function(He,Xe){se(Ne,it,He,Xe)})}return ke=ke?ke.then(Re,Re):Re()}})}function ae(xe,ce,se){var ke="suspendedStart";return function($e,Ne){if(ke==="executing")throw new Error("Generator is already running");if(ke==="completed"){if($e==="throw")throw Ne;return{value:void 0,done:!0}}for(se.method=$e,se.arg=Ne;;){var it=se.delegate;if(it){var Re=le(it,se);if(Re){if(Re===D)continue;return Re}}if(se.method==="next")se.sent=se._sent=se.arg;else if(se.method==="throw"){if(ke==="suspendedStart")throw ke="completed",se.arg;se.dispatchException(se.arg)}else se.method==="return"&&se.abrupt("return",se.arg);ke="executing";var He=R(xe,ce,se);if(He.type==="normal"){if(ke=se.done?"completed":"suspendedYield",He.arg===D)continue;return{value:He.arg,done:se.done}}He.type==="throw"&&(ke="completed",se.method="throw",se.arg=He.arg)}}}function le(xe,ce){var se=ce.method,ke=xe.iterator[se];if(ke===void 0)return ce.delegate=null,se==="throw"&&xe.iterator.return&&(ce.method="return",ce.arg=void 0,le(xe,ce),ce.method==="throw")||se!=="return"&&(ce.method="throw",ce.arg=new TypeError("The iterator does not provide a '"+se+"' method")),D;var $e=R(ke,xe.iterator,ce.arg);if($e.type==="throw")return ce.method="throw",ce.arg=$e.arg,ce.delegate=null,D;var Ne=$e.arg;return Ne?Ne.done?(ce[xe.resultName]=Ne.value,ce.next=xe.nextLoc,ce.method!=="return"&&(ce.method="next",ce.arg=void 0),ce.delegate=null,D):Ne:(ce.method="throw",ce.arg=new TypeError("iterator result is not an object"),ce.delegate=null,D)}function ne(xe){var ce={tryLoc:xe[0]};1 in xe&&(ce.catchLoc=xe[1]),2 in xe&&(ce.finallyLoc=xe[2],ce.afterLoc=xe[3]),this.tryEntries.push(ce)}function de(xe){var ce=xe.completion||{};ce.type="normal",delete ce.arg,xe.completion=ce}function $(xe){this.tryEntries=[{tryLoc:"root"}],xe.forEach(ne,this),this.reset(!0)}function ue(xe){if(xe||xe===""){var ce=xe[g];if(ce)return ce.call(xe);if(typeof xe.next=="function")return xe;if(!isNaN(xe.length)){var se=-1,ke=function $e(){for(;++se<xe.length;)if(l.call(xe,se))return $e.value=xe[se],$e.done=!1,$e;return $e.value=void 0,$e.done=!0,$e};return ke.next=ke}}throw new TypeError(bn(xe)+" is not iterable")}return q.prototype=G,h(O,"constructor",{value:G,configurable:!0}),h(G,"constructor",{value:q,configurable:!0}),q.displayName=w(G,E,"GeneratorFunction"),n.isGeneratorFunction=function(xe){var ce=typeof xe=="function"&&xe.constructor;return!!ce&&(ce===q||(ce.displayName||ce.name)==="GeneratorFunction")},n.mark=function(xe){return Object.setPrototypeOf?Object.setPrototypeOf(xe,G):(xe.__proto__=G,w(xe,E,"GeneratorFunction")),xe.prototype=Object.create(O),xe},n.awrap=function(xe){return{__await:xe}},V(U.prototype),w(U.prototype,x,function(){return this}),n.AsyncIterator=U,n.async=function(xe,ce,se,ke,$e){$e===void 0&&($e=Promise);var Ne=new U(I(xe,ce,se,ke),$e);return n.isGeneratorFunction(ce)?Ne:Ne.next().then(function(it){return it.done?it.value:Ne.next()})},V(O),w(O,E,"Generator"),w(O,g,function(){return this}),w(O,"toString",function(){return"[object Generator]"}),n.keys=function(xe){var ce=Object(xe),se=[];for(var ke in ce)se.push(ke);return se.reverse(),function $e(){for(;se.length;){var Ne=se.pop();if(Ne in ce)return $e.value=Ne,$e.done=!1,$e}return $e.done=!0,$e}},n.values=ue,$.prototype={constructor:$,reset:function(ce){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(de),!ce)for(var se in this)se.charAt(0)==="t"&&l.call(this,se)&&!isNaN(+se.slice(1))&&(this[se]=void 0)},stop:function(){this.done=!0;var ce=this.tryEntries[0].completion;if(ce.type==="throw")throw ce.arg;return this.rval},dispatchException:function(ce){if(this.done)throw ce;var se=this;function ke(Xe,ze){return it.type="throw",it.arg=ce,se.next=Xe,ze&&(se.method="next",se.arg=void 0),!!ze}for(var $e=this.tryEntries.length-1;$e>=0;--$e){var Ne=this.tryEntries[$e],it=Ne.completion;if(Ne.tryLoc==="root")return ke("end");if(Ne.tryLoc<=this.prev){var Re=l.call(Ne,"catchLoc"),He=l.call(Ne,"finallyLoc");if(Re&&He){if(this.prev<Ne.catchLoc)return ke(Ne.catchLoc,!0);if(this.prev<Ne.finallyLoc)return ke(Ne.finallyLoc)}else if(Re){if(this.prev<Ne.catchLoc)return ke(Ne.catchLoc,!0)}else{if(!He)throw new Error("try statement without catch or finally");if(this.prev<Ne.finallyLoc)return ke(Ne.finallyLoc)}}}},abrupt:function(ce,se){for(var ke=this.tryEntries.length-1;ke>=0;--ke){var $e=this.tryEntries[ke];if($e.tryLoc<=this.prev&&l.call($e,"finallyLoc")&&this.prev<$e.finallyLoc){var Ne=$e;break}}Ne&&(ce==="break"||ce==="continue")&&Ne.tryLoc<=se&&se<=Ne.finallyLoc&&(Ne=null);var it=Ne?Ne.completion:{};return it.type=ce,it.arg=se,Ne?(this.method="next",this.next=Ne.finallyLoc,D):this.complete(it)},complete:function(ce,se){if(ce.type==="throw")throw ce.arg;return ce.type==="break"||ce.type==="continue"?this.next=ce.arg:ce.type==="return"?(this.rval=this.arg=ce.arg,this.method="return",this.next="end"):ce.type==="normal"&&se&&(this.next=se),D},finish:function(ce){for(var se=this.tryEntries.length-1;se>=0;--se){var ke=this.tryEntries[se];if(ke.finallyLoc===ce)return this.complete(ke.completion,ke.afterLoc),de(ke),D}},catch:function(ce){for(var se=this.tryEntries.length-1;se>=0;--se){var ke=this.tryEntries[se];if(ke.tryLoc===ce){var $e=ke.completion;if($e.type==="throw"){var Ne=$e.arg;de(ke)}return Ne}}throw new Error("illegal catch attempt")},delegateYield:function(ce,se,ke){return this.delegate={iterator:ue(ce),resultName:se,nextLoc:ke},this.method==="next"&&(this.arg=void 0),D}},n}function jI(n,o,l,h,f,g,x){try{var E=n[g](x),w=E.value}catch(I){l(I);return}E.done?o(w):Promise.resolve(w).then(h,f)}function Jh(n){return function(){var o=this,l=arguments;return new Promise(function(h,f){var g=n.apply(o,l);function x(w){jI(g,h,f,x,E,"next",w)}function E(w){jI(g,h,f,x,E,"throw",w)}x(void 0)})}}var Ap=ft({},OU),gZ=Ap.version,_Z=Ap.render,yZ=Ap.unmountComponentAtNode,iy;try{var vZ=Number((gZ||"").split(".")[0]);vZ>=18&&(iy=Ap.createRoot)}catch{}function $I(n){var o=Ap.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;o&&bn(o)==="object"&&(o.usingClientEntryPoint=n)}var p_="__rc_react_root__";function xZ(n,o){$I(!0);var l=o[p_]||iy(o);$I(!1),l.render(n),o[p_]=l}function bZ(n,o){_Z(n,o)}function wZ(n,o){if(iy){xZ(n,o);return}bZ(n,o)}function EZ(n){return hw.apply(this,arguments)}function hw(){return hw=Jh(Eo().mark(function n(o){return Eo().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",Promise.resolve().then(function(){var f;(f=o[p_])===null||f===void 0||f.unmount(),delete o[p_]}));case 1:case"end":return h.stop()}},n)})),hw.apply(this,arguments)}function SZ(n){yZ(n)}function TZ(n){return dw.apply(this,arguments)}function dw(){return dw=Jh(Eo().mark(function n(o){return Eo().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(iy===void 0){h.next=2;break}return h.abrupt("return",EZ(o));case 2:SZ(o);case 3:case"end":return h.stop()}},n)})),dw.apply(this,arguments)}const K3=function(n){if(!n)return!1;if(n instanceof Element){if(n.offsetParent)return!0;if(n.getBBox){var o=n.getBBox(),l=o.width,h=o.height;if(l||h)return!0}if(n.getBoundingClientRect){var f=n.getBoundingClientRect(),g=f.width,x=f.height;if(g||x)return!0}}return!1},MZ=n=>{const{componentCls:o,colorPrimary:l}=n;return{[o]:{position:"absolute",background:"transparent",pointerEvents:"none",boxSizing:"border-box",color:`var(--wave-color, ${l})`,boxShadow:"0 0 0 0 currentcolor",opacity:.2,"&.wave-motion-appear":{transition:[`box-shadow 0.4s ${n.motionEaseOutCirc}`,`opacity 2s ${n.motionEaseOutCirc}`].join(","),"&-active":{boxShadow:"0 0 0 6px currentcolor",opacity:0},"&.wave-quick":{transition:[`box-shadow 0.3s ${n.motionEaseInOut}`,`opacity 0.35s ${n.motionEaseInOut}`].join(",")}}}}},CZ=ba("Wave",n=>[MZ(n)]);function AZ(n){const o=(n||"").match(/rgba?\((\d*), (\d*), (\d*)(, [\d.]*)?\)/);return o&&o[1]&&o[2]&&o[3]?!(o[1]===o[2]&&o[2]===o[3]):!0}function Pb(n){return n&&n!=="#fff"&&n!=="#ffffff"&&n!=="rgb(255, 255, 255)"&&n!=="rgba(255, 255, 255, 1)"&&AZ(n)&&!/rgba\((?:\d*, ){3}0\)/.test(n)&&n!=="transparent"}function IZ(n){const{borderTopColor:o,borderColor:l,backgroundColor:h}=getComputedStyle(n);return Pb(o)?o:Pb(l)?l:Pb(h)?h:null}const J3="ant-wave-target";function kb(n){return Number.isNaN(n)?0:n}const PZ=n=>{const{className:o,target:l,component:h}=n,f=A.useRef(null),[g,x]=A.useState(null),[E,w]=A.useState([]),[I,R]=A.useState(0),[D,F]=A.useState(0),[q,G]=A.useState(0),[j,te]=A.useState(0),[N,O]=A.useState(!1),V={left:I,top:D,width:q,height:j,borderRadius:E.map(le=>`${le}px`).join(" ")};g&&(V["--wave-color"]=g);function U(){const le=getComputedStyle(l);x(IZ(l));const ne=le.position==="static",{borderLeftWidth:de,borderTopWidth:$}=le;R(ne?l.offsetLeft:kb(-parseFloat(de))),F(ne?l.offsetTop:kb(-parseFloat($))),G(l.offsetWidth),te(l.offsetHeight);const{borderTopLeftRadius:ue,borderTopRightRadius:xe,borderBottomLeftRadius:ce,borderBottomRightRadius:se}=le;w([ue,xe,se,ce].map(ke=>kb(parseFloat(ke))))}if(A.useEffect(()=>{if(l){const le=va(()=>{U(),O(!0)});let ne;return typeof ResizeObserver<"u"&&(ne=new ResizeObserver(U),ne.observe(l)),()=>{va.cancel(le),ne==null||ne.disconnect()}}},[]),!N)return null;const ae=(h==="Checkbox"||h==="Radio")&&(l==null?void 0:l.classList.contains(J3));return A.createElement(Yh,{visible:!0,motionAppear:!0,motionName:"wave-motion",motionDeadline:5e3,onAppearEnd:(le,ne)=>{var de;if(ne.deadline||ne.propertyName==="opacity"){const $=(de=f.current)===null||de===void 0?void 0:de.parentElement;TZ($).then(()=>{$==null||$.remove()})}return!1}},le=>{let{className:ne}=le;return A.createElement("div",{ref:f,className:$t(o,{"wave-quick":ae},ne),style:V})})},kZ=(n,o)=>{var l;const{component:h}=o;if(h==="Checkbox"&&!(!((l=n.querySelector("input"))===null||l===void 0)&&l.checked))return;const f=document.createElement("div");f.style.position="absolute",f.style.left="0px",f.style.top="0px",n==null||n.insertBefore(f,n==null?void 0:n.firstChild),wZ(A.createElement(PZ,Object.assign({},o,{target:n})),f)},RZ=kZ;function zZ(n,o,l){const{wave:h}=A.useContext(wn),[,f,g]=Vc(),x=Ba(I=>{const R=n.current;if(h!=null&&h.disabled||!R)return;const D=R.querySelector(`.${J3}`)||R,{showEffect:F}=h||{};(F||RZ)(D,{className:o,token:f,component:l,event:I,hashId:g})}),E=A.useRef();return I=>{va.cancel(E.current),E.current=va(()=>{x(I)})}}const DZ=n=>{const{children:o,disabled:l,component:h}=n,{getPrefixCls:f}=A.useContext(wn),g=A.useRef(null),x=f("wave"),[,E]=CZ(x),w=zZ(g,$t(x,E),h);if(xn.useEffect(()=>{const R=g.current;if(!R||R.nodeType!==1||l)return;const D=F=>{!K3(F.target)||!R.getAttribute||R.getAttribute("disabled")||R.disabled||R.className.includes("disabled")||R.className.includes("-leave")||w(F)};return R.addEventListener("click",D,!0),()=>{R.removeEventListener("click",D,!0)}},[l]),!xn.isValidElement(o))return o??null;const I=Hh(o)?Bc(o.ref,g):g;return Dc(o,{ref:I})},G8=DZ,LZ=n=>{const o=xn.useContext(Q_);return xn.useMemo(()=>n?typeof n=="string"?n??o:n instanceof Function?n(o):o:o,[n,o])},Q3=LZ;globalThis&&globalThis.__rest;const W8=A.createContext(null),OZ=(n,o)=>{const l=A.useContext(W8),h=A.useMemo(()=>{if(!l)return"";const{compactDirection:f,isFirstItem:g,isLastItem:x}=l,E=f==="vertical"?"-vertical-":"-";return $t(`${n}-compact${E}item`,{[`${n}-compact${E}first-item`]:g,[`${n}-compact${E}last-item`]:x,[`${n}-compact${E}item-rtl`]:o==="rtl"})},[n,o,l]);return{compactSize:l==null?void 0:l.compactSize,compactDirection:l==null?void 0:l.compactDirection,compactItemClassnames:h}},FZ=n=>{let{children:o}=n;return A.createElement(W8.Provider,{value:null},o)},BZ=A.forwardRef((n,o)=>{const{className:l,style:h,children:f,prefixCls:g}=n,x=$t(`${g}-icon`,l);return xn.createElement("span",{ref:o,className:x,style:h},f)}),H8=BZ,VI=A.forwardRef((n,o)=>{let{prefixCls:l,className:h,style:f,iconClassName:g}=n;const x=$t(`${l}-loading-icon`,h);return xn.createElement(H8,{prefixCls:l,className:x,style:f,ref:o},xn.createElement(Y3,{className:g}))}),Rb=()=>({width:0,opacity:0,transform:"scale(0)"}),zb=n=>({width:n.scrollWidth,opacity:1,transform:"scale(1)"}),NZ=n=>{const{prefixCls:o,loading:l,existIcon:h,className:f,style:g}=n,x=!!l;return h?xn.createElement(VI,{prefixCls:o,className:f,style:g}):xn.createElement(Yh,{visible:x,motionName:`${o}-loading-icon-motion`,removeOnLeave:!0,onAppearStart:Rb,onAppearActive:zb,onEnterStart:Rb,onEnterActive:zb,onLeaveStart:zb,onLeaveActive:Rb},(E,w)=>{let{className:I,style:R}=E;return xn.createElement(VI,{prefixCls:o,className:f,style:Object.assign(Object.assign({},g),R),ref:w,iconClassName:I})})},jZ=NZ;var $Z=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};const q8=A.createContext(void 0),VZ=n=>{const{getPrefixCls:o,direction:l}=A.useContext(wn),{prefixCls:h,size:f,className:g}=n,x=$Z(n,["prefixCls","size","className"]),E=o("btn-group",h),[,,w]=Vc();let I="";switch(f){case"large":I="lg";break;case"small":I="sm";break}const R=$t(E,{[`${E}-${I}`]:I,[`${E}-rtl`]:l==="rtl"},g,w);return A.createElement(q8.Provider,{value:f},A.createElement("div",Object.assign({},x,{className:R})))},UZ=VZ,UI=/^[\u4e00-\u9fa5]{2}$/,fw=UI.test.bind(UI);function GZ(n){return typeof n=="string"}function Db(n){return n==="text"||n==="link"}function WZ(n,o){if(n==null)return;const l=o?" ":"";return typeof n!="string"&&typeof n!="number"&&GZ(n.type)&&fw(n.props.children)?Dc(n,{children:n.props.children.split("").join(l)}):typeof n=="string"?fw(n)?xn.createElement("span",null,n.split("").join(l)):xn.createElement("span",null,n):U8(n)?xn.createElement("span",null,n):n}function HZ(n,o){let l=!1;const h=[];return xn.Children.forEach(n,f=>{const g=typeof f,x=g==="string"||g==="number";if(l&&x){const E=h.length-1,w=h[E];h[E]=`${w}${f}`}else h.push(f);l=x}),xn.Children.map(h,f=>WZ(f,o))}function qZ(n,o,l){const{focusElCls:h,focus:f,borderElCls:g}=l,x=g?"> *":"",E=["hover",f?"focus":null,"active"].filter(Boolean).map(w=>`&:${w} ${x}`).join(",");return{[`&-item:not(${o}-last-item)`]:{marginInlineEnd:-n.lineWidth},"&-item":Object.assign(Object.assign({[E]:{zIndex:2}},h?{[`&${h}`]:{zIndex:2}}:{}),{[`&[disabled] ${x}`]:{zIndex:0}})}}function ZZ(n,o,l){const{borderElCls:h}=l,f=h?`> ${h}`:"";return{[`&-item:not(${o}-first-item):not(${o}-last-item) ${f}`]:{borderRadius:0},[`&-item:not(${o}-last-item)${o}-first-item`]:{[`& ${f}, &${n}-sm ${f}, &${n}-lg ${f}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},[`&-item:not(${o}-first-item)${o}-last-item`]:{[`& ${f}, &${n}-sm ${f}, &${n}-lg ${f}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}}}function XZ(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{focus:!0};const{componentCls:l}=n,h=`${l}-compact`;return{[h]:Object.assign(Object.assign({},qZ(n,h,o)),ZZ(l,h,o))}}function YZ(n,o){return{[`&-item:not(${o}-last-item)`]:{marginBottom:-n.lineWidth},"&-item":{"&:hover,&:focus,&:active":{zIndex:2},"&[disabled]":{zIndex:0}}}}function KZ(n,o){return{[`&-item:not(${o}-first-item):not(${o}-last-item)`]:{borderRadius:0},[`&-item${o}-first-item:not(${o}-last-item)`]:{[`&, &${n}-sm, &${n}-lg`]:{borderEndEndRadius:0,borderEndStartRadius:0}},[`&-item${o}-last-item:not(${o}-first-item)`]:{[`&, &${n}-sm, &${n}-lg`]:{borderStartStartRadius:0,borderStartEndRadius:0}}}}function JZ(n){const o=`${n.componentCls}-compact-vertical`;return{[o]:Object.assign(Object.assign({},YZ(n,o)),KZ(n.componentCls,o))}}const GI=(n,o)=>({[`> span, > ${n}`]:{"&:not(:last-child)":{[`&, & > ${n}`]:{"&:not(:disabled)":{borderInlineEndColor:o}}},"&:not(:first-child)":{[`&, & > ${n}`]:{"&:not(:disabled)":{borderInlineStartColor:o}}}}}),QZ=n=>{const{componentCls:o,fontSize:l,lineWidth:h,colorPrimaryHover:f,colorErrorHover:g}=n;return{[`${o}-group`]:[{position:"relative",display:"inline-flex",[`> span, > ${o}`]:{"&:not(:last-child)":{[`&, & > ${o}`]:{borderStartEndRadius:0,borderEndEndRadius:0}},"&:not(:first-child)":{marginInlineStart:-h,[`&, & > ${o}`]:{borderStartStartRadius:0,borderEndStartRadius:0}}},[o]:{position:"relative",zIndex:1,"&:hover,\n          &:focus,\n          &:active":{zIndex:2},"&[disabled]":{zIndex:0}},[`${o}-icon-only`]:{fontSize:l}},GI(`${o}-primary`,f),GI(`${o}-danger`,g)]}},eX=QZ,tX=n=>{const{componentCls:o,iconCls:l,buttonFontWeight:h}=n;return{[o]:{outline:"none",position:"relative",display:"inline-block",fontWeight:h,whiteSpace:"nowrap",textAlign:"center",backgroundImage:"none",backgroundColor:"transparent",border:`${n.lineWidth}px ${n.lineType} transparent`,cursor:"pointer",transition:`all ${n.motionDurationMid} ${n.motionEaseInOut}`,userSelect:"none",touchAction:"manipulation",lineHeight:n.lineHeight,color:n.colorText,"&:disabled > *":{pointerEvents:"none"},"> span":{display:"inline-block"},[`${o}-icon`]:{lineHeight:0},[`> ${l} + span, > span + ${l}`]:{marginInlineStart:n.marginXS},[`&:not(${o}-icon-only) > ${o}-icon`]:{[`&${o}-loading-icon, &:not(:last-child)`]:{marginInlineEnd:n.marginXS}},"> a":{color:"currentColor"},"&:not(:disabled)":Object.assign({},rH(n)),[`&-icon-only${o}-compact-item`]:{flex:"none"},[`&-compact-item${o}-primary`]:{[`&:not([disabled]) + ${o}-compact-item${o}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:-n.lineWidth,insetInlineStart:-n.lineWidth,display:"inline-block",width:n.lineWidth,height:`calc(100% + ${n.lineWidth*2}px)`,backgroundColor:n.colorPrimaryHover,content:'""'}}},"&-compact-vertical-item":{[`&${o}-primary`]:{[`&:not([disabled]) + ${o}-compact-vertical-item${o}-primary:not([disabled])`]:{position:"relative","&:before":{position:"absolute",top:-n.lineWidth,insetInlineStart:-n.lineWidth,display:"inline-block",width:`calc(100% + ${n.lineWidth*2}px)`,height:n.lineWidth,backgroundColor:n.colorPrimaryHover,content:'""'}}}}}}},Ts=(n,o,l)=>({[`&:not(:disabled):not(${n}-disabled)`]:{"&:hover":o,"&:active":l}}),rX=n=>({minWidth:n.controlHeight,paddingInlineStart:0,paddingInlineEnd:0,borderRadius:"50%"}),nX=n=>({borderRadius:n.controlHeight,paddingInlineStart:n.controlHeight/2,paddingInlineEnd:n.controlHeight/2}),iX=n=>({cursor:"not-allowed",borderColor:n.colorBorder,color:n.colorTextDisabled,backgroundColor:n.colorBgContainerDisabled,boxShadow:"none"}),dp=(n,o,l,h,f,g,x)=>({[`&${n}-background-ghost`]:Object.assign(Object.assign({color:o||void 0,backgroundColor:"transparent",borderColor:l||void 0,boxShadow:"none"},Ts(n,Object.assign({backgroundColor:"transparent"},g),Object.assign({backgroundColor:"transparent"},x))),{"&:disabled":{cursor:"not-allowed",color:h||void 0,borderColor:f||void 0}})}),eE=n=>({[`&:disabled, &${n.componentCls}-disabled`]:Object.assign({},iX(n))}),Z8=n=>Object.assign({},eE(n)),m_=n=>({[`&:disabled, &${n.componentCls}-disabled`]:{cursor:"not-allowed",color:n.colorTextDisabled}}),X8=n=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Z8(n)),{backgroundColor:n.colorBgContainer,borderColor:n.colorBorder,boxShadow:`0 ${n.controlOutlineWidth}px 0 ${n.controlTmpOutline}`}),Ts(n.componentCls,{color:n.colorPrimaryHover,borderColor:n.colorPrimaryHover},{color:n.colorPrimaryActive,borderColor:n.colorPrimaryActive})),dp(n.componentCls,n.colorBgContainer,n.colorBgContainer,n.colorTextDisabled,n.colorBorder)),{[`&${n.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({color:n.colorError,borderColor:n.colorError},Ts(n.componentCls,{color:n.colorErrorHover,borderColor:n.colorErrorBorderHover},{color:n.colorErrorActive,borderColor:n.colorErrorActive})),dp(n.componentCls,n.colorError,n.colorError,n.colorTextDisabled,n.colorBorder)),eE(n))}),oX=n=>Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},Z8(n)),{color:n.colorTextLightSolid,backgroundColor:n.colorPrimary,boxShadow:`0 ${n.controlOutlineWidth}px 0 ${n.controlOutline}`}),Ts(n.componentCls,{color:n.colorTextLightSolid,backgroundColor:n.colorPrimaryHover},{color:n.colorTextLightSolid,backgroundColor:n.colorPrimaryActive})),dp(n.componentCls,n.colorPrimary,n.colorPrimary,n.colorTextDisabled,n.colorBorder,{color:n.colorPrimaryHover,borderColor:n.colorPrimaryHover},{color:n.colorPrimaryActive,borderColor:n.colorPrimaryActive})),{[`&${n.componentCls}-dangerous`]:Object.assign(Object.assign(Object.assign({backgroundColor:n.colorError,boxShadow:`0 ${n.controlOutlineWidth}px 0 ${n.colorErrorOutline}`},Ts(n.componentCls,{backgroundColor:n.colorErrorHover},{backgroundColor:n.colorErrorActive})),dp(n.componentCls,n.colorError,n.colorError,n.colorTextDisabled,n.colorBorder,{color:n.colorErrorHover,borderColor:n.colorErrorHover},{color:n.colorErrorActive,borderColor:n.colorErrorActive})),eE(n))}),aX=n=>Object.assign(Object.assign({},X8(n)),{borderStyle:"dashed"}),sX=n=>Object.assign(Object.assign(Object.assign({color:n.colorLink},Ts(n.componentCls,{color:n.colorLinkHover},{color:n.colorLinkActive})),m_(n)),{[`&${n.componentCls}-dangerous`]:Object.assign(Object.assign({color:n.colorError},Ts(n.componentCls,{color:n.colorErrorHover},{color:n.colorErrorActive})),m_(n))}),lX=n=>Object.assign(Object.assign(Object.assign({},Ts(n.componentCls,{color:n.colorText,backgroundColor:n.colorBgTextHover},{color:n.colorText,backgroundColor:n.colorBgTextActive})),m_(n)),{[`&${n.componentCls}-dangerous`]:Object.assign(Object.assign({color:n.colorError},m_(n)),Ts(n.componentCls,{color:n.colorErrorHover,backgroundColor:n.colorErrorBg},{color:n.colorErrorHover,backgroundColor:n.colorErrorBg}))}),cX=n=>{const{componentCls:o}=n;return{[`${o}-default`]:X8(n),[`${o}-primary`]:oX(n),[`${o}-dashed`]:aX(n),[`${o}-link`]:sX(n),[`${o}-text`]:lX(n),[`${o}-ghost`]:dp(n.componentCls,n.colorBgContainer,n.colorBgContainer,n.colorTextDisabled,n.colorBorder)}},tE=function(n){let o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const{componentCls:l,controlHeight:h,fontSize:f,lineHeight:g,lineWidth:x,borderRadius:E,buttonPaddingHorizontal:w,iconCls:I}=n,R=Math.max(0,(h-f*g)/2-x),D=w-x,F=`${l}-icon-only`;return[{[`${l}${o}`]:{fontSize:f,height:h,padding:`${R}px ${D}px`,borderRadius:E,[`&${F}`]:{width:h,paddingInlineStart:0,paddingInlineEnd:0,[`&${l}-round`]:{width:"auto"},[I]:{fontSize:n.buttonIconOnlyFontSize}},[`&${l}-loading`]:{opacity:n.opacityLoading,cursor:"default"},[`${l}-loading-icon`]:{transition:`width ${n.motionDurationSlow} ${n.motionEaseInOut}, opacity ${n.motionDurationSlow} ${n.motionEaseInOut}`}}},{[`${l}${l}-circle${o}`]:rX(n)},{[`${l}${l}-round${o}`]:nX(n)}]},uX=n=>tE(n),hX=n=>{const o=to(n,{controlHeight:n.controlHeightSM,padding:n.paddingXS,buttonPaddingHorizontal:8,borderRadius:n.borderRadiusSM,buttonIconOnlyFontSize:n.fontSizeLG-2});return tE(o,`${n.componentCls}-sm`)},dX=n=>{const o=to(n,{controlHeight:n.controlHeightLG,fontSize:n.fontSizeLG,borderRadius:n.borderRadiusLG,buttonIconOnlyFontSize:n.fontSizeLG+2});return tE(o,`${n.componentCls}-lg`)},fX=n=>{const{componentCls:o}=n;return{[o]:{[`&${o}-block`]:{width:"100%"}}}},pX=ba("Button",n=>{const{controlTmpOutline:o,paddingContentHorizontal:l}=n,h=to(n,{colorOutlineDefault:o,buttonPaddingHorizontal:l,buttonIconOnlyFontSize:n.fontSizeLG,buttonFontWeight:400});return[tX(h),hX(h),uX(h),dX(h),fX(h),cX(h),eX(h),XZ(n),JZ(n)]});var mX=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};function gX(n){if(typeof n=="object"&&n){const o=n==null?void 0:n.delay;return{loading:!1,delay:!Number.isNaN(o)&&typeof o=="number"?o:0}}return{loading:!!n,delay:0}}const _X=(n,o)=>{var l,h;const{loading:f=!1,prefixCls:g,type:x="default",danger:E,shape:w="default",size:I,styles:R,disabled:D,className:F,rootClassName:q,children:G,icon:j,ghost:te=!1,block:N=!1,htmlType:O="button",classNames:V,style:U={}}=n,ae=mX(n,["loading","prefixCls","type","danger","shape","size","styles","disabled","className","rootClassName","children","icon","ghost","block","htmlType","classNames","style"]),{getPrefixCls:le,autoInsertSpaceInButton:ne,direction:de,button:$}=A.useContext(wn),ue=le("btn",g),[xe,ce]=pX(ue),se=A.useContext(J_),ke=D??se,$e=A.useContext(q8),Ne=A.useMemo(()=>gX(f),[f]),[it,Re]=A.useState(Ne.loading),[He,Xe]=A.useState(!1),at=Bc(o,A.createRef()),Pt=A.Children.count(G)===1&&!j&&!Db(x);A.useEffect(()=>{let we=null;Ne.delay>0?we=setTimeout(()=>{we=null,Re(!0)},Ne.delay):Re(Ne.loading);function Ie(){we&&(clearTimeout(we),we=null)}return Ie},[Ne]),A.useEffect(()=>{if(!at||!at.current||ne===!1)return;const we=at.current.textContent;Pt&&fw(we)?He||Xe(!0):He&&Xe(!1)},[at]);const mt=we=>{const{onClick:Ie}=n;if(it||ke){we.preventDefault();return}Ie==null||Ie(we)},kt=ne!==!1,{compactSize:Oe,compactItemClassnames:qt}=OZ(ue,de),Sr={large:"lg",small:"sm",middle:void 0},Ir=Q3(we=>{var Ie,Qe;return(Qe=(Ie=I??Oe)!==null&&Ie!==void 0?Ie:$e)!==null&&Qe!==void 0?Qe:we}),Xr=Ir&&Sr[Ir]||"",Ur=it?"loading":j,pr=$c(ae,["navigate"]),ar=$t(ue,ce,{[`${ue}-${w}`]:w!=="default"&&w,[`${ue}-${x}`]:x,[`${ue}-${Xr}`]:Xr,[`${ue}-icon-only`]:!G&&G!==0&&!!Ur,[`${ue}-background-ghost`]:te&&!Db(x),[`${ue}-loading`]:it,[`${ue}-two-chinese-chars`]:He&&kt&&!it,[`${ue}-block`]:N,[`${ue}-dangerous`]:!!E,[`${ue}-rtl`]:de==="rtl"},qt,F,q,$==null?void 0:$.className),hr=Object.assign(Object.assign({},$==null?void 0:$.style),U),xr=$t(V==null?void 0:V.icon,(l=$==null?void 0:$.classNames)===null||l===void 0?void 0:l.icon),Fe=Object.assign(Object.assign({},(R==null?void 0:R.icon)||{}),((h=$==null?void 0:$.styles)===null||h===void 0?void 0:h.icon)||{}),Y=j&&!it?xn.createElement(H8,{prefixCls:ue,className:xr,style:Fe},j):xn.createElement(jZ,{existIcon:!!j,prefixCls:ue,loading:!!it}),ee=G||G===0?HZ(G,Pt&&kt):null;if(pr.href!==void 0)return xe(xn.createElement("a",Object.assign({},pr,{className:$t(ar,{[`${ue}-disabled`]:ke}),style:hr,onClick:mt,ref:at}),Y,ee));let re=xn.createElement("button",Object.assign({},ae,{type:O,className:ar,style:hr,onClick:mt,disabled:ke,ref:at}),Y,ee);return Db(x)||(re=xn.createElement(G8,{component:"Button",disabled:!!it},re)),xe(re)},rE=A.forwardRef(_X);rE.Group=UZ;rE.__ANT_BUTTON=!0;const Y8=rE,Lb=()=>({height:0,opacity:0}),WI=n=>{const{scrollHeight:o}=n;return{height:o,opacity:1}},yX=n=>({height:n?n.offsetHeight:0}),Ob=(n,o)=>(o==null?void 0:o.deadline)===!0||o.propertyName==="height",vX=function(){return{motionName:`${arguments.length>0&&arguments[0]!==void 0?arguments[0]:"ant"}-motion-collapse`,onAppearStart:Lb,onEnterStart:Lb,onAppearActive:WI,onEnterActive:WI,onLeaveStart:yX,onLeaveActive:Lb,onAppearEnd:Ob,onEnterEnd:Ob,onLeaveEnd:Ob,motionDeadline:500}},xX=(n,o,l)=>l!==void 0?l:`${n}-${o}`,HI=vX;var K8=A.createContext(null),qI=[];function bX(n,o){var l=A.useState(function(){if(!Oi())return null;var G=document.createElement("div");return G}),h=Ht(l,1),f=h[0],g=A.useRef(!1),x=A.useContext(K8),E=A.useState(qI),w=Ht(E,2),I=w[0],R=w[1],D=x||(g.current?void 0:function(G){R(function(j){var te=[G].concat(Jt(j));return te})});function F(){f.parentElement||document.body.appendChild(f),g.current=!0}function q(){var G;(G=f.parentElement)===null||G===void 0||G.removeChild(f),g.current=!1}return Ti(function(){return n?x?x(F):F():q(),q},[n]),Ti(function(){I.length&&(I.forEach(function(G){return G()}),R(qI))},[I]),[f,D]}var Fb;function wX(n){if(typeof document>"u")return 0;if(n||Fb===void 0){var o=document.createElement("div");o.style.width="100%",o.style.height="200px";var l=document.createElement("div"),h=l.style;h.position="absolute",h.top="0",h.left="0",h.pointerEvents="none",h.visibility="hidden",h.width="200px",h.height="150px",h.overflow="hidden",l.appendChild(o),document.body.appendChild(l);var f=o.offsetWidth;l.style.overflow="scroll";var g=o.offsetWidth;f===g&&(g=l.clientWidth),document.body.removeChild(l),Fb=f-g}return Fb}function ZI(n){var o=n.match(/^(.*)px$/),l=Number(o==null?void 0:o[1]);return Number.isNaN(l)?wX():l}function EX(n){if(typeof document>"u"||!n||!(n instanceof Element))return{width:0,height:0};var o=getComputedStyle(n,"::-webkit-scrollbar"),l=o.width,h=o.height;return{width:ZI(l),height:ZI(h)}}function SX(){return document.body.scrollHeight>(window.innerHeight||document.documentElement.clientHeight)&&window.innerWidth>document.body.offsetWidth}var TX="rc-util-locker-".concat(Date.now()),XI=0;function MX(n){var o=!!n,l=A.useState(function(){return XI+=1,"".concat(TX,"_").concat(XI)}),h=Ht(l,1),f=h[0];Ti(function(){if(o){var g=EX(document.body).width,x=SX();jh(`
html body {
  overflow-y: hidden;
  `.concat(x?"width: calc(100% - ".concat(g,"px);"):"",`
}`),f)}else l_(f);return function(){l_(f)}},[o,f])}var YI=!1;function CX(n){return typeof n=="boolean"&&(YI=n),YI}var KI=function(o){return o===!1?!1:!Oi()||!o?null:typeof o=="string"?document.querySelector(o):typeof o=="function"?o():o},J8=A.forwardRef(function(n,o){var l=n.open,h=n.autoLock,f=n.getContainer;n.debug;var g=n.autoDestroy,x=g===void 0?!0:g,E=n.children,w=A.useState(l),I=Ht(w,2),R=I[0],D=I[1],F=R||l;A.useEffect(function(){(x||l)&&D(l)},[l,x]);var q=A.useState(function(){return KI(f)}),G=Ht(q,2),j=G[0],te=G[1];A.useEffect(function(){var xe=KI(f);te(xe??null)});var N=bX(F&&!j),O=Ht(N,2),V=O[0],U=O[1],ae=j??V;MX(h&&l&&Oi()&&(ae===V||ae===document.body));var le=null;if(E&&Hh(E)&&o){var ne=E;le=ne.ref}var de=dk(le,o);if(!F||!Oi()||j===void 0)return null;var $=ae===!1||CX(),ue=E;return o&&(ue=A.cloneElement(E,{ref:de})),A.createElement(K8.Provider,{value:U},$?ue:Tp.createPortal(ue,ae))});function AX(){var n=ft({},x_);return n.useId}var JI=0;function IX(n){var o=A.useState("ssr-id"),l=Ht(o,2),h=l[0],f=l[1],g=AX(),x=g==null?void 0:g();return A.useEffect(function(){if(!g){var E=JI;JI+=1,f("rc_unique_".concat(E))}},[]),n||x||h}const PX=()=>Oi()&&window.document.documentElement;let u0;const kX=()=>{if(!PX())return!1;if(u0!==void 0)return u0;const n=document.createElement("div");n.style.display="flex",n.style.flexDirection="column",n.style.rowGap="1px",n.appendChild(document.createElement("div")),n.appendChild(document.createElement("div"));const o=document.createElement("div");return o.style.position="absolute",o.style.zIndex="-9999",o.appendChild(n),document.body.appendChild(o),u0=n.scrollHeight===1,document.body.removeChild(o),u0};var vc="RC_FORM_INTERNAL_HOOKS",yn=function(){xo(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},Lc=A.createContext({getFieldValue:yn,getFieldsValue:yn,getFieldError:yn,getFieldWarning:yn,getFieldsError:yn,isFieldsTouched:yn,isFieldTouched:yn,isFieldValidating:yn,isFieldsValidating:yn,resetFields:yn,setFields:yn,setFieldValue:yn,setFieldsValue:yn,validateFields:yn,submit:yn,getInternalHooks:function(){return yn(),{dispatch:yn,initEntityValue:yn,registerField:yn,useSubscribe:yn,setInitialValues:yn,destroyForm:yn,setCallbacks:yn,registerWatch:yn,getFields:yn,setValidateMessages:yn,setPreserve:yn,getInitialValue:yn}}}),fp=A.createContext(null);function pw(n){return n==null?[]:Array.isArray(n)?n:[n]}function RX(n){return n&&!!n._init}function xc(){return xc=Object.assign?Object.assign.bind():function(n){for(var o=1;o<arguments.length;o++){var l=arguments[o];for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&(n[h]=l[h])}return n},xc.apply(this,arguments)}function zX(n,o){n.prototype=Object.create(o.prototype),n.prototype.constructor=n,pp(n,o)}function mw(n){return mw=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(l){return l.__proto__||Object.getPrototypeOf(l)},mw(n)}function pp(n,o){return pp=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(h,f){return h.__proto__=f,h},pp(n,o)}function DX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function k0(n,o,l){return DX()?k0=Reflect.construct.bind():k0=function(f,g,x){var E=[null];E.push.apply(E,g);var w=Function.bind.apply(f,E),I=new w;return x&&pp(I,x.prototype),I},k0.apply(null,arguments)}function LX(n){return Function.toString.call(n).indexOf("[native code]")!==-1}function gw(n){var o=typeof Map=="function"?new Map:void 0;return gw=function(h){if(h===null||!LX(h))return h;if(typeof h!="function")throw new TypeError("Super expression must either be null or a function");if(typeof o<"u"){if(o.has(h))return o.get(h);o.set(h,f)}function f(){return k0(h,arguments,mw(this).constructor)}return f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}),pp(f,h)},gw(n)}var OX=/%[sdj%]/g,FX=function(){};typeof process<"u"&&process.env;function _w(n){if(!n||!n.length)return null;var o={};return n.forEach(function(l){var h=l.field;o[h]=o[h]||[],o[h].push(l)}),o}function vo(n){for(var o=arguments.length,l=new Array(o>1?o-1:0),h=1;h<o;h++)l[h-1]=arguments[h];var f=0,g=l.length;if(typeof n=="function")return n.apply(null,l);if(typeof n=="string"){var x=n.replace(OX,function(E){if(E==="%%")return"%";if(f>=g)return E;switch(E){case"%s":return String(l[f++]);case"%d":return Number(l[f++]);case"%j":try{return JSON.stringify(l[f++])}catch{return"[Circular]"}break;default:return E}});return x}return n}function BX(n){return n==="string"||n==="url"||n==="hex"||n==="email"||n==="date"||n==="pattern"}function hi(n,o){return!!(n==null||o==="array"&&Array.isArray(n)&&!n.length||BX(o)&&typeof n=="string"&&!n)}function NX(n,o,l){var h=[],f=0,g=n.length;function x(E){h.push.apply(h,E||[]),f++,f===g&&l(h)}n.forEach(function(E){o(E,x)})}function QI(n,o,l){var h=0,f=n.length;function g(x){if(x&&x.length){l(x);return}var E=h;h=h+1,E<f?o(n[E],g):l([])}g([])}function jX(n){var o=[];return Object.keys(n).forEach(function(l){o.push.apply(o,n[l]||[])}),o}var eP=function(n){zX(o,n);function o(l,h){var f;return f=n.call(this,"Async Validation Error")||this,f.errors=l,f.fields=h,f}return o}(gw(Error));function $X(n,o,l,h,f){if(o.first){var g=new Promise(function(F,q){var G=function(N){return h(N),N.length?q(new eP(N,_w(N))):F(f)},j=jX(n);QI(j,l,G)});return g.catch(function(F){return F}),g}var x=o.firstFields===!0?Object.keys(n):o.firstFields||[],E=Object.keys(n),w=E.length,I=0,R=[],D=new Promise(function(F,q){var G=function(te){if(R.push.apply(R,te),I++,I===w)return h(R),R.length?q(new eP(R,_w(R))):F(f)};E.length||(h(R),F(f)),E.forEach(function(j){var te=n[j];x.indexOf(j)!==-1?QI(te,l,G):NX(te,l,G)})});return D.catch(function(F){return F}),D}function VX(n){return!!(n&&n.message!==void 0)}function UX(n,o){for(var l=n,h=0;h<o.length;h++){if(l==null)return l;l=l[o[h]]}return l}function tP(n,o){return function(l){var h;return n.fullFields?h=UX(o,n.fullFields):h=o[l.field||n.fullField],VX(l)?(l.field=l.field||n.fullField,l.fieldValue=h,l):{message:typeof l=="function"?l():l,fieldValue:h,field:l.field||n.fullField}}}function rP(n,o){if(o){for(var l in o)if(o.hasOwnProperty(l)){var h=o[l];typeof h=="object"&&typeof n[l]=="object"?n[l]=xc({},n[l],h):n[l]=h}}return n}var Q8=function(o,l,h,f,g,x){o.required&&(!h.hasOwnProperty(o.field)||hi(l,x||o.type))&&f.push(vo(g.messages.required,o.fullField))},GX=function(o,l,h,f,g){(/^\s+$/.test(l)||l==="")&&f.push(vo(g.messages.whitespace,o.fullField))},h0,WX=function(){if(h0)return h0;var n="[a-fA-F\\d:]",o=function(U){return U&&U.includeBoundaries?"(?:(?<=\\s|^)(?="+n+")|(?<="+n+")(?=\\s|$))":""},l="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",h="[a-fA-F\\d]{1,4}",f=(`
(?:
(?:`+h+":){7}(?:"+h+`|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8
(?:`+h+":){6}(?:"+l+"|:"+h+`|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4
(?:`+h+":){5}(?::"+l+"|(?::"+h+`){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4
(?:`+h+":){4}(?:(?::"+h+"){0,1}:"+l+"|(?::"+h+`){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4
(?:`+h+":){3}(?:(?::"+h+"){0,2}:"+l+"|(?::"+h+`){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4
(?:`+h+":){2}(?:(?::"+h+"){0,3}:"+l+"|(?::"+h+`){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4
(?:`+h+":){1}(?:(?::"+h+"){0,4}:"+l+"|(?::"+h+`){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4
(?::(?:(?::`+h+"){0,5}:"+l+"|(?::"+h+`){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4
)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1
`).replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),g=new RegExp("(?:^"+l+"$)|(?:^"+f+"$)"),x=new RegExp("^"+l+"$"),E=new RegExp("^"+f+"$"),w=function(U){return U&&U.exact?g:new RegExp("(?:"+o(U)+l+o(U)+")|(?:"+o(U)+f+o(U)+")","g")};w.v4=function(V){return V&&V.exact?x:new RegExp(""+o(V)+l+o(V),"g")},w.v6=function(V){return V&&V.exact?E:new RegExp(""+o(V)+f+o(V),"g")};var I="(?:(?:[a-z]+:)?//)",R="(?:\\S+(?::\\S*)?@)?",D=w.v4().source,F=w.v6().source,q="(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)",G="(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*",j="(?:\\.(?:[a-z\\u00a1-\\uffff]{2,}))",te="(?::\\d{2,5})?",N='(?:[/?#][^\\s"]*)?',O="(?:"+I+"|www\\.)"+R+"(?:localhost|"+D+"|"+F+"|"+q+G+j+")"+te+N;return h0=new RegExp("(?:^"+O+"$)","i"),h0},nP={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},If={integer:function(o){return If.number(o)&&parseInt(o,10)===o},float:function(o){return If.number(o)&&!If.integer(o)},array:function(o){return Array.isArray(o)},regexp:function(o){if(o instanceof RegExp)return!0;try{return!!new RegExp(o)}catch{return!1}},date:function(o){return typeof o.getTime=="function"&&typeof o.getMonth=="function"&&typeof o.getYear=="function"&&!isNaN(o.getTime())},number:function(o){return isNaN(o)?!1:typeof o=="number"},object:function(o){return typeof o=="object"&&!If.array(o)},method:function(o){return typeof o=="function"},email:function(o){return typeof o=="string"&&o.length<=320&&!!o.match(nP.email)},url:function(o){return typeof o=="string"&&o.length<=2048&&!!o.match(WX())},hex:function(o){return typeof o=="string"&&!!o.match(nP.hex)}},HX=function(o,l,h,f,g){if(o.required&&l===void 0){Q8(o,l,h,f,g);return}var x=["integer","float","array","regexp","object","method","email","number","date","url","hex"],E=o.type;x.indexOf(E)>-1?If[E](l)||f.push(vo(g.messages.types[E],o.fullField,o.type)):E&&typeof l!==o.type&&f.push(vo(g.messages.types[E],o.fullField,o.type))},qX=function(o,l,h,f,g){var x=typeof o.len=="number",E=typeof o.min=="number",w=typeof o.max=="number",I=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,R=l,D=null,F=typeof l=="number",q=typeof l=="string",G=Array.isArray(l);if(F?D="number":q?D="string":G&&(D="array"),!D)return!1;G&&(R=l.length),q&&(R=l.replace(I,"_").length),x?R!==o.len&&f.push(vo(g.messages[D].len,o.fullField,o.len)):E&&!w&&R<o.min?f.push(vo(g.messages[D].min,o.fullField,o.min)):w&&!E&&R>o.max?f.push(vo(g.messages[D].max,o.fullField,o.max)):E&&w&&(R<o.min||R>o.max)&&f.push(vo(g.messages[D].range,o.fullField,o.min,o.max))},Yu="enum",ZX=function(o,l,h,f,g){o[Yu]=Array.isArray(o[Yu])?o[Yu]:[],o[Yu].indexOf(l)===-1&&f.push(vo(g.messages[Yu],o.fullField,o[Yu].join(", ")))},XX=function(o,l,h,f,g){if(o.pattern){if(o.pattern instanceof RegExp)o.pattern.lastIndex=0,o.pattern.test(l)||f.push(vo(g.messages.pattern.mismatch,o.fullField,l,o.pattern));else if(typeof o.pattern=="string"){var x=new RegExp(o.pattern);x.test(l)||f.push(vo(g.messages.pattern.mismatch,o.fullField,l,o.pattern))}}},qr={required:Q8,whitespace:GX,type:HX,range:qX,enum:ZX,pattern:XX},YX=function(o,l,h,f,g){var x=[],E=o.required||!o.required&&f.hasOwnProperty(o.field);if(E){if(hi(l,"string")&&!o.required)return h();qr.required(o,l,f,x,g,"string"),hi(l,"string")||(qr.type(o,l,f,x,g),qr.range(o,l,f,x,g),qr.pattern(o,l,f,x,g),o.whitespace===!0&&qr.whitespace(o,l,f,x,g))}h(x)},KX=function(o,l,h,f,g){var x=[],E=o.required||!o.required&&f.hasOwnProperty(o.field);if(E){if(hi(l)&&!o.required)return h();qr.required(o,l,f,x,g),l!==void 0&&qr.type(o,l,f,x,g)}h(x)},JX=function(o,l,h,f,g){var x=[],E=o.required||!o.required&&f.hasOwnProperty(o.field);if(E){if(l===""&&(l=void 0),hi(l)&&!o.required)return h();qr.required(o,l,f,x,g),l!==void 0&&(qr.type(o,l,f,x,g),qr.range(o,l,f,x,g))}h(x)},QX=function(o,l,h,f,g){var x=[],E=o.required||!o.required&&f.hasOwnProperty(o.field);if(E){if(hi(l)&&!o.required)return h();qr.required(o,l,f,x,g),l!==void 0&&qr.type(o,l,f,x,g)}h(x)},eY=function(o,l,h,f,g){var x=[],E=o.required||!o.required&&f.hasOwnProperty(o.field);if(E){if(hi(l)&&!o.required)return h();qr.required(o,l,f,x,g),hi(l)||qr.type(o,l,f,x,g)}h(x)},tY=function(o,l,h,f,g){var x=[],E=o.required||!o.required&&f.hasOwnProperty(o.field);if(E){if(hi(l)&&!o.required)return h();qr.required(o,l,f,x,g),l!==void 0&&(qr.type(o,l,f,x,g),qr.range(o,l,f,x,g))}h(x)},rY=function(o,l,h,f,g){var x=[],E=o.required||!o.required&&f.hasOwnProperty(o.field);if(E){if(hi(l)&&!o.required)return h();qr.required(o,l,f,x,g),l!==void 0&&(qr.type(o,l,f,x,g),qr.range(o,l,f,x,g))}h(x)},nY=function(o,l,h,f,g){var x=[],E=o.required||!o.required&&f.hasOwnProperty(o.field);if(E){if(l==null&&!o.required)return h();qr.required(o,l,f,x,g,"array"),l!=null&&(qr.type(o,l,f,x,g),qr.range(o,l,f,x,g))}h(x)},iY=function(o,l,h,f,g){var x=[],E=o.required||!o.required&&f.hasOwnProperty(o.field);if(E){if(hi(l)&&!o.required)return h();qr.required(o,l,f,x,g),l!==void 0&&qr.type(o,l,f,x,g)}h(x)},oY="enum",aY=function(o,l,h,f,g){var x=[],E=o.required||!o.required&&f.hasOwnProperty(o.field);if(E){if(hi(l)&&!o.required)return h();qr.required(o,l,f,x,g),l!==void 0&&qr[oY](o,l,f,x,g)}h(x)},sY=function(o,l,h,f,g){var x=[],E=o.required||!o.required&&f.hasOwnProperty(o.field);if(E){if(hi(l,"string")&&!o.required)return h();qr.required(o,l,f,x,g),hi(l,"string")||qr.pattern(o,l,f,x,g)}h(x)},lY=function(o,l,h,f,g){var x=[],E=o.required||!o.required&&f.hasOwnProperty(o.field);if(E){if(hi(l,"date")&&!o.required)return h();if(qr.required(o,l,f,x,g),!hi(l,"date")){var w;l instanceof Date?w=l:w=new Date(l),qr.type(o,w,f,x,g),w&&qr.range(o,w.getTime(),f,x,g)}}h(x)},cY=function(o,l,h,f,g){var x=[],E=Array.isArray(l)?"array":typeof l;qr.required(o,l,f,x,g,E),h(x)},Bb=function(o,l,h,f,g){var x=o.type,E=[],w=o.required||!o.required&&f.hasOwnProperty(o.field);if(w){if(hi(l,x)&&!o.required)return h();qr.required(o,l,f,E,g,x),hi(l,x)||qr.type(o,l,f,E,g)}h(E)},uY=function(o,l,h,f,g){var x=[],E=o.required||!o.required&&f.hasOwnProperty(o.field);if(E){if(hi(l)&&!o.required)return h();qr.required(o,l,f,x,g)}h(x)},$f={string:YX,method:KX,number:JX,boolean:QX,regexp:eY,integer:tY,float:rY,array:nY,object:iY,enum:aY,pattern:sY,date:lY,url:Bb,hex:Bb,email:Bb,required:cY,any:uY};function yw(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var o=JSON.parse(JSON.stringify(this));return o.clone=this.clone,o}}}var vw=yw(),Ip=function(){function n(l){this.rules=null,this._messages=vw,this.define(l)}var o=n.prototype;return o.define=function(h){var f=this;if(!h)throw new Error("Cannot configure a schema with no rules");if(typeof h!="object"||Array.isArray(h))throw new Error("Rules must be an object");this.rules={},Object.keys(h).forEach(function(g){var x=h[g];f.rules[g]=Array.isArray(x)?x:[x]})},o.messages=function(h){return h&&(this._messages=rP(yw(),h)),this._messages},o.validate=function(h,f,g){var x=this;f===void 0&&(f={}),g===void 0&&(g=function(){});var E=h,w=f,I=g;if(typeof w=="function"&&(I=w,w={}),!this.rules||Object.keys(this.rules).length===0)return I&&I(null,E),Promise.resolve(E);function R(j){var te=[],N={};function O(U){if(Array.isArray(U)){var ae;te=(ae=te).concat.apply(ae,U)}else te.push(U)}for(var V=0;V<j.length;V++)O(j[V]);te.length?(N=_w(te),I(te,N)):I(null,E)}if(w.messages){var D=this.messages();D===vw&&(D=yw()),rP(D,w.messages),w.messages=D}else w.messages=this.messages();var F={},q=w.keys||Object.keys(this.rules);q.forEach(function(j){var te=x.rules[j],N=E[j];te.forEach(function(O){var V=O;typeof V.transform=="function"&&(E===h&&(E=xc({},E)),N=E[j]=V.transform(N)),typeof V=="function"?V={validator:V}:V=xc({},V),V.validator=x.getValidationMethod(V),V.validator&&(V.field=j,V.fullField=V.fullField||j,V.type=x.getType(V),F[j]=F[j]||[],F[j].push({rule:V,value:N,source:E,field:j}))})});var G={};return $X(F,w,function(j,te){var N=j.rule,O=(N.type==="object"||N.type==="array")&&(typeof N.fields=="object"||typeof N.defaultField=="object");O=O&&(N.required||!N.required&&j.value),N.field=j.field;function V(le,ne){return xc({},ne,{fullField:N.fullField+"."+le,fullFields:N.fullFields?[].concat(N.fullFields,[le]):[le]})}function U(le){le===void 0&&(le=[]);var ne=Array.isArray(le)?le:[le];!w.suppressWarning&&ne.length&&n.warning("async-validator:",ne),ne.length&&N.message!==void 0&&(ne=[].concat(N.message));var de=ne.map(tP(N,E));if(w.first&&de.length)return G[N.field]=1,te(de);if(!O)te(de);else{if(N.required&&!j.value)return N.message!==void 0?de=[].concat(N.message).map(tP(N,E)):w.error&&(de=[w.error(N,vo(w.messages.required,N.field))]),te(de);var $={};N.defaultField&&Object.keys(j.value).map(function(ce){$[ce]=N.defaultField}),$=xc({},$,j.rule.fields);var ue={};Object.keys($).forEach(function(ce){var se=$[ce],ke=Array.isArray(se)?se:[se];ue[ce]=ke.map(V.bind(null,ce))});var xe=new n(ue);xe.messages(w.messages),j.rule.options&&(j.rule.options.messages=w.messages,j.rule.options.error=w.error),xe.validate(j.value,j.rule.options||w,function(ce){var se=[];de&&de.length&&se.push.apply(se,de),ce&&ce.length&&se.push.apply(se,ce),te(se.length?se:null)})}}var ae;if(N.asyncValidator)ae=N.asyncValidator(N,j.value,U,j.source,w);else if(N.validator){try{ae=N.validator(N,j.value,U,j.source,w)}catch(le){console.error==null||console.error(le),w.suppressValidatorError||setTimeout(function(){throw le},0),U(le.message)}ae===!0?U():ae===!1?U(typeof N.message=="function"?N.message(N.fullField||N.field):N.message||(N.fullField||N.field)+" fails"):ae instanceof Array?U(ae):ae instanceof Error&&U(ae.message)}ae&&ae.then&&ae.then(function(){return U()},function(le){return U(le)})},function(j){R(j)},E)},o.getType=function(h){if(h.type===void 0&&h.pattern instanceof RegExp&&(h.type="pattern"),typeof h.validator!="function"&&h.type&&!$f.hasOwnProperty(h.type))throw new Error(vo("Unknown rule type %s",h.type));return h.type||"string"},o.getValidationMethod=function(h){if(typeof h.validator=="function")return h.validator;var f=Object.keys(h),g=f.indexOf("message");return g!==-1&&f.splice(g,1),f.length===1&&f[0]==="required"?$f.required:$f[this.getType(h)]||void 0},n}();Ip.register=function(o,l){if(typeof l!="function")throw new Error("Cannot register a validator by type, validator is not a function");$f[o]=l};Ip.warning=FX;Ip.messages=vw;Ip.validators=$f;var po="'${name}' is not a valid ${type}",eD={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:po,method:po,array:po,object:po,number:po,date:po,boolean:po,integer:po,float:po,regexp:po,email:po,url:po,hex:po},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},iP=Ip;function hY(n,o){return n.replace(/\$\{\w+\}/g,function(l){var h=l.slice(2,-1);return o[h]})}var oP="CODE_LOGIC_ERROR";function xw(n,o,l,h,f){return bw.apply(this,arguments)}function bw(){return bw=Jh(Eo().mark(function n(o,l,h,f,g){var x,E,w,I,R,D,F,q,G;return Eo().wrap(function(te){for(;;)switch(te.prev=te.next){case 0:return x=ft({},h),delete x.ruleIndex,iP.warning=function(){},x.validator&&(E=x.validator,x.validator=function(){try{return E.apply(void 0,arguments)}catch(N){return console.error(N),Promise.reject(oP)}}),w=null,x&&x.type==="array"&&x.defaultField&&(w=x.defaultField,delete x.defaultField),I=new iP($r({},o,[x])),R=vh(eD,f.validateMessages),I.messages(R),D=[],te.prev=10,te.next=13,Promise.resolve(I.validate($r({},o,l),ft({},f)));case 13:te.next=18;break;case 15:te.prev=15,te.t0=te.catch(10),te.t0.errors&&(D=te.t0.errors.map(function(N,O){var V=N.message,U=V===oP?R.default:V;return A.isValidElement(U)?A.cloneElement(U,{key:"error_".concat(O)}):U}));case 18:if(!(!D.length&&w)){te.next=23;break}return te.next=21,Promise.all(l.map(function(N,O){return xw("".concat(o,".").concat(O),N,w,f,g)}));case 21:return F=te.sent,te.abrupt("return",F.reduce(function(N,O){return[].concat(Jt(N),Jt(O))},[]));case 23:return q=ft(ft({},h),{},{name:o,enum:(h.enum||[]).join(", ")},g),G=D.map(function(N){return typeof N=="string"?hY(N,q):N}),te.abrupt("return",G);case 26:case"end":return te.stop()}},n,null,[[10,15]])})),bw.apply(this,arguments)}function dY(n,o,l,h,f,g){var x=n.join("."),E=l.map(function(R,D){var F=R.validator,q=ft(ft({},R),{},{ruleIndex:D});return F&&(q.validator=function(G,j,te){var N=!1,O=function(){for(var ae=arguments.length,le=new Array(ae),ne=0;ne<ae;ne++)le[ne]=arguments[ne];Promise.resolve().then(function(){xo(!N,"Your validator function has already return a promise. `callback` will be ignored."),N||te.apply(void 0,le)})},V=F(G,j,O);N=V&&typeof V.then=="function"&&typeof V.catch=="function",xo(N,"`callback` is deprecated. Please return a promise instead."),N&&V.then(function(){te()}).catch(function(U){te(U||" ")})}),q}).sort(function(R,D){var F=R.warningOnly,q=R.ruleIndex,G=D.warningOnly,j=D.ruleIndex;return!!F==!!G?q-j:F?1:-1}),w;if(f===!0)w=new Promise(function(){var R=Jh(Eo().mark(function D(F,q){var G,j,te;return Eo().wrap(function(O){for(;;)switch(O.prev=O.next){case 0:G=0;case 1:if(!(G<E.length)){O.next=12;break}return j=E[G],O.next=5,xw(x,o,j,h,g);case 5:if(te=O.sent,!te.length){O.next=9;break}return q([{errors:te,rule:j}]),O.abrupt("return");case 9:G+=1,O.next=1;break;case 12:F([]);case 13:case"end":return O.stop()}},D)}));return function(D,F){return R.apply(this,arguments)}}());else{var I=E.map(function(R){return xw(x,o,R,h,g).then(function(D){return{errors:D,rule:R}})});w=(f?pY(I):fY(I)).then(function(R){return Promise.reject(R)})}return w.catch(function(R){return R}),w}function fY(n){return ww.apply(this,arguments)}function ww(){return ww=Jh(Eo().mark(function n(o){return Eo().wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",Promise.all(o).then(function(f){var g,x=(g=[]).concat.apply(g,Jt(f));return x}));case 1:case"end":return h.stop()}},n)})),ww.apply(this,arguments)}function pY(n){return Ew.apply(this,arguments)}function Ew(){return Ew=Jh(Eo().mark(function n(o){var l;return Eo().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return l=0,f.abrupt("return",new Promise(function(g){o.forEach(function(x){x.then(function(E){E.errors.length&&g([E]),l+=1,l===o.length&&g([])})})}));case 2:case"end":return f.stop()}},n)})),Ew.apply(this,arguments)}function Yn(n){return pw(n)}function aP(n,o){var l={};return o.forEach(function(h){var f=pa(n,h);l=ua(l,h,f)}),l}function Vf(n,o){return n&&n.some(function(l){return tD(l,o)})}function tD(n,o){return!n||!o||n.length!==o.length?!1:n.every(function(l,h){return o[h]===l})}function mY(n,o){if(n===o)return!0;if(!n&&o||n&&!o||!n||!o||bn(n)!=="object"||bn(o)!=="object")return!1;var l=Object.keys(n),h=Object.keys(o),f=new Set([].concat(l,h));return Jt(f).every(function(g){var x=n[g],E=o[g];return typeof x=="function"&&typeof E=="function"?!0:x===E})}function gY(n){var o=arguments.length<=1?void 0:arguments[1];return o&&o.target&&bn(o.target)==="object"&&n in o.target?o.target[n]:o}function sP(n,o,l){var h=n.length;if(o<0||o>=h||l<0||l>=h)return n;var f=n[o],g=o-l;return g>0?[].concat(Jt(n.slice(0,l)),[f],Jt(n.slice(l,o)),Jt(n.slice(o+1,h))):g<0?[].concat(Jt(n.slice(0,o)),Jt(n.slice(o+1,l+1)),[f],Jt(n.slice(l+1,h))):n}var _Y=["name"],Fo=[];function lP(n,o,l,h,f,g){return typeof n=="function"?n(o,l,"source"in g?{source:g.source}:{}):h!==f}var nE=function(n){b_(l,n);var o=w_(l);function l(h){var f;if(Va(this,l),f=o.call(this,h),f.state={resetCount:0},f.cancelRegisterFunc=null,f.mounted=!1,f.touched=!1,f.dirty=!1,f.validatePromise=void 0,f.prevValidating=void 0,f.errors=Fo,f.warnings=Fo,f.cancelRegister=function(){var w=f.props,I=w.preserve,R=w.isListField,D=w.name;f.cancelRegisterFunc&&f.cancelRegisterFunc(R,I,Yn(D)),f.cancelRegisterFunc=null},f.getNamePath=function(){var w=f.props,I=w.name,R=w.fieldContext,D=R.prefixName,F=D===void 0?[]:D;return I!==void 0?[].concat(Jt(F),Jt(I)):[]},f.getRules=function(){var w=f.props,I=w.rules,R=I===void 0?[]:I,D=w.fieldContext;return R.map(function(F){return typeof F=="function"?F(D):F})},f.refresh=function(){f.mounted&&f.setState(function(w){var I=w.resetCount;return{resetCount:I+1}})},f.metaCache=null,f.triggerMetaEvent=function(w){var I=f.props.onMetaChange;if(I){var R=ft(ft({},f.getMeta()),{},{destroy:w});Cz(f.metaCache,R)||I(R),f.metaCache=R}else f.metaCache=null},f.onStoreChange=function(w,I,R){var D=f.props,F=D.shouldUpdate,q=D.dependencies,G=q===void 0?[]:q,j=D.onReset,te=R.store,N=f.getNamePath(),O=f.getValue(w),V=f.getValue(te),U=I&&Vf(I,N);switch(R.type==="valueUpdate"&&R.source==="external"&&O!==V&&(f.touched=!0,f.dirty=!0,f.validatePromise=null,f.errors=Fo,f.warnings=Fo,f.triggerMetaEvent()),R.type){case"reset":if(!I||U){f.touched=!1,f.dirty=!1,f.validatePromise=void 0,f.errors=Fo,f.warnings=Fo,f.triggerMetaEvent(),j==null||j(),f.refresh();return}break;case"remove":{if(F){f.reRender();return}break}case"setField":{if(U){var ae=R.data;"touched"in ae&&(f.touched=ae.touched),"validating"in ae&&!("originRCField"in ae)&&(f.validatePromise=ae.validating?Promise.resolve([]):null),"errors"in ae&&(f.errors=ae.errors||Fo),"warnings"in ae&&(f.warnings=ae.warnings||Fo),f.dirty=!0,f.triggerMetaEvent(),f.reRender();return}if(F&&!N.length&&lP(F,w,te,O,V,R)){f.reRender();return}break}case"dependenciesUpdate":{var le=G.map(Yn);if(le.some(function(ne){return Vf(R.relatedFields,ne)})){f.reRender();return}break}default:if(U||(!G.length||N.length||F)&&lP(F,w,te,O,V,R)){f.reRender();return}break}F===!0&&f.reRender()},f.validateRules=function(w){var I=f.getNamePath(),R=f.getValue(),D=w||{},F=D.triggerName,q=D.validateOnly,G=q===void 0?!1:q,j=Promise.resolve().then(function(){if(!f.mounted)return[];var te=f.props,N=te.validateFirst,O=N===void 0?!1:N,V=te.messageVariables,U=f.getRules();F&&(U=U.filter(function(le){return le}).filter(function(le){var ne=le.validateTrigger;if(!ne)return!0;var de=pw(ne);return de.includes(F)}));var ae=dY(I,R,U,w,O,V);return ae.catch(function(le){return le}).then(function(){var le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fo;if(f.validatePromise===j){var ne;f.validatePromise=null;var de=[],$=[];(ne=le.forEach)===null||ne===void 0||ne.call(le,function(ue){var xe=ue.rule.warningOnly,ce=ue.errors,se=ce===void 0?Fo:ce;xe?$.push.apply($,Jt(se)):de.push.apply(de,Jt(se))}),f.errors=de,f.warnings=$,f.triggerMetaEvent(),f.reRender()}}),ae});return G||(f.validatePromise=j,f.dirty=!0,f.errors=Fo,f.warnings=Fo,f.triggerMetaEvent(),f.reRender()),j},f.isFieldValidating=function(){return!!f.validatePromise},f.isFieldTouched=function(){return f.touched},f.isFieldDirty=function(){if(f.dirty||f.props.initialValue!==void 0)return!0;var w=f.props.fieldContext,I=w.getInternalHooks(vc),R=I.getInitialValue;return R(f.getNamePath())!==void 0},f.getErrors=function(){return f.errors},f.getWarnings=function(){return f.warnings},f.isListField=function(){return f.props.isListField},f.isList=function(){return f.props.isList},f.isPreserve=function(){return f.props.preserve},f.getMeta=function(){f.prevValidating=f.isFieldValidating();var w={touched:f.isFieldTouched(),validating:f.prevValidating,errors:f.errors,warnings:f.warnings,name:f.getNamePath(),validated:f.validatePromise===null};return w},f.getOnlyChild=function(w){if(typeof w=="function"){var I=f.getMeta();return ft(ft({},f.getOnlyChild(w(f.getControlled(),I,f.props.fieldContext))),{},{isFunction:!0})}var R=Wf(w);return R.length!==1||!A.isValidElement(R[0])?{child:R,isFunction:!1}:{child:R[0],isFunction:!1}},f.getValue=function(w){var I=f.props.fieldContext.getFieldsValue,R=f.getNamePath();return pa(w||I(!0),R)},f.getControlled=function(){var w=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},I=f.props,R=I.trigger,D=I.validateTrigger,F=I.getValueFromEvent,q=I.normalize,G=I.valuePropName,j=I.getValueProps,te=I.fieldContext,N=D!==void 0?D:te.validateTrigger,O=f.getNamePath(),V=te.getInternalHooks,U=te.getFieldsValue,ae=V(vc),le=ae.dispatch,ne=f.getValue(),de=j||function(ce){return $r({},G,ce)},$=w[R],ue=ft(ft({},w),de(ne));ue[R]=function(){f.touched=!0,f.dirty=!0,f.triggerMetaEvent();for(var ce,se=arguments.length,ke=new Array(se),$e=0;$e<se;$e++)ke[$e]=arguments[$e];F?ce=F.apply(void 0,ke):ce=gY.apply(void 0,[G].concat(ke)),q&&(ce=q(ce,ne,U(!0))),le({type:"updateValue",namePath:O,value:ce}),$&&$.apply(void 0,ke)};var xe=pw(N||[]);return xe.forEach(function(ce){var se=ue[ce];ue[ce]=function(){se&&se.apply(void 0,arguments);var ke=f.props.rules;ke&&ke.length&&le({type:"validateField",namePath:O,triggerName:ce})}}),ue},h.fieldContext){var g=h.fieldContext.getInternalHooks,x=g(vc),E=x.initEntityValue;E(D0(f))}return f}return Ua(l,[{key:"componentDidMount",value:function(){var f=this.props,g=f.shouldUpdate,x=f.fieldContext;if(this.mounted=!0,x){var E=x.getInternalHooks,w=E(vc),I=w.registerField;this.cancelRegisterFunc=I(this)}g===!0&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var f=this.state.resetCount,g=this.props.children,x=this.getOnlyChild(g),E=x.child,w=x.isFunction,I;return w?I=E:A.isValidElement(E)?I=A.cloneElement(E,this.getControlled(E.props)):(xo(!E,"`children` of Field is not validate ReactElement."),I=E),A.createElement(A.Fragment,{key:f},I)}}]),l}(A.Component);nE.contextType=Lc;nE.defaultProps={trigger:"onChange",valuePropName:"value"};function iE(n){var o=n.name,l=xa(n,_Y),h=A.useContext(Lc),f=A.useContext(fp),g=o!==void 0?Yn(o):void 0,x="keep";return l.isListField||(x="_".concat((g||[]).join("_"))),A.createElement(nE,ui({key:x,name:g,isListField:!!f},l,{fieldContext:h}))}function rD(n){var o=n.name,l=n.initialValue,h=n.children,f=n.rules,g=n.validateTrigger,x=n.isListField,E=A.useContext(Lc),w=A.useContext(fp),I=A.useRef({keys:[],id:0}),R=I.current,D=A.useMemo(function(){var j=Yn(E.prefixName)||[];return[].concat(Jt(j),Jt(Yn(o)))},[E.prefixName,o]),F=A.useMemo(function(){return ft(ft({},E),{},{prefixName:D})},[E,D]),q=A.useMemo(function(){return{getKey:function(te){var N=D.length,O=te[N];return[R.keys[O],te.slice(N+1)]}}},[D]);if(typeof h!="function")return xo(!1,"Form.List only accepts function as children."),null;var G=function(te,N,O){var V=O.source;return V==="internal"?!1:te!==N};return A.createElement(fp.Provider,{value:q},A.createElement(Lc.Provider,{value:F},A.createElement(iE,{name:[],shouldUpdate:G,rules:f,validateTrigger:g,initialValue:l,isList:!0,isListField:x??!!w},function(j,te){var N=j.value,O=N===void 0?[]:N,V=j.onChange,U=E.getFieldValue,ae=function(){var $=U(D||[]);return $||[]},le={add:function($,ue){var xe=ae();ue>=0&&ue<=xe.length?(R.keys=[].concat(Jt(R.keys.slice(0,ue)),[R.id],Jt(R.keys.slice(ue))),V([].concat(Jt(xe.slice(0,ue)),[$],Jt(xe.slice(ue))))):(R.keys=[].concat(Jt(R.keys),[R.id]),V([].concat(Jt(xe),[$]))),R.id+=1},remove:function($){var ue=ae(),xe=new Set(Array.isArray($)?$:[$]);xe.size<=0||(R.keys=R.keys.filter(function(ce,se){return!xe.has(se)}),V(ue.filter(function(ce,se){return!xe.has(se)})))},move:function($,ue){if($!==ue){var xe=ae();$<0||$>=xe.length||ue<0||ue>=xe.length||(R.keys=sP(R.keys,$,ue),V(sP(xe,$,ue)))}}},ne=O||[];return Array.isArray(ne)||(ne=[]),h(ne.map(function(de,$){var ue=R.keys[$];return ue===void 0&&(R.keys[$]=R.id,ue=R.keys[$],R.id+=1),{name:$,key:ue,isListField:!0}}),le,te)})))}function yY(n){var o=!1,l=n.length,h=[];return n.length?new Promise(function(f,g){n.forEach(function(x,E){x.catch(function(w){return o=!0,w}).then(function(w){l-=1,h[E]=w,!(l>0)&&(o&&g(h),f(h))})})}):Promise.resolve([])}var nD="__@field_split__";function Nb(n){return n.map(function(o){return"".concat(bn(o),":").concat(o)}).join(nD)}var Ku=function(){function n(){Va(this,n),this.kvs=new Map}return Ua(n,[{key:"set",value:function(l,h){this.kvs.set(Nb(l),h)}},{key:"get",value:function(l){return this.kvs.get(Nb(l))}},{key:"update",value:function(l,h){var f=this.get(l),g=h(f);g?this.set(l,g):this.delete(l)}},{key:"delete",value:function(l){this.kvs.delete(Nb(l))}},{key:"map",value:function(l){return Jt(this.kvs.entries()).map(function(h){var f=Ht(h,2),g=f[0],x=f[1],E=g.split(nD);return l({key:E.map(function(w){var I=w.match(/^([^:]*):(.*)$/),R=Ht(I,3),D=R[1],F=R[2];return D==="number"?Number(F):F}),value:x})})}},{key:"toJSON",value:function(){var l={};return this.map(function(h){var f=h.key,g=h.value;return l[f.join(".")]=g,null}),l}}]),n}(),vY=["name"],xY=Ua(function n(o){var l=this;Va(this,n),this.formHooked=!1,this.forceRootUpdate=void 0,this.subscribable=!0,this.store={},this.fieldEntities=[],this.initialValues={},this.callbacks={},this.validateMessages=null,this.preserve=null,this.lastValidatePromise=null,this.getForm=function(){return{getFieldValue:l.getFieldValue,getFieldsValue:l.getFieldsValue,getFieldError:l.getFieldError,getFieldWarning:l.getFieldWarning,getFieldsError:l.getFieldsError,isFieldsTouched:l.isFieldsTouched,isFieldTouched:l.isFieldTouched,isFieldValidating:l.isFieldValidating,isFieldsValidating:l.isFieldsValidating,resetFields:l.resetFields,setFields:l.setFields,setFieldValue:l.setFieldValue,setFieldsValue:l.setFieldsValue,validateFields:l.validateFields,submit:l.submit,_init:!0,getInternalHooks:l.getInternalHooks}},this.getInternalHooks=function(h){return h===vc?(l.formHooked=!0,{dispatch:l.dispatch,initEntityValue:l.initEntityValue,registerField:l.registerField,useSubscribe:l.useSubscribe,setInitialValues:l.setInitialValues,destroyForm:l.destroyForm,setCallbacks:l.setCallbacks,setValidateMessages:l.setValidateMessages,getFields:l.getFields,setPreserve:l.setPreserve,getInitialValue:l.getInitialValue,registerWatch:l.registerWatch}):(xo(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)},this.useSubscribe=function(h){l.subscribable=h},this.prevWithoutPreserves=null,this.setInitialValues=function(h,f){if(l.initialValues=h||{},f){var g,x=vh(h,l.store);(g=l.prevWithoutPreserves)===null||g===void 0||g.map(function(E){var w=E.key;x=ua(x,w,pa(h,w))}),l.prevWithoutPreserves=null,l.updateStore(x)}},this.destroyForm=function(){var h=new Ku;l.getFieldEntities(!0).forEach(function(f){l.isMergedPreserve(f.isPreserve())||h.set(f.getNamePath(),!0)}),l.prevWithoutPreserves=h},this.getInitialValue=function(h){var f=pa(l.initialValues,h);return h.length?vh(f):f},this.setCallbacks=function(h){l.callbacks=h},this.setValidateMessages=function(h){l.validateMessages=h},this.setPreserve=function(h){l.preserve=h},this.watchList=[],this.registerWatch=function(h){return l.watchList.push(h),function(){l.watchList=l.watchList.filter(function(f){return f!==h})}},this.notifyWatch=function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];if(l.watchList.length){var f=l.getFieldsValue(),g=l.getFieldsValue(!0);l.watchList.forEach(function(x){x(f,g,h)})}},this.timeoutId=null,this.warningUnhooked=function(){},this.updateStore=function(h){l.store=h},this.getFieldEntities=function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return h?l.fieldEntities.filter(function(f){return f.getNamePath().length}):l.fieldEntities},this.getFieldsMap=function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,f=new Ku;return l.getFieldEntities(h).forEach(function(g){var x=g.getNamePath();f.set(x,g)}),f},this.getFieldEntitiesForNamePathList=function(h){if(!h)return l.getFieldEntities(!0);var f=l.getFieldsMap(!0);return h.map(function(g){var x=Yn(g);return f.get(x)||{INVALIDATE_NAME_PATH:Yn(g)}})},this.getFieldsValue=function(h,f){l.warningUnhooked();var g,x,E;if(h===!0||Array.isArray(h)?(g=h,x=f):h&&bn(h)==="object"&&(E=h.strict,x=h.filter),g===!0&&!x)return l.store;var w=l.getFieldEntitiesForNamePathList(Array.isArray(g)?g:null),I=[];return w.forEach(function(R){var D,F="INVALIDATE_NAME_PATH"in R?R.INVALIDATE_NAME_PATH:R.getNamePath();if(E){var q;if(!((q=R.isList)===null||q===void 0)&&q.call(R))return}else if(!g&&(!((D=R.isListField)===null||D===void 0)&&D.call(R)))return;if(!x)I.push(F);else{var G="getMeta"in R?R.getMeta():null;x(G)&&I.push(F)}}),aP(l.store,I.map(Yn))},this.getFieldValue=function(h){l.warningUnhooked();var f=Yn(h);return pa(l.store,f)},this.getFieldsError=function(h){l.warningUnhooked();var f=l.getFieldEntitiesForNamePathList(h);return f.map(function(g,x){return g&&!("INVALIDATE_NAME_PATH"in g)?{name:g.getNamePath(),errors:g.getErrors(),warnings:g.getWarnings()}:{name:Yn(h[x]),errors:[],warnings:[]}})},this.getFieldError=function(h){l.warningUnhooked();var f=Yn(h),g=l.getFieldsError([f])[0];return g.errors},this.getFieldWarning=function(h){l.warningUnhooked();var f=Yn(h),g=l.getFieldsError([f])[0];return g.warnings},this.isFieldsTouched=function(){l.warningUnhooked();for(var h=arguments.length,f=new Array(h),g=0;g<h;g++)f[g]=arguments[g];var x=f[0],E=f[1],w,I=!1;f.length===0?w=null:f.length===1?Array.isArray(x)?(w=x.map(Yn),I=!1):(w=null,I=x):(w=x.map(Yn),I=E);var R=l.getFieldEntities(!0),D=function(te){return te.isFieldTouched()};if(!w)return I?R.every(D):R.some(D);var F=new Ku;w.forEach(function(j){F.set(j,[])}),R.forEach(function(j){var te=j.getNamePath();w.forEach(function(N){N.every(function(O,V){return te[V]===O})&&F.update(N,function(O){return[].concat(Jt(O),[j])})})});var q=function(te){return te.some(D)},G=F.map(function(j){var te=j.value;return te});return I?G.every(q):G.some(q)},this.isFieldTouched=function(h){return l.warningUnhooked(),l.isFieldsTouched([h])},this.isFieldsValidating=function(h){l.warningUnhooked();var f=l.getFieldEntities();if(!h)return f.some(function(x){return x.isFieldValidating()});var g=h.map(Yn);return f.some(function(x){var E=x.getNamePath();return Vf(g,E)&&x.isFieldValidating()})},this.isFieldValidating=function(h){return l.warningUnhooked(),l.isFieldsValidating([h])},this.resetWithFieldInitialValue=function(){var h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=new Ku,g=l.getFieldEntities(!0);g.forEach(function(w){var I=w.props.initialValue,R=w.getNamePath();if(I!==void 0){var D=f.get(R)||new Set;D.add({entity:w,value:I}),f.set(R,D)}});var x=function(I){I.forEach(function(R){var D=R.props.initialValue;if(D!==void 0){var F=R.getNamePath(),q=l.getInitialValue(F);if(q!==void 0)xo(!1,"Form already set 'initialValues' with path '".concat(F.join("."),"'. Field can not overwrite it."));else{var G=f.get(F);if(G&&G.size>1)xo(!1,"Multiple Field with path '".concat(F.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(G){var j=l.getFieldValue(F);(!h.skipExist||j===void 0)&&l.updateStore(ua(l.store,F,Jt(G)[0].value))}}}})},E;h.entities?E=h.entities:h.namePathList?(E=[],h.namePathList.forEach(function(w){var I=f.get(w);if(I){var R;(R=E).push.apply(R,Jt(Jt(I).map(function(D){return D.entity})))}})):E=g,x(E)},this.resetFields=function(h){l.warningUnhooked();var f=l.store;if(!h){l.updateStore(vh(l.initialValues)),l.resetWithFieldInitialValue(),l.notifyObservers(f,null,{type:"reset"}),l.notifyWatch();return}var g=h.map(Yn);g.forEach(function(x){var E=l.getInitialValue(x);l.updateStore(ua(l.store,x,E))}),l.resetWithFieldInitialValue({namePathList:g}),l.notifyObservers(f,g,{type:"reset"}),l.notifyWatch(g)},this.setFields=function(h){l.warningUnhooked();var f=l.store,g=[];h.forEach(function(x){var E=x.name,w=xa(x,vY),I=Yn(E);g.push(I),"value"in w&&l.updateStore(ua(l.store,I,w.value)),l.notifyObservers(f,[I],{type:"setField",data:x})}),l.notifyWatch(g)},this.getFields=function(){var h=l.getFieldEntities(!0),f=h.map(function(g){var x=g.getNamePath(),E=g.getMeta(),w=ft(ft({},E),{},{name:x,value:l.getFieldValue(x)});return Object.defineProperty(w,"originRCField",{value:!0}),w});return f},this.initEntityValue=function(h){var f=h.props.initialValue;if(f!==void 0){var g=h.getNamePath(),x=pa(l.store,g);x===void 0&&l.updateStore(ua(l.store,g,f))}},this.isMergedPreserve=function(h){var f=h!==void 0?h:l.preserve;return f??!0},this.registerField=function(h){l.fieldEntities.push(h);var f=h.getNamePath();if(l.notifyWatch([f]),h.props.initialValue!==void 0){var g=l.store;l.resetWithFieldInitialValue({entities:[h],skipExist:!0}),l.notifyObservers(g,[h.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(x,E){var w=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];if(l.fieldEntities=l.fieldEntities.filter(function(D){return D!==h}),!l.isMergedPreserve(E)&&(!x||w.length>1)){var I=x?void 0:l.getInitialValue(f);if(f.length&&l.getFieldValue(f)!==I&&l.fieldEntities.every(function(D){return!tD(D.getNamePath(),f)})){var R=l.store;l.updateStore(ua(R,f,I,!0)),l.notifyObservers(R,[f],{type:"remove"}),l.triggerDependenciesUpdate(R,f)}}l.notifyWatch([f])}},this.dispatch=function(h){switch(h.type){case"updateValue":{var f=h.namePath,g=h.value;l.updateValue(f,g);break}case"validateField":{var x=h.namePath,E=h.triggerName;l.validateFields([x],{triggerName:E});break}}},this.notifyObservers=function(h,f,g){if(l.subscribable){var x=ft(ft({},g),{},{store:l.getFieldsValue(!0)});l.getFieldEntities().forEach(function(E){var w=E.onStoreChange;w(h,f,x)})}else l.forceRootUpdate()},this.triggerDependenciesUpdate=function(h,f){var g=l.getDependencyChildrenFields(f);return g.length&&l.validateFields(g),l.notifyObservers(h,g,{type:"dependenciesUpdate",relatedFields:[f].concat(Jt(g))}),g},this.updateValue=function(h,f){var g=Yn(h),x=l.store;l.updateStore(ua(l.store,g,f)),l.notifyObservers(x,[g],{type:"valueUpdate",source:"internal"}),l.notifyWatch([g]);var E=l.triggerDependenciesUpdate(x,g),w=l.callbacks.onValuesChange;if(w){var I=aP(l.store,[g]);w(I,l.getFieldsValue())}l.triggerOnFieldsChange([g].concat(Jt(E)))},this.setFieldsValue=function(h){l.warningUnhooked();var f=l.store;if(h){var g=vh(l.store,h);l.updateStore(g)}l.notifyObservers(f,null,{type:"valueUpdate",source:"external"}),l.notifyWatch()},this.setFieldValue=function(h,f){l.setFields([{name:h,value:f}])},this.getDependencyChildrenFields=function(h){var f=new Set,g=[],x=new Ku;l.getFieldEntities().forEach(function(w){var I=w.props.dependencies;(I||[]).forEach(function(R){var D=Yn(R);x.update(D,function(){var F=arguments.length>0&&arguments[0]!==void 0?arguments[0]:new Set;return F.add(w),F})})});var E=function w(I){var R=x.get(I)||new Set;R.forEach(function(D){if(!f.has(D)){f.add(D);var F=D.getNamePath();D.isFieldDirty()&&F.length&&(g.push(F),w(F))}})};return E(h),g},this.triggerOnFieldsChange=function(h,f){var g=l.callbacks.onFieldsChange;if(g){var x=l.getFields();if(f){var E=new Ku;f.forEach(function(I){var R=I.name,D=I.errors;E.set(R,D)}),x.forEach(function(I){I.errors=E.get(I.name)||I.errors})}var w=x.filter(function(I){var R=I.name;return Vf(h,R)});w.length&&g(w,x)}},this.validateFields=function(h,f){l.warningUnhooked();var g,x;Array.isArray(h)||typeof h=="string"||typeof f=="string"?(g=h,x=f):x=h;var E=!!g,w=E?g.map(Yn):[],I=[],R=String(Date.now()),D=new Set;l.getFieldEntities(!0).forEach(function(j){var te;if(E||w.push(j.getNamePath()),!((te=x)===null||te===void 0)&&te.recursive&&E){var N=j.getNamePath();N.every(function(U,ae){return g[ae]===U||g[ae]===void 0})&&w.push(N)}if(!(!j.props.rules||!j.props.rules.length)){var O=j.getNamePath();if(D.add(O.join(R)),!E||Vf(w,O)){var V=j.validateRules(ft({validateMessages:ft(ft({},eD),l.validateMessages)},x));I.push(V.then(function(){return{name:O,errors:[],warnings:[]}}).catch(function(U){var ae,le=[],ne=[];return(ae=U.forEach)===null||ae===void 0||ae.call(U,function(de){var $=de.rule.warningOnly,ue=de.errors;$?ne.push.apply(ne,Jt(ue)):le.push.apply(le,Jt(ue))}),le.length?Promise.reject({name:O,errors:le,warnings:ne}):{name:O,errors:le,warnings:ne}}))}}});var F=yY(I);l.lastValidatePromise=F,F.catch(function(j){return j}).then(function(j){var te=j.map(function(N){var O=N.name;return O});l.notifyObservers(l.store,te,{type:"validateFinish"}),l.triggerOnFieldsChange(te,j)});var q=F.then(function(){return l.lastValidatePromise===F?Promise.resolve(l.getFieldsValue(w)):Promise.reject([])}).catch(function(j){var te=j.filter(function(N){return N&&N.errors.length});return Promise.reject({values:l.getFieldsValue(w),errorFields:te,outOfDate:l.lastValidatePromise!==F})});q.catch(function(j){return j});var G=w.filter(function(j){return D.has(j.join(R))});return l.triggerOnFieldsChange(G),q},this.submit=function(){l.warningUnhooked(),l.validateFields().then(function(h){var f=l.callbacks.onFinish;if(f)try{f(h)}catch(g){console.error(g)}}).catch(function(h){var f=l.callbacks.onFinishFailed;f&&f(h)})},this.forceRootUpdate=o});function oE(n){var o=A.useRef(),l=A.useState({}),h=Ht(l,2),f=h[1];if(!o.current)if(n)o.current=n;else{var g=function(){f({})},x=new xY(g);o.current=x.getForm()}return[o.current]}var Sw=A.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),iD=function(o){var l=o.validateMessages,h=o.onFormChange,f=o.onFormFinish,g=o.children,x=A.useContext(Sw),E=A.useRef({});return A.createElement(Sw.Provider,{value:ft(ft({},x),{},{validateMessages:ft(ft({},x.validateMessages),l),triggerFormChange:function(I,R){h&&h(I,{changedFields:R,forms:E.current}),x.triggerFormChange(I,R)},triggerFormFinish:function(I,R){f&&f(I,{values:R,forms:E.current}),x.triggerFormFinish(I,R)},registerForm:function(I,R){I&&(E.current=ft(ft({},E.current),{},$r({},I,R))),x.registerForm(I,R)},unregisterForm:function(I){var R=ft({},E.current);delete R[I],E.current=R,x.unregisterForm(I)}})},g)},bY=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed"],wY=function(o,l){var h=o.name,f=o.initialValues,g=o.fields,x=o.form,E=o.preserve,w=o.children,I=o.component,R=I===void 0?"form":I,D=o.validateMessages,F=o.validateTrigger,q=F===void 0?"onChange":F,G=o.onValuesChange,j=o.onFieldsChange,te=o.onFinish,N=o.onFinishFailed,O=xa(o,bY),V=A.useContext(Sw),U=oE(x),ae=Ht(U,1),le=ae[0],ne=le.getInternalHooks(vc),de=ne.useSubscribe,$=ne.setInitialValues,ue=ne.setCallbacks,xe=ne.setValidateMessages,ce=ne.setPreserve,se=ne.destroyForm;A.useImperativeHandle(l,function(){return le}),A.useEffect(function(){return V.registerForm(h,le),function(){V.unregisterForm(h)}},[V,le,h]),xe(ft(ft({},V.validateMessages),D)),ue({onValuesChange:G,onFieldsChange:function(at){if(V.triggerFormChange(h,at),j){for(var Pt=arguments.length,mt=new Array(Pt>1?Pt-1:0),kt=1;kt<Pt;kt++)mt[kt-1]=arguments[kt];j.apply(void 0,[at].concat(mt))}},onFinish:function(at){V.triggerFormFinish(h,at),te&&te(at)},onFinishFailed:N}),ce(E);var ke=A.useRef(null);$(f,!ke.current),ke.current||(ke.current=!0),A.useEffect(function(){return se},[]);var $e,Ne=typeof w=="function";if(Ne){var it=le.getFieldsValue(!0);$e=w(it,le)}else $e=w;de(!Ne);var Re=A.useRef();A.useEffect(function(){mY(Re.current||[],g||[])||le.setFields(g||[]),Re.current=g},[g,le]);var He=A.useMemo(function(){return ft(ft({},le),{},{validateTrigger:q})},[le,q]),Xe=A.createElement(fp.Provider,{value:null},A.createElement(Lc.Provider,{value:He},$e));return R===!1?Xe:A.createElement(R,ui({},O,{onSubmit:function(at){at.preventDefault(),at.stopPropagation(),le.submit()},onReset:function(at){var Pt;at.preventDefault(),le.resetFields(),(Pt=O.onReset)===null||Pt===void 0||Pt.call(O,at)}}),Xe)};function cP(n){try{return JSON.stringify(n)}catch{return Math.random()}}function oD(){for(var n=arguments.length,o=new Array(n),l=0;l<n;l++)o[l]=arguments[l];var h=o[0],f=h===void 0?[]:h,g=o[1],x=g===void 0?{}:g,E=RX(x)?{form:x}:x,w=E.form,I=A.useState(),R=Ht(I,2),D=R[0],F=R[1],q=A.useMemo(function(){return cP(D)},[D]),G=A.useRef(q);G.current=q;var j=A.useContext(Lc),te=w||j,N=te&&te._init,O=Yn(f),V=A.useRef(O);return V.current=O,A.useEffect(function(){if(N){var U=te.getFieldsValue,ae=te.getInternalHooks,le=ae(vc),ne=le.registerWatch,de=ne(function(ue,xe){var ce=pa(E.preserve?xe:ue,V.current),se=cP(ce);G.current!==se&&(G.current=se,F(ce))}),$=pa(E.preserve?U(!0):U(),V.current);return F($),de}},[N]),D}var EY=A.forwardRef(wY),Qh=EY;Qh.FormProvider=iD;Qh.Field=iE;Qh.List=rD;Qh.useForm=oE;Qh.useWatch=oD;const Ll=A.createContext({labelAlign:"right",vertical:!1,itemRef:()=>{}}),aD=A.createContext(null),sD=n=>{const o=$c(n,["prefixCls"]);return A.createElement(iD,Object.assign({},o))},aE=A.createContext({prefixCls:""}),oy=A.createContext({}),SY=n=>({animationDuration:n,animationFillMode:"both"}),TY=n=>({animationDuration:n,animationFillMode:"both"}),MY=function(n,o,l,h){const g=(arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1)?"&":"";return{[`
      ${g}${n}-enter,
      ${g}${n}-appear
    `]:Object.assign(Object.assign({},SY(h)),{animationPlayState:"paused"}),[`${g}${n}-leave`]:Object.assign(Object.assign({},TY(h)),{animationPlayState:"paused"}),[`
      ${g}${n}-enter${n}-enter-active,
      ${g}${n}-appear${n}-appear-active
    `]:{animationName:o,animationPlayState:"running"},[`${g}${n}-leave${n}-leave-active`]:{animationName:l,animationPlayState:"running",pointerEvents:"none"}}},sE=new Ni("antZoomIn",{"0%":{transform:"scale(0.2)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),CY=new Ni("antZoomOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.2)",opacity:0}}),uP=new Ni("antZoomBigIn",{"0%":{transform:"scale(0.8)",opacity:0},"100%":{transform:"scale(1)",opacity:1}}),hP=new Ni("antZoomBigOut",{"0%":{transform:"scale(1)"},"100%":{transform:"scale(0.8)",opacity:0}}),AY=new Ni("antZoomUpIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 0%"}}),IY=new Ni("antZoomUpOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 0%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 0%",opacity:0}}),PY=new Ni("antZoomLeftIn",{"0%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"0% 50%"}}),kY=new Ni("antZoomLeftOut",{"0%":{transform:"scale(1)",transformOrigin:"0% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"0% 50%",opacity:0}}),RY=new Ni("antZoomRightIn",{"0%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"100% 50%"}}),zY=new Ni("antZoomRightOut",{"0%":{transform:"scale(1)",transformOrigin:"100% 50%"},"100%":{transform:"scale(0.8)",transformOrigin:"100% 50%",opacity:0}}),DY=new Ni("antZoomDownIn",{"0%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0},"100%":{transform:"scale(1)",transformOrigin:"50% 100%"}}),LY=new Ni("antZoomDownOut",{"0%":{transform:"scale(1)",transformOrigin:"50% 100%"},"100%":{transform:"scale(0.8)",transformOrigin:"50% 100%",opacity:0}}),OY={zoom:{inKeyframes:sE,outKeyframes:CY},"zoom-big":{inKeyframes:uP,outKeyframes:hP},"zoom-big-fast":{inKeyframes:uP,outKeyframes:hP},"zoom-left":{inKeyframes:PY,outKeyframes:kY},"zoom-right":{inKeyframes:RY,outKeyframes:zY},"zoom-up":{inKeyframes:AY,outKeyframes:IY},"zoom-down":{inKeyframes:DY,outKeyframes:LY}},FY=(n,o)=>{const{antCls:l}=n,h=`${l}-${o}`,{inKeyframes:f,outKeyframes:g}=OY[o];return[MY(h,f,g,o==="zoom-big-fast"?n.motionDurationFast:n.motionDurationMid),{[`
        ${h}-enter,
        ${h}-appear
      `]:{transform:"scale(0)",opacity:0,animationTimingFunction:n.motionEaseOutCirc,"&-prepare":{transform:"none"}},[`${h}-leave`]:{animationTimingFunction:n.motionEaseInOutCirc}}]},BY=n=>({[n.componentCls]:{[`${n.antCls}-motion-collapse-legacy`]:{overflow:"hidden","&-active":{transition:`height ${n.motionDurationMid} ${n.motionEaseInOut},
        opacity ${n.motionDurationMid} ${n.motionEaseInOut} !important`}},[`${n.antCls}-motion-collapse`]:{overflow:"hidden",transition:`height ${n.motionDurationMid} ${n.motionEaseInOut},
        opacity ${n.motionDurationMid} ${n.motionEaseInOut} !important`}}}),NY=BY,jY=function(){if(typeof navigator>"u"||typeof window>"u")return!1;var n=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino|android|ipad|playbook|silk/i.test(n)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(n==null?void 0:n.substr(0,4))};var dP=A.createContext(null);function fP(n){return n?Array.isArray(n)?n:[n]:[]}function $Y(n,o,l,h){return A.useMemo(function(){var f=fP(l??o),g=fP(h??o),x=new Set(f),E=new Set(g);return n&&(x.has("hover")&&(x.delete("hover"),x.add("click")),E.has("hover")&&(E.delete("hover"),E.add("click"))),[x,E]},[n,o,l,h])}function VY(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],l=arguments.length>2?arguments[2]:void 0;return l?n[0]===o[0]:n[0]===o[0]&&n[1]===o[1]}function UY(n,o,l,h){for(var f=l.points,g=Object.keys(n),x=0;x<g.length;x+=1){var E,w=g[x];if(VY((E=n[w])===null||E===void 0?void 0:E.points,f,h))return"".concat(o,"-placement-").concat(w)}return""}function pP(n,o,l,h){return o||(l?{motionName:"".concat(n,"-").concat(l)}:h?{motionName:h}:null)}function Pp(n){return n.ownerDocument.defaultView}function Tw(n){for(var o=[],l=n==null?void 0:n.parentElement,h=["hidden","scroll","clip","auto"];l;){var f=Pp(l).getComputedStyle(l),g=f.overflowX,x=f.overflowY,E=f.overflow;[g,x,E].some(function(w){return h.includes(w)})&&o.push(l),l=l.parentElement}return o}function mp(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;return Number.isNaN(n)?o:n}function vf(n){return mp(parseFloat(n),0)}function mP(n,o){var l=ft({},n);return(o||[]).forEach(function(h){if(!(h instanceof HTMLBodyElement)){var f=Pp(h).getComputedStyle(h),g=f.overflow,x=f.overflowClipMargin,E=f.borderTopWidth,w=f.borderBottomWidth,I=f.borderLeftWidth,R=f.borderRightWidth,D=h.getBoundingClientRect(),F=h.offsetHeight,q=h.clientHeight,G=h.offsetWidth,j=h.clientWidth,te=vf(E),N=vf(w),O=vf(I),V=vf(R),U=mp(Math.round(D.width/G*1e3)/1e3),ae=mp(Math.round(D.height/F*1e3)/1e3),le=(G-j-O-V)*U,ne=(F-q-te-N)*ae,de=te*ae,$=N*ae,ue=O*U,xe=V*U,ce=0,se=0;if(g==="clip"){var ke=vf(x);ce=ke*U,se=ke*ae}var $e=D.x+ue-ce,Ne=D.y+de-se,it=$e+D.width+2*ce-ue-xe-le,Re=Ne+D.height+2*se-de-$-ne;l.left=Math.max(l.left,$e),l.top=Math.max(l.top,Ne),l.right=Math.min(l.right,it),l.bottom=Math.min(l.bottom,Re)}}),l}function gP(n){var o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,l="".concat(o),h=l.match(/^(.*)\%$/);return h?n*(parseFloat(h[1])/100):parseFloat(l)}function _P(n,o){var l=o||[],h=Ht(l,2),f=h[0],g=h[1];return[gP(n.width,f),gP(n.height,g)]}function yP(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";return[n[0],n[1]]}function Ju(n,o){var l=o[0],h=o[1],f,g;return l==="t"?g=n.y:l==="b"?g=n.y+n.height:g=n.y+n.height/2,h==="l"?f=n.x:h==="r"?f=n.x+n.width:f=n.x+n.width/2,{x:f,y:g}}function fl(n,o){var l={t:"b",b:"t",l:"r",r:"l"};return n.map(function(h,f){return f===o?l[h]||"c":h}).join("")}function GY(n,o,l,h,f,g,x){var E=A.useState({ready:!1,offsetX:0,offsetY:0,offsetR:0,offsetB:0,arrowX:0,arrowY:0,scaleX:1,scaleY:1,align:f[h]||{}}),w=Ht(E,2),I=w[0],R=w[1],D=A.useRef(0),F=A.useMemo(function(){return o?Tw(o):[]},[o]),q=A.useRef({}),G=function(){q.current={}};n||G();var j=Ba(function(){if(o&&l&&n){let di=function(Hl,oo){var Xo=arguments.length>2&&arguments[2]!==void 0?arguments[2]:xr,Co=ce.x+Hl,Ea=ce.y+oo,Zc=Co+mt,Xc=Ea+Pt,Yc=Math.max(Co,Xo.left),ql=Math.max(Ea,Xo.top),Ee=Math.min(Zc,Xo.right),rt=Math.min(Xc,Xo.bottom);return Math.max(0,(Ee-Yc)*(rt-ql))},zs=function(){xt=ce.y+ct,rr=xt+Pt,yt=ce.x+bt,_r=yt+mt};var Ci=di,qa=zs,O=o,V=O.style.left,U=O.style.top,ae=O.style.right,le=O.style.bottom,ne=O.ownerDocument,de=Pp(O),$=ft(ft({},f[h]),g);O.style.left="0",O.style.top="0",O.style.right="auto",O.style.bottom="auto";var ue;if(Array.isArray(l))ue={x:l[0],y:l[1],width:0,height:0};else{var xe=l.getBoundingClientRect();ue={x:xe.x,y:xe.y,width:xe.width,height:xe.height}}var ce=O.getBoundingClientRect(),se=de.getComputedStyle(O),ke=se.width,$e=se.height,Ne=ne.documentElement,it=Ne.clientWidth,Re=Ne.clientHeight,He=Ne.scrollWidth,Xe=Ne.scrollHeight,ze=Ne.scrollTop,at=Ne.scrollLeft,Pt=ce.height,mt=ce.width,kt=ue.height,Oe=ue.width,qt={left:0,top:0,right:it,bottom:Re},Sr={left:-at,top:-ze,right:He-at,bottom:Xe-ze},Ir=$.htmlRegion,Xr="visible",Ur="visibleFirst";Ir!=="scroll"&&Ir!==Ur&&(Ir=Xr);var pr=Ir===Ur,ar=mP(Sr,F),hr=mP(qt,F),xr=Ir===Xr?hr:ar,Fe=pr?hr:xr;O.style.left="auto",O.style.top="auto",O.style.right="0",O.style.bottom="0";var Y=O.getBoundingClientRect();O.style.left=V,O.style.top=U,O.style.right=ae,O.style.bottom=le;var ee=mp(Math.round(mt/parseFloat(ke)*1e3)/1e3),re=mp(Math.round(Pt/parseFloat($e)*1e3)/1e3);if(ee===0||re===0||o_(l)&&!K3(l))return;var we=$.offset,Ie=$.targetOffset,Qe=_P(ce,we),tt=Ht(Qe,2),Be=tt[0],gt=tt[1],Tt=_P(ue,Ie),At=Ht(Tt,2),mr=At[0],nn=At[1];ue.x-=mr,ue.y-=nn;var Pr=$.points||[],Cr=Ht(Pr,2),Yr=Cr[0],br=Cr[1],Te=yP(br),Pe=yP(Yr),et=Ju(ue,Te),_t=Ju(ce,Pe),Rt=ft({},$),bt=et.x-_t.x+Be,ct=et.y-_t.y+gt,It=di(bt,ct),Mt=di(bt,ct,hr),ye=Ju(ue,["t","l"]),be=Ju(ce,["t","l"]),Me=Ju(ue,["b","r"]),De=Ju(ce,["b","r"]),Le=$.overflow||{},qe=Le.adjustX,Ue=Le.adjustY,Ze=Le.shiftX,ot=Le.shiftY,We=function(oo){return typeof oo=="boolean"?oo:oo>=0},xt,rr,yt,_r;zs();var wr=We(Ue),Bt=Pe[0]===Te[0];if(wr&&Pe[0]==="t"&&(rr>Fe.bottom||q.current.bt)){var yr=ct;Bt?yr-=Pt-kt:yr=ye.y-De.y-gt;var Qr=di(bt,yr),Wn=di(bt,yr,hr);Qr>It||Qr===It&&(!pr||Wn>=Mt)?(q.current.bt=!0,ct=yr,Rt.points=[fl(Pe,0),fl(Te,0)]):q.current.bt=!1}if(wr&&Pe[0]==="b"&&(xt<Fe.top||q.current.tb)){var Er=ct;Bt?Er+=Pt-kt:Er=Me.y-be.y-gt;var on=di(bt,Er),Br=di(bt,Er,hr);on>It||on===It&&(!pr||Br>=Mt)?(q.current.tb=!0,ct=Er,Rt.points=[fl(Pe,0),fl(Te,0)]):q.current.tb=!1}var ro=We(qe),qo=Pe[1]===Te[1];if(ro&&Pe[1]==="l"&&(_r>Fe.right||q.current.rl)){var bi=bt;qo?bi-=mt-Oe:bi=ye.x-De.x-Be;var jl=di(bi,ct),$l=di(bi,ct,hr);jl>It||jl===It&&(!pr||$l>=Mt)?(q.current.rl=!0,bt=bi,Rt.points=[fl(Pe,1),fl(Te,1)]):q.current.rl=!1}if(ro&&Pe[1]==="r"&&(yt<Fe.left||q.current.lr)){var wa=bt;qo?wa+=mt-Oe:wa=Me.x-be.x-Be;var Gc=di(wa,ct),Wc=di(wa,ct,hr);Gc>It||Gc===It&&(!pr||Wc>=Mt)?(q.current.lr=!0,bt=wa,Rt.points=[fl(Pe,1),fl(Te,1)]):q.current.lr=!1}zs();var Wa=Ze===!0?0:Ze;typeof Wa=="number"&&(yt<hr.left&&(bt-=yt-hr.left,ue.x+Oe<hr.left+Wa&&(bt+=ue.x-hr.left+Oe-Wa)),_r>hr.right&&(bt-=_r-hr.right,ue.x>hr.right-Wa&&(bt+=ue.x-hr.right+Wa)));var no=ot===!0?0:ot;typeof no=="number"&&(xt<hr.top&&(ct-=xt-hr.top+gt,ue.y+kt<hr.top+no&&(ct+=ue.y-hr.top+kt-no)),rr>hr.bottom&&(ct-=rr-hr.bottom-gt,ue.y>hr.bottom-no&&(ct+=ue.y-hr.bottom+no)));var Ha=ce.x+bt,io=Ha+mt,As=ce.y+ct,Is=As+Pt,Vl=ue.x,id=Vl+Oe,Ul=ue.y,Hc=Ul+kt,qc=Math.max(Ha,Vl),Gl=Math.min(io,id),Ps=(qc+Gl)/2,ks=Ps-Ha,Wl=Math.max(As,Ul),Rs=Math.min(Is,Hc),Zo=(Wl+Rs)/2,Ot=Zo-As;x==null||x(o,Rt);var Tr=Y.right-ce.x-(bt+ce.width),gi=Y.bottom-ce.y-(ct+ce.height);R({ready:!0,offsetX:bt/ee,offsetY:ct/re,offsetR:Tr/ee,offsetB:gi/re,arrowX:ks/ee,arrowY:Ot/re,scaleX:ee,scaleY:re,align:Rt})}}),te=function(){D.current+=1;var V=D.current;Promise.resolve().then(function(){D.current===V&&j()})},N=function(){R(function(V){return ft(ft({},V),{},{ready:!1})})};return Ti(N,[h]),Ti(function(){n||N()},[n]),[I.ready,I.offsetX,I.offsetY,I.offsetR,I.offsetB,I.arrowX,I.arrowY,I.scaleX,I.scaleY,I.align,te]}function WY(n,o,l,h){Ti(function(){if(n&&o&&l){let D=function(){h()};var R=D,f=o,g=l,x=Tw(f),E=Tw(g),w=Pp(g),I=new Set([w].concat(Jt(x),Jt(E)));return I.forEach(function(F){F.addEventListener("scroll",D,{passive:!0})}),w.addEventListener("resize",D,{passive:!0}),h(),function(){I.forEach(function(F){F.removeEventListener("scroll",D),w.removeEventListener("resize",D)})}}},[n,o,l])}function HY(n,o,l,h,f,g,x,E){var w=A.useRef(n),I=A.useRef(!1);w.current!==n&&(I.current=!0,w.current=n),A.useEffect(function(){var R=va(function(){I.current=!1});return function(){va.cancel(R)}},[n]),A.useEffect(function(){if(o&&h&&(!f||g)){var R=function(){var le=!1,ne=function(ue){var xe=ue.target;le=x(xe)},de=function(ue){var xe=ue.target;!I.current&&w.current&&!le&&!x(xe)&&E(!1)};return[ne,de]},D=R(),F=Ht(D,2),q=F[0],G=F[1],j=R(),te=Ht(j,2),N=te[0],O=te[1],V=Pp(h);V.addEventListener("mousedown",q,!0),V.addEventListener("click",G,!0),V.addEventListener("contextmenu",G,!0);var U=f_(l);return U&&(U.addEventListener("mousedown",N,!0),U.addEventListener("click",O,!0),U.addEventListener("contextmenu",O,!0)),function(){V.removeEventListener("mousedown",q,!0),V.removeEventListener("click",G,!0),V.removeEventListener("contextmenu",G,!0),U&&(U.removeEventListener("mousedown",N,!0),U.removeEventListener("click",O,!0),U.removeEventListener("contextmenu",O,!0))}}},[o,l,h,f,g])}function qY(n){var o=n.prefixCls,l=n.align,h=n.arrow,f=n.arrowPos,g=h||{},x=g.className,E=g.content,w=f.x,I=w===void 0?0:w,R=f.y,D=R===void 0?0:R,F=A.useRef();if(!l||!l.points)return null;var q={position:"absolute"};if(l.autoArrow!==!1){var G=l.points[0],j=l.points[1],te=G[0],N=G[1],O=j[0],V=j[1];te===O||!["t","b"].includes(te)?q.top=D:te==="t"?q.top=0:q.bottom=0,N===V||!["l","r"].includes(N)?q.left=I:N==="l"?q.left=0:q.right=0}return A.createElement("div",{ref:F,className:$t("".concat(o,"-arrow"),x),style:q},E)}function ZY(n){var o=n.prefixCls,l=n.open,h=n.zIndex,f=n.mask,g=n.motion;return f?A.createElement(Yh,ui({},g,{motionAppear:!0,visible:l,removeOnLeave:!0}),function(x){var E=x.className;return A.createElement("div",{style:{zIndex:h},className:$t("".concat(o,"-mask"),E)})}):null}var XY=A.memo(function(n){var o=n.children;return o},function(n,o){return o.cache}),YY=A.forwardRef(function(n,o){var l=n.popup,h=n.className,f=n.prefixCls,g=n.style,x=n.target,E=n.onVisibleChanged,w=n.open,I=n.keepDom,R=n.onClick,D=n.mask,F=n.arrow,q=n.arrowPos,G=n.align,j=n.motion,te=n.maskMotion,N=n.forceRender,O=n.getPopupContainer,V=n.autoDestroy,U=n.portal,ae=n.zIndex,le=n.onMouseEnter,ne=n.onMouseLeave,de=n.onPointerEnter,$=n.ready,ue=n.offsetX,xe=n.offsetY,ce=n.offsetR,se=n.offsetB,ke=n.onAlign,$e=n.onPrepare,Ne=n.stretch,it=n.targetWidth,Re=n.targetHeight,He=typeof l=="function"?l():l,Xe=w||I,ze=(O==null?void 0:O.length)>0,at=A.useState(!O||!ze),Pt=Ht(at,2),mt=Pt[0],kt=Pt[1];if(Ti(function(){!mt&&ze&&x&&kt(!0)},[mt,ze,x]),!mt)return null;var Oe="auto",qt={left:"-1000vw",top:"-1000vh",right:Oe,bottom:Oe};if($||!w){var Sr=G.points,Ir=G._experimental,Xr=Ir==null?void 0:Ir.dynamicInset,Ur=Xr&&Sr[0][1]==="r",pr=Xr&&Sr[0][0]==="b";Ur?(qt.right=ce,qt.left=Oe):(qt.left=ue,qt.right=Oe),pr?(qt.bottom=se,qt.top=Oe):(qt.top=xe,qt.bottom=Oe)}var ar={};return Ne&&(Ne.includes("height")&&Re?ar.height=Re:Ne.includes("minHeight")&&Re&&(ar.minHeight=Re),Ne.includes("width")&&it?ar.width=it:Ne.includes("minWidth")&&it&&(ar.minWidth=it)),w||(ar.pointerEvents="none"),A.createElement(U,{open:N||Xe,getContainer:O&&function(){return O(x)},autoDestroy:V},A.createElement(ZY,{prefixCls:f,open:w,zIndex:ae,mask:D,motion:te}),A.createElement(R3,{onResize:ke,disabled:!w},function(hr){return A.createElement(Yh,ui({motionAppear:!0,motionEnter:!0,motionLeave:!0,removeOnLeave:!1,forceRender:N,leavedClassName:"".concat(f,"-hidden")},j,{onAppearPrepare:$e,onEnterPrepare:$e,visible:w,onVisibleChanged:function(Fe){var Y;j==null||(Y=j.onVisibleChanged)===null||Y===void 0||Y.call(j,Fe),E(Fe)}}),function(xr,Fe){var Y=xr.className,ee=xr.style,re=$t(f,Y,h);return A.createElement("div",{ref:Bc(hr,o,Fe),className:re,style:ft(ft(ft(ft({"--arrow-x":"".concat(q.x||0,"px"),"--arrow-y":"".concat(q.y||0,"px")},qt),ar),ee),{},{boxSizing:"border-box",zIndex:ae},g),onMouseEnter:le,onMouseLeave:ne,onPointerEnter:de,onClick:R},F&&A.createElement(qY,{prefixCls:f,arrow:F,arrowPos:q,align:G}),A.createElement(XY,{cache:!w},He))})}))}),KY=A.forwardRef(function(n,o){var l=n.children,h=n.getTriggerDOMNode,f=Hh(l),g=A.useCallback(function(E){$w(o,h?h(E):E)},[h]),x=dk(g,l.ref);return f?A.cloneElement(l,{ref:x}):l}),JY=["prefixCls","children","action","showAction","hideAction","popupVisible","defaultPopupVisible","onPopupVisibleChange","afterPopupVisibleChange","mouseEnterDelay","mouseLeaveDelay","focusDelay","blurDelay","mask","maskClosable","getPopupContainer","forceRender","autoDestroy","destroyPopupOnHide","popup","popupClassName","popupStyle","popupPlacement","builtinPlacements","popupAlign","zIndex","stretch","getPopupClassNameFromAlign","alignPoint","onPopupClick","onPopupAlign","arrow","popupMotion","maskMotion","popupTransitionName","popupAnimation","maskTransitionName","maskAnimation","className","getTriggerDOMNode"];function QY(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:J8,o=A.forwardRef(function(l,h){var f=l.prefixCls,g=f===void 0?"rc-trigger-popup":f,x=l.children,E=l.action,w=E===void 0?"hover":E,I=l.showAction,R=l.hideAction,D=l.popupVisible,F=l.defaultPopupVisible,q=l.onPopupVisibleChange,G=l.afterPopupVisibleChange,j=l.mouseEnterDelay,te=l.mouseLeaveDelay,N=te===void 0?.1:te,O=l.focusDelay,V=l.blurDelay,U=l.mask,ae=l.maskClosable,le=ae===void 0?!0:ae,ne=l.getPopupContainer,de=l.forceRender,$=l.autoDestroy,ue=l.destroyPopupOnHide,xe=l.popup,ce=l.popupClassName,se=l.popupStyle,ke=l.popupPlacement,$e=l.builtinPlacements,Ne=$e===void 0?{}:$e,it=l.popupAlign,Re=l.zIndex,He=l.stretch,Xe=l.getPopupClassNameFromAlign,ze=l.alignPoint,at=l.onPopupClick,Pt=l.onPopupAlign,mt=l.arrow,kt=l.popupMotion,Oe=l.maskMotion,qt=l.popupTransitionName,Sr=l.popupAnimation,Ir=l.maskTransitionName,Xr=l.maskAnimation,Ur=l.className,pr=l.getTriggerDOMNode,ar=xa(l,JY),hr=$||ue||!1,xr=A.useState(!1),Fe=Ht(xr,2),Y=Fe[0],ee=Fe[1];Ti(function(){ee(jY())},[]);var re=A.useRef({}),we=A.useContext(dP),Ie=A.useMemo(function(){return{registerSubPopup:function(rt,dr){re.current[rt]=dr,we==null||we.registerSubPopup(rt,dr)}}},[we]),Qe=IX(),tt=A.useState(null),Be=Ht(tt,2),gt=Be[0],Tt=Be[1],At=Ba(function(Ee){o_(Ee)&&gt!==Ee&&Tt(Ee),we==null||we.registerSubPopup(Qe,Ee)}),mr=A.useState(null),nn=Ht(mr,2),Pr=nn[0],Cr=nn[1],Yr=Ba(function(Ee){o_(Ee)&&Pr!==Ee&&Cr(Ee)}),br=A.Children.only(x),Te=(br==null?void 0:br.props)||{},Pe={},et=Ba(function(Ee){var rt,dr,pe=Pr;return(pe==null?void 0:pe.contains(Ee))||((rt=f_(pe))===null||rt===void 0?void 0:rt.host)===Ee||Ee===pe||(gt==null?void 0:gt.contains(Ee))||((dr=f_(gt))===null||dr===void 0?void 0:dr.host)===Ee||Ee===gt||Object.values(re.current).some(function(en){return(en==null?void 0:en.contains(Ee))||Ee===en})}),_t=pP(g,kt,Sr,qt),Rt=pP(g,Oe,Xr,Ir),bt=A.useState(F||!1),ct=Ht(bt,2),It=ct[0],Mt=ct[1],ye=D??It,be=Ba(function(Ee){D===void 0&&Mt(Ee)});Ti(function(){Mt(D||!1)},[D]);var Me=A.useRef(ye);Me.current=ye;var De=Ba(function(Ee){Tp.flushSync(function(){ye!==Ee&&(be(Ee),q==null||q(Ee))})}),Le=A.useRef(),qe=function(){clearTimeout(Le.current)},Ue=function(rt){var dr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;qe(),dr===0?De(rt):Le.current=setTimeout(function(){De(rt)},dr*1e3)};A.useEffect(function(){return qe},[]);var Ze=A.useState(!1),ot=Ht(Ze,2),We=ot[0],xt=ot[1];Ti(function(Ee){(!Ee||ye)&&xt(!0)},[ye]);var rr=A.useState(null),yt=Ht(rr,2),_r=yt[0],wr=yt[1],Bt=A.useState([0,0]),yr=Ht(Bt,2),Qr=yr[0],Wn=yr[1],Er=function(rt){Wn([rt.clientX,rt.clientY])},on=GY(ye,gt,ze?Qr:Pr,ke,Ne,it,Pt),Br=Ht(on,11),ro=Br[0],qo=Br[1],bi=Br[2],jl=Br[3],$l=Br[4],wa=Br[5],Gc=Br[6],Wc=Br[7],Wa=Br[8],no=Br[9],Ha=Br[10],io=Ba(function(){We||Ha()});WY(ye,Pr,gt,io),Ti(function(){io()},[Qr,ke]),Ti(function(){ye&&!(Ne!=null&&Ne[ke])&&io()},[JSON.stringify(it)]);var As=A.useMemo(function(){var Ee=UY(Ne,g,no,ze);return $t(Ee,Xe==null?void 0:Xe(no))},[no,Xe,Ne,g,ze]);A.useImperativeHandle(h,function(){return{forceAlign:io}});var Is=function(rt){xt(!1),Ha(),G==null||G(rt)},Vl=function(){return new Promise(function(rt){wr(function(){return rt})})};Ti(function(){_r&&(Ha(),_r(),wr(null))},[_r]);var id=A.useState(0),Ul=Ht(id,2),Hc=Ul[0],qc=Ul[1],Gl=A.useState(0),Ps=Ht(Gl,2),ks=Ps[0],Wl=Ps[1],Rs=function(rt,dr){if(io(),He){var pe=dr.getBoundingClientRect();qc(pe.width),Wl(pe.height)}},Zo=$Y(Y,w,I,R),Ot=Ht(Zo,2),Tr=Ot[0],gi=Ot[1];function Ci(Ee,rt,dr,pe){Pe[Ee]=function(en){var st;pe==null||pe(en),Ue(rt,dr);for(var kn=arguments.length,Ao=new Array(kn>1?kn-1:0),Kc=1;Kc<kn;Kc++)Ao[Kc-1]=arguments[Kc];(st=Te[Ee])===null||st===void 0||st.call.apply(st,[Te,en].concat(Ao))}}var qa=Tr.has("click"),di=gi.has("click")||gi.has("contextMenu");(qa||di)&&(Pe.onClick=function(Ee){var rt;Me.current&&di?Ue(!1):!Me.current&&qa&&(Er(Ee),Ue(!0));for(var dr=arguments.length,pe=new Array(dr>1?dr-1:0),en=1;en<dr;en++)pe[en-1]=arguments[en];(rt=Te.onClick)===null||rt===void 0||rt.call.apply(rt,[Te,Ee].concat(pe))}),HY(ye,di,Pr,gt,U,le,et,Ue);var zs=Tr.has("hover"),Hl=gi.has("hover"),oo,Xo;zs&&(Ci("onMouseEnter",!0,j,function(Ee){Er(Ee)}),Ci("onPointerEnter",!0,j,function(Ee){Er(Ee)}),oo=function(){(ye||We)&&Ue(!0,j)},ze&&(Pe.onMouseMove=function(Ee){var rt;(rt=Te.onMouseMove)===null||rt===void 0||rt.call(Te,Ee)})),Hl&&(Ci("onMouseLeave",!1,N),Ci("onPointerLeave",!1,N),Xo=function(){Ue(!1,N)}),Tr.has("focus")&&Ci("onFocus",!0,O),gi.has("focus")&&Ci("onBlur",!1,V),Tr.has("contextMenu")&&(Pe.onContextMenu=function(Ee){var rt;Me.current&&gi.has("contextMenu")?Ue(!1):(Er(Ee),Ue(!0)),Ee.preventDefault();for(var dr=arguments.length,pe=new Array(dr>1?dr-1:0),en=1;en<dr;en++)pe[en-1]=arguments[en];(rt=Te.onContextMenu)===null||rt===void 0||rt.call.apply(rt,[Te,Ee].concat(pe))}),Ur&&(Pe.className=$t(Te.className,Ur));var Co=ft(ft({},Te),Pe),Ea={},Zc=["onContextMenu","onClick","onMouseDown","onTouchStart","onMouseEnter","onMouseLeave","onFocus","onBlur"];Zc.forEach(function(Ee){ar[Ee]&&(Ea[Ee]=function(){for(var rt,dr=arguments.length,pe=new Array(dr),en=0;en<dr;en++)pe[en]=arguments[en];(rt=Co[Ee])===null||rt===void 0||rt.call.apply(rt,[Co].concat(pe)),ar[Ee].apply(ar,pe)})});var Xc=A.cloneElement(br,ft(ft({},Co),Ea)),Yc={x:wa,y:Gc},ql=mt?ft({},mt!==!0?mt:{}):null;return A.createElement(A.Fragment,null,A.createElement(R3,{disabled:!ye,ref:Yr,onResize:Rs},A.createElement(KY,{getTriggerDOMNode:pr},Xc)),A.createElement(dP.Provider,{value:Ie},A.createElement(YY,{portal:n,ref:At,prefixCls:g,popup:xe,className:$t(ce,As),style:se,target:Pr,onMouseEnter:oo,onMouseLeave:Xo,onPointerEnter:oo,zIndex:Re,open:ye,keepDom:We,onClick:at,mask:U,motion:_t,maskMotion:Rt,onVisibleChanged:Is,onPrepare:Vl,forceRender:de,autoDestroy:hr,getPopupContainer:ne,align:no,arrow:ql,arrowPos:Yc,ready:ro,offsetX:qo,offsetY:bi,offsetR:jl,offsetB:$l,onAlign:io,stretch:He,targetWidth:Hc/Wc,targetHeight:ks/Wa})))});return o}const eK=QY(J8),gp=["xxl","xl","lg","md","sm","xs"],tK=n=>({xs:`(max-width: ${n.screenXSMax}px)`,sm:`(min-width: ${n.screenSM}px)`,md:`(min-width: ${n.screenMD}px)`,lg:`(min-width: ${n.screenLG}px)`,xl:`(min-width: ${n.screenXL}px)`,xxl:`(min-width: ${n.screenXXL}px)`}),rK=n=>{const o=n,l=[].concat(gp).reverse();return l.forEach((h,f)=>{const g=h.toUpperCase(),x=`screen${g}Min`,E=`screen${g}`;if(!(o[x]<=o[E]))throw new Error(`${x}<=${E} fails : !(${o[x]}<=${o[E]})`);if(f<l.length-1){const w=`screen${g}Max`;if(!(o[E]<=o[w]))throw new Error(`${E}<=${w} fails : !(${o[E]}<=${o[w]})`);const R=`screen${l[f+1].toUpperCase()}Min`;if(!(o[w]<=o[R]))throw new Error(`${w}<=${R} fails : !(${o[w]}<=${o[R]})`)}}),n};function nK(){const[,n]=Vc(),o=tK(rK(n));return xn.useMemo(()=>{const l=new Map;let h=-1,f={};return{matchHandlers:{},dispatch(g){return f=g,l.forEach(x=>x(f)),l.size>=1},subscribe(g){return l.size||this.register(),h+=1,l.set(h,g),g(f),h},unsubscribe(g){l.delete(g),l.size||this.unregister()},unregister(){Object.keys(o).forEach(g=>{const x=o[g],E=this.matchHandlers[x];E==null||E.mql.removeListener(E==null?void 0:E.listener)}),l.clear()},register(){Object.keys(o).forEach(g=>{const x=o[g],E=I=>{let{matches:R}=I;this.dispatch(Object.assign(Object.assign({},f),{[g]:R}))},w=window.matchMedia(x);w.addListener(E),this.matchHandlers[x]={mql:w,listener:E},E(w)})},responsiveMap:o}},[n])}var Qu={shiftX:64,adjustY:1},eh={adjustX:1,shiftY:!0},Bo=[0,0],iK={left:{points:["cr","cl"],overflow:eh,offset:[-4,0],targetOffset:Bo},right:{points:["cl","cr"],overflow:eh,offset:[4,0],targetOffset:Bo},top:{points:["bc","tc"],overflow:Qu,offset:[0,-4],targetOffset:Bo},bottom:{points:["tc","bc"],overflow:Qu,offset:[0,4],targetOffset:Bo},topLeft:{points:["bl","tl"],overflow:Qu,offset:[0,-4],targetOffset:Bo},leftTop:{points:["tr","tl"],overflow:eh,offset:[-4,0],targetOffset:Bo},topRight:{points:["br","tr"],overflow:Qu,offset:[0,-4],targetOffset:Bo},rightTop:{points:["tl","tr"],overflow:eh,offset:[4,0],targetOffset:Bo},bottomRight:{points:["tr","br"],overflow:Qu,offset:[0,4],targetOffset:Bo},rightBottom:{points:["bl","br"],overflow:eh,offset:[4,0],targetOffset:Bo},bottomLeft:{points:["tl","bl"],overflow:Qu,offset:[0,4],targetOffset:Bo},leftBottom:{points:["br","bl"],overflow:eh,offset:[-4,0],targetOffset:Bo}};function lD(n){var o=n.children,l=n.prefixCls,h=n.id,f=n.overlayInnerStyle,g=n.className,x=n.style;return A.createElement("div",{className:$t("".concat(l,"-content"),g),style:x},A.createElement("div",{className:"".concat(l,"-inner"),id:h,role:"tooltip",style:f},typeof o=="function"?o():o))}var oK=["overlayClassName","trigger","mouseEnterDelay","mouseLeaveDelay","overlayStyle","prefixCls","children","onVisibleChange","afterVisibleChange","transitionName","animation","motion","placement","align","destroyTooltipOnHide","defaultVisible","getTooltipContainer","overlayInnerStyle","arrowContent","overlay","id","showArrow"],aK=function(o,l){var h=o.overlayClassName,f=o.trigger,g=f===void 0?["hover"]:f,x=o.mouseEnterDelay,E=x===void 0?0:x,w=o.mouseLeaveDelay,I=w===void 0?.1:w,R=o.overlayStyle,D=o.prefixCls,F=D===void 0?"rc-tooltip":D,q=o.children,G=o.onVisibleChange,j=o.afterVisibleChange,te=o.transitionName,N=o.animation,O=o.motion,V=o.placement,U=V===void 0?"right":V,ae=o.align,le=ae===void 0?{}:ae,ne=o.destroyTooltipOnHide,de=ne===void 0?!1:ne,$=o.defaultVisible,ue=o.getTooltipContainer,xe=o.overlayInnerStyle;o.arrowContent;var ce=o.overlay,se=o.id,ke=o.showArrow,$e=ke===void 0?!0:ke,Ne=xa(o,oK),it=A.useRef(null);A.useImperativeHandle(l,function(){return it.current});var Re=ft({},Ne);"visible"in o&&(Re.popupVisible=o.visible);var He=function(){return A.createElement(lD,{key:"content",prefixCls:F,id:se,overlayInnerStyle:xe},ce)};return A.createElement(eK,ui({popupClassName:h,prefixCls:F,popup:He,action:g,builtinPlacements:iK,popupPlacement:U,ref:it,popupAlign:le,getPopupContainer:ue,onPopupVisibleChange:G,afterPopupVisibleChange:j,popupTransitionName:te,popupAnimation:N,popupMotion:O,defaultPopupVisible:$,autoDestroy:de,mouseLeaveDelay:I,popupStyle:R,mouseEnterDelay:E,arrow:$e},Re),q)};const sK=A.forwardRef(aK),cD=8;function uD(n){const o=cD,{contentRadius:l,limitVerticalRadius:h}=n,f=l>12?l+2:12;return{dropdownArrowOffset:f,dropdownArrowOffsetVertical:h?o:f}}function d0(n,o){return n?o:{}}function lK(n,o){const{componentCls:l,sizePopupArrow:h,borderRadiusXS:f,borderRadiusOuter:g,boxShadowPopoverArrow:x}=n,{colorBg:E,contentRadius:w=n.borderRadiusLG,limitVerticalRadius:I,arrowDistance:R=0,arrowPlacement:D={left:!0,right:!0,top:!0,bottom:!0}}=o,{dropdownArrowOffsetVertical:F,dropdownArrowOffset:q}=uD({contentRadius:w,limitVerticalRadius:I});return{[l]:Object.assign(Object.assign(Object.assign(Object.assign({[`${l}-arrow`]:[Object.assign(Object.assign({position:"absolute",zIndex:1,display:"block"},JW(h,f,g,E,x)),{"&:before":{background:E}})]},d0(!!D.top,{[[`&-placement-top ${l}-arrow`,`&-placement-topLeft ${l}-arrow`,`&-placement-topRight ${l}-arrow`].join(",")]:{bottom:R,transform:"translateY(100%) rotate(180deg)"},[`&-placement-top ${l}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(100%) rotate(180deg)"},[`&-placement-topLeft ${l}-arrow`]:{left:{_skip_check_:!0,value:q}},[`&-placement-topRight ${l}-arrow`]:{right:{_skip_check_:!0,value:q}}})),d0(!!D.bottom,{[[`&-placement-bottom ${l}-arrow`,`&-placement-bottomLeft ${l}-arrow`,`&-placement-bottomRight ${l}-arrow`].join(",")]:{top:R,transform:"translateY(-100%)"},[`&-placement-bottom ${l}-arrow`]:{left:{_skip_check_:!0,value:"50%"},transform:"translateX(-50%) translateY(-100%)"},[`&-placement-bottomLeft ${l}-arrow`]:{left:{_skip_check_:!0,value:q}},[`&-placement-bottomRight ${l}-arrow`]:{right:{_skip_check_:!0,value:q}}})),d0(!!D.left,{[[`&-placement-left ${l}-arrow`,`&-placement-leftTop ${l}-arrow`,`&-placement-leftBottom ${l}-arrow`].join(",")]:{right:{_skip_check_:!0,value:R},transform:"translateX(100%) rotate(90deg)"},[`&-placement-left ${l}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(100%) rotate(90deg)"},[`&-placement-leftTop ${l}-arrow`]:{top:F},[`&-placement-leftBottom ${l}-arrow`]:{bottom:F}})),d0(!!D.right,{[[`&-placement-right ${l}-arrow`,`&-placement-rightTop ${l}-arrow`,`&-placement-rightBottom ${l}-arrow`].join(",")]:{left:{_skip_check_:!0,value:R},transform:"translateX(-100%) rotate(-90deg)"},[`&-placement-right ${l}-arrow`]:{top:{_skip_check_:!0,value:"50%"},transform:"translateY(-50%) translateX(-100%) rotate(-90deg)"},[`&-placement-rightTop ${l}-arrow`]:{top:F},[`&-placement-rightBottom ${l}-arrow`]:{bottom:F}}))}}function cK(n,o,l,h){if(h===!1)return{adjustX:!1,adjustY:!1};const f=h&&typeof h=="object"?h:{},g={};switch(n){case"top":case"bottom":g.shiftX=o.dropdownArrowOffset*2+l;break;case"left":case"right":g.shiftY=o.dropdownArrowOffsetVertical*2+l;break}const x=Object.assign(Object.assign({},g),f);return x.shiftX||(x.adjustX=!0),x.shiftY||(x.adjustY=!0),x}const vP={left:{points:["cr","cl"]},right:{points:["cl","cr"]},top:{points:["bc","tc"]},bottom:{points:["tc","bc"]},topLeft:{points:["bl","tl"]},leftTop:{points:["tr","tl"]},topRight:{points:["br","tr"]},rightTop:{points:["tl","tr"]},bottomRight:{points:["tr","br"]},rightBottom:{points:["bl","br"]},bottomLeft:{points:["tl","bl"]},leftBottom:{points:["br","bl"]}},uK={topLeft:{points:["bl","tc"]},leftTop:{points:["tr","cl"]},topRight:{points:["br","tc"]},rightTop:{points:["tl","cr"]},bottomRight:{points:["tr","bc"]},rightBottom:{points:["bl","cr"]},bottomLeft:{points:["tl","bc"]},leftBottom:{points:["br","cl"]}},hK=new Set(["topLeft","topRight","bottomLeft","bottomRight","leftTop","leftBottom","rightTop","rightBottom"]);function dK(n){const{arrowWidth:o,autoAdjustOverflow:l,arrowPointAtCenter:h,offset:f,borderRadius:g,visibleFirst:x}=n,E=o/2,w={};return Object.keys(vP).forEach(I=>{const R=h&&uK[I]||vP[I],D=Object.assign(Object.assign({},R),{offset:[0,0]});switch(w[I]=D,hK.has(I)&&(D.autoArrow=!1),I){case"top":case"topLeft":case"topRight":D.offset[1]=-E-f;break;case"bottom":case"bottomLeft":case"bottomRight":D.offset[1]=E+f;break;case"left":case"leftTop":case"leftBottom":D.offset[0]=-E-f;break;case"right":case"rightTop":case"rightBottom":D.offset[0]=E+f;break}const F=uD({contentRadius:g,limitVerticalRadius:!0});if(h)switch(I){case"topLeft":case"bottomLeft":D.offset[0]=-F.dropdownArrowOffset-E;break;case"topRight":case"bottomRight":D.offset[0]=F.dropdownArrowOffset+E;break;case"leftTop":case"rightTop":D.offset[1]=-F.dropdownArrowOffset-E;break;case"leftBottom":case"rightBottom":D.offset[1]=F.dropdownArrowOffset+E;break}D.overflow=cK(I,F,o,l),x&&(D.htmlRegion="visibleFirst")}),w}const fK=n=>{const o=n!=null&&n.algorithm?cp(n.algorithm):cp(Cp),l=Object.assign(Object.assign({},Mp),n==null?void 0:n.token);return Fz(l,{override:n==null?void 0:n.token},o,n8)},pK=fK;function mK(n){const{sizeUnit:o,sizeStep:l}=n,h=l-2;return{sizeXXL:o*(h+10),sizeXL:o*(h+6),sizeLG:o*(h+2),sizeMD:o*(h+2),sizeMS:o*(h+1),size:o*h,sizeSM:o*h,sizeXS:o*(h-1),sizeXXS:o*(h-1)}}const gK=(n,o)=>{const l=o??Cp(n),h=l.fontSizeSM,f=l.controlHeight-4;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},l),mK(o??n)),e8(h)),{controlHeight:f}),Jz(Object.assign(Object.assign({},l),{controlHeight:f})))},_K=gK,pl=(n,o)=>new Di(n).setAlpha(o).toRgbString(),th=(n,o)=>new Di(n).lighten(o).toHexString(),yK=n=>{const o=Ss(n,{theme:"dark"});return{1:o[0],2:o[1],3:o[2],4:o[3],5:o[6],6:o[5],7:o[4],8:o[6],9:o[5],10:o[4]}},vK=(n,o)=>{const l=n||"#000",h=o||"#fff";return{colorBgBase:l,colorTextBase:h,colorText:pl(h,.85),colorTextSecondary:pl(h,.65),colorTextTertiary:pl(h,.45),colorTextQuaternary:pl(h,.25),colorFill:pl(h,.18),colorFillSecondary:pl(h,.12),colorFillTertiary:pl(h,.08),colorFillQuaternary:pl(h,.04),colorBgElevated:th(l,12),colorBgContainer:th(l,8),colorBgLayout:th(l,0),colorBgSpotlight:th(l,26),colorBorder:th(l,26),colorBorderSecondary:th(l,19)}},xK=(n,o)=>{const l=Object.keys(V3).map(f=>{const g=Ss(n[f],{theme:"dark"});return new Array(10).fill(1).reduce((x,E,w)=>(x[`${f}-${w+1}`]=g[w],x[`${f}${w+1}`]=g[w],x),{})}).reduce((f,g)=>(f=Object.assign(Object.assign({},f),g),f),{}),h=o??Cp(n);return Object.assign(Object.assign(Object.assign({},h),l),Qz(n,{generateColorPalettes:yK,generateNeutralColorPalettes:vK}))},bK=xK;function wK(){const[n,o,l]=Vc();return{theme:n,token:o,hashId:l}}const hD={defaultConfig:h_,defaultSeed:h_.token,useToken:wK,defaultAlgorithm:Cp,darkAlgorithm:bK,compactAlgorithm:_K,getDesignToken:pK},EK=n=>{const{componentCls:o,tooltipMaxWidth:l,tooltipColor:h,tooltipBg:f,tooltipBorderRadius:g,zIndexPopup:x,controlHeight:E,boxShadowSecondary:w,paddingSM:I,paddingXS:R,tooltipRadiusOuter:D}=n;return[{[o]:Object.assign(Object.assign(Object.assign(Object.assign({},Dl(n)),{position:"absolute",zIndex:x,display:"block",width:"max-content",maxWidth:l,visibility:"visible",transformOrigin:"var(--arrow-x, 50%) var(--arrow-y, 50%)","&-hidden":{display:"none"},"--antd-arrow-background-color":f,[`${o}-inner`]:{minWidth:E,minHeight:E,padding:`${I/2}px ${R}px`,color:h,textAlign:"start",textDecoration:"none",wordWrap:"break-word",backgroundColor:f,borderRadius:g,boxShadow:w,boxSizing:"border-box"},[["&-placement-left","&-placement-leftTop","&-placement-leftBottom","&-placement-right","&-placement-rightTop","&-placement-rightBottom"].join(",")]:{[`${o}-inner`]:{borderRadius:Math.min(g,cD)}},[`${o}-content`]:{position:"relative"}}),oH(n,(F,q)=>{let{darkColor:G}=q;return{[`&${o}-${F}`]:{[`${o}-inner`]:{backgroundColor:G},[`${o}-arrow`]:{"--antd-arrow-background-color":G}}}})),{"&-rtl":{direction:"rtl"}})},lK(to(n,{borderRadiusOuter:D}),{colorBg:"var(--antd-arrow-background-color)",contentRadius:g,limitVerticalRadius:!0}),{[`${o}-pure`]:{position:"relative",maxWidth:"none",margin:n.sizePopupArrow}}]},dD=(n,o)=>ba("Tooltip",h=>{if(o===!1)return[];const{borderRadius:f,colorTextLightSolid:g,colorBgDefault:x,borderRadiusOuter:E}=h,w=to(h,{tooltipMaxWidth:250,tooltipColor:g,tooltipBorderRadius:f,tooltipBg:x,tooltipRadiusOuter:E>4?4:E});return[EK(w),FY(h,"zoom-big-fast")]},h=>{let{zIndexPopupBase:f,colorBgSpotlight:g}=h;return{zIndexPopup:f+70,colorBgDefault:g}},{resetStyle:!1})(n),SK=u_.map(n=>`${n}-inverse`);function TK(n){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)?[].concat(Jt(SK),Jt(u_)).includes(n):u_.includes(n)}function fD(n,o){const l=TK(o),h=$t({[`${n}-${o}`]:o&&l}),f={},g={};return o&&!l&&(f.background=o,g["--antd-arrow-background-color"]=o),{className:h,overlayStyle:f,arrowStyle:g}}const MK=n=>{const{prefixCls:o,className:l,placement:h="top",title:f,color:g,overlayInnerStyle:x}=n,{getPrefixCls:E}=A.useContext(wn),w=E("tooltip",o),[I,R]=dD(w,!0),D=fD(w,g),F=D.arrowStyle,q=Object.assign(Object.assign({},x),D.overlayStyle),G=$t(R,w,`${w}-pure`,`${w}-placement-${h}`,l,D.className);return I(A.createElement("div",{className:G,style:F},A.createElement("div",{className:`${w}-arrow`}),A.createElement(lD,Object.assign({},n,{className:R,prefixCls:w,overlayInnerStyle:q}),f)))},CK=MK;var AK=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};const{useToken:IK}=hD,PK=(n,o)=>{const l={},h=Object.assign({},n);return o.forEach(f=>{n&&f in n&&(l[f]=n[f],delete h[f])}),{picked:l,omitted:h}};function kK(n,o){const l=n.type;if((l.__ANT_BUTTON===!0||n.type==="button")&&n.props.disabled||l.__ANT_SWITCH===!0&&(n.props.disabled||n.props.loading)||l.__ANT_RADIO===!0&&n.props.disabled){const{picked:h,omitted:f}=PK(n.props.style,["position","left","right","top","bottom","float","display","zIndex"]),g=Object.assign(Object.assign({display:"inline-block"},h),{cursor:"not-allowed",width:n.props.block?"100%":void 0}),x=Object.assign(Object.assign({},f),{pointerEvents:"none"}),E=Dc(n,{style:x,className:null});return A.createElement("span",{style:g,className:$t(n.props.className,`${o}-disabled-compatible-wrapper`)},E)}return n}const pD=A.forwardRef((n,o)=>{var l,h;const{prefixCls:f,openClassName:g,getTooltipContainer:x,overlayClassName:E,color:w,overlayInnerStyle:I,children:R,afterOpenChange:D,afterVisibleChange:F,destroyTooltipOnHide:q,arrow:G=!0,title:j,overlay:te,builtinPlacements:N,arrowPointAtCenter:O=!1,autoAdjustOverflow:V=!0}=n,U=!!G,{token:ae}=IK(),{getPopupContainer:le,getPrefixCls:ne,direction:de}=A.useContext(wn),$=A.useRef(null),ue=()=>{var ee;(ee=$.current)===null||ee===void 0||ee.forceAlign()};A.useImperativeHandle(o,()=>({forceAlign:ue,forcePopupAlign:()=>{ue()}}));const[xe,ce]=U3(!1,{value:(l=n.open)!==null&&l!==void 0?l:n.visible,defaultValue:(h=n.defaultOpen)!==null&&h!==void 0?h:n.defaultVisible}),se=!j&&!te&&j!==0,ke=ee=>{var re,we;ce(se?!1:ee),se||((re=n.onOpenChange)===null||re===void 0||re.call(n,ee),(we=n.onVisibleChange)===null||we===void 0||we.call(n,ee))},$e=A.useMemo(()=>{var ee,re;let we=O;return typeof G=="object"&&(we=(re=(ee=G.pointAtCenter)!==null&&ee!==void 0?ee:G.arrowPointAtCenter)!==null&&re!==void 0?re:O),N||dK({arrowPointAtCenter:we,autoAdjustOverflow:V,arrowWidth:U?ae.sizePopupArrow:0,borderRadius:ae.borderRadius,offset:ae.marginXXS,visibleFirst:!0})},[O,G,N,ae]),Ne=A.useMemo(()=>j===0?j:te||j||"",[te,j]),it=A.createElement(FZ,null,typeof Ne=="function"?Ne():Ne),{getPopupContainer:Re,placement:He="top",mouseEnterDelay:Xe=.1,mouseLeaveDelay:ze=.1,overlayStyle:at,rootClassName:Pt}=n,mt=AK(n,["getPopupContainer","placement","mouseEnterDelay","mouseLeaveDelay","overlayStyle","rootClassName"]),kt=ne("tooltip",f),Oe=ne(),qt=n["data-popover-inject"];let Sr=xe;!("open"in n)&&!("visible"in n)&&se&&(Sr=!1);const Ir=kK(Vh(R)&&!U8(R)?R:A.createElement("span",null,R),kt),Xr=Ir.props,Ur=!Xr.className||typeof Xr.className=="string"?$t(Xr.className,g||`${kt}-open`):Xr.className,[pr,ar]=dD(kt,!qt),hr=fD(kt,w),xr=hr.arrowStyle,Fe=Object.assign(Object.assign({},I),hr.overlayStyle),Y=$t(E,{[`${kt}-rtl`]:de==="rtl"},hr.className,Pt,ar);return pr(A.createElement(sK,Object.assign({},mt,{showArrow:U,placement:He,mouseEnterDelay:Xe,mouseLeaveDelay:ze,prefixCls:kt,overlayClassName:Y,overlayStyle:Object.assign(Object.assign({},xr),at),getTooltipContainer:Re||x||le,ref:$,builtinPlacements:$e,overlay:it,visible:Sr,onVisibleChange:ke,afterVisibleChange:D??F,overlayInnerStyle:Fe,arrowContent:A.createElement("span",{className:`${kt}-arrow-content`}),motion:{motionName:xX(Oe,"zoom-big-fast",n.transitionName),motionDeadline:1e3},destroyTooltipOnHide:!!q}),Sr?Dc(Ir,{className:Ur}):Ir))});pD._InternalPanelDoNotUseOrYouWillBeFired=CK;const RK=pD,mD=A.createContext(null),zK=mD.Provider,gD=A.createContext(null),DK=gD.Provider;var LK=["prefixCls","className","style","checked","disabled","defaultChecked","type","title","onChange"],OK=A.forwardRef(function(n,o){var l,h=n.prefixCls,f=h===void 0?"rc-checkbox":h,g=n.className,x=n.style,E=n.checked,w=n.disabled,I=n.defaultChecked,R=I===void 0?!1:I,D=n.type,F=D===void 0?"checkbox":D,q=n.title,G=n.onChange,j=xa(n,LK),te=A.useRef(null),N=U3(R,{value:E}),O=Ht(N,2),V=O[0],U=O[1];A.useImperativeHandle(o,function(){return{focus:function(){var de;(de=te.current)===null||de===void 0||de.focus()},blur:function(){var de;(de=te.current)===null||de===void 0||de.blur()},input:te.current}});var ae=$t(f,g,(l={},$r(l,"".concat(f,"-checked"),V),$r(l,"".concat(f,"-disabled"),w),l)),le=function(de){w||("checked"in n||U(de.target.checked),G==null||G({target:ft(ft({},n),{},{type:F,checked:de.target.checked}),stopPropagation:function(){de.stopPropagation()},preventDefault:function(){de.preventDefault()},nativeEvent:de.nativeEvent}))};return A.createElement("span",{className:ae,title:q,style:x},A.createElement("input",ui({},j,{className:"".concat(f,"-input"),ref:te,onChange:le,disabled:w,checked:!!V,type:F})),A.createElement("span",{className:"".concat(f,"-inner")}))});const FK=n=>{const{componentCls:o,antCls:l}=n,h=`${o}-group`;return{[h]:Object.assign(Object.assign({},Dl(n)),{display:"inline-block",fontSize:0,[`&${h}-rtl`]:{direction:"rtl"},[`${l}-badge ${l}-badge-count`]:{zIndex:1},[`> ${l}-badge:not(:first-child) > ${l}-button-wrapper`]:{borderInlineStart:"none"}})}},BK=n=>{const{componentCls:o,wrapperMarginInlineEnd:l,colorPrimary:h,radioSize:f,motionDurationSlow:g,motionDurationMid:x,motionEaseInOutCirc:E,colorBgContainer:w,colorBorder:I,lineWidth:R,dotSize:D,colorBgContainerDisabled:F,colorTextDisabled:q,paddingXS:G,dotColorDisabled:j,lineType:te,radioDotDisabledSize:N,wireframe:O,colorWhite:V}=n,U=`${o}-inner`;return{[`${o}-wrapper`]:Object.assign(Object.assign({},Dl(n)),{display:"inline-flex",alignItems:"baseline",marginInlineStart:0,marginInlineEnd:l,cursor:"pointer",[`&${o}-wrapper-rtl`]:{direction:"rtl"},"&-disabled":{cursor:"not-allowed",color:n.colorTextDisabled},"&::after":{display:"inline-block",width:0,overflow:"hidden",content:'"\\a0"'},[`${o}-checked::after`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:"100%",height:"100%",border:`${R}px ${te} ${h}`,borderRadius:"50%",visibility:"hidden",content:'""'},[o]:Object.assign(Object.assign({},Dl(n)),{position:"relative",display:"inline-block",outline:"none",cursor:"pointer",alignSelf:"center",borderRadius:"50%"}),[`${o}-wrapper:hover &,
        &:hover ${U}`]:{borderColor:h},[`${o}-input:focus-visible + ${U}`]:Object.assign({},G3(n)),[`${o}:hover::after, ${o}-wrapper:hover &::after`]:{visibility:"visible"},[`${o}-inner`]:{"&::after":{boxSizing:"border-box",position:"absolute",insetBlockStart:"50%",insetInlineStart:"50%",display:"block",width:f,height:f,marginBlockStart:f/-2,marginInlineStart:f/-2,backgroundColor:O?h:V,borderBlockStart:0,borderInlineStart:0,borderRadius:f,transform:"scale(0)",opacity:0,transition:`all ${g} ${E}`,content:'""'},boxSizing:"border-box",position:"relative",insetBlockStart:0,insetInlineStart:0,display:"block",width:f,height:f,backgroundColor:w,borderColor:I,borderStyle:"solid",borderWidth:R,borderRadius:"50%",transition:`all ${x}`},[`${o}-input`]:{position:"absolute",insetBlockStart:0,insetInlineEnd:0,insetBlockEnd:0,insetInlineStart:0,width:0,height:0,padding:0,margin:0,zIndex:1,cursor:"pointer",opacity:0},[`${o}-checked`]:{[U]:{borderColor:h,backgroundColor:O?w:h,"&::after":{transform:`scale(${D/f})`,opacity:1,transition:`all ${g} ${E}`}}},[`${o}-disabled`]:{cursor:"not-allowed",[U]:{backgroundColor:F,borderColor:I,cursor:"not-allowed","&::after":{backgroundColor:j}},[`${o}-input`]:{cursor:"not-allowed"},[`${o}-disabled + span`]:{color:q,cursor:"not-allowed"},[`&${o}-checked`]:{[U]:{"&::after":{transform:`scale(${N/f})`}}}},[`span${o} + *`]:{paddingInlineStart:G,paddingInlineEnd:G}})}},NK=n=>{const{buttonColor:o,controlHeight:l,componentCls:h,lineWidth:f,lineType:g,colorBorder:x,motionDurationSlow:E,motionDurationMid:w,buttonPaddingInline:I,fontSize:R,buttonBg:D,fontSizeLG:F,controlHeightLG:q,controlHeightSM:G,paddingXS:j,borderRadius:te,borderRadiusSM:N,borderRadiusLG:O,buttonCheckedBg:V,buttonSolidCheckedColor:U,colorTextDisabled:ae,colorBgContainerDisabled:le,buttonCheckedBgDisabled:ne,buttonCheckedColorDisabled:de,colorPrimary:$,colorPrimaryHover:ue,colorPrimaryActive:xe}=n;return{[`${h}-button-wrapper`]:{position:"relative",display:"inline-block",height:l,margin:0,paddingInline:I,paddingBlock:0,color:o,fontSize:R,lineHeight:`${l-f*2}px`,background:D,border:`${f}px ${g} ${x}`,borderBlockStartWidth:f+.02,borderInlineStartWidth:0,borderInlineEndWidth:f,cursor:"pointer",transition:[`color ${w}`,`background ${w}`,`box-shadow ${w}`].join(","),a:{color:o},[`> ${h}-button`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,zIndex:-1,width:"100%",height:"100%"},"&:not(:first-child)":{"&::before":{position:"absolute",insetBlockStart:-f,insetInlineStart:-f,display:"block",boxSizing:"content-box",width:1,height:"100%",paddingBlock:f,paddingInline:0,backgroundColor:x,transition:`background-color ${E}`,content:'""'}},"&:first-child":{borderInlineStart:`${f}px ${g} ${x}`,borderStartStartRadius:te,borderEndStartRadius:te},"&:last-child":{borderStartEndRadius:te,borderEndEndRadius:te},"&:first-child:last-child":{borderRadius:te},[`${h}-group-large &`]:{height:q,fontSize:F,lineHeight:`${q-f*2}px`,"&:first-child":{borderStartStartRadius:O,borderEndStartRadius:O},"&:last-child":{borderStartEndRadius:O,borderEndEndRadius:O}},[`${h}-group-small &`]:{height:G,paddingInline:j-f,paddingBlock:0,lineHeight:`${G-f*2}px`,"&:first-child":{borderStartStartRadius:N,borderEndStartRadius:N},"&:last-child":{borderStartEndRadius:N,borderEndEndRadius:N}},"&:hover":{position:"relative",color:$},"&:has(:focus-visible)":Object.assign({},G3(n)),[`${h}-inner, input[type='checkbox'], input[type='radio']`]:{width:0,height:0,opacity:0,pointerEvents:"none"},[`&-checked:not(${h}-button-wrapper-disabled)`]:{zIndex:1,color:$,background:V,borderColor:$,"&::before":{backgroundColor:$},"&:first-child":{borderColor:$},"&:hover":{color:ue,borderColor:ue,"&::before":{backgroundColor:ue}},"&:active":{color:xe,borderColor:xe,"&::before":{backgroundColor:xe}}},[`${h}-group-solid &-checked:not(${h}-button-wrapper-disabled)`]:{color:U,background:$,borderColor:$,"&:hover":{color:U,background:ue,borderColor:ue},"&:active":{color:U,background:xe,borderColor:xe}},"&-disabled":{color:ae,backgroundColor:le,borderColor:x,cursor:"not-allowed","&:first-child, &:hover":{color:ae,backgroundColor:le,borderColor:x}},[`&-disabled${h}-button-wrapper-checked`]:{color:de,backgroundColor:ne,borderColor:x,boxShadow:"none"}}}},xP=n=>n-4*2,_D=ba("Radio",n=>{const{controlOutline:o,controlOutlineWidth:l,radioSize:h}=n,f=`0 0 0 ${l}px ${o}`,g=f,x=xP(h),E=to(n,{radioDotDisabledSize:x,radioFocusShadow:f,radioButtonFocusShadow:g});return[FK(E),BK(E),NK(E)]},n=>{const{wireframe:o,padding:l,marginXS:h,lineWidth:f,fontSizeLG:g,colorText:x,colorBgContainer:E,colorTextDisabled:w,controlItemBgActiveDisabled:I,colorTextLightSolid:R}=n,D=4,F=g,q=o?xP(F):F-(D+f)*2;return{radioSize:F,dotSize:q,dotColorDisabled:w,buttonSolidCheckedColor:R,buttonBg:E,buttonCheckedBg:E,buttonColor:x,buttonCheckedBgDisabled:I,buttonCheckedColorDisabled:w,buttonPaddingInline:l-f,wrapperMarginInlineEnd:h}});var jK=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};const $K=(n,o)=>{var l,h;const f=A.useContext(mD),g=A.useContext(gD),{getPrefixCls:x,direction:E,radio:w}=A.useContext(wn),I=A.useRef(null),R=Bc(o,I),{isFormItemInput:D}=A.useContext(oy),F=xe=>{var ce,se;(ce=n.onChange)===null||ce===void 0||ce.call(n,xe),(se=f==null?void 0:f.onChange)===null||se===void 0||se.call(f,xe)},{prefixCls:q,className:G,rootClassName:j,children:te,style:N}=n,O=jK(n,["prefixCls","className","rootClassName","children","style"]),V=x("radio",q),U=((f==null?void 0:f.optionType)||g)==="button",ae=U?`${V}-button`:V,[le,ne]=_D(V),de=Object.assign({},O),$=A.useContext(J_);f&&(de.name=f.name,de.onChange=F,de.checked=n.value===f.value,de.disabled=(l=de.disabled)!==null&&l!==void 0?l:f.disabled),de.disabled=(h=de.disabled)!==null&&h!==void 0?h:$;const ue=$t(`${ae}-wrapper`,{[`${ae}-wrapper-checked`]:de.checked,[`${ae}-wrapper-disabled`]:de.disabled,[`${ae}-wrapper-rtl`]:E==="rtl",[`${ae}-wrapper-in-form-item`]:D},w==null?void 0:w.className,G,j,ne);return le(A.createElement(G8,{component:"Radio",disabled:de.disabled},A.createElement("label",{className:ue,style:Object.assign(Object.assign({},w==null?void 0:w.style),N),onMouseEnter:n.onMouseEnter,onMouseLeave:n.onMouseLeave},A.createElement(OK,Object.assign({},de,{className:$t(de.className,!U&&J3),type:"radio",prefixCls:ae,ref:R})),te!==void 0?A.createElement("span",null,te):null)))},VK=A.forwardRef($K),g_=VK,UK=A.forwardRef((n,o)=>{const{getPrefixCls:l,direction:h}=A.useContext(wn),[f,g]=U3(n.defaultValue,{value:n.value}),x=ce=>{const se=f,ke=ce.target.value;"value"in n||g(ke);const{onChange:$e}=n;$e&&ke!==se&&$e(ce)},{prefixCls:E,className:w,rootClassName:I,options:R,buttonStyle:D="outline",disabled:F,children:q,size:G,style:j,id:te,onMouseEnter:N,onMouseLeave:O,onFocus:V,onBlur:U}=n,ae=l("radio",E),le=`${ae}-group`,[ne,de]=_D(ae);let $=q;R&&R.length>0&&($=R.map(ce=>typeof ce=="string"||typeof ce=="number"?A.createElement(g_,{key:ce.toString(),prefixCls:ae,disabled:F,value:ce,checked:f===ce},ce):A.createElement(g_,{key:`radio-group-value-options-${ce.value}`,prefixCls:ae,disabled:ce.disabled||F,value:ce.value,checked:f===ce.value,title:ce.title,style:ce.style},ce.label)));const ue=Q3(G),xe=$t(le,`${le}-${D}`,{[`${le}-${ue}`]:ue,[`${le}-rtl`]:h==="rtl"},w,I,de);return ne(A.createElement("div",Object.assign({},lZ(n,{aria:!0,data:!0}),{className:xe,style:j,onMouseEnter:N,onMouseLeave:O,onFocus:V,onBlur:U,id:te,ref:o}),A.createElement(zK,{value:{onChange:x,value:f,disabled:n.disabled,name:n.name,optionType:n.optionType}},$)))}),GK=A.memo(UK);var WK=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};const HK=(n,o)=>{const{getPrefixCls:l}=A.useContext(wn),{prefixCls:h}=n,f=WK(n,["prefixCls"]),g=l("radio",h);return A.createElement(DK,{value:"button"},A.createElement(g_,Object.assign({prefixCls:g},f,{type:"radio",ref:o})))},qK=A.forwardRef(HK),ay=g_;ay.Button=qK;ay.Group=GK;ay.__ANT_RADIO=!0;const vn=ay,ZK=n=>{const{prefixCls:o,className:l,style:h,size:f,shape:g}=n,x=$t({[`${o}-lg`]:f==="large",[`${o}-sm`]:f==="small"}),E=$t({[`${o}-circle`]:g==="circle",[`${o}-square`]:g==="square",[`${o}-round`]:g==="round"}),w=A.useMemo(()=>typeof f=="number"?{width:f,height:f,lineHeight:`${f}px`}:{},[f]);return A.createElement("span",{className:$t(o,x,E,l),style:Object.assign(Object.assign({},w),h)})},sy=ZK,XK=new Ni("ant-skeleton-loading",{"0%":{backgroundPosition:"100% 50%"},"100%":{backgroundPosition:"0 50%"}}),ly=n=>({height:n,lineHeight:`${n}px`}),Ph=n=>Object.assign({width:n},ly(n)),YK=n=>({background:n.skeletonLoadingBackground,backgroundSize:"400% 100%",animationName:XK,animationDuration:n.skeletonLoadingMotionDuration,animationTimingFunction:"ease",animationIterationCount:"infinite"}),jb=n=>Object.assign({width:n*5,minWidth:n*5},ly(n)),KK=n=>{const{skeletonAvatarCls:o,gradientFromColor:l,controlHeight:h,controlHeightLG:f,controlHeightSM:g}=n;return{[`${o}`]:Object.assign({display:"inline-block",verticalAlign:"top",background:l},Ph(h)),[`${o}${o}-circle`]:{borderRadius:"50%"},[`${o}${o}-lg`]:Object.assign({},Ph(f)),[`${o}${o}-sm`]:Object.assign({},Ph(g))}},JK=n=>{const{controlHeight:o,borderRadiusSM:l,skeletonInputCls:h,controlHeightLG:f,controlHeightSM:g,gradientFromColor:x}=n;return{[`${h}`]:Object.assign({display:"inline-block",verticalAlign:"top",background:x,borderRadius:l},jb(o)),[`${h}-lg`]:Object.assign({},jb(f)),[`${h}-sm`]:Object.assign({},jb(g))}},bP=n=>Object.assign({width:n},ly(n)),QK=n=>{const{skeletonImageCls:o,imageSizeBase:l,gradientFromColor:h,borderRadiusSM:f}=n;return{[`${o}`]:Object.assign(Object.assign({display:"flex",alignItems:"center",justifyContent:"center",verticalAlign:"top",background:h,borderRadius:f},bP(l*2)),{[`${o}-path`]:{fill:"#bfbfbf"},[`${o}-svg`]:Object.assign(Object.assign({},bP(l)),{maxWidth:l*4,maxHeight:l*4}),[`${o}-svg${o}-svg-circle`]:{borderRadius:"50%"}}),[`${o}${o}-circle`]:{borderRadius:"50%"}}},$b=(n,o,l)=>{const{skeletonButtonCls:h}=n;return{[`${l}${h}-circle`]:{width:o,minWidth:o,borderRadius:"50%"},[`${l}${h}-round`]:{borderRadius:o}}},Vb=n=>Object.assign({width:n*2,minWidth:n*2},ly(n)),eJ=n=>{const{borderRadiusSM:o,skeletonButtonCls:l,controlHeight:h,controlHeightLG:f,controlHeightSM:g,gradientFromColor:x}=n;return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({[`${l}`]:Object.assign({display:"inline-block",verticalAlign:"top",background:x,borderRadius:o,width:h*2,minWidth:h*2},Vb(h))},$b(n,h,l)),{[`${l}-lg`]:Object.assign({},Vb(f))}),$b(n,f,`${l}-lg`)),{[`${l}-sm`]:Object.assign({},Vb(g))}),$b(n,g,`${l}-sm`))},tJ=n=>{const{componentCls:o,skeletonAvatarCls:l,skeletonTitleCls:h,skeletonParagraphCls:f,skeletonButtonCls:g,skeletonInputCls:x,skeletonImageCls:E,controlHeight:w,controlHeightLG:I,controlHeightSM:R,gradientFromColor:D,padding:F,marginSM:q,borderRadius:G,titleHeight:j,blockRadius:te,paragraphLiHeight:N,controlHeightXS:O,paragraphMarginTop:V}=n;return{[`${o}`]:{display:"table",width:"100%",[`${o}-header`]:{display:"table-cell",paddingInlineEnd:F,verticalAlign:"top",[`${l}`]:Object.assign({display:"inline-block",verticalAlign:"top",background:D},Ph(w)),[`${l}-circle`]:{borderRadius:"50%"},[`${l}-lg`]:Object.assign({},Ph(I)),[`${l}-sm`]:Object.assign({},Ph(R))},[`${o}-content`]:{display:"table-cell",width:"100%",verticalAlign:"top",[`${h}`]:{width:"100%",height:j,background:D,borderRadius:te,[`+ ${f}`]:{marginBlockStart:R}},[`${f}`]:{padding:0,"> li":{width:"100%",height:N,listStyle:"none",background:D,borderRadius:te,"+ li":{marginBlockStart:O}}},[`${f}> li:last-child:not(:first-child):not(:nth-child(2))`]:{width:"61%"}},[`&-round ${o}-content`]:{[`${h}, ${f} > li`]:{borderRadius:G}}},[`${o}-with-avatar ${o}-content`]:{[`${h}`]:{marginBlockStart:q,[`+ ${f}`]:{marginBlockStart:V}}},[`${o}${o}-element`]:Object.assign(Object.assign(Object.assign(Object.assign({display:"inline-block",width:"auto"},eJ(n)),KK(n)),JK(n)),QK(n)),[`${o}${o}-block`]:{width:"100%",[`${g}`]:{width:"100%"},[`${x}`]:{width:"100%"}},[`${o}${o}-active`]:{[`
        ${h},
        ${f} > li,
        ${l},
        ${g},
        ${x},
        ${E}
      `]:Object.assign({},YK(n))}}},ed=ba("Skeleton",n=>{const{componentCls:o}=n,l=to(n,{skeletonAvatarCls:`${o}-avatar`,skeletonTitleCls:`${o}-title`,skeletonParagraphCls:`${o}-paragraph`,skeletonButtonCls:`${o}-button`,skeletonInputCls:`${o}-input`,skeletonImageCls:`${o}-image`,imageSizeBase:n.controlHeight*1.5,borderRadius:100,skeletonLoadingBackground:`linear-gradient(90deg, ${n.gradientFromColor} 25%, ${n.gradientToColor} 37%, ${n.gradientFromColor} 63%)`,skeletonLoadingMotionDuration:"1.4s"});return[tJ(l)]},n=>{const{colorFillContent:o,colorFill:l}=n,h=o,f=l;return{color:h,colorGradientEnd:f,gradientFromColor:h,gradientToColor:f,titleHeight:n.controlHeight/2,blockRadius:n.borderRadiusSM,paragraphMarginTop:n.marginLG+n.marginXXS,paragraphLiHeight:n.controlHeight/2}},{deprecatedTokens:[["color","gradientFromColor"],["colorGradientEnd","gradientToColor"]]}),rJ=n=>{const{prefixCls:o,className:l,rootClassName:h,active:f,shape:g="circle",size:x="default"}=n,{getPrefixCls:E}=A.useContext(wn),w=E("skeleton",o),[I,R]=ed(w),D=$c(n,["prefixCls","className"]),F=$t(w,`${w}-element`,{[`${w}-active`]:f},l,h,R);return I(A.createElement("div",{className:F},A.createElement(sy,Object.assign({prefixCls:`${w}-avatar`,shape:g,size:x},D))))},nJ=rJ,iJ=n=>{const{prefixCls:o,className:l,rootClassName:h,active:f,block:g=!1,size:x="default"}=n,{getPrefixCls:E}=A.useContext(wn),w=E("skeleton",o),[I,R]=ed(w),D=$c(n,["prefixCls"]),F=$t(w,`${w}-element`,{[`${w}-active`]:f,[`${w}-block`]:g},l,h,R);return I(A.createElement("div",{className:F},A.createElement(sy,Object.assign({prefixCls:`${w}-button`,size:x},D))))},oJ=iJ,aJ="M365.714286 329.142857q0 45.714286-32.036571 77.677714t-77.677714 32.036571-77.677714-32.036571-32.036571-77.677714 32.036571-77.677714 77.677714-32.036571 77.677714 32.036571 32.036571 77.677714zM950.857143 548.571429l0 256-804.571429 0 0-109.714286 182.857143-182.857143 91.428571 91.428571 292.571429-292.571429zM1005.714286 146.285714l-914.285714 0q-7.460571 0-12.873143 5.412571t-5.412571 12.873143l0 694.857143q0 7.460571 5.412571 12.873143t12.873143 5.412571l914.285714 0q7.460571 0 12.873143-5.412571t5.412571-12.873143l0-694.857143q0-7.460571-5.412571-12.873143t-12.873143-5.412571zM1097.142857 164.571429l0 694.857143q0 37.741714-26.843429 64.585143t-64.585143 26.843429l-914.285714 0q-37.741714 0-64.585143-26.843429t-26.843429-64.585143l0-694.857143q0-37.741714 26.843429-64.585143t64.585143-26.843429l914.285714 0q37.741714 0 64.585143 26.843429t26.843429 64.585143z",sJ=n=>{const{prefixCls:o,className:l,rootClassName:h,style:f,active:g}=n,{getPrefixCls:x}=A.useContext(wn),E=x("skeleton",o),[w,I]=ed(E),R=$t(E,`${E}-element`,{[`${E}-active`]:g},l,h,I);return w(A.createElement("div",{className:R},A.createElement("div",{className:$t(`${E}-image`,l),style:f},A.createElement("svg",{viewBox:"0 0 1098 1024",xmlns:"http://www.w3.org/2000/svg",className:`${E}-image-svg`},A.createElement("path",{d:aJ,className:`${E}-image-path`})))))},lJ=sJ,cJ=n=>{const{prefixCls:o,className:l,rootClassName:h,active:f,block:g,size:x="default"}=n,{getPrefixCls:E}=A.useContext(wn),w=E("skeleton",o),[I,R]=ed(w),D=$c(n,["prefixCls"]),F=$t(w,`${w}-element`,{[`${w}-active`]:f,[`${w}-block`]:g},l,h,R);return I(A.createElement("div",{className:F},A.createElement(sy,Object.assign({prefixCls:`${w}-input`,size:x},D))))},uJ=cJ;var hJ={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M888 792H200V168c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v688c0 4.4 3.6 8 8 8h752c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM288 604a64 64 0 10128 0 64 64 0 10-128 0zm118-224a48 48 0 1096 0 48 48 0 10-96 0zm158 228a96 96 0 10192 0 96 96 0 10-192 0zm148-314a56 56 0 10112 0 56 56 0 10-112 0z"}}]},name:"dot-chart",theme:"outlined"};const dJ=hJ;var fJ=function(o,l){return A.createElement(Uc,ui({},o,{ref:l,icon:dJ}))};const pJ=A.forwardRef(fJ),mJ=n=>{const{prefixCls:o,className:l,rootClassName:h,style:f,active:g,children:x}=n,{getPrefixCls:E}=A.useContext(wn),w=E("skeleton",o),[I,R]=ed(w),D=$t(w,`${w}-element`,{[`${w}-active`]:g},R,l,h),F=x??A.createElement(pJ,null);return I(A.createElement("div",{className:D},A.createElement("div",{className:$t(`${w}-image`,l),style:f},F)))},gJ=mJ,_J=n=>{const o=E=>{const{width:w,rows:I=2}=n;if(Array.isArray(w))return w[E];if(I-1===E)return w},{prefixCls:l,className:h,style:f,rows:g}=n,x=Jt(Array(g)).map((E,w)=>A.createElement("li",{key:w,style:{width:o(w)}}));return A.createElement("ul",{className:$t(l,h),style:f},x)},yJ=_J,vJ=n=>{let{prefixCls:o,className:l,width:h,style:f}=n;return A.createElement("h3",{className:$t(o,l),style:Object.assign({width:h},f)})},xJ=vJ;function Ub(n){return n&&typeof n=="object"?n:{}}function bJ(n,o){return n&&!o?{size:"large",shape:"square"}:{size:"large",shape:"circle"}}function wJ(n,o){return!n&&o?{width:"38%"}:n&&o?{width:"50%"}:{}}function EJ(n,o){const l={};return(!n||!o)&&(l.width="61%"),!n&&o?l.rows=3:l.rows=2,l}const td=n=>{const{prefixCls:o,loading:l,className:h,rootClassName:f,style:g,children:x,avatar:E=!1,title:w=!0,paragraph:I=!0,active:R,round:D}=n,{getPrefixCls:F,direction:q,skeleton:G}=A.useContext(wn),j=F("skeleton",o),[te,N]=ed(j);if(l||!("loading"in n)){const O=!!E,V=!!w,U=!!I;let ae;if(O){const de=Object.assign(Object.assign({prefixCls:`${j}-avatar`},bJ(V,U)),Ub(E));ae=A.createElement("div",{className:`${j}-header`},A.createElement(sy,Object.assign({},de)))}let le;if(V||U){let de;if(V){const ue=Object.assign(Object.assign({prefixCls:`${j}-title`},wJ(O,U)),Ub(w));de=A.createElement(xJ,Object.assign({},ue))}let $;if(U){const ue=Object.assign(Object.assign({prefixCls:`${j}-paragraph`},EJ(O,V)),Ub(I));$=A.createElement(yJ,Object.assign({},ue))}le=A.createElement("div",{className:`${j}-content`},de,$)}const ne=$t(j,{[`${j}-with-avatar`]:O,[`${j}-active`]:R,[`${j}-rtl`]:q==="rtl",[`${j}-round`]:D},G==null?void 0:G.className,h,f,N);return te(A.createElement("div",{className:ne,style:Object.assign(Object.assign({},G==null?void 0:G.style),g)},ae,le))}return typeof x<"u"?x:null};td.Button=oJ;td.Avatar=nJ;td.Input=uJ;td.Image=lJ;td.Node=gJ;const wP=td;function SJ(n,o,l){var h=l||{},f=h.noTrailing,g=f===void 0?!1:f,x=h.noLeading,E=x===void 0?!1:x,w=h.debounceMode,I=w===void 0?void 0:w,R,D=!1,F=0;function q(){R&&clearTimeout(R)}function G(te){var N=te||{},O=N.upcomingOnly,V=O===void 0?!1:O;q(),D=!V}function j(){for(var te=arguments.length,N=new Array(te),O=0;O<te;O++)N[O]=arguments[O];var V=this,U=Date.now()-F;if(D)return;function ae(){F=Date.now(),o.apply(V,N)}function le(){R=void 0}!E&&I&&!R&&ae(),q(),I===void 0&&U>n?E?(F=Date.now(),g||(R=setTimeout(I?le:ae,n))):ae():g!==!0&&(R=setTimeout(I?le:ae,I===void 0?n-U:n))}return j.cancel=G,j}function TJ(n,o,l){var h=l||{},f=h.atBegin,g=f===void 0?!1:f;return SJ(n,o,{debounceMode:g!==!1})}const MJ=A.createContext({}),yD=MJ,CJ=n=>{const{componentCls:o}=n;return{[o]:{display:"flex",flexFlow:"row wrap",minWidth:0,"&::before, &::after":{display:"flex"},"&-no-wrap":{flexWrap:"nowrap"},"&-start":{justifyContent:"flex-start"},"&-center":{justifyContent:"center"},"&-end":{justifyContent:"flex-end"},"&-space-between":{justifyContent:"space-between"},"&-space-around":{justifyContent:"space-around"},"&-space-evenly":{justifyContent:"space-evenly"},"&-top":{alignItems:"flex-start"},"&-middle":{alignItems:"center"},"&-bottom":{alignItems:"flex-end"}}}},AJ=n=>{const{componentCls:o}=n;return{[o]:{position:"relative",maxWidth:"100%",minHeight:1}}},IJ=(n,o)=>{const{componentCls:l,gridColumns:h}=n,f={};for(let g=h;g>=0;g--)g===0?(f[`${l}${o}-${g}`]={display:"none"},f[`${l}-push-${g}`]={insetInlineStart:"auto"},f[`${l}-pull-${g}`]={insetInlineEnd:"auto"},f[`${l}${o}-push-${g}`]={insetInlineStart:"auto"},f[`${l}${o}-pull-${g}`]={insetInlineEnd:"auto"},f[`${l}${o}-offset-${g}`]={marginInlineStart:0},f[`${l}${o}-order-${g}`]={order:0}):(f[`${l}${o}-${g}`]={display:"block",flex:`0 0 ${g/h*100}%`,maxWidth:`${g/h*100}%`},f[`${l}${o}-push-${g}`]={insetInlineStart:`${g/h*100}%`},f[`${l}${o}-pull-${g}`]={insetInlineEnd:`${g/h*100}%`},f[`${l}${o}-offset-${g}`]={marginInlineStart:`${g/h*100}%`},f[`${l}${o}-order-${g}`]={order:g});return f},Mw=(n,o)=>IJ(n,o),PJ=(n,o,l)=>({[`@media (min-width: ${o}px)`]:Object.assign({},Mw(n,l))}),kJ=ba("Grid",n=>[CJ(n)]),RJ=ba("Grid",n=>{const o=to(n,{gridColumns:24}),l={"-sm":o.screenSMMin,"-md":o.screenMDMin,"-lg":o.screenLGMin,"-xl":o.screenXLMin,"-xxl":o.screenXXLMin};return[AJ(o),Mw(o,""),Mw(o,"-xs"),Object.keys(l).map(h=>PJ(o,l[h],h)).reduce((h,f)=>Object.assign(Object.assign({},h),f),{})]});var zJ=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};function DJ(n){return typeof n=="number"?`${n} ${n} auto`:/^\d+(\.\d+)?(px|em|rem|%)$/.test(n)?`0 0 ${n}`:n}const LJ=["xs","sm","md","lg","xl","xxl"],OJ=A.forwardRef((n,o)=>{const{getPrefixCls:l,direction:h}=A.useContext(wn),{gutter:f,wrap:g,supportFlexGap:x}=A.useContext(yD),{prefixCls:E,span:w,order:I,offset:R,push:D,pull:F,className:q,children:G,flex:j,style:te}=n,N=zJ(n,["prefixCls","span","order","offset","push","pull","className","children","flex","style"]),O=l("col",E),[V,U]=RJ(O);let ae={};LJ.forEach(de=>{let $={};const ue=n[de];typeof ue=="number"?$.span=ue:typeof ue=="object"&&($=ue||{}),delete N[de],ae=Object.assign(Object.assign({},ae),{[`${O}-${de}-${$.span}`]:$.span!==void 0,[`${O}-${de}-order-${$.order}`]:$.order||$.order===0,[`${O}-${de}-offset-${$.offset}`]:$.offset||$.offset===0,[`${O}-${de}-push-${$.push}`]:$.push||$.push===0,[`${O}-${de}-pull-${$.pull}`]:$.pull||$.pull===0,[`${O}-${de}-flex-${$.flex}`]:$.flex||$.flex==="auto",[`${O}-rtl`]:h==="rtl"})});const le=$t(O,{[`${O}-${w}`]:w!==void 0,[`${O}-order-${I}`]:I,[`${O}-offset-${R}`]:R,[`${O}-push-${D}`]:D,[`${O}-pull-${F}`]:F},q,ae,U),ne={};if(f&&f[0]>0){const de=f[0]/2;ne.paddingLeft=de,ne.paddingRight=de}if(f&&f[1]>0&&!x){const de=f[1]/2;ne.paddingTop=de,ne.paddingBottom=de}return j&&(ne.flex=DJ(j),g===!1&&!ne.minWidth&&(ne.minWidth=0)),V(A.createElement("div",Object.assign({},N,{style:Object.assign(Object.assign({},ne),te),className:le,ref:o}),G))}),vD=OJ,FJ=()=>{const[n,o]=A.useState(!1);return A.useEffect(()=>{o(kX())},[]),n};var BJ=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};function EP(n,o){const[l,h]=A.useState(typeof n=="string"?n:""),f=()=>{if(typeof n=="string"&&h(n),typeof n=="object")for(let g=0;g<gp.length;g++){const x=gp[g];if(!o[x])continue;const E=n[x];if(E!==void 0){h(E);return}}};return A.useEffect(()=>{f()},[JSON.stringify(n),o]),l}const NJ=A.forwardRef((n,o)=>{const{prefixCls:l,justify:h,align:f,className:g,style:x,children:E,gutter:w=0,wrap:I}=n,R=BJ(n,["prefixCls","justify","align","className","style","children","gutter","wrap"]),{getPrefixCls:D,direction:F}=A.useContext(wn),[q,G]=A.useState({xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0}),[j,te]=A.useState({xs:!1,sm:!1,md:!1,lg:!1,xl:!1,xxl:!1}),N=EP(f,j),O=EP(h,j),V=FJ(),U=A.useRef(w),ae=nK();A.useEffect(()=>{const Re=ae.subscribe(He=>{te(He);const Xe=U.current||0;(!Array.isArray(Xe)&&typeof Xe=="object"||Array.isArray(Xe)&&(typeof Xe[0]=="object"||typeof Xe[1]=="object"))&&G(He)});return()=>ae.unsubscribe(Re)},[]);const le=()=>{const Re=[void 0,void 0];return(Array.isArray(w)?w:[w,void 0]).forEach((Xe,ze)=>{if(typeof Xe=="object")for(let at=0;at<gp.length;at++){const Pt=gp[at];if(q[Pt]&&Xe[Pt]!==void 0){Re[ze]=Xe[Pt];break}}else Re[ze]=Xe}),Re},ne=D("row",l),[de,$]=kJ(ne),ue=le(),xe=$t(ne,{[`${ne}-no-wrap`]:I===!1,[`${ne}-${O}`]:O,[`${ne}-${N}`]:N,[`${ne}-rtl`]:F==="rtl"},g,$),ce={},se=ue[0]!=null&&ue[0]>0?ue[0]/-2:void 0,ke=ue[1]!=null&&ue[1]>0?ue[1]/-2:void 0;se&&(ce.marginLeft=se,ce.marginRight=se),V?[,ce.rowGap]=ue:ke&&(ce.marginTop=ke,ce.marginBottom=ke);const[$e,Ne]=ue,it=A.useMemo(()=>({gutter:[$e,Ne],wrap:I,supportFlexGap:V}),[$e,Ne,I,V]);return de(A.createElement(yD.Provider,{value:it},A.createElement("div",Object.assign({},R,{className:xe,style:Object.assign(Object.assign({},ce),x),ref:o}),E)))}),jJ=NJ,$J=n=>{const{componentCls:o,sizePaddingEdgeHorizontal:l,colorSplit:h,lineWidth:f}=n;return{[o]:Object.assign(Object.assign({},Dl(n)),{borderBlockStart:`${f}px solid ${h}`,"&-vertical":{position:"relative",top:"-0.06em",display:"inline-block",height:"0.9em",margin:`0 ${n.dividerVerticalGutterMargin}px`,verticalAlign:"middle",borderTop:0,borderInlineStart:`${f}px solid ${h}`},"&-horizontal":{display:"flex",clear:"both",width:"100%",minWidth:"100%",margin:`${n.dividerHorizontalGutterMargin}px 0`},[`&-horizontal${o}-with-text`]:{display:"flex",alignItems:"center",margin:`${n.dividerHorizontalWithTextGutterMargin}px 0`,color:n.colorTextHeading,fontWeight:500,fontSize:n.fontSizeLG,whiteSpace:"nowrap",textAlign:"center",borderBlockStart:`0 ${h}`,"&::before, &::after":{position:"relative",width:"50%",borderBlockStart:`${f}px solid transparent`,borderBlockStartColor:"inherit",borderBlockEnd:0,transform:"translateY(50%)",content:"''"}},[`&-horizontal${o}-with-text-left`]:{"&::before":{width:"5%"},"&::after":{width:"95%"}},[`&-horizontal${o}-with-text-right`]:{"&::before":{width:"95%"},"&::after":{width:"5%"}},[`${o}-inner-text`]:{display:"inline-block",padding:"0 1em"},"&-dashed":{background:"none",borderColor:h,borderStyle:"dashed",borderWidth:`${f}px 0 0`},[`&-horizontal${o}-with-text${o}-dashed`]:{"&::before, &::after":{borderStyle:"dashed none none"}},[`&-vertical${o}-dashed`]:{borderInlineStartWidth:f,borderInlineEnd:0,borderBlockStart:0,borderBlockEnd:0},[`&-plain${o}-with-text`]:{color:n.colorText,fontWeight:"normal",fontSize:n.fontSize},[`&-horizontal${o}-with-text-left${o}-no-default-orientation-margin-left`]:{"&::before":{width:0},"&::after":{width:"100%"},[`${o}-inner-text`]:{paddingInlineStart:l}},[`&-horizontal${o}-with-text-right${o}-no-default-orientation-margin-right`]:{"&::before":{width:"100%"},"&::after":{width:0},[`${o}-inner-text`]:{paddingInlineEnd:l}}})}},VJ=ba("Divider",n=>{const o=to(n,{dividerVerticalGutterMargin:n.marginXS,dividerHorizontalWithTextGutterMargin:n.margin,dividerHorizontalGutterMargin:n.marginLG});return[$J(o)]},{sizePaddingEdgeHorizontal:0});var UJ=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};const GJ=n=>{const{getPrefixCls:o,direction:l,divider:h}=A.useContext(wn),{prefixCls:f,type:g="horizontal",orientation:x="center",orientationMargin:E,className:w,rootClassName:I,children:R,dashed:D,plain:F,style:q}=n,G=UJ(n,["prefixCls","type","orientation","orientationMargin","className","rootClassName","children","dashed","plain","style"]),j=o("divider",f),[te,N]=VJ(j),O=x.length>0?`-${x}`:x,V=!!R,U=x==="left"&&E!=null,ae=x==="right"&&E!=null,le=$t(j,h==null?void 0:h.className,N,`${j}-${g}`,{[`${j}-with-text`]:V,[`${j}-with-text${O}`]:V,[`${j}-dashed`]:!!D,[`${j}-plain`]:!!F,[`${j}-rtl`]:l==="rtl",[`${j}-no-default-orientation-margin-left`]:U,[`${j}-no-default-orientation-margin-right`]:ae},w,I),ne=A.useMemo(()=>typeof E=="number"?E:/^\d+$/.test(E)?Number(E):E,[E]),de=Object.assign(Object.assign({},U&&{marginLeft:ne}),ae&&{marginRight:ne});return te(A.createElement("div",Object.assign({className:le,style:Object.assign(Object.assign({},h==null?void 0:h.style),q)},G,{role:"separator"}),R&&g!=="vertical"&&A.createElement("span",{className:`${j}-inner-text`,style:de},R)))},xD=GJ;function __(n){const[o,l]=A.useState(n);return A.useEffect(()=>{const h=setTimeout(()=>{l(n)},n.length?0:10);return()=>{clearTimeout(h)}},[n]),o}const WJ=n=>{const{componentCls:o}=n,l=`${o}-show-help`,h=`${o}-show-help-item`;return{[l]:{transition:`opacity ${n.motionDurationSlow} ${n.motionEaseInOut}`,"&-appear, &-enter":{opacity:0,"&-active":{opacity:1}},"&-leave":{opacity:1,"&-active":{opacity:0}},[h]:{overflow:"hidden",transition:`height ${n.motionDurationSlow} ${n.motionEaseInOut},
                     opacity ${n.motionDurationSlow} ${n.motionEaseInOut},
                     transform ${n.motionDurationSlow} ${n.motionEaseInOut} !important`,[`&${h}-appear, &${h}-enter`]:{transform:"translateY(-5px)",opacity:0,"&-active":{transform:"translateY(0)",opacity:1}},[`&${h}-leave-active`]:{transform:"translateY(-5px)"}}}}},HJ=WJ,qJ=n=>({legend:{display:"block",width:"100%",marginBottom:n.marginLG,padding:0,color:n.colorTextDescription,fontSize:n.fontSizeLG,lineHeight:"inherit",border:0,borderBottom:`${n.lineWidth}px ${n.lineType} ${n.colorBorder}`},label:{fontSize:n.fontSize},'input[type="search"]':{boxSizing:"border-box"},'input[type="radio"], input[type="checkbox"]':{lineHeight:"normal"},'input[type="file"]':{display:"block"},'input[type="range"]':{display:"block",width:"100%"},"select[multiple], select[size]":{height:"auto"},"input[type='file']:focus,\n  input[type='radio']:focus,\n  input[type='checkbox']:focus":{outline:0,boxShadow:`0 0 0 ${n.controlOutlineWidth}px ${n.controlOutline}`},output:{display:"block",paddingTop:15,color:n.colorText,fontSize:n.fontSize,lineHeight:n.lineHeight}}),SP=(n,o)=>{const{formItemCls:l}=n;return{[l]:{[`${l}-label > label`]:{height:o},[`${l}-control-input`]:{minHeight:o}}}},ZJ=n=>{const{componentCls:o}=n;return{[n.componentCls]:Object.assign(Object.assign(Object.assign({},Dl(n)),qJ(n)),{[`${o}-text`]:{display:"inline-block",paddingInlineEnd:n.paddingSM},"&-small":Object.assign({},SP(n,n.controlHeightSM)),"&-large":Object.assign({},SP(n,n.controlHeightLG))})}},XJ=n=>{const{formItemCls:o,iconCls:l,componentCls:h,rootPrefixCls:f}=n;return{[o]:Object.assign(Object.assign({},Dl(n)),{marginBottom:n.marginLG,verticalAlign:"top","&-with-help":{transition:"none"},[`&-hidden,
        &-hidden.${f}-row`]:{display:"none"},"&-has-warning":{[`${o}-split`]:{color:n.colorError}},"&-has-error":{[`${o}-split`]:{color:n.colorWarning}},[`${o}-label`]:{display:"inline-block",flexGrow:0,overflow:"hidden",whiteSpace:"nowrap",textAlign:"end",verticalAlign:"middle","&-left":{textAlign:"start"},"&-wrap":{overflow:"unset",lineHeight:`${n.lineHeight} - 0.25em`,whiteSpace:"unset"},"> label":{position:"relative",display:"inline-flex",alignItems:"center",maxWidth:"100%",height:n.controlHeight,color:n.colorTextHeading,fontSize:n.fontSize,[`> ${l}`]:{fontSize:n.fontSize,verticalAlign:"top"},[`&${o}-required:not(${o}-required-mark-optional)::before`]:{display:"inline-block",marginInlineEnd:n.marginXXS,color:n.colorError,fontSize:n.fontSize,fontFamily:"SimSun, sans-serif",lineHeight:1,content:'"*"',[`${h}-hide-required-mark &`]:{display:"none"}},[`${o}-optional`]:{display:"inline-block",marginInlineStart:n.marginXXS,color:n.colorTextDescription,[`${h}-hide-required-mark &`]:{display:"none"}},[`${o}-tooltip`]:{color:n.colorTextDescription,cursor:"help",writingMode:"horizontal-tb",marginInlineStart:n.marginXXS},"&::after":{content:'":"',position:"relative",marginBlock:0,marginInlineStart:n.marginXXS/2,marginInlineEnd:n.marginXS},[`&${o}-no-colon::after`]:{content:'"\\a0"'}}},[`${o}-control`]:{display:"flex",flexDirection:"column",flexGrow:1,[`&:first-child:not([class^="'${f}-col-'"]):not([class*="' ${f}-col-'"])`]:{width:"100%"},"&-input":{position:"relative",display:"flex",alignItems:"center",minHeight:n.controlHeight,"&-content":{flex:"auto",maxWidth:"100%"}}},[o]:{"&-explain, &-extra":{clear:"both",color:n.colorTextDescription,fontSize:n.fontSize,lineHeight:n.lineHeight},"&-explain-connected":{width:"100%"},"&-extra":{minHeight:n.controlHeightSM,transition:`color ${n.motionDurationMid} ${n.motionEaseOut}`},"&-explain":{"&-error":{color:n.colorError},"&-warning":{color:n.colorWarning}}},[`&-with-help ${o}-explain`]:{height:"auto",opacity:1},[`${o}-feedback-icon`]:{fontSize:n.fontSize,textAlign:"center",visibility:"visible",animationName:sE,animationDuration:n.motionDurationMid,animationTimingFunction:n.motionEaseOutBack,pointerEvents:"none","&-success":{color:n.colorSuccess},"&-error":{color:n.colorError},"&-warning":{color:n.colorWarning},"&-validating":{color:n.colorPrimary}}})}},YJ=n=>{const{componentCls:o,formItemCls:l,rootPrefixCls:h}=n;return{[`${o}-horizontal`]:{[`${l}-label`]:{flexGrow:0},[`${l}-control`]:{flex:"1 1 0",minWidth:0},[`${l}-label.${h}-col-24 + ${l}-control`]:{minWidth:"unset"}}}},KJ=n=>{const{componentCls:o,formItemCls:l}=n;return{[`${o}-inline`]:{display:"flex",flexWrap:"wrap",[l]:{flex:"none",marginInlineEnd:n.margin,marginBottom:0,"&-row":{flexWrap:"nowrap"},"&-with-help":{marginBottom:n.marginLG},[`> ${l}-label,
        > ${l}-control`]:{display:"inline-block",verticalAlign:"top"},[`> ${l}-label`]:{flex:"none"},[`${o}-text`]:{display:"inline-block"},[`${l}-has-feedback`]:{display:"inline-block"}}}}},ih=n=>({padding:`0 0 ${n.paddingXS}px`,whiteSpace:"initial",textAlign:"start","> label":{margin:0,"&::after":{visibility:"hidden"}}}),JJ=n=>{const{componentCls:o,formItemCls:l}=n;return{[`${l} ${l}-label`]:ih(n),[o]:{[l]:{flexWrap:"wrap",[`${l}-label,
          ${l}-control`]:{flex:"0 0 100%",maxWidth:"100%"}}}}},QJ=n=>{const{componentCls:o,formItemCls:l,rootPrefixCls:h}=n;return{[`${o}-vertical`]:{[l]:{"&-row":{flexDirection:"column"},"&-label > label":{height:"auto"},[`${o}-item-control`]:{width:"100%"}}},[`${o}-vertical ${l}-label,
      .${h}-col-24${l}-label,
      .${h}-col-xl-24${l}-label`]:ih(n),[`@media (max-width: ${n.screenXSMax}px)`]:[JJ(n),{[o]:{[`.${h}-col-xs-24${l}-label`]:ih(n)}}],[`@media (max-width: ${n.screenSMMax}px)`]:{[o]:{[`.${h}-col-sm-24${l}-label`]:ih(n)}},[`@media (max-width: ${n.screenMDMax}px)`]:{[o]:{[`.${h}-col-md-24${l}-label`]:ih(n)}},[`@media (max-width: ${n.screenLGMax}px)`]:{[o]:{[`.${h}-col-lg-24${l}-label`]:ih(n)}}}},lE=ba("Form",(n,o)=>{let{rootPrefixCls:l}=o;const h=to(n,{formItemCls:`${n.componentCls}-item`,rootPrefixCls:l});return[ZJ(h),XJ(h),HJ(h),YJ(h),KJ(h),QJ(h),NY(h),sE]}),TP=[];function Gb(n,o,l){let h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;return{key:typeof n=="string"?n:`${o}-${h}`,error:n,errorStatus:l}}const eQ=n=>{let{help:o,helpStatus:l,errors:h=TP,warnings:f=TP,className:g,fieldId:x,onVisibleChanged:E}=n;const{prefixCls:w}=A.useContext(aE),I=`${w}-item-explain`,[,R]=lE(w),D=A.useMemo(()=>HI(w),[w]),F=__(h),q=__(f),G=A.useMemo(()=>o!=null?[Gb(o,"help",l)]:[].concat(Jt(F.map((te,N)=>Gb(te,"error","error",N))),Jt(q.map((te,N)=>Gb(te,"warning","warning",N)))),[o,l,F,q]),j={};return x&&(j.id=`${x}_help`),A.createElement(Yh,{motionDeadline:D.motionDeadline,motionName:`${w}-show-help`,visible:!!G.length,onVisibleChanged:E},te=>{const{className:N,style:O}=te;return A.createElement("div",Object.assign({},j,{className:$t(I,N,g,R),style:O,role:"alert"}),A.createElement(kH,Object.assign({keys:G},HI(w),{motionName:`${w}-show-help-item`,component:!1}),V=>{const{key:U,error:ae,errorStatus:le,className:ne,style:de}=V;return A.createElement("div",{key:U,className:$t(ne,{[`${I}-${le}`]:le}),style:de},ae)}))})},bD=eQ,tQ=["parentNode"],rQ="form_item";function Uf(n){return n===void 0||n===!1?[]:Array.isArray(n)?n:[n]}function wD(n,o){if(!n.length)return;const l=n.join("_");return o?`${o}_${l}`:tQ.includes(l)?`${rQ}_${l}`:l}function MP(n){return Uf(n).join("_")}function ED(n){const[o]=oE(),l=A.useRef({}),h=A.useMemo(()=>n??Object.assign(Object.assign({},o),{__INTERNAL__:{itemRef:f=>g=>{const x=MP(f);g?l.current[x]=g:delete l.current[x]}},scrollToField:function(f){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const x=Uf(f),E=wD(x,h.__INTERNAL__.name),w=E?document.getElementById(E):null;w&&dZ(w,Object.assign({scrollMode:"if-needed",block:"nearest"},g))},getFieldInstance:f=>{const g=MP(f);return l.current[g]}}),[n,o]);return[h]}var nQ=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};const iQ=(n,o)=>{const l=A.useContext(J_),{getPrefixCls:h,direction:f,form:g}=A.useContext(wn),{prefixCls:x,className:E,rootClassName:w,size:I,disabled:R=l,form:D,colon:F,labelAlign:q,labelWrap:G,labelCol:j,wrapperCol:te,hideRequiredMark:N,layout:O="horizontal",scrollToFirstError:V,requiredMark:U,onFinishFailed:ae,name:le,style:ne}=n,de=nQ(n,["prefixCls","className","rootClassName","size","disabled","form","colon","labelAlign","labelWrap","labelCol","wrapperCol","hideRequiredMark","layout","scrollToFirstError","requiredMark","onFinishFailed","name","style"]),$=Q3(I),ue=A.useContext(qz),xe=A.useMemo(()=>U!==void 0?U:g&&g.requiredMark!==void 0?g.requiredMark:!N,[N,U,g]),ce=F??(g==null?void 0:g.colon),se=h("form",x),[ke,$e]=lE(se),Ne=$t(se,`${se}-${O}`,{[`${se}-hide-required-mark`]:xe===!1,[`${se}-rtl`]:f==="rtl",[`${se}-${$}`]:$},$e,g==null?void 0:g.className,E,w),[it]=ED(D),{__INTERNAL__:Re}=it;Re.name=le;const He=A.useMemo(()=>({name:le,labelAlign:q,labelCol:j,labelWrap:G,wrapperCol:te,vertical:O==="vertical",colon:ce,requiredMark:xe,itemRef:Re.itemRef,form:it}),[le,q,j,te,O,ce,xe,it]);A.useImperativeHandle(o,()=>it);const Xe=(at,Pt)=>{if(at){let mt={block:"nearest"};typeof at=="object"&&(mt=at),it.scrollToField(Pt,mt)}},ze=at=>{if(ae==null||ae(at),at.errorFields.length){const Pt=at.errorFields[0].name;if(V!==void 0){Xe(V,Pt);return}g&&g.scrollToFirstError!==void 0&&Xe(g.scrollToFirstError,Pt)}};return ke(A.createElement(s8,{disabled:R},A.createElement(l8,{size:$},A.createElement(sD,{validateMessages:ue},A.createElement(Ll.Provider,{value:He},A.createElement(Qh,Object.assign({id:le},de,{name:le,onFinishFailed:ze,form:it,style:Object.assign(Object.assign({},g==null?void 0:g.style),ne),className:Ne})))))))},oQ=A.forwardRef(iQ),aQ=oQ,SD=()=>{const{status:n,errors:o=[],warnings:l=[]}=A.useContext(oy);return{status:n,errors:o,warnings:l}};SD.Context=oy;const sQ=SD;function lQ(n){const[o,l]=A.useState(n),h=A.useRef(null),f=A.useRef([]),g=A.useRef(!1);A.useEffect(()=>(g.current=!1,()=>{g.current=!0,va.cancel(h.current),h.current=null}),[]);function x(E){g.current||(h.current===null&&(f.current=[],h.current=va(()=>{h.current=null,l(w=>{let I=w;return f.current.forEach(R=>{I=R(I)}),I})})),f.current.push(E))}return[o,x]}function cQ(){const{itemRef:n}=A.useContext(Ll),o=A.useRef({});function l(h,f){const g=f&&typeof f=="object"&&f.ref,x=h.join("_");return(o.current.name!==x||o.current.originRef!==g)&&(o.current.name=x,o.current.originRef=g,o.current.ref=Bc(n(h),g)),o.current.ref}return l}const uQ=n=>{const{prefixCls:o,status:l,wrapperCol:h,children:f,errors:g,warnings:x,_internalItemRender:E,extra:w,help:I,fieldId:R,marginBottom:D,onErrorVisibleChanged:F}=n,q=`${o}-item`,G=A.useContext(Ll),j=h||G.wrapperCol||{},te=$t(`${q}-control`,j.className),N=A.useMemo(()=>Object.assign({},G),[G]);delete N.labelCol,delete N.wrapperCol;const O=A.createElement("div",{className:`${q}-control-input`},A.createElement("div",{className:`${q}-control-input-content`},f)),V=A.useMemo(()=>({prefixCls:o,status:l}),[o,l]),U=D!==null||g.length||x.length?A.createElement("div",{style:{display:"flex",flexWrap:"nowrap"}},A.createElement(aE.Provider,{value:V},A.createElement(bD,{fieldId:R,errors:g,warnings:x,help:I,helpStatus:l,className:`${q}-explain-connected`,onVisibleChanged:F})),!!D&&A.createElement("div",{style:{width:0,height:D}})):null,ae={};R&&(ae.id=`${R}_extra`);const le=w?A.createElement("div",Object.assign({},ae,{className:`${q}-extra`}),w):null,ne=E&&E.mark==="pro_table_render"&&E.render?E.render(n,{input:O,errorList:U,extra:le}):A.createElement(A.Fragment,null,O,U,le);return A.createElement(Ll.Provider,{value:N},A.createElement(vD,Object.assign({},j,{className:te}),ne))},hQ=uQ;var dQ={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z"}},{tag:"path",attrs:{d:"M623.6 316.7C593.6 290.4 554 276 512 276s-81.6 14.5-111.6 40.7C369.2 344 352 380.7 352 420v7.6c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V420c0-44.1 43.1-80 96-80s96 35.9 96 80c0 31.1-22 59.6-56.1 72.7-21.2 8.1-39.2 22.3-52.1 40.9-13.1 19-19.9 41.8-19.9 64.9V620c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8v-22.7a48.3 48.3 0 0130.9-44.8c59-22.7 97.1-74.7 97.1-132.5.1-39.3-17.1-76-48.3-103.3zM472 732a40 40 0 1080 0 40 40 0 10-80 0z"}}]},name:"question-circle",theme:"outlined"};const fQ=dQ;var pQ=function(o,l){return A.createElement(Uc,ui({},o,{ref:l,icon:fQ}))};const mQ=A.forwardRef(pQ);var gQ=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};function _Q(n){return n?typeof n=="object"&&!A.isValidElement(n)?n:{title:n}:null}const yQ=n=>{let{prefixCls:o,label:l,htmlFor:h,labelCol:f,labelAlign:g,colon:x,required:E,requiredMark:w,tooltip:I}=n;var R;const[D]=vW("Form"),{vertical:F,labelAlign:q,labelCol:G,labelWrap:j,colon:te}=A.useContext(Ll);if(!l)return null;const N=f||G||{},O=g||q,V=`${o}-item-label`,U=$t(V,O==="left"&&`${V}-left`,N.className,{[`${V}-wrap`]:!!j});let ae=l;const le=x===!0||te!==!1&&x!==!1;le&&!F&&typeof l=="string"&&l.trim()!==""&&(ae=l.replace(/[:|：]\s*$/,""));const de=_Q(I);if(de){const{icon:ue=A.createElement(mQ,null)}=de,xe=gQ(de,["icon"]),ce=A.createElement(RK,Object.assign({},xe),A.cloneElement(ue,{className:`${o}-item-tooltip`,title:""}));ae=A.createElement(A.Fragment,null,ae,ce)}w==="optional"&&!E&&(ae=A.createElement(A.Fragment,null,ae,A.createElement("span",{className:`${o}-item-optional`,title:""},(D==null?void 0:D.optional)||((R=zc.Form)===null||R===void 0?void 0:R.optional))));const $=$t({[`${o}-item-required`]:E,[`${o}-item-required-mark-optional`]:w==="optional",[`${o}-item-no-colon`]:!le});return A.createElement(vD,Object.assign({},N,{className:U}),A.createElement("label",{htmlFor:h,className:$,title:typeof l=="string"?l:""},ae))},vQ=yQ;var xQ=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};const bQ={success:j8,warning:V8,error:$8,validating:Y3};function wQ(n){const{prefixCls:o,className:l,rootClassName:h,style:f,help:g,errors:x,warnings:E,validateStatus:w,meta:I,hasFeedback:R,hidden:D,children:F,fieldId:q,required:G,isRequired:j,onSubItemMetaChange:te}=n,N=xQ(n,["prefixCls","className","rootClassName","style","help","errors","warnings","validateStatus","meta","hasFeedback","hidden","children","fieldId","required","isRequired","onSubItemMetaChange"]),O=`${o}-item`,{requiredMark:V}=A.useContext(Ll),U=A.useRef(null),ae=__(x),le=__(E),ne=g!=null,de=!!(ne||x.length||E.length),$=!!U.current&&K3(U.current),[ue,xe]=A.useState(null);Ti(()=>{if(de&&U.current){const it=getComputedStyle(U.current);xe(parseInt(it.marginBottom,10))}},[de,$]);const ce=it=>{it||xe(null)},ke=function(){let it=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Re="";const He=it?ae:I.errors,Xe=it?le:I.warnings;return w!==void 0?Re=w:I.validating?Re="validating":He.length?Re="error":Xe.length?Re="warning":(I.touched||R&&I.validated)&&(Re="success"),Re}(),$e=A.useMemo(()=>{let it;if(R){const Re=ke&&bQ[ke];it=Re?A.createElement("span",{className:$t(`${O}-feedback-icon`,`${O}-feedback-icon-${ke}`)},A.createElement(Re,null)):null}return{status:ke,errors:x,warnings:E,hasFeedback:R,feedbackIcon:it,isFormItemInput:!0}},[ke,R]),Ne=$t(O,l,h,{[`${O}-with-help`]:ne||ae.length||le.length,[`${O}-has-feedback`]:ke&&R,[`${O}-has-success`]:ke==="success",[`${O}-has-warning`]:ke==="warning",[`${O}-has-error`]:ke==="error",[`${O}-is-validating`]:ke==="validating",[`${O}-hidden`]:D});return A.createElement("div",{className:Ne,style:f,ref:U},A.createElement(jJ,Object.assign({className:`${O}-row`},$c(N,["_internalItemRender","colon","dependencies","extra","fieldKey","getValueFromEvent","getValueProps","htmlFor","id","initialValue","isListField","label","labelAlign","labelCol","labelWrap","messageVariables","name","normalize","noStyle","preserve","requiredMark","rules","shouldUpdate","trigger","tooltip","validateFirst","validateTrigger","valuePropName","wrapperCol"])),A.createElement(vQ,Object.assign({htmlFor:q},n,{requiredMark:V,required:G??j,prefixCls:o})),A.createElement(hQ,Object.assign({},n,I,{errors:ae,warnings:le,prefixCls:o,status:ke,help:g,marginBottom:ue,onErrorVisibleChanged:ce}),A.createElement(aD.Provider,{value:te},A.createElement(oy.Provider,{value:$e},F)))),!!ue&&A.createElement("div",{className:`${O}-margin-offset`,style:{marginBottom:-ue}}))}function EQ(n){if(typeof n=="function")return n;const o=Wf(n);return o.length<=1?o[0]:o}const SQ="__SPLIT__",TQ=A.memo(n=>{let{children:o}=n;return o},(n,o)=>n.value===o.value&&n.update===o.update&&n.childProps.length===o.childProps.length&&n.childProps.every((l,h)=>l===o.childProps[h]));function MQ(n){return n!=null}function CP(){return{errors:[],warnings:[],touched:!1,validating:!1,name:[],validated:!1}}function CQ(n){const{name:o,noStyle:l,className:h,dependencies:f,prefixCls:g,shouldUpdate:x,rules:E,children:w,required:I,label:R,messageVariables:D,trigger:F="onChange",validateTrigger:q,hidden:G,help:j}=n,{getPrefixCls:te}=A.useContext(wn),{name:N}=A.useContext(Ll),O=EQ(w),V=typeof O=="function",U=A.useContext(aD),{validateTrigger:ae}=A.useContext(Lc),le=q!==void 0?q:ae,ne=MQ(o),de=te("form",g),[$,ue]=lE(de),xe=A.useContext(fp),ce=A.useRef(),[se,ke]=lQ({}),[$e,Ne]=Cc(()=>CP()),it=mt=>{const kt=xe==null?void 0:xe.getKey(mt.name);if(Ne(mt.destroy?CP():mt,!0),l&&j!==!1&&U){let Oe=mt.name;if(mt.destroy)Oe=ce.current||Oe;else if(kt!==void 0){const[qt,Sr]=kt;Oe=[qt].concat(Jt(Sr)),ce.current=Oe}U(mt,Oe)}},Re=(mt,kt)=>{ke(Oe=>{const qt=Object.assign({},Oe),Ir=[].concat(Jt(mt.name.slice(0,-1)),Jt(kt)).join(SQ);return mt.destroy?delete qt[Ir]:qt[Ir]=mt,qt})},[He,Xe]=A.useMemo(()=>{const mt=Jt($e.errors),kt=Jt($e.warnings);return Object.values(se).forEach(Oe=>{mt.push.apply(mt,Jt(Oe.errors||[])),kt.push.apply(kt,Jt(Oe.warnings||[]))}),[mt,kt]},[se,$e.errors,$e.warnings]),ze=cQ();function at(mt,kt,Oe){return l&&!G?mt:A.createElement(wQ,Object.assign({key:"row"},n,{className:$t(h,ue),prefixCls:de,fieldId:kt,isRequired:Oe,errors:He,warnings:Xe,meta:$e,onSubItemMetaChange:Re}),mt)}if(!ne&&!V&&!f)return $(at(O));let Pt={};return typeof R=="string"?Pt.label=R:o&&(Pt.label=String(o)),D&&(Pt=Object.assign(Object.assign({},Pt),D)),$(A.createElement(iE,Object.assign({},n,{messageVariables:Pt,trigger:F,validateTrigger:le,onMetaChange:it}),(mt,kt,Oe)=>{const qt=Uf(o).length&&kt?kt.name:[],Sr=wD(qt,N),Ir=I!==void 0?I:!!(E&&E.some(pr=>{if(pr&&typeof pr=="object"&&pr.required&&!pr.warningOnly)return!0;if(typeof pr=="function"){const ar=pr(Oe);return ar&&ar.required&&!ar.warningOnly}return!1})),Xr=Object.assign({},mt);let Ur=null;if(Array.isArray(O)&&ne)Ur=O;else if(!(V&&(!(x||f)||ne))){if(!(f&&!V&&!ne))if(Vh(O)){const pr=Object.assign(Object.assign({},O.props),Xr);if(pr.id||(pr.id=Sr),j||He.length>0||Xe.length>0||n.extra){const xr=[];(j||He.length>0)&&xr.push(`${Sr}_help`),n.extra&&xr.push(`${Sr}_extra`),pr["aria-describedby"]=xr.join(" ")}He.length>0&&(pr["aria-invalid"]="true"),Ir&&(pr["aria-required"]="true"),Hh(O)&&(pr.ref=ze(qt,O)),new Set([].concat(Jt(Uf(F)),Jt(Uf(le)))).forEach(xr=>{pr[xr]=function(){for(var Fe,Y,ee,re,we,Ie=arguments.length,Qe=new Array(Ie),tt=0;tt<Ie;tt++)Qe[tt]=arguments[tt];(ee=Xr[xr])===null||ee===void 0||(Fe=ee).call.apply(Fe,[Xr].concat(Qe)),(we=(re=O.props)[xr])===null||we===void 0||(Y=we).call.apply(Y,[re].concat(Qe))}});const hr=[pr["aria-required"],pr["aria-invalid"],pr["aria-describedby"]];Ur=A.createElement(TQ,{value:Xr[n.valuePropName||"value"],update:O,childProps:hr},Dc(O,pr))}else V&&(x||f)&&!ne?Ur=O(Oe):Ur=O}return at(Ur,Sr,Ir)}))}const TD=CQ;TD.useStatus=sQ;const AQ=TD;var IQ=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};const PQ=n=>{var{prefixCls:o,children:l}=n,h=IQ(n,["prefixCls","children"]);const{getPrefixCls:f}=A.useContext(wn),g=f("form",o),x=A.useMemo(()=>({prefixCls:g,status:"error"}),[g]);return A.createElement(rD,Object.assign({},h),(E,w,I)=>A.createElement(aE.Provider,{value:x},l(E.map(R=>Object.assign(Object.assign({},R),{fieldKey:R.key})),w,{errors:I.errors,warnings:I.warnings})))},kQ=PQ;function RQ(){const{form:n}=A.useContext(Ll);return n}const Cs=aQ;Cs.Item=AQ;Cs.List=kQ;Cs.ErrorList=bD;Cs.useForm=ED;Cs.useFormInstance=RQ;Cs.useWatch=oD;Cs.Provider=sD;Cs.create=()=>{};const ml=Cs,zQ=new Ni("antSpinMove",{to:{opacity:1}}),DQ=new Ni("antRotate",{to:{transform:"rotate(405deg)"}}),LQ=n=>({[`${n.componentCls}`]:Object.assign(Object.assign({},Dl(n)),{position:"absolute",display:"none",color:n.colorPrimary,fontSize:0,textAlign:"center",verticalAlign:"middle",opacity:0,transition:`transform ${n.motionDurationSlow} ${n.motionEaseInOutCirc}`,"&-spinning":{position:"static",display:"inline-block",opacity:1},"&-nested-loading":{position:"relative",[`> div > ${n.componentCls}`]:{position:"absolute",top:0,insetInlineStart:0,zIndex:4,display:"block",width:"100%",height:"100%",maxHeight:n.contentHeight,[`${n.componentCls}-dot`]:{position:"absolute",top:"50%",insetInlineStart:"50%",margin:-n.spinDotSize/2},[`${n.componentCls}-text`]:{position:"absolute",top:"50%",width:"100%",paddingTop:(n.spinDotSize-n.fontSize)/2+2,textShadow:`0 1px 2px ${n.colorBgContainer}`,fontSize:n.fontSize},[`&${n.componentCls}-show-text ${n.componentCls}-dot`]:{marginTop:-(n.spinDotSize/2)-10},"&-sm":{[`${n.componentCls}-dot`]:{margin:-n.spinDotSizeSM/2},[`${n.componentCls}-text`]:{paddingTop:(n.spinDotSizeSM-n.fontSize)/2+2},[`&${n.componentCls}-show-text ${n.componentCls}-dot`]:{marginTop:-(n.spinDotSizeSM/2)-10}},"&-lg":{[`${n.componentCls}-dot`]:{margin:-(n.spinDotSizeLG/2)},[`${n.componentCls}-text`]:{paddingTop:(n.spinDotSizeLG-n.fontSize)/2+2},[`&${n.componentCls}-show-text ${n.componentCls}-dot`]:{marginTop:-(n.spinDotSizeLG/2)-10}}},[`${n.componentCls}-container`]:{position:"relative",transition:`opacity ${n.motionDurationSlow}`,"&::after":{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,zIndex:10,width:"100%",height:"100%",background:n.colorBgContainer,opacity:0,transition:`all ${n.motionDurationSlow}`,content:'""',pointerEvents:"none"}},[`${n.componentCls}-blur`]:{clear:"both",opacity:.5,userSelect:"none",pointerEvents:"none","&::after":{opacity:.4,pointerEvents:"auto"}}},"&-tip":{color:n.spinDotDefault},[`${n.componentCls}-dot`]:{position:"relative",display:"inline-block",fontSize:n.spinDotSize,width:"1em",height:"1em","&-item":{position:"absolute",display:"block",width:(n.spinDotSize-n.marginXXS/2)/2,height:(n.spinDotSize-n.marginXXS/2)/2,backgroundColor:n.colorPrimary,borderRadius:"100%",transform:"scale(0.75)",transformOrigin:"50% 50%",opacity:.3,animationName:zQ,animationDuration:"1s",animationIterationCount:"infinite",animationTimingFunction:"linear",animationDirection:"alternate","&:nth-child(1)":{top:0,insetInlineStart:0},"&:nth-child(2)":{top:0,insetInlineEnd:0,animationDelay:"0.4s"},"&:nth-child(3)":{insetInlineEnd:0,bottom:0,animationDelay:"0.8s"},"&:nth-child(4)":{bottom:0,insetInlineStart:0,animationDelay:"1.2s"}},"&-spin":{transform:"rotate(45deg)",animationName:DQ,animationDuration:"1.2s",animationIterationCount:"infinite",animationTimingFunction:"linear"}},[`&-sm ${n.componentCls}-dot`]:{fontSize:n.spinDotSizeSM,i:{width:(n.spinDotSizeSM-n.marginXXS/2)/2,height:(n.spinDotSizeSM-n.marginXXS/2)/2}},[`&-lg ${n.componentCls}-dot`]:{fontSize:n.spinDotSizeLG,i:{width:(n.spinDotSizeLG-n.marginXXS)/2,height:(n.spinDotSizeLG-n.marginXXS)/2}},[`&${n.componentCls}-show-text ${n.componentCls}-text`]:{display:"block"}})}),OQ=ba("Spin",n=>{const o=to(n,{spinDotDefault:n.colorTextDescription,spinDotSize:n.controlHeightLG/2,spinDotSizeSM:n.controlHeightLG*.35,spinDotSizeLG:n.controlHeight});return[LQ(o)]},{contentHeight:400});var FQ=globalThis&&globalThis.__rest||function(n,o){var l={};for(var h in n)Object.prototype.hasOwnProperty.call(n,h)&&o.indexOf(h)<0&&(l[h]=n[h]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var f=0,h=Object.getOwnPropertySymbols(n);f<h.length;f++)o.indexOf(h[f])<0&&Object.prototype.propertyIsEnumerable.call(n,h[f])&&(l[h[f]]=n[h[f]]);return l};let R0=null;function BQ(n,o){const{indicator:l}=o,h=`${n}-dot`;return l===null?null:Vh(l)?Dc(l,{className:$t(l.props.className,h)}):Vh(R0)?Dc(R0,{className:$t(R0.props.className,h)}):A.createElement("span",{className:$t(h,`${n}-dot-spin`)},A.createElement("i",{className:`${n}-dot-item`,key:1}),A.createElement("i",{className:`${n}-dot-item`,key:2}),A.createElement("i",{className:`${n}-dot-item`,key:3}),A.createElement("i",{className:`${n}-dot-item`,key:4}))}function NQ(n,o){return!!n&&!!o&&!isNaN(Number(o))}const jQ=n=>{const{spinPrefixCls:o,spinning:l=!0,delay:h=0,className:f,rootClassName:g,size:x="default",tip:E,wrapperClassName:w,style:I,children:R,hashId:D}=n,F=FQ(n,["spinPrefixCls","spinning","delay","className","rootClassName","size","tip","wrapperClassName","style","children","hashId"]),[q,G]=A.useState(()=>l&&!NQ(l,h));A.useEffect(()=>{if(l){const ne=TJ(h,()=>{G(!0)});return ne(),()=>{var de;(de=ne==null?void 0:ne.cancel)===null||de===void 0||de.call(ne)}}G(!1)},[h,l]);const j=A.useMemo(()=>typeof R<"u",[R]),{direction:te,spin:N}=A.useContext(wn),O=$t(o,N==null?void 0:N.className,{[`${o}-sm`]:x==="small",[`${o}-lg`]:x==="large",[`${o}-spinning`]:q,[`${o}-show-text`]:!!E,[`${o}-rtl`]:te==="rtl"},f,g,D),V=$t(`${o}-container`,{[`${o}-blur`]:q}),U=$c(F,["indicator","prefixCls"]),ae=Object.assign(Object.assign({},N==null?void 0:N.style),I),le=A.createElement("div",Object.assign({},U,{style:ae,className:O,"aria-live":"polite","aria-busy":q}),BQ(o,n),E&&j?A.createElement("div",{className:`${o}-text`},E):null);return j?A.createElement("div",Object.assign({},U,{className:$t(`${o}-nested-loading`,w,D)}),q&&A.createElement("div",{key:"loading"},le),A.createElement("div",{className:V,key:"container"},R)):le},MD=n=>{const{prefixCls:o}=n,{getPrefixCls:l}=A.useContext(wn),h=l("spin",o),[f,g]=OQ(h),x=Object.assign(Object.assign({},n),{spinPrefixCls:h,hashId:g});return f(A.createElement(jQ,Object.assign({},x)))};MD.setDefaultIndicator=n=>{R0=n};const $Q=MD;var VQ={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M955.7 856l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zM480 416c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v184c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V416zm32 352a48.01 48.01 0 010-96 48.01 48.01 0 010 96z"}}]},name:"warning",theme:"filled"};const UQ=VQ;var GQ=function(o,l){return A.createElement(Uc,ui({},o,{ref:l,icon:UQ}))};const WQ=A.forwardRef(GQ),HQ=()=>A.createElement("svg",{width:"252",height:"294"},A.createElement("defs",null,A.createElement("path",{d:"M0 .387h251.772v251.772H0z"})),A.createElement("g",{fill:"none",fillRule:"evenodd"},A.createElement("g",{transform:"translate(0 .012)"},A.createElement("mask",{fill:"#fff"}),A.createElement("path",{d:"M0 127.32v-2.095C0 56.279 55.892.387 124.838.387h2.096c68.946 0 124.838 55.892 124.838 124.838v2.096c0 68.946-55.892 124.838-124.838 124.838h-2.096C55.892 252.16 0 196.267 0 127.321",fill:"#E4EBF7",mask:"url(#b)"})),A.createElement("path",{d:"M39.755 130.84a8.276 8.276 0 1 1-16.468-1.66 8.276 8.276 0 0 1 16.468 1.66",fill:"#FFF"}),A.createElement("path",{d:"M36.975 134.297l10.482 5.943M48.373 146.508l-12.648 10.788",stroke:"#FFF",strokeWidth:"2"}),A.createElement("path",{d:"M39.875 159.352a5.667 5.667 0 1 1-11.277-1.136 5.667 5.667 0 0 1 11.277 1.136M57.588 143.247a5.708 5.708 0 1 1-11.358-1.145 5.708 5.708 0 0 1 11.358 1.145M99.018 26.875l29.82-.014a4.587 4.587 0 1 0-.003-9.175l-29.82.013a4.587 4.587 0 1 0 .003 9.176M110.424 45.211l29.82-.013a4.588 4.588 0 0 0-.004-9.175l-29.82.013a4.587 4.587 0 1 0 .004 9.175",fill:"#FFF"}),A.createElement("path",{d:"M112.798 26.861v-.002l15.784-.006a4.588 4.588 0 1 0 .003 9.175l-15.783.007v-.002a4.586 4.586 0 0 0-.004-9.172M184.523 135.668c-.553 5.485-5.447 9.483-10.931 8.93-5.485-.553-9.483-5.448-8.93-10.932.552-5.485 5.447-9.483 10.932-8.93 5.485.553 9.483 5.447 8.93 10.932",fill:"#FFF"}),A.createElement("path",{d:"M179.26 141.75l12.64 7.167M193.006 156.477l-15.255 13.011",stroke:"#FFF",strokeWidth:"2"}),A.createElement("path",{d:"M184.668 170.057a6.835 6.835 0 1 1-13.6-1.372 6.835 6.835 0 0 1 13.6 1.372M203.34 153.325a6.885 6.885 0 1 1-13.7-1.382 6.885 6.885 0 0 1 13.7 1.382",fill:"#FFF"}),A.createElement("path",{d:"M151.931 192.324a2.222 2.222 0 1 1-4.444 0 2.222 2.222 0 0 1 4.444 0zM225.27 116.056a2.222 2.222 0 1 1-4.445 0 2.222 2.222 0 0 1 4.444 0zM216.38 151.08a2.223 2.223 0 1 1-4.446-.001 2.223 2.223 0 0 1 4.446 0zM176.917 107.636a2.223 2.223 0 1 1-4.445 0 2.223 2.223 0 0 1 4.445 0zM195.291 92.165a2.223 2.223 0 1 1-4.445 0 2.223 2.223 0 0 1 4.445 0zM202.058 180.711a2.223 2.223 0 1 1-4.446 0 2.223 2.223 0 0 1 4.446 0z",stroke:"#FFF",strokeWidth:"2"}),A.createElement("path",{stroke:"#FFF",strokeWidth:"2",d:"M214.404 153.302l-1.912 20.184-10.928 5.99M173.661 174.792l-6.356 9.814h-11.36l-4.508 6.484M174.941 125.168v-15.804M220.824 117.25l-12.84 7.901-15.31-7.902V94.39"}),A.createElement("path",{d:"M166.588 65.936h-3.951a4.756 4.756 0 0 1-4.743-4.742 4.756 4.756 0 0 1 4.743-4.743h3.951a4.756 4.756 0 0 1 4.743 4.743 4.756 4.756 0 0 1-4.743 4.742",fill:"#FFF"}),A.createElement("path",{d:"M174.823 30.03c0-16.281 13.198-29.48 29.48-29.48 16.28 0 29.48 13.199 29.48 29.48 0 16.28-13.2 29.48-29.48 29.48-16.282 0-29.48-13.2-29.48-29.48",fill:"#1677ff"}),A.createElement("path",{d:"M205.952 38.387c.5.5.785 1.142.785 1.928s-.286 1.465-.785 1.964c-.572.5-1.214.75-2 .75-.785 0-1.429-.285-1.929-.785-.572-.5-.82-1.143-.82-1.929s.248-1.428.82-1.928c.5-.5 1.144-.75 1.93-.75.785 0 1.462.25 1.999.75m4.285-19.463c1.428 1.249 2.143 2.963 2.143 5.142 0 1.712-.427 3.13-1.219 4.25-.067.096-.137.18-.218.265-.416.429-1.41 1.346-2.956 2.699a5.07 5.07 0 0 0-1.428 1.75 5.207 5.207 0 0 0-.536 2.357v.5h-4.107v-.5c0-1.357.215-2.536.714-3.5.464-.964 1.857-2.464 4.178-4.536l.43-.5c.643-.785.964-1.643.964-2.535 0-1.18-.358-2.108-1-2.785-.678-.68-1.643-1.001-2.858-1.001-1.536 0-2.642.464-3.357 1.43-.37.5-.621 1.135-.76 1.904a1.999 1.999 0 0 1-1.971 1.63h-.004c-1.277 0-2.257-1.183-1.98-2.43.337-1.518 1.02-2.78 2.073-3.784 1.536-1.5 3.607-2.25 6.25-2.25 2.32 0 4.214.607 5.642 1.894",fill:"#FFF"}),A.createElement("path",{d:"M52.04 76.131s21.81 5.36 27.307 15.945c5.575 10.74-6.352 9.26-15.73 4.935-10.86-5.008-24.7-11.822-11.577-20.88",fill:"#FFB594"}),A.createElement("path",{d:"M90.483 67.504l-.449 2.893c-.753.49-4.748-2.663-4.748-2.663l-1.645.748-1.346-5.684s6.815-4.589 8.917-5.018c2.452-.501 9.884.94 10.7 2.278 0 0 1.32.486-2.227.69-3.548.203-5.043.447-6.79 3.132-1.747 2.686-2.412 3.624-2.412 3.624",fill:"#FFC6A0"}),A.createElement("path",{d:"M128.055 111.367c-2.627-7.724-6.15-13.18-8.917-15.478-3.5-2.906-9.34-2.225-11.366-4.187-1.27-1.231-3.215-1.197-3.215-1.197s-14.98-3.158-16.828-3.479c-2.37-.41-2.124-.714-6.054-1.405-1.57-1.907-2.917-1.122-2.917-1.122l-7.11-1.383c-.853-1.472-2.423-1.023-2.423-1.023l-2.468-.897c-1.645 9.976-7.74 13.796-7.74 13.796 1.795 1.122 15.703 8.3 15.703 8.3l5.107 37.11s-3.321 5.694 1.346 9.109c0 0 19.883-3.743 34.921-.329 0 0 3.047-2.546.972-8.806.523-3.01 1.394-8.263 1.736-11.622.385.772 2.019 1.918 3.14 3.477 0 0 9.407-7.365 11.052-14.012-.832-.723-1.598-1.585-2.267-2.453-.567-.736-.358-2.056-.765-2.717-.669-1.084-1.804-1.378-1.907-1.682",fill:"#FFF"}),A.createElement("path",{d:"M101.09 289.998s4.295 2.041 7.354 1.021c2.821-.94 4.53.668 7.08 1.178 2.55.51 6.874 1.1 11.686-1.26-.103-5.51-6.889-3.98-11.96-6.713-2.563-1.38-3.784-4.722-3.598-8.799h-9.402s-1.392 10.52-1.16 14.573",fill:"#CBD1D1"}),A.createElement("path",{d:"M101.067 289.826s2.428 1.271 6.759.653c3.058-.437 3.712.481 7.423 1.031 3.712.55 10.724-.069 11.823-.894.413 1.1-.343 2.063-.343 2.063s-1.512.603-4.812.824c-2.03.136-5.8.291-7.607-.503-1.787-1.375-5.247-1.903-5.728-.241-3.918.95-7.355-.286-7.355-.286l-.16-2.647z",fill:"#2B0849"}),A.createElement("path",{d:"M108.341 276.044h3.094s-.103 6.702 4.536 8.558c-4.64.618-8.558-2.303-7.63-8.558",fill:"#A4AABA"}),A.createElement("path",{d:"M57.542 272.401s-2.107 7.416-4.485 12.306c-1.798 3.695-4.225 7.492 5.465 7.492 6.648 0 8.953-.48 7.423-6.599-1.53-6.12.266-13.199.266-13.199h-8.669z",fill:"#CBD1D1"}),A.createElement("path",{d:"M51.476 289.793s2.097 1.169 6.633 1.169c6.083 0 8.249-1.65 8.249-1.65s.602 1.114-.619 2.165c-.993.855-3.597 1.591-7.39 1.546-4.145-.048-5.832-.566-6.736-1.168-.825-.55-.687-1.58-.137-2.062",fill:"#2B0849"}),A.createElement("path",{d:"M58.419 274.304s.033 1.519-.314 2.93c-.349 1.42-1.078 3.104-1.13 4.139-.058 1.151 4.537 1.58 5.155.034.62-1.547 1.294-6.427 1.913-7.252.619-.825-4.903-2.119-5.624.15",fill:"#A4AABA"}),A.createElement("path",{d:"M99.66 278.514l13.378.092s1.298-54.52 1.853-64.403c.554-9.882 3.776-43.364 1.002-63.128l-12.547-.644-22.849.78s-.434 3.966-1.195 9.976c-.063.496-.682.843-.749 1.365-.075.585.423 1.354.32 1.966-2.364 14.08-6.377 33.104-8.744 46.677-.116.666-1.234 1.009-1.458 2.691-.04.302.211 1.525.112 1.795-6.873 18.744-10.949 47.842-14.277 61.885l14.607-.014s2.197-8.57 4.03-16.97c2.811-12.886 23.111-85.01 23.111-85.01l3.016-.521 1.043 46.35s-.224 1.234.337 2.02c.56.785-.56 1.123-.392 2.244l.392 1.794s-.449 7.178-.898 11.89c-.448 4.71-.092 39.165-.092 39.165",fill:"#7BB2F9"}),A.createElement("path",{d:"M76.085 221.626c1.153.094 4.038-2.019 6.955-4.935M106.36 225.142s2.774-1.11 6.103-3.883",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M107.275 222.1s2.773-1.11 6.102-3.884",stroke:"#648BD8",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M74.74 224.767s2.622-.591 6.505-3.365M86.03 151.634c-.27 3.106.3 8.525-4.336 9.123M103.625 149.88s.11 14.012-1.293 15.065c-2.219 1.664-2.99 1.944-2.99 1.944M99.79 150.438s.035 12.88-1.196 24.377M93.673 175.911s7.212-1.664 9.431-1.664M74.31 205.861a212.013 212.013 0 0 1-.979 4.56s-1.458 1.832-1.009 3.776c.449 1.944-.947 2.045-4.985 15.355-1.696 5.59-4.49 18.591-6.348 27.597l-.231 1.12M75.689 197.807a320.934 320.934 0 0 1-.882 4.754M82.591 152.233L81.395 162.7s-1.097.15-.5 2.244c.113 1.346-2.674 15.775-5.18 30.43M56.12 274.418h13.31",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M116.241 148.22s-17.047-3.104-35.893.2c.158 2.514-.003 4.15-.003 4.15s14.687-2.818 35.67-.312c.252-2.355.226-4.038.226-4.038",fill:"#192064"}),A.createElement("path",{d:"M106.322 151.165l.003-4.911a.81.81 0 0 0-.778-.815c-2.44-.091-5.066-.108-7.836-.014a.818.818 0 0 0-.789.815l-.003 4.906a.81.81 0 0 0 .831.813c2.385-.06 4.973-.064 7.73.017a.815.815 0 0 0 .842-.81",fill:"#FFF"}),A.createElement("path",{d:"M105.207 150.233l.002-3.076a.642.642 0 0 0-.619-.646 94.321 94.321 0 0 0-5.866-.01.65.65 0 0 0-.63.647v3.072a.64.64 0 0 0 .654.644 121.12 121.12 0 0 1 5.794.011c.362.01.665-.28.665-.642",fill:"#192064"}),A.createElement("path",{d:"M100.263 275.415h12.338M101.436 270.53c.006 3.387.042 5.79.111 6.506M101.451 264.548a915.75 915.75 0 0 0-.015 4.337M100.986 174.965l.898 44.642s.673 1.57-.225 2.692c-.897 1.122 2.468.673.898 2.243-1.57 1.57.897 1.122 0 3.365-.596 1.489-.994 21.1-1.096 35.146",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M46.876 83.427s-.516 6.045 7.223 5.552c11.2-.712 9.218-9.345 31.54-21.655-.786-2.708-2.447-4.744-2.447-4.744s-11.068 3.11-22.584 8.046c-6.766 2.9-13.395 6.352-13.732 12.801M104.46 91.057l.941-5.372-8.884-11.43-5.037 5.372-1.74 7.834a.321.321 0 0 0 .108.32c.965.8 6.5 5.013 14.347 3.544a.332.332 0 0 0 .264-.268",fill:"#FFC6A0"}),A.createElement("path",{d:"M93.942 79.387s-4.533-2.853-2.432-6.855c1.623-3.09 4.513 1.133 4.513 1.133s.52-3.642 3.121-3.642c.52-1.04 1.561-4.162 1.561-4.162s11.445 2.601 13.526 3.121c0 5.203-2.304 19.424-7.84 19.861-8.892.703-12.449-9.456-12.449-9.456",fill:"#FFC6A0"}),A.createElement("path",{d:"M113.874 73.446c2.601-2.081 3.47-9.722 3.47-9.722s-2.479-.49-6.64-2.05c-4.683-2.081-12.798-4.747-17.48.976-9.668 3.223-2.05 19.823-2.05 19.823l2.713-3.021s-3.935-3.287-2.08-6.243c2.17-3.462 3.92 1.073 3.92 1.073s.637-2.387 3.581-3.342c.355-.71 1.036-2.674 1.432-3.85a1.073 1.073 0 0 1 1.263-.704c2.4.558 8.677 2.019 11.356 2.662.522.125.871.615.82 1.15l-.305 3.248z",fill:"#520038"}),A.createElement("path",{d:"M104.977 76.064c-.103.61-.582 1.038-1.07.956-.489-.083-.801-.644-.698-1.254.103-.61.582-1.038 1.07-.956.488.082.8.644.698 1.254M112.132 77.694c-.103.61-.582 1.038-1.07.956-.488-.083-.8-.644-.698-1.254.103-.61.582-1.038 1.07-.956.488.082.8.643.698 1.254",fill:"#552950"}),A.createElement("path",{stroke:"#DB836E",strokeWidth:"1.118",strokeLinecap:"round",strokeLinejoin:"round",d:"M110.13 74.84l-.896 1.61-.298 4.357h-2.228"}),A.createElement("path",{d:"M110.846 74.481s1.79-.716 2.506.537",stroke:"#5C2552",strokeWidth:"1.118",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M92.386 74.282s.477-1.114 1.113-.716c.637.398 1.274 1.433.558 1.99-.717.556.159 1.67.159 1.67",stroke:"#DB836E",strokeWidth:"1.118",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M103.287 72.93s1.83 1.113 4.137.954",stroke:"#5C2552",strokeWidth:"1.118",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M103.685 81.762s2.227 1.193 4.376 1.193M104.64 84.308s.954.398 1.511.318M94.693 81.205s2.308 7.4 10.424 7.639",stroke:"#DB836E",strokeWidth:"1.118",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M81.45 89.384s.45 5.647-4.935 12.787M69 82.654s-.726 9.282-8.204 14.206",stroke:"#E4EBF7",strokeWidth:"1.101",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M129.405 122.865s-5.272 7.403-9.422 10.768",stroke:"#E4EBF7",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M119.306 107.329s.452 4.366-2.127 32.062",stroke:"#E4EBF7",strokeWidth:"1.101",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M150.028 151.232h-49.837a1.01 1.01 0 0 1-1.01-1.01v-31.688c0-.557.452-1.01 1.01-1.01h49.837c.558 0 1.01.453 1.01 1.01v31.688a1.01 1.01 0 0 1-1.01 1.01",fill:"#F2D7AD"}),A.createElement("path",{d:"M150.29 151.232h-19.863v-33.707h20.784v32.786a.92.92 0 0 1-.92.92",fill:"#F4D19D"}),A.createElement("path",{d:"M123.554 127.896H92.917a.518.518 0 0 1-.425-.816l6.38-9.113c.193-.277.51-.442.85-.442h31.092l-7.26 10.371z",fill:"#F2D7AD"}),A.createElement("path",{fill:"#CC9B6E",d:"M123.689 128.447H99.25v-.519h24.169l7.183-10.26.424.298z"}),A.createElement("path",{d:"M158.298 127.896h-18.669a2.073 2.073 0 0 1-1.659-.83l-7.156-9.541h19.965c.49 0 .95.23 1.244.622l6.69 8.92a.519.519 0 0 1-.415.83",fill:"#F4D19D"}),A.createElement("path",{fill:"#CC9B6E",d:"M157.847 128.479h-19.384l-7.857-10.475.415-.31 7.7 10.266h19.126zM130.554 150.685l-.032-8.177.519-.002.032 8.177z"}),A.createElement("path",{fill:"#CC9B6E",d:"M130.511 139.783l-.08-21.414.519-.002.08 21.414zM111.876 140.932l-.498-.143 1.479-5.167.498.143zM108.437 141.06l-2.679-2.935 2.665-3.434.41.318-2.397 3.089 2.384 2.612zM116.607 141.06l-.383-.35 2.383-2.612-2.397-3.089.41-.318 2.665 3.434z"}),A.createElement("path",{d:"M154.316 131.892l-3.114-1.96.038 3.514-1.043.092c-1.682.115-3.634.23-4.789.23-1.902 0-2.693 2.258 2.23 2.648l-2.645-.596s-2.168 1.317.504 2.3c0 0-1.58 1.217.561 2.58-.584 3.504 5.247 4.058 7.122 3.59 1.876-.47 4.233-2.359 4.487-5.16.28-3.085-.89-5.432-3.35-7.238",fill:"#FFC6A0"}),A.createElement("path",{d:"M153.686 133.577s-6.522.47-8.36.372c-1.836-.098-1.904 2.19 2.359 2.264 3.739.15 5.451-.044 5.451-.044",stroke:"#DB836E",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M145.16 135.877c-1.85 1.346.561 2.355.561 2.355s3.478.898 6.73.617",stroke:"#DB836E",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M151.89 141.71s-6.28.111-6.73-2.132c-.223-1.346.45-1.402.45-1.402M146.114 140.868s-1.103 3.16 5.44 3.533M151.202 129.932v3.477M52.838 89.286c3.533-.337 8.423-1.248 13.582-7.754",stroke:"#DB836E",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M168.567 248.318a6.647 6.647 0 0 1-6.647-6.647v-66.466a6.647 6.647 0 1 1 13.294 0v66.466a6.647 6.647 0 0 1-6.647 6.647",fill:"#5BA02E"}),A.createElement("path",{d:"M176.543 247.653a6.647 6.647 0 0 1-6.646-6.647v-33.232a6.647 6.647 0 1 1 13.293 0v33.232a6.647 6.647 0 0 1-6.647 6.647",fill:"#92C110"}),A.createElement("path",{d:"M186.443 293.613H158.92a3.187 3.187 0 0 1-3.187-3.187v-46.134a3.187 3.187 0 0 1 3.187-3.187h27.524a3.187 3.187 0 0 1 3.187 3.187v46.134a3.187 3.187 0 0 1-3.187 3.187",fill:"#F2D7AD"}),A.createElement("path",{d:"M88.979 89.48s7.776 5.384 16.6 2.842",stroke:"#E4EBF7",strokeWidth:"1.101",strokeLinecap:"round",strokeLinejoin:"round"}))),qQ=HQ,ZQ=()=>A.createElement("svg",{width:"254",height:"294"},A.createElement("defs",null,A.createElement("path",{d:"M0 .335h253.49v253.49H0z"}),A.createElement("path",{d:"M0 293.665h253.49V.401H0z"})),A.createElement("g",{fill:"none",fillRule:"evenodd"},A.createElement("g",{transform:"translate(0 .067)"},A.createElement("mask",{fill:"#fff"}),A.createElement("path",{d:"M0 128.134v-2.11C0 56.608 56.273.334 125.69.334h2.11c69.416 0 125.69 56.274 125.69 125.69v2.11c0 69.417-56.274 125.69-125.69 125.69h-2.11C56.273 253.824 0 197.551 0 128.134",fill:"#E4EBF7",mask:"url(#b)"})),A.createElement("path",{d:"M39.989 132.108a8.332 8.332 0 1 1-16.581-1.671 8.332 8.332 0 0 1 16.58 1.671",fill:"#FFF"}),A.createElement("path",{d:"M37.19 135.59l10.553 5.983M48.665 147.884l-12.734 10.861",stroke:"#FFF",strokeWidth:"2"}),A.createElement("path",{d:"M40.11 160.816a5.706 5.706 0 1 1-11.354-1.145 5.706 5.706 0 0 1 11.354 1.145M57.943 144.6a5.747 5.747 0 1 1-11.436-1.152 5.747 5.747 0 0 1 11.436 1.153M99.656 27.434l30.024-.013a4.619 4.619 0 1 0-.004-9.238l-30.024.013a4.62 4.62 0 0 0 .004 9.238M111.14 45.896l30.023-.013a4.62 4.62 0 1 0-.004-9.238l-30.024.013a4.619 4.619 0 1 0 .004 9.238",fill:"#FFF"}),A.createElement("path",{d:"M113.53 27.421v-.002l15.89-.007a4.619 4.619 0 1 0 .005 9.238l-15.892.007v-.002a4.618 4.618 0 0 0-.004-9.234M150.167 70.091h-3.979a4.789 4.789 0 0 1-4.774-4.775 4.788 4.788 0 0 1 4.774-4.774h3.979a4.789 4.789 0 0 1 4.775 4.774 4.789 4.789 0 0 1-4.775 4.775",fill:"#FFF"}),A.createElement("path",{d:"M171.687 30.234c0-16.392 13.289-29.68 29.681-29.68 16.392 0 29.68 13.288 29.68 29.68 0 16.393-13.288 29.681-29.68 29.681s-29.68-13.288-29.68-29.68",fill:"#FF603B"}),A.createElement("path",{d:"M203.557 19.435l-.676 15.035a1.514 1.514 0 0 1-3.026 0l-.675-15.035a2.19 2.19 0 1 1 4.377 0m-.264 19.378c.513.477.77 1.1.77 1.87s-.257 1.393-.77 1.907c-.55.476-1.21.733-1.943.733a2.545 2.545 0 0 1-1.87-.77c-.55-.514-.806-1.136-.806-1.87 0-.77.256-1.393.806-1.87.513-.513 1.137-.733 1.87-.733.77 0 1.43.22 1.943.733",fill:"#FFF"}),A.createElement("path",{d:"M119.3 133.275c4.426-.598 3.612-1.204 4.079-4.778.675-5.18-3.108-16.935-8.262-25.118-1.088-10.72-12.598-11.24-12.598-11.24s4.312 4.895 4.196 16.199c1.398 5.243.804 14.45.804 14.45s5.255 11.369 11.78 10.487",fill:"#FFB594"}),A.createElement("path",{d:"M100.944 91.61s1.463-.583 3.211.582c8.08 1.398 10.368 6.706 11.3 11.368 1.864 1.282 1.864 2.33 1.864 3.496.365.777 1.515 3.03 1.515 3.03s-7.225 1.748-10.954 6.758c-1.399-6.41-6.936-25.235-6.936-25.235",fill:"#FFF"}),A.createElement("path",{d:"M94.008 90.5l1.019-5.815-9.23-11.874-5.233 5.581-2.593 9.863s8.39 5.128 16.037 2.246",fill:"#FFB594"}),A.createElement("path",{d:"M82.931 78.216s-4.557-2.868-2.445-6.892c1.632-3.107 4.537 1.139 4.537 1.139s.524-3.662 3.139-3.662c.523-1.046 1.569-4.184 1.569-4.184s11.507 2.615 13.6 3.138c-.001 5.23-2.317 19.529-7.884 19.969-8.94.706-12.516-9.508-12.516-9.508",fill:"#FFC6A0"}),A.createElement("path",{d:"M102.971 72.243c2.616-2.093 3.489-9.775 3.489-9.775s-2.492-.492-6.676-2.062c-4.708-2.092-12.867-4.771-17.575.982-9.54 4.41-2.062 19.93-2.062 19.93l2.729-3.037s-3.956-3.304-2.092-6.277c2.183-3.48 3.943 1.08 3.943 1.08s.64-2.4 3.6-3.36c.356-.714 1.04-2.69 1.44-3.872a1.08 1.08 0 0 1 1.27-.707c2.41.56 8.723 2.03 11.417 2.676.524.126.876.619.825 1.156l-.308 3.266z",fill:"#520038"}),A.createElement("path",{d:"M101.22 76.514c-.104.613-.585 1.044-1.076.96-.49-.082-.805-.646-.702-1.26.104-.613.585-1.044 1.076-.961.491.083.805.647.702 1.26M94.26 75.074c-.104.613-.585 1.044-1.076.96-.49-.082-.805-.646-.702-1.26.104-.613.585-1.044 1.076-.96.491.082.805.646.702 1.26",fill:"#552950"}),A.createElement("path",{stroke:"#DB836E",strokeWidth:"1.063",strokeLinecap:"round",strokeLinejoin:"round",d:"M99.206 73.644l-.9 1.62-.3 4.38h-2.24"}),A.createElement("path",{d:"M99.926 73.284s1.8-.72 2.52.54",stroke:"#5C2552",strokeWidth:"1.117",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M81.367 73.084s.48-1.12 1.12-.72c.64.4 1.28 1.44.56 2s.16 1.68.16 1.68",stroke:"#DB836E",strokeWidth:"1.117",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M92.326 71.724s1.84 1.12 4.16.96",stroke:"#5C2552",strokeWidth:"1.117",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M92.726 80.604s2.24 1.2 4.4 1.2M93.686 83.164s.96.4 1.52.32M83.687 80.044s1.786 6.547 9.262 7.954",stroke:"#DB836E",strokeWidth:"1.063",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M95.548 91.663s-1.068 2.821-8.298 2.105c-7.23-.717-10.29-5.044-10.29-5.044",stroke:"#E4EBF7",strokeWidth:"1.136",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M78.126 87.478s6.526 4.972 16.47 2.486c0 0 9.577 1.02 11.536 5.322 5.36 11.77.543 36.835 0 39.962 3.496 4.055-.466 8.483-.466 8.483-15.624-3.548-35.81-.6-35.81-.6-4.849-3.546-1.223-9.044-1.223-9.044L62.38 110.32c-2.485-15.227.833-19.803 3.549-20.743 3.03-1.049 8.04-1.282 8.04-1.282.496-.058 1.08-.076 1.37-.233 2.36-1.282 2.787-.583 2.787-.583",fill:"#FFF"}),A.createElement("path",{d:"M65.828 89.81s-6.875.465-7.59 8.156c-.466 8.857 3.03 10.954 3.03 10.954s6.075 22.102 16.796 22.957c8.39-2.176 4.758-6.702 4.661-11.42-.233-11.304-7.108-16.897-7.108-16.897s-4.212-13.75-9.789-13.75",fill:"#FFC6A0"}),A.createElement("path",{d:"M71.716 124.225s.855 11.264 9.828 6.486c4.765-2.536 7.581-13.828 9.789-22.568 1.456-5.768 2.58-12.197 2.58-12.197l-4.973-1.709s-2.408 5.516-7.769 12.275c-4.335 5.467-9.144 11.11-9.455 17.713",fill:"#FFC6A0"}),A.createElement("path",{d:"M108.463 105.191s1.747 2.724-2.331 30.535c2.376 2.216 1.053 6.012-.233 7.51",stroke:"#E4EBF7",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M123.262 131.527s-.427 2.732-11.77 1.981c-15.187-1.006-25.326-3.25-25.326-3.25l.933-5.8s.723.215 9.71-.068c11.887-.373 18.714-6.07 24.964-1.022 4.039 3.263 1.489 8.16 1.489 8.16",fill:"#FFC6A0"}),A.createElement("path",{d:"M70.24 90.974s-5.593-4.739-11.054 2.68c-3.318 7.223.517 15.284 2.664 19.578-.31 3.729 2.33 4.311 2.33 4.311s.108.895 1.516 2.68c4.078-7.03 6.72-9.166 13.711-12.546-.328-.656-1.877-3.265-1.825-3.767.175-1.69-1.282-2.623-1.282-2.623s-.286-.156-1.165-2.738c-.788-2.313-2.036-5.177-4.895-7.575",fill:"#FFF"}),A.createElement("path",{d:"M90.232 288.027s4.855 2.308 8.313 1.155c3.188-1.063 5.12.755 8.002 1.331 2.881.577 7.769 1.243 13.207-1.424-.117-6.228-7.786-4.499-13.518-7.588-2.895-1.56-4.276-5.336-4.066-9.944H91.544s-1.573 11.89-1.312 16.47",fill:"#CBD1D1"}),A.createElement("path",{d:"M90.207 287.833s2.745 1.437 7.639.738c3.456-.494 3.223.66 7.418 1.282 4.195.621 13.092-.194 14.334-1.126.466 1.242-.388 2.33-.388 2.33s-1.709.682-5.438.932c-2.295.154-8.098.276-10.14-.621-2.02-1.554-4.894-1.515-6.06-.234-4.427 1.075-7.184-.31-7.184-.31l-.181-2.991z",fill:"#2B0849"}),A.createElement("path",{d:"M98.429 272.257h3.496s-.117 7.574 5.127 9.671c-5.244.7-9.672-2.602-8.623-9.671",fill:"#A4AABA"}),A.createElement("path",{d:"M44.425 272.046s-2.208 7.774-4.702 12.899c-1.884 3.874-4.428 7.854 5.729 7.854 6.97 0 9.385-.503 7.782-6.917-1.604-6.415.279-13.836.279-13.836h-9.088z",fill:"#CBD1D1"}),A.createElement("path",{d:"M38.066 290.277s2.198 1.225 6.954 1.225c6.376 0 8.646-1.73 8.646-1.73s.63 1.168-.649 2.27c-1.04.897-3.77 1.668-7.745 1.621-4.347-.05-6.115-.593-7.062-1.224-.864-.577-.72-1.657-.144-2.162",fill:"#2B0849"}),A.createElement("path",{d:"M45.344 274.041s.035 1.592-.329 3.07c-.365 1.49-1.13 3.255-1.184 4.34-.061 1.206 4.755 1.657 5.403.036.65-1.622 1.357-6.737 2.006-7.602.648-.865-5.14-2.222-5.896.156",fill:"#A4AABA"}),A.createElement("path",{d:"M89.476 277.57l13.899.095s1.349-56.643 1.925-66.909c.576-10.267 3.923-45.052 1.042-65.585l-13.037-.669-23.737.81s-.452 4.12-1.243 10.365c-.065.515-.708.874-.777 1.417-.078.608.439 1.407.332 2.044-2.455 14.627-5.797 32.736-8.256 46.837-.121.693-1.282 1.048-1.515 2.796-.042.314.22 1.584.116 1.865-7.14 19.473-12.202 52.601-15.66 67.19l15.176-.015s2.282-10.145 4.185-18.871c2.922-13.389 24.012-88.32 24.012-88.32l3.133-.954-.158 48.568s-.233 1.282.35 2.098c.583.815-.581 1.167-.408 2.331l.408 1.864s-.466 7.458-.932 12.352c-.467 4.895 1.145 40.69 1.145 40.69",fill:"#7BB2F9"}),A.createElement("path",{d:"M64.57 218.881c1.197.099 4.195-2.097 7.225-5.127M96.024 222.534s2.881-1.152 6.34-4.034",stroke:"#648BD8",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M96.973 219.373s2.882-1.153 6.34-4.034",stroke:"#648BD8",strokeWidth:"1.032",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M63.172 222.144s2.724-.614 6.759-3.496M74.903 146.166c-.281 3.226.31 8.856-4.506 9.478M93.182 144.344s.115 14.557-1.344 15.65c-2.305 1.73-3.107 2.02-3.107 2.02M89.197 144.923s.269 13.144-1.01 25.088M83.525 170.71s6.81-1.051 9.116-1.051M46.026 270.045l-.892 4.538M46.937 263.289l-.815 4.157M62.725 202.503c-.33 1.618-.102 1.904-.449 3.438 0 0-2.756 1.903-2.29 3.923.466 2.02-.31 3.424-4.505 17.252-1.762 5.807-4.233 18.922-6.165 28.278-.03.144-.521 2.646-1.14 5.8M64.158 194.136c-.295 1.658-.6 3.31-.917 4.938M71.33 146.787l-1.244 10.877s-1.14.155-.519 2.33c.117 1.399-2.778 16.39-5.382 31.615M44.242 273.727H58.07",stroke:"#648BD8",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M106.18 142.117c-3.028-.489-18.825-2.744-36.219.2a.625.625 0 0 0-.518.644c.063 1.307.044 2.343.015 2.995a.617.617 0 0 0 .716.636c3.303-.534 17.037-2.412 35.664-.266.347.04.66-.214.692-.56.124-1.347.16-2.425.17-3.029a.616.616 0 0 0-.52-.62",fill:"#192064"}),A.createElement("path",{d:"M96.398 145.264l.003-5.102a.843.843 0 0 0-.809-.847 114.104 114.104 0 0 0-8.141-.014.85.85 0 0 0-.82.847l-.003 5.097c0 .476.388.857.864.845 2.478-.064 5.166-.067 8.03.017a.848.848 0 0 0 .876-.843",fill:"#FFF"}),A.createElement("path",{d:"M95.239 144.296l.002-3.195a.667.667 0 0 0-.643-.672c-1.9-.061-3.941-.073-6.094-.01a.675.675 0 0 0-.654.672l-.002 3.192c0 .376.305.677.68.669 1.859-.042 3.874-.043 6.02.012.376.01.69-.291.691-.668",fill:"#192064"}),A.createElement("path",{d:"M90.102 273.522h12.819M91.216 269.761c.006 3.519-.072 5.55 0 6.292M90.923 263.474c-.009 1.599-.016 2.558-.016 4.505M90.44 170.404l.932 46.38s.7 1.631-.233 2.796c-.932 1.166 2.564.7.932 2.33-1.63 1.633.933 1.166 0 3.497-.618 1.546-1.031 21.921-1.138 36.513",stroke:"#648BD8",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M73.736 98.665l2.214 4.312s2.098.816 1.865 2.68l.816 2.214M64.297 116.611c.233-.932 2.176-7.147 12.585-10.488M77.598 90.042s7.691 6.137 16.547 2.72",stroke:"#E4EBF7",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M91.974 86.954s5.476-.816 7.574-4.545c1.297-.345.72 2.212-.33 3.671-.7.971-1.01 1.554-1.01 1.554s.194.31.155.816c-.053.697-.175.653-.272 1.048-.081.335.108.657 0 1.049-.046.17-.198.5-.382.878-.12.249-.072.687-.2.948-.231.469-1.562 1.87-2.622 2.855-3.826 3.554-5.018 1.644-6.001-.408-.894-1.865-.661-5.127-.874-6.875-.35-2.914-2.622-3.03-1.923-4.429.343-.685 2.87.69 3.263 1.748.757 2.04 2.952 1.807 2.622 1.69",fill:"#FFC6A0"}),A.createElement("path",{d:"M99.8 82.429c-.465.077-.35.272-.97 1.243-.622.971-4.817 2.932-6.39 3.224-2.589.48-2.278-1.56-4.254-2.855-1.69-1.107-3.562-.638-1.398 1.398.99.932.932 1.107 1.398 3.205.335 1.506-.64 3.67.7 5.593",stroke:"#DB836E",strokeWidth:".774",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M79.543 108.673c-2.1 2.926-4.266 6.175-5.557 8.762",stroke:"#E59788",strokeWidth:".774",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M87.72 124.768s-2.098-1.942-5.127-2.719c-3.03-.777-3.574-.155-5.516.078-1.942.233-3.885-.932-3.652.7.233 1.63 5.05 1.01 5.206 2.097.155 1.087-6.37 2.796-8.313 2.175-.777.777.466 1.864 2.02 2.175.233 1.554 2.253 1.554 2.253 1.554s.699 1.01 2.641 1.088c2.486 1.32 8.934-.7 10.954-1.554 2.02-.855-.466-5.594-.466-5.594",fill:"#FFC6A0"}),A.createElement("path",{d:"M73.425 122.826s.66 1.127 3.167 1.418c2.315.27 2.563.583 2.563.583s-2.545 2.894-9.07 2.272M72.416 129.274s3.826.097 4.933-.718M74.98 130.75s1.961.136 3.36-.505M77.232 131.916s1.748.019 2.914-.505M73.328 122.321s-.595-1.032 1.262-.427c1.671.544 2.833.055 5.128.155 1.389.061 3.067-.297 3.982.15 1.606.784 3.632 2.181 3.632 2.181s10.526 1.204 19.033-1.127M78.864 108.104s-8.39 2.758-13.168 12.12",stroke:"#E59788",strokeWidth:".774",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M109.278 112.533s3.38-3.613 7.575-4.662",stroke:"#E4EBF7",strokeWidth:"1.085",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M107.375 123.006s9.697-2.745 11.445-.88",stroke:"#E59788",strokeWidth:".774",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M194.605 83.656l3.971-3.886M187.166 90.933l3.736-3.655M191.752 84.207l-4.462-4.56M198.453 91.057l-4.133-4.225M129.256 163.074l3.718-3.718M122.291 170.039l3.498-3.498M126.561 163.626l-4.27-4.27M132.975 170.039l-3.955-3.955",stroke:"#BFCDDD",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M190.156 211.779h-1.604a4.023 4.023 0 0 1-4.011-4.011V175.68a4.023 4.023 0 0 1 4.01-4.01h1.605a4.023 4.023 0 0 1 4.011 4.01v32.088a4.023 4.023 0 0 1-4.01 4.01",fill:"#A3B4C6"}),A.createElement("path",{d:"M237.824 212.977a4.813 4.813 0 0 1-4.813 4.813h-86.636a4.813 4.813 0 0 1 0-9.626h86.636a4.813 4.813 0 0 1 4.813 4.813",fill:"#A3B4C6"}),A.createElement("mask",{fill:"#fff"}),A.createElement("path",{fill:"#A3B4C6",mask:"url(#d)",d:"M154.098 190.096h70.513v-84.617h-70.513z"}),A.createElement("path",{d:"M224.928 190.096H153.78a3.219 3.219 0 0 1-3.208-3.209V167.92a3.219 3.219 0 0 1 3.208-3.21h71.148a3.219 3.219 0 0 1 3.209 3.21v18.967a3.219 3.219 0 0 1-3.21 3.209M224.928 130.832H153.78a3.218 3.218 0 0 1-3.208-3.208v-18.968a3.219 3.219 0 0 1 3.208-3.209h71.148a3.219 3.219 0 0 1 3.209 3.21v18.967a3.218 3.218 0 0 1-3.21 3.208",fill:"#BFCDDD",mask:"url(#d)"}),A.createElement("path",{d:"M159.563 120.546a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M166.98 120.546a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M174.397 120.546a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M222.539 120.546h-22.461a.802.802 0 0 1-.802-.802v-3.208c0-.443.359-.803.802-.803h22.46c.444 0 .803.36.803.803v3.208c0 .443-.36.802-.802.802",fill:"#FFF",mask:"url(#d)"}),A.createElement("path",{d:"M224.928 160.464H153.78a3.218 3.218 0 0 1-3.208-3.209v-18.967a3.219 3.219 0 0 1 3.208-3.209h71.148a3.219 3.219 0 0 1 3.209 3.209v18.967a3.218 3.218 0 0 1-3.21 3.209",fill:"#BFCDDD",mask:"url(#d)"}),A.createElement("path",{d:"M173.455 130.832h49.301M164.984 130.832h6.089M155.952 130.832h6.75M173.837 160.613h49.3M165.365 160.613h6.089M155.57 160.613h6.751",stroke:"#7C90A5",strokeWidth:"1.124",strokeLinecap:"round",strokeLinejoin:"round",mask:"url(#d)"}),A.createElement("path",{d:"M159.563 151.038a2.407 2.407 0 1 1 0-4.814 2.407 2.407 0 0 1 0 4.814M166.98 151.038a2.407 2.407 0 1 1 0-4.814 2.407 2.407 0 0 1 0 4.814M174.397 151.038a2.407 2.407 0 1 1 .001-4.814 2.407 2.407 0 0 1 0 4.814M222.539 151.038h-22.461a.802.802 0 0 1-.802-.802v-3.209c0-.443.359-.802.802-.802h22.46c.444 0 .803.36.803.802v3.209c0 .443-.36.802-.802.802M159.563 179.987a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M166.98 179.987a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M174.397 179.987a2.407 2.407 0 1 1 0-4.813 2.407 2.407 0 0 1 0 4.813M222.539 179.987h-22.461a.802.802 0 0 1-.802-.802v-3.209c0-.443.359-.802.802-.802h22.46c.444 0 .803.36.803.802v3.209c0 .443-.36.802-.802.802",fill:"#FFF",mask:"url(#d)"}),A.createElement("path",{d:"M203.04 221.108h-27.372a2.413 2.413 0 0 1-2.406-2.407v-11.448a2.414 2.414 0 0 1 2.406-2.407h27.372a2.414 2.414 0 0 1 2.407 2.407V218.7a2.413 2.413 0 0 1-2.407 2.407",fill:"#BFCDDD",mask:"url(#d)"}),A.createElement("path",{d:"M177.259 207.217v11.52M201.05 207.217v11.52",stroke:"#A3B4C6",strokeWidth:"1.124",strokeLinecap:"round",strokeLinejoin:"round",mask:"url(#d)"}),A.createElement("path",{d:"M162.873 267.894a9.422 9.422 0 0 1-9.422-9.422v-14.82a9.423 9.423 0 0 1 18.845 0v14.82a9.423 9.423 0 0 1-9.423 9.422",fill:"#5BA02E",mask:"url(#d)"}),A.createElement("path",{d:"M171.22 267.83a9.422 9.422 0 0 1-9.422-9.423v-3.438a9.423 9.423 0 0 1 18.845 0v3.438a9.423 9.423 0 0 1-9.422 9.423",fill:"#92C110",mask:"url(#d)"}),A.createElement("path",{d:"M181.31 293.666h-27.712a3.209 3.209 0 0 1-3.209-3.21V269.79a3.209 3.209 0 0 1 3.209-3.21h27.711a3.209 3.209 0 0 1 3.209 3.21v20.668a3.209 3.209 0 0 1-3.209 3.209",fill:"#F2D7AD",mask:"url(#d)"}))),XQ=ZQ,YQ=()=>A.createElement("svg",{width:"251",height:"294"},A.createElement("g",{fill:"none",fillRule:"evenodd"},A.createElement("path",{d:"M0 129.023v-2.084C0 58.364 55.591 2.774 124.165 2.774h2.085c68.574 0 124.165 55.59 124.165 124.165v2.084c0 68.575-55.59 124.166-124.165 124.166h-2.085C55.591 253.189 0 197.598 0 129.023",fill:"#E4EBF7"}),A.createElement("path",{d:"M41.417 132.92a8.231 8.231 0 1 1-16.38-1.65 8.231 8.231 0 0 1 16.38 1.65",fill:"#FFF"}),A.createElement("path",{d:"M38.652 136.36l10.425 5.91M49.989 148.505l-12.58 10.73",stroke:"#FFF",strokeWidth:"2"}),A.createElement("path",{d:"M41.536 161.28a5.636 5.636 0 1 1-11.216-1.13 5.636 5.636 0 0 1 11.216 1.13M59.154 145.261a5.677 5.677 0 1 1-11.297-1.138 5.677 5.677 0 0 1 11.297 1.138M100.36 29.516l29.66-.013a4.562 4.562 0 1 0-.004-9.126l-29.66.013a4.563 4.563 0 0 0 .005 9.126M111.705 47.754l29.659-.013a4.563 4.563 0 1 0-.004-9.126l-29.66.013a4.563 4.563 0 1 0 .005 9.126",fill:"#FFF"}),A.createElement("path",{d:"M114.066 29.503V29.5l15.698-.007a4.563 4.563 0 1 0 .004 9.126l-15.698.007v-.002a4.562 4.562 0 0 0-.004-9.122M185.405 137.723c-.55 5.455-5.418 9.432-10.873 8.882-5.456-.55-9.432-5.418-8.882-10.873.55-5.455 5.418-9.432 10.873-8.882 5.455.55 9.432 5.418 8.882 10.873",fill:"#FFF"}),A.createElement("path",{d:"M180.17 143.772l12.572 7.129M193.841 158.42L178.67 171.36",stroke:"#FFF",strokeWidth:"2"}),A.createElement("path",{d:"M185.55 171.926a6.798 6.798 0 1 1-13.528-1.363 6.798 6.798 0 0 1 13.527 1.363M204.12 155.285a6.848 6.848 0 1 1-13.627-1.375 6.848 6.848 0 0 1 13.626 1.375",fill:"#FFF"}),A.createElement("path",{d:"M152.988 194.074a2.21 2.21 0 1 1-4.42 0 2.21 2.21 0 0 1 4.42 0zM225.931 118.217a2.21 2.21 0 1 1-4.421 0 2.21 2.21 0 0 1 4.421 0zM217.09 153.051a2.21 2.21 0 1 1-4.421 0 2.21 2.21 0 0 1 4.42 0zM177.84 109.842a2.21 2.21 0 1 1-4.422 0 2.21 2.21 0 0 1 4.421 0zM196.114 94.454a2.21 2.21 0 1 1-4.421 0 2.21 2.21 0 0 1 4.421 0zM202.844 182.523a2.21 2.21 0 1 1-4.42 0 2.21 2.21 0 0 1 4.42 0z",stroke:"#FFF",strokeWidth:"2"}),A.createElement("path",{stroke:"#FFF",strokeWidth:"2",d:"M215.125 155.262l-1.902 20.075-10.87 5.958M174.601 176.636l-6.322 9.761H156.98l-4.484 6.449M175.874 127.28V111.56M221.51 119.404l-12.77 7.859-15.228-7.86V96.668"}),A.createElement("path",{d:"M180.68 29.32C180.68 13.128 193.806 0 210 0c16.193 0 29.32 13.127 29.32 29.32 0 16.194-13.127 29.322-29.32 29.322-16.193 0-29.32-13.128-29.32-29.321",fill:"#A26EF4"}),A.createElement("path",{d:"M221.45 41.706l-21.563-.125a1.744 1.744 0 0 1-1.734-1.754l.071-12.23a1.744 1.744 0 0 1 1.754-1.734l21.562.125c.964.006 1.74.791 1.735 1.755l-.071 12.229a1.744 1.744 0 0 1-1.754 1.734",fill:"#FFF"}),A.createElement("path",{d:"M215.106 29.192c-.015 2.577-2.049 4.654-4.543 4.64-2.494-.014-4.504-2.115-4.489-4.693l.04-6.925c.016-2.577 2.05-4.654 4.543-4.64 2.494.015 4.504 2.116 4.49 4.693l-.04 6.925zm-4.53-14.074a6.877 6.877 0 0 0-6.916 6.837l-.043 7.368a6.877 6.877 0 0 0 13.754.08l.042-7.368a6.878 6.878 0 0 0-6.837-6.917zM167.566 68.367h-3.93a4.73 4.73 0 0 1-4.717-4.717 4.73 4.73 0 0 1 4.717-4.717h3.93a4.73 4.73 0 0 1 4.717 4.717 4.73 4.73 0 0 1-4.717 4.717",fill:"#FFF"}),A.createElement("path",{d:"M168.214 248.838a6.611 6.611 0 0 1-6.61-6.611v-66.108a6.611 6.611 0 0 1 13.221 0v66.108a6.611 6.611 0 0 1-6.61 6.61",fill:"#5BA02E"}),A.createElement("path",{d:"M176.147 248.176a6.611 6.611 0 0 1-6.61-6.61v-33.054a6.611 6.611 0 1 1 13.221 0v33.053a6.611 6.611 0 0 1-6.61 6.611",fill:"#92C110"}),A.createElement("path",{d:"M185.994 293.89h-27.376a3.17 3.17 0 0 1-3.17-3.17v-45.887a3.17 3.17 0 0 1 3.17-3.17h27.376a3.17 3.17 0 0 1 3.17 3.17v45.886a3.17 3.17 0 0 1-3.17 3.17",fill:"#F2D7AD"}),A.createElement("path",{d:"M81.972 147.673s6.377-.927 17.566-1.28c11.729-.371 17.57 1.086 17.57 1.086s3.697-3.855.968-8.424c1.278-12.077 5.982-32.827.335-48.273-1.116-1.339-3.743-1.512-7.536-.62-1.337.315-7.147-.149-7.983-.1l-15.311-.347s-3.487-.17-8.035-.508c-1.512-.113-4.227-1.683-5.458-.338-.406.443-2.425 5.669-1.97 16.077l8.635 35.642s-3.141 3.61 1.219 7.085",fill:"#FFF"}),A.createElement("path",{d:"M75.768 73.325l-.9-6.397 11.982-6.52s7.302-.118 8.038 1.205c.737 1.324-5.616.993-5.616.993s-1.836 1.388-2.615 2.5c-1.654 2.363-.986 6.471-8.318 5.986-1.708.284-2.57 2.233-2.57 2.233",fill:"#FFC6A0"}),A.createElement("path",{d:"M52.44 77.672s14.217 9.406 24.973 14.444c1.061.497-2.094 16.183-11.892 11.811-7.436-3.318-20.162-8.44-21.482-14.496-.71-3.258 2.543-7.643 8.401-11.76M141.862 80.113s-6.693 2.999-13.844 6.876c-3.894 2.11-10.137 4.704-12.33 7.988-6.224 9.314 3.536 11.22 12.947 7.503 6.71-2.651 28.999-12.127 13.227-22.367",fill:"#FFB594"}),A.createElement("path",{d:"M76.166 66.36l3.06 3.881s-2.783 2.67-6.31 5.747c-7.103 6.195-12.803 14.296-15.995 16.44-3.966 2.662-9.754 3.314-12.177-.118-3.553-5.032.464-14.628 31.422-25.95",fill:"#FFC6A0"}),A.createElement("path",{d:"M64.674 85.116s-2.34 8.413-8.912 14.447c.652.548 18.586 10.51 22.144 10.056 5.238-.669 6.417-18.968 1.145-20.531-.702-.208-5.901-1.286-8.853-2.167-.87-.26-1.611-1.71-3.545-.936l-1.98-.869zM128.362 85.826s5.318 1.956 7.325 13.734c-.546.274-17.55 12.35-21.829 7.805-6.534-6.94-.766-17.393 4.275-18.61 4.646-1.121 5.03-1.37 10.23-2.929",fill:"#FFF"}),A.createElement("path",{d:"M78.18 94.656s.911 7.41-4.914 13.078",stroke:"#E4EBF7",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M87.397 94.68s3.124 2.572 10.263 2.572c7.14 0 9.074-3.437 9.074-3.437",stroke:"#E4EBF7",strokeWidth:".932",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M117.184 68.639l-6.781-6.177s-5.355-4.314-9.223-.893c-3.867 3.422 4.463 2.083 5.653 4.165 1.19 2.082.848 1.143-2.083.446-5.603-1.331-2.082.893 2.975 5.355 2.091 1.845 6.992.955 6.992.955l2.467-3.851z",fill:"#FFC6A0"}),A.createElement("path",{d:"M105.282 91.315l-.297-10.937-15.918-.027-.53 10.45c-.026.403.17.788.515.999 2.049 1.251 9.387 5.093 15.799.424.287-.21.443-.554.431-.91",fill:"#FFB594"}),A.createElement("path",{d:"M107.573 74.24c.817-1.147.982-9.118 1.015-11.928a1.046 1.046 0 0 0-.965-1.055l-4.62-.365c-7.71-1.044-17.071.624-18.253 6.346-5.482 5.813-.421 13.244-.421 13.244s1.963 3.566 4.305 6.791c.756 1.041.398-3.731 3.04-5.929 5.524-4.594 15.899-7.103 15.899-7.103",fill:"#5C2552"}),A.createElement("path",{d:"M88.426 83.206s2.685 6.202 11.602 6.522c7.82.28 8.973-7.008 7.434-17.505l-.909-5.483c-6.118-2.897-15.478.54-15.478.54s-.576 2.044-.19 5.504c-2.276 2.066-1.824 5.618-1.824 5.618s-.905-1.922-1.98-2.321c-.86-.32-1.897.089-2.322 1.98-1.04 4.632 3.667 5.145 3.667 5.145",fill:"#FFC6A0"}),A.createElement("path",{stroke:"#DB836E",strokeWidth:"1.145",strokeLinecap:"round",strokeLinejoin:"round",d:"M100.843 77.099l1.701-.928-1.015-4.324.674-1.406"}),A.createElement("path",{d:"M105.546 74.092c-.022.713-.452 1.279-.96 1.263-.51-.016-.904-.607-.882-1.32.021-.713.452-1.278.96-1.263.51.016.904.607.882 1.32M97.592 74.349c-.022.713-.452 1.278-.961 1.263-.509-.016-.904-.607-.882-1.32.022-.713.452-1.279.961-1.263.51.016.904.606.882 1.32",fill:"#552950"}),A.createElement("path",{d:"M91.132 86.786s5.269 4.957 12.679 2.327",stroke:"#DB836E",strokeWidth:"1.145",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M99.776 81.903s-3.592.232-1.44-2.79c1.59-1.496 4.897-.46 4.897-.46s1.156 3.906-3.457 3.25",fill:"#DB836E"}),A.createElement("path",{d:"M102.88 70.6s2.483.84 3.402.715M93.883 71.975s2.492-1.144 4.778-1.073",stroke:"#5C2552",strokeWidth:"1.526",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M86.32 77.374s.961.879 1.458 2.106c-.377.48-1.033 1.152-.236 1.809M99.337 83.719s1.911.151 2.509-.254",stroke:"#DB836E",strokeWidth:"1.145",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M87.782 115.821l15.73-3.012M100.165 115.821l10.04-2.008",stroke:"#E4EBF7",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M66.508 86.763s-1.598 8.83-6.697 14.078",stroke:"#E4EBF7",strokeWidth:"1.114",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M128.31 87.934s3.013 4.121 4.06 11.785",stroke:"#E4EBF7",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M64.09 84.816s-6.03 9.912-13.607 9.903",stroke:"#DB836E",strokeWidth:".795",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M112.366 65.909l-.142 5.32s5.993 4.472 11.945 9.202c4.482 3.562 8.888 7.455 10.985 8.662 4.804 2.766 8.9 3.355 11.076 1.808 4.071-2.894 4.373-9.878-8.136-15.263-4.271-1.838-16.144-6.36-25.728-9.73",fill:"#FFC6A0"}),A.createElement("path",{d:"M130.532 85.488s4.588 5.757 11.619 6.214",stroke:"#DB836E",strokeWidth:".75",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M121.708 105.73s-.393 8.564-1.34 13.612",stroke:"#E4EBF7",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M115.784 161.512s-3.57-1.488-2.678-7.14",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M101.52 290.246s4.326 2.057 7.408 1.03c2.842-.948 4.564.673 7.132 1.186 2.57.514 6.925 1.108 11.772-1.269-.104-5.551-6.939-4.01-12.048-6.763-2.582-1.39-3.812-4.757-3.625-8.863h-9.471s-1.402 10.596-1.169 14.68",fill:"#CBD1D1"}),A.createElement("path",{d:"M101.496 290.073s2.447 1.281 6.809.658c3.081-.44 3.74.485 7.479 1.039 3.739.554 10.802-.07 11.91-.9.415 1.108-.347 2.077-.347 2.077s-1.523.608-4.847.831c-2.045.137-5.843.293-7.663-.507-1.8-1.385-5.286-1.917-5.77-.243-3.947.958-7.41-.288-7.41-.288l-.16-2.667z",fill:"#2B0849"}),A.createElement("path",{d:"M108.824 276.19h3.116s-.103 6.751 4.57 8.62c-4.673.624-8.62-2.32-7.686-8.62",fill:"#A4AABA"}),A.createElement("path",{d:"M57.65 272.52s-2.122 7.47-4.518 12.396c-1.811 3.724-4.255 7.548 5.505 7.548 6.698 0 9.02-.483 7.479-6.648-1.541-6.164.268-13.296.268-13.296H57.65z",fill:"#CBD1D1"}),A.createElement("path",{d:"M51.54 290.04s2.111 1.178 6.682 1.178c6.128 0 8.31-1.662 8.31-1.662s.605 1.122-.624 2.18c-1 .862-3.624 1.603-7.444 1.559-4.177-.049-5.876-.57-6.786-1.177-.831-.554-.692-1.593-.138-2.078",fill:"#2B0849"}),A.createElement("path",{d:"M58.533 274.438s.034 1.529-.315 2.95c-.352 1.431-1.087 3.127-1.139 4.17-.058 1.16 4.57 1.592 5.194.035.623-1.559 1.303-6.475 1.927-7.306.622-.831-4.94-2.135-5.667.15",fill:"#A4AABA"}),A.createElement("path",{d:"M100.885 277.015l13.306.092s1.291-54.228 1.843-64.056c.552-9.828 3.756-43.13.997-62.788l-12.48-.64-22.725.776s-.433 3.944-1.19 9.921c-.062.493-.677.838-.744 1.358-.075.582.42 1.347.318 1.956-2.35 14.003-6.343 32.926-8.697 46.425-.116.663-1.227 1.004-1.45 2.677-.04.3.21 1.516.112 1.785-6.836 18.643-10.89 47.584-14.2 61.551l14.528-.014s2.185-8.524 4.008-16.878c2.796-12.817 22.987-84.553 22.987-84.553l3-.517 1.037 46.1s-.223 1.228.334 2.008c.558.782-.556 1.117-.39 2.233l.39 1.784s-.446 7.14-.892 11.826c-.446 4.685-.092 38.954-.092 38.954",fill:"#7BB2F9"}),A.createElement("path",{d:"M77.438 220.434c1.146.094 4.016-2.008 6.916-4.91M107.55 223.931s2.758-1.103 6.069-3.862",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M108.459 220.905s2.759-1.104 6.07-3.863",stroke:"#648BD8",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M76.099 223.557s2.608-.587 6.47-3.346M87.33 150.82c-.27 3.088.297 8.478-4.315 9.073M104.829 149.075s.11 13.936-1.286 14.983c-2.207 1.655-2.975 1.934-2.975 1.934M101.014 149.63s.035 12.81-1.19 24.245M94.93 174.965s7.174-1.655 9.38-1.655M75.671 204.754c-.316 1.55-.64 3.067-.973 4.535 0 0-1.45 1.822-1.003 3.756.446 1.934-.943 2.034-4.96 15.273-1.686 5.559-4.464 18.49-6.313 27.447-.078.38-4.018 18.06-4.093 18.423M77.043 196.743a313.269 313.269 0 0 1-.877 4.729M83.908 151.414l-1.19 10.413s-1.091.148-.496 2.23c.111 1.34-2.66 15.692-5.153 30.267M57.58 272.94h13.238",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}),A.createElement("path",{d:"M117.377 147.423s-16.955-3.087-35.7.199c.157 2.501-.002 4.128-.002 4.128s14.607-2.802 35.476-.31c.251-2.342.226-4.017.226-4.017",fill:"#192064"}),A.createElement("path",{d:"M107.511 150.353l.004-4.885a.807.807 0 0 0-.774-.81c-2.428-.092-5.04-.108-7.795-.014a.814.814 0 0 0-.784.81l-.003 4.88c0 .456.371.82.827.808a140.76 140.76 0 0 1 7.688.017.81.81 0 0 0 .837-.806",fill:"#FFF"}),A.createElement("path",{d:"M106.402 149.426l.002-3.06a.64.64 0 0 0-.616-.643 94.135 94.135 0 0 0-5.834-.009.647.647 0 0 0-.626.643l-.001 3.056c0 .36.291.648.651.64 1.78-.04 3.708-.041 5.762.012.36.009.662-.279.662-.64",fill:"#192064"}),A.createElement("path",{d:"M101.485 273.933h12.272M102.652 269.075c.006 3.368.04 5.759.11 6.47M102.667 263.125c-.009 1.53-.015 2.98-.016 4.313M102.204 174.024l.893 44.402s.669 1.561-.224 2.677c-.892 1.116 2.455.67.893 2.231-1.562 1.562.893 1.116 0 3.347-.592 1.48-.988 20.987-1.09 34.956",stroke:"#648BD8",strokeWidth:"1.051",strokeLinecap:"round",strokeLinejoin:"round"}))),KQ=YQ,JQ=n=>{const{componentCls:o,lineHeightHeading3:l,iconCls:h,padding:f,paddingXL:g,paddingXS:x,paddingLG:E,marginXS:w,lineHeight:I}=n;return{[o]:{padding:`${E*2}px ${g}px`,"&-rtl":{direction:"rtl"}},[`${o} ${o}-image`]:{width:n.imageWidth,height:n.imageHeight,margin:"auto"},[`${o} ${o}-icon`]:{marginBottom:E,textAlign:"center",[`& > ${h}`]:{fontSize:n.iconFontSize}},[`${o} ${o}-title`]:{color:n.colorTextHeading,fontSize:n.titleFontSize,lineHeight:l,marginBlock:w,textAlign:"center"},[`${o} ${o}-subtitle`]:{color:n.colorTextDescription,fontSize:n.subtitleFontSize,lineHeight:I,textAlign:"center"},[`${o} ${o}-content`]:{marginTop:E,padding:`${E}px ${f*2.5}px`,backgroundColor:n.colorFillAlter},[`${o} ${o}-extra`]:{margin:n.extraMargin,textAlign:"center","& > *":{marginInlineEnd:x,"&:last-child":{marginInlineEnd:0}}}}},QQ=n=>{const{componentCls:o,iconCls:l}=n;return{[`${o}-success ${o}-icon > ${l}`]:{color:n.resultSuccessIconColor},[`${o}-error ${o}-icon > ${l}`]:{color:n.resultErrorIconColor},[`${o}-info ${o}-icon > ${l}`]:{color:n.resultInfoIconColor},[`${o}-warning ${o}-icon > ${l}`]:{color:n.resultWarningIconColor}}},eee=n=>[JQ(n),QQ(n)],tee=n=>eee(n),ree=ba("Result",n=>{const o=n.colorInfo,l=n.colorError,h=n.colorSuccess,f=n.colorWarning,g=to(n,{resultInfoIconColor:o,resultErrorIconColor:l,resultSuccessIconColor:h,resultWarningIconColor:f,imageWidth:250,imageHeight:295});return[tee(g)]},n=>({titleFontSize:n.fontSizeHeading3,subtitleFontSize:n.fontSize,iconFontSize:n.fontSizeHeading3*3,extraMargin:`${n.paddingLG}px 0 0 0`})),nee={success:j8,error:$8,info:V8,warning:WQ},kp={404:qQ,500:XQ,403:KQ},iee=Object.keys(kp),oee=n=>{let{prefixCls:o,icon:l,status:h}=n;const f=$t(`${o}-icon`);if(iee.includes(`${h}`)){const x=kp[h];return A.createElement("div",{className:`${f} ${o}-image`},A.createElement(x,null))}const g=A.createElement(nee[h]);return l===null||l===!1?null:A.createElement("div",{className:f},l||g)},aee=n=>{let{prefixCls:o,extra:l}=n;return l?A.createElement("div",{className:`${o}-extra`},l):null},cy=n=>{let{prefixCls:o,className:l,rootClassName:h,subTitle:f,title:g,style:x,children:E,status:w="info",icon:I,extra:R}=n;const{getPrefixCls:D,direction:F,result:q}=A.useContext(wn),G=D("result",o),[j,te]=ree(G),N=$t(G,`${G}-${w}`,l,q==null?void 0:q.className,h,{[`${G}-rtl`]:F==="rtl"},te),O=Object.assign(Object.assign({},q==null?void 0:q.style),x);return j(A.createElement("div",{className:N,style:O},A.createElement(oee,{prefixCls:G,status:w,icon:I}),A.createElement("div",{className:`${G}-title`},g),f&&A.createElement("div",{className:`${G}-subtitle`},f),A.createElement(aee,{prefixCls:G,extra:R}),E&&A.createElement("div",{className:`${G}-content`},E)))};cy.PRESENTED_IMAGE_403=kp[403];cy.PRESENTED_IMAGE_404=kp[404];cy.PRESENTED_IMAGE_500=kp[500];const CD=cy;var cE={},AD={exports:{}};(function(n){function o(l){return l&&l.__esModule?l:{default:l}}n.exports=o,n.exports.__esModule=!0,n.exports.default=n.exports})(AD);var uE=AD.exports,uy={};Object.defineProperty(uy,"__esModule",{value:!0});uy.default=void 0;var see={items_per_page:"条/页",jump_to:"跳至",jump_to_confirm:"确定",page:"页",prev_page:"上一页",next_page:"下一页",prev_5:"向前 5 页",next_5:"向后 5 页",prev_3:"向前 3 页",next_3:"向后 3 页",page_size:"页码"};uy.default=see;var hy={},Rp={},dy={};Object.defineProperty(dy,"__esModule",{value:!0});dy.default=void 0;var lee={locale:"zh_CN",today:"今天",now:"此刻",backToToday:"返回今天",ok:"确定",timeSelect:"选择时间",dateSelect:"选择日期",weekSelect:"选择周",clear:"清除",month:"月",year:"年",previousMonth:"上个月 (翻页上键)",nextMonth:"下个月 (翻页下键)",monthSelect:"选择月份",yearSelect:"选择年份",decadeSelect:"选择年代",yearFormat:"YYYY年",dayFormat:"D日",dateFormat:"YYYY年M月D日",dateTimeFormat:"YYYY年M月D日 HH时mm分ss秒",previousYear:"上一年 (Control键加左方向键)",nextYear:"下一年 (Control键加右方向键)",previousDecade:"上一年代",nextDecade:"下一年代",previousCentury:"上一世纪",nextCentury:"下一世纪"},cee=lee;dy.default=cee;var zp={};Object.defineProperty(zp,"__esModule",{value:!0});zp.default=void 0;const uee={placeholder:"请选择时间",rangePlaceholder:["开始时间","结束时间"]};var hee=uee;zp.default=hee;var ID=uE.default;Object.defineProperty(Rp,"__esModule",{value:!0});Rp.default=void 0;var dee=ID(dy),fee=ID(zp);const PD={lang:Object.assign({placeholder:"请选择日期",yearPlaceholder:"请选择年份",quarterPlaceholder:"请选择季度",monthPlaceholder:"请选择月份",weekPlaceholder:"请选择周",rangePlaceholder:["开始日期","结束日期"],rangeYearPlaceholder:["开始年份","结束年份"],rangeMonthPlaceholder:["开始月份","结束月份"],rangeQuarterPlaceholder:["开始季度","结束季度"],rangeWeekPlaceholder:["开始周","结束周"]},dee.default),timePickerLocale:Object.assign({},fee.default)};PD.lang.ok="确定";var pee=PD;Rp.default=pee;var mee=uE.default;Object.defineProperty(hy,"__esModule",{value:!0});hy.default=void 0;var gee=mee(Rp),_ee=gee.default;hy.default=_ee;var fy=uE.default;Object.defineProperty(cE,"__esModule",{value:!0});var kD=cE.default=void 0,yee=fy(uy),vee=fy(hy),xee=fy(Rp),bee=fy(zp);const mo="${label}不是一个有效的${type}",wee={locale:"zh-cn",Pagination:yee.default,DatePicker:xee.default,TimePicker:bee.default,Calendar:vee.default,global:{placeholder:"请选择"},Table:{filterTitle:"筛选",filterConfirm:"确定",filterReset:"重置",filterEmptyText:"无筛选项",filterCheckall:"全选",filterSearchPlaceholder:"在筛选项中搜索",selectAll:"全选当页",selectInvert:"反选当页",selectNone:"清空所有",selectionAll:"全选所有",sortTitle:"排序",expand:"展开行",collapse:"关闭行",triggerDesc:"点击降序",triggerAsc:"点击升序",cancelSort:"取消排序"},Modal:{okText:"确定",cancelText:"取消",justOkText:"知道了"},Tour:{Next:"下一步",Previous:"上一步",Finish:"结束导览"},Popconfirm:{cancelText:"取消",okText:"确定"},Transfer:{titles:["",""],searchPlaceholder:"请输入搜索内容",itemUnit:"项",itemsUnit:"项",remove:"删除",selectCurrent:"全选当页",removeCurrent:"删除当页",selectAll:"全选所有",removeAll:"删除全部",selectInvert:"反选当页"},Upload:{uploading:"文件上传中",removeFile:"删除文件",uploadError:"上传错误",previewFile:"预览文件",downloadFile:"下载文件"},Empty:{description:"暂无数据"},Icon:{icon:"图标"},Text:{edit:"编辑",copy:"复制",copied:"复制成功",expand:"展开"},PageHeader:{back:"返回"},Form:{optional:"（可选）",defaultValidateMessages:{default:"字段验证错误${label}",required:"请输入${label}",enum:"${label}必须是其中一个[${enum}]",whitespace:"${label}不能为空字符",date:{format:"${label}日期格式无效",parse:"${label}不能转换为日期",invalid:"${label}是一个无效日期"},types:{string:mo,method:mo,array:mo,object:mo,number:mo,date:mo,boolean:mo,integer:mo,float:mo,regexp:mo,email:mo,url:mo,hex:mo},string:{len:"${label}须为${len}个字符",min:"${label}最少${min}个字符",max:"${label}最多${max}个字符",range:"${label}须在${min}-${max}字符之间"},number:{len:"${label}必须等于${len}",min:"${label}最小值为${min}",max:"${label}最大值为${max}",range:"${label}须在${min}-${max}之间"},array:{len:"须为${len}个${label}",min:"最少${min}个${label}",max:"最多${max}个${label}",range:"${label}数量须在${min}-${max}之间"},pattern:{mismatch:"${label}与模式不匹配${pattern}"}}},Image:{preview:"预览"},QRCode:{expired:"二维码过期",refresh:"点击刷新"},ColorPicker:{presetEmpty:"暂无"}};var Eee=wee;kD=cE.default=Eee;var Cw={},AP=Tp;Cw.createRoot=AP.createRoot,Cw.hydrateRoot=AP.hydrateRoot;const See="mapbox-gl-v3-demo",Tee="Mapbox GL JS v3 示例",Mee="0.1.0",Cee="huangli",Aee={prepare:"husky install",commit:"git-cz",dev:"vite",build:"tsc && vite build",preview:"vite preview",genlog:"conventional-changelog -p angular -i CHANGELOG.md -s",release:"standard-version && git push --follow-tags",lint:"eslint src --fix --ext .ts,.tsx,.vue,.js,.jsx",prettier:"prettier --write ."},Iee={"@naivemap/mapbox-gl-naive-map":"^0.2.0",ahooks:"^3.7.8",antd:"^5.8.2",axios:"^1.4.0",dayjs:"^1.11.9","mapbox-gl":"^3.0.0-beta.1",react:"^18.2.0","react-dom":"^18.2.0","react-router-dom":"^6.14.2",zustand:"^4.4.1"},Pee={"@commitlint/cli":"^17.6.7","@commitlint/config-conventional":"^17.6.7","@types/mapbox-gl":"^2.7.12","@types/react":"^18.2.19","@types/react-dom":"^18.2.7","@typescript-eslint/eslint-plugin":"^6.3.0","@typescript-eslint/parser":"^6.3.0","@vitejs/plugin-react":"^4.0.4","@vitejs/plugin-react-swc":"^3.3.2",autoprefixer:"^10.4.14",commitizen:"^4.3.0",consola:"^3.2.3","conventional-changelog-cli":"^3.0.0",eslint:"^8.46.0","eslint-config-prettier":"^9.0.0","eslint-plugin-react":"^7.33.1","eslint-plugin-react-hooks":"^4.6.0","git-cz":"^4.9.0",husky:"^8.0.3",less:"^4.2.0","lint-staged":"^13.2.3",postcss:"^8.4.27","standard-version":"^9.5.0",tailwindcss:"^3.3.3",typescript:"^5.1.6",vite:"^4.4.9"},kee={commitizen:{path:"git-cz"}},Ree={name:See,description:Tee,private:!0,version:Mee,author:Cee,scripts:Aee,dependencies:Iee,devDependencies:Pee,config:kee,"lint-staged":{"src/**/*.{ts,vue}":["yarn prettier","yarn lint"]}};/**
 * @remix-run/router v1.7.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function On(){return On=Object.assign?Object.assign.bind():function(n){for(var o=1;o<arguments.length;o++){var l=arguments[o];for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&(n[h]=l[h])}return n},On.apply(this,arguments)}var ti;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(ti||(ti={}));const IP="popstate";function zee(n){n===void 0&&(n={});function o(f,g){let{pathname:x="/",search:E="",hash:w=""}=Ga(f.location.hash.substr(1));return _p("",{pathname:x,search:E,hash:w},g.state&&g.state.usr||null,g.state&&g.state.key||"default")}function l(f,g){let x=f.document.querySelector("base"),E="";if(x&&x.getAttribute("href")){let w=f.location.href,I=w.indexOf("#");E=I===-1?w:w.slice(0,I)}return E+"#"+(typeof g=="string"?g:Fc(g))}function h(f,g){Oc(f.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(g)+")")}return Lee(o,l,h,n)}function Vr(n,o){if(n===!1||n===null||typeof n>"u")throw new Error(o)}function Oc(n,o){if(!n){typeof console<"u"&&console.warn(o);try{throw new Error(o)}catch{}}}function Dee(){return Math.random().toString(36).substr(2,8)}function PP(n,o){return{usr:n.state,key:n.key,idx:o}}function _p(n,o,l,h){return l===void 0&&(l=null),On({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof o=="string"?Ga(o):o,{state:l,key:o&&o.key||h||Dee()})}function Fc(n){let{pathname:o="/",search:l="",hash:h=""}=n;return l&&l!=="?"&&(o+=l.charAt(0)==="?"?l:"?"+l),h&&h!=="#"&&(o+=h.charAt(0)==="#"?h:"#"+h),o}function Ga(n){let o={};if(n){let l=n.indexOf("#");l>=0&&(o.hash=n.substr(l),n=n.substr(0,l));let h=n.indexOf("?");h>=0&&(o.search=n.substr(h),n=n.substr(0,h)),n&&(o.pathname=n)}return o}function Lee(n,o,l,h){h===void 0&&(h={});let{window:f=document.defaultView,v5Compat:g=!1}=h,x=f.history,E=ti.Pop,w=null,I=R();I==null&&(I=0,x.replaceState(On({},x.state,{idx:I}),""));function R(){return(x.state||{idx:null}).idx}function D(){E=ti.Pop;let te=R(),N=te==null?null:te-I;I=te,w&&w({action:E,location:j.location,delta:N})}function F(te,N){E=ti.Push;let O=_p(j.location,te,N);l&&l(O,te),I=R()+1;let V=PP(O,I),U=j.createHref(O);try{x.pushState(V,"",U)}catch(ae){if(ae instanceof DOMException&&ae.name==="DataCloneError")throw ae;f.location.assign(U)}g&&w&&w({action:E,location:j.location,delta:1})}function q(te,N){E=ti.Replace;let O=_p(j.location,te,N);l&&l(O,te),I=R();let V=PP(O,I),U=j.createHref(O);x.replaceState(V,"",U),g&&w&&w({action:E,location:j.location,delta:0})}function G(te){let N=f.location.origin!=="null"?f.location.origin:f.location.href,O=typeof te=="string"?te:Fc(te);return Vr(N,"No window.location.(origin|href) available to create URL for href: "+O),new URL(O,N)}let j={get action(){return E},get location(){return n(f,x)},listen(te){if(w)throw new Error("A history only accepts one active listener");return f.addEventListener(IP,D),w=te,()=>{f.removeEventListener(IP,D),w=null}},createHref(te){return o(f,te)},createURL:G,encodeLocation(te){let N=G(te);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:F,replace:q,go(te){return x.go(te)}};return j}var si;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(si||(si={}));const Oee=new Set(["lazy","caseSensitive","path","id","index","children"]);function Fee(n){return n.index===!0}function Aw(n,o,l,h){return l===void 0&&(l=[]),h===void 0&&(h={}),n.map((f,g)=>{let x=[...l,g],E=typeof f.id=="string"?f.id:x.join("-");if(Vr(f.index!==!0||!f.children,"Cannot specify children on an index route"),Vr(!h[E],'Found a route id collision on id "'+E+`".  Route id's must be globally unique within Data Router usages`),Fee(f)){let w=On({},f,o(f),{id:E});return h[E]=w,w}else{let w=On({},f,o(f),{id:E,children:void 0});return h[E]=w,f.children&&(w.children=Aw(f.children,o,x,h)),w}})}function wh(n,o,l){l===void 0&&(l="/");let h=typeof o=="string"?Ga(o):o,f=rd(h.pathname||"/",l);if(f==null)return null;let g=RD(n);Bee(g);let x=null;for(let E=0;x==null&&E<g.length;++E)x=qee(g[E],Yee(f));return x}function RD(n,o,l,h){o===void 0&&(o=[]),l===void 0&&(l=[]),h===void 0&&(h="");let f=(g,x,E)=>{let w={relativePath:E===void 0?g.path||"":E,caseSensitive:g.caseSensitive===!0,childrenIndex:x,route:g};w.relativePath.startsWith("/")&&(Vr(w.relativePath.startsWith(h),'Absolute route path "'+w.relativePath+'" nested under path '+('"'+h+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),w.relativePath=w.relativePath.slice(h.length));let I=vs([h,w.relativePath]),R=l.concat(w);g.children&&g.children.length>0&&(Vr(g.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+I+'".')),RD(g.children,o,R,I)),!(g.path==null&&!g.index)&&o.push({path:I,score:Wee(I,g.index),routesMeta:R})};return n.forEach((g,x)=>{var E;if(g.path===""||!((E=g.path)!=null&&E.includes("?")))f(g,x);else for(let w of zD(g.path))f(g,x,w)}),o}function zD(n){let o=n.split("/");if(o.length===0)return[];let[l,...h]=o,f=l.endsWith("?"),g=l.replace(/\?$/,"");if(h.length===0)return f?[g,""]:[g];let x=zD(h.join("/")),E=[];return E.push(...x.map(w=>w===""?g:[g,w].join("/"))),f&&E.push(...x),E.map(w=>n.startsWith("/")&&w===""?"/":w)}function Bee(n){n.sort((o,l)=>o.score!==l.score?l.score-o.score:Hee(o.routesMeta.map(h=>h.childrenIndex),l.routesMeta.map(h=>h.childrenIndex)))}const Nee=/^:\w+$/,jee=3,$ee=2,Vee=1,Uee=10,Gee=-2,kP=n=>n==="*";function Wee(n,o){let l=n.split("/"),h=l.length;return l.some(kP)&&(h+=Gee),o&&(h+=$ee),l.filter(f=>!kP(f)).reduce((f,g)=>f+(Nee.test(g)?jee:g===""?Vee:Uee),h)}function Hee(n,o){return n.length===o.length&&n.slice(0,-1).every((h,f)=>h===o[f])?n[n.length-1]-o[o.length-1]:0}function qee(n,o){let{routesMeta:l}=n,h={},f="/",g=[];for(let x=0;x<l.length;++x){let E=l[x],w=x===l.length-1,I=f==="/"?o:o.slice(f.length)||"/",R=Zee({path:E.relativePath,caseSensitive:E.caseSensitive,end:w},I);if(!R)return null;Object.assign(h,R.params);let D=E.route;g.push({params:h,pathname:vs([f,R.pathname]),pathnameBase:ete(vs([f,R.pathnameBase])),route:D}),R.pathnameBase!=="/"&&(f=vs([f,R.pathnameBase]))}return g}function Zee(n,o){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[l,h]=Xee(n.path,n.caseSensitive,n.end),f=o.match(l);if(!f)return null;let g=f[0],x=g.replace(/(.)\/+$/,"$1"),E=f.slice(1);return{params:h.reduce((I,R,D)=>{if(R==="*"){let F=E[D]||"";x=g.slice(0,g.length-F.length).replace(/(.)\/+$/,"$1")}return I[R]=Kee(E[D]||"",R),I},{}),pathname:g,pathnameBase:x,pattern:n}}function Xee(n,o,l){o===void 0&&(o=!1),l===void 0&&(l=!0),Oc(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let h=[],f="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^$?{}|()[\]]/g,"\\$&").replace(/\/:(\w+)/g,(x,E)=>(h.push(E),"/([^\\/]+)"));return n.endsWith("*")?(h.push("*"),f+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):l?f+="\\/*$":n!==""&&n!=="/"&&(f+="(?:(?=\\/|$))"),[new RegExp(f,o?void 0:"i"),h]}function Yee(n){try{return decodeURI(n)}catch(o){return Oc(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+o+").")),n}}function Kee(n,o){try{return decodeURIComponent(n)}catch(l){return Oc(!1,'The value for the URL param "'+o+'" will not be decoded because'+(' the string "'+n+'" is a malformed URL segment. This is probably')+(" due to a bad percent encoding ("+l+").")),n}}function rd(n,o){if(o==="/")return n;if(!n.toLowerCase().startsWith(o.toLowerCase()))return null;let l=o.endsWith("/")?o.length-1:o.length,h=n.charAt(l);return h&&h!=="/"?null:n.slice(l)||"/"}function Jee(n,o){o===void 0&&(o="/");let{pathname:l,search:h="",hash:f=""}=typeof n=="string"?Ga(n):n;return{pathname:l?l.startsWith("/")?l:Qee(l,o):o,search:tte(h),hash:rte(f)}}function Qee(n,o){let l=o.replace(/\/+$/,"").split("/");return n.split("/").forEach(f=>{f===".."?l.length>1&&l.pop():f!=="."&&l.push(f)}),l.length>1?l.join("/"):"/"}function Wb(n,o,l,h){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+o+"` field ["+JSON.stringify(h)+"].  Please separate it out to the ")+("`to."+l+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function py(n){return n.filter((o,l)=>l===0||o.route.path&&o.route.path.length>0)}function hE(n,o,l,h){h===void 0&&(h=!1);let f;typeof n=="string"?f=Ga(n):(f=On({},n),Vr(!f.pathname||!f.pathname.includes("?"),Wb("?","pathname","search",f)),Vr(!f.pathname||!f.pathname.includes("#"),Wb("#","pathname","hash",f)),Vr(!f.search||!f.search.includes("#"),Wb("#","search","hash",f)));let g=n===""||f.pathname==="",x=g?"/":f.pathname,E;if(h||x==null)E=l;else{let D=o.length-1;if(x.startsWith("..")){let F=x.split("/");for(;F[0]==="..";)F.shift(),D-=1;f.pathname=F.join("/")}E=D>=0?o[D]:"/"}let w=Jee(f,E),I=x&&x!=="/"&&x.endsWith("/"),R=(g||x===".")&&l.endsWith("/");return!w.pathname.endsWith("/")&&(I||R)&&(w.pathname+="/"),w}const vs=n=>n.join("/").replace(/\/\/+/g,"/"),ete=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),tte=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,rte=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;class dE{constructor(o,l,h,f){f===void 0&&(f=!1),this.status=o,this.statusText=l||"",this.internal=f,h instanceof Error?(this.data=h.toString(),this.error=h):this.data=h}}function DD(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const LD=["post","put","patch","delete"],nte=new Set(LD),ite=["get",...LD],ote=new Set(ite),ate=new Set([301,302,303,307,308]),ste=new Set([307,308]),Hb={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},lte={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},xf={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},OD=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,cte=n=>({hasErrorBoundary:!!n.hasErrorBoundary});function ute(n){const o=n.window?n.window:typeof window<"u"?window:void 0,l=typeof o<"u"&&typeof o.document<"u"&&typeof o.document.createElement<"u",h=!l;Vr(n.routes.length>0,"You must provide a non-empty routes array to createRouter");let f;if(n.mapRouteProperties)f=n.mapRouteProperties;else if(n.detectErrorBoundary){let Te=n.detectErrorBoundary;f=Pe=>({hasErrorBoundary:Te(Pe)})}else f=cte;let g={},x=Aw(n.routes,f,void 0,g),E,w=n.basename||"/",I=On({v7_normalizeFormMethod:!1,v7_prependBasename:!1},n.future),R=null,D=new Set,F=null,q=null,G=null,j=n.hydrationData!=null,te=wh(x,n.history.location,w),N=null;if(te==null){let Te=No(404,{pathname:n.history.location.pathname}),{matches:Pe,route:et}=NP(x);te=Pe,N={[et.id]:Te}}let O=!te.some(Te=>Te.route.lazy)&&(!te.some(Te=>Te.route.loader)||n.hydrationData!=null),V,U={historyAction:n.history.action,location:n.history.location,matches:te,initialized:O,navigation:Hb,restoreScrollPosition:n.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:n.hydrationData&&n.hydrationData.loaderData||{},actionData:n.hydrationData&&n.hydrationData.actionData||null,errors:n.hydrationData&&n.hydrationData.errors||N,fetchers:new Map,blockers:new Map},ae=ti.Pop,le=!1,ne,de=!1,$=!1,ue=[],xe=[],ce=new Map,se=0,ke=-1,$e=new Map,Ne=new Set,it=new Map,Re=new Map,He=new Map,Xe=!1;function ze(){return R=n.history.listen(Te=>{let{action:Pe,location:et,delta:_t}=Te;if(Xe){Xe=!1;return}Oc(He.size===0||_t!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Rt=At({currentLocation:U.location,nextLocation:et,historyAction:Pe});if(Rt&&_t!=null){Xe=!0,n.history.go(_t*-1),Tt(Rt,{state:"blocked",location:et,proceed(){Tt(Rt,{state:"proceeding",proceed:void 0,reset:void 0,location:et}),n.history.go(_t)},reset(){let bt=new Map(U.blockers);bt.set(Rt,xf),mt({blockers:bt})}});return}return Sr(Pe,et)}),U.initialized||Sr(ti.Pop,U.location),V}function at(){R&&R(),D.clear(),ne&&ne.abort(),U.fetchers.forEach((Te,Pe)=>re(Pe)),U.blockers.forEach((Te,Pe)=>gt(Pe))}function Pt(Te){return D.add(Te),()=>D.delete(Te)}function mt(Te){U=On({},U,Te),D.forEach(Pe=>Pe(U))}function kt(Te,Pe){var et,_t;let Rt=U.actionData!=null&&U.navigation.formMethod!=null&&da(U.navigation.formMethod)&&U.navigation.state==="loading"&&((et=Te.state)==null?void 0:et._isRedirect)!==!0,bt;Pe.actionData?Object.keys(Pe.actionData).length>0?bt=Pe.actionData:bt=null:Rt?bt=U.actionData:bt=null;let ct=Pe.loaderData?BP(U.loaderData,Pe.loaderData,Pe.matches||[],Pe.errors):U.loaderData,It=U.blockers;It.size>0&&(It=new Map(It),It.forEach((ye,be)=>It.set(be,xf)));let Mt=le===!0||U.navigation.formMethod!=null&&da(U.navigation.formMethod)&&((_t=Te.state)==null?void 0:_t._isRedirect)!==!0;E&&(x=E,E=void 0),de||ae===ti.Pop||(ae===ti.Push?n.history.push(Te,Te.state):ae===ti.Replace&&n.history.replace(Te,Te.state)),mt(On({},Pe,{actionData:bt,loaderData:ct,historyAction:ae,location:Te,initialized:!0,navigation:Hb,revalidation:"idle",restoreScrollPosition:Yr(Te,Pe.matches||U.matches),preventScrollReset:Mt,blockers:It})),ae=ti.Pop,le=!1,de=!1,$=!1,ue=[],xe=[]}async function Oe(Te,Pe){if(typeof Te=="number"){n.history.go(Te);return}let et=Iw(U.location,U.matches,w,I.v7_prependBasename,Te,Pe==null?void 0:Pe.fromRouteId,Pe==null?void 0:Pe.relative),{path:_t,submission:Rt,error:bt}=RP(I.v7_normalizeFormMethod,!1,et,Pe),ct=U.location,It=_p(U.location,_t,Pe&&Pe.state);It=On({},It,n.history.encodeLocation(It));let Mt=Pe&&Pe.replace!=null?Pe.replace:void 0,ye=ti.Push;Mt===!0?ye=ti.Replace:Mt===!1||Rt!=null&&da(Rt.formMethod)&&Rt.formAction===U.location.pathname+U.location.search&&(ye=ti.Replace);let be=Pe&&"preventScrollReset"in Pe?Pe.preventScrollReset===!0:void 0,Me=At({currentLocation:ct,nextLocation:It,historyAction:ye});if(Me){Tt(Me,{state:"blocked",location:It,proceed(){Tt(Me,{state:"proceeding",proceed:void 0,reset:void 0,location:It}),Oe(Te,Pe)},reset(){let De=new Map(U.blockers);De.set(Me,xf),mt({blockers:De})}});return}return await Sr(ye,It,{submission:Rt,pendingError:bt,preventScrollReset:be,replace:Pe&&Pe.replace})}function qt(){if(Y(),mt({revalidation:"loading"}),U.navigation.state!=="submitting"){if(U.navigation.state==="idle"){Sr(U.historyAction,U.location,{startUninterruptedRevalidation:!0});return}Sr(ae||U.historyAction,U.navigation.location,{overrideNavigation:U.navigation})}}async function Sr(Te,Pe,et){ne&&ne.abort(),ne=null,ae=Te,de=(et&&et.startUninterruptedRevalidation)===!0,Cr(U.location,U.matches),le=(et&&et.preventScrollReset)===!0;let _t=E||x,Rt=et&&et.overrideNavigation,bt=wh(_t,Pe,w);if(!bt){let De=No(404,{pathname:Pe.pathname}),{matches:Le,route:qe}=NP(_t);mr(),kt(Pe,{matches:Le,loaderData:{},errors:{[qe.id]:De}});return}if(U.initialized&&!$&&mte(U.location,Pe)&&!(et&&et.submission&&da(et.submission.formMethod))){kt(Pe,{matches:bt});return}ne=new AbortController;let ct=wf(n.history,Pe,ne.signal,et&&et.submission),It,Mt;if(et&&et.pendingError)Mt={[Eh(bt).route.id]:et.pendingError};else if(et&&et.submission&&da(et.submission.formMethod)){let De=await Ir(ct,Pe,et.submission,bt,{replace:et.replace});if(De.shortCircuited)return;It=De.pendingActionData,Mt=De.pendingActionError,Rt=f0(Pe,et.submission),ct=new Request(ct.url,{signal:ct.signal})}let{shortCircuited:ye,loaderData:be,errors:Me}=await Xr(ct,Pe,bt,Rt,et&&et.submission,et&&et.fetcherSubmission,et&&et.replace,It,Mt);ye||(ne=null,kt(Pe,On({matches:bt},It?{actionData:It}:{},{loaderData:be,errors:Me})))}async function Ir(Te,Pe,et,_t,Rt){Rt===void 0&&(Rt={}),Y();let bt=xte(Pe,et);mt({navigation:bt});let ct,It=kw(_t,Pe);if(!It.route.action&&!It.route.lazy)ct={type:si.error,error:No(405,{method:Te.method,pathname:Pe.pathname,routeId:It.route.id})};else if(ct=await bf("action",Te,It,_t,g,f,w),Te.signal.aborted)return{shortCircuited:!0};if(kh(ct)){let Mt;return Rt&&Rt.replace!=null?Mt=Rt.replace:Mt=ct.location===U.location.pathname+U.location.search,await xr(U,ct,{submission:et,replace:Mt}),{shortCircuited:!0}}if(Gf(ct)){let Mt=Eh(_t,It.route.id);return(Rt&&Rt.replace)!==!0&&(ae=ti.Push),{pendingActionData:{},pendingActionError:{[Mt.route.id]:ct.error}}}if(bc(ct))throw No(400,{type:"defer-action"});return{pendingActionData:{[It.route.id]:ct.data}}}async function Xr(Te,Pe,et,_t,Rt,bt,ct,It,Mt){let ye=_t||f0(Pe,Rt),be=Rt||bt||VP(ye),Me=E||x,[De,Le]=zP(n.history,U,et,be,Pe,$,ue,xe,it,Ne,Me,w,It,Mt);if(mr(Bt=>!(et&&et.some(yr=>yr.route.id===Bt))||De&&De.some(yr=>yr.route.id===Bt)),ke=++se,De.length===0&&Le.length===0){let Bt=Qe();return kt(Pe,On({matches:et,loaderData:{},errors:Mt||null},It?{actionData:It}:{},Bt?{fetchers:new Map(U.fetchers)}:{})),{shortCircuited:!0}}if(!de){Le.forEach(yr=>{let Qr=U.fetchers.get(yr.key),Wn=Ef(void 0,Qr?Qr.data:void 0);U.fetchers.set(yr.key,Wn)});let Bt=It||U.actionData;mt(On({navigation:ye},Bt?Object.keys(Bt).length===0?{actionData:null}:{actionData:Bt}:{},Le.length>0?{fetchers:new Map(U.fetchers)}:{}))}Le.forEach(Bt=>{ce.has(Bt.key)&&we(Bt.key),Bt.controller&&ce.set(Bt.key,Bt.controller)});let qe=()=>Le.forEach(Bt=>we(Bt.key));ne&&ne.signal.addEventListener("abort",qe);let{results:Ue,loaderResults:Ze,fetcherResults:ot}=await Fe(U.matches,et,De,Le,Te);if(Te.signal.aborted)return{shortCircuited:!0};ne&&ne.signal.removeEventListener("abort",qe),Le.forEach(Bt=>ce.delete(Bt.key));let We=jP(Ue);if(We){if(We.idx>=De.length){let Bt=Le[We.idx-De.length].key;Ne.add(Bt)}return await xr(U,We.result,{replace:ct}),{shortCircuited:!0}}let{loaderData:xt,errors:rr}=FP(U,et,De,Ze,Mt,Le,ot,Re);Re.forEach((Bt,yr)=>{Bt.subscribe(Qr=>{(Qr||Bt.done)&&Re.delete(yr)})});let yt=Qe(),_r=tt(ke),wr=yt||_r||Le.length>0;return On({loaderData:xt,errors:rr},wr?{fetchers:new Map(U.fetchers)}:{})}function Ur(Te){return U.fetchers.get(Te)||lte}function pr(Te,Pe,et,_t){if(h)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");ce.has(Te)&&we(Te);let Rt=E||x,bt=Iw(U.location,U.matches,w,I.v7_prependBasename,et,Pe,_t==null?void 0:_t.relative),ct=wh(Rt,bt,w);if(!ct){ee(Te,Pe,No(404,{pathname:bt}));return}let{path:It,submission:Mt,error:ye}=RP(I.v7_normalizeFormMethod,!0,bt,_t);if(ye){ee(Te,Pe,ye);return}let be=kw(ct,It);if(le=(_t&&_t.preventScrollReset)===!0,Mt&&da(Mt.formMethod)){ar(Te,Pe,It,be,ct,Mt);return}it.set(Te,{routeId:Pe,path:It}),hr(Te,Pe,It,be,ct,Mt)}async function ar(Te,Pe,et,_t,Rt,bt){if(Y(),it.delete(Te),!_t.route.action&&!_t.route.lazy){let Er=No(405,{method:bt.formMethod,pathname:et,routeId:Pe});ee(Te,Pe,Er);return}let ct=U.fetchers.get(Te),It=bte(bt,ct);U.fetchers.set(Te,It),mt({fetchers:new Map(U.fetchers)});let Mt=new AbortController,ye=wf(n.history,et,Mt.signal,bt);ce.set(Te,Mt);let be=se,Me=await bf("action",ye,_t,Rt,g,f,w);if(ye.signal.aborted){ce.get(Te)===Mt&&ce.delete(Te);return}if(kh(Me))if(ce.delete(Te),ke>be){let Er=oh(void 0);U.fetchers.set(Te,Er),mt({fetchers:new Map(U.fetchers)});return}else{Ne.add(Te);let Er=Ef(bt);return U.fetchers.set(Te,Er),mt({fetchers:new Map(U.fetchers)}),xr(U,Me,{submission:bt,isFetchActionRedirect:!0})}if(Gf(Me)){ee(Te,Pe,Me.error);return}if(bc(Me))throw No(400,{type:"defer-action"});let De=U.navigation.location||U.location,Le=wf(n.history,De,Mt.signal),qe=E||x,Ue=U.navigation.state!=="idle"?wh(qe,U.navigation.location,w):U.matches;Vr(Ue,"Didn't find any matches after fetcher action");let Ze=++se;$e.set(Te,Ze);let ot=Ef(bt,Me.data);U.fetchers.set(Te,ot);let[We,xt]=zP(n.history,U,Ue,bt,De,$,ue,xe,it,Ne,qe,w,{[_t.route.id]:Me.data},void 0);xt.filter(Er=>Er.key!==Te).forEach(Er=>{let on=Er.key,Br=U.fetchers.get(on),ro=Ef(void 0,Br?Br.data:void 0);U.fetchers.set(on,ro),ce.has(on)&&we(on),Er.controller&&ce.set(on,Er.controller)}),mt({fetchers:new Map(U.fetchers)});let rr=()=>xt.forEach(Er=>we(Er.key));Mt.signal.addEventListener("abort",rr);let{results:yt,loaderResults:_r,fetcherResults:wr}=await Fe(U.matches,Ue,We,xt,Le);if(Mt.signal.aborted)return;Mt.signal.removeEventListener("abort",rr),$e.delete(Te),ce.delete(Te),xt.forEach(Er=>ce.delete(Er.key));let Bt=jP(yt);if(Bt){if(Bt.idx>=We.length){let Er=xt[Bt.idx-We.length].key;Ne.add(Er)}return xr(U,Bt.result)}let{loaderData:yr,errors:Qr}=FP(U,U.matches,We,_r,void 0,xt,wr,Re);if(U.fetchers.has(Te)){let Er=oh(Me.data);U.fetchers.set(Te,Er)}let Wn=tt(Ze);U.navigation.state==="loading"&&Ze>ke?(Vr(ae,"Expected pending action"),ne&&ne.abort(),kt(U.navigation.location,{matches:Ue,loaderData:yr,errors:Qr,fetchers:new Map(U.fetchers)})):(mt(On({errors:Qr,loaderData:BP(U.loaderData,yr,Ue,Qr)},Wn||xt.length>0?{fetchers:new Map(U.fetchers)}:{})),$=!1)}async function hr(Te,Pe,et,_t,Rt,bt){let ct=U.fetchers.get(Te),It=Ef(bt,ct?ct.data:void 0);U.fetchers.set(Te,It),mt({fetchers:new Map(U.fetchers)});let Mt=new AbortController,ye=wf(n.history,et,Mt.signal);ce.set(Te,Mt);let be=se,Me=await bf("loader",ye,_t,Rt,g,f,w);if(bc(Me)&&(Me=await ND(Me,ye.signal,!0)||Me),ce.get(Te)===Mt&&ce.delete(Te),ye.signal.aborted)return;if(kh(Me))if(ke>be){let Le=oh(void 0);U.fetchers.set(Te,Le),mt({fetchers:new Map(U.fetchers)});return}else{Ne.add(Te),await xr(U,Me);return}if(Gf(Me)){let Le=Eh(U.matches,Pe);U.fetchers.delete(Te),mt({fetchers:new Map(U.fetchers),errors:{[Le.route.id]:Me.error}});return}Vr(!bc(Me),"Unhandled fetcher deferred data");let De=oh(Me.data);U.fetchers.set(Te,De),mt({fetchers:new Map(U.fetchers)})}async function xr(Te,Pe,et){let{submission:_t,replace:Rt,isFetchActionRedirect:bt}=et===void 0?{}:et;Pe.revalidate&&($=!0);let ct=_p(Te.location,Pe.location,On({_isRedirect:!0},bt?{_isFetchActionRedirect:!0}:{}));if(Vr(ct,"Expected a location on the redirect navigation"),OD.test(Pe.location)&&l){let ye=n.history.createURL(Pe.location),be=rd(ye.pathname,w)==null;if(o.location.origin!==ye.origin||be){Rt?o.location.replace(Pe.location):o.location.assign(Pe.location);return}}ne=null;let It=Rt===!0?ti.Replace:ti.Push,Mt=_t||VP(Te.navigation);if(ste.has(Pe.status)&&Mt&&da(Mt.formMethod))await Sr(It,ct,{submission:On({},Mt,{formAction:Pe.location}),preventScrollReset:le});else if(bt)await Sr(It,ct,{overrideNavigation:f0(ct),fetcherSubmission:Mt,preventScrollReset:le});else{let ye=f0(ct,Mt);await Sr(It,ct,{overrideNavigation:ye,preventScrollReset:le})}}async function Fe(Te,Pe,et,_t,Rt){let bt=await Promise.all([...et.map(Mt=>bf("loader",Rt,Mt,Pe,g,f,w)),..._t.map(Mt=>Mt.matches&&Mt.match&&Mt.controller?bf("loader",wf(n.history,Mt.path,Mt.controller.signal),Mt.match,Mt.matches,g,f,w):{type:si.error,error:No(404,{pathname:Mt.path})})]),ct=bt.slice(0,et.length),It=bt.slice(et.length);return await Promise.all([$P(Te,et,ct,ct.map(()=>Rt.signal),!1,U.loaderData),$P(Te,_t.map(Mt=>Mt.match),It,_t.map(Mt=>Mt.controller?Mt.controller.signal:null),!0)]),{results:bt,loaderResults:ct,fetcherResults:It}}function Y(){$=!0,ue.push(...mr()),it.forEach((Te,Pe)=>{ce.has(Pe)&&(xe.push(Pe),we(Pe))})}function ee(Te,Pe,et){let _t=Eh(U.matches,Pe);re(Te),mt({errors:{[_t.route.id]:et},fetchers:new Map(U.fetchers)})}function re(Te){let Pe=U.fetchers.get(Te);ce.has(Te)&&!(Pe&&Pe.state==="loading"&&$e.has(Te))&&we(Te),it.delete(Te),$e.delete(Te),Ne.delete(Te),U.fetchers.delete(Te)}function we(Te){let Pe=ce.get(Te);Vr(Pe,"Expected fetch controller: "+Te),Pe.abort(),ce.delete(Te)}function Ie(Te){for(let Pe of Te){let et=Ur(Pe),_t=oh(et.data);U.fetchers.set(Pe,_t)}}function Qe(){let Te=[],Pe=!1;for(let et of Ne){let _t=U.fetchers.get(et);Vr(_t,"Expected fetcher: "+et),_t.state==="loading"&&(Ne.delete(et),Te.push(et),Pe=!0)}return Ie(Te),Pe}function tt(Te){let Pe=[];for(let[et,_t]of $e)if(_t<Te){let Rt=U.fetchers.get(et);Vr(Rt,"Expected fetcher: "+et),Rt.state==="loading"&&(we(et),$e.delete(et),Pe.push(et))}return Ie(Pe),Pe.length>0}function Be(Te,Pe){let et=U.blockers.get(Te)||xf;return He.get(Te)!==Pe&&He.set(Te,Pe),et}function gt(Te){U.blockers.delete(Te),He.delete(Te)}function Tt(Te,Pe){let et=U.blockers.get(Te)||xf;Vr(et.state==="unblocked"&&Pe.state==="blocked"||et.state==="blocked"&&Pe.state==="blocked"||et.state==="blocked"&&Pe.state==="proceeding"||et.state==="blocked"&&Pe.state==="unblocked"||et.state==="proceeding"&&Pe.state==="unblocked","Invalid blocker state transition: "+et.state+" -> "+Pe.state);let _t=new Map(U.blockers);_t.set(Te,Pe),mt({blockers:_t})}function At(Te){let{currentLocation:Pe,nextLocation:et,historyAction:_t}=Te;if(He.size===0)return;He.size>1&&Oc(!1,"A router only supports one blocker at a time");let Rt=Array.from(He.entries()),[bt,ct]=Rt[Rt.length-1],It=U.blockers.get(bt);if(!(It&&It.state==="proceeding")&&ct({currentLocation:Pe,nextLocation:et,historyAction:_t}))return bt}function mr(Te){let Pe=[];return Re.forEach((et,_t)=>{(!Te||Te(_t))&&(et.cancel(),Pe.push(_t),Re.delete(_t))}),Pe}function nn(Te,Pe,et){if(F=Te,G=Pe,q=et||null,!j&&U.navigation===Hb){j=!0;let _t=Yr(U.location,U.matches);_t!=null&&mt({restoreScrollPosition:_t})}return()=>{F=null,G=null,q=null}}function Pr(Te,Pe){return q&&q(Te,Pe.map(_t=>vte(_t,U.loaderData)))||Te.key}function Cr(Te,Pe){if(F&&G){let et=Pr(Te,Pe);F[et]=G()}}function Yr(Te,Pe){if(F){let et=Pr(Te,Pe),_t=F[et];if(typeof _t=="number")return _t}return null}function br(Te){g={},E=Aw(Te,f,void 0,g)}return V={get basename(){return w},get state(){return U},get routes(){return x},initialize:ze,subscribe:Pt,enableScrollRestoration:nn,navigate:Oe,fetch:pr,revalidate:qt,createHref:Te=>n.history.createHref(Te),encodeLocation:Te=>n.history.encodeLocation(Te),getFetcher:Ur,deleteFetcher:re,dispose:at,getBlocker:Be,deleteBlocker:gt,_internalFetchControllers:ce,_internalActiveDeferreds:Re,_internalSetRoutes:br},V}function hte(n){return n!=null&&("formData"in n&&n.formData!=null||"body"in n&&n.body!==void 0)}function Iw(n,o,l,h,f,g,x){let E,w;if(g!=null&&x!=="path"){E=[];for(let R of o)if(E.push(R),R.route.id===g){w=R;break}}else E=o,w=o[o.length-1];let I=hE(f||".",py(E).map(R=>R.pathnameBase),rd(n.pathname,l)||n.pathname,x==="path");return f==null&&(I.search=n.search,I.hash=n.hash),(f==null||f===""||f===".")&&w&&w.route.index&&!fE(I.search)&&(I.search=I.search?I.search.replace(/^\?/,"?index&"):"?index"),h&&l!=="/"&&(I.pathname=I.pathname==="/"?l:vs([l,I.pathname])),Fc(I)}function RP(n,o,l,h){if(!h||!hte(h))return{path:l};if(h.formMethod&&!yte(h.formMethod))return{path:l,error:No(405,{method:h.formMethod})};let f=()=>({path:l,error:No(400,{type:"invalid-body"})}),g=h.formMethod||"get",x=n?g.toUpperCase():g.toLowerCase(),E=BD(l);if(h.body!==void 0){if(h.formEncType==="text/plain"){if(!da(x))return f();let F=typeof h.body=="string"?h.body:h.body instanceof FormData||h.body instanceof URLSearchParams?Array.from(h.body.entries()).reduce((q,G)=>{let[j,te]=G;return""+q+j+"="+te+`
`},""):String(h.body);return{path:l,submission:{formMethod:x,formAction:E,formEncType:h.formEncType,formData:void 0,json:void 0,text:F}}}else if(h.formEncType==="application/json"){if(!da(x))return f();try{let F=typeof h.body=="string"?JSON.parse(h.body):h.body;return{path:l,submission:{formMethod:x,formAction:E,formEncType:h.formEncType,formData:void 0,json:F,text:void 0}}}catch{return f()}}}Vr(typeof FormData=="function","FormData is not available in this environment");let w,I;if(h.formData)w=Pw(h.formData),I=h.formData;else if(h.body instanceof FormData)w=Pw(h.body),I=h.body;else if(h.body instanceof URLSearchParams)w=h.body,I=OP(w);else if(h.body==null)w=new URLSearchParams,I=new FormData;else try{w=new URLSearchParams(h.body),I=OP(w)}catch{return f()}let R={formMethod:x,formAction:E,formEncType:h&&h.formEncType||"application/x-www-form-urlencoded",formData:I,json:void 0,text:void 0};if(da(R.formMethod))return{path:l,submission:R};let D=Ga(l);return o&&D.search&&fE(D.search)&&w.append("index",""),D.search="?"+w,{path:Fc(D),submission:R}}function dte(n,o){let l=n;if(o){let h=n.findIndex(f=>f.route.id===o);h>=0&&(l=n.slice(0,h))}return l}function zP(n,o,l,h,f,g,x,E,w,I,R,D,F,q){let G=q?Object.values(q)[0]:F?Object.values(F)[0]:void 0,j=n.createURL(o.location),te=n.createURL(f),N=q?Object.keys(q)[0]:void 0,V=dte(l,N).filter((ae,le)=>{if(ae.route.lazy)return!0;if(ae.route.loader==null)return!1;if(fte(o.loaderData,o.matches[le],ae)||x.some($=>$===ae.route.id))return!0;let ne=o.matches[le],de=ae;return DP(ae,On({currentUrl:j,currentParams:ne.params,nextUrl:te,nextParams:de.params},h,{actionResult:G,defaultShouldRevalidate:g||j.pathname+j.search===te.pathname+te.search||j.search!==te.search||FD(ne,de)}))}),U=[];return w.forEach((ae,le)=>{if(!l.some(xe=>xe.route.id===ae.routeId))return;let ne=wh(R,ae.path,D);if(!ne){U.push({key:le,routeId:ae.routeId,path:ae.path,matches:null,match:null,controller:null});return}let de=o.fetchers.get(le),$=kw(ne,ae.path),ue=!1;I.has(le)?ue=!1:E.includes(le)?ue=!0:de&&de.state!=="idle"&&de.data===void 0?ue=g:ue=DP($,On({currentUrl:j,currentParams:o.matches[o.matches.length-1].params,nextUrl:te,nextParams:l[l.length-1].params},h,{actionResult:G,defaultShouldRevalidate:g})),ue&&U.push({key:le,routeId:ae.routeId,path:ae.path,matches:ne,match:$,controller:new AbortController})}),[V,U]}function fte(n,o,l){let h=!o||l.route.id!==o.route.id,f=n[l.route.id]===void 0;return h||f}function FD(n,o){let l=n.route.path;return n.pathname!==o.pathname||l!=null&&l.endsWith("*")&&n.params["*"]!==o.params["*"]}function DP(n,o){if(n.route.shouldRevalidate){let l=n.route.shouldRevalidate(o);if(typeof l=="boolean")return l}return o.defaultShouldRevalidate}async function LP(n,o,l){if(!n.lazy)return;let h=await n.lazy();if(!n.lazy)return;let f=l[n.id];Vr(f,"No route found in manifest");let g={};for(let x in h){let w=f[x]!==void 0&&x!=="hasErrorBoundary";Oc(!w,'Route "'+f.id+'" has a static property "'+x+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+x+'" will be ignored.')),!w&&!Oee.has(x)&&(g[x]=h[x])}Object.assign(f,g),Object.assign(f,On({},o(f),{lazy:void 0}))}async function bf(n,o,l,h,f,g,x,E){E===void 0&&(E={});let w,I,R,D=G=>{let j,te=new Promise((N,O)=>j=O);return R=()=>j(),o.signal.addEventListener("abort",R),Promise.race([G({request:o,params:l.params,context:E.requestContext}),te])};try{let G=l.route[n];if(l.route.lazy)if(G)I=(await Promise.all([D(G),LP(l.route,g,f)]))[0];else if(await LP(l.route,g,f),G=l.route[n],G)I=await D(G);else if(n==="action"){let j=new URL(o.url),te=j.pathname+j.search;throw No(405,{method:o.method,pathname:te,routeId:l.route.id})}else return{type:si.data,data:void 0};else if(G)I=await D(G);else{let j=new URL(o.url),te=j.pathname+j.search;throw No(404,{pathname:te})}Vr(I!==void 0,"You defined "+(n==="action"?"an action":"a loader")+" for route "+('"'+l.route.id+"\" but didn't return anything from your `"+n+"` ")+"function. Please return a value or `null`.")}catch(G){w=si.error,I=G}finally{R&&o.signal.removeEventListener("abort",R)}if(_te(I)){let G=I.status;if(ate.has(G)){let N=I.headers.get("Location");if(Vr(N,"Redirects returned/thrown from loaders/actions must have a Location header"),!OD.test(N))N=Iw(new URL(o.url),h.slice(0,h.indexOf(l)+1),x,!0,N);else if(!E.isStaticRequest){let O=new URL(o.url),V=N.startsWith("//")?new URL(O.protocol+N):new URL(N),U=rd(V.pathname,x)!=null;V.origin===O.origin&&U&&(N=V.pathname+V.search+V.hash)}if(E.isStaticRequest)throw I.headers.set("Location",N),I;return{type:si.redirect,status:G,location:N,revalidate:I.headers.get("X-Remix-Revalidate")!==null}}if(E.isRouteRequest)throw{type:w||si.data,response:I};let j,te=I.headers.get("Content-Type");return te&&/\bapplication\/json\b/.test(te)?j=await I.json():j=await I.text(),w===si.error?{type:w,error:new dE(G,I.statusText,j),headers:I.headers}:{type:si.data,data:j,statusCode:I.status,headers:I.headers}}if(w===si.error)return{type:w,error:I};if(gte(I)){var F,q;return{type:si.deferred,deferredData:I,statusCode:(F=I.init)==null?void 0:F.status,headers:((q=I.init)==null?void 0:q.headers)&&new Headers(I.init.headers)}}return{type:si.data,data:I}}function wf(n,o,l,h){let f=n.createURL(BD(o)).toString(),g={signal:l};if(h&&da(h.formMethod)){let{formMethod:x,formEncType:E}=h;g.method=x.toUpperCase(),E==="application/json"?(g.headers=new Headers({"Content-Type":E}),g.body=JSON.stringify(h.json)):E==="text/plain"?g.body=h.text:E==="application/x-www-form-urlencoded"&&h.formData?g.body=Pw(h.formData):g.body=h.formData}return new Request(f,g)}function Pw(n){let o=new URLSearchParams;for(let[l,h]of n.entries())o.append(l,typeof h=="string"?h:h.name);return o}function OP(n){let o=new FormData;for(let[l,h]of n.entries())o.append(l,h);return o}function pte(n,o,l,h,f){let g={},x=null,E,w=!1,I={};return l.forEach((R,D)=>{let F=o[D].route.id;if(Vr(!kh(R),"Cannot handle redirect results in processLoaderData"),Gf(R)){let q=Eh(n,F),G=R.error;h&&(G=Object.values(h)[0],h=void 0),x=x||{},x[q.route.id]==null&&(x[q.route.id]=G),g[F]=void 0,w||(w=!0,E=DD(R.error)?R.error.status:500),R.headers&&(I[F]=R.headers)}else bc(R)?(f.set(F,R.deferredData),g[F]=R.deferredData.data):g[F]=R.data,R.statusCode!=null&&R.statusCode!==200&&!w&&(E=R.statusCode),R.headers&&(I[F]=R.headers)}),h&&(x=h,g[Object.keys(h)[0]]=void 0),{loaderData:g,errors:x,statusCode:E||200,loaderHeaders:I}}function FP(n,o,l,h,f,g,x,E){let{loaderData:w,errors:I}=pte(o,l,h,f,E);for(let R=0;R<g.length;R++){let{key:D,match:F,controller:q}=g[R];Vr(x!==void 0&&x[R]!==void 0,"Did not find corresponding fetcher result");let G=x[R];if(!(q&&q.signal.aborted))if(Gf(G)){let j=Eh(n.matches,F==null?void 0:F.route.id);I&&I[j.route.id]||(I=On({},I,{[j.route.id]:G.error})),n.fetchers.delete(D)}else if(kh(G))Vr(!1,"Unhandled fetcher revalidation redirect");else if(bc(G))Vr(!1,"Unhandled fetcher deferred data");else{let j=oh(G.data);n.fetchers.set(D,j)}}return{loaderData:w,errors:I}}function BP(n,o,l,h){let f=On({},o);for(let g of l){let x=g.route.id;if(o.hasOwnProperty(x)?o[x]!==void 0&&(f[x]=o[x]):n[x]!==void 0&&g.route.loader&&(f[x]=n[x]),h&&h.hasOwnProperty(x))break}return f}function Eh(n,o){return(o?n.slice(0,n.findIndex(h=>h.route.id===o)+1):[...n]).reverse().find(h=>h.route.hasErrorBoundary===!0)||n[0]}function NP(n){let o=n.find(l=>l.index||!l.path||l.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:o}],route:o}}function No(n,o){let{pathname:l,routeId:h,method:f,type:g}=o===void 0?{}:o,x="Unknown Server Error",E="Unknown @remix-run/router error";return n===400?(x="Bad Request",f&&l&&h?E="You made a "+f+' request to "'+l+'" but '+('did not provide a `loader` for route "'+h+'", ')+"so there is no way to handle the request.":g==="defer-action"?E="defer() is not supported in actions":g==="invalid-body"&&(E="Unable to encode submission body")):n===403?(x="Forbidden",E='Route "'+h+'" does not match URL "'+l+'"'):n===404?(x="Not Found",E='No route matches URL "'+l+'"'):n===405&&(x="Method Not Allowed",f&&l&&h?E="You made a "+f.toUpperCase()+' request to "'+l+'" but '+('did not provide an `action` for route "'+h+'", ')+"so there is no way to handle the request.":f&&(E='Invalid request method "'+f.toUpperCase()+'"')),new dE(n||500,x,new Error(E),!0)}function jP(n){for(let o=n.length-1;o>=0;o--){let l=n[o];if(kh(l))return{result:l,idx:o}}}function BD(n){let o=typeof n=="string"?Ga(n):n;return Fc(On({},o,{hash:""}))}function mte(n,o){return n.pathname!==o.pathname||n.search!==o.search?!1:n.hash===""?o.hash!=="":n.hash===o.hash?!0:o.hash!==""}function bc(n){return n.type===si.deferred}function Gf(n){return n.type===si.error}function kh(n){return(n&&n.type)===si.redirect}function gte(n){let o=n;return o&&typeof o=="object"&&typeof o.data=="object"&&typeof o.subscribe=="function"&&typeof o.cancel=="function"&&typeof o.resolveData=="function"}function _te(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.headers=="object"&&typeof n.body<"u"}function yte(n){return ote.has(n.toLowerCase())}function da(n){return nte.has(n.toLowerCase())}async function $P(n,o,l,h,f,g){for(let x=0;x<l.length;x++){let E=l[x],w=o[x];if(!w)continue;let I=n.find(D=>D.route.id===w.route.id),R=I!=null&&!FD(I,w)&&(g&&g[w.route.id])!==void 0;if(bc(E)&&(f||R)){let D=h[x];Vr(D,"Expected an AbortSignal for revalidating fetcher deferred result"),await ND(E,D,f).then(F=>{F&&(l[x]=F||l[x])})}}}async function ND(n,o,l){if(l===void 0&&(l=!1),!await n.deferredData.resolveData(o)){if(l)try{return{type:si.data,data:n.deferredData.unwrappedData}}catch(f){return{type:si.error,error:f}}return{type:si.data,data:n.deferredData.data}}}function fE(n){return new URLSearchParams(n).getAll("index").some(o=>o==="")}function vte(n,o){let{route:l,pathname:h,params:f}=n;return{id:l.id,pathname:h,params:f,data:o[l.id],handle:l.handle}}function kw(n,o){let l=typeof o=="string"?Ga(o).search:o.search;if(n[n.length-1].route.index&&fE(l||""))return n[n.length-1];let h=py(n);return h[h.length-1]}function VP(n){let{formMethod:o,formAction:l,formEncType:h,text:f,formData:g,json:x}=n;if(!(!o||!l||!h)){if(f!=null)return{formMethod:o,formAction:l,formEncType:h,formData:void 0,json:void 0,text:f};if(g!=null)return{formMethod:o,formAction:l,formEncType:h,formData:g,json:void 0,text:void 0};if(x!==void 0)return{formMethod:o,formAction:l,formEncType:h,formData:void 0,json:x,text:void 0}}}function f0(n,o){return o?{state:"loading",location:n,formMethod:o.formMethod,formAction:o.formAction,formEncType:o.formEncType,formData:o.formData,json:o.json,text:o.text}:{state:"loading",location:n,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function xte(n,o){return{state:"submitting",location:n,formMethod:o.formMethod,formAction:o.formAction,formEncType:o.formEncType,formData:o.formData,json:o.json,text:o.text}}function Ef(n,o){return n?{state:"loading",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:o," _hasFetcherDoneAnything ":!0}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:o," _hasFetcherDoneAnything ":!0}}function bte(n,o){return{state:"submitting",formMethod:n.formMethod,formAction:n.formAction,formEncType:n.formEncType,formData:n.formData,json:n.json,text:n.text,data:o?o.data:void 0," _hasFetcherDoneAnything ":!0}}function oh(n){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:n," _hasFetcherDoneAnything ":!0}}/**
 * React Router v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function y_(){return y_=Object.assign?Object.assign.bind():function(n){for(var o=1;o<arguments.length;o++){var l=arguments[o];for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&(n[h]=l[h])}return n},y_.apply(this,arguments)}const my=A.createContext(null),jD=A.createContext(null),nd=A.createContext(null),gy=A.createContext(null),Nl=A.createContext({outlet:null,matches:[],isDataRoute:!1}),$D=A.createContext(null);function wte(n,o){let{relative:l}=o===void 0?{}:o;Dp()||Vr(!1);let{basename:h,navigator:f}=A.useContext(nd),{hash:g,pathname:x,search:E}=UD(n,{relative:l}),w=x;return h!=="/"&&(w=x==="/"?h:vs([h,x])),f.createHref({pathname:w,search:E,hash:g})}function Dp(){return A.useContext(gy)!=null}function _y(){return Dp()||Vr(!1),A.useContext(gy).location}function VD(n){A.useContext(nd).static||A.useLayoutEffect(n)}function pE(){let{isDataRoute:n}=A.useContext(Nl);return n?Lte():Ete()}function Ete(){Dp()||Vr(!1);let n=A.useContext(my),{basename:o,navigator:l}=A.useContext(nd),{matches:h}=A.useContext(Nl),{pathname:f}=_y(),g=JSON.stringify(py(h).map(w=>w.pathnameBase)),x=A.useRef(!1);return VD(()=>{x.current=!0}),A.useCallback(function(w,I){if(I===void 0&&(I={}),!x.current)return;if(typeof w=="number"){l.go(w);return}let R=hE(w,JSON.parse(g),f,I.relative==="path");n==null&&o!=="/"&&(R.pathname=R.pathname==="/"?o:vs([o,R.pathname])),(I.replace?l.replace:l.push)(R,I.state,I)},[o,l,g,f,n])}const Ste=A.createContext(null);function Tte(n){let o=A.useContext(Nl).outlet;return o&&A.createElement(Ste.Provider,{value:n},o)}function UD(n,o){let{relative:l}=o===void 0?{}:o,{matches:h}=A.useContext(Nl),{pathname:f}=_y(),g=JSON.stringify(py(h).map(x=>x.pathnameBase));return A.useMemo(()=>hE(n,JSON.parse(g),f,l==="path"),[n,g,f,l])}function Mte(n,o,l){Dp()||Vr(!1);let{navigator:h}=A.useContext(nd),{matches:f}=A.useContext(Nl),g=f[f.length-1],x=g?g.params:{};g&&g.pathname;let E=g?g.pathnameBase:"/";g&&g.route;let w=_y(),I;if(o){var R;let j=typeof o=="string"?Ga(o):o;E==="/"||(R=j.pathname)!=null&&R.startsWith(E)||Vr(!1),I=j}else I=w;let D=I.pathname||"/",F=E==="/"?D:D.slice(E.length)||"/",q=wh(n,{pathname:F}),G=kte(q&&q.map(j=>Object.assign({},j,{params:Object.assign({},x,j.params),pathname:vs([E,h.encodeLocation?h.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?E:vs([E,h.encodeLocation?h.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),f,l);return o&&G?A.createElement(gy.Provider,{value:{location:y_({pathname:"/",search:"",hash:"",state:null,key:"default"},I),navigationType:ti.Pop}},G):G}function Cte(){let n=WD(),o=DD(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),l=n instanceof Error?n.stack:null,f={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},g=null;return A.createElement(A.Fragment,null,A.createElement("h2",null,"Unexpected Application Error!"),A.createElement("h3",{style:{fontStyle:"italic"}},o),l?A.createElement("pre",{style:f},l):null,g)}const Ate=A.createElement(Cte,null);class Ite extends A.Component{constructor(o){super(o),this.state={location:o.location,revalidation:o.revalidation,error:o.error}}static getDerivedStateFromError(o){return{error:o}}static getDerivedStateFromProps(o,l){return l.location!==o.location||l.revalidation!=="idle"&&o.revalidation==="idle"?{error:o.error,location:o.location,revalidation:o.revalidation}:{error:o.error||l.error,location:l.location,revalidation:o.revalidation||l.revalidation}}componentDidCatch(o,l){console.error("React Router caught the following error during render",o,l)}render(){return this.state.error?A.createElement(Nl.Provider,{value:this.props.routeContext},A.createElement($D.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Pte(n){let{routeContext:o,match:l,children:h}=n,f=A.useContext(my);return f&&f.static&&f.staticContext&&(l.route.errorElement||l.route.ErrorBoundary)&&(f.staticContext._deepestRenderedBoundaryId=l.route.id),A.createElement(Nl.Provider,{value:o},h)}function kte(n,o,l){var h;if(o===void 0&&(o=[]),l===void 0&&(l=null),n==null){var f;if((f=l)!=null&&f.errors)n=l.matches;else return null}let g=n,x=(h=l)==null?void 0:h.errors;if(x!=null){let E=g.findIndex(w=>w.route.id&&(x==null?void 0:x[w.route.id]));E>=0||Vr(!1),g=g.slice(0,Math.min(g.length,E+1))}return g.reduceRight((E,w,I)=>{let R=w.route.id?x==null?void 0:x[w.route.id]:null,D=null;l&&(D=w.route.errorElement||Ate);let F=o.concat(g.slice(0,I+1)),q=()=>{let G;return R?G=D:w.route.Component?G=A.createElement(w.route.Component,null):w.route.element?G=w.route.element:G=E,A.createElement(Pte,{match:w,routeContext:{outlet:E,matches:F,isDataRoute:l!=null},children:G})};return l&&(w.route.ErrorBoundary||w.route.errorElement||I===0)?A.createElement(Ite,{location:l.location,revalidation:l.revalidation,component:D,error:R,children:q(),routeContext:{outlet:null,matches:F,isDataRoute:!0}}):q()},null)}var Rw;(function(n){n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate"})(Rw||(Rw={}));var yp;(function(n){n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId"})(yp||(yp={}));function Rte(n){let o=A.useContext(my);return o||Vr(!1),o}function zte(n){let o=A.useContext(jD);return o||Vr(!1),o}function Dte(n){let o=A.useContext(Nl);return o||Vr(!1),o}function GD(n){let o=Dte(),l=o.matches[o.matches.length-1];return l.route.id||Vr(!1),l.route.id}function WD(){var n;let o=A.useContext($D),l=zte(yp.UseRouteError),h=GD(yp.UseRouteError);return o||((n=l.errors)==null?void 0:n[h])}function Lte(){let{router:n}=Rte(Rw.UseNavigateStable),o=GD(yp.UseNavigateStable),l=A.useRef(!1);return VD(()=>{l.current=!0}),A.useCallback(function(f,g){g===void 0&&(g={}),l.current&&(typeof f=="number"?n.navigate(f):n.navigate(f,y_({fromRouteId:o},g)))},[n,o])}const Ote="startTransition",UP=x_[Ote];function Fte(n){let{fallbackElement:o,router:l,future:h}=n,[f,g]=A.useState(l.state),{v7_startTransition:x}=h||{},E=A.useCallback(D=>{x&&UP?UP(()=>g(D)):g(D)},[g,x]);A.useLayoutEffect(()=>l.subscribe(E),[l,E]);let w=A.useMemo(()=>({createHref:l.createHref,encodeLocation:l.encodeLocation,go:D=>l.navigate(D),push:(D,F,q)=>l.navigate(D,{state:F,preventScrollReset:q==null?void 0:q.preventScrollReset}),replace:(D,F,q)=>l.navigate(D,{replace:!0,state:F,preventScrollReset:q==null?void 0:q.preventScrollReset})}),[l]),I=l.basename||"/",R=A.useMemo(()=>({router:l,navigator:w,static:!1,basename:I}),[l,w,I]);return A.createElement(A.Fragment,null,A.createElement(my.Provider,{value:R},A.createElement(jD.Provider,{value:f},A.createElement(jte,{basename:I,location:f.location,navigationType:f.historyAction,navigator:w},f.initialized?A.createElement(Bte,{routes:l.routes,state:f}):o))),null)}function Bte(n){let{routes:o,state:l}=n;return Mte(o,void 0,l)}function Nte(n){return Tte(n.context)}function jte(n){let{basename:o="/",children:l=null,location:h,navigationType:f=ti.Pop,navigator:g,static:x=!1}=n;Dp()&&Vr(!1);let E=o.replace(/^\/*/,"/"),w=A.useMemo(()=>({basename:E,navigator:g,static:x}),[E,g,x]);typeof h=="string"&&(h=Ga(h));let{pathname:I="/",search:R="",hash:D="",state:F=null,key:q="default"}=h,G=A.useMemo(()=>{let j=rd(I,E);return j==null?null:{location:{pathname:j,search:R,hash:D,state:F,key:q},navigationType:f}},[E,I,R,D,F,q,f]);return G==null?null:A.createElement(nd.Provider,{value:w},A.createElement(gy.Provider,{children:l,value:G}))}var GP;(function(n){n[n.pending=0]="pending",n[n.success=1]="success",n[n.error=2]="error"})(GP||(GP={}));new Promise(()=>{});function $te(n){let o={hasErrorBoundary:n.ErrorBoundary!=null||n.errorElement!=null};return n.Component&&Object.assign(o,{element:A.createElement(n.Component),Component:void 0}),n.ErrorBoundary&&Object.assign(o,{errorElement:A.createElement(n.ErrorBoundary),ErrorBoundary:void 0}),o}/**
 * React Router DOM v6.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function vp(){return vp=Object.assign?Object.assign.bind():function(n){for(var o=1;o<arguments.length;o++){var l=arguments[o];for(var h in l)Object.prototype.hasOwnProperty.call(l,h)&&(n[h]=l[h])}return n},vp.apply(this,arguments)}function Vte(n,o){if(n==null)return{};var l={},h=Object.keys(n),f,g;for(g=0;g<h.length;g++)f=h[g],!(o.indexOf(f)>=0)&&(l[f]=n[f]);return l}function Ute(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Gte(n,o){return n.button===0&&(!o||o==="_self")&&!Ute(n)}const Wte=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset"];function Hte(n,o){return ute({basename:o==null?void 0:o.basename,future:vp({},o==null?void 0:o.future,{v7_prependBasename:!0}),history:zee({window:o==null?void 0:o.window}),hydrationData:(o==null?void 0:o.hydrationData)||qte(),routes:n,mapRouteProperties:$te}).initialize()}function qte(){var n;let o=(n=window)==null?void 0:n.__staticRouterHydrationData;return o&&o.errors&&(o=vp({},o,{errors:Zte(o.errors)})),o}function Zte(n){if(!n)return null;let o=Object.entries(n),l={};for(let[h,f]of o)if(f&&f.__type==="RouteErrorResponse")l[h]=new dE(f.status,f.statusText,f.data,f.internal===!0);else if(f&&f.__type==="Error"){if(f.__subType){let g=window[f.__subType];if(typeof g=="function")try{let x=new g(f.message);x.stack="",l[h]=x}catch{}}if(l[h]==null){let g=new Error(f.message);g.stack="",l[h]=g}}else l[h]=f;return l}const Xte=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Yte=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Kte=A.forwardRef(function(o,l){let{onClick:h,relative:f,reloadDocument:g,replace:x,state:E,target:w,to:I,preventScrollReset:R}=o,D=Vte(o,Wte),{basename:F}=A.useContext(nd),q,G=!1;if(typeof I=="string"&&Yte.test(I)&&(q=I,Xte))try{let O=new URL(window.location.href),V=I.startsWith("//")?new URL(O.protocol+I):new URL(I),U=rd(V.pathname,F);V.origin===O.origin&&U!=null?I=U+V.search+V.hash:G=!0}catch{}let j=wte(I,{relative:f}),te=Jte(I,{replace:x,state:E,target:w,preventScrollReset:R,relative:f});function N(O){h&&h(O),O.defaultPrevented||te(O)}return A.createElement("a",vp({},D,{href:q||j,onClick:G||g?h:N,ref:l,target:w}))});var WP;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher"})(WP||(WP={}));var HP;(function(n){n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(HP||(HP={}));function Jte(n,o){let{target:l,replace:h,state:f,preventScrollReset:g,relative:x}=o===void 0?{}:o,E=pE(),w=_y(),I=UD(n,{relative:x});return A.useCallback(R=>{if(Gte(R,l)){R.preventDefault();let D=h!==void 0?h:Fc(w)===Fc(I);E(n,{replace:D,state:f,preventScrollReset:g,relative:x})}},[w,E,I,h,f,l,n,g,x])}const Qte=()=>Ct.jsx("div",{className:"w-full h-full fixed bg-[#2c3e50] flex flex-col justify-center",children:Ct.jsxs("div",{className:"container mx-auto",children:[Ct.jsx("div",{className:"spinner h-10 text-center text-sm mx-auto mt-5 mb-3",children:new Array(5).fill("").map((n,o)=>Ct.jsx("div",{style:{animation:"stretchdelay 1.2s infinite ease-in-out",animationDelay:`${-1.1+o*.1}s`},className:"bg-[#647eff] h-full w-[6px] inline-block mr-[3px]"},o))}),Ct.jsx("div",{style:{WebkitTextFillColor:"transparent"},className:"text-center text-lg bg-clip-text bg-gradient-to-r from-[#42d392] to-[#647eff] font-bold",children:"数据加载中"}),Ct.jsxs("div",{className:"py-12",children:[Ct.jsx(wP,{active:!0}),Ct.jsx(wP,{active:!0})]})]})});var HD={exports:{}};(function(n,o){(function(l,h){n.exports=h()})(Sf,function(){var l,h,f;function g(E,w){if(!l)l=w;else if(!h)h=w;else{var I="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+l+")(sharedChunk); ("+h+")(sharedChunk); self.onerror = null;",R={};l(R),f=w(R),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(f.workerUrl=window.URL.createObjectURL(new Blob([I],{type:"text/javascript"})))}}g(["exports"],function(E){var w=typeof self<"u"?self:{},I="3.0.0-beta.1";let R;const D={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(R==null){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{R={}.API_URL_REGEX!=null?new RegExp({}.API_URL_REGEX):t}catch{R=t}}return R},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!D.API_URL)return null;try{const t=new URL(D.API_URL);return t.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":t.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard-beta",MAX_PARALLEL_IMAGE_REQUESTS:16,LOADERS_URL:"https://api.mapbox.com/mapbox-gl-js/v3.0.0/mapbox-gl-loaders.js"},F={supported:!1,testSupport:function(t){!j&&G&&(te?N(t):q=t)}};let q,G,j=!1,te=!1;function N(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,G),t.isContextLost())return;F.supported=!0}catch{}t.deleteTexture(e),j=!0}w.document&&(G=w.document.createElement("img"),G.onload=function(){q&&N(q),q=null,te=!0},G.onerror=function(){j=!0,q=null},G.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const O="01";function V(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var U=ae;function ae(t,e,r,i){this.cx=3*t,this.bx=3*(r-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(i-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=r,this.p2y=i}ae.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(e===void 0&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var r=t,i=0;i<8;i++){var a=this.sampleCurveX(r)-t;if(Math.abs(a)<e)return r;var s=this.sampleCurveDerivativeX(r);if(Math.abs(s)<1e-6)break;r-=a/s}var c=0,u=1;for(r=t,i=0;i<20&&(a=this.sampleCurveX(r),!(Math.abs(a-t)<e));i++)t>a?c=r:u=r,r=.5*(u-c)+c;return r},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var le=V(U),ne=de;function de(t,e){this.x=t,this.y=e}de.prototype={clone:function(){return new de(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,r=t.y-this.y;return e*e+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),r=Math.sin(t),i=r*this.x+e*this.y;return this.x=e*this.x-r*this.y,this.y=i,this},_rotateAround:function(t,e){var r=Math.cos(t),i=Math.sin(t),a=e.y+i*(this.x-e.x)+r*(this.y-e.y);return this.x=e.x+r*(this.x-e.x)-i*(this.y-e.y),this.y=a,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},de.convert=function(t){return t instanceof de?t:Array.isArray(t)?new de(t[0],t[1]):t};var $=V(ne);function ue(t,e){if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!ue(t[r],e[r]))return!1;return!0}if(typeof t=="object"&&t!==null&&e!==null){if(typeof e!="object"||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(!ue(t[r],e[r]))return!1;return!0}return t===e}const xe=Math.PI/180,ce=180/Math.PI;function se(t){return t*xe}function ke(t){return t*ce}const $e=[[0,0],[1,0],[1,1],[0,1]];function Ne(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,r=e*t;return 4*(t<.5?r:3*(t-e)+r-.75)}function it(t){let e=1/0,r=1/0,i=-1/0,a=-1/0;for(const s of t)e=Math.min(e,s.x),r=Math.min(r,s.y),i=Math.max(i,s.x),a=Math.max(a,s.y);return{min:new $(e,r),max:new $(i,a)}}function Re(t,e,r=0,i=!0){const a=new $(r,r),s=t.sub(a),c=e.add(a),u=[s,new $(c.x,s.y),c,new $(s.x,c.y)];return i&&u.push(s.clone()),u}function He(t,e,r,i){const a=new le(t,e,r,i);return function(s){return a.solve(s)}}const Xe=He(.25,.1,.25,1);function ze(t,e,r){return Math.min(r,Math.max(e,t))}function at(t,e,r){return(r=ze((r-t)/(e-t),0,1))*r*(3-2*r)}function Pt(t,e,r){const i=r-e,a=((t-e)%i+i)%i+e;return a===e?r:a}function mt(t,e,r){if(!t.length)return r(null,[]);let i=t.length;const a=new Array(t.length);let s=null;t.forEach((c,u)=>{e(c,(d,p)=>{d&&(s=d),a[u]=p,--i==0&&r(s,a)})})}function kt(t){const e=[];for(const r in t)e.push(t[r]);return e}function Oe(t,...e){for(const r of e)for(const i in r)t[i]=r[i];return t}function qt(t,e){const r={};for(let i=0;i<e.length;i++){const a=e[i];a in t&&(r[a]=t[a])}return r}let Sr=1;function Ir(){return Sr++}function Xr(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function Ur(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function pr(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function ar(t,e){t.forEach(r=>{e[r]&&(e[r]=e[r].bind(e))})}function hr(t,e){return t.indexOf(e,t.length-e.length)!==-1}function xr(t,e,r){const i={};for(const a in t)i[a]=e.call(r||this,t[a],a,t);return i}function Fe(t,e,r){const i={};for(const a in t)e.call(r||this,t[a],a,t)&&(i[a]=t[a]);return i}function Y(t){return Array.isArray(t)?t.map(Y):typeof t=="object"&&t?xr(t,Y):t}const ee={};function re(t){ee[t]||(typeof console<"u"&&console.warn(t),ee[t]=!0)}function we(t,e,r){return(r.y-t.y)*(e.x-t.x)>(e.y-t.y)*(r.x-t.x)}function Ie(t){let e=0;for(let r,i,a=0,s=t.length,c=s-1;a<s;c=a++)r=t[a],i=t[c],e+=(i.x-r.x)*(r.y+i.y);return e}function Qe([t,e,r]){const i=se(e+90),a=se(r);return{x:t*Math.cos(i)*Math.sin(a),y:t*Math.sin(i)*Math.sin(a),z:t*Math.cos(a),azimuthal:e,polar:r}}function tt(t,e,r){const i=Math.sqrt(t*t+e*e+r*r),a=i>0?Math.acos(r/i)*ce:0;let s=t!==0||e!==0?Math.atan2(-e,-t)*ce+90:0;return s<0&&(s+=360),[i,s,a]}function Be(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function gt(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(r,i,a,s)=>{const c=a||s;return e[i]=!c||c.toLowerCase(),""}),e["max-age"]){const r=parseInt(e["max-age"],10);isNaN(r)?delete e["max-age"]:e["max-age"]=r}return e}let Tt=null;function At(t){if(Tt==null){const e=t.navigator?t.navigator.userAgent:null;Tt=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Tt}function mr(){return!!w.document.fullscreenElement||!!w.document.webkitFullscreenElement}function nn(t){try{const e=w[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Pr(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}function Cr(t,e,r){t[4*e+0]=r[0],t[4*e+1]=r[1],t[4*e+2]=r[2],t[4*e+3]=r[3]}function Yr(t,e){return[Math.pow(t[0],2.2)*e,Math.pow(t[1],2.2)*e,Math.pow(t[2],2.2)*e]}function br(t){return[Math.pow(t[0],1/2.2),Math.pow(t[1],1/2.2),Math.pow(t[2],1/2.2)]}const Te="mapbox-tiles";let Pe=500,et=50,_t,Rt;function bt(){try{return w.caches}catch{}}function ct(){bt()&&!_t&&(_t=w.caches.open(Te))}function It(t){const e=t.indexOf("?");if(e<0)return t;const r=function(a){const s=a.indexOf("?");return s>0?a.slice(s+1).split("&"):[]}(t),i=r.filter(a=>{const s=a.split("=");return s[0]==="language"||s[0]==="worldview"});return i.length?`${t.slice(0,e)}?${i.join("&")}`:t.slice(0,e)}let Mt=1/0;function ye(t){Mt++,Mt>et&&(t.getActor().send("enforceCacheSizeLimit",Pe),Mt=0)}const be={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(be);class Me extends Error{constructor(e,r,i){r===401&&Bt(i)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=r,this.url=i}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const De=Be()?()=>self.worker&&self.worker.referrer:()=>(w.location.protocol==="blob:"?w.parent:w).location.href,Le=function(t,e){if(!(/^file:/.test(r=t.url)||/^file:/.test(De())&&!/^\w+:/.test(r))){if(w.fetch&&w.Request&&w.AbortController&&w.Request.prototype.hasOwnProperty("signal"))return function(i,a){const s=new w.AbortController,c=new w.Request(i.url,{method:i.method||"GET",body:i.body,credentials:i.credentials,headers:i.headers,referrer:De(),referrerPolicy:i.referrerPolicy,signal:s.signal});let u=!1,d=!1;const p=(m=c.url).indexOf("sku=")>0&&Bt(m);var m;i.type==="json"&&c.headers.set("Accept","application/json");const _=(v,b,S)=>{if(d)return;if(v&&v.message!=="SecurityError"&&re(v.toString()),b&&S)return y(b);const T=Date.now();w.fetch(c).then(M=>{if(M.ok){const C=p?M.clone():null;return y(M,C,T)}return a(new Me(M.statusText,M.status,i.url))}).catch(M=>{M.name!=="AbortError"&&a(new Error(`${M.message} ${i.url}`))})},y=(v,b,S)=>{(i.type==="arrayBuffer"?v.arrayBuffer():i.type==="json"?v.json():v.text()).then(T=>{d||(b&&S&&function(M,C,P){if(ct(),!_t)return;const k={status:C.status,statusText:C.statusText,headers:new w.Headers};C.headers.forEach((B,W)=>k.headers.set(W,B));const z=gt(C.headers.get("Cache-Control")||"");if(z["no-store"])return;z["max-age"]&&k.headers.set("Expires",new Date(P+1e3*z["max-age"]).toUTCString());const L=k.headers.get("Expires");L&&(new Date(L).getTime()-P<42e4||function(B,W){if(Rt===void 0)try{new Response(new ReadableStream),Rt=!0}catch{Rt=!1}Rt?W(B.body):B.blob().then(W)}(C,B=>{const W=new w.Response(B,k);ct(),_t&&_t.then(Z=>Z.put(It(M.url),W)).catch(Z=>re(Z.message))}))}(c,b,S),u=!0,a(null,T,v.headers.get("Cache-Control"),v.headers.get("Expires")))}).catch(T=>{d||a(new Error(T.message))})};return p?function(v,b){if(ct(),!_t)return b(null);const S=It(v.url);_t.then(T=>{T.match(S).then(M=>{const C=function(P){if(!P)return!1;const k=new Date(P.headers.get("Expires")||0),z=gt(P.headers.get("Cache-Control")||"");return k>Date.now()&&!z["no-cache"]}(M);T.delete(S),C&&T.put(S,M.clone()),b(null,M,C)}).catch(b)}).catch(b)}(c,_):_(null,null),{cancel:()=>{d=!0,u||s.abort()}}}(t,e);if(Be()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var r;return function(i,a){const s=new w.XMLHttpRequest;s.open(i.method||"GET",i.url,!0),i.type==="arrayBuffer"&&(s.responseType="arraybuffer");for(const c in i.headers)s.setRequestHeader(c,i.headers[c]);return i.type==="json"&&(s.responseType="text",s.setRequestHeader("Accept","application/json")),s.withCredentials=i.credentials==="include",s.onerror=()=>{a(new Error(s.statusText))},s.onload=()=>{if((s.status>=200&&s.status<300||s.status===0)&&s.response!==null){let c=s.response;if(i.type==="json")try{c=JSON.parse(s.response)}catch(u){return a(u)}a(null,c,s.getResponseHeader("Cache-Control"),s.getResponseHeader("Expires"))}else a(new Me(s.statusText,s.status,i.url))},s.send(i.body),{cancel:()=>s.abort()}}(t,e)},qe=function(t,e){return Le(Oe(t,{type:"json"}),e)},Ue=function(t,e){return Le(Oe(t,{type:"arrayBuffer"}),e)};function Ze(t){const e=w.document.createElement("a");return e.href=t,e.protocol===w.document.location.protocol&&e.host===w.document.location.host}const ot="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let We,xt;We=[],xt=0;const rr=function(t,e){if(F.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),xt>=D.MAX_PARALLEL_IMAGE_REQUESTS){const s={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return We.push(s),s}xt++;let r=!1;const i=()=>{if(!r)for(r=!0,xt--;We.length&&xt<D.MAX_PARALLEL_IMAGE_REQUESTS;){const s=We.shift(),{requestParameters:c,callback:u,cancelled:d}=s;d||(s.cancel=rr(c,u).cancel)}},a=Ue(t,(s,c,u,d)=>{i(),s?e(s):c&&(w.createImageBitmap?function(p,m){const _=new w.Blob([new Uint8Array(p)],{type:"image/png"});w.createImageBitmap(_).then(y=>{m(null,y)}).catch(y=>{m(new Error(`Could not load image because of ${y.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(c,(p,m)=>e(p,m,u,d)):function(p,m){const _=new w.Image,y=w.URL;_.onload=()=>{m(null,_),y.revokeObjectURL(_.src),_.onload=null,w.requestAnimationFrame(()=>{_.src=ot})},_.onerror=()=>m(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const v=new w.Blob([new Uint8Array(p)],{type:"image/png"});_.src=p.byteLength?y.createObjectURL(v):ot}(c,(p,m)=>e(p,m,u,d)))});return{cancel:()=>{a.cancel(),i()}}},yt="NO_ACCESS_TOKEN";class _r{constructor(e,r,i){this._transformRequestFn=e,this._customAccessToken=r,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const e=function(){let r="";for(let i=0;i<10;i++)r+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",O,r].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=e.token,this._skuTokenExpiresAt=e.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(e,r){return this._transformRequestFn&&this._transformRequestFn(e,r)||{url:e}}normalizeStyleURL(e,r){if(!wr(e))return e;const i=on(e);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||r)}normalizeGlyphsURL(e,r){if(!wr(e))return e;const i=on(e);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||r)}normalizeModelURL(e,r){if(!wr(e))return e;const i=on(e);return i.path=`/models/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||r)}normalizeSourceURL(e,r,i,a){if(!wr(e))return e;const s=on(e);return s.path=`/v4/${s.authority}.json`,s.params.push("secure"),i&&s.params.push(`language=${i}`),a&&s.params.push(`worldview=${a}`),this._makeAPIURL(s,this._customAccessToken||r)}normalizeSpriteURL(e,r,i,a){const s=on(e);return wr(e)?(s.path=`/styles/v1${s.path}/sprite${r}${i}`,this._makeAPIURL(s,this._customAccessToken||a)):(s.path+=`${r}${i}`,Br(s))}normalizeTileURL(e,r,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),e&&!wr(e))return e;const a=on(e);a.path=a.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${r||i&&a.authority!=="raster"&&i===512?"@2x":""}${F.supported?".webp":"$1"}`),a.authority==="raster"?a.path=`/${D.RASTER_URL_PREFIX}${a.path}`:(a.path=a.path.replace(/^.+\/v4\//,"/"),a.path=`/${D.TILE_URL_VERSION}${a.path}`);const s=this._customAccessToken||function(c){for(const u of c){const d=u.match(/^access_token=(.*)$/);if(d)return d[1]}return null}(a.params)||D.ACCESS_TOKEN;return D.REQUIRE_ACCESS_TOKEN&&s&&this._skuToken&&a.params.push(`sku=${this._skuToken}`),this._makeAPIURL(a,s)}canonicalizeTileURL(e,r){const i=on(e);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return e;let a="mapbox://";i.path.match(/^\/raster\/v1\//)?a+=`raster/${i.path.replace(`/${D.RASTER_URL_PREFIX}/`,"")}`:a+=`tiles/${i.path.replace(`/${D.TILE_URL_VERSION}/`,"")}`;let s=i.params;return r&&(s=s.filter(c=>!c.match(/^access_token=/))),s.length&&(a+=`?${s.join("&")}`),a}canonicalizeTileset(e,r){const i=!!r&&wr(r),a=[];for(const s of e.tiles||[])Bt(s)?a.push(this.canonicalizeTileURL(s,i)):a.push(s);return a}_makeAPIURL(e,r){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",a=on(D.API_URL);if(e.protocol=a.protocol,e.authority=a.authority,e.protocol==="http"){const s=e.params.indexOf("secure");s>=0&&e.params.splice(s,1)}if(a.path!=="/"&&(e.path=`${a.path}${e.path}`),!D.REQUIRE_ACCESS_TOKEN)return Br(e);if(r=r||D.ACCESS_TOKEN,!this._silenceAuthErrors){if(!r)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if(r[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return e.params=e.params.filter(s=>s.indexOf("access_token")===-1),e.params.push(`access_token=${r||""}`),Br(e)}}function wr(t){return t.indexOf("mapbox:")===0}function Bt(t){return D.API_URL_REGEX.test(t)}function yr(t){return D.API_CDN_URL_REGEX.test(t)}function Qr(t){return D.API_STYLE_REGEX.test(t)&&!Wn(t)}function Wn(t){return D.API_SPRITE_REGEX.test(t)}const Er=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function on(t){const e=t.match(Er);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Br(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}const ro="mapbox.eventData";function qo(t){if(!t)return null;const e=t.split(".");if(!e||e.length!==3)return null;try{return JSON.parse(decodeURIComponent(w.atob(e[1]).split("").map(r=>"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class bi{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const r=qo(D.ACCESS_TOKEN);let i="";return i=r&&r.u?w.btoa(encodeURIComponent(r.u).replace(/%([0-9A-F]{2})/g,(a,s)=>String.fromCharCode(+("0x"+s)))):D.ACCESS_TOKEN||"",e?`${ro}.${e}:${i}`:`${ro}:${i}`}fetchEventData(){const e=nn("localStorage"),r=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{const a=w.localStorage.getItem(r);a&&(this.eventData=JSON.parse(a));const s=w.localStorage.getItem(i);s&&(this.anonId=s)}catch{re("Unable to read from LocalStorage")}}saveEventData(){const e=nn("localStorage"),r=this.getStorageKey(),i=this.getStorageKey("uuid");if(e)try{w.localStorage.setItem(i,this.anonId),Object.keys(this.eventData).length>=1&&w.localStorage.setItem(r,JSON.stringify(this.eventData))}catch{re("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,r,i,a){if(!D.EVENTS_URL)return;const s=on(D.EVENTS_URL);s.params.push(`access_token=${a||D.ACCESS_TOKEN||""}`);const c={event:this.type,created:new Date(e).toISOString()},u=r?Oe(c,r):c,d={url:Br(s),headers:{"Content-Type":"text/plain"},body:JSON.stringify([u])};this.pendingRequest=function(p,m){return Le(Oe(p,{method:"POST"}),m)}(d,p=>{this.pendingRequest=null,i(p),this.saveEventData(),this.processRequests(a)})}queueRequest(e,r){this.queue.push(e),this.processRequests(r)}}const jl=new class extends bi{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){D.EVENTS_URL&&D.ACCESS_TOKEN&&Array.isArray(t)&&t.some(r=>wr(r)||Bt(r))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=qo(D.ACCESS_TOKEN),r=e?e.u:D.ACCESS_TOKEN;let i=r!==this.eventData.tokenU;pr(this.anonId)||(this.anonId=Xr(),i=!0);const a=this.queue.shift();if(this.eventData.lastSuccess){const s=new Date(this.eventData.lastSuccess),c=new Date(a),u=(a-this.eventData.lastSuccess)/864e5;i=i||u>=1||u<-1||s.getDate()!==c.getDate()}else i=!0;i?this.postEvent(a,{sdkIdentifier:"mapbox-gl-js",sdkVersion:I,skuId:O,"enabled.telemetry":!1,userId:this.anonId},s=>{s||(this.eventData.lastSuccess=a,this.eventData.tokenU=r)},t):this.processRequests()}},$l=jl.postTurnstileEvent.bind(jl),wa=new class extends bi{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,r,i){this.skuToken=e,this.errorCb=i,D.EVENTS_URL&&(r||D.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},r):this.errorCb(new Error(yt)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),pr(this.anonId)||(this.anonId=Xr()),this.postEvent(r,{sdkIdentifier:"mapbox-gl-js",sdkVersion:I,skuId:O,skuToken:this.skuToken,userId:this.anonId},i=>{i?this.errorCb(i):e&&(this.success[e]=!0)},t))}},Gc=wa.postMapLoadEvent.bind(wa),Wc=new class extends bi{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){D.EVENTS_URL&&(t||D.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:e,performanceData:r}=this.queue.shift(),i=function(a){const s=w.performance.getEntriesByType("resource"),c=w.performance.getEntriesByType("mark"),u=function(y){const v={};if(y){for(const b in y)if(b!=="other")for(const S of y[b]){const T=`${b}ResolveRangeMin`,M=`${b}ResolveRangeMax`,C=`${b}RequestCount`,P=`${b}RequestCachedCount`;v[T]=Math.min(v[T]||1/0,S.startTime),v[M]=Math.max(v[M]||-1/0,S.responseEnd);const k=z=>{v[z]===void 0&&(v[z]=0),++v[z]};S.transferSize!==void 0&&S.transferSize===0&&k(P),k(C)}}return v}(function(y,v){const b={};if(y)for(const S of y){const T=v(S);b[T]===void 0&&(b[T]=[]),b[T].push(S)}return b}(s,id)),d=w.devicePixelRatio,p=w.navigator.connection||w.navigator.mozConnection||w.navigator.webkitConnection,m={counters:[],metadata:[],attributes:[]},_=(y,v,b)=>{b!=null&&y.push({name:v,value:b.toString()})};for(const y in u)_(m.counters,y,u[y]);if(a.interactionRange[0]!==1/0&&a.interactionRange[1]!==-1/0&&(_(m.counters,"interactionRangeMin",a.interactionRange[0]),_(m.counters,"interactionRangeMax",a.interactionRange[1])),c)for(const y of Object.keys(Is)){const v=Is[y],b=c.find(S=>S.name===v);b&&_(m.counters,v,b.startTime)}return _(m.counters,"visibilityHidden",a.visibilityHidden),_(m.attributes,"style",function(y){if(y)for(const v of y){const b=v.name.split("?")[0];if(Qr(b)){const S=b.split("/").slice(-2);if(S.length===2)return`mapbox://styles/${S[0]}/${S[1]}`}}}(s)),_(m.attributes,"terrainEnabled",a.terrainEnabled?"true":"false"),_(m.attributes,"fogEnabled",a.fogEnabled?"true":"false"),_(m.attributes,"projection",a.projection),_(m.attributes,"zoom",a.zoom),_(m.metadata,"devicePixelRatio",d),_(m.metadata,"connectionEffectiveType",p?p.effectiveType:void 0),_(m.metadata,"navigatorUserAgent",w.navigator.userAgent),_(m.metadata,"screenWidth",w.screen.width),_(m.metadata,"screenHeight",w.screen.height),_(m.metadata,"windowWidth",w.innerWidth),_(m.metadata,"windowHeight",w.innerHeight),_(m.metadata,"mapWidth",a.width/d),_(m.metadata,"mapHeight",a.height/d),_(m.metadata,"webglRenderer",a.renderer),_(m.metadata,"webglVendor",a.vendor),_(m.metadata,"sdkVersion",I),_(m.metadata,"sdkIdentifier","mapbox-gl-js"),m}(r);for(const a of i.metadata);for(const a of i.counters);for(const a of i.attributes);this.postEvent(e,i,()=>{},t)}},Wa=Wc.postPerformanceEvent.bind(Wc),no=new class extends bi{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,r,i){if(!D.API_URL||!D.SESSION_PATH)return;const a=on(D.API_URL+D.SESSION_PATH);a.params.push(`sku=${e||""}`),a.params.push(`access_token=${i||D.ACCESS_TOKEN||""}`);const s={url:Br(a),headers:{"Content-Type":"text/plain"}};this.pendingRequest=function(c,u){return Le(Oe(c,{method:"GET"}),u)}(s,c=>{this.pendingRequest=null,r(c),this.saveEventData(),this.processRequests(i)})}getSessionAPI(t,e,r,i){this.skuToken=e,this.errorCb=i,D.SESSION_PATH&&D.API_URL&&(r||D.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},r):this.errorCb(new Error(yt)))}processRequests(t){if(this.pendingRequest||this.queue.length===0)return;const{id:e,timestamp:r}=this.queue.shift();e&&this.success[e]||this.getSession(r,this.skuToken,i=>{i?this.errorCb(i):e&&(this.success[e]=!0)},t)}},Ha=no.getSessionAPI.bind(no),io=new Set;function As(t,e){e?io.add(t):io.delete(t)}const Is={create:"create",load:"load",fullLoad:"fullLoad"},Vl={mark(t){w.performance.mark(t)},measure(t,e,r){w.performance.measure(t,e,r)}};function id(t){const e=t.name.split("?")[0];return yr(e)&&e.includes("mapbox-gl.js")?"javascript":yr(e)&&e.includes("mapbox-gl.css")?"css":function(r){return D.API_FONTS_REGEX.test(r)}(e)?"fontRange":Wn(e)?"sprite":Qr(e)?"style":function(r){return D.API_TILEJSON_REGEX.test(r)}(e)?"tilejson":"other"}const Ul=w.performance;function Hc(t){const e=t?t.url.toString():void 0;return Ul.getEntriesByName(e)}var qc=Gl;function Gl(t){return!function(e){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var i,a,s=new Blob([""],{type:"text/javascript"}),c=URL.createObjectURL(s);try{a=new Worker(c),i=!0}catch{i=!1}return a&&a.terminate(),URL.revokeObjectURL(c),i}()?"Uint8ClampedArray"in window?ArrayBuffer.isView?function(){var i=document.createElement("canvas");i.width=i.height=1;var a=i.getContext("2d");if(!a)return!1;var s=a.getImageData(0,0,1,1);return s&&s.width===i.width}()?(Ps[r=e&&e.failIfMajorPerformanceCaveat]===void 0&&(Ps[r]=function(i){var a,s=function(c){var u=document.createElement("canvas"),d=Object.create(Gl.webGLContextAttributes);return d.failIfMajorPerformanceCaveat=c,u.getContext("webgl",d)||u.getContext("experimental-webgl",d)}(i);if(!s)return!1;try{a=s.createShader(s.VERTEX_SHADER)}catch{return!1}return!(!a||s.isContextLost())&&(s.shaderSource(a,"void main() {}"),s.compileShader(a),s.getShaderParameter(a,s.COMPILE_STATUS)===!0)}(r)),Ps[r]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var r}(t)}var Ps={};let ks,Wl,Rs,Zo;Gl.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Ot={now:()=>Rs!==void 0?Rs:w.performance.now(),setNow(t){Rs=t},restoreNow(){Rs=void 0},frame(t){const e=w.requestAnimationFrame(t);return{cancel:()=>w.cancelAnimationFrame(e)}},getImageData(t,e=0){const{width:r,height:i}=t;Zo||(Zo=w.document.createElement("canvas"));const a=Zo.getContext("2d",{willReadFrequently:!0});if(!a)throw new Error("failed to create canvas 2d context");return(r>Zo.width||i>Zo.height)&&(Zo.width=r,Zo.height=i),a.clearRect(-e,-e,r+2*e,i+2*e),a.drawImage(t,0,0,r,i),a.getImageData(-e,-e,r+2*e,i+2*e)},resolveURL:t=>(ks||(ks=w.document.createElement("a")),ks.href=t,ks.href),get devicePixelRatio(){return w.devicePixelRatio},get prefersReducedMotion(){return!!w.matchMedia&&(Wl==null&&(Wl=w.matchMedia("(prefers-reduced-motion: reduce)")),Wl.matches)}};function Tr(t,e,r){const i=w.document.createElement(t);return e!==void 0&&(i.className=e),r&&r.appendChild(i),i}function gi(t,e,r){const i=w.document.createElementNS("http://www.w3.org/2000/svg",t);for(const a of Object.keys(e))i.setAttributeNS(null,a,e[a]);return r&&r.appendChild(i),i}const Ci=w.document&&w.document.documentElement.style,qa=Ci&&Ci.userSelect!==void 0?"userSelect":"WebkitUserSelect";let di;function zs(){Ci&&qa&&(di=Ci[qa],Ci[qa]="none")}function Hl(){Ci&&qa&&(Ci[qa]=di)}function oo(t){t.preventDefault(),t.stopPropagation(),w.removeEventListener("click",oo,!0)}function Xo(){w.addEventListener("click",oo,!0),w.setTimeout(()=>{w.removeEventListener("click",oo,!0)},0)}function Co(t,e){const r=t.getBoundingClientRect();return Xc(t,r,e)}function Ea(t,e){const r=t.getBoundingClientRect(),i=[];for(let a=0;a<e.length;a++)i.push(Xc(t,r,e[a]));return i}function Zc(t){return w.InstallTrigger!==void 0&&t.button===2&&t.ctrlKey&&w.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:t.button}function Xc(t,e,r){const i=t.offsetWidth===e.width?1:t.offsetWidth/e.width;return new $((r.clientX-e.left)*i,(r.clientY-e.top)*i)}function Yc(t,e,r){r[t]&&r[t].indexOf(e)!==-1||(r[t]=r[t]||[],r[t].push(e))}function ql(t,e,r){if(r&&r[t]){const i=r[t].indexOf(e);i!==-1&&r[t].splice(i,1)}}class Ee{constructor(e,r={}){Oe(this,r),this.type=e}}class rt extends Ee{constructor(e,r={}){super("error",Oe({error:e},r))}}class dr{on(e,r){return this._listeners=this._listeners||{},Yc(e,r,this._listeners),this}off(e,r){return ql(e,r,this._listeners),ql(e,r,this._oneTimeListeners),this}once(e,r){return r?(this._oneTimeListeners=this._oneTimeListeners||{},Yc(e,r,this._oneTimeListeners),this):new Promise(i=>this.once(e,i))}fire(e,r){typeof e=="string"&&(e=new Ee(e,r||{}));const i=e.type;if(this.listens(i)){e.target=this;const a=this._listeners&&this._listeners[i]?this._listeners[i].slice():[];for(const u of a)u.call(this,e);const s=this._oneTimeListeners&&this._oneTimeListeners[i]?this._oneTimeListeners[i].slice():[];for(const u of s)ql(i,u,this._oneTimeListeners),u.call(this,e);const c=this._eventedParent;c&&(Oe(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),c.fire(e))}else e instanceof rt&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,r){return this._eventedParent=e,this._eventedParentData=r,this}}var pe=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"lights":{"required":false,"type":"array","value":"light-3d"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"camera":{"type":"camera"},"imports":{"type":"array","value":"import"},"schema":{"type":"schema"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"},"models":{"type":"models"}},"model":{"type":"string","required":true},"import":{"id":{"type":"string","required":true},"url":{"type":"string","required":true},"config":{"type":"config"},"data":{"type":"$root"}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","required":true},"type":{"type":"enum","values":{"string":{},"number":{},"boolean":{},"color":{}}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string","required":true},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false,"transition":false,"expression":{"interpolated":false},"property-type":"data-constant"},"shadow-intensity":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"required":true,"type":"enum","values":{"model":{},"batched-model":{}}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_model":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"},"model-id":{"type":"string","property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]},"transition":false,"requires":[{"source":["geojson","vector"]}]}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":false},"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","expression":{"interpolated":false},"property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":{},"orthographic":{}},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective","property-type":"data-constant"}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"units":"intensity","expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-ambient-occlusion-wall-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-ambient-occlusion-ground-radius":{"property-type":"data-constant","type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"property-type":"data-constant","type":"color","default":"#ffffff","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"property-type":"data-constant","type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","units":"meters","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","units":"meters","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"property-type":"data-constant","type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"property-type":"data-constant","type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"property-type":"data-constant","type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"units":"intensity","expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"},"line-border-width":{"type":"number","private":true,"default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","private":true,"default":"rgba(0, 0, 0, 0)","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"units":"intensity","expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"units":"intensity","expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"units":"intensity","expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image-cross-fade":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"transition":true},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-color":{"type":"color","transition":false,"expression":{"interpolated":true,"parameters":["raster-value"]},"property-type":"color-ramp"},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","default":[0,1],"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"units":"intensity","expression":{"interpolated":true,"parameters":["zoom","measure-light"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"units":"degrees","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":{},"location-indicator":{}},"default":"common-3d","property-type":"data-constant"},"model-cast-shadows":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false},"property-type":"data-constant"},"model-receive-shadows":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false},"property-type":"data-constant"},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant","transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"units":"number","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function en(t,...e){for(const r of e)for(const i in r)t[i]=r[i];return t}class st{constructor(e,r,i,a){this.message=(e?`${e}: `:"")+i,a&&(this.identifier=a),r!=null&&r.__line__&&(this.line=r.__line__)}}function kn(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Ao(t){if(Array.isArray(t))return t.map(Ao);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const r in t)e[r]=Ao(t[r]);return e}return kn(t)}class Kc extends Error{constructor(e,r){super(r),this.message=r,this.key=e}}var Sa=Kc;class xy{constructor(e,r=[]){this.parent=e,this.bindings={};for(const[i,a]of r)this.bindings[i]=a}concat(e){return new xy(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var tL=xy;const Jc={kind:"null"},lt={kind:"number"},gr={kind:"string"},Mr={kind:"boolean"},Io={kind:"color"},Qc={kind:"object"},vr={kind:"value"},Lp={kind:"collator"},od={kind:"formatted"},ad={kind:"resolvedImage"};function ji(t,e){return{kind:"array",itemType:t,N:e}}function Rn(t){if(t.kind==="array"){const e=Rn(t.itemType);return typeof t.N=="number"?`array<${e}, ${t.N}>`:t.itemType.kind==="value"?"array":`array<${e}>`}return t.kind}const rL=[Jc,lt,gr,Mr,Io,od,Qc,ji(vr),ad];function sd(t,e){if(e.kind==="error")return null;if(t.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!sd(t.itemType,e.itemType))&&(typeof t.N!="number"||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if(t.kind==="value"){for(const r of rL)if(!sd(r,e))return null}}return`Expected ${Rn(t)} but found ${Rn(e)} instead.`}function by(t,e){return e.some(r=>r.kind===t.kind)}function ld(t,e){return e.some(r=>r==="null"?t===null:r==="array"?Array.isArray(t):r==="object"?t&&!Array.isArray(t)&&typeof t=="object":r===typeof t)}var wy,mE={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Op(t){return(t=Math.round(t))<0?0:t>255?255:t}function Ey(t){return Op(t[t.length-1]==="%"?parseFloat(t)/100*255:parseInt(t))}function Fp(t){return(e=t[t.length-1]==="%"?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function Sy(t,e,r){return r<0?r+=1:r>1&&(r-=1),6*r<1?t+(e-t)*r*6:2*r<1?e:3*r<2?t+(e-t)*(2/3-r)*6:t}try{wy={}.parseCSSColor=function(t){var e,r=t.replace(/ /g,"").toLowerCase();if(r in mE)return mE[r].slice();if(r[0]==="#")return r.length===4?(e=parseInt(r.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:r.length===7&&(e=parseInt(r.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var i=r.indexOf("("),a=r.indexOf(")");if(i!==-1&&a+1===r.length){var s=r.substr(0,i),c=r.substr(i+1,a-(i+1)).split(","),u=1;switch(s){case"rgba":if(c.length!==4)return null;u=Fp(c.pop());case"rgb":return c.length!==3?null:[Ey(c[0]),Ey(c[1]),Ey(c[2]),u];case"hsla":if(c.length!==4)return null;u=Fp(c.pop());case"hsl":if(c.length!==3)return null;var d=(parseFloat(c[0])%360+360)%360/360,p=Fp(c[1]),m=Fp(c[2]),_=m<=.5?m*(p+1):m+p-m*p,y=2*m-_;return[Op(255*Sy(y,_,d+1/3)),Op(255*Sy(y,_,d)),Op(255*Sy(y,_,d-1/3)),u];default:return null}}return null}}catch{}class $i{constructor(e,r,i,a=1){this.r=e,this.g=r,this.b=i,this.a=a}static parse(e){if(!e)return;if(e instanceof $i)return e;if(typeof e!="string")return;const r=wy(e);return r?new $i(r[0]/255*r[3],r[1]/255*r[3],r[2]/255*r[3],r[3]):void 0}toString(){const[e,r,i,a]=this.toArray();return`rgba(${Math.round(e)},${Math.round(r)},${Math.round(i)},${a})`}toArray(){const{r:e,g:r,b:i,a}=this;return a===0?[0,0,0,0]:[255*e/a,255*r/a,255*i/a,a]}toArray01(){const{r:e,g:r,b:i,a}=this;return a===0?[0,0,0,0]:[e/a,r/a,i/a,a]}toArray01Scaled(e){const{r,g:i,b:a,a:s}=this;return s===0?[0,0,0]:[r/s*e,i/s*e,a/s*e]}toArray01PremultipliedAlpha(){const{r:e,g:r,b:i,a}=this;return[e,r,i,a]}toArray01Linear(){const{r:e,g:r,b:i,a}=this;return a===0?[0,0,0,0]:[Math.pow(e/a,2.2),Math.pow(r/a,2.2),Math.pow(i/a,2.2),a]}}$i.black=new $i(0,0,0,1),$i.white=new $i(1,1,1,1),$i.transparent=new $i(0,0,0,0),$i.red=new $i(1,0,0,1),$i.blue=new $i(0,0,1,1);var Zt=$i;class Ty{constructor(e,r,i){this.sensitivity=e?r?"variant":"case":r?"accent":"base",this.locale=i,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,r){return this.collator.compare(e,r)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class My{constructor(e,r,i,a,s){this.text=e.normalize?e.normalize():e,this.image=r,this.scale=i,this.fontStack=a,this.textColor=s}}class Vi{constructor(e){this.sections=e}static fromString(e){return new Vi([new My(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.namePrimary.length!==0)}static factory(e){return e instanceof Vi?e:Vi.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const r of this.sections){if(r.image){e.push(["image",r.image.namePrimary]);continue}e.push(r.text);const i={};r.fontStack&&(i["text-font"]=["literal",r.fontStack.split(",")]),r.scale&&(i["font-scale"]=r.scale),r.textColor&&(i["text-color"]=["rgba"].concat(r.textColor.toArray())),e.push(i)}return e}}class Po{constructor(e){this.namePrimary=e.namePrimary,e.nameSecondary&&(this.nameSecondary=e.nameSecondary),this.available=e.available}toString(){return this.nameSecondary?`[${this.namePrimary},${this.nameSecondary}]`:this.namePrimary}static fromString(e,r){return e?new Po({namePrimary:e,nameSecondary:r,available:!1}):null}serialize(){return this.nameSecondary?["image",this.namePrimary,this.nameSecondary]:["image",this.namePrimary]}}function gE(t,e,r,i){return typeof t=="number"&&t>=0&&t<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof r=="number"&&r>=0&&r<=255?i===void 0||typeof i=="number"&&i>=0&&i<=1?null:`Invalid rgba value [${[t,e,r,i].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof i=="number"?[t,e,r,i]:[t,e,r]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function eu(t){if(t===null||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||t instanceof Zt||t instanceof Ty||t instanceof Vi||t instanceof Po)return!0;if(Array.isArray(t)){for(const e of t)if(!eu(e))return!1;return!0}if(typeof t=="object"){for(const e in t)if(!eu(t[e]))return!1;return!0}return!1}function Hn(t){if(t===null)return Jc;if(typeof t=="string")return gr;if(typeof t=="boolean")return Mr;if(typeof t=="number")return lt;if(t instanceof Zt)return Io;if(t instanceof Ty)return Lp;if(t instanceof Vi)return od;if(t instanceof Po)return ad;if(Array.isArray(t)){const e=t.length;let r;for(const i of t){const a=Hn(i);if(r){if(r===a)continue;r=vr;break}r=a}return ji(r||vr,e)}return Qc}function cd(t){const e=typeof t;return t===null?"":e==="string"||e==="number"||e==="boolean"?String(t):t instanceof Zt||t instanceof Vi||t instanceof Po?t.toString():JSON.stringify(t)}class Cy{constructor(e,r){this.type=e,this.value=r}static parse(e,r){if(e.length!==2)return r.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!eu(e[1]))return r.error("invalid value");const i=e[1];let a=Hn(i);const s=r.expectedType;return a.kind!=="array"||a.N!==0||!s||s.kind!=="array"||typeof s.N=="number"&&s.N!==0||(a=s),new Cy(a,i)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Zt?["rgba"].concat(this.value.toArray()):this.value instanceof Vi?this.value.serialize():this.value}}var ud=Cy,Jn=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const Ay={string:gr,number:lt,boolean:Mr,object:Qc};class Iy{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");let i,a=1;const s=e[0];if(s==="array"){let u,d;if(e.length>2){const p=e[1];if(typeof p!="string"||!(p in Ay)||p==="object")return r.error('The item type argument of "array" must be one of string, number, boolean',1);u=Ay[p],a++}else u=vr;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return r.error('The length argument to "array" must be a positive integer literal',2);d=e[2],a++}i=ji(u,d)}else i=Ay[s];const c=[];for(;a<e.length;a++){const u=r.parse(e[a],a,vr);if(!u)return null;c.push(u)}return new Iy(i,c)}evaluate(e){for(let r=0;r<this.args.length;r++){const i=this.args[r].evaluate(e);if(!sd(this.type,Hn(i)))return i;if(r===this.args.length-1)throw new Jn(`Expected value to be of type ${Rn(this.type)}, but found ${Rn(Hn(i))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,r=[e.kind];if(e.kind==="array"){const i=e.itemType;if(i.kind==="string"||i.kind==="number"||i.kind==="boolean"){r.push(i.kind);const a=e.N;(typeof a=="number"||this.args.length>1)&&r.push(a)}}return r.concat(this.args.map(i=>i.serialize()))}}var Za=Iy;class hd{constructor(e){this.type=od,this.sections=e}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const i=e[1];if(!Array.isArray(i)&&typeof i=="object")return r.error("First argument must be an image or text section.");const a=[];let s=!1;for(let c=1;c<=e.length-1;++c){const u=e[c];if(s&&typeof u=="object"&&!Array.isArray(u)){s=!1;let d=null;if(u["font-scale"]&&(d=r.parse(u["font-scale"],1,lt),!d))return null;let p=null;if(u["text-font"]&&(p=r.parse(u["text-font"],1,ji(gr)),!p))return null;let m=null;if(u["text-color"]&&(m=r.parse(u["text-color"],1,Io),!m))return null;const _=a[a.length-1];_.scale=d,_.font=p,_.textColor=m}else{const d=r.parse(e[c],1,vr);if(!d)return null;const p=d.type.kind;if(p!=="string"&&p!=="value"&&p!=="null"&&p!=="resolvedImage")return r.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");s=!0,a.push({content:d,scale:null,font:null,textColor:null})}}return new hd(a)}evaluate(e){return new Vi(this.sections.map(r=>{const i=r.content.evaluate(e);return Hn(i)===ad?new My("",i,null,null,null):new My(cd(i),null,r.scale?r.scale.evaluate(e):null,r.font?r.font.evaluate(e).join(","):null,r.textColor?r.textColor.evaluate(e):null)}))}eachChild(e){for(const r of this.sections)e(r.content),r.scale&&e(r.scale),r.font&&e(r.font),r.textColor&&e(r.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const r of this.sections){e.push(r.content.serialize());const i={};r.scale&&(i["font-scale"]=r.scale.serialize()),r.font&&(i["text-font"]=r.font.serialize()),r.textColor&&(i["text-color"]=r.textColor.serialize()),e.push(i)}return e}}class dd{constructor(e,r){this.type=ad,this.inputPrimary=e,this.inputSecondary=r}static parse(e,r){if(e.length<2)return r.error("Expected two or more arguments.");const i=r.parse(e[1],1,gr);if(!i)return r.error("No image name provided.");if(e.length===2)return new dd(i);const a=r.parse(e[2],1,gr);return a?new dd(i,a):r.error("Secondary image variant is not a string.")}evaluate(e){const r=Po.fromString(this.inputPrimary.evaluate(e),this.inputSecondary?this.inputSecondary.evaluate(e):void 0);return r&&e.availableImages&&(r.available=e.availableImages.indexOf(r.namePrimary)>-1,r.nameSecondary&&r.available&&e.availableImages&&(r.available=e.availableImages.indexOf(r.nameSecondary)>-1)),r}eachChild(e){e(this.inputPrimary),this.inputSecondary&&e(this.inputSecondary)}outputDefined(){return!1}serialize(){return this.inputSecondary?["image",this.inputPrimary.serialize(),this.inputSecondary.serialize()]:["image",this.inputPrimary.serialize()]}}function Dr(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":t===null?"null":typeof t}const nL={"to-boolean":Mr,"to-color":Io,"to-number":lt,"to-string":gr};class Py{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expected at least one argument.");const i=e[0],a=[];let s=Jc;if(i==="to-array"){if(!Array.isArray(e[1]))return null;const c=e[1].length;if(r.expectedType){if(r.expectedType.kind!=="array")return r.error(`Expected ${r.expectedType.kind} but found array.`);s=ji(r.expectedType.itemType,c)}else{if(!(c>0&&eu(e[1][0])))return null;s=ji(Hn(e[1][0]),c)}for(let u=0;u<c;u++){const d=e[1][u];let p;if(Dr(d)==="array")p=r.parse(d,void 0,s.itemType);else{const m=Dr(d);if(m!==s.itemType.kind)return r.error(`Expected ${s.itemType.kind} but found ${m}.`);p=r.registry.literal.parse(["literal",d===void 0?null:d],r)}if(!p)return null;a.push(p)}}else{if((i==="to-boolean"||i==="to-string")&&e.length!==2)return r.error("Expected one argument.");s=nL[i];for(let c=1;c<e.length;c++){const u=r.parse(e[c],c,vr);if(!u)return null;a.push(u)}}return new Py(s,a)}evaluate(e){if(this.type.kind==="boolean")return!!this.args[0].evaluate(e);if(this.type.kind==="color"){let r,i;for(const a of this.args){if(r=a.evaluate(e),i=null,r instanceof Zt)return r;if(typeof r=="string"){const s=e.parseColor(r);if(s)return s}else if(Array.isArray(r)&&(i=r.length<3||r.length>4?`Invalid rbga value ${JSON.stringify(r)}: expected an array containing either three or four numeric values.`:gE(r[0],r[1],r[2],r[3]),!i))return new Zt(r[0]/255,r[1]/255,r[2]/255,r[3])}throw new Jn(i||`Could not parse color from value '${typeof r=="string"?r:String(JSON.stringify(r))}'`)}if(this.type.kind==="number"){let r=null;for(const i of this.args){if(r=i.evaluate(e),r===null)return 0;const a=Number(r);if(!isNaN(a))return a}throw new Jn(`Could not convert ${JSON.stringify(r)} to number.`)}return this.type.kind==="formatted"?Vi.fromString(cd(this.args[0].evaluate(e))):this.type.kind==="resolvedImage"?Po.fromString(cd(this.args[0].evaluate(e))):this.type.kind==="array"?this.args.map(r=>r.evaluate(e)):cd(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if(this.type.kind==="formatted")return new hd([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new dd(this.args[0]).serialize();const e=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(r=>{e.push(r.serialize())}),e}}var Zl=Py;const iL=["Unknown","Point","LineString","Polygon"];var _E=class{constructor(t){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.options=t}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?iL[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(t){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:r,y:i}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(r*e-t[0])+this.featureDistanceData.bearing[1]*(i*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=Zt.parse(t)),e}getConfig(t){return this.options?this.options.get(t):null}};class tu{constructor(e,r,i,a){this.name=e,this.type=r,this._evaluate=i,this.args=a}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,r){const i=e[0],a=tu.definitions[i];if(!a)return r.error(`Unknown expression "${i}". If you wanted a literal array, use ["literal", [...]].`,0);const s=Array.isArray(a)?a[0]:a.type,c=Array.isArray(a)?[[a[1],a[2]]]:a.overloads,u=c.filter(([p])=>!Array.isArray(p)||p.length===e.length-1);let d=null;for(const[p,m]of u){d=new DE(r.registry,r.path,null,r.scope,void 0,r.options);const _=[];let y=!1;for(let v=1;v<e.length;v++){const b=e[v],S=Array.isArray(p)?p[v-1]:p.type,T=d.parse(b,1+_.length,S);if(!T){y=!0;break}_.push(T)}if(!y)if(Array.isArray(p)&&p.length!==_.length)d.error(`Expected ${p.length} arguments, but found ${_.length} instead.`);else{for(let v=0;v<_.length;v++){const b=Array.isArray(p)?p[v]:p.type,S=_[v];d.concat(v+1).checkSubtype(b,S.type)}if(d.errors.length===0)return new tu(i,s,m,_)}}if(u.length===1)r.errors.push(...d.errors);else{const p=(u.length?u:c).map(([_])=>{return y=_,Array.isArray(y)?`(${y.map(Rn).join(", ")})`:`(${Rn(y.type)}...)`;var y}).join(" | "),m=[];for(let _=1;_<e.length;_++){const y=r.parse(e[_],1+m.length);if(!y)return null;m.push(Rn(y.type))}r.error(`Expected arguments of type ${p}, but found (${m.join(", ")}) instead.`)}return null}static register(e,r){tu.definitions=r;for(const i in r)e[i]=tu}}var Ta=tu;class Bp{constructor(e,r,i){this.type=Lp,this.locale=i,this.caseSensitive=e,this.diacriticSensitive=r}static parse(e,r){if(e.length!==2)return r.error("Expected one argument.");const i=e[1];if(typeof i!="object"||Array.isArray(i))return r.error("Collator options argument must be an object.");const a=r.parse(i["case-sensitive"]!==void 0&&i["case-sensitive"],1,Mr);if(!a)return null;const s=r.parse(i["diacritic-sensitive"]!==void 0&&i["diacritic-sensitive"],1,Mr);if(!s)return null;let c=null;return i.locale&&(c=r.parse(i.locale,1,gr),!c)?null:new Bp(a,s,c)}evaluate(e){return new Ty(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}var yE={exports:{}};yE.exports=function(){function t(i,a,s,c,u){for(;c>s;){if(c-s>600){var d=c-s+1,p=a-s+1,m=Math.log(d),_=.5*Math.exp(2*m/3),y=.5*Math.sqrt(m*_*(d-_)/d)*(p-d/2<0?-1:1);t(i,a,Math.max(s,Math.floor(a-p*_/d+y)),Math.min(c,Math.floor(a+(d-p)*_/d+y)),u)}var v=i[a],b=s,S=c;for(e(i,s,a),u(i[c],v)>0&&e(i,s,c);b<S;){for(e(i,b,S),b++,S--;u(i[b],v)<0;)b++;for(;u(i[S],v)>0;)S--}u(i[s],v)===0?e(i,s,S):e(i,++S,c),S<=a&&(s=S+1),a<=S&&(c=S-1)}}function e(i,a,s){var c=i[a];i[a]=i[s],i[s]=c}function r(i,a){return i<a?-1:i>a?1:0}return function(i,a,s,c,u){t(i,a,s||0,c||i.length-1,u||r)}}();var oL=V(yE.exports);function aL(t){let e=0;for(let r,i,a=0,s=t.length,c=s-1;a<s;c=a++)r=t[a],i=t[c],e+=(i.x-r.x)*(r.y+i.y);return e}function fd(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function pd(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function sL(t,e,r){const i=t[0]-e[0],a=t[1]-e[1],s=t[0]-r[0],c=t[1]-r[1];return i*c-s*a==0&&i*s<=0&&a*c<=0}function ru(t,e,r=!1){let i=!1;for(let u=0,d=e.length;u<d;u++){const p=e[u];for(let m=0,_=p.length,y=_-1;m<_;y=m++){const v=p[y],b=p[m];if(sL(t,v,b))return r;(s=v)[1]>(a=t)[1]!=(c=b)[1]>a[1]&&a[0]<(c[0]-s[0])*(a[1]-s[1])/(c[1]-s[1])+s[0]&&(i=!i)}}var a,s,c;return i}function vE(t,e,r,i){const a=i[0]-r[0],s=i[1]-r[1],c=(t[0]-r[0])*s-a*(t[1]-r[1]),u=(e[0]-r[0])*s-a*(e[1]-r[1]);return c>0&&u<0||c<0&&u>0}function Np(t,e,r,i){return(a=[i[0]-r[0],i[1]-r[1]])[0]*(s=[e[0]-t[0],e[1]-t[1]])[1]-a[1]*s[0]!=0&&!(!vE(t,e,r,i)||!vE(r,i,t,e));var a,s}const Ds=8192;function lL(t,e){const r=(180+t[0])/360,i=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,a=Math.pow(2,e.z);return[Math.round(r*a*Ds),Math.round(i*a*Ds)]}function cL(t,e){for(let r=0;r<e.length;r++)if(ru(t,e[r]))return!0;return!1}function uL(t,e,r){for(const i of r)for(let a=0,s=i.length,c=s-1;a<s;c=a++)if(Np(t,e,i[c],i[a]))return!0;return!1}function xE(t,e){for(let r=0;r<t.length;++r)if(!ru(t[r],e))return!1;for(let r=0;r<t.length-1;++r)if(uL(t[r],t[r+1],e))return!1;return!0}function hL(t,e){for(let r=0;r<e.length;r++)if(xE(t,e[r]))return!0;return!1}function ky(t,e,r){const i=[];for(let a=0;a<t.length;a++){const s=[];for(let c=0;c<t[a].length;c++){const u=lL(t[a][c],r);fd(e,u),s.push(u)}i.push(s)}return i}function bE(t,e,r){const i=[];for(let a=0;a<t.length;a++){const s=ky(t[a],e,r);i.push(s)}return i}function wE(t,e,r,i){if(t[0]<r[0]||t[0]>r[2]){const a=.5*i;let s=t[0]-r[0]>a?-i:r[0]-t[0]>a?i:0;s===0&&(s=t[0]-r[2]>a?-i:r[2]-t[0]>a?i:0),t[0]+=s}fd(e,t)}function EE(t,e,r,i){const a=Math.pow(2,i.z)*Ds,s=[i.x*Ds,i.y*Ds],c=[];if(!t)return c;for(const u of t)for(const d of u){const p=[d.x+s[0],d.y+s[1]];wE(p,e,r,a),c.push(p)}return c}function SE(t,e,r,i){const a=Math.pow(2,i.z)*Ds,s=[i.x*Ds,i.y*Ds],c=[];if(!t)return c;for(const d of t){const p=[];for(const m of d){const _=[m.x+s[0],m.y+s[1]];fd(e,_),p.push(_)}c.push(p)}if(e[2]-e[0]<=a/2){(u=e)[0]=u[1]=1/0,u[2]=u[3]=-1/0;for(const d of c)for(const p of d)wE(p,e,r,a)}var u;return c}class md{constructor(e,r){this.type=Mr,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(eu(e[1])){const i=e[1];if(i.type==="FeatureCollection")for(let a=0;a<i.features.length;++a){const s=i.features[a].geometry.type;if(s==="Polygon"||s==="MultiPolygon")return new md(i,i.features[a].geometry)}else if(i.type==="Feature"){const a=i.geometry.type;if(a==="Polygon"||a==="MultiPolygon")return new md(i,i.geometry)}else if(i.type==="Polygon"||i.type==="MultiPolygon")return new md(i,i)}return r.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(r,i){const a=[1/0,1/0,-1/0,-1/0],s=[1/0,1/0,-1/0,-1/0],c=r.canonicalID();if(!c)return!1;if(i.type==="Polygon"){const u=ky(i.coordinates,s,c),d=EE(r.geometry(),a,s,c);if(!pd(a,s))return!1;for(const p of d)if(!ru(p,u))return!1}if(i.type==="MultiPolygon"){const u=bE(i.coordinates,s,c),d=EE(r.geometry(),a,s,c);if(!pd(a,s))return!1;for(const p of d)if(!cL(p,u))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(r,i){const a=[1/0,1/0,-1/0,-1/0],s=[1/0,1/0,-1/0,-1/0],c=r.canonicalID();if(!c)return!1;if(i.type==="Polygon"){const u=ky(i.coordinates,s,c),d=SE(r.geometry(),a,s,c);if(!pd(a,s))return!1;for(const p of d)if(!xE(p,u))return!1}if(i.type==="MultiPolygon"){const u=bE(i.coordinates,s,c),d=SE(r.geometry(),a,s,c);if(!pd(a,s))return!1;for(const p of d)if(!hL(p,u))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Ry=md,TE={exports:{}};TE.exports=function(){var t={kilometers:1,miles:.621371192237334,nauticalmiles:.5399568034557235,meters:1e3,metres:1e3,yards:1093.6132983377079,feet:3280.839895013123,inches:39370.078740157485},e=1/298.257223563,r=e*(2-e),i=Math.PI/180,a=function(p,m){if(p===void 0)throw new Error("No latitude given.");if(m&&!t[m])throw new Error("Unknown unit "+m+". Use one of: "+Object.keys(t).join(", "));var _=6378.137*i*(m?t[m]:1),y=Math.cos(p*i),v=1/(1-r*(1-y*y)),b=Math.sqrt(v);this.kx=_*b*y,this.ky=_*b*v*(1-r)},s={units:{configurable:!0}};function c(p,m){return p[0]===m[0]&&p[1]===m[1]}function u(p,m,_){var y=d(m[0]-p[0]);return[p[0]+y*_,p[1]+(m[1]-p[1])*_]}function d(p){for(;p<-180;)p+=360;for(;p>180;)p-=360;return p}return a.fromTile=function(p,m,_){var y=Math.PI*(1-2*(p+.5)/Math.pow(2,m)),v=Math.atan(.5*(Math.exp(y)-Math.exp(-y)))/i;return new a(v,_)},s.units.get=function(){return t},a.prototype.distance=function(p,m){var _=d(p[0]-m[0])*this.kx,y=(p[1]-m[1])*this.ky;return Math.sqrt(_*_+y*y)},a.prototype.bearing=function(p,m){var _=d(m[0]-p[0])*this.kx;return Math.atan2(_,(m[1]-p[1])*this.ky)/i},a.prototype.destination=function(p,m,_){var y=_*i;return this.offset(p,Math.sin(y)*m,Math.cos(y)*m)},a.prototype.offset=function(p,m,_){return[p[0]+m/this.kx,p[1]+_/this.ky]},a.prototype.lineDistance=function(p){for(var m=0,_=0;_<p.length-1;_++)m+=this.distance(p[_],p[_+1]);return m},a.prototype.area=function(p){for(var m=0,_=0;_<p.length;_++)for(var y=p[_],v=0,b=y.length,S=b-1;v<b;S=v++)m+=d(y[v][0]-y[S][0])*(y[v][1]+y[S][1])*(_?-1:1);return Math.abs(m)/2*this.kx*this.ky},a.prototype.along=function(p,m){var _=0;if(m<=0)return p[0];for(var y=0;y<p.length-1;y++){var v=p[y],b=p[y+1],S=this.distance(v,b);if((_+=S)>m)return u(v,b,(m-(_-S))/S)}return p[p.length-1]},a.prototype.pointToSegmentDistance=function(p,m,_){var y=m[0],v=m[1],b=d(_[0]-y)*this.kx,S=(_[1]-v)*this.ky,T=0;return b===0&&S===0||((T=(d(p[0]-y)*this.kx*b+(p[1]-v)*this.ky*S)/(b*b+S*S))>1?(y=_[0],v=_[1]):T>0&&(y+=b/this.kx*T,v+=S/this.ky*T)),b=d(p[0]-y)*this.kx,S=(p[1]-v)*this.ky,Math.sqrt(b*b+S*S)},a.prototype.pointOnLine=function(p,m){for(var _,y,v,b,S=1/0,T=0;T<p.length-1;T++){var M=p[T][0],C=p[T][1],P=d(p[T+1][0]-M)*this.kx,k=(p[T+1][1]-C)*this.ky,z=0;P===0&&k===0||((z=(d(m[0]-M)*this.kx*P+(m[1]-C)*this.ky*k)/(P*P+k*k))>1?(M=p[T+1][0],C=p[T+1][1]):z>0&&(M+=P/this.kx*z,C+=k/this.ky*z));var L=(P=d(m[0]-M)*this.kx)*P+(k=(m[1]-C)*this.ky)*k;L<S&&(S=L,_=M,y=C,v=T,b=z)}return{point:[_,y],index:v,t:Math.max(0,Math.min(1,b))}},a.prototype.lineSlice=function(p,m,_){var y=this.pointOnLine(_,p),v=this.pointOnLine(_,m);if(y.index>v.index||y.index===v.index&&y.t>v.t){var b=y;y=v,v=b}var S=[y.point],T=y.index+1,M=v.index;!c(_[T],S[0])&&T<=M&&S.push(_[T]);for(var C=T+1;C<=M;C++)S.push(_[C]);return c(_[M],v.point)||S.push(v.point),S},a.prototype.lineSliceAlong=function(p,m,_){for(var y=0,v=[],b=0;b<_.length-1;b++){var S=_[b],T=_[b+1],M=this.distance(S,T);if((y+=M)>p&&v.length===0&&v.push(u(S,T,(p-(y-M))/M)),y>=m)return v.push(u(S,T,(m-(y-M))/M)),v;y>p&&v.push(T)}return v},a.prototype.bufferPoint=function(p,m){var _=m/this.ky,y=m/this.kx;return[p[0]-y,p[1]-_,p[0]+y,p[1]+_]},a.prototype.bufferBBox=function(p,m){var _=m/this.ky,y=m/this.kx;return[p[0]-y,p[1]-_,p[2]+y,p[3]+_]},a.prototype.insideBBox=function(p,m){return d(p[0]-m[0])>=0&&d(p[0]-m[2])<=0&&p[1]>=m[1]&&p[1]<=m[3]},Object.defineProperties(a,s),a}();var zy=V(TE.exports),ME={exports:{}};ME.exports=function(){var t=function(r,i){if(r===void 0&&(r=[]),i===void 0&&(i=e),this.data=r,this.length=this.data.length,this.compare=i,this.length>0)for(var a=(this.length>>1)-1;a>=0;a--)this._down(a)};function e(r,i){return r<i?-1:r>i?1:0}return t.prototype.push=function(r){this.data.push(r),this.length++,this._up(this.length-1)},t.prototype.pop=function(){if(this.length!==0){var r=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),r}},t.prototype.peek=function(){return this.data[0]},t.prototype._up=function(r){for(var i=this.data,a=this.compare,s=i[r];r>0;){var c=r-1>>1,u=i[c];if(a(s,u)>=0)break;i[r]=u,r=c}i[r]=s},t.prototype._down=function(r){for(var i=this.data,a=this.compare,s=this.length>>1,c=i[r];r<s;){var u=1+(r<<1),d=i[u],p=u+1;if(p<this.length&&a(i[p],d)<0&&(u=p,d=i[p]),a(d,c)>=0)break;i[r]=d,r=u}i[r]=c},t}();var Dy=V(ME.exports),Ae=8192;function CE(t,e){return e.dist-t.dist}const Ly=100,Oy=50;function AE(t){const e=[1/0,1/0,-1/0,-1/0];if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function jp(t){return t[1]-t[0]+1}function Xa(t,e){const r=t[1]>=t[0]&&t[1]<e;return r||console.warn("Distance Expression: Index is out of range"),r}function Fy(t,e){if(t[0]>t[1])return[null,null];const r=jp(t);if(e){if(r===2)return[t,null];const i=Math.floor(r/2);return[[t[0],t[0]+i],[t[0]+i,t[1]]]}{if(r===1)return[t,null];const i=Math.floor(r/2)-1;return[[t[0],t[0]+i],[t[0]+i+1,t[1]]]}}function Xl(t,e){const r=[1/0,1/0,-1/0,-1/0];if(!Xa(e,t.length))return r;for(let i=e[0];i<=e[1];++i)fd(r,t[i]);return r}function $p(t){const e=[1/0,1/0,-1/0,-1/0];for(let r=0;r<t.length;++r)for(let i=0;i<t[r].length;++i)fd(e,t[r][i]);return e}function nu(t,e,r){if(AE(t)||AE(e))return NaN;let i=0,a=0;return t[2]<e[0]&&(i=e[0]-t[2]),t[0]>e[2]&&(i=t[0]-e[2]),t[1]>e[3]&&(a=t[1]-e[3]),t[3]<e[1]&&(a=e[1]-t[3]),r.distance([0,0],[i,a])}function By(t,e){const r=Math.pow(2,e.z);return[(a=(t.x/Ae+e.x)/r,360*a-180),(i=(t.y/Ae+e.y)/r,360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90)];var i,a}function dL(t,e){const r=[];for(let i=0;i<t.length;++i)r.push(By(t[i],e));return r}function IE(t,e,r){const i=r.pointOnLine(e,t).point;return r.distance(t,i)}function PE(t,e,r,i,a){const s=r.slice(i[0],i[1]+1);let c=1/0;for(let u=e[0];u<=e[1];++u)if((c=Math.min(c,IE(t[u],s,a)))===0)return 0;return c}function Ny(t,e,r,i,a){const s=Math.min(a.pointToSegmentDistance(t,r,i),a.pointToSegmentDistance(e,r,i)),c=Math.min(a.pointToSegmentDistance(r,t,e),a.pointToSegmentDistance(i,t,e));return Math.min(s,c)}function fL(t,e,r,i,a){if(!Xa(e,t.length)||!Xa(i,r.length))return NaN;let s=1/0;for(let c=e[0];c<e[1];++c)for(let u=i[0];u<i[1];++u){if(Np(t[c],t[c+1],r[u],r[u+1]))return 0;s=Math.min(s,Ny(t[c],t[c+1],r[u],r[u+1],a))}return s}function pL(t,e,r,i,a){if(!Xa(e,t.length)||!Xa(i,r.length))return NaN;let s=1/0;for(let c=e[0];c<=e[1];++c)for(let u=i[0];u<=i[1];++u)if((s=Math.min(s,a.distance(t[c],r[u])))===0)return s;return s}function mL(t,e,r){if(ru(t,e,!0))return 0;let i=1/0;for(const a of e){const s=a.length;if(s<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(a[0]!==a[s-1]&&(i=Math.min(i,r.pointToSegmentDistance(t,a[s-1],a[0])))===0||(i=Math.min(i,IE(t,a,r)))===0)return i}return i}function gL(t,e,r,i){if(!Xa(e,t.length))return NaN;for(let s=e[0];s<=e[1];++s)if(ru(t[s],r,!0))return 0;let a=1/0;for(let s=e[0];s<e[1];++s)for(const c of r)for(let u=0,d=c.length,p=d-1;u<d;p=u++){if(Np(t[s],t[s+1],c[p],c[u]))return 0;a=Math.min(a,Ny(t[s],t[s+1],c[p],c[u],i))}return a}function kE(t,e){for(const r of t)for(let i=0;i<=r.length-1;++i)if(ru(r[i],e,!0))return!0;return!1}function _L(t,e,r,i=1/0){const a=$p(t),s=$p(e);if(i!==1/0&&nu(a,s,r)>=i)return i;if(pd(a,s)){if(kE(t,e))return 0}else if(kE(e,t))return 0;let c=i;for(const u of t)for(let d=0,p=u.length,m=p-1;d<p;m=d++)for(const _ of e)for(let y=0,v=_.length,b=v-1;y<v;b=y++){if(Np(u[m],u[d],_[b],_[y]))return 0;c=Math.min(c,Ny(u[m],u[d],_[b],_[y],r))}return c}function Vp(t,e,r,i,a,s,c){if(s===null||c===null)return;const u=nu(Xl(i,s),Xl(a,c),r);u<e&&t.push({dist:u,range1:s,range2:c})}function yL(t,e,r,i,a=1/0){let s=Math.min(i.distance(t[0],r[0][0]),a);if(s===0)return s;const c=new Dy([{dist:0,range1:[0,t.length-1],range2:[0,0]}],CE),u=e?Oy:Ly,d=$p(r);for(;c.length;){const p=c.pop();if(p.dist>=s)continue;const m=p.range1;if(jp(m)<=u){if(!Xa(m,t.length))return NaN;if(e){const _=gL(t,m,r,i);if((s=Math.min(s,_))===0)return s}else for(let _=m[0];_<=m[1];++_){const y=mL(t[_],r,i);if((s=Math.min(s,y))===0)return s}}else{const _=Fy(m,e);if(_[0]!==null){const y=nu(Xl(t,_[0]),d,i);y<s&&c.push({dist:y,range1:_[0],range2:[0,0]})}if(_[1]!==null){const y=nu(Xl(t,_[1]),d,i);y<s&&c.push({dist:y,range1:_[1],range2:[0,0]})}}}return s}function RE(t,e,r,i,a,s=1/0){let c=Math.min(s,a.distance(t[0],r[0]));if(c===0)return c;const u=new Dy([{dist:0,range1:[0,t.length-1],range2:[0,r.length-1]}],CE),d=e?Oy:Ly,p=i?Oy:Ly;for(;u.length;){const m=u.pop();if(m.dist>=c)continue;const _=m.range1,y=m.range2;if(jp(_)<=d&&jp(y)<=p){if(!Xa(_,t.length)||!Xa(y,r.length))return NaN;if(e&&i?c=Math.min(c,fL(t,_,r,y,a)):e||i?e&&!i?c=Math.min(c,PE(r,y,t,_,a)):!e&&i&&(c=Math.min(c,PE(t,_,r,y,a))):c=Math.min(c,pL(t,_,r,y,a)),c===0)return c}else{const v=Fy(_,e),b=Fy(y,i);Vp(u,c,a,t,r,v[0],b[0]),Vp(u,c,a,t,r,v[0],b[1]),Vp(u,c,a,t,r,v[1],b[0]),Vp(u,c,a,t,r,v[1],b[1])}}return c}function jy(t,e,r,i,a=1/0){let s=a;const c=Xl(t,[0,t.length-1]);for(const u of r)if(!(s!==1/0&&nu(c,Xl(u,[0,u.length-1]),i)>=s)&&(s=Math.min(s,RE(t,e,u,!0,i,s)),s===0))return s;return s}function Up(t,e,r,i,a=1/0){let s=a;const c=Xl(t,[0,t.length-1]);for(const u of r){if(s!==1/0&&nu(c,$p(u),i)>=s)continue;const d=yL(t,e,u,i,s);if(isNaN(d))return d;if((s=Math.min(s,d))===0)return s}return s}function $y(t){return t==="Point"||t==="MultiPoint"||t==="LineString"||t==="MultiLineString"||t==="Polygon"||t==="MultiPolygon"}class gd{constructor(e,r){this.type=lt,this.geojson=e,this.geometries=r}static parse(e,r){if(e.length!==2)return r.error(`'distance' expression requires either one argument, but found ' ${e.length-1} instead.`);if(eu(e[1])){const i=e[1];if(i.type==="FeatureCollection"){for(let a=0;a<i.features.length;++a)if($y(i.features[a].geometry.type))return new gd(i,i.features[a].geometry)}else if(i.type==="Feature"){if($y(i.geometry.type))return new gd(i,i.geometry)}else if($y(i.type))return new gd(i,i)}return r.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(e){const r=e.geometry(),i=e.canonicalID();if(r!=null&&i!=null){if(e.geometryType()==="Point")return function(a,s,c){const u=[];for(const p of a)for(const m of p)u.push(By(m,s));const d=new zy(u[0][1],"meters");return c.type==="Point"||c.type==="MultiPoint"||c.type==="LineString"?RE(u,!1,c.type==="Point"?[c.coordinates]:c.coordinates,c.type==="LineString",d):c.type==="MultiLineString"?jy(u,!1,c.coordinates,d):c.type==="Polygon"||c.type==="MultiPolygon"?Up(u,!1,c.type==="Polygon"?[c.coordinates]:c.coordinates,d):null}(r,i,this.geometries);if(e.geometryType()==="LineString")return function(a,s,c){const u=[];for(const p of a){const m=[];for(const _ of p)m.push(By(_,s));u.push(m)}const d=new zy(u[0][0][1],"meters");if(c.type==="Point"||c.type==="MultiPoint"||c.type==="LineString")return jy(c.type==="Point"?[c.coordinates]:c.coordinates,c.type==="LineString",u,d);if(c.type==="MultiLineString"){let p=1/0;for(let m=0;m<c.coordinates.length;m++){const _=jy(c.coordinates[m],!0,u,d,p);if(isNaN(_))return _;if((p=Math.min(p,_))===0)return p}return p}if(c.type==="Polygon"||c.type==="MultiPolygon"){let p=1/0;for(let m=0;m<u.length;m++){const _=Up(u[m],!0,c.type==="Polygon"?[c.coordinates]:c.coordinates,d,p);if(isNaN(_))return _;if((p=Math.min(p,_))===0)return p}return p}return null}(r,i,this.geometries);if(e.geometryType()==="Polygon")return function(a,s,c){const u=[];for(const p of function(m,_){const y=m.length;if(y<=1)return[m];const v=[];let b,S;for(let T=0;T<y;T++){const M=aL(m[T]);M!==0&&(m[T].area=Math.abs(M),S===void 0&&(S=M<0),S===M<0?(b&&v.push(b),b=[m[T]]):b.push(m[T]))}return b&&v.push(b),v}(a)){const m=[];for(let _=0;_<p.length;++_)m.push(dL(p[_],s));u.push(m)}const d=new zy(u[0][0][0][1],"meters");if(c.type==="Point"||c.type==="MultiPoint"||c.type==="LineString")return Up(c.type==="Point"?[c.coordinates]:c.coordinates,c.type==="LineString",u,d);if(c.type==="MultiLineString"){let p=1/0;for(let m=0;m<c.coordinates.length;m++){const _=Up(c.coordinates[m],!0,u,d,p);if(isNaN(_))return _;if((p=Math.min(p,_))===0)return p}return p}return c.type==="Polygon"||c.type==="MultiPolygon"?function(p,m,_){let y=1/0;for(const v of p)for(const b of m){const S=_L(v,b,_,y);if(isNaN(S))return S;if((y=Math.min(y,S))===0)return y}return y}(c.type==="Polygon"?[c.coordinates]:c.coordinates,u,d):null}(r,i,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}var Vy=gd;function _d(t){if(t instanceof Ta&&(t.name==="get"&&t.args.length===1||t.name==="feature-state"||t.name==="has"&&t.args.length===1||t.name==="properties"||t.name==="geometry-type"||t.name==="id"||/^filter-/.test(t.name))||t instanceof Ry||t instanceof Vy)return!1;let e=!0;return t.eachChild(r=>{e&&!_d(r)&&(e=!1)}),e}function Gp(t){if(t instanceof Ta&&t.name==="feature-state")return!1;let e=!0;return t.eachChild(r=>{e&&!Gp(r)&&(e=!1)}),e}function Uy(t){if(t instanceof Ta&&t.name==="config")return!1;let e=!0;return t.eachChild(r=>{e&&!Uy(r)&&(e=!1)}),e}function Yl(t,e){if(t instanceof Ta&&e.indexOf(t.name)>=0)return!1;let r=!0;return t.eachChild(i=>{r&&!Yl(i,e)&&(r=!1)}),r}class Gy{constructor(e,r){this.type=r.type,this.name=e,this.boundExpression=r}static parse(e,r){if(e.length!==2||typeof e[1]!="string")return r.error("'var' expression requires exactly one string literal argument.");const i=e[1];return r.scope.has(i)?new Gy(i,r.scope.get(i)):r.error(`Unknown variable "${i}". Make sure "${i}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var zE=Gy;class Wy{constructor(e,r=[],i,a=new tL,s=[],c){this.registry=e,this.path=r,this.key=r.map(u=>`[${u}]`).join(""),this.scope=a,this.errors=s,this.expectedType=i,this.options=c}parse(e,r,i,a,s={}){return r||i?this.concat(r,i,a)._parse(e,s):this._parse(e,s)}_parse(e,r){function i(a,s,c){return c==="assert"?new Za(s,[a]):c==="coerce"?new Zl(s,[a]):a}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const a=typeof e[0]=="string"?this.registry[e[0]]:void 0;if(a){let s=a.parse(e,this);if(!s)return null;if(this.expectedType){const c=this.expectedType,u=s.type;if(c.kind!=="string"&&c.kind!=="number"&&c.kind!=="boolean"&&c.kind!=="object"&&c.kind!=="array"||u.kind!=="value")if(c.kind!=="color"&&c.kind!=="formatted"&&c.kind!=="resolvedImage"||u.kind!=="value"&&u.kind!=="string"){if(this.checkSubtype(c,u))return null}else s=i(s,c,r.typeAnnotation||"coerce");else s=i(s,c,r.typeAnnotation||"assert")}if(!(s instanceof ud)&&s.type.kind!=="resolvedImage"&&Hy(s)){const c=new _E(this.options);try{s=new ud(s.type,s.evaluate(c))}catch(u){return this.error(u.message),null}}return s}return Zl.parse(["to-array",e],this)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,r,i){const a=typeof e=="number"?this.path.concat(e):this.path,s=i?this.scope.concat(i):this.scope;return new Wy(this.registry,a,r||null,s,this.errors,this.options)}error(e,...r){const i=`${this.key}${r.map(a=>`[${a}]`).join("")}`;this.errors.push(new Sa(i,e))}checkSubtype(e,r){const i=sd(e,r);return i&&this.error(i),i}}var DE=Wy;function Hy(t){if(t instanceof zE)return Hy(t.boundExpression);if(t instanceof Ta&&t.name==="error"||t instanceof Ta&&t.name==="config"||t instanceof Bp||t instanceof Ry||t instanceof Vy)return!1;const e=t instanceof Zl||t instanceof Za;let r=!0;return t.eachChild(i=>{r=e?r&&Hy(i):r&&i instanceof ud}),!!r&&_d(t)&&Yl(t,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light"])}function Wp(t,e){const r=t.length-1;let i,a,s=0,c=r,u=0;for(;s<=c;)if(u=Math.floor((s+c)/2),i=t[u],a=t[u+1],i<=e){if(u===r||e<a)return u;s=u+1}else{if(!(i>e))throw new Jn("Input is not a number.");c=u-1}return 0}class qy{constructor(e,r,i){this.type=e,this.input=r,this.labels=[],this.outputs=[];for(const[a,s]of i)this.labels.push(a),this.outputs.push(s)}static parse(e,r){if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");const i=r.parse(e[1],1,lt);if(!i)return null;const a=[];let s=null;r.expectedType&&r.expectedType.kind!=="value"&&(s=r.expectedType);for(let c=1;c<e.length;c+=2){const u=c===1?-1/0:e[c],d=e[c+1],p=c,m=c+1;if(typeof u!="number")return r.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',p);if(a.length&&a[a.length-1][0]>=u)return r.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',p);const _=r.parse(d,m,s);if(!_)return null;s=s||_.type,a.push([u,_])}return new qy(s,i,a)}evaluate(e){const r=this.labels,i=this.outputs;if(r.length===1)return i[0].evaluate(e);const a=this.input.evaluate(e);if(a<=r[0])return i[0].evaluate(e);const s=r.length;return a>=r[s-1]?i[s-1].evaluate(e):i[Wp(r,a)].evaluate(e)}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let r=0;r<this.labels.length;r++)r>0&&e.push(this.labels[r]),e.push(this.outputs[r].serialize());return e}}var Zy=qy;function Ft(t,e,r){return t*(1-r)+e*r}var Hp=Object.freeze({__proto__:null,array:function(t,e,r){return t.map((i,a)=>Ft(i,e[a],r))},color:function(t,e,r){return new Zt(Ft(t.r,e.r,r),Ft(t.g,e.g,r),Ft(t.b,e.b,r),Ft(t.a,e.a,r))},number:Ft});const LE=.95047,OE=1.08883,FE=4/29,iu=6/29,BE=3*iu*iu,vL=iu*iu*iu,xL=Math.PI/180,bL=180/Math.PI;function Xy(t){return t>vL?Math.pow(t,1/3):t/BE+FE}function Yy(t){return t>iu?t*t*t:BE*(t-FE)}function Ky(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Jy(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function NE(t){const e=Jy(t.r),r=Jy(t.g),i=Jy(t.b),a=Xy((.4124564*e+.3575761*r+.1804375*i)/LE),s=Xy((.2126729*e+.7151522*r+.072175*i)/1);return{l:116*s-16,a:500*(a-s),b:200*(s-Xy((.0193339*e+.119192*r+.9503041*i)/OE)),alpha:t.a}}function jE(t){let e=(t.l+16)/116,r=isNaN(t.a)?e:e+t.a/500,i=isNaN(t.b)?e:e-t.b/200;return e=1*Yy(e),r=LE*Yy(r),i=OE*Yy(i),new Zt(Ky(3.2404542*r-1.5371385*e-.4985314*i),Ky(-.969266*r+1.8760108*e+.041556*i),Ky(.0556434*r-.2040259*e+1.0572252*i),t.alpha)}function wL(t,e,r){const i=e-t;return t+r*(i>180||i<-180?i-360*Math.round(i/360):i)}const yd={forward:NE,reverse:jE,interpolate:function(t,e,r){return{l:Ft(t.l,e.l,r),a:Ft(t.a,e.a,r),b:Ft(t.b,e.b,r),alpha:Ft(t.alpha,e.alpha,r)}}},vd={forward:function(t){const{l:e,a:r,b:i}=NE(t),a=Math.atan2(i,r)*bL;return{h:a<0?a+360:a,c:Math.sqrt(r*r+i*i),l:e,alpha:t.a}},reverse:function(t){const e=t.h*xL,r=t.c;return jE({l:t.l,a:Math.cos(e)*r,b:Math.sin(e)*r,alpha:t.alpha})},interpolate:function(t,e,r){return{h:wL(t.h,e.h,r),c:Ft(t.c,e.c,r),l:Ft(t.l,e.l,r),alpha:Ft(t.alpha,e.alpha,r)}}};var $E=Object.freeze({__proto__:null,hcl:vd,lab:yd});class qp{constructor(e,r,i,a,s){this.type=e,this.operator=r,this.interpolation=i,this.input=a,this.labels=[],this.outputs=[];for(const[c,u]of s)this.labels.push(c),this.outputs.push(u)}static interpolationFactor(e,r,i,a){let s=0;if(e.name==="exponential")s=Qy(r,e.base,i,a);else if(e.name==="linear")s=Qy(r,1,i,a);else if(e.name==="cubic-bezier"){const c=e.controlPoints;s=new le(c[0],c[1],c[2],c[3]).solve(Qy(r,1,i,a))}return s}static parse(e,r){let[i,a,s,...c]=e;if(!Array.isArray(a)||a.length===0)return r.error("Expected an interpolation type expression.",1);if(a[0]==="linear")a={name:"linear"};else if(a[0]==="exponential"){const p=a[1];if(typeof p!="number")return r.error("Exponential interpolation requires a numeric base.",1,1);a={name:"exponential",base:p}}else{if(a[0]!=="cubic-bezier")return r.error(`Unknown interpolation type ${String(a[0])}`,1,0);{const p=a.slice(1);if(p.length!==4||p.some(m=>typeof m!="number"||m<0||m>1))return r.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);a={name:"cubic-bezier",controlPoints:p}}}if(e.length-1<4)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return r.error("Expected an even number of arguments.");if(s=r.parse(s,2,lt),!s)return null;const u=[];let d=null;i==="interpolate-hcl"||i==="interpolate-lab"?d=Io:r.expectedType&&r.expectedType.kind!=="value"&&(d=r.expectedType);for(let p=0;p<c.length;p+=2){const m=c[p],_=c[p+1],y=p+3,v=p+4;if(typeof m!="number")return r.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',y);if(u.length&&u[u.length-1][0]>=m)return r.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',y);const b=r.parse(_,v,d);if(!b)return null;d=d||b.type,u.push([m,b])}return d.kind==="number"||d.kind==="color"||d.kind==="array"&&d.itemType.kind==="number"&&typeof d.N=="number"?new qp(d,i,a,s,u):r.error(`Type ${Rn(d)} is not interpolatable.`)}evaluate(e){const r=this.labels,i=this.outputs;if(r.length===1)return i[0].evaluate(e);const a=this.input.evaluate(e);if(a<=r[0])return i[0].evaluate(e);const s=r.length;if(a>=r[s-1])return i[s-1].evaluate(e);const c=Wp(r,a),u=qp.interpolationFactor(this.interpolation,a,r[c],r[c+1]),d=i[c].evaluate(e),p=i[c+1].evaluate(e);return this.operator==="interpolate"?Hp[this.type.kind.toLowerCase()](d,p,u):this.operator==="interpolate-hcl"?vd.reverse(vd.interpolate(vd.forward(d),vd.forward(p),u)):yd.reverse(yd.interpolate(yd.forward(d),yd.forward(p),u))}eachChild(e){e(this.input);for(const r of this.outputs)e(r)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const r=[this.operator,e,this.input.serialize()];for(let i=0;i<this.labels.length;i++)r.push(this.labels[i],this.outputs[i].serialize());return r}}function Qy(t,e,r,i){const a=i-r,s=t-r;return a===0?0:e===1?s/a:(Math.pow(e,s)-1)/(Math.pow(e,a)-1)}var Ma=qp;class e1{constructor(e,r){this.type=e,this.args=r}static parse(e,r){if(e.length<2)return r.error("Expectected at least one argument.");let i=null;const a=r.expectedType;a&&a.kind!=="value"&&(i=a);const s=[];for(const u of e.slice(1)){const d=r.parse(u,1+s.length,i,void 0,{typeAnnotation:"omit"});if(!d)return null;i=i||d.type,s.push(d)}const c=a&&s.some(u=>sd(a,u.type));return new e1(c?vr:i,s)}evaluate(e){let r,i=null,a=0;for(const s of this.args){if(a++,i=s.evaluate(e),i&&i instanceof Po&&!i.available&&(r||(r=i),i=null,a===this.args.length))return r;if(i!==null)break}return i}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(r=>{e.push(r.serialize())}),e}}var VE=e1;class t1{constructor(e,r){this.type=r.type,this.bindings=[].concat(e),this.result=r}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const r of this.bindings)e(r[1]);e(this.result)}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const i=[];for(let s=1;s<e.length-1;s+=2){const c=e[s];if(typeof c!="string")return r.error(`Expected string, but found ${typeof c} instead.`,s);if(/[^a-zA-Z0-9_]/.test(c))return r.error("Variable names must contain only alphanumeric characters or '_'.",s);const u=r.parse(e[s+1],s+1);if(!u)return null;i.push([c,u])}const a=r.parse(e[e.length-1],e.length-1,r.expectedType,i);return a?new t1(i,a):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[r,i]of this.bindings)e.push(r,i.serialize());return e.push(this.result.serialize()),e}}var UE=t1;class r1{constructor(e,r,i){this.type=e,this.index=r,this.input=i}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const i=r.parse(e[1],1,lt),a=r.parse(e[2],2,ji(r.expectedType||vr));return i&&a?new r1(a.type.itemType,i,a):null}evaluate(e){const r=this.index.evaluate(e),i=this.input.evaluate(e);if(r<0)throw new Jn(`Array index out of bounds: ${r} < 0.`);if(r>=i.length)throw new Jn(`Array index out of bounds: ${r} > ${i.length-1}.`);if(r!==Math.floor(r))throw new Jn(`Array index must be an integer, but found ${r} instead.`);return i[r]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var EL=r1;class n1{constructor(e,r){this.type=Mr,this.needle=e,this.haystack=r}static parse(e,r){if(e.length!==3)return r.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const i=r.parse(e[1],1,vr),a=r.parse(e[2],2,vr);return i&&a?by(i.type,[Mr,gr,lt,Jc,vr])?new n1(i,a):r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Rn(i.type)} instead`):null}evaluate(e){const r=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(i==null)return!1;if(!ld(r,["boolean","string","number","null"]))throw new Jn(`Expected first argument to be of type boolean, string, number or null, but found ${Rn(Hn(r))} instead.`);if(!ld(i,["string","array"]))throw new Jn(`Expected second argument to be of type array or string, but found ${Rn(Hn(i))} instead.`);return i.indexOf(r)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var SL=n1;class Zp{constructor(e,r,i){this.type=lt,this.needle=e,this.haystack=r,this.fromIndex=i}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const i=r.parse(e[1],1,vr),a=r.parse(e[2],2,vr);if(!i||!a)return null;if(!by(i.type,[Mr,gr,lt,Jc,vr]))return r.error(`Expected first argument to be of type boolean, string, number or null, but found ${Rn(i.type)} instead`);if(e.length===4){const s=r.parse(e[3],3,lt);return s?new Zp(i,a,s):null}return new Zp(i,a)}evaluate(e){const r=this.needle.evaluate(e),i=this.haystack.evaluate(e);if(!ld(r,["boolean","string","number","null"]))throw new Jn(`Expected first argument to be of type boolean, string, number or null, but found ${Rn(Hn(r))} instead.`);if(!ld(i,["string","array"]))throw new Jn(`Expected second argument to be of type array or string, but found ${Rn(Hn(i))} instead.`);if(this.fromIndex){const a=this.fromIndex.evaluate(e);return i.indexOf(r,a)}return i.indexOf(r)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var TL=Zp;class i1{constructor(e,r,i,a,s,c){this.inputType=e,this.type=r,this.input=i,this.cases=a,this.outputs=s,this.otherwise=c}static parse(e,r){if(e.length<5)return r.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return r.error("Expected an even number of arguments.");let i,a;r.expectedType&&r.expectedType.kind!=="value"&&(a=r.expectedType);const s={},c=[];for(let p=2;p<e.length-1;p+=2){let m=e[p];const _=e[p+1];Array.isArray(m)||(m=[m]);const y=r.concat(p);if(m.length===0)return y.error("Expected at least one branch label.");for(const b of m){if(typeof b!="number"&&typeof b!="string")return y.error("Branch labels must be numbers or strings.");if(typeof b=="number"&&Math.abs(b)>Number.MAX_SAFE_INTEGER)return y.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof b=="number"&&Math.floor(b)!==b)return y.error("Numeric branch labels must be integer values.");if(i){if(y.checkSubtype(i,Hn(b)))return null}else i=Hn(b);if(s[String(b)]!==void 0)return y.error("Branch labels must be unique.");s[String(b)]=c.length}const v=r.parse(_,p,a);if(!v)return null;a=a||v.type,c.push(v)}const u=r.parse(e[1],1,vr);if(!u)return null;const d=r.parse(e[e.length-1],e.length-1,a);return d?u.type.kind!=="value"&&r.concat(1).checkSubtype(i,u.type)?null:new i1(i,a,u,s,c,d):null}evaluate(e){const r=this.input.evaluate(e);return(Hn(r)===this.inputType&&this.outputs[this.cases[r]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],r=Object.keys(this.cases).sort(),i=[],a={};for(const c of r){const u=a[this.cases[c]];u===void 0?(a[this.cases[c]]=i.length,i.push([this.cases[c],[c]])):i[u][1].push(c)}const s=c=>this.inputType.kind==="number"?Number(c):c;for(const[c,u]of i)e.push(u.length===1?s(u[0]):u.map(s)),e.push(this.outputs[c].serialize());return e.push(this.otherwise.serialize()),e}}var ML=i1;class o1{constructor(e,r,i){this.type=e,this.branches=r,this.otherwise=i}static parse(e,r){if(e.length<4)return r.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return r.error("Expected an odd number of arguments.");let i;r.expectedType&&r.expectedType.kind!=="value"&&(i=r.expectedType);const a=[];for(let c=1;c<e.length-1;c+=2){const u=r.parse(e[c],c,Mr);if(!u)return null;const d=r.parse(e[c+1],c+1,i);if(!d)return null;a.push([u,d]),i=i||d.type}const s=r.parse(e[e.length-1],e.length-1,i);return s?new o1(i,a,s):null}evaluate(e){for(const[r,i]of this.branches)if(r.evaluate(e))return i.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[r,i]of this.branches)e(r),e(i);e(this.otherwise)}outputDefined(){return this.branches.every(([e,r])=>r.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(r=>{e.push(r.serialize())}),e}}var CL=o1;class Xp{constructor(e,r,i,a){this.type=e,this.input=r,this.beginIndex=i,this.endIndex=a}static parse(e,r){if(e.length<=2||e.length>=5)return r.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const i=r.parse(e[1],1,vr),a=r.parse(e[2],2,lt);if(!i||!a)return null;if(!by(i.type,[ji(vr),gr,vr]))return r.error(`Expected first argument to be of type array or string, but found ${Rn(i.type)} instead`);if(e.length===4){const s=r.parse(e[3],3,lt);return s?new Xp(i.type,i,a,s):null}return new Xp(i.type,i,a)}evaluate(e){const r=this.input.evaluate(e),i=this.beginIndex.evaluate(e);if(!ld(r,["string","array"]))throw new Jn(`Expected first argument to be of type array or string, but found ${Rn(Hn(r))} instead.`);if(this.endIndex){const a=this.endIndex.evaluate(e);return r.slice(i,a)}return r.slice(i)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var AL=Xp;function GE(t,e){return t==="=="||t==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function WE(t,e,r,i){return i.compare(e,r)===0}function ou(t,e,r){const i=t!=="=="&&t!=="!=";return class qD{constructor(s,c,u){this.type=Mr,this.lhs=s,this.rhs=c,this.collator=u,this.hasUntypedArgument=s.type.kind==="value"||c.type.kind==="value"}static parse(s,c){if(s.length!==3&&s.length!==4)return c.error("Expected two or three arguments.");const u=s[0];let d=c.parse(s[1],1,vr);if(!d)return null;if(!GE(u,d.type))return c.concat(1).error(`"${u}" comparisons are not supported for type '${Rn(d.type)}'.`);let p=c.parse(s[2],2,vr);if(!p)return null;if(!GE(u,p.type))return c.concat(2).error(`"${u}" comparisons are not supported for type '${Rn(p.type)}'.`);if(d.type.kind!==p.type.kind&&d.type.kind!=="value"&&p.type.kind!=="value")return c.error(`Cannot compare types '${Rn(d.type)}' and '${Rn(p.type)}'.`);i&&(d.type.kind==="value"&&p.type.kind!=="value"?d=new Za(p.type,[d]):d.type.kind!=="value"&&p.type.kind==="value"&&(p=new Za(d.type,[p])));let m=null;if(s.length===4){if(d.type.kind!=="string"&&p.type.kind!=="string"&&d.type.kind!=="value"&&p.type.kind!=="value")return c.error("Cannot use collator to compare non-string types.");if(m=c.parse(s[3],3,Lp),!m)return null}return new qD(d,p,m)}evaluate(s){const c=this.lhs.evaluate(s),u=this.rhs.evaluate(s);if(i&&this.hasUntypedArgument){const d=Hn(c),p=Hn(u);if(d.kind!==p.kind||d.kind!=="string"&&d.kind!=="number")throw new Jn(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${d.kind}, ${p.kind}) instead.`)}if(this.collator&&!i&&this.hasUntypedArgument){const d=Hn(c),p=Hn(u);if(d.kind!=="string"||p.kind!=="string")return e(s,c,u)}return this.collator?r(s,c,u,this.collator.evaluate(s)):e(s,c,u)}eachChild(s){s(this.lhs),s(this.rhs),this.collator&&s(this.collator)}outputDefined(){return!0}serialize(){const s=[t];return this.eachChild(c=>{s.push(c.serialize())}),s}}}const IL=ou("==",function(t,e,r){return e===r},WE),PL=ou("!=",function(t,e,r){return e!==r},function(t,e,r,i){return!WE(0,e,r,i)}),kL=ou("<",function(t,e,r){return e<r},function(t,e,r,i){return i.compare(e,r)<0}),RL=ou(">",function(t,e,r){return e>r},function(t,e,r,i){return i.compare(e,r)>0}),zL=ou("<=",function(t,e,r){return e<=r},function(t,e,r,i){return i.compare(e,r)<=0}),DL=ou(">=",function(t,e,r){return e>=r},function(t,e,r,i){return i.compare(e,r)>=0});class a1{constructor(e,r,i,a,s,c){this.type=gr,this.number=e,this.locale=r,this.currency=i,this.unit=a,this.minFractionDigits=s,this.maxFractionDigits=c}static parse(e,r){if(e.length!==3)return r.error("Expected two arguments.");const i=r.parse(e[1],1,lt);if(!i)return null;const a=e[2];if(typeof a!="object"||Array.isArray(a))return r.error("NumberFormat options argument must be an object.");let s=null;if(a.locale&&(s=r.parse(a.locale,1,gr),!s))return null;let c=null;if(a.currency&&(c=r.parse(a.currency,1,gr),!c))return null;let u=null;if(a.unit&&(u=r.parse(a.unit,1,gr),!u))return null;let d=null;if(a["min-fraction-digits"]&&(d=r.parse(a["min-fraction-digits"],1,lt),!d))return null;let p=null;return a["max-fraction-digits"]&&(p=r.parse(a["max-fraction-digits"],1,lt),!p)?null:new a1(i,s,c,u,d,p)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class s1{constructor(e){this.type=lt,this.input=e}static parse(e,r){if(e.length!==2)return r.error(`Expected 1 argument, but found ${e.length-1} instead.`);const i=r.parse(e[1],1);return i?i.type.kind!=="array"&&i.type.kind!=="string"&&i.type.kind!=="value"?r.error(`Expected argument of type string or array, but found ${Rn(i.type)} instead.`):new s1(i):null}evaluate(e){const r=this.input.evaluate(e);if(typeof r=="string"||Array.isArray(r))return r.length;throw new Jn(`Expected value to be of type string or array, but found ${Rn(Hn(r))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(r=>{e.push(r.serialize())}),e}}function l1(t){return function(){t=1831565813+(t|=0)|0;let e=Math.imul(t^t>>>15,1|t);return e=e+Math.imul(e^e>>>7,61|e)^e,((e^e>>>14)>>>0)/4294967296}}const HE={"==":IL,"!=":PL,">":RL,"<":kL,">=":DL,"<=":zL,array:Za,at:EL,boolean:Za,case:CL,coalesce:VE,collator:Bp,format:hd,image:dd,in:SL,"index-of":TL,interpolate:Ma,"interpolate-hcl":Ma,"interpolate-lab":Ma,length:s1,let:UE,literal:ud,match:ML,number:Za,"number-format":a1,object:Za,slice:AL,step:Zy,string:Za,"to-boolean":Zl,"to-color":Zl,"to-number":Zl,"to-string":Zl,var:zE,within:Ry,distance:Vy};function qE(t,[e,r,i,a]){e=e.evaluate(t),r=r.evaluate(t),i=i.evaluate(t);const s=a?a.evaluate(t):1,c=gE(e,r,i,s);if(c)throw new Jn(c);return new Zt(e/255*s,r/255*s,i/255*s,s)}function ZE(t,[e,r,i,a]){e=e.evaluate(t),r=r.evaluate(t),i=i.evaluate(t);const s=a?a.evaluate(t):1,c=function(p,m,_,y){return typeof p=="number"&&p>=0&&p<=360?typeof m=="number"&&m>=0&&m<=100&&typeof _=="number"&&_>=0&&_<=100?y===void 0||typeof y=="number"&&y>=0&&y<=1?null:`Invalid hsla value [${[p,m,_,y].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof y=="number"?[p,m,_,y]:[p,m,_]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof y=="number"?[p,m,_,y]:[p,m,_]).join(", ")}]: 'h' must be between 0 and 360.`}(e,r,i,s);if(c)throw new Jn(c);const u=`hsla(${e}, ${r}%, ${i}%, ${s})`,d=Zt.parse(u);if(!d)throw new Jn(`Failed to parse HSLA color: ${u}`);return d}function XE(t,e){return t in e}function c1(t,e){const r=e[t];return r===void 0?null:r}function YE(t,e,r){r.length&&(e+=`${r}`);const i=t.getConfig(e);return i?i.evaluate(t):null}function Kl(t){return{type:t}}Ta.register(HE,{error:[{kind:"error"},[gr],(t,[e])=>{throw new Jn(e.evaluate(t))}],typeof:[gr,[vr],(t,[e])=>Rn(Hn(e.evaluate(t)))],"to-rgba":[ji(lt,4),[Io],(t,[e])=>e.evaluate(t).toArray()],rgb:[Io,[lt,lt,lt],qE],rgba:[Io,[lt,lt,lt,lt],qE],hsl:[Io,[lt,lt,lt],ZE],hsla:[Io,[lt,lt,lt,lt],ZE],has:{type:Mr,overloads:[[[gr],(t,[e])=>XE(e.evaluate(t),t.properties())],[[gr,Qc],(t,[e,r])=>XE(e.evaluate(t),r.evaluate(t))]]},get:{type:vr,overloads:[[[gr],(t,[e])=>c1(e.evaluate(t),t.properties())],[[gr,Qc],(t,[e,r])=>c1(e.evaluate(t),r.evaluate(t))]]},config:{type:vr,overloads:[[[gr],(t,[e])=>YE(t,e.evaluate(t),"")],[[gr,gr],(t,[e,r])=>YE(t,e.evaluate(t),r.evaluate(t))]]},"feature-state":[vr,[gr],(t,[e])=>c1(e.evaluate(t),t.featureState||{})],properties:[Qc,[],t=>t.properties()],"geometry-type":[gr,[],t=>t.geometryType()],id:[vr,[],t=>t.id()],zoom:[lt,[],t=>t.globals.zoom],pitch:[lt,[],t=>t.globals.pitch||0],"distance-from-center":[lt,[],t=>t.distanceFromCenter()],"measure-light":[lt,[gr],(t,[e])=>t.measureLight(e.evaluate(t))],"heatmap-density":[lt,[],t=>t.globals.heatmapDensity||0],"line-progress":[lt,[],t=>t.globals.lineProgress||0],"raster-value":[lt,[],t=>t.globals.rasterValue||0],"sky-radial-progress":[lt,[],t=>t.globals.skyRadialProgress||0],accumulated:[vr,[],t=>t.globals.accumulated===void 0?null:t.globals.accumulated],"+":[lt,Kl(lt),(t,e)=>{let r=0;for(const i of e)r+=i.evaluate(t);return r}],"*":[lt,Kl(lt),(t,e)=>{let r=1;for(const i of e)r*=i.evaluate(t);return r}],"-":{type:lt,overloads:[[[lt,lt],(t,[e,r])=>e.evaluate(t)-r.evaluate(t)],[[lt],(t,[e])=>-e.evaluate(t)]]},"/":[lt,[lt,lt],(t,[e,r])=>e.evaluate(t)/r.evaluate(t)],"%":[lt,[lt,lt],(t,[e,r])=>e.evaluate(t)%r.evaluate(t)],ln2:[lt,[],()=>Math.LN2],pi:[lt,[],()=>Math.PI],e:[lt,[],()=>Math.E],"^":[lt,[lt,lt],(t,[e,r])=>Math.pow(e.evaluate(t),r.evaluate(t))],sqrt:[lt,[lt],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[lt,[lt],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[lt,[lt],(t,[e])=>Math.log(e.evaluate(t))],log2:[lt,[lt],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[lt,[lt],(t,[e])=>Math.sin(e.evaluate(t))],cos:[lt,[lt],(t,[e])=>Math.cos(e.evaluate(t))],tan:[lt,[lt],(t,[e])=>Math.tan(e.evaluate(t))],asin:[lt,[lt],(t,[e])=>Math.asin(e.evaluate(t))],acos:[lt,[lt],(t,[e])=>Math.acos(e.evaluate(t))],atan:[lt,[lt],(t,[e])=>Math.atan(e.evaluate(t))],min:[lt,Kl(lt),(t,e)=>Math.min(...e.map(r=>r.evaluate(t)))],max:[lt,Kl(lt),(t,e)=>Math.max(...e.map(r=>r.evaluate(t)))],abs:[lt,[lt],(t,[e])=>Math.abs(e.evaluate(t))],round:[lt,[lt],(t,[e])=>{const r=e.evaluate(t);return r<0?-Math.round(-r):Math.round(r)}],floor:[lt,[lt],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[lt,[lt],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Mr,[gr,vr],(t,[e,r])=>t.properties()[e.value]===r.value],"filter-id-==":[Mr,[vr],(t,[e])=>t.id()===e.value],"filter-type-==":[Mr,[gr],(t,[e])=>t.geometryType()===e.value],"filter-<":[Mr,[gr,vr],(t,[e,r])=>{const i=t.properties()[e.value],a=r.value;return typeof i==typeof a&&i<a}],"filter-id-<":[Mr,[vr],(t,[e])=>{const r=t.id(),i=e.value;return typeof r==typeof i&&r<i}],"filter->":[Mr,[gr,vr],(t,[e,r])=>{const i=t.properties()[e.value],a=r.value;return typeof i==typeof a&&i>a}],"filter-id->":[Mr,[vr],(t,[e])=>{const r=t.id(),i=e.value;return typeof r==typeof i&&r>i}],"filter-<=":[Mr,[gr,vr],(t,[e,r])=>{const i=t.properties()[e.value],a=r.value;return typeof i==typeof a&&i<=a}],"filter-id-<=":[Mr,[vr],(t,[e])=>{const r=t.id(),i=e.value;return typeof r==typeof i&&r<=i}],"filter->=":[Mr,[gr,vr],(t,[e,r])=>{const i=t.properties()[e.value],a=r.value;return typeof i==typeof a&&i>=a}],"filter-id->=":[Mr,[vr],(t,[e])=>{const r=t.id(),i=e.value;return typeof r==typeof i&&r>=i}],"filter-has":[Mr,[vr],(t,[e])=>e.value in t.properties()],"filter-has-id":[Mr,[],t=>t.id()!==null&&t.id()!==void 0],"filter-type-in":[Mr,[ji(gr)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Mr,[ji(vr)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Mr,[gr,ji(vr)],(t,[e,r])=>r.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Mr,[gr,ji(vr)],(t,[e,r])=>function(i,a,s,c){for(;s<=c;){const u=s+c>>1;if(a[u]===i)return!0;a[u]>i?c=u-1:s=u+1}return!1}(t.properties()[e.value],r.value,0,r.value.length-1)],all:{type:Mr,overloads:[[[Mr,Mr],(t,[e,r])=>e.evaluate(t)&&r.evaluate(t)],[Kl(Mr),(t,e)=>{for(const r of e)if(!r.evaluate(t))return!1;return!0}]]},any:{type:Mr,overloads:[[[Mr,Mr],(t,[e,r])=>e.evaluate(t)||r.evaluate(t)],[Kl(Mr),(t,e)=>{for(const r of e)if(r.evaluate(t))return!0;return!1}]]},"!":[Mr,[Mr],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Mr,[gr],(t,[e])=>{const r=t.globals&&t.globals.isSupportedScript;return!r||r(e.evaluate(t))}],upcase:[gr,[gr],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[gr,[gr],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[gr,Kl(vr),(t,e)=>e.map(r=>cd(r.evaluate(t))).join("")],"resolved-locale":[gr,[Lp],(t,[e])=>e.evaluate(t).resolvedLocale()],random:[lt,[lt,lt,vr],(t,e)=>{const[r,i,a]=e.map(c=>c.evaluate(t));if(r>i||r===i)return r;let s;if(typeof a=="string")s=function(c){let u=0;if(c.length===0)return u;for(let d=0;d<c.length;d++)u=(u<<5)-u+c.charCodeAt(d),u&=u;return u}(a);else{if(typeof a!="number")throw new Jn(`Invalid seed input: ${a}`);s=a}return r+l1(s)()*(i-r)}]});var xd=HE;function KE(t){return{result:"success",value:t}}function Jl(t){return{result:"error",value:t}}function JE(t,e){return!!t&&!!t.parameters&&t.parameters.indexOf(e)>-1}function Ql(t){return t["property-type"]==="data-driven"}function QE(t){return JE(t.expression,"measure-light")}function u1(t){return JE(t.expression,"zoom")}function h1(t){return!!t.expression&&t.expression.interpolated}function Yp(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}function LL(t){return t}function eS(t,e){const r=e.type==="color",i=t.stops&&typeof t.stops[0][0]=="object",a=i||!(i||t.property!==void 0),s=t.type||(h1(e)?"exponential":"interval");if(r&&((t=en({},t)).stops&&(t.stops=t.stops.map(p=>[p[0],Zt.parse(p[1])])),t.default=Zt.parse(t.default?t.default:e.default)),t.colorSpace&&t.colorSpace!=="rgb"&&!$E[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let c,u,d;if(s==="exponential")c=tS;else if(s==="interval")c=FL;else if(s==="categorical"){c=OL,u=Object.create(null);for(const p of t.stops)u[p[0]]=p[1];d=typeof t.stops[0][0]}else{if(s!=="identity")throw new Error(`Unknown function type "${s}"`);c=BL}if(i){const p={},m=[];for(let v=0;v<t.stops.length;v++){const b=t.stops[v],S=b[0].zoom;p[S]===void 0&&(p[S]={zoom:S,type:t.type,property:t.property,default:t.default,stops:[]},m.push(S)),p[S].stops.push([b[0].value,b[1]])}const _=[];for(const v of m)_.push([p[v].zoom,eS(p[v],e)]);const y={name:"linear"};return{kind:"composite",interpolationType:y,interpolationFactor:Ma.interpolationFactor.bind(void 0,y),zoomStops:_.map(v=>v[0]),evaluate:({zoom:v},b)=>tS({stops:_,base:t.base},e,v).evaluate(v,b)}}if(a){const p=s==="exponential"?{name:"exponential",base:t.base!==void 0?t.base:1}:null;return{kind:"camera",interpolationType:p,interpolationFactor:Ma.interpolationFactor.bind(void 0,p),zoomStops:t.stops.map(m=>m[0]),evaluate:({zoom:m})=>c(t,e,m,u,d)}}return{kind:"source",evaluate(p,m){const _=m&&m.properties?m.properties[t.property]:void 0;return _===void 0?bd(t.default,e.default):c(t,e,_,u,d)}}}function bd(t,e,r){return t!==void 0?t:e!==void 0?e:r!==void 0?r:void 0}function OL(t,e,r,i,a){return bd(typeof r===a?i[r]:void 0,t.default,e.default)}function FL(t,e,r){if(Dr(r)!=="number")return bd(t.default,e.default);const i=t.stops.length;if(i===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[i-1][0])return t.stops[i-1][1];const a=Wp(t.stops.map(s=>s[0]),r);return t.stops[a][1]}function tS(t,e,r){const i=t.base!==void 0?t.base:1;if(Dr(r)!=="number")return bd(t.default,e.default);const a=t.stops.length;if(a===1||r<=t.stops[0][0])return t.stops[0][1];if(r>=t.stops[a-1][0])return t.stops[a-1][1];const s=Wp(t.stops.map(m=>m[0]),r),c=function(m,_,y,v){const b=v-y,S=m-y;return b===0?0:_===1?S/b:(Math.pow(_,S)-1)/(Math.pow(_,b)-1)}(r,i,t.stops[s][0],t.stops[s+1][0]),u=t.stops[s][1],d=t.stops[s+1][1];let p=Hp[e.type]||LL;if(t.colorSpace&&t.colorSpace!=="rgb"){const m=$E[t.colorSpace];p=(_,y)=>m.reverse(m.interpolate(m.forward(_),m.forward(y),c))}return typeof u.evaluate=="function"?{evaluate(...m){const _=u.evaluate.apply(void 0,m),y=d.evaluate.apply(void 0,m);if(_!==void 0&&y!==void 0)return p(_,y,c)}}:p(u,d,c)}function BL(t,e,r){return e.type==="color"?r=Zt.parse(r):e.type==="formatted"?r=Vi.fromString(r.toString()):e.type==="resolvedImage"?r=Po.fromString(r.toString()):Dr(r)===e.type||e.type==="enum"&&e.values[r]||(r=void 0),bd(r,t.default,e.default)}class d1{constructor(e,r,i){this.expression=e,this._warningHistory={},this._evaluator=new _E(i),this._defaultValue=r?function(a){return a.type==="color"&&(Yp(a.default)||Array.isArray(a.default))?new Zt(0,0,0,0):a.type==="color"?Zt.parse(a.default)||null:a.default===void 0?null:a.default}(r):null,this._enumValues=r&&r.type==="enum"?r.values:null}evaluateWithoutErrorHandling(e,r,i,a,s,c,u,d){return this._evaluator.globals=e,this._evaluator.feature=r,this._evaluator.featureState=i,this._evaluator.canonical=a||null,this._evaluator.availableImages=s||null,this._evaluator.formattedSection=c,this._evaluator.featureTileCoord=u||null,this._evaluator.featureDistanceData=d||null,this.expression.evaluate(this._evaluator)}evaluate(e,r,i,a,s,c,u,d){this._evaluator.globals=e,this._evaluator.feature=r||null,this._evaluator.featureState=i||null,this._evaluator.canonical=a||null,this._evaluator.availableImages=s||null,this._evaluator.formattedSection=c||null,this._evaluator.featureTileCoord=u||null,this._evaluator.featureDistanceData=d||null;try{const p=this.expression.evaluate(this._evaluator);if(p==null||typeof p=="number"&&p!=p)return this._defaultValue;if(this._enumValues&&!(p in this._enumValues))throw new Jn(`Expected value to be one of ${Object.keys(this._enumValues).map(m=>JSON.stringify(m)).join(", ")}, but found ${JSON.stringify(p)} instead.`);return p}catch(p){return this._warningHistory[p.message]||(this._warningHistory[p.message]=!0,typeof console<"u"&&console.warn(p.message)),this._defaultValue}}}function Kp(t){return Array.isArray(t)&&t.length>0&&typeof t[0]=="string"&&t[0]in xd}function Ls(t,e,r){const i=new DE(xd,[],e?function(s){const c={color:Io,string:gr,number:lt,enum:gr,boolean:Mr,formatted:od,resolvedImage:ad};return s.type==="array"?ji(c[s.value]||vr,s.length):c[s.type]}(e):void 0,void 0,void 0,r),a=i.parse(t,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?KE(new d1(a,e,r)):Jl(i.errors)}class f1{constructor(e,r,i){this.kind=e,this._styleExpression=r,this.isLightConstant=i,this.isStateDependent=e!=="constant"&&!Gp(r.expression),this.isConfigDependent=!Uy(r.expression)}evaluateWithoutErrorHandling(e,r,i,a,s,c){return this._styleExpression.evaluateWithoutErrorHandling(e,r,i,a,s,c)}evaluate(e,r,i,a,s,c){return this._styleExpression.evaluate(e,r,i,a,s,c)}}class Jp{constructor(e,r,i,a,s){this.kind=e,this.zoomStops=i,this._styleExpression=r,this.isStateDependent=e!=="camera"&&!Gp(r.expression),this.isLightConstant=s,this.isConfigDependent=!Uy(r.expression),this.interpolationType=a}evaluateWithoutErrorHandling(e,r,i,a,s,c){return this._styleExpression.evaluateWithoutErrorHandling(e,r,i,a,s,c)}evaluate(e,r,i,a,s,c){return this._styleExpression.evaluate(e,r,i,a,s,c)}interpolationFactor(e,r,i){return this.interpolationType?Ma.interpolationFactor(this.interpolationType,e,r,i):0}}function p1(t,e,r){if((t=Ls(t,e,r)).result==="error")return t;const i=t.value.expression,a=_d(i);if(!a&&!Ql(e))return Jl([new Sa("","data expressions not supported")]);const s=Yl(i,["zoom","pitch","distance-from-center"]);if(!s&&!u1(e))return Jl([new Sa("","zoom expressions not supported")]);const c=Yl(i,["measure-light"]);if(!c&&!QE(e))return Jl([new Sa("","measure-light expression not supported")]);const u=e.expression&&e.expression.relaxZoomRestriction,d=em(i);return d||s||u?d instanceof Sa?Jl([d]):d instanceof Ma&&!h1(e)?Jl([new Sa("",'"interpolate" expressions cannot be used with this property')]):KE(d?new Jp(a?"camera":"composite",t.value,d.labels,d instanceof Ma?d.interpolation:void 0,c):new f1(a?"constant":"source",t.value,c)):Jl([new Sa("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class Qp{constructor(e,r){this._parameters=e,this._specification=r,en(this,eS(this._parameters,this._specification))}static deserialize(e){return new Qp(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function em(t){let e=null;if(t instanceof UE)e=em(t.result);else if(t instanceof VE){for(const r of t.args)if(e=em(r),e)break}else(t instanceof Zy||t instanceof Ma)&&t.input instanceof Ta&&t.input.name==="zoom"&&(e=t);return e instanceof Sa||t.eachChild(r=>{const i=em(r);i instanceof Sa?e=i:e&&i&&e!==i&&(e=new Sa("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function ko(t){const e=t.key,r=t.value,i=t.valueSpec||{},a=t.objectElementValidators||{},s=t.style,c=t.styleSpec;let u=[];const d=Dr(r);if(d!=="object")return[new st(e,r,`object expected, ${d} found`)];for(const p in r){const m=p.split(".")[0];let _;a[m]?_=a[m]:i[m]?_=ii:a["*"]?_=a["*"]:i["*"]&&(_=ii),_?u=u.concat(_({key:(e&&`${e}.`)+p,value:r[p],valueSpec:i[m]||i["*"],style:s,styleSpec:c,object:r,objectKey:p},r)):u.push(new st(e,r[p],`unknown property "${p}"`))}for(const p in i)a[p]||i[p].required&&i[p].default===void 0&&r[p]===void 0&&u.push(new st(e,r,`missing required property "${p}"`));return u}function rS(t){const e=t.value,r=t.valueSpec,i=t.style,a=t.styleSpec,s=t.key,c=t.arrayElementValidator||ii;if(Dr(e)!=="array")return[new st(s,e,`array expected, ${Dr(e)} found`)];if(r.length&&e.length!==r.length)return[new st(s,e,`array length ${r.length} expected, length ${e.length} found`)];if(r["min-length"]&&e.length<r["min-length"])return[new st(s,e,`array length at least ${r["min-length"]} expected, length ${e.length} found`)];let u={type:r.value,values:r.values,minimum:r.minimum,maximum:r.maximum,function:void 0};a.$version<7&&(u.function=r.function),Dr(r.value)==="object"&&(u=r.value);let d=[];for(let p=0;p<e.length;p++)d=d.concat(c({array:e,arrayIndex:p,value:e[p],valueSpec:u,style:i,styleSpec:a,key:`${s}[${p}]`},!0));return d}function nS(t){const e=t.key,r=t.value,i=t.valueSpec;let a=Dr(r);if(a==="number"&&r!=r&&(a="NaN"),a!=="number")return[new st(e,r,`number expected, ${a} found`)];if("minimum"in i){let s=i.minimum;if(Dr(i.minimum)==="array"&&(s=i.minimum[t.arrayIndex]),r<s)return[new st(e,r,`${r} is less than the minimum value ${s}`)]}if("maximum"in i){let s=i.maximum;if(Dr(i.maximum)==="array"&&(s=i.maximum[t.arrayIndex]),r>s)return[new st(e,r,`${r} is greater than the maximum value ${s}`)]}return[]}function iS(t){const e=t.valueSpec,r=kn(t.value.type);let i,a,s,c={};const u=r!=="categorical"&&t.value.property===void 0,d=!u,p=Dr(t.value.stops)==="array"&&Dr(t.value.stops[0])==="array"&&Dr(t.value.stops[0][0])==="object",m=ko({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(v){if(r==="identity")return[new st(v.key,v.value,'identity function may not have a "stops" property')];let b=[];const S=v.value;return b=b.concat(rS({key:v.key,value:S,valueSpec:v.valueSpec,style:v.style,styleSpec:v.styleSpec,arrayElementValidator:_})),Dr(S)==="array"&&S.length===0&&b.push(new st(v.key,S,"array must have at least one stop")),b},default:function(v){return ii({key:v.key,value:v.value,valueSpec:e,style:v.style,styleSpec:v.styleSpec})}}});return r==="identity"&&u&&m.push(new st(t.key,t.value,'missing required property "property"')),r==="identity"||t.value.stops||m.push(new st(t.key,t.value,'missing required property "stops"')),r==="exponential"&&t.valueSpec.expression&&!h1(t.valueSpec)&&m.push(new st(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(d&&!Ql(t.valueSpec)?m.push(new st(t.key,t.value,"property functions not supported")):u&&!u1(t.valueSpec)&&m.push(new st(t.key,t.value,"zoom functions not supported"))),r!=="categorical"&&!p||t.value.property!==void 0||m.push(new st(t.key,t.value,'"property" property is required')),m;function _(v){let b=[];const S=v.value,T=v.key;if(Dr(S)!=="array")return[new st(T,S,`array expected, ${Dr(S)} found`)];if(S.length!==2)return[new st(T,S,`array length 2 expected, length ${S.length} found`)];if(p){if(Dr(S[0])!=="object")return[new st(T,S,`object expected, ${Dr(S[0])} found`)];if(S[0].zoom===void 0)return[new st(T,S,"object stop key must have zoom")];if(S[0].value===void 0)return[new st(T,S,"object stop key must have value")];const M=kn(S[0].zoom);if(typeof M!="number")return[new st(T,S[0].zoom,"stop zoom values must be numbers")];if(s&&s>M)return[new st(T,S[0].zoom,"stop zoom values must appear in ascending order")];M!==s&&(s=M,a=void 0,c={}),b=b.concat(ko({key:`${T}[0]`,value:S[0],valueSpec:{zoom:{}},style:v.style,styleSpec:v.styleSpec,objectElementValidators:{zoom:nS,value:y}}))}else b=b.concat(y({key:`${T}[0]`,value:S[0],valueSpec:{},style:v.style,styleSpec:v.styleSpec},S));return Kp(Ao(S[1]))?b.concat([new st(`${T}[1]`,S[1],"expressions are not allowed in function stops.")]):b.concat(ii({key:`${T}[1]`,value:S[1],valueSpec:e,style:v.style,styleSpec:v.styleSpec}))}function y(v,b){const S=Dr(v.value),T=kn(v.value),M=v.value!==null?v.value:b;if(i){if(S!==i)return[new st(v.key,M,`${S} stop domain type must match previous stop domain type ${i}`)]}else i=S;if(S!=="number"&&S!=="string"&&S!=="boolean"&&typeof T!="number"&&typeof T!="string"&&typeof T!="boolean")return[new st(v.key,M,"stop domain value must be a number, string, or boolean")];if(S!=="number"&&r!=="categorical"){let C=`number expected, ${S} found`;return Ql(e)&&r===void 0&&(C+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new st(v.key,M,C)]}return r!=="categorical"||S!=="number"||typeof T=="number"&&isFinite(T)&&Math.floor(T)===T?r!=="categorical"&&S==="number"&&typeof T=="number"&&typeof a=="number"&&a!==void 0&&T<a?[new st(v.key,M,"stop domain values must appear in ascending order")]:(a=T,r==="categorical"&&T in c?[new st(v.key,M,"stop domain values must be unique")]:(c[T]=!0,[])):[new st(v.key,M,`integer expected, found ${String(T)}`)]}}function ec(t){const e=(t.expressionContext==="property"?p1:Ls)(Ao(t.value),t.valueSpec);if(e.result==="error")return e.value.map(i=>new st(`${t.key}${i.key}`,t.value,i.message));const r=e.value.expression||e.value._styleExpression.expression;if(t.expressionContext==="property"&&t.propertyKey==="text-font"&&!r.outputDefined())return[new st(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if(t.expressionContext==="property"&&t.propertyType==="layout"&&!Gp(r))return[new st(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if(t.expressionContext==="filter")return oS(r,t);if(t.expressionContext&&t.expressionContext.indexOf("cluster")===0){if(!Yl(r,["zoom","feature-state"]))return[new st(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(t.expressionContext==="cluster-initial"&&!_d(r))return[new st(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function oS(t,e){const r=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const a of e.valueSpec.expression.parameters)r.delete(a);if(r.size===0)return[];const i=[];return t instanceof Ta&&r.has(t.name)?[new st(e.key,e.value,`["${t.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(t.eachChild(a=>{i.push(...oS(a,e))}),i)}function tm(t){const e=t.key,r=t.value,i=t.valueSpec,a=[];return Array.isArray(i.values)?i.values.indexOf(kn(r))===-1&&a.push(new st(e,r,`expected one of [${i.values.join(", ")}], ${JSON.stringify(r)} found`)):Object.keys(i.values).indexOf(kn(r))===-1&&a.push(new st(e,r,`expected one of [${Object.keys(i.values).join(", ")}], ${JSON.stringify(r)} found`)),a}function m1(t){if(t===!0||t===!1)return!0;if(!Array.isArray(t)||t.length===0)return!1;switch(t[0]){case"has":return t.length>=2&&t[1]!=="$id"&&t[1]!=="$type";case"in":return t.length>=3&&(typeof t[1]!="string"||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return t.length!==3||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!m1(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}function rm(t,e="fill"){if(t==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};m1(t)||(t=nm(t));const r=t;let i=!0;try{i=function(p){if(!au(p))return p;let m=Ao(p);return sS(m),m=aS(m),m}(r)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(r,null,2)}
        `)}const a=pe[`filter_${e}`],s=Ls(i,a);let c=null;if(s.result==="error")throw new Error(s.value.map(p=>`${p.key}: ${p.message}`).join(", "));c=(p,m,_)=>s.value.evaluate(p,m,{},_);let u=null,d=null;if(i!==r){const p=Ls(r,a);if(p.result==="error")throw new Error(p.value.map(m=>`${m.key}: ${m.message}`).join(", "));u=(m,_,y,v,b)=>p.value.evaluate(m,_,{},y,void 0,void 0,v,b),d=!_d(p.value.expression)}return{filter:c,dynamicFilter:u||void 0,needGeometry:lS(i),needFeature:!!d}}function aS(t){if(!Array.isArray(t))return t;const e=function(r){if(NL.has(r[0])){for(let i=1;i<r.length;i++)if(au(r[i]))return!0}return r}(t);return e===!0?e:e.map(r=>aS(r))}function sS(t){let e=!1;const r=[];if(t[0]==="case"){for(let i=1;i<t.length-1;i+=2)e=e||au(t[i]),r.push(t[i+1]);r.push(t[t.length-1])}else if(t[0]==="match"){e=e||au(t[1]);for(let i=2;i<t.length-1;i+=2)r.push(t[i+1]);r.push(t[t.length-1])}else if(t[0]==="step"){e=e||au(t[1]);for(let i=1;i<t.length-1;i+=2)r.push(t[i+1])}e&&(t.length=0,t.push("any",...r));for(let i=1;i<t.length;i++)sS(t[i])}function au(t){if(!Array.isArray(t))return!1;if((e=t[0])==="pitch"||e==="distance-from-center")return!0;var e;for(let r=1;r<t.length;r++)if(au(t[r]))return!0;return!1}const NL=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function jL(t,e){return t<e?-1:t>e?1:0}function lS(t){if(!Array.isArray(t))return!1;if(t[0]==="within"||t[0]==="distance")return!0;for(let e=1;e<t.length;e++)if(lS(t[e]))return!0;return!1}function nm(t){if(!t)return!0;const e=t[0];return t.length<=1?e!=="any":e==="=="?g1(t[1],t[2],"=="):e==="!="?im(g1(t[1],t[2],"==")):e==="<"||e===">"||e==="<="||e===">="?g1(t[1],t[2],e):e==="any"?(r=t.slice(1),["any"].concat(r.map(nm))):e==="all"?["all"].concat(t.slice(1).map(nm)):e==="none"?["all"].concat(t.slice(1).map(nm).map(im)):e==="in"?cS(t[1],t.slice(2)):e==="!in"?im(cS(t[1],t.slice(2))):e==="has"?uS(t[1]):e!=="!has"||im(uS(t[1]));var r}function g1(t,e,r){switch(t){case"$type":return[`filter-type-${r}`,e];case"$id":return[`filter-id-${r}`,e];default:return[`filter-${r}`,t,e]}}function cS(t,e){if(e.length===0)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(r=>typeof r!=typeof e[0])?["filter-in-large",t,["literal",e.sort(jL)]]:["filter-in-small",t,["literal",e]]}}function uS(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function im(t){return["!",t]}function _1(t){return m1(Ao(t.value))?ec(en({},t,{expressionContext:"filter",valueSpec:t.styleSpec[`filter_${t.layerType||"fill"}`]})):hS(t)}function hS(t){const e=t.value,r=t.key;if(Dr(e)!=="array")return[new st(r,e,`array expected, ${Dr(e)} found`)];const i=t.styleSpec;let a,s=[];if(e.length<1)return[new st(r,e,"filter array must have at least 1 element")];switch(s=s.concat(tm({key:`${r}[0]`,value:e[0],valueSpec:i.filter_operator,style:t.style,styleSpec:t.styleSpec})),kn(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&kn(e[1])==="$type"&&s.push(new st(r,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&s.push(new st(r,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(a=Dr(e[1]),a!=="string"&&s.push(new st(`${r}[1]`,e[1],`string expected, ${a} found`)));for(let c=2;c<e.length;c++)a=Dr(e[c]),kn(e[1])==="$type"?s=s.concat(tm({key:`${r}[${c}]`,value:e[c],valueSpec:i.geometry_type,style:t.style,styleSpec:t.styleSpec})):a!=="string"&&a!=="number"&&a!=="boolean"&&s.push(new st(`${r}[${c}]`,e[c],`string, number, or boolean expected, ${a} found`));break;case"any":case"all":case"none":for(let c=1;c<e.length;c++)s=s.concat(hS({key:`${r}[${c}]`,value:e[c],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":a=Dr(e[1]),e.length!==2?s.push(new st(r,e,`filter array for "${e[0]}" operator must have 2 elements`)):a!=="string"&&s.push(new st(`${r}[1]`,e[1],`string expected, ${a} found`))}return s}function dS(t,e){const r=t.key,i=t.style,a=t.layer,s=t.styleSpec,c=t.value,u=t.objectKey,d=s[`${e}_${t.layerType}`];if(!d)return[];const p=u.match(/^(.*)-transition$/);if(e==="paint"&&p&&d[p[1]]&&d[p[1]].transition)return ii({key:r,value:c,valueSpec:s.transition,style:i,styleSpec:s});const m=t.valueSpec||d[u];if(!m)return[new st(r,c,`unknown property "${u}"`)];let _;if(Dr(c)==="string"&&Ql(m)&&!m.tokens&&(_=/^{([^}]+)}$/.exec(c))){const v=`\`{ "type": "identity", "property": ${_?JSON.stringify(_[1]):'"_"'} }\``;return[new st(r,c,`"${u}" does not support interpolation syntax
Use an identity property function instead: ${v}.`)]}const y=[];if(t.layerType==="symbol")u==="text-field"&&i&&!i.glyphs&&y.push(new st(r,c,'use of "text-field" requires a style "glyphs" property')),u==="text-font"&&Yp(Ao(c))&&kn(c.type)==="identity"&&y.push(new st(r,c,'"text-font" does not support identity functions'));else if(t.layerType==="model"&&e==="paint"&&a&&a.layout&&a.layout.hasOwnProperty("model-id")&&Ql(m)&&(QE(m)||u1(m))){const v=p1(Ao(c),m),b=v.value.expression||v.value._styleExpression.expression;!b||Yl(b,["zoom"])&&Yl(b,["measure-light"])||y.push(new st(r,c,`${u} does not support zoom or measure-light expressions when the model layer source is vector tile or GeoJSON.`))}return y.concat(ii({key:t.key,value:c,valueSpec:m,style:i,styleSpec:s,expressionContext:"property",propertyType:e,propertyKey:u}))}function fS(t){return dS(t,"paint")}function pS(t){return dS(t,"layout")}function mS(t){let e=[];const r=t.value,i=t.key,a=t.style,s=t.styleSpec;r.type||r.ref||e.push(new st(i,r,'either "type" or "ref" is required'));let c=kn(r.type);const u=kn(r.ref);if(r.id){const d=kn(r.id);for(let p=0;p<t.arrayIndex;p++){const m=a.layers[p];kn(m.id)===d&&e.push(new st(i,r.id,`duplicate layer id "${r.id}", previously used at line ${m.id.__line__}`))}}if("ref"in r){let d;["type","source","source-layer","filter","layout"].forEach(p=>{p in r&&e.push(new st(i,r[p],`"${p}" is prohibited for ref layers`))}),a.layers.forEach(p=>{kn(p.id)===u&&(d=p)}),d?d.ref?e.push(new st(i,r.ref,"ref cannot reference another ref layer")):c=kn(d.type):typeof u=="string"&&e.push(new st(i,r.ref,`ref layer "${u}" not found`))}else if(c!=="background"&&c!=="sky"&&c!=="slot")if(r.source){const d=a.sources&&a.sources[r.source],p=d&&kn(d.type);d?p==="vector"&&c==="raster"?e.push(new st(i,r.source,`layer "${r.id}" requires a raster source`)):p==="raster"&&c!=="raster"?e.push(new st(i,r.source,`layer "${r.id}" requires a vector source`)):p!=="vector"||r["source-layer"]?p==="raster-dem"&&c!=="hillshade"?e.push(new st(i,r.source,"raster-dem source can only be used with layer type 'hillshade'.")):c!=="line"||!r.paint||!r.paint["line-gradient"]&&!r.paint["line-trim-offset"]||p==="geojson"&&d.lineMetrics||e.push(new st(i,r,`layer "${r.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new st(i,r,`layer "${r.id}" must specify a "source-layer"`)):e.push(new st(i,r.source,`source "${r.source}" not found`))}else e.push(new st(i,r,'missing required property "source"'));return e=e.concat(ko({key:i,value:r,valueSpec:s.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ii({key:`${i}.type`,value:r.type,valueSpec:s.layer.type,style:t.style,styleSpec:t.styleSpec,object:r,objectKey:"type"}),filter:d=>_1(en({layerType:c},d)),layout:d=>ko({layer:r,key:d.key,value:d.value,valueSpec:{},style:d.style,styleSpec:d.styleSpec,objectElementValidators:{"*":p=>pS(en({layerType:c},p))}}),paint:d=>ko({layer:r,key:d.key,value:d.value,valueSpec:{},style:d.style,styleSpec:d.styleSpec,objectElementValidators:{"*":p=>fS(en({layerType:c,layer:r},p))}})}})),e}function su(t){const e=t.value,r=t.key,i=Dr(e);return i!=="string"?[new st(r,e,`string expected, ${i} found`)]:[]}const gS={promoteId:function({key:t,value:e}){if(Dr(e)==="string")return su({key:t,value:e});{const r=[];for(const i in e)r.push(...su({key:`${t}.${i}`,value:e[i]}));return r}}};function _S(t){const e=t.value,r=t.key,i=t.styleSpec,a=t.style;if(!e.type)return[new st(r,e,'"type" is required')];const s=kn(e.type);let c;switch(s){case"vector":case"raster":case"raster-dem":return c=ko({key:r,value:e,valueSpec:i[`source_${s.replace("-","_")}`],style:t.style,styleSpec:i,objectElementValidators:gS}),c;case"geojson":if(c=ko({key:r,value:e,valueSpec:i.source_geojson,style:a,styleSpec:i,objectElementValidators:gS}),e.cluster)for(const u in e.clusterProperties){const[d,p]=e.clusterProperties[u],m=typeof d=="string"?[d,["accumulated"],["get",u]]:d;c.push(...ec({key:`${r}.${u}.map`,value:p,expressionContext:"cluster-map"})),c.push(...ec({key:`${r}.${u}.reduce`,value:m,expressionContext:"cluster-reduce"}))}return c;case"video":return ko({key:r,value:e,valueSpec:i.source_video,style:a,styleSpec:i});case"image":return ko({key:r,value:e,valueSpec:i.source_image,style:a,styleSpec:i});case"canvas":return[new st(r,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return tm({key:`${r}.type`,value:e.type,valueSpec:{values:$L(i)},style:a,styleSpec:i})}}function $L(t){return t.source.reduce((e,r)=>{const i=t[r];return i.type.type==="enum"&&(e=e.concat(Object.keys(i.type.values))),e},[])}function yS(t){const e=t.value;let r=[];if(!e)return r;const i=Dr(e);return i!=="string"?(r=r.concat([new st(t.key,e,`string expected, "${i}" found`)]),r):(function(a){const s=a.indexOf("://")===-1;try{return new URL(a,s?"http://example.com":void 0),!0}catch{return!1}}(e)||(r=r.concat([new st(t.key,e,`invalid url "${e}"`)])),r)}function vS(t){const e=t.value,r=t.styleSpec,i=r.light,a=t.style;let s=[];const c=Dr(e);if(e===void 0)return s;if(c!=="object")return s=s.concat([new st("light",e,`object expected, ${c} found`)]),s;for(const u in e){const d=u.match(/^(.*)-transition$/);s=s.concat(d&&i[d[1]]&&i[d[1]].transition?ii({key:u,value:e[u],valueSpec:r.transition,style:a,styleSpec:r}):i[u]?ii({key:u,value:e[u],valueSpec:i[u],style:a,styleSpec:r}):[new st(u,e[u],`unknown property "${u}"`)])}return s}function xS(t){const e=t.value;let r=[];if(!e)return r;const i=Dr(e);if(i!=="object")return r=r.concat([new st("light-3d",e,`object expected, ${i} found`)]),r;const a=t.styleSpec,s=a["light-3d"],c=t.style;for(const p of["type","id"])if(!(p in e))return r=r.concat([new st("light-3d",e,`missing property ${p} on light`)]),r;const u=`properties_light_${e.type}`;if(!(u in a))return r=r.concat([new st("light-3d",e,`Invalid light type ${e.type}`)]),r;const d=a[u];for(const p in e)if(p==="properties"){const m=e[p],_=Dr(m);if(_!=="object")return r=r.concat([new st("properties",m,`object expected, ${_} found`)]),r;for(const y in m)r=r.concat(ii({key:y,value:m[y],valueSpec:d[y],style:c,styleSpec:a}))}else{const m=p.match(/^(.*)-transition$/);r=r.concat(m&&s[m[1]]&&s[m[1]].transition?ii({key:p,value:e[p],valueSpec:a.transition,style:c,styleSpec:a}):s[p]?ii({key:p,value:e[p],valueSpec:s[p],style:c,styleSpec:a}):[new st(p,e[p],`unknown property "${p}"`)])}return r}function bS(t){const e=t.value,r=t.key,i=t.style,a=t.styleSpec,s=a.terrain;let c=[];const u=Dr(e);if(e===void 0)return c;if(u!=="object")return c=c.concat([new st("terrain",e,`object expected, ${u} found`)]),c;for(const d in e){const p=d.match(/^(.*)-transition$/);c=c.concat(p&&s[p[1]]&&s[p[1]].transition?ii({key:d,value:e[d],valueSpec:a.transition,style:i,styleSpec:a}):s[d]?ii({key:d,value:e[d],valueSpec:s[d],style:i,styleSpec:a}):[new st(d,e[d],`unknown property "${d}"`)])}if(e.source){const d=i.sources&&i.sources[e.source],p=d&&kn(d.type);d?p!=="raster-dem"&&c.push(new st(r,e.source,`terrain cannot be used with a source of type ${String(p)}, it only be used with a "raster-dem" source type`)):c.push(new st(r,e.source,`source "${e.source}" not found`))}else c.push(new st(r,e,'terrain is missing required property "source"'));return c}function wS(t){const e=t.value,r=t.style,i=t.styleSpec,a=i.fog;let s=[];const c=Dr(e);if(e===void 0)return s;if(c!=="object")return s=s.concat([new st("fog",e,`object expected, ${c} found`)]),s;for(const u in e){const d=u.match(/^(.*)-transition$/);s=s.concat(d&&a[d[1]]&&a[d[1]].transition?ii({key:u,value:e[u],valueSpec:i.transition,style:r,styleSpec:i}):a[u]?ii({key:u,value:e[u],valueSpec:a[u],style:r,styleSpec:i}):[new st(u,e[u],`unknown property "${u}"`)])}return s}const ES={"*":()=>[],array:rS,boolean:function(t){const e=t.value,r=t.key,i=Dr(e);return i!=="boolean"?[new st(r,e,`boolean expected, ${i} found`)]:[]},number:nS,color:function(t){const e=t.key,r=t.value,i=Dr(r);return i!=="string"?[new st(e,r,`color expected, ${i} found`)]:wy(r)===null?[new st(e,r,`color expected, "${r}" found`)]:[]},enum:tm,filter:_1,function:iS,layer:mS,object:ko,source:_S,model:yS,light:vS,"light-3d":xS,terrain:bS,fog:wS,string:su,formatted:function(t){return su(t).length===0?[]:ec(t)},resolvedImage:function(t){return su(t).length===0?[]:ec(t)},projection:function(t){const e=t.value,r=t.styleSpec,i=r.projection,a=t.style;let s=[];const c=Dr(e);if(c==="object")for(const u in e)s=s.concat(ii({key:u,value:e[u],valueSpec:i[u],style:a,styleSpec:r}));else c!=="string"&&(s=s.concat([new st("projection",e,`object or string expected, ${c} found`)]));return s},import:function(t){const{value:e,styleSpec:r}=t,{data:i,...a}=e;Object.defineProperty(a,"__line__",{value:e.__line__,enumerable:!1});let s=ko(en({},t,{value:a,valueSpec:r.import}));return i&&(s=s.concat(SS(i,r,{key:`${t.key}.data`}))),s}};function ii(t,e=!1){const r=t.value,i=t.valueSpec,a=t.styleSpec;if(i.expression&&Yp(kn(r)))return iS(t);if(i.expression&&Kp(Ao(r)))return ec(t);if(i.type&&ES[i.type]){const s=ES[i.type](t);return e===!0&&s.length>0&&Dr(t.value)==="array"?ec(t):s}return ko(en({},t,{valueSpec:i.type?a[i.type]:i}))}function VL(t){const e=t.value,r=t.key,i=su(t);return i.length||(e.indexOf("{fontstack}")===-1&&i.push(new st(r,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&i.push(new st(r,e,'"glyphs" url must include a "{range}" token'))),i}function SS(t,e=pe,r={}){return ii({key:r.key||"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:VL,"*":()=>[]}})}function lu(t,e=pe){return Yo(SS(t,e))}const UL=t=>Yo(_S(t)),GL=t=>Yo(vS(t)),WL=t=>Yo(xS(t)),HL=t=>Yo(bS(t)),qL=t=>Yo(wS(t)),ZL=t=>Yo(mS(t)),y1=t=>Yo(_1(t)),XL=t=>Yo(fS(t)),YL=t=>Yo(pS(t)),KL=t=>Yo(yS(t));function Yo(t){return t.slice().sort((e,r)=>e.line&&r.line?e.line-r.line:0)}function om(t,e){let r=!1;if(e&&e.length)for(const i of e)t.fire(new rt(new Error(i.message))),r=!0;return r}var JL=Ca,Os=3;function Ca(t,e,r){var i=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var a=new Int32Array(this.arrayBuffer);t=a[0],this.d=(e=a[1])+2*(r=a[2]);for(var s=0;s<this.d*this.d;s++){var c=a[Os+s],u=a[Os+s+1];i.push(c===u?null:a.subarray(c,u))}var d=a[Os+i.length+1];this.keys=a.subarray(a[Os+i.length],d),this.bboxes=a.subarray(d),this.insert=this._insertReadonly}else{this.d=e+2*r;for(var p=0;p<this.d*this.d;p++)i.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=r,this.scale=e/t,this.uid=0;var m=r/e*t;this.min=-m,this.max=t+m}Ca.prototype.insert=function(t,e,r,i,a){this._forEachCell(e,r,i,a,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(a)},Ca.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ca.prototype._insertCell=function(t,e,r,i,a,s){this.cells[a].push(s)},Ca.prototype.query=function(t,e,r,i,a){var s=this.min,c=this.max;if(t<=s&&e<=s&&c<=r&&c<=i&&!a)return Array.prototype.slice.call(this.keys);var u=[];return this._forEachCell(t,e,r,i,this._queryCell,u,{},a),u},Ca.prototype._queryCell=function(t,e,r,i,a,s,c,u){var d=this.cells[a];if(d!==null)for(var p=this.keys,m=this.bboxes,_=0;_<d.length;_++){var y=d[_];if(c[y]===void 0){var v=4*y;(u?u(m[v+0],m[v+1],m[v+2],m[v+3]):t<=m[v+2]&&e<=m[v+3]&&r>=m[v+0]&&i>=m[v+1])?(c[y]=!0,s.push(p[y])):c[y]=!1}}},Ca.prototype._forEachCell=function(t,e,r,i,a,s,c,u){for(var d=this._convertToCellCoord(t),p=this._convertToCellCoord(e),m=this._convertToCellCoord(r),_=this._convertToCellCoord(i),y=d;y<=m;y++)for(var v=p;v<=_;v++){var b=this.d*v+y;if((!u||u(this._convertFromCellCoord(y),this._convertFromCellCoord(v),this._convertFromCellCoord(y+1),this._convertFromCellCoord(v+1)))&&a.call(this,t,e,r,i,b,s,c,u))return}},Ca.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Ca.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Ca.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=Os+this.cells.length+1+1,r=0,i=0;i<this.cells.length;i++)r+=this.cells[i].length;var a=new Int32Array(e+r+this.keys.length+this.bboxes.length);a[0]=this.extent,a[1]=this.n,a[2]=this.padding;for(var s=e,c=0;c<t.length;c++){var u=t[c];a[Os+c]=s,a.set(u,s),s+=u.length}return a[Os+t.length]=s,a.set(this.keys,s),a[Os+t.length+1]=s+=this.keys.length,a.set(this.bboxes,s),s+=this.bboxes.length,a.buffer};var cu=V(JL);const am={};function ht(t,e,r={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),am[e]={klass:t,omit:r.omit||[]}}ht(Object,"Object"),cu.serialize=function(t,e){const r=t.toArrayBuffer();return e&&e.push(r),{buffer:r}},cu.deserialize=function(t){return new cu(t.buffer)},Object.defineProperty(cu,"name",{value:"Grid"}),ht(cu,"Grid"),ht(Zt,"Color"),ht(Error,"Error"),ht(Me,"AJAXError"),ht(Po,"ResolvedImage"),ht(Qp,"StylePropertyFunction"),ht(d1,"StyleExpression",{omit:["_evaluator"]}),ht(Jp,"ZoomDependentExpression"),ht(f1,"ZoomConstantExpression"),ht(Ta,"CompoundExpression",{omit:["_evaluate"]});for(const t in xd)am[xd[t]._classRegistryKey]||ht(xd[t],`Expression${t}`);function TS(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&t.constructor.name==="ArrayBuffer")}function MS(t){return w.ImageBitmap&&t instanceof w.ImageBitmap}function uu(t,e){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(TS(t)||MS(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const r=t;return e&&e.push(r.buffer),r}if(t instanceof w.ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const r=[];for(const i of t)r.push(uu(i,e));return r}if(t instanceof Map){const r={$name:"Map"};for(const[i,a]of t.entries())r[i]=uu(a);return r}if(typeof t=="object"){const r=t.constructor,i=r._classRegistryKey;if(!i)throw new Error(`can't serialize object of unregistered class ${i}`);const a=r.serialize?r.serialize(t,e):{};if(!r.serialize){for(const s in t)t.hasOwnProperty(s)&&(am[i].omit.indexOf(s)>=0||(a[s]=uu(t[s],e)));t instanceof Error&&(a.message=t.message)}if(a.$name)throw new Error("$name property is reserved for worker serialization logic.");return i!=="Object"&&(a.$name=i),a}throw new Error("can't serialize object of type "+typeof t)}function hu(t){if(t==null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||TS(t)||MS(t)||ArrayBuffer.isView(t)||t instanceof w.ImageData)return t;if(Array.isArray(t))return t.map(hu);if(typeof t=="object"){const e=t.$name||"Object";if(e==="Map"){const a=new Map;for(const s of Object.keys(t))s!=="$name"&&a.set(s,hu(t[s]));return a}const{klass:r}=am[e];if(!r)throw new Error(`can't deserialize unregistered class ${e}`);if(r.deserialize)return r.deserialize(t);const i=Object.create(r.prototype);for(const a of Object.keys(t))a!=="$name"&&(i[a]=hu(t[a]));return i}throw new Error("can't deserialize object of type "+typeof t)}const vt={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519,"CJK Unified Ideographs Extension B":t=>t>=131072&&t<=173791};function v1(t){for(const e of t)if(x1(e.charCodeAt(0)))return!0;return!1}function QL(t){for(const e of t)if(!eO(e.charCodeAt(0)))return!1;return!0}function eO(t){return!(vt.Arabic(t)||vt["Arabic Supplement"](t)||vt["Arabic Extended-A"](t)||vt["Arabic Presentation Forms-A"](t)||vt["Arabic Presentation Forms-B"](t))}function x1(t){return!(t!==746&&t!==747&&(t<4352||!(vt["Bopomofo Extended"](t)||vt.Bopomofo(t)||vt["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||vt["CJK Compatibility Ideographs"](t)||vt["CJK Compatibility"](t)||vt["CJK Radicals Supplement"](t)||vt["CJK Strokes"](t)||!(!vt["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||t===12336)||vt["CJK Unified Ideographs Extension A"](t)||vt["CJK Unified Ideographs"](t)||vt["Enclosed CJK Letters and Months"](t)||vt["Hangul Compatibility Jamo"](t)||vt["Hangul Jamo Extended-A"](t)||vt["Hangul Jamo Extended-B"](t)||vt["Hangul Jamo"](t)||vt["Hangul Syllables"](t)||vt.Hiragana(t)||vt["Ideographic Description Characters"](t)||vt.Kanbun(t)||vt["Kangxi Radicals"](t)||vt["Katakana Phonetic Extensions"](t)||vt.Katakana(t)&&t!==12540||!(!vt["Halfwidth and Fullwidth Forms"](t)||t===65288||t===65289||t===65293||t>=65306&&t<=65310||t===65339||t===65341||t===65343||t>=65371&&t<=65503||t===65507||t>=65512&&t<=65519)||!(!vt["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||vt["Unified Canadian Aboriginal Syllabics"](t)||vt["Unified Canadian Aboriginal Syllabics Extended"](t)||vt["Vertical Forms"](t)||vt["Yijing Hexagram Symbols"](t)||vt["Yi Syllables"](t)||vt["Yi Radicals"](t))))}function CS(t){return!(x1(t)||function(e){return!!(vt["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||vt["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||vt["Letterlike Symbols"](e)||vt["Number Forms"](e)||vt["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||vt["Control Pictures"](e)&&e!==9251||vt["Optical Character Recognition"](e)||vt["Enclosed Alphanumerics"](e)||vt["Geometric Shapes"](e)||vt["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||vt["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||vt["CJK Symbols and Punctuation"](e)||vt.Katakana(e)||vt["Private Use Area"](e)||vt["CJK Compatibility Forms"](e)||vt["Small Form Variants"](e)||vt["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(t))}function AS(t){return t>=1424&&t<=2303||vt["Arabic Presentation Forms-A"](t)||vt["Arabic Presentation Forms-B"](t)}function tO(t,e){return!(!e&&AS(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||vt.Khmer(t))}function rO(t){for(const e of t)if(AS(e.charCodeAt(0)))return!0;return!1}const b1="deferred",w1="loading",E1="loaded";let S1=null,Ui="unavailable",Fs=null;const IS=function(t){t&&typeof t=="string"&&t.indexOf("NetworkError")>-1&&(Ui="error"),S1&&S1(t)};function T1(){M1.fire(new Ee("pluginStateChange",{pluginStatus:Ui,pluginURL:Fs}))}const M1=new dr,C1=function(){return Ui},PS=function(){if(Ui!==b1||!Fs)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ui=w1,T1(),Fs&&Ue({url:Fs},t=>{t?IS(t):(Ui=E1,T1())})},Ro={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ui===E1||Ro.applyArabicShaping!=null,isLoading:()=>Ui===w1,setState(t){Ui=t.pluginStatus,Fs=t.pluginURL},isParsed:()=>Ro.applyArabicShaping!=null&&Ro.processBidirectionalText!=null&&Ro.processStyledBidirectionalText!=null,getPluginURL:()=>Fs};class mn{constructor(e,r){this.zoom=e,r?(this.now=r.now,this.fadeDuration=r.fadeDuration,this.transition=r.transition,this.pitch=r.pitch,this.brightness=r.brightness):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(e){return function(r,i){for(const a of r)if(!tO(a.charCodeAt(0),i))return!1;return!0}(e,Ro.isLoaded())}}class sm{constructor(e,r,i){this.property=e,this.value=r,this.expression=function(a,s,c){if(Yp(a))return new Qp(a,s);if(Kp(a)||Array.isArray(a)&&a.length>0){const u=p1(a,s,c);if(u.result==="error")throw new Error(u.value.map(d=>`${d.key}: ${d.message}`).join(", "));return u.value}{let u=a;return typeof a=="string"&&s.type==="color"&&(u=Zt.parse(a)),{kind:"constant",isConfigDependent:!1,evaluate:()=>u}}}(r===void 0?e.specification.default:r,e.specification,i)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,r,i){return this.property.possiblyEvaluate(this,e,r,i)}}class A1{constructor(e,r){this.property=e,this.value=new sm(e,void 0,r)}transitioned(e,r){return new kS(this.property,this.value,r,Oe({},e.transition,this.transition),e.now)}untransitioned(){return new kS(this.property,this.value,null,{},0)}}class wd{constructor(e,r){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues),this._options=r,this.isConfigDependent=!1}getValue(e){return Y(this._values[e].value.value)}setValue(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new A1(this._values[e].property,this._options)),this._values[e].value=new sm(this._values[e].property,r===null?void 0:Y(r),this._options),this.isConfigDependent=this.isConfigDependent||this._values[e].value.expression.isConfigDependent}setTransitionOrValue(e){if(e)for(const r in e){const i=e[r];hr(r,"-transition")?this.setTransition(r.slice(0,-11),i):this.setValue(r,i)}}getTransition(e){return Y(this._values[e].transition)}setTransition(e,r){this._values.hasOwnProperty(e)||(this._values[e]=new A1(this._values[e].property)),this._values[e].transition=Y(r)||void 0}serialize(){const e={};for(const r of Object.keys(this._values)){const i=this.getValue(r);i!==void 0&&(e[r]=i);const a=this.getTransition(r);a!==void 0&&(e[`${r}-transition`]=a)}return e}transitioned(e,r){const i=new RS(this._properties);for(const a of Object.keys(this._values))i._values[a]=this._values[a].transitioned(e,r._values[a]);return i}untransitioned(){const e=new RS(this._properties);for(const r of Object.keys(this._values))e._values[r]=this._values[r].untransitioned();return e}}class kS{constructor(e,r,i,a,s){const c=a.delay||0,u=a.duration||0;s=s||0,this.property=e,this.value=r,this.begin=s+c,this.end=this.begin+u,e.specification.transition&&(a.delay||a.duration)&&(this.prior=i)}possiblyEvaluate(e,r,i){const a=e.now||0,s=this.value.possiblyEvaluate(e,r,i),c=this.prior;if(c){if(a>this.end)return this.prior=null,s;if(this.value.isDataDriven())return this.prior=null,s;if(a<this.begin)return c.possiblyEvaluate(e,r,i);{const u=(a-this.begin)/(this.end-this.begin);return this.property.interpolate(c.possiblyEvaluate(e,r,i),s,Ne(u))}}return s}}class RS{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,r,i){const a=new lm(this._properties);for(const s of Object.keys(this._values))a._values[s]=this._values[s].possiblyEvaluate(e,r,i);return a}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class nO{constructor(e,r){this._properties=e,this._values=Object.create(e.defaultPropertyValues),this._options=r,this.isConfigDependent=!1}getValue(e){return Y(this._values[e].value)}setValue(e,r){this._values[e]=new sm(this._values[e].property,r===null?void 0:Y(r),this._options),this.isConfigDependent=this.isConfigDependent||this._values[e].expression.isConfigDependent}serialize(){const e={};for(const r of Object.keys(this._values)){const i=this.getValue(r);i!==void 0&&(e[r]=i)}return e}possiblyEvaluate(e,r,i){const a=new lm(this._properties);for(const s of Object.keys(this._values))a._values[s]=this._values[s].possiblyEvaluate(e,r,i);return a}}class du{constructor(e,r,i){this.property=e,this.value=r,this.parameters=i}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,r,i,a){return this.property.evaluate(this.value,this.parameters,e,r,i,a)}}class lm{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class Ke{constructor(e){this.specification=e}possiblyEvaluate(e,r){return e.expression.evaluate(r)}interpolate(e,r,i){const a=Hp[this.specification.type];return a?a(e,r,i):e}}class St{constructor(e,r){this.specification=e,this.overrides=r}possiblyEvaluate(e,r,i,a){return new du(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(r,null,{},i,a)}:e.expression,r)}interpolate(e,r,i){if(e.value.kind!=="constant"||r.value.kind!=="constant")return e;if(e.value.value===void 0||r.value.value===void 0)return new du(this,{kind:"constant",value:void 0},e.parameters);const a=Hp[this.specification.type];return a?new du(this,{kind:"constant",value:a(e.value.value,r.value.value,i)},e.parameters):e}evaluate(e,r,i,a,s,c){return e.kind==="constant"?e.value:e.evaluate(r,i,a,s,c)}}class Ed{constructor(e){this.specification=e}possiblyEvaluate(e,r,i,a){return!!e.expression.evaluate(r,null,{},i,a)}interpolate(){return!1}}class gn{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const r=new mn(0,{});for(const i in e){const a=e[i];a.specification.overridable&&this.overridableProperties.push(i);const s=this.defaultPropertyValues[i]=new sm(a,void 0),c=this.defaultTransitionablePropertyValues[i]=new A1(a);this.defaultTransitioningPropertyValues[i]=c.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=s.possiblyEvaluate(r)}}}function zS(t,e){return 256*(t=ze(Math.floor(t),0,255))+ze(Math.floor(e),0,255)}ht(St,"DataDrivenProperty"),ht(Ke,"DataConstantProperty"),ht(Ed,"ColorRampProperty");const iO={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class cm{constructor(e,r){this._structArray=e,this._pos1=r*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class un{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,r){return e._trim(),r&&(e.isTransferred=!0,r.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const r=Object.create(this.prototype);return r.arrayBuffer=e.arrayBuffer,r.length=e.length,r.capacity=e.arrayBuffer.byteLength/r.bytesPerElement,r._refreshViews(),r}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const r=this.uint8;this._refreshViews(),r&&this.uint8.set(r)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ar(t,e=1){let r=0,i=0;return{members:t.map(a=>{const s=iO[a.type].BYTES_PER_ELEMENT,c=r=DS(r,Math.max(e,s)),u=a.components||1;return i=Math.max(i,s),r+=s*u,{name:a.name,type:a.type,components:u,offset:c}}),size:DS(r,Math.max(i,e)),alignment:e}}function DS(t,e){return Math.ceil(t/e)*e}class Gi extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r){const i=this.length;return this.resize(i+1),this.emplace(i,e,r)}emplace(e,r,i){const a=2*e;return this.int16[a+0]=r,this.int16[a+1]=i,e}}Gi.prototype.bytesPerElement=4,ht(Gi,"StructArrayLayout2i4");class um extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,r,i)}emplace(e,r,i,a){const s=3*e;return this.int16[s+0]=r,this.int16[s+1]=i,this.int16[s+2]=a,e}}um.prototype.bytesPerElement=6,ht(um,"StructArrayLayout3i6");class Bs extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i,a){const s=this.length;return this.resize(s+1),this.emplace(s,e,r,i,a)}emplace(e,r,i,a,s){const c=4*e;return this.int16[c+0]=r,this.int16[c+1]=i,this.int16[c+2]=a,this.int16[c+3]=s,e}}Bs.prototype.bytesPerElement=8,ht(Bs,"StructArrayLayout4i8");class I1 extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,a,s,c,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,r,i,a,s,c,u)}emplace(e,r,i,a,s,c,u,d){const p=6*e,m=12*e,_=3*e;return this.int16[p+0]=r,this.int16[p+1]=i,this.uint8[m+4]=a,this.uint8[m+5]=s,this.uint8[m+6]=c,this.uint8[m+7]=u,this.float32[_+2]=d,e}}I1.prototype.bytesPerElement=12,ht(I1,"StructArrayLayout2i4ub1f12");class Ns extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,a){const s=this.length;return this.resize(s+1),this.emplace(s,e,r,i,a)}emplace(e,r,i,a,s){const c=4*e;return this.float32[c+0]=r,this.float32[c+1]=i,this.float32[c+2]=a,this.float32[c+3]=s,e}}Ns.prototype.bytesPerElement=16,ht(Ns,"StructArrayLayout4f16");class js extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,a,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,r,i,a,s)}emplace(e,r,i,a,s,c){const u=6*e,d=3*e;return this.uint16[u+0]=r,this.uint16[u+1]=i,this.uint16[u+2]=a,this.uint16[u+3]=s,this.float32[d+2]=c,e}}js.prototype.bytesPerElement=12,ht(js,"StructArrayLayout4ui1f12");class hm extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,i,a){const s=this.length;return this.resize(s+1),this.emplace(s,e,r,i,a)}emplace(e,r,i,a,s){const c=4*e;return this.uint16[c+0]=r,this.uint16[c+1]=i,this.uint16[c+2]=a,this.uint16[c+3]=s,e}}hm.prototype.bytesPerElement=8,ht(hm,"StructArrayLayout4ui8");class dm extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i,a,s,c){const u=this.length;return this.resize(u+1),this.emplace(u,e,r,i,a,s,c)}emplace(e,r,i,a,s,c,u){const d=6*e;return this.int16[d+0]=r,this.int16[d+1]=i,this.int16[d+2]=a,this.int16[d+3]=s,this.int16[d+4]=c,this.int16[d+5]=u,e}}dm.prototype.bytesPerElement=12,ht(dm,"StructArrayLayout6i12");class P1 extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,i,a,s,c,u,d,p,m,_,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,r,i,a,s,c,u,d,p,m,_,y)}emplace(e,r,i,a,s,c,u,d,p,m,_,y,v){const b=12*e;return this.int16[b+0]=r,this.int16[b+1]=i,this.int16[b+2]=a,this.int16[b+3]=s,this.uint16[b+4]=c,this.uint16[b+5]=u,this.uint16[b+6]=d,this.uint16[b+7]=p,this.int16[b+8]=m,this.int16[b+9]=_,this.int16[b+10]=y,this.int16[b+11]=v,e}}P1.prototype.bytesPerElement=24,ht(P1,"StructArrayLayout4i4ui4i24");class k1 extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,a,s,c){const u=this.length;return this.resize(u+1),this.emplace(u,e,r,i,a,s,c)}emplace(e,r,i,a,s,c,u){const d=10*e,p=5*e;return this.int16[d+0]=r,this.int16[d+1]=i,this.int16[d+2]=a,this.float32[p+2]=s,this.float32[p+3]=c,this.float32[p+4]=u,e}}k1.prototype.bytesPerElement=20,ht(k1,"StructArrayLayout3i3f20");class R1 extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint32[1*e+0]=r,e}}R1.prototype.bytesPerElement=4,ht(R1,"StructArrayLayout1ul4");class $s extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r){const i=this.length;return this.resize(i+1),this.emplace(i,e,r)}emplace(e,r,i){const a=2*e;return this.uint16[a+0]=r,this.uint16[a+1]=i,e}}$s.prototype.bytesPerElement=4,ht($s,"StructArrayLayout2ui4");class z1 extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,i,a,s,c,u,d,p,m,_,y,v){const b=this.length;return this.resize(b+1),this.emplace(b,e,r,i,a,s,c,u,d,p,m,_,y,v)}emplace(e,r,i,a,s,c,u,d,p,m,_,y,v,b){const S=20*e,T=10*e;return this.int16[S+0]=r,this.int16[S+1]=i,this.int16[S+2]=a,this.int16[S+3]=s,this.int16[S+4]=c,this.float32[T+3]=u,this.float32[T+4]=d,this.float32[T+5]=p,this.float32[T+6]=m,this.int16[S+14]=_,this.uint32[T+8]=y,this.uint16[S+18]=v,this.uint16[S+19]=b,e}}z1.prototype.bytesPerElement=40,ht(z1,"StructArrayLayout5i4f1i1ul2ui40");class fm extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i,a,s,c,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,r,i,a,s,c,u)}emplace(e,r,i,a,s,c,u,d){const p=8*e;return this.int16[p+0]=r,this.int16[p+1]=i,this.int16[p+2]=a,this.int16[p+4]=s,this.int16[p+5]=c,this.int16[p+6]=u,this.int16[p+7]=d,e}}fm.prototype.bytesPerElement=16,ht(fm,"StructArrayLayout3i2i2i16");class D1 extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,r,i,a,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,r,i,a,s)}emplace(e,r,i,a,s,c){const u=4*e,d=8*e;return this.float32[u+0]=r,this.float32[u+1]=i,this.float32[u+2]=a,this.int16[d+6]=s,this.int16[d+7]=c,e}}D1.prototype.bytesPerElement=16,ht(D1,"StructArrayLayout2f1f2i16");class L1 extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,a){const s=this.length;return this.resize(s+1),this.emplace(s,e,r,i,a)}emplace(e,r,i,a,s){const c=12*e,u=3*e;return this.uint8[c+0]=r,this.uint8[c+1]=i,this.float32[u+1]=a,this.float32[u+2]=s,e}}L1.prototype.bytesPerElement=12,ht(L1,"StructArrayLayout2ub2f12");class Vs extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,r,i)}emplace(e,r,i,a){const s=3*e;return this.float32[s+0]=r,this.float32[s+1]=i,this.float32[s+2]=a,e}}Vs.prototype.bytesPerElement=12,ht(Vs,"StructArrayLayout3f12");class Bn extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,r,i)}emplace(e,r,i,a){const s=3*e;return this.uint16[s+0]=r,this.uint16[s+1]=i,this.uint16[s+2]=a,e}}Bn.prototype.bytesPerElement=6,ht(Bn,"StructArrayLayout3ui6");class O1 extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T,M,C,P,k,z){const L=this.length;return this.resize(L+1),this.emplace(L,e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T,M,C,P,k,z)}emplace(e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T,M,C,P,k,z,L){const B=30*e,W=15*e,Z=60*e;return this.int16[B+0]=r,this.int16[B+1]=i,this.int16[B+2]=a,this.float32[W+2]=s,this.float32[W+3]=c,this.uint16[B+8]=u,this.uint16[B+9]=d,this.uint32[W+5]=p,this.uint32[W+6]=m,this.uint32[W+7]=_,this.uint16[B+16]=y,this.uint16[B+17]=v,this.uint16[B+18]=b,this.float32[W+10]=S,this.float32[W+11]=T,this.uint8[Z+48]=M,this.uint8[Z+49]=C,this.uint8[Z+50]=P,this.uint32[W+13]=k,this.int16[B+28]=z,this.uint8[Z+58]=L,e}}O1.prototype.bytesPerElement=60,ht(O1,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class F1 extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T,M,C,P,k,z,L,B,W,Z,X,H,J,Q,K,fe){const he=this.length;return this.resize(he+1),this.emplace(he,e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T,M,C,P,k,z,L,B,W,Z,X,H,J,Q,K,fe)}emplace(e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T,M,C,P,k,z,L,B,W,Z,X,H,J,Q,K,fe,he){const _e=40*e,oe=20*e,me=80*e;return this.int16[_e+0]=r,this.int16[_e+1]=i,this.int16[_e+2]=a,this.float32[oe+2]=s,this.float32[oe+3]=c,this.int16[_e+8]=u,this.int16[_e+9]=d,this.int16[_e+10]=p,this.int16[_e+11]=m,this.int16[_e+12]=_,this.int16[_e+13]=y,this.uint16[_e+14]=v,this.uint16[_e+15]=b,this.uint16[_e+16]=S,this.uint16[_e+17]=T,this.uint16[_e+18]=M,this.uint16[_e+19]=C,this.uint16[_e+20]=P,this.uint16[_e+21]=k,this.uint16[_e+22]=z,this.uint16[_e+23]=L,this.uint16[_e+24]=B,this.uint16[_e+25]=W,this.uint16[_e+26]=Z,this.uint16[_e+27]=X,this.uint16[_e+28]=H,this.uint32[oe+15]=J,this.float32[oe+16]=Q,this.float32[oe+17]=K,this.float32[oe+18]=fe,this.uint8[me+76]=he,e}}F1.prototype.bytesPerElement=80,ht(F1,"StructArrayLayout3i2f6i15ui1ul3f1ub80");class pm extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.float32[1*e+0]=r,e}}pm.prototype.bytesPerElement=4,ht(pm,"StructArrayLayout1f4");class Sd extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,a,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,r,i,a,s)}emplace(e,r,i,a,s,c){const u=5*e;return this.float32[u+0]=r,this.float32[u+1]=i,this.float32[u+2]=a,this.float32[u+3]=s,this.float32[u+4]=c,e}}Sd.prototype.bytesPerElement=20,ht(Sd,"StructArrayLayout5f20");class B1 extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,a,s,c,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,r,i,a,s,c,u)}emplace(e,r,i,a,s,c,u,d){const p=7*e;return this.float32[p+0]=r,this.float32[p+1]=i,this.float32[p+2]=a,this.float32[p+3]=s,this.float32[p+4]=c,this.float32[p+5]=u,this.float32[p+6]=d,e}}B1.prototype.bytesPerElement=28,ht(B1,"StructArrayLayout7f28");class N1 extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,r,i,a){const s=this.length;return this.resize(s+1),this.emplace(s,e,r,i,a)}emplace(e,r,i,a,s){const c=6*e;return this.uint32[3*e+0]=r,this.uint16[c+2]=i,this.uint16[c+3]=a,this.uint16[c+4]=s,e}}N1.prototype.bytesPerElement=12,ht(N1,"StructArrayLayout1ul3ui12");class Td extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint16[1*e+0]=r,e}}Td.prototype.bytesPerElement=2,ht(Td,"StructArrayLayout1ui2");class Md extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r){const i=this.length;return this.resize(i+1),this.emplace(i,e,r)}emplace(e,r,i){const a=2*e;return this.float32[a+0]=r,this.float32[a+1]=i,e}}Md.prototype.bytesPerElement=8,ht(Md,"StructArrayLayout2f8");class j1 extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T){const M=this.length;return this.resize(M+1),this.emplace(M,e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T)}emplace(e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T,M){const C=16*e;return this.float32[C+0]=r,this.float32[C+1]=i,this.float32[C+2]=a,this.float32[C+3]=s,this.float32[C+4]=c,this.float32[C+5]=u,this.float32[C+6]=d,this.float32[C+7]=p,this.float32[C+8]=m,this.float32[C+9]=_,this.float32[C+10]=y,this.float32[C+11]=v,this.float32[C+12]=b,this.float32[C+13]=S,this.float32[C+14]=T,this.float32[C+15]=M,e}}j1.prototype.bytesPerElement=64,ht(j1,"StructArrayLayout16f64");class mm extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,r,i,a,s,c,u){const d=this.length;return this.resize(d+1),this.emplace(d,e,r,i,a,s,c,u)}emplace(e,r,i,a,s,c,u,d){const p=10*e,m=5*e;return this.uint16[p+0]=r,this.uint16[p+1]=i,this.uint16[p+2]=a,this.uint16[p+3]=s,this.float32[m+2]=c,this.float32[m+3]=u,this.float32[m+4]=d,e}}mm.prototype.bytesPerElement=20,ht(mm,"StructArrayLayout4ui3f20");class $1 extends un{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(e){const r=this.length;return this.resize(r+1),this.emplace(r,e)}emplace(e,r){return this.uint8[1*e+0]=r,e}}$1.prototype.bytesPerElement=1,ht($1,"StructArrayLayout1ub1");class LS extends cm{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}LS.prototype.size=40;class V1 extends z1{get(e){return new LS(this,e)}}ht(V1,"CollisionBoxArray");class OS extends cm{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}OS.prototype.size=60;class FS extends O1{get(e){return new OS(this,e)}}ht(FS,"PlacedSymbolArray");class BS extends cm{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}}BS.prototype.size=80;class NS extends F1{get(e){return new BS(this,e)}}ht(NS,"SymbolInstanceArray");class jS extends pm{getoffsetX(e){return this.float32[1*e+0]}}ht(jS,"GlyphOffsetArray");class $S extends Gi{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}ht($S,"SymbolLineVertexArray");class VS extends cm{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}VS.prototype.size=12;class US extends N1{get(e){return new VS(this,e)}}ht(US,"FeatureIndexArray");class GS extends $s{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}ht(GS,"FillExtrusionCentroidArray");const oO=Ar([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),aO=Ar([{name:"a_dash",components:4,type:"Uint16"}]);var gm={exports:{}},WS={exports:{}};(function(t){t.exports=function(e,r){var i,a,s,c,u,d,p,m;for(a=e.length-(i=3&e.length),s=r,u=3432918353,d=461845907,m=0;m<a;)p=255&e.charCodeAt(m)|(255&e.charCodeAt(++m))<<8|(255&e.charCodeAt(++m))<<16|(255&e.charCodeAt(++m))<<24,++m,s=27492+(65535&(c=5*(65535&(s=(s^=p=(65535&(p=(p=(65535&p)*u+(((p>>>16)*u&65535)<<16)&4294967295)<<15|p>>>17))*d+(((p>>>16)*d&65535)<<16)&4294967295)<<13|s>>>19))+((5*(s>>>16)&65535)<<16)&4294967295))+((58964+(c>>>16)&65535)<<16);switch(p=0,i){case 3:p^=(255&e.charCodeAt(m+2))<<16;case 2:p^=(255&e.charCodeAt(m+1))<<8;case 1:s^=p=(65535&(p=(p=(65535&(p^=255&e.charCodeAt(m)))*u+(((p>>>16)*u&65535)<<16)&4294967295)<<15|p>>>17))*d+(((p>>>16)*d&65535)<<16)&4294967295}return s^=e.length,s=2246822507*(65535&(s^=s>>>16))+((2246822507*(s>>>16)&65535)<<16)&4294967295,s=3266489909*(65535&(s^=s>>>13))+((3266489909*(s>>>16)&65535)<<16)&4294967295,(s^=s>>>16)>>>0}})(WS);var sO=WS.exports,HS={exports:{}};(function(t){t.exports=function(e,r){for(var i,a=e.length,s=r^a,c=0;a>=4;)i=1540483477*(65535&(i=255&e.charCodeAt(c)|(255&e.charCodeAt(++c))<<8|(255&e.charCodeAt(++c))<<16|(255&e.charCodeAt(++c))<<24))+((1540483477*(i>>>16)&65535)<<16),s=1540483477*(65535&s)+((1540483477*(s>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),a-=4,++c;switch(a){case 3:s^=(255&e.charCodeAt(c+2))<<16;case 2:s^=(255&e.charCodeAt(c+1))<<8;case 1:s=1540483477*(65535&(s^=255&e.charCodeAt(c)))+((1540483477*(s>>>16)&65535)<<16)}return s=1540483477*(65535&(s^=s>>>13))+((1540483477*(s>>>16)&65535)<<16),(s^=s>>>15)>>>0}})(HS);var qS=sO,lO=HS.exports;gm.exports=qS,gm.exports.murmur3=qS,gm.exports.murmur2=lO;var U1=V(gm.exports);class _m{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(e,r,i,a){this.ids.push(ZS(e)),this.positions.push(r,i,a)}eachPosition(e,r){const i=ZS(e);let a=0,s=this.ids.length-1;for(;a<s;){const c=a+s>>1;this.ids[c]>=i?s=c:a=c+1}for(;this.ids[a]===i;)r(this.positions[3*a],this.positions[3*a+1],this.positions[3*a+2]),a++}static serialize(e,r){const i=new Float64Array(e.ids),a=new Uint32Array(e.positions);return G1(i,a,0,i.length-1),r&&r.push(i.buffer,a.buffer),{ids:i,positions:a}}static deserialize(e){const r=new _m;let i;r.ids=e.ids,r.positions=e.positions;for(const a of r.ids)a!==i&&r.uniqueIds.push(a),i=a;return r.indexed=!0,r}}function ZS(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:U1(String(t))}function G1(t,e,r,i){for(;r<i;){const a=t[r+i>>1];let s=r-1,c=i+1;for(;;){do s++;while(t[s]<a);do c--;while(t[c]>a);if(s>=c)break;ym(t,s,c),ym(e,3*s,3*c),ym(e,3*s+1,3*c+1),ym(e,3*s+2,3*c+2)}c-r<i-c?(G1(t,e,r,c),r=c+1):(G1(t,e,c+1,i),i=c)}}function ym(t,e,r){const i=t[e];t[e]=t[r],t[r]=i}ht(_m,"FeaturePositionMap");class Ya{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,r){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,r),this.initialized=!0),!!this.location}}class Qt extends Ya{constructor(e){super(e),this.current=0}set(e,r,i){this.fetchUniformLocation(e,r)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}}class Ye extends Ya{constructor(e){super(e),this.current=0}set(e,r,i){this.fetchUniformLocation(e,r)&&this.current!==i&&(this.current=i,this.gl.uniform1f(this.location,i))}}class sr extends Ya{constructor(e){super(e),this.current=[0,0]}set(e,r,i){this.fetchUniformLocation(e,r)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}}class Vt extends Ya{constructor(e){super(e),this.current=[0,0,0]}set(e,r,i){this.fetchUniformLocation(e,r)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}}class ao extends Ya{constructor(e){super(e),this.current=[0,0,0,0]}set(e,r,i){this.fetchUniformLocation(e,r)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]&&i[3]===this.current[3]||(this.current=i,this.gl.uniform4f(this.location,i[0],i[1],i[2],i[3])))}}class fu extends Ya{constructor(e){super(e),this.current=Zt.transparent}set(e,r,i){this.fetchUniformLocation(e,r)&&(i.r===this.current.r&&i.g===this.current.g&&i.b===this.current.b&&i.a===this.current.a||(this.current=i,this.gl.uniform4f(this.location,i.r,i.g,i.b,i.a)))}}const cO=new Float32Array(16);class Gt extends Ya{constructor(e){super(e),this.current=cO}set(e,r,i){if(this.fetchUniformLocation(e,r)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let a=1;a<16;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}}const uO=new Float32Array(9);class XS extends Ya{constructor(e){super(e),this.current=uO}set(e,r,i){if(this.fetchUniformLocation(e,r)){for(let a=0;a<9;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}}}const hO=new Float32Array(4);class W1 extends Ya{constructor(e){super(e),this.current=hO}set(e,r,i){if(this.fetchUniformLocation(e,r)){for(let a=0;a<4;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}}}function H1(t){return[zS(255*t.r,255*t.g),zS(255*t.b,255*t.a)]}class Cd{constructor(e,r,i){this.value=e,this.uniformNames=r.map(a=>`u_${a}`),this.type=i}setUniform(e,r,i,a,s){r.set(e,s,a.constantOr(this.value))}getBinding(e,r){return this.type==="color"?new fu(e):new Ye(e)}}class pu{constructor(e,r){this.uniformNames=r.map(i=>`u_${i}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,r,i,a,s){const c=s==="u_pattern"||s==="u_dash"?this.pattern:s==="u_pixel_ratio"?this.pixelRatio:null;c&&r.set(e,s,c)}getBinding(e,r){return r==="u_pattern"||r==="u_dash"?new ao(e):new Ye(e)}}class Ka{constructor(e,r,i,a){this.expression=e,this.type=i,this.maxValue=0,this.paintVertexAttributes=r.map(s=>({name:`a_${s}`,type:"Float32",components:i==="color"?2:1,offset:0})),this.paintVertexArray=new a}populatePaintArray(e,r,i,a,s,c,u){const d=this.paintVertexArray.length,p=this.expression.evaluate(new mn(0,{brightness:c}),r,{},s,a,u);this.paintVertexArray.resize(e),this._setPaintValue(d,e,p)}updatePaintArray(e,r,i,a,s,c,u){const d=this.expression.evaluate({zoom:0,brightness:u},i,a,void 0,s);this._setPaintValue(e,r,d)}_setPaintValue(e,r,i){if(this.type==="color"){const a=H1(i);for(let s=e;s<r;s++)this.paintVertexArray.emplace(s,a[0],a[1])}else{for(let a=e;a<r;a++)this.paintVertexArray.emplace(a,i);this.maxValue=Math.max(this.maxValue,Math.abs(i))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ko{constructor(e,r,i,a,s,c){this.expression=e,this.uniformNames=r.map(u=>`u_${u}_t`),this.type=i,this.useIntegerZoom=a,this.zoom=s,this.maxValue=0,this.paintVertexAttributes=r.map(u=>({name:`a_${u}`,type:"Float32",components:i==="color"?4:2,offset:0})),this.paintVertexArray=new c}populatePaintArray(e,r,i,a,s,c,u){const d=this.expression.evaluate(new mn(this.zoom,{brightness:c}),r,{},s,a,u),p=this.expression.evaluate(new mn(this.zoom+1,{brightness:c}),r,{},s,a,u),m=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(m,e,d,p)}updatePaintArray(e,r,i,a,s,c,u){const d=this.expression.evaluate({zoom:this.zoom,brightness:u},i,a,void 0,s),p=this.expression.evaluate({zoom:this.zoom+1,brightness:u},i,a,void 0,s);this._setPaintValue(e,r,d,p)}_setPaintValue(e,r,i,a){if(this.type==="color"){const s=H1(i),c=H1(a);for(let u=e;u<r;u++)this.paintVertexArray.emplace(u,s[0],s[1],c[0],c[1])}else{for(let s=e;s<r;s++)this.paintVertexArray.emplace(s,i,a);this.maxValue=Math.max(this.maxValue,Math.abs(i),Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,r,i,a,s){const c=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,u=ze(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);r.set(e,s,u)}getBinding(e,r){return new Ye(e)}}class Us{constructor(e,r,i,a,s){this.expression=e,this.layerId=s,this.paintVertexAttributes=(i==="array"?aO:oO).members;for(let c=0;c<r.length;++c);this.paintVertexArray=new a}populatePaintArray(e,r,i){const a=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(a,e,r.patterns&&r.patterns[this.layerId],i)}updatePaintArray(e,r,i,a,s,c,u){this._setPaintValues(e,r,i.patterns&&i.patterns[this.layerId],c)}_setPaintValues(e,r,i,a){if(!a||!i)return;const s=a[i];if(!s)return;const{tl:c,br:u,pixelRatio:d}=s;for(let p=e;p<r;p++)this.paintVertexArray.emplace(p,c[0],c[1],u[0],u[1],d)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Gs{constructor(e,r,i=()=>!0){this.binders={},this._buffers=[];const a=[];for(const s in e.paint._values){if(!i(s))continue;const c=e.paint.get(s);if(!(c instanceof du&&Ql(c.property.specification)))continue;const u=fO(s,e.type),d=c.value,p=c.property.specification.type,m=!!c.property.useIntegerZoom,_=s==="line-dasharray"||s.endsWith("pattern"),y=s==="line-dasharray"&&e.layout.get("line-cap").value.kind!=="constant";if(d.kind!=="constant"||y)if(d.kind==="source"||y||_){const v=YS(s,p,"source");this.binders[s]=_?new Us(d,u,p,v,e.id):new Ka(d,u,p,v),a.push(`/a_${s}`)}else{const v=YS(s,p,"composite");this.binders[s]=new Ko(d,u,p,m,r,v),a.push(`/z_${s}`)}else this.binders[s]=_?new pu(d.value,u):new Cd(d.value,u,p),a.push(`/u_${s}`)}this.cacheKey=a.sort().join("")}getMaxValue(e){const r=this.binders[e];return r instanceof Ka||r instanceof Ko?r.maxValue:0}populatePaintArrays(e,r,i,a,s,c,u){for(const d in this.binders){const p=this.binders[d];(p instanceof Ka||p instanceof Ko||p instanceof Us)&&p.populatePaintArray(e,r,i,a,s,c,u)}}setConstantPatternPositions(e){for(const r in this.binders){const i=this.binders[r];i instanceof pu&&i.setConstantPatternPositions(e)}}updatePaintArrays(e,r,i,a,s,c,u){let d=!1;const p=Object.keys(e),m=p.length===0?r.uniqueIds:p;if(m.length===0)return!1;for(const _ in this.binders){const y=this.binders[_];if((y instanceof Ka||y instanceof Ko||y instanceof Us)&&(y.expression.isStateDependent===!0||y.expression.isLightConstant===!1)){const v=a.paint.get(_);y.expression=v.value;for(const b of m){const S=e[b.toString()];r.eachPosition(b,(T,M,C)=>{const P=i.feature(T);y.updatePaintArray(M,C,P,S,s,c,u)})}d=!0}}return d}defines(){const e=[];for(const r in this.binders){const i=this.binders[r];(i instanceof Cd||i instanceof pu)&&e.push(...i.uniformNames.map(a=>`#define HAS_UNIFORM_${a}`))}return e}getBinderAttributes(){const e=[];for(const r in this.binders){const i=this.binders[r];if(i instanceof Ka||i instanceof Ko||i instanceof Us)for(let a=0;a<i.paintVertexAttributes.length;a++)e.push(i.paintVertexAttributes[a].name)}return e}getBinderUniforms(){const e=[];for(const r in this.binders){const i=this.binders[r];if(i instanceof Cd||i instanceof pu||i instanceof Ko)for(const a of i.uniformNames)e.push(a)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const r=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof Cd||a instanceof pu||a instanceof Ko)for(const s of a.uniformNames)r.push({name:s,property:i,binding:a.getBinding(e,s)})}return r}setUniforms(e,r,i,a,s){for(const{name:c,property:u,binding:d}of i)this.binders[u].setUniform(e,d,s,a.get(u),c)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const r=this.binders[e];(r instanceof Ka||r instanceof Ko||r instanceof Us)&&r.paintVertexBuffer&&this._buffers.push(r.paintVertexBuffer)}}upload(e){for(const r in this.binders){const i=this.binders[r];(i instanceof Ka||i instanceof Ko||i instanceof Us)&&i.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const r=this.binders[e];(r instanceof Ka||r instanceof Ko||r instanceof Us)&&r.destroy()}}}class Ws{constructor(e,r,i=()=>!0){this.programConfigurations={};for(const a of e)this.programConfigurations[a.id]=new Gs(a,r,i);this.needsUpload=!1,this._featureMap=new _m,this._bufferOffset=0}populatePaintArrays(e,r,i,a,s,c,u,d){for(const p in this.programConfigurations)this.programConfigurations[p].populatePaintArrays(e,r,a,s,c,u,d);r.id!==void 0&&this._featureMap.add(r.id,i,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,r,i,a,s,c){for(const u of i)this.needsUpload=this.programConfigurations[u.id].updatePaintArrays(e,this._featureMap,r,u,a,s,c||0)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const r in this.programConfigurations)this.programConfigurations[r].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const dO={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function fO(t,e){return dO[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const pO={"line-pattern":{source:js,composite:js},"fill-pattern":{source:js,composite:js},"fill-extrusion-pattern":{source:js,composite:js},"line-dasharray":{source:hm,composite:hm}},mO={color:{source:Md,composite:Ns},number:{source:pm,composite:Md}};function YS(t,e,r){const i=pO[t];return i&&i[r]||mO[e][r]}ht(Cd,"ConstantBinder"),ht(pu,"PatternConstantBinder"),ht(Ka,"SourceExpressionBinder"),ht(Us,"PatternCompositeBinder"),ht(Ko,"CompositeExpressionBinder"),ht(Gs,"ProgramConfiguration",{omit:["_buffers"]}),ht(Ws,"ProgramConfigurationSet");const KS="-transition";class so extends dr{constructor(e,r,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.isConfigDependent=!1,e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&e.type!=="sky"&&e.type!=="slot"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),this.options=i,e.slot&&(this.slot=e.slot),r.layout&&(this._unevaluatedLayout=new nO(r.layout,i),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent),r.paint)){this._transitionablePaint=new wd(r.paint,i);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new lm(r.paint)}}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,r,i={}){r!=null&&this._validate(YL,`layers.${this.id}.layout.${e}`,e,r,i)||(this._unevaluatedLayout.setValue(e,r),this.isConfigDependent=this.isConfigDependent||this._unevaluatedLayout.isConfigDependent,e==="visibility"&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0})))}getPaintProperty(e){return hr(e,KS)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,r,i={}){if(r!=null&&this._validate(XL,`layers.${this.id}.paint.${e}`,e,r,i))return!1;if(hr(e,KS))return this._transitionablePaint.setTransition(e.slice(0,-11),r||void 0),!1;{const a=this._transitionablePaint._values[e],s=a.value.isDataDriven(),c=a.value;this._transitionablePaint.setValue(e,r),this.isConfigDependent=this.isConfigDependent||this._transitionablePaint.isConfigDependent,this._handleSpecialPaintPropertyUpdate(e);const u=this._transitionablePaint._values[e].value,d=u.isDataDriven(),p=hr(e,"pattern")||e==="line-dasharray";return d||s||p||this._handleOverridablePaintPropertyUpdate(e,c,u)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,r,i){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,r){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,r)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,r)}serialize(){return Fe({id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(e,r)=>!(e===void 0||r==="layout"&&!Object.keys(e).length||r==="paint"&&!Object.keys(e).length))}_validate(e,r,i,a,s={}){return(!s||s.validate!==!1)&&om(this,e.call(lu,{key:r,layerType:this.type,objectKey:i,value:a,styleSpec:pe,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}hasLightBeamPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const r=this.paint.get(e);if(r instanceof du&&Ql(r.property.specification)&&(r.value.kind==="source"||r.value.kind==="composite")&&r.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=rm(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const gO=Ar([{name:"a_pos",components:2,type:"Int16"}],4),_O=Ar([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Gr{constructor(e=[]){this.segments=e}prepareSegment(e,r,i,a){let s=this.segments[this.segments.length-1];return e>Gr.MAX_VERTEX_ARRAY_LENGTH&&re(`Max vertices per segment is ${Gr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!s||s.vertexLength+e>Gr.MAX_VERTEX_ARRAY_LENGTH||s.sortKey!==a)&&(s={vertexOffset:r.length,primitiveOffset:i.length,vertexLength:0,primitiveLength:0},a!==void 0&&(s.sortKey=a),this.segments.push(s)),s}get(){return this.segments}destroy(){for(const e of this.segments)for(const r in e.vaos)e.vaos[r].destroy()}static simpleSegment(e,r,i,a){return new Gr([{vertexOffset:e,primitiveOffset:r,vertexLength:i,primitiveLength:a,vaos:{},sortKey:0}])}}Gr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,ht(Gr,"SegmentVector");class lo{constructor(e,r){e&&(r?this.setSouthWest(e).setNorthEast(r):e.length===4?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof zt?new zt(e.lng,e.lat):zt.convert(e),this}setSouthWest(e){return this._sw=e instanceof zt?new zt(e.lng,e.lat):zt.convert(e),this}extend(e){const r=this._sw,i=this._ne;let a,s;if(e instanceof zt)a=e,s=e;else{if(!(e instanceof lo))return Array.isArray(e)?e.length===4||e.every(Array.isArray)?this.extend(lo.convert(e)):this.extend(zt.convert(e)):typeof e=="object"&&e!==null&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(zt.convert(e)):this;if(a=e._sw,s=e._ne,!a||!s)return this}return r||i?(r.lng=Math.min(a.lng,r.lng),r.lat=Math.min(a.lat,r.lat),i.lng=Math.max(s.lng,i.lng),i.lat=Math.max(s.lat,i.lat)):(this._sw=new zt(a.lng,a.lat),this._ne=new zt(s.lng,s.lat)),this}getCenter(){return new zt((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new zt(this.getWest(),this.getNorth())}getSouthEast(){return new zt(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:r,lat:i}=zt.convert(e);let a=this._sw.lng<=r&&r<=this._ne.lng;return this._sw.lng>this._ne.lng&&(a=this._sw.lng>=r&&r>=this._ne.lng),this._sw.lat<=i&&i<=this._ne.lat&&a}static convert(e){return!e||e instanceof lo?e:new lo(e)}}var qn={},Zn={};Object.defineProperty(Zn,"__esModule",{value:!0}),Zn.setMatrixArrayType=function(t){Zn.ARRAY_TYPE=QS=t},Zn.toRadian=function(t){return t*vO},Zn.equals=function(t,e){return Math.abs(t-e)<=JS*Math.max(1,Math.abs(t),Math.abs(e))},Zn.RANDOM=Zn.ARRAY_TYPE=Zn.EPSILON=void 0;var JS=1e-6;Zn.EPSILON=JS;var QS=typeof Float32Array<"u"?Float32Array:Array;Zn.ARRAY_TYPE=QS;var yO=Math.random;Zn.RANDOM=yO;var vO=Math.PI/180;Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var ln={};function q1(t){return q1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q1(t)}Object.defineProperty(ln,"__esModule",{value:!0}),ln.create=function(){var t=new Hs.ARRAY_TYPE(4);return Hs.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},ln.clone=function(t){var e=new Hs.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},ln.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},ln.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},ln.fromValues=function(t,e,r,i){var a=new Hs.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=i,a},ln.set=function(t,e,r,i,a){return t[0]=e,t[1]=r,t[2]=i,t[3]=a,t},ln.transpose=function(t,e){if(t===e){var r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},ln.invert=function(t,e){var r=e[0],i=e[1],a=e[2],s=e[3],c=r*s-a*i;return c?(t[0]=s*(c=1/c),t[1]=-i*c,t[2]=-a*c,t[3]=r*c,t):null},ln.adjoint=function(t,e){var r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},ln.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},ln.multiply=t4,ln.rotate=function(t,e,r){var i=e[0],a=e[1],s=e[2],c=e[3],u=Math.sin(r),d=Math.cos(r);return t[0]=i*d+s*u,t[1]=a*d+c*u,t[2]=i*-u+s*d,t[3]=a*-u+c*d,t},ln.scale=function(t,e,r){var i=e[1],a=e[2],s=e[3],c=r[0],u=r[1];return t[0]=e[0]*c,t[1]=i*c,t[2]=a*u,t[3]=s*u,t},ln.fromRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t},ln.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},ln.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},ln.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},ln.LDU=function(t,e,r,i){return t[2]=i[2]/i[0],r[0]=i[0],r[1]=i[1],r[3]=i[3]-t[2]*r[1],[t,e,r]},ln.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},ln.subtract=r4,ln.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},ln.equals=function(t,e){var r=t[0],i=t[1],a=t[2],s=t[3],c=e[0],u=e[1],d=e[2],p=e[3];return Math.abs(r-c)<=Hs.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-u)<=Hs.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-d)<=Hs.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(s-p)<=Hs.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))},ln.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},ln.multiplyScalarAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t},ln.sub=ln.mul=void 0;var Hs=function(t,e){if(t&&t.__esModule)return t;if(t===null||q1(t)!=="object"&&typeof t!="function")return{default:t};var r=e4(void 0);if(r&&r.has(t))return r.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var c=a?Object.getOwnPropertyDescriptor(t,s):null;c&&(c.get||c.set)?Object.defineProperty(i,s,c):i[s]=t[s]}return i.default=t,r&&r.set(t,i),i}(Zn);function e4(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(e4=function(i){return i?r:e})(t)}function t4(t,e,r){var i=e[0],a=e[1],s=e[2],c=e[3],u=r[0],d=r[1],p=r[2],m=r[3];return t[0]=i*u+s*d,t[1]=a*u+c*d,t[2]=i*p+s*m,t[3]=a*p+c*m,t}function r4(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}ln.mul=t4,ln.sub=r4;var hn={};function Z1(t){return Z1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Z1(t)}Object.defineProperty(hn,"__esModule",{value:!0}),hn.create=function(){var t=new Aa.ARRAY_TYPE(6);return Aa.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},hn.clone=function(t){var e=new Aa.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},hn.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},hn.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},hn.fromValues=function(t,e,r,i,a,s){var c=new Aa.ARRAY_TYPE(6);return c[0]=t,c[1]=e,c[2]=r,c[3]=i,c[4]=a,c[5]=s,c},hn.set=function(t,e,r,i,a,s,c){return t[0]=e,t[1]=r,t[2]=i,t[3]=a,t[4]=s,t[5]=c,t},hn.invert=function(t,e){var r=e[0],i=e[1],a=e[2],s=e[3],c=e[4],u=e[5],d=r*s-i*a;return d?(t[0]=s*(d=1/d),t[1]=-i*d,t[2]=-a*d,t[3]=r*d,t[4]=(a*u-s*c)*d,t[5]=(i*c-r*u)*d,t):null},hn.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},hn.multiply=i4,hn.rotate=function(t,e,r){var i=e[0],a=e[1],s=e[2],c=e[3],u=e[4],d=e[5],p=Math.sin(r),m=Math.cos(r);return t[0]=i*m+s*p,t[1]=a*m+c*p,t[2]=i*-p+s*m,t[3]=a*-p+c*m,t[4]=u,t[5]=d,t},hn.scale=function(t,e,r){var i=e[1],a=e[2],s=e[3],c=e[4],u=e[5],d=r[0],p=r[1];return t[0]=e[0]*d,t[1]=i*d,t[2]=a*p,t[3]=s*p,t[4]=c,t[5]=u,t},hn.translate=function(t,e,r){var i=e[0],a=e[1],s=e[2],c=e[3],u=e[4],d=e[5],p=r[0],m=r[1];return t[0]=i,t[1]=a,t[2]=s,t[3]=c,t[4]=i*p+s*m+u,t[5]=a*p+c*m+d,t},hn.fromRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t[4]=0,t[5]=0,t},hn.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},hn.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},hn.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},hn.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],1)},hn.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},hn.subtract=o4,hn.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},hn.multiplyScalarAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t},hn.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},hn.equals=function(t,e){var r=t[0],i=t[1],a=t[2],s=t[3],c=t[4],u=t[5],d=e[0],p=e[1],m=e[2],_=e[3],y=e[4],v=e[5];return Math.abs(r-d)<=Aa.EPSILON*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(i-p)<=Aa.EPSILON*Math.max(1,Math.abs(i),Math.abs(p))&&Math.abs(a-m)<=Aa.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(s-_)<=Aa.EPSILON*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(c-y)<=Aa.EPSILON*Math.max(1,Math.abs(c),Math.abs(y))&&Math.abs(u-v)<=Aa.EPSILON*Math.max(1,Math.abs(u),Math.abs(v))},hn.sub=hn.mul=void 0;var Aa=function(t,e){if(t&&t.__esModule)return t;if(t===null||Z1(t)!=="object"&&typeof t!="function")return{default:t};var r=n4(void 0);if(r&&r.has(t))return r.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var c=a?Object.getOwnPropertyDescriptor(t,s):null;c&&(c.get||c.set)?Object.defineProperty(i,s,c):i[s]=t[s]}return i.default=t,r&&r.set(t,i),i}(Zn);function n4(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(n4=function(i){return i?r:e})(t)}function i4(t,e,r){var i=e[0],a=e[1],s=e[2],c=e[3],u=e[4],d=e[5],p=r[0],m=r[1],_=r[2],y=r[3],v=r[4],b=r[5];return t[0]=i*p+s*m,t[1]=a*p+c*m,t[2]=i*_+s*y,t[3]=a*_+c*y,t[4]=i*v+s*b+u,t[5]=a*v+c*b+d,t}function o4(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}hn.mul=i4,hn.sub=o4;var Nr={};function X1(t){return X1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},X1(t)}Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.create=function(){var t=new co.ARRAY_TYPE(9);return co.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},Nr.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},Nr.clone=function(t){var e=new co.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},Nr.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},Nr.fromValues=function(t,e,r,i,a,s,c,u,d){var p=new co.ARRAY_TYPE(9);return p[0]=t,p[1]=e,p[2]=r,p[3]=i,p[4]=a,p[5]=s,p[6]=c,p[7]=u,p[8]=d,p},Nr.set=function(t,e,r,i,a,s,c,u,d,p){return t[0]=e,t[1]=r,t[2]=i,t[3]=a,t[4]=s,t[5]=c,t[6]=u,t[7]=d,t[8]=p,t},Nr.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},Nr.transpose=function(t,e){if(t===e){var r=e[1],i=e[2],a=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=i,t[7]=a}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},Nr.invert=function(t,e){var r=e[0],i=e[1],a=e[2],s=e[3],c=e[4],u=e[5],d=e[6],p=e[7],m=e[8],_=m*c-u*p,y=-m*s+u*d,v=p*s-c*d,b=r*_+i*y+a*v;return b?(t[0]=_*(b=1/b),t[1]=(-m*i+a*p)*b,t[2]=(u*i-a*c)*b,t[3]=y*b,t[4]=(m*r-a*d)*b,t[5]=(-u*r+a*s)*b,t[6]=v*b,t[7]=(-p*r+i*d)*b,t[8]=(c*r-i*s)*b,t):null},Nr.adjoint=function(t,e){var r=e[0],i=e[1],a=e[2],s=e[3],c=e[4],u=e[5],d=e[6],p=e[7],m=e[8];return t[0]=c*m-u*p,t[1]=a*p-i*m,t[2]=i*u-a*c,t[3]=u*d-s*m,t[4]=r*m-a*d,t[5]=a*s-r*u,t[6]=s*p-c*d,t[7]=i*d-r*p,t[8]=r*c-i*s,t},Nr.determinant=function(t){var e=t[3],r=t[4],i=t[5],a=t[6],s=t[7],c=t[8];return t[0]*(c*r-i*s)+t[1]*(-c*e+i*a)+t[2]*(s*e-r*a)},Nr.multiply=s4,Nr.translate=function(t,e,r){var i=e[0],a=e[1],s=e[2],c=e[3],u=e[4],d=e[5],p=e[6],m=e[7],_=e[8],y=r[0],v=r[1];return t[0]=i,t[1]=a,t[2]=s,t[3]=c,t[4]=u,t[5]=d,t[6]=y*i+v*c+p,t[7]=y*a+v*u+m,t[8]=y*s+v*d+_,t},Nr.rotate=function(t,e,r){var i=e[0],a=e[1],s=e[2],c=e[3],u=e[4],d=e[5],p=e[6],m=e[7],_=e[8],y=Math.sin(r),v=Math.cos(r);return t[0]=v*i+y*c,t[1]=v*a+y*u,t[2]=v*s+y*d,t[3]=v*c-y*i,t[4]=v*u-y*a,t[5]=v*d-y*s,t[6]=p,t[7]=m,t[8]=_,t},Nr.scale=function(t,e,r){var i=r[0],a=r[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=a*e[3],t[4]=a*e[4],t[5]=a*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},Nr.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},Nr.fromRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=-r,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},Nr.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},Nr.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},Nr.fromQuat=function(t,e){var r=e[0],i=e[1],a=e[2],s=e[3],c=r+r,u=i+i,d=a+a,p=r*c,m=i*c,_=i*u,y=a*c,v=a*u,b=a*d,S=s*c,T=s*u,M=s*d;return t[0]=1-_-b,t[3]=m-M,t[6]=y+T,t[1]=m+M,t[4]=1-p-b,t[7]=v-S,t[2]=y-T,t[5]=v+S,t[8]=1-p-_,t},Nr.normalFromMat4=function(t,e){var r=e[0],i=e[1],a=e[2],s=e[3],c=e[4],u=e[5],d=e[6],p=e[7],m=e[8],_=e[9],y=e[10],v=e[11],b=e[12],S=e[13],T=e[14],M=e[15],C=r*u-i*c,P=r*d-a*c,k=r*p-s*c,z=i*d-a*u,L=i*p-s*u,B=a*p-s*d,W=m*S-_*b,Z=m*T-y*b,X=m*M-v*b,H=_*T-y*S,J=_*M-v*S,Q=y*M-v*T,K=C*Q-P*J+k*H+z*X-L*Z+B*W;return K?(t[0]=(u*Q-d*J+p*H)*(K=1/K),t[1]=(d*X-c*Q-p*Z)*K,t[2]=(c*J-u*X+p*W)*K,t[3]=(a*J-i*Q-s*H)*K,t[4]=(r*Q-a*X+s*Z)*K,t[5]=(i*X-r*J-s*W)*K,t[6]=(S*B-T*L+M*z)*K,t[7]=(T*k-b*B-M*P)*K,t[8]=(b*L-S*k+M*C)*K,t):null},Nr.projection=function(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},Nr.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},Nr.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])},Nr.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},Nr.subtract=l4,Nr.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},Nr.multiplyScalarAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t},Nr.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},Nr.equals=function(t,e){var r=t[0],i=t[1],a=t[2],s=t[3],c=t[4],u=t[5],d=t[6],p=t[7],m=t[8],_=e[0],y=e[1],v=e[2],b=e[3],S=e[4],T=e[5],M=e[6],C=e[7],P=e[8];return Math.abs(r-_)<=co.EPSILON*Math.max(1,Math.abs(r),Math.abs(_))&&Math.abs(i-y)<=co.EPSILON*Math.max(1,Math.abs(i),Math.abs(y))&&Math.abs(a-v)<=co.EPSILON*Math.max(1,Math.abs(a),Math.abs(v))&&Math.abs(s-b)<=co.EPSILON*Math.max(1,Math.abs(s),Math.abs(b))&&Math.abs(c-S)<=co.EPSILON*Math.max(1,Math.abs(c),Math.abs(S))&&Math.abs(u-T)<=co.EPSILON*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(d-M)<=co.EPSILON*Math.max(1,Math.abs(d),Math.abs(M))&&Math.abs(p-C)<=co.EPSILON*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(m-P)<=co.EPSILON*Math.max(1,Math.abs(m),Math.abs(P))},Nr.sub=Nr.mul=void 0;var co=function(t,e){if(t&&t.__esModule)return t;if(t===null||X1(t)!=="object"&&typeof t!="function")return{default:t};var r=a4(void 0);if(r&&r.has(t))return r.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var c=a?Object.getOwnPropertyDescriptor(t,s):null;c&&(c.get||c.set)?Object.defineProperty(i,s,c):i[s]=t[s]}return i.default=t,r&&r.set(t,i),i}(Zn);function a4(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(a4=function(i){return i?r:e})(t)}function s4(t,e,r){var i=e[0],a=e[1],s=e[2],c=e[3],u=e[4],d=e[5],p=e[6],m=e[7],_=e[8],y=r[0],v=r[1],b=r[2],S=r[3],T=r[4],M=r[5],C=r[6],P=r[7],k=r[8];return t[0]=y*i+v*c+b*p,t[1]=y*a+v*u+b*m,t[2]=y*s+v*d+b*_,t[3]=S*i+T*c+M*p,t[4]=S*a+T*u+M*m,t[5]=S*s+T*d+M*_,t[6]=C*i+P*c+k*p,t[7]=C*a+P*u+k*m,t[8]=C*s+P*d+k*_,t}function l4(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}Nr.mul=s4,Nr.sub=l4;var Wt={};function Y1(t){return Y1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Y1(t)}Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.create=function(){var t=new En.ARRAY_TYPE(16);return En.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},Wt.clone=function(t){var e=new En.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},Wt.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Wt.fromValues=function(t,e,r,i,a,s,c,u,d,p,m,_,y,v,b,S){var T=new En.ARRAY_TYPE(16);return T[0]=t,T[1]=e,T[2]=r,T[3]=i,T[4]=a,T[5]=s,T[6]=c,T[7]=u,T[8]=d,T[9]=p,T[10]=m,T[11]=_,T[12]=y,T[13]=v,T[14]=b,T[15]=S,T},Wt.set=function(t,e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T){return t[0]=e,t[1]=r,t[2]=i,t[3]=a,t[4]=s,t[5]=c,t[6]=u,t[7]=d,t[8]=p,t[9]=m,t[10]=_,t[11]=y,t[12]=v,t[13]=b,t[14]=S,t[15]=T,t},Wt.identity=u4,Wt.transpose=function(t,e){if(t===e){var r=e[1],i=e[2],a=e[3],s=e[6],c=e[7],u=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=s,t[11]=e[14],t[12]=a,t[13]=c,t[14]=u}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},Wt.invert=function(t,e){var r=e[0],i=e[1],a=e[2],s=e[3],c=e[4],u=e[5],d=e[6],p=e[7],m=e[8],_=e[9],y=e[10],v=e[11],b=e[12],S=e[13],T=e[14],M=e[15],C=r*u-i*c,P=r*d-a*c,k=r*p-s*c,z=i*d-a*u,L=i*p-s*u,B=a*p-s*d,W=m*S-_*b,Z=m*T-y*b,X=m*M-v*b,H=_*T-y*S,J=_*M-v*S,Q=y*M-v*T,K=C*Q-P*J+k*H+z*X-L*Z+B*W;return K?(t[0]=(u*Q-d*J+p*H)*(K=1/K),t[1]=(a*J-i*Q-s*H)*K,t[2]=(S*B-T*L+M*z)*K,t[3]=(y*L-_*B-v*z)*K,t[4]=(d*X-c*Q-p*Z)*K,t[5]=(r*Q-a*X+s*Z)*K,t[6]=(T*k-b*B-M*P)*K,t[7]=(m*B-y*k+v*P)*K,t[8]=(c*J-u*X+p*W)*K,t[9]=(i*X-r*J-s*W)*K,t[10]=(b*L-S*k+M*C)*K,t[11]=(_*k-m*L-v*C)*K,t[12]=(u*Z-c*H-d*W)*K,t[13]=(r*H-i*Z+a*W)*K,t[14]=(S*P-b*z-T*C)*K,t[15]=(m*z-_*P+y*C)*K,t):null},Wt.adjoint=function(t,e){var r=e[0],i=e[1],a=e[2],s=e[3],c=e[4],u=e[5],d=e[6],p=e[7],m=e[8],_=e[9],y=e[10],v=e[11],b=e[12],S=e[13],T=e[14],M=e[15];return t[0]=u*(y*M-v*T)-_*(d*M-p*T)+S*(d*v-p*y),t[1]=-(i*(y*M-v*T)-_*(a*M-s*T)+S*(a*v-s*y)),t[2]=i*(d*M-p*T)-u*(a*M-s*T)+S*(a*p-s*d),t[3]=-(i*(d*v-p*y)-u*(a*v-s*y)+_*(a*p-s*d)),t[4]=-(c*(y*M-v*T)-m*(d*M-p*T)+b*(d*v-p*y)),t[5]=r*(y*M-v*T)-m*(a*M-s*T)+b*(a*v-s*y),t[6]=-(r*(d*M-p*T)-c*(a*M-s*T)+b*(a*p-s*d)),t[7]=r*(d*v-p*y)-c*(a*v-s*y)+m*(a*p-s*d),t[8]=c*(_*M-v*S)-m*(u*M-p*S)+b*(u*v-p*_),t[9]=-(r*(_*M-v*S)-m*(i*M-s*S)+b*(i*v-s*_)),t[10]=r*(u*M-p*S)-c*(i*M-s*S)+b*(i*p-s*u),t[11]=-(r*(u*v-p*_)-c*(i*v-s*_)+m*(i*p-s*u)),t[12]=-(c*(_*T-y*S)-m*(u*T-d*S)+b*(u*y-d*_)),t[13]=r*(_*T-y*S)-m*(i*T-a*S)+b*(i*y-a*_),t[14]=-(r*(u*T-d*S)-c*(i*T-a*S)+b*(i*d-a*u)),t[15]=r*(u*y-d*_)-c*(i*y-a*_)+m*(i*d-a*u),t},Wt.determinant=function(t){var e=t[0],r=t[1],i=t[2],a=t[3],s=t[4],c=t[5],u=t[6],d=t[7],p=t[8],m=t[9],_=t[10],y=t[11],v=t[12],b=t[13],S=t[14],T=t[15];return(e*c-r*s)*(_*T-y*S)-(e*u-i*s)*(m*T-y*b)+(e*d-a*s)*(m*S-_*b)+(r*u-i*c)*(p*T-y*v)-(r*d-a*c)*(p*S-_*v)+(i*d-a*u)*(p*b-m*v)},Wt.multiply=h4,Wt.translate=function(t,e,r){var i,a,s,c,u,d,p,m,_,y,v,b,S=r[0],T=r[1],M=r[2];return e===t?(t[12]=e[0]*S+e[4]*T+e[8]*M+e[12],t[13]=e[1]*S+e[5]*T+e[9]*M+e[13],t[14]=e[2]*S+e[6]*T+e[10]*M+e[14],t[15]=e[3]*S+e[7]*T+e[11]*M+e[15]):(a=e[1],s=e[2],c=e[3],u=e[4],d=e[5],p=e[6],m=e[7],_=e[8],y=e[9],v=e[10],b=e[11],t[0]=i=e[0],t[1]=a,t[2]=s,t[3]=c,t[4]=u,t[5]=d,t[6]=p,t[7]=m,t[8]=_,t[9]=y,t[10]=v,t[11]=b,t[12]=i*S+u*T+_*M+e[12],t[13]=a*S+d*T+y*M+e[13],t[14]=s*S+p*T+v*M+e[14],t[15]=c*S+m*T+b*M+e[15]),t},Wt.scale=function(t,e,r){var i=r[0],a=r[1],s=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*a,t[5]=e[5]*a,t[6]=e[6]*a,t[7]=e[7]*a,t[8]=e[8]*s,t[9]=e[9]*s,t[10]=e[10]*s,t[11]=e[11]*s,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},Wt.rotate=function(t,e,r,i){var a,s,c,u,d,p,m,_,y,v,b,S,T,M,C,P,k,z,L,B,W,Z,X,H,J=i[0],Q=i[1],K=i[2],fe=Math.hypot(J,Q,K);return fe<En.EPSILON?null:(J*=fe=1/fe,Q*=fe,K*=fe,a=Math.sin(r),s=Math.cos(r),d=e[1],p=e[2],m=e[3],y=e[5],v=e[6],b=e[7],T=e[9],M=e[10],C=e[11],L=J*Q*(c=1-s)-K*a,B=Q*Q*c+s,W=K*Q*c+J*a,Z=J*K*c+Q*a,X=Q*K*c-J*a,H=K*K*c+s,t[0]=(u=e[0])*(P=J*J*c+s)+(_=e[4])*(k=Q*J*c+K*a)+(S=e[8])*(z=K*J*c-Q*a),t[1]=d*P+y*k+T*z,t[2]=p*P+v*k+M*z,t[3]=m*P+b*k+C*z,t[4]=u*L+_*B+S*W,t[5]=d*L+y*B+T*W,t[6]=p*L+v*B+M*W,t[7]=m*L+b*B+C*W,t[8]=u*Z+_*X+S*H,t[9]=d*Z+y*X+T*H,t[10]=p*Z+v*X+M*H,t[11]=m*Z+b*X+C*H,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},Wt.rotateX=function(t,e,r){var i=Math.sin(r),a=Math.cos(r),s=e[4],c=e[5],u=e[6],d=e[7],p=e[8],m=e[9],_=e[10],y=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=s*a+p*i,t[5]=c*a+m*i,t[6]=u*a+_*i,t[7]=d*a+y*i,t[8]=p*a-s*i,t[9]=m*a-c*i,t[10]=_*a-u*i,t[11]=y*a-d*i,t},Wt.rotateY=function(t,e,r){var i=Math.sin(r),a=Math.cos(r),s=e[0],c=e[1],u=e[2],d=e[3],p=e[8],m=e[9],_=e[10],y=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*a-p*i,t[1]=c*a-m*i,t[2]=u*a-_*i,t[3]=d*a-y*i,t[8]=s*i+p*a,t[9]=c*i+m*a,t[10]=u*i+_*a,t[11]=d*i+y*a,t},Wt.rotateZ=function(t,e,r){var i=Math.sin(r),a=Math.cos(r),s=e[0],c=e[1],u=e[2],d=e[3],p=e[4],m=e[5],_=e[6],y=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=s*a+p*i,t[1]=c*a+m*i,t[2]=u*a+_*i,t[3]=d*a+y*i,t[4]=p*a-s*i,t[5]=m*a-c*i,t[6]=_*a-u*i,t[7]=y*a-d*i,t},Wt.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},Wt.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Wt.fromRotation=function(t,e,r){var i,a,s,c=r[0],u=r[1],d=r[2],p=Math.hypot(c,u,d);return p<En.EPSILON?null:(c*=p=1/p,u*=p,d*=p,i=Math.sin(e),a=Math.cos(e),t[0]=c*c*(s=1-a)+a,t[1]=u*c*s+d*i,t[2]=d*c*s-u*i,t[3]=0,t[4]=c*u*s-d*i,t[5]=u*u*s+a,t[6]=d*u*s+c*i,t[7]=0,t[8]=c*d*s+u*i,t[9]=u*d*s-c*i,t[10]=d*d*s+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},Wt.fromXRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Wt.fromYRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Wt.fromZRotation=function(t,e){var r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Wt.fromRotationTranslation=d4,Wt.fromQuat2=function(t,e){var r=new En.ARRAY_TYPE(3),i=-e[0],a=-e[1],s=-e[2],c=e[3],u=e[4],d=e[5],p=e[6],m=e[7],_=i*i+a*a+s*s+c*c;return _>0?(r[0]=2*(u*c+m*i+d*s-p*a)/_,r[1]=2*(d*c+m*a+p*i-u*s)/_,r[2]=2*(p*c+m*s+u*a-d*i)/_):(r[0]=2*(u*c+m*i+d*s-p*a),r[1]=2*(d*c+m*a+p*i-u*s),r[2]=2*(p*c+m*s+u*a-d*i)),d4(t,e,r),t},Wt.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},Wt.getScaling=f4,Wt.getRotation=function(t,e){var r=new En.ARRAY_TYPE(3);f4(r,e);var i=1/r[0],a=1/r[1],s=1/r[2],c=e[0]*i,u=e[1]*a,d=e[2]*s,p=e[4]*i,m=e[5]*a,_=e[6]*s,y=e[8]*i,v=e[9]*a,b=e[10]*s,S=c+m+b,T=0;return S>0?(T=2*Math.sqrt(S+1),t[3]=.25*T,t[0]=(_-v)/T,t[1]=(y-d)/T,t[2]=(u-p)/T):c>m&&c>b?(T=2*Math.sqrt(1+c-m-b),t[3]=(_-v)/T,t[0]=.25*T,t[1]=(u+p)/T,t[2]=(y+d)/T):m>b?(T=2*Math.sqrt(1+m-c-b),t[3]=(y-d)/T,t[0]=(u+p)/T,t[1]=.25*T,t[2]=(_+v)/T):(T=2*Math.sqrt(1+b-c-m),t[3]=(u-p)/T,t[0]=(y+d)/T,t[1]=(_+v)/T,t[2]=.25*T),t},Wt.fromRotationTranslationScale=function(t,e,r,i){var a=e[0],s=e[1],c=e[2],u=e[3],d=a+a,p=s+s,m=c+c,_=a*d,y=a*p,v=a*m,b=s*p,S=s*m,T=c*m,M=u*d,C=u*p,P=u*m,k=i[0],z=i[1],L=i[2];return t[0]=(1-(b+T))*k,t[1]=(y+P)*k,t[2]=(v-C)*k,t[3]=0,t[4]=(y-P)*z,t[5]=(1-(_+T))*z,t[6]=(S+M)*z,t[7]=0,t[8]=(v+C)*L,t[9]=(S-M)*L,t[10]=(1-(_+b))*L,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},Wt.fromRotationTranslationScaleOrigin=function(t,e,r,i,a){var s=e[0],c=e[1],u=e[2],d=e[3],p=s+s,m=c+c,_=u+u,y=s*p,v=s*m,b=s*_,S=c*m,T=c*_,M=u*_,C=d*p,P=d*m,k=d*_,z=i[0],L=i[1],B=i[2],W=a[0],Z=a[1],X=a[2],H=(1-(S+M))*z,J=(v+k)*z,Q=(b-P)*z,K=(v-k)*L,fe=(1-(y+M))*L,he=(T+C)*L,_e=(b+P)*B,oe=(T-C)*B,me=(1-(y+S))*B;return t[0]=H,t[1]=J,t[2]=Q,t[3]=0,t[4]=K,t[5]=fe,t[6]=he,t[7]=0,t[8]=_e,t[9]=oe,t[10]=me,t[11]=0,t[12]=r[0]+W-(H*W+K*Z+_e*X),t[13]=r[1]+Z-(J*W+fe*Z+oe*X),t[14]=r[2]+X-(Q*W+he*Z+me*X),t[15]=1,t},Wt.fromQuat=function(t,e){var r=e[0],i=e[1],a=e[2],s=e[3],c=r+r,u=i+i,d=a+a,p=r*c,m=i*c,_=i*u,y=a*c,v=a*u,b=a*d,S=s*c,T=s*u,M=s*d;return t[0]=1-_-b,t[1]=m+M,t[2]=y-T,t[3]=0,t[4]=m-M,t[5]=1-p-b,t[6]=v+S,t[7]=0,t[8]=y+T,t[9]=v-S,t[10]=1-p-_,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},Wt.frustum=function(t,e,r,i,a,s,c){var u=1/(r-e),d=1/(a-i),p=1/(s-c);return t[0]=2*s*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*s*d,t[6]=0,t[7]=0,t[8]=(r+e)*u,t[9]=(a+i)*d,t[10]=(c+s)*p,t[11]=-1,t[12]=0,t[13]=0,t[14]=c*s*2*p,t[15]=0,t},Wt.perspectiveNO=p4,Wt.perspectiveZO=function(t,e,r,i,a){var s,c=1/Math.tan(e/2);return t[0]=c/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(t[10]=a*(s=1/(i-a)),t[14]=a*i*s):(t[10]=-1,t[14]=-i),t},Wt.perspectiveFromFieldOfView=function(t,e,r,i){var a=Math.tan(e.upDegrees*Math.PI/180),s=Math.tan(e.downDegrees*Math.PI/180),c=Math.tan(e.leftDegrees*Math.PI/180),u=Math.tan(e.rightDegrees*Math.PI/180),d=2/(c+u),p=2/(a+s);return t[0]=d,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=p,t[6]=0,t[7]=0,t[8]=-(c-u)*d*.5,t[9]=(a-s)*p*.5,t[10]=i/(r-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*r/(r-i),t[15]=0,t},Wt.orthoNO=m4,Wt.orthoZO=function(t,e,r,i,a,s,c){var u=1/(e-r),d=1/(i-a),p=1/(s-c);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=p,t[11]=0,t[12]=(e+r)*u,t[13]=(a+i)*d,t[14]=s*p,t[15]=1,t},Wt.lookAt=function(t,e,r,i){var a,s,c,u,d,p,m,_,y,v,b=e[0],S=e[1],T=e[2],M=i[0],C=i[1],P=i[2],k=r[0],z=r[1],L=r[2];return Math.abs(b-k)<En.EPSILON&&Math.abs(S-z)<En.EPSILON&&Math.abs(T-L)<En.EPSILON?u4(t):(m=b-k,_=S-z,y=T-L,a=C*(y*=v=1/Math.hypot(m,_,y))-P*(_*=v),s=P*(m*=v)-M*y,c=M*_-C*m,(v=Math.hypot(a,s,c))?(a*=v=1/v,s*=v,c*=v):(a=0,s=0,c=0),u=_*c-y*s,d=y*a-m*c,p=m*s-_*a,(v=Math.hypot(u,d,p))?(u*=v=1/v,d*=v,p*=v):(u=0,d=0,p=0),t[0]=a,t[1]=u,t[2]=m,t[3]=0,t[4]=s,t[5]=d,t[6]=_,t[7]=0,t[8]=c,t[9]=p,t[10]=y,t[11]=0,t[12]=-(a*b+s*S+c*T),t[13]=-(u*b+d*S+p*T),t[14]=-(m*b+_*S+y*T),t[15]=1,t)},Wt.targetTo=function(t,e,r,i){var a=e[0],s=e[1],c=e[2],u=i[0],d=i[1],p=i[2],m=a-r[0],_=s-r[1],y=c-r[2],v=m*m+_*_+y*y;v>0&&(m*=v=1/Math.sqrt(v),_*=v,y*=v);var b=d*y-p*_,S=p*m-u*y,T=u*_-d*m;return(v=b*b+S*S+T*T)>0&&(b*=v=1/Math.sqrt(v),S*=v,T*=v),t[0]=b,t[1]=S,t[2]=T,t[3]=0,t[4]=_*T-y*S,t[5]=y*b-m*T,t[6]=m*S-_*b,t[7]=0,t[8]=m,t[9]=_,t[10]=y,t[11]=0,t[12]=a,t[13]=s,t[14]=c,t[15]=1,t},Wt.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},Wt.frob=function(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])},Wt.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},Wt.subtract=g4,Wt.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},Wt.multiplyScalarAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t[9]=e[9]+r[9]*i,t[10]=e[10]+r[10]*i,t[11]=e[11]+r[11]*i,t[12]=e[12]+r[12]*i,t[13]=e[13]+r[13]*i,t[14]=e[14]+r[14]*i,t[15]=e[15]+r[15]*i,t},Wt.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},Wt.equals=function(t,e){var r=t[0],i=t[1],a=t[2],s=t[3],c=t[4],u=t[5],d=t[6],p=t[7],m=t[8],_=t[9],y=t[10],v=t[11],b=t[12],S=t[13],T=t[14],M=t[15],C=e[0],P=e[1],k=e[2],z=e[3],L=e[4],B=e[5],W=e[6],Z=e[7],X=e[8],H=e[9],J=e[10],Q=e[11],K=e[12],fe=e[13],he=e[14],_e=e[15];return Math.abs(r-C)<=En.EPSILON*Math.max(1,Math.abs(r),Math.abs(C))&&Math.abs(i-P)<=En.EPSILON*Math.max(1,Math.abs(i),Math.abs(P))&&Math.abs(a-k)<=En.EPSILON*Math.max(1,Math.abs(a),Math.abs(k))&&Math.abs(s-z)<=En.EPSILON*Math.max(1,Math.abs(s),Math.abs(z))&&Math.abs(c-L)<=En.EPSILON*Math.max(1,Math.abs(c),Math.abs(L))&&Math.abs(u-B)<=En.EPSILON*Math.max(1,Math.abs(u),Math.abs(B))&&Math.abs(d-W)<=En.EPSILON*Math.max(1,Math.abs(d),Math.abs(W))&&Math.abs(p-Z)<=En.EPSILON*Math.max(1,Math.abs(p),Math.abs(Z))&&Math.abs(m-X)<=En.EPSILON*Math.max(1,Math.abs(m),Math.abs(X))&&Math.abs(_-H)<=En.EPSILON*Math.max(1,Math.abs(_),Math.abs(H))&&Math.abs(y-J)<=En.EPSILON*Math.max(1,Math.abs(y),Math.abs(J))&&Math.abs(v-Q)<=En.EPSILON*Math.max(1,Math.abs(v),Math.abs(Q))&&Math.abs(b-K)<=En.EPSILON*Math.max(1,Math.abs(b),Math.abs(K))&&Math.abs(S-fe)<=En.EPSILON*Math.max(1,Math.abs(S),Math.abs(fe))&&Math.abs(T-he)<=En.EPSILON*Math.max(1,Math.abs(T),Math.abs(he))&&Math.abs(M-_e)<=En.EPSILON*Math.max(1,Math.abs(M),Math.abs(_e))},Wt.sub=Wt.mul=Wt.ortho=Wt.perspective=void 0;var En=function(t,e){if(t&&t.__esModule)return t;if(t===null||Y1(t)!=="object"&&typeof t!="function")return{default:t};var r=c4(void 0);if(r&&r.has(t))return r.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var c=a?Object.getOwnPropertyDescriptor(t,s):null;c&&(c.get||c.set)?Object.defineProperty(i,s,c):i[s]=t[s]}return i.default=t,r&&r.set(t,i),i}(Zn);function c4(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(c4=function(i){return i?r:e})(t)}function u4(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function h4(t,e,r){var i=e[0],a=e[1],s=e[2],c=e[3],u=e[4],d=e[5],p=e[6],m=e[7],_=e[8],y=e[9],v=e[10],b=e[11],S=e[12],T=e[13],M=e[14],C=e[15],P=r[0],k=r[1],z=r[2],L=r[3];return t[0]=P*i+k*u+z*_+L*S,t[1]=P*a+k*d+z*y+L*T,t[2]=P*s+k*p+z*v+L*M,t[3]=P*c+k*m+z*b+L*C,t[4]=(P=r[4])*i+(k=r[5])*u+(z=r[6])*_+(L=r[7])*S,t[5]=P*a+k*d+z*y+L*T,t[6]=P*s+k*p+z*v+L*M,t[7]=P*c+k*m+z*b+L*C,t[8]=(P=r[8])*i+(k=r[9])*u+(z=r[10])*_+(L=r[11])*S,t[9]=P*a+k*d+z*y+L*T,t[10]=P*s+k*p+z*v+L*M,t[11]=P*c+k*m+z*b+L*C,t[12]=(P=r[12])*i+(k=r[13])*u+(z=r[14])*_+(L=r[15])*S,t[13]=P*a+k*d+z*y+L*T,t[14]=P*s+k*p+z*v+L*M,t[15]=P*c+k*m+z*b+L*C,t}function d4(t,e,r){var i=e[0],a=e[1],s=e[2],c=e[3],u=i+i,d=a+a,p=s+s,m=i*u,_=i*d,y=i*p,v=a*d,b=a*p,S=s*p,T=c*u,M=c*d,C=c*p;return t[0]=1-(v+S),t[1]=_+C,t[2]=y-M,t[3]=0,t[4]=_-C,t[5]=1-(m+S),t[6]=b+T,t[7]=0,t[8]=y+M,t[9]=b-T,t[10]=1-(m+v),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function f4(t,e){var r=e[4],i=e[5],a=e[6],s=e[8],c=e[9],u=e[10];return t[0]=Math.hypot(e[0],e[1],e[2]),t[1]=Math.hypot(r,i,a),t[2]=Math.hypot(s,c,u),t}function p4(t,e,r,i,a){var s,c=1/Math.tan(e/2);return t[0]=c/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,a!=null&&a!==1/0?(t[10]=(a+i)*(s=1/(i-a)),t[14]=2*a*i*s):(t[10]=-1,t[14]=-2*i),t}function m4(t,e,r,i,a,s,c){var u=1/(e-r),d=1/(i-a),p=1/(s-c);return t[0]=-2*u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*d,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*p,t[11]=0,t[12]=(e+r)*u,t[13]=(a+i)*d,t[14]=(c+s)*p,t[15]=1,t}function g4(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}Wt.perspective=p4,Wt.ortho=m4,Wt.mul=h4,Wt.sub=g4;var jt={},Ut={};function K1(t){return K1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},K1(t)}Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.create=y4,Ut.clone=function(t){var e=new Ja.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},Ut.length=v4,Ut.fromValues=function(t,e,r){var i=new Ja.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=r,i},Ut.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},Ut.set=function(t,e,r,i){return t[0]=e,t[1]=r,t[2]=i,t},Ut.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},Ut.subtract=x4,Ut.multiply=b4,Ut.divide=w4,Ut.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},Ut.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},Ut.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},Ut.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},Ut.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},Ut.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},Ut.scaleAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t},Ut.distance=E4,Ut.squaredDistance=S4,Ut.squaredLength=T4,Ut.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},Ut.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},Ut.normalize=function(t,e){var r=e[0],i=e[1],a=e[2],s=r*r+i*i+a*a;return s>0&&(s=1/Math.sqrt(s)),t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t},Ut.dot=M4,Ut.cross=function(t,e,r){var i=e[0],a=e[1],s=e[2],c=r[0],u=r[1],d=r[2];return t[0]=a*d-s*u,t[1]=s*c-i*d,t[2]=i*u-a*c,t},Ut.lerp=function(t,e,r,i){var a=e[0],s=e[1],c=e[2];return t[0]=a+i*(r[0]-a),t[1]=s+i*(r[1]-s),t[2]=c+i*(r[2]-c),t},Ut.hermite=function(t,e,r,i,a,s){var c=s*s,u=c*(2*s-3)+1,d=c*(s-2)+s,p=c*(s-1),m=c*(3-2*s);return t[0]=e[0]*u+r[0]*d+i[0]*p+a[0]*m,t[1]=e[1]*u+r[1]*d+i[1]*p+a[1]*m,t[2]=e[2]*u+r[2]*d+i[2]*p+a[2]*m,t},Ut.bezier=function(t,e,r,i,a,s){var c=1-s,u=c*c,d=s*s,p=u*c,m=3*s*u,_=3*d*c,y=d*s;return t[0]=e[0]*p+r[0]*m+i[0]*_+a[0]*y,t[1]=e[1]*p+r[1]*m+i[1]*_+a[1]*y,t[2]=e[2]*p+r[2]*m+i[2]*_+a[2]*y,t},Ut.random=function(t,e){e=e||1;var r=2*Ja.RANDOM()*Math.PI,i=2*Ja.RANDOM()-1,a=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(r)*a,t[1]=Math.sin(r)*a,t[2]=i*e,t},Ut.transformMat4=function(t,e,r){var i=e[0],a=e[1],s=e[2],c=r[3]*i+r[7]*a+r[11]*s+r[15];return t[0]=(r[0]*i+r[4]*a+r[8]*s+r[12])/(c=c||1),t[1]=(r[1]*i+r[5]*a+r[9]*s+r[13])/c,t[2]=(r[2]*i+r[6]*a+r[10]*s+r[14])/c,t},Ut.transformMat3=function(t,e,r){var i=e[0],a=e[1],s=e[2];return t[0]=i*r[0]+a*r[3]+s*r[6],t[1]=i*r[1]+a*r[4]+s*r[7],t[2]=i*r[2]+a*r[5]+s*r[8],t},Ut.transformQuat=function(t,e,r){var i=r[0],a=r[1],s=r[2],c=e[0],u=e[1],d=e[2],p=a*d-s*u,m=s*c-i*d,_=i*u-a*c,y=a*_-s*m,v=s*p-i*_,b=i*m-a*p,S=2*r[3];return m*=S,_*=S,v*=2,b*=2,t[0]=c+(p*=S)+(y*=2),t[1]=u+m+v,t[2]=d+_+b,t},Ut.rotateX=function(t,e,r,i){var a=[],s=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],s[0]=a[0],s[1]=a[1]*Math.cos(i)-a[2]*Math.sin(i),s[2]=a[1]*Math.sin(i)+a[2]*Math.cos(i),t[0]=s[0]+r[0],t[1]=s[1]+r[1],t[2]=s[2]+r[2],t},Ut.rotateY=function(t,e,r,i){var a=[],s=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],s[0]=a[2]*Math.sin(i)+a[0]*Math.cos(i),s[1]=a[1],s[2]=a[2]*Math.cos(i)-a[0]*Math.sin(i),t[0]=s[0]+r[0],t[1]=s[1]+r[1],t[2]=s[2]+r[2],t},Ut.rotateZ=function(t,e,r,i){var a=[],s=[];return a[0]=e[0]-r[0],a[1]=e[1]-r[1],a[2]=e[2]-r[2],s[0]=a[0]*Math.cos(i)-a[1]*Math.sin(i),s[1]=a[0]*Math.sin(i)+a[1]*Math.cos(i),s[2]=a[2],t[0]=s[0]+r[0],t[1]=s[1]+r[1],t[2]=s[2]+r[2],t},Ut.angle=function(t,e){var r=t[0],i=t[1],a=t[2],s=e[0],c=e[1],u=e[2],d=Math.sqrt(r*r+i*i+a*a)*Math.sqrt(s*s+c*c+u*u),p=d&&M4(t,e)/d;return Math.acos(Math.min(Math.max(p,-1),1))},Ut.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t},Ut.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},Ut.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},Ut.equals=function(t,e){var r=t[0],i=t[1],a=t[2],s=e[0],c=e[1],u=e[2];return Math.abs(r-s)<=Ja.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(i-c)<=Ja.EPSILON*Math.max(1,Math.abs(i),Math.abs(c))&&Math.abs(a-u)<=Ja.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))},Ut.forEach=Ut.sqrLen=Ut.len=Ut.sqrDist=Ut.dist=Ut.div=Ut.mul=Ut.sub=void 0;var Ja=function(t,e){if(t&&t.__esModule)return t;if(t===null||K1(t)!=="object"&&typeof t!="function")return{default:t};var r=_4(void 0);if(r&&r.has(t))return r.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var c=a?Object.getOwnPropertyDescriptor(t,s):null;c&&(c.get||c.set)?Object.defineProperty(i,s,c):i[s]=t[s]}return i.default=t,r&&r.set(t,i),i}(Zn);function _4(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(_4=function(i){return i?r:e})(t)}function y4(){var t=new Ja.ARRAY_TYPE(3);return Ja.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function v4(t){return Math.hypot(t[0],t[1],t[2])}function x4(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function b4(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function w4(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function E4(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])}function S4(t,e){var r=e[0]-t[0],i=e[1]-t[1],a=e[2]-t[2];return r*r+i*i+a*a}function T4(t){var e=t[0],r=t[1],i=t[2];return e*e+r*r+i*i}function M4(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}Ut.sub=x4,Ut.mul=b4,Ut.div=w4,Ut.dist=E4,Ut.sqrDist=S4,Ut.len=v4,Ut.sqrLen=T4;var Qa,xO=(Qa=y4(),function(t,e,r,i,a,s){var c,u;for(e||(e=3),r||(r=0),u=i?Math.min(i*e+r,t.length):t.length,c=r;c<u;c+=e)Qa[0]=t[c],Qa[1]=t[c+1],Qa[2]=t[c+2],a(Qa,Qa,s),t[c]=Qa[0],t[c+1]=Qa[1],t[c+2]=Qa[2];return t});Ut.forEach=xO;var or={};function J1(t){return J1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},J1(t)}Object.defineProperty(or,"__esModule",{value:!0}),or.create=A4,or.clone=function(t){var e=new zo.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},or.fromValues=function(t,e,r,i){var a=new zo.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=i,a},or.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},or.set=function(t,e,r,i,a){return t[0]=e,t[1]=r,t[2]=i,t[3]=a,t},or.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},or.subtract=I4,or.multiply=P4,or.divide=k4,or.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},or.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},or.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},or.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},or.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},or.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},or.scaleAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t},or.distance=R4,or.squaredDistance=z4,or.length=D4,or.squaredLength=L4,or.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},or.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},or.normalize=function(t,e){var r=e[0],i=e[1],a=e[2],s=e[3],c=r*r+i*i+a*a+s*s;return c>0&&(c=1/Math.sqrt(c)),t[0]=r*c,t[1]=i*c,t[2]=a*c,t[3]=s*c,t},or.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},or.cross=function(t,e,r,i){var a=r[0]*i[1]-r[1]*i[0],s=r[0]*i[2]-r[2]*i[0],c=r[0]*i[3]-r[3]*i[0],u=r[1]*i[2]-r[2]*i[1],d=r[1]*i[3]-r[3]*i[1],p=r[2]*i[3]-r[3]*i[2],m=e[0],_=e[1],y=e[2],v=e[3];return t[0]=_*p-y*d+v*u,t[1]=-m*p+y*c-v*s,t[2]=m*d-_*c+v*a,t[3]=-m*u+_*s-y*a,t},or.lerp=function(t,e,r,i){var a=e[0],s=e[1],c=e[2],u=e[3];return t[0]=a+i*(r[0]-a),t[1]=s+i*(r[1]-s),t[2]=c+i*(r[2]-c),t[3]=u+i*(r[3]-u),t},or.random=function(t,e){var r,i,a,s,c,u;e=e||1;do c=(r=2*zo.RANDOM()-1)*r+(i=2*zo.RANDOM()-1)*i;while(c>=1);do u=(a=2*zo.RANDOM()-1)*a+(s=2*zo.RANDOM()-1)*s;while(u>=1);var d=Math.sqrt((1-c)/u);return t[0]=e*r,t[1]=e*i,t[2]=e*a*d,t[3]=e*s*d,t},or.transformMat4=function(t,e,r){var i=e[0],a=e[1],s=e[2],c=e[3];return t[0]=r[0]*i+r[4]*a+r[8]*s+r[12]*c,t[1]=r[1]*i+r[5]*a+r[9]*s+r[13]*c,t[2]=r[2]*i+r[6]*a+r[10]*s+r[14]*c,t[3]=r[3]*i+r[7]*a+r[11]*s+r[15]*c,t},or.transformQuat=function(t,e,r){var i=e[0],a=e[1],s=e[2],c=r[0],u=r[1],d=r[2],p=r[3],m=p*i+u*s-d*a,_=p*a+d*i-c*s,y=p*s+c*a-u*i,v=-c*i-u*a-d*s;return t[0]=m*p+v*-c+_*-d-y*-u,t[1]=_*p+v*-u+y*-c-m*-d,t[2]=y*p+v*-d+m*-u-_*-c,t[3]=e[3],t},or.zero=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t},or.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},or.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},or.equals=function(t,e){var r=t[0],i=t[1],a=t[2],s=t[3],c=e[0],u=e[1],d=e[2],p=e[3];return Math.abs(r-c)<=zo.EPSILON*Math.max(1,Math.abs(r),Math.abs(c))&&Math.abs(i-u)<=zo.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-d)<=zo.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(s-p)<=zo.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))},or.forEach=or.sqrLen=or.len=or.sqrDist=or.dist=or.div=or.mul=or.sub=void 0;var zo=function(t,e){if(t&&t.__esModule)return t;if(t===null||J1(t)!=="object"&&typeof t!="function")return{default:t};var r=C4(void 0);if(r&&r.has(t))return r.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var c=a?Object.getOwnPropertyDescriptor(t,s):null;c&&(c.get||c.set)?Object.defineProperty(i,s,c):i[s]=t[s]}return i.default=t,r&&r.set(t,i),i}(Zn);function C4(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(C4=function(i){return i?r:e})(t)}function A4(){var t=new zo.ARRAY_TYPE(4);return zo.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function I4(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function P4(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function k4(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function R4(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2],e[3]-t[3])}function z4(t,e){var r=e[0]-t[0],i=e[1]-t[1],a=e[2]-t[2],s=e[3]-t[3];return r*r+i*i+a*a+s*s}function D4(t){return Math.hypot(t[0],t[1],t[2],t[3])}function L4(t){var e=t[0],r=t[1],i=t[2],a=t[3];return e*e+r*r+i*i+a*a}or.sub=I4,or.mul=P4,or.div=k4,or.dist=R4,or.sqrDist=z4,or.len=D4,or.sqrLen=L4;var bO=function(){var t=A4();return function(e,r,i,a,s,c){var u,d;for(r||(r=4),i||(i=0),d=a?Math.min(a*r+i,e.length):e.length,u=i;u<d;u+=r)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],s(t,t,c),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}();function Q1(t){return Q1=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Q1(t)}or.forEach=bO,Object.defineProperty(jt,"__esModule",{value:!0}),jt.create=ev,jt.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},jt.setAxisAngle=F4,jt.getAxisAngle=function(t,e){var r=2*Math.acos(e[3]),i=Math.sin(r/2);return i>tc.EPSILON?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),r},jt.getAngle=function(t,e){var r=U4(t,e);return Math.acos(2*r*r-1)},jt.multiply=B4,jt.rotateX=function(t,e,r){r*=.5;var i=e[0],a=e[1],s=e[2],c=e[3],u=Math.sin(r),d=Math.cos(r);return t[0]=i*d+c*u,t[1]=a*d+s*u,t[2]=s*d-a*u,t[3]=c*d-i*u,t},jt.rotateY=function(t,e,r){r*=.5;var i=e[0],a=e[1],s=e[2],c=e[3],u=Math.sin(r),d=Math.cos(r);return t[0]=i*d-s*u,t[1]=a*d+c*u,t[2]=s*d+i*u,t[3]=c*d-a*u,t},jt.rotateZ=function(t,e,r){r*=.5;var i=e[0],a=e[1],s=e[2],c=e[3],u=Math.sin(r),d=Math.cos(r);return t[0]=i*d+a*u,t[1]=a*d-i*u,t[2]=s*d+c*u,t[3]=c*d-s*u,t},jt.calculateW=function(t,e){var r=e[0],i=e[1],a=e[2];return t[0]=r,t[1]=i,t[2]=a,t[3]=Math.sqrt(Math.abs(1-r*r-i*i-a*a)),t},jt.exp=N4,jt.ln=j4,jt.pow=function(t,e,r){return j4(t,e),V4(t,t,r),N4(t,t),t},jt.slerp=xm,jt.random=function(t){var e=tc.RANDOM(),r=tc.RANDOM(),i=tc.RANDOM(),a=Math.sqrt(1-e),s=Math.sqrt(e);return t[0]=a*Math.sin(2*Math.PI*r),t[1]=a*Math.cos(2*Math.PI*r),t[2]=s*Math.sin(2*Math.PI*i),t[3]=s*Math.cos(2*Math.PI*i),t},jt.invert=function(t,e){var r=e[0],i=e[1],a=e[2],s=e[3],c=r*r+i*i+a*a+s*s,u=c?1/c:0;return t[0]=-r*u,t[1]=-i*u,t[2]=-a*u,t[3]=s*u,t},jt.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},jt.fromMat3=$4,jt.fromEuler=function(t,e,r,i){var a=.5*Math.PI/180;e*=a,r*=a,i*=a;var s=Math.sin(e),c=Math.cos(e),u=Math.sin(r),d=Math.cos(r),p=Math.sin(i),m=Math.cos(i);return t[0]=s*d*m-c*u*p,t[1]=c*u*m+s*d*p,t[2]=c*d*p-s*u*m,t[3]=c*d*m+s*u*p,t},jt.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},jt.setAxes=jt.sqlerp=jt.rotationTo=jt.equals=jt.exactEquals=jt.normalize=jt.sqrLen=jt.squaredLength=jt.len=jt.length=jt.lerp=jt.dot=jt.scale=jt.mul=jt.add=jt.set=jt.copy=jt.fromValues=jt.clone=void 0;var tc=vm(Zn),wO=vm(Nr),es=vm(Ut),uo=vm(or);function O4(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(O4=function(i){return i?r:e})(t)}function vm(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||Q1(t)!=="object"&&typeof t!="function")return{default:t};var r=O4(e);if(r&&r.has(t))return r.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var c=a?Object.getOwnPropertyDescriptor(t,s):null;c&&(c.get||c.set)?Object.defineProperty(i,s,c):i[s]=t[s]}return i.default=t,r&&r.set(t,i),i}function ev(){var t=new tc.ARRAY_TYPE(4);return tc.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function F4(t,e,r){r*=.5;var i=Math.sin(r);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(r),t}function B4(t,e,r){var i=e[0],a=e[1],s=e[2],c=e[3],u=r[0],d=r[1],p=r[2],m=r[3];return t[0]=i*m+c*u+a*p-s*d,t[1]=a*m+c*d+s*u-i*p,t[2]=s*m+c*p+i*d-a*u,t[3]=c*m-i*u-a*d-s*p,t}function N4(t,e){var r=e[0],i=e[1],a=e[2],s=e[3],c=Math.sqrt(r*r+i*i+a*a),u=Math.exp(s),d=c>0?u*Math.sin(c)/c:0;return t[0]=r*d,t[1]=i*d,t[2]=a*d,t[3]=u*Math.cos(c),t}function j4(t,e){var r=e[0],i=e[1],a=e[2],s=e[3],c=Math.sqrt(r*r+i*i+a*a),u=c>0?Math.atan2(c,s)/c:0;return t[0]=r*u,t[1]=i*u,t[2]=a*u,t[3]=.5*Math.log(r*r+i*i+a*a+s*s),t}function xm(t,e,r,i){var a,s,c,u,d,p=e[0],m=e[1],_=e[2],y=e[3],v=r[0],b=r[1],S=r[2],T=r[3];return(s=p*v+m*b+_*S+y*T)<0&&(s=-s,v=-v,b=-b,S=-S,T=-T),1-s>tc.EPSILON?(a=Math.acos(s),c=Math.sin(a),u=Math.sin((1-i)*a)/c,d=Math.sin(i*a)/c):(u=1-i,d=i),t[0]=u*p+d*v,t[1]=u*m+d*b,t[2]=u*_+d*S,t[3]=u*y+d*T,t}function $4(t,e){var r,i=e[0]+e[4]+e[8];if(i>0)r=Math.sqrt(i+1),t[3]=.5*r,t[0]=(e[5]-e[7])*(r=.5/r),t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var a=0;e[4]>e[0]&&(a=1),e[8]>e[3*a+a]&&(a=2);var s=(a+1)%3,c=(a+2)%3;r=Math.sqrt(e[3*a+a]-e[3*s+s]-e[3*c+c]+1),t[a]=.5*r,t[3]=(e[3*s+c]-e[3*c+s])*(r=.5/r),t[s]=(e[3*s+a]+e[3*a+s])*r,t[c]=(e[3*c+a]+e[3*a+c])*r}return t}jt.clone=uo.clone,jt.fromValues=uo.fromValues,jt.copy=uo.copy,jt.set=uo.set,jt.add=uo.add,jt.mul=B4;var V4=uo.scale;jt.scale=V4;var U4=uo.dot;jt.dot=U4,jt.lerp=uo.lerp;var G4=uo.length;jt.length=G4,jt.len=G4;var W4=uo.squaredLength;jt.squaredLength=W4,jt.sqrLen=W4;var tv=uo.normalize;jt.normalize=tv,jt.exactEquals=uo.exactEquals,jt.equals=uo.equals;var Jo,H4,q4,EO=(Jo=es.create(),H4=es.fromValues(1,0,0),q4=es.fromValues(0,1,0),function(t,e,r){var i=es.dot(e,r);return i<-.999999?(es.cross(Jo,H4,e),es.len(Jo)<1e-6&&es.cross(Jo,q4,e),es.normalize(Jo,Jo),F4(t,Jo,Math.PI),t):i>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):(es.cross(Jo,e,r),t[0]=Jo[0],t[1]=Jo[1],t[2]=Jo[2],t[3]=1+i,tv(t,t))});jt.rotationTo=EO;var rv,nv,SO=(rv=ev(),nv=ev(),function(t,e,r,i,a,s){return xm(rv,e,a,s),xm(nv,r,i,s),xm(t,rv,nv,2*s*(1-s)),t});jt.sqlerp=SO;var Qo,TO=(Qo=wO.create(),function(t,e,r,i){return Qo[0]=r[0],Qo[3]=r[1],Qo[6]=r[2],Qo[1]=i[0],Qo[4]=i[1],Qo[7]=i[2],Qo[2]=-e[0],Qo[5]=-e[1],Qo[8]=-e[2],tv(t,$4(t,Qo))});jt.setAxes=TO;var fr={};function iv(t){return iv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},iv(t)}Object.defineProperty(fr,"__esModule",{value:!0}),fr.create=function(){var t=new Ai.ARRAY_TYPE(8);return Ai.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},fr.clone=function(t){var e=new Ai.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},fr.fromValues=function(t,e,r,i,a,s,c,u){var d=new Ai.ARRAY_TYPE(8);return d[0]=t,d[1]=e,d[2]=r,d[3]=i,d[4]=a,d[5]=s,d[6]=c,d[7]=u,d},fr.fromRotationTranslationValues=function(t,e,r,i,a,s,c){var u=new Ai.ARRAY_TYPE(8);u[0]=t,u[1]=e,u[2]=r,u[3]=i;var d=.5*a,p=.5*s,m=.5*c;return u[4]=d*i+p*r-m*e,u[5]=p*i+m*t-d*r,u[6]=m*i+d*e-p*t,u[7]=-d*t-p*e-m*r,u},fr.fromRotationTranslation=Y4,fr.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},fr.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},fr.fromMat4=function(t,e){var r=ts.create();Z4.getRotation(r,e);var i=new Ai.ARRAY_TYPE(3);return Z4.getTranslation(i,e),Y4(t,r,i),t},fr.copy=K4,fr.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},fr.set=function(t,e,r,i,a,s,c,u,d){return t[0]=e,t[1]=r,t[2]=i,t[3]=a,t[4]=s,t[5]=c,t[6]=u,t[7]=d,t},fr.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},fr.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},fr.getTranslation=function(t,e){var r=e[4],i=e[5],a=e[6],s=e[7],c=-e[0],u=-e[1],d=-e[2],p=e[3];return t[0]=2*(r*p+s*c+i*d-a*u),t[1]=2*(i*p+s*u+a*c-r*d),t[2]=2*(a*p+s*d+r*u-i*c),t},fr.translate=function(t,e,r){var i=e[0],a=e[1],s=e[2],c=e[3],u=.5*r[0],d=.5*r[1],p=.5*r[2],m=e[4],_=e[5],y=e[6],v=e[7];return t[0]=i,t[1]=a,t[2]=s,t[3]=c,t[4]=c*u+a*p-s*d+m,t[5]=c*d+s*u-i*p+_,t[6]=c*p+i*d-a*u+y,t[7]=-i*u-a*d-s*p+v,t},fr.rotateX=function(t,e,r){var i=-e[0],a=-e[1],s=-e[2],c=e[3],u=e[4],d=e[5],p=e[6],m=e[7],_=u*c+m*i+d*s-p*a,y=d*c+m*a+p*i-u*s,v=p*c+m*s+u*a-d*i,b=m*c-u*i-d*a-p*s;return ts.rotateX(t,e,r),t[4]=_*(c=t[3])+b*(i=t[0])+y*(s=t[2])-v*(a=t[1]),t[5]=y*c+b*a+v*i-_*s,t[6]=v*c+b*s+_*a-y*i,t[7]=b*c-_*i-y*a-v*s,t},fr.rotateY=function(t,e,r){var i=-e[0],a=-e[1],s=-e[2],c=e[3],u=e[4],d=e[5],p=e[6],m=e[7],_=u*c+m*i+d*s-p*a,y=d*c+m*a+p*i-u*s,v=p*c+m*s+u*a-d*i,b=m*c-u*i-d*a-p*s;return ts.rotateY(t,e,r),t[4]=_*(c=t[3])+b*(i=t[0])+y*(s=t[2])-v*(a=t[1]),t[5]=y*c+b*a+v*i-_*s,t[6]=v*c+b*s+_*a-y*i,t[7]=b*c-_*i-y*a-v*s,t},fr.rotateZ=function(t,e,r){var i=-e[0],a=-e[1],s=-e[2],c=e[3],u=e[4],d=e[5],p=e[6],m=e[7],_=u*c+m*i+d*s-p*a,y=d*c+m*a+p*i-u*s,v=p*c+m*s+u*a-d*i,b=m*c-u*i-d*a-p*s;return ts.rotateZ(t,e,r),t[4]=_*(c=t[3])+b*(i=t[0])+y*(s=t[2])-v*(a=t[1]),t[5]=y*c+b*a+v*i-_*s,t[6]=v*c+b*s+_*a-y*i,t[7]=b*c-_*i-y*a-v*s,t},fr.rotateByQuatAppend=function(t,e,r){var i=r[0],a=r[1],s=r[2],c=r[3],u=e[0],d=e[1],p=e[2],m=e[3];return t[0]=u*c+m*i+d*s-p*a,t[1]=d*c+m*a+p*i-u*s,t[2]=p*c+m*s+u*a-d*i,t[3]=m*c-u*i-d*a-p*s,t[4]=(u=e[4])*c+(m=e[7])*i+(d=e[5])*s-(p=e[6])*a,t[5]=d*c+m*a+p*i-u*s,t[6]=p*c+m*s+u*a-d*i,t[7]=m*c-u*i-d*a-p*s,t},fr.rotateByQuatPrepend=function(t,e,r){var i=e[0],a=e[1],s=e[2],c=e[3],u=r[0],d=r[1],p=r[2],m=r[3];return t[0]=i*m+c*u+a*p-s*d,t[1]=a*m+c*d+s*u-i*p,t[2]=s*m+c*p+i*d-a*u,t[3]=c*m-i*u-a*d-s*p,t[4]=i*(m=r[7])+c*(u=r[4])+a*(p=r[6])-s*(d=r[5]),t[5]=a*m+c*d+s*u-i*p,t[6]=s*m+c*p+i*d-a*u,t[7]=c*m-i*u-a*d-s*p,t},fr.rotateAroundAxis=function(t,e,r,i){if(Math.abs(i)<Ai.EPSILON)return K4(t,e);var a=Math.hypot(r[0],r[1],r[2]);i*=.5;var s=Math.sin(i),c=s*r[0]/a,u=s*r[1]/a,d=s*r[2]/a,p=Math.cos(i),m=e[0],_=e[1],y=e[2],v=e[3];t[0]=m*p+v*c+_*d-y*u,t[1]=_*p+v*u+y*c-m*d,t[2]=y*p+v*d+m*u-_*c,t[3]=v*p-m*c-_*u-y*d;var b=e[4],S=e[5],T=e[6],M=e[7];return t[4]=b*p+M*c+S*d-T*u,t[5]=S*p+M*u+T*c-b*d,t[6]=T*p+M*d+b*u-S*c,t[7]=M*p-b*c-S*u-T*d,t},fr.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t},fr.multiply=J4,fr.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t},fr.lerp=function(t,e,r,i){var a=1-i;return Q4(e,r)<0&&(i=-i),t[0]=e[0]*a+r[0]*i,t[1]=e[1]*a+r[1]*i,t[2]=e[2]*a+r[2]*i,t[3]=e[3]*a+r[3]*i,t[4]=e[4]*a+r[4]*i,t[5]=e[5]*a+r[5]*i,t[6]=e[6]*a+r[6]*i,t[7]=e[7]*a+r[7]*i,t},fr.invert=function(t,e){var r=bm(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t},fr.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},fr.normalize=function(t,e){var r=bm(e);if(r>0){r=Math.sqrt(r);var i=e[0]/r,a=e[1]/r,s=e[2]/r,c=e[3]/r,u=e[4],d=e[5],p=e[6],m=e[7],_=i*u+a*d+s*p+c*m;t[0]=i,t[1]=a,t[2]=s,t[3]=c,t[4]=(u-i*_)/r,t[5]=(d-a*_)/r,t[6]=(p-s*_)/r,t[7]=(m-c*_)/r}return t},fr.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},fr.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},fr.equals=function(t,e){var r=t[0],i=t[1],a=t[2],s=t[3],c=t[4],u=t[5],d=t[6],p=t[7],m=e[0],_=e[1],y=e[2],v=e[3],b=e[4],S=e[5],T=e[6],M=e[7];return Math.abs(r-m)<=Ai.EPSILON*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(i-_)<=Ai.EPSILON*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(a-y)<=Ai.EPSILON*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(s-v)<=Ai.EPSILON*Math.max(1,Math.abs(s),Math.abs(v))&&Math.abs(c-b)<=Ai.EPSILON*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(u-S)<=Ai.EPSILON*Math.max(1,Math.abs(u),Math.abs(S))&&Math.abs(d-T)<=Ai.EPSILON*Math.max(1,Math.abs(d),Math.abs(T))&&Math.abs(p-M)<=Ai.EPSILON*Math.max(1,Math.abs(p),Math.abs(M))},fr.sqrLen=fr.squaredLength=fr.len=fr.length=fr.dot=fr.mul=fr.setReal=fr.getReal=void 0;var Ai=ov(Zn),ts=ov(jt),Z4=ov(Wt);function X4(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(X4=function(i){return i?r:e})(t)}function ov(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||iv(t)!=="object"&&typeof t!="function")return{default:t};var r=X4(e);if(r&&r.has(t))return r.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var c=a?Object.getOwnPropertyDescriptor(t,s):null;c&&(c.get||c.set)?Object.defineProperty(i,s,c):i[s]=t[s]}return i.default=t,r&&r.set(t,i),i}function Y4(t,e,r){var i=.5*r[0],a=.5*r[1],s=.5*r[2],c=e[0],u=e[1],d=e[2],p=e[3];return t[0]=c,t[1]=u,t[2]=d,t[3]=p,t[4]=i*p+a*d-s*u,t[5]=a*p+s*c-i*d,t[6]=s*p+i*u-a*c,t[7]=-i*c-a*u-s*d,t}function K4(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function J4(t,e,r){var i=e[0],a=e[1],s=e[2],c=e[3],u=r[4],d=r[5],p=r[6],m=r[7],_=e[4],y=e[5],v=e[6],b=e[7],S=r[0],T=r[1],M=r[2],C=r[3];return t[0]=i*C+c*S+a*M-s*T,t[1]=a*C+c*T+s*S-i*M,t[2]=s*C+c*M+i*T-a*S,t[3]=c*C-i*S-a*T-s*M,t[4]=i*m+c*u+a*p-s*d+_*C+b*S+y*M-v*T,t[5]=a*m+c*d+s*u-i*p+y*C+b*T+v*S-_*M,t[6]=s*m+c*p+i*d-a*u+v*C+b*M+_*T-y*S,t[7]=c*m-i*u-a*d-s*p+b*C-_*S-y*T-v*M,t}fr.getReal=ts.copy,fr.setReal=ts.copy,fr.mul=J4;var Q4=ts.dot;fr.dot=Q4;var eT=ts.length;fr.length=eT,fr.len=eT;var bm=ts.squaredLength;fr.squaredLength=bm,fr.sqrLen=bm;var Xt={};function av(t){return av=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},av(t)}Object.defineProperty(Xt,"__esModule",{value:!0}),Xt.create=rT,Xt.clone=function(t){var e=new rc.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},Xt.fromValues=function(t,e){var r=new rc.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},Xt.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},Xt.set=function(t,e,r){return t[0]=e,t[1]=r,t},Xt.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},Xt.subtract=nT,Xt.multiply=iT,Xt.divide=oT,Xt.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},Xt.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},Xt.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},Xt.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},Xt.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},Xt.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},Xt.scaleAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t},Xt.distance=aT,Xt.squaredDistance=sT,Xt.length=lT,Xt.squaredLength=cT,Xt.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},Xt.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},Xt.normalize=function(t,e){var r=e[0],i=e[1],a=r*r+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t},Xt.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},Xt.cross=function(t,e,r){var i=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=i,t},Xt.lerp=function(t,e,r,i){var a=e[0],s=e[1];return t[0]=a+i*(r[0]-a),t[1]=s+i*(r[1]-s),t},Xt.random=function(t,e){e=e||1;var r=2*rc.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},Xt.transformMat2=function(t,e,r){var i=e[0],a=e[1];return t[0]=r[0]*i+r[2]*a,t[1]=r[1]*i+r[3]*a,t},Xt.transformMat2d=function(t,e,r){var i=e[0],a=e[1];return t[0]=r[0]*i+r[2]*a+r[4],t[1]=r[1]*i+r[3]*a+r[5],t},Xt.transformMat3=function(t,e,r){var i=e[0],a=e[1];return t[0]=r[0]*i+r[3]*a+r[6],t[1]=r[1]*i+r[4]*a+r[7],t},Xt.transformMat4=function(t,e,r){var i=e[0],a=e[1];return t[0]=r[0]*i+r[4]*a+r[12],t[1]=r[1]*i+r[5]*a+r[13],t},Xt.rotate=function(t,e,r,i){var a=e[0]-r[0],s=e[1]-r[1],c=Math.sin(i),u=Math.cos(i);return t[0]=a*u-s*c+r[0],t[1]=a*c+s*u+r[1],t},Xt.angle=function(t,e){var r=t[0],i=t[1],a=e[0],s=e[1],c=Math.sqrt(r*r+i*i)*Math.sqrt(a*a+s*s);return Math.acos(Math.min(Math.max(c&&(r*a+i*s)/c,-1),1))},Xt.zero=function(t){return t[0]=0,t[1]=0,t},Xt.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},Xt.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Xt.equals=function(t,e){var r=t[0],i=t[1],a=e[0],s=e[1];return Math.abs(r-a)<=rc.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(i-s)<=rc.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))},Xt.forEach=Xt.sqrLen=Xt.sqrDist=Xt.dist=Xt.div=Xt.mul=Xt.sub=Xt.len=void 0;var rc=function(t,e){if(t&&t.__esModule)return t;if(t===null||av(t)!=="object"&&typeof t!="function")return{default:t};var r=tT(void 0);if(r&&r.has(t))return r.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var c=a?Object.getOwnPropertyDescriptor(t,s):null;c&&(c.get||c.set)?Object.defineProperty(i,s,c):i[s]=t[s]}return i.default=t,r&&r.set(t,i),i}(Zn);function tT(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(tT=function(i){return i?r:e})(t)}function rT(){var t=new rc.ARRAY_TYPE(2);return rc.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function nT(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function iT(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function oT(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function aT(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1])}function sT(t,e){var r=e[0]-t[0],i=e[1]-t[1];return r*r+i*i}function lT(t){return Math.hypot(t[0],t[1])}function cT(t){var e=t[0],r=t[1];return e*e+r*r}Xt.len=lT,Xt.sub=nT,Xt.mul=iT,Xt.div=oT,Xt.dist=aT,Xt.sqrDist=sT,Xt.sqrLen=cT;var MO=function(){var t=rT();return function(e,r,i,a,s,c){var u,d;for(r||(r=2),i||(i=0),d=a?Math.min(a*r+i,e.length):e.length,u=i;u<d;u+=r)t[0]=e[u],t[1]=e[u+1],s(t,t,c),e[u]=t[0],e[u+1]=t[1];return e}}();function sv(t){return sv=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},sv(t)}Xt.forEach=MO,Object.defineProperty(qn,"__esModule",{value:!0});var Wr=qn.vec4=ie=qn.vec3=qn.vec2=qn.quat2=oi=qn.quat=ge=qn.mat4=Ii=qn.mat3=qn.mat2d=mu=qn.mat2=qn.glMatrix=void 0,CO=Ia(Zn);qn.glMatrix=CO;var AO=Ia(ln),mu=qn.mat2=AO,IO=Ia(hn);qn.mat2d=IO;var PO=Ia(Nr),Ii=qn.mat3=PO,kO=Ia(Wt),ge=qn.mat4=kO,RO=Ia(jt),oi=qn.quat=RO,zO=Ia(fr);qn.quat2=zO;var DO=Ia(Xt);qn.vec2=DO;var LO=Ia(Ut),ie=qn.vec3=LO,OO=Ia(or);function uT(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,r=new WeakMap;return(uT=function(i){return i?r:e})(t)}function Ia(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||sv(t)!=="object"&&typeof t!="function")return{default:t};var r=uT(e);if(r&&r.has(t))return r.get(t);var i={},a=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if(s!=="default"&&Object.prototype.hasOwnProperty.call(t,s)){var c=a?Object.getOwnPropertyDescriptor(t,s):null;c&&(c.get||c.set)?Object.defineProperty(i,s,c):i[s]=t[s]}return i.default=t,r&&r.set(t,i),i}Wr=qn.vec4=OO;const FO=Ar([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:hT}=FO,dT=Ar([{name:"a_pos_3",components:3,type:"Int16"}]);var qs=Ar([{name:"a_pos",type:"Int16",components:2}]);class wm{constructor(e,r){this.pos=e,this.dir=r}intersectsPlane(e,r,i){const a=ie.dot(r,this.dir);if(Math.abs(a)<1e-6)return!1;const s=((e[0]-this.pos[0])*r[0]+(e[1]-this.pos[1])*r[1]+(e[2]-this.pos[2])*r[2])/a;return i[0]=this.pos[0]+this.dir[0]*s,i[1]=this.pos[1]+this.dir[1]*s,i[2]=this.pos[2]+this.dir[2]*s,!0}closestPointOnSphere(e,r,i){if(ie.equals(this.pos,e)||r===0)return i[0]=i[1]=i[2]=0,!1;const[a,s,c]=this.dir,u=this.pos[0]-e[0],d=this.pos[1]-e[1],p=this.pos[2]-e[2],m=a*a+s*s+c*c,_=2*(u*a+d*s+p*c),y=_*_-4*m*(u*u+d*d+p*p-r*r);if(y<0){const v=Math.max(-_/2,0),b=u+a*v,S=d+s*v,T=p+c*v,M=Math.hypot(b,S,T);return i[0]=b*r/M,i[1]=S*r/M,i[2]=T*r/M,!1}{const v=(-_-Math.sqrt(y))/(2*m);if(v<0){const b=Math.hypot(u,d,p);return i[0]=u*r/b,i[1]=d*r/b,i[2]=p*r/b,!1}return i[0]=u+a*v,i[1]=d+s*v,i[2]=p+c*v,!0}}}class lv{constructor(e,r,i,a,s){this.TL=e,this.TR=r,this.BR=i,this.BL=a,this.horizon=s}static fromInvProjectionMatrix(e,r,i){const a=[-1,1,1],s=[1,1,1],c=[1,-1,1],u=[-1,-1,1],d=ie.transformMat4(a,a,e),p=ie.transformMat4(s,s,e),m=ie.transformMat4(c,c,e),_=ie.transformMat4(u,u,e);return new lv(d,p,m,_,r/i)}}function cv(t,e,r){let i=1/0,a=-1/0;const s=[];for(const c of t){ie.sub(s,c,e);const u=ie.dot(s,r);i=Math.min(i,u),a=Math.max(a,u)}return[i,a]}function fT(t,e){let r=!0;for(let i=0;i<t.planes.length;i++){const a=t.planes[i];let s=0;for(let c=0;c<e.length;c++)s+=ie.dot(a,e[c])+a[3]>=0;if(s===0)return 0;s!==e.length&&(r=!1)}return r?2:1}function pT(t,e){for(const r of t.projections){const i=cv(e,t.points[0],r.axis);if(r.projection[1]<i[0]||r.projection[0]>i[1])return 0}return 1}class gu{constructor(e,r){this.points=e||new Array(8).fill([0,0,0]),this.planes=r||new Array(6).fill([0,0,0,0]),this.bounds=_n.fromPoints(this.points),this.projections=[];const i=[ie.sub([],this.points[2],this.points[3]),ie.sub([],this.points[0],this.points[3]),ie.sub([],this.points[4],this.points[0]),ie.sub([],this.points[5],this.points[1]),ie.sub([],this.points[6],this.points[2]),ie.sub([],this.points[7],this.points[3])];for(const a of i){const s=[0,-a[2],a[1]],c=[a[2],0,-a[0]];this.projections.push({axis:s,projection:cv(this.points,this.points[0],s)}),this.projections.push({axis:c,projection:cv(this.points,this.points[0],c)})}}static fromInvProjectionMatrix(e,r,i,a){const s=Math.pow(2,i),c=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(p=>{const m=Wr.transformMat4([],p,e),_=1/m[3]/r*s;return Wr.mul(m,m,[_,_,a?1/m[3]:_,_])}),u=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(p=>{const m=ie.sub([],c[p[0]],c[p[1]]),_=ie.sub([],c[p[2]],c[p[1]]),y=ie.normalize([],ie.cross([],m,_)),v=-ie.dot(y,c[p[1]]);return y.concat(v)}),d=[];for(let p=0;p<c.length;p++)d.push([c[p][0],c[p][1],c[p][2]]);return new gu(d,u)}}class _n{static fromPoints(e){const r=[1/0,1/0,1/0],i=[-1/0,-1/0,-1/0];for(const a of e)ie.min(r,r,a),ie.max(i,i,a);return new _n(r,i)}static applyTransform(e,r){const i=e.getCorners();for(let a=0;a<i.length;++a)ie.transformMat4(i[a],i[a],r);return _n.fromPoints(i)}static projectAabbCorners(e,r){const i=e.getCorners();for(let a=0;a<i.length;++a)ie.transformMat4(i[a],i[a],r);return i}constructor(e,r){this.min=e,this.max=r,this.center=ie.scale([],ie.add([],this.min,this.max),.5)}quadrant(e){const r=[e%2==0,e<2],i=ie.clone(this.min),a=ie.clone(this.max);for(let s=0;s<r.length;s++)i[s]=r[s]?this.min[s]:this.center[s],a[s]=r[s]?this.center[s]:this.max[s];return a[2]=this.max[2],new _n(i,a)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,r=this.max;return[[e[0],e[1],e[2]],[r[0],e[1],e[2]],[r[0],r[1],e[2]],[e[0],r[1],e[2]],[e[0],e[1],r[2]],[r[0],e[1],r[2]],[r[0],r[1],r[2]],[e[0],r[1],r[2]]]}intersects(e){return this.intersectsAabb(e.bounds)?fT(e,this.getCorners()):0}intersectsFlat(e){return this.intersectsAabb(e.bounds)?fT(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(e,r){return r||this.intersects(e)?pT(e,this.getCorners()):0}intersectsPreciseFlat(e,r){return r||this.intersectsFlat(e)?pT(e,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(e){for(let r=0;r<3;++r)if(this.min[r]>e.max[r]||e.min[r]>this.max[r])return!1;return!0}intersectsAabbXY(e){return!(this.min[0]>e.max[0]||e.min[0]>this.max[0]||this.min[1]>e.max[1]||e.min[1]>this.max[1])}encapsulate(e){for(let r=0;r<3;r++)this.min[r]=Math.min(this.min[r],e.min[r]),this.max[r]=Math.max(this.max[r],e.max[r])}encapsulatePoint(e){for(let r=0;r<3;r++)this.min[r]=Math.min(this.min[r],e[r]),this.max[r]=Math.max(this.max[r],e[r])}}ht(_n,"Aabb");const Ad=5,Zs=6,Wi=Ae/Math.PI/2,BO=16383,_u=64,uv=[_u,32,16],Do=-Wi,Lo=Wi,NO=[new _n([Do,Do,Do],[Lo,Lo,Lo]),new _n([Do,Do,Do],[0,0,Lo]),new _n([0,Do,Do],[Lo,0,Lo]),new _n([Do,0,Do],[0,Lo,Lo]),new _n([0,0,Do],[Lo,Lo,Lo])];function Em(t){return t*Wi/xu}function mT(t,e,r,i=!0){const a=ie.scale([],t._camera.position,t.worldSize),s=[e,r,1,1];Wr.transformMat4(s,s,t.pixelMatrixInverse),Wr.scale(s,s,1/s[3]);const c=ie.sub([],s,a),u=ie.normalize([],c),d=t.globeMatrix,p=[d[12],d[13],d[14]],m=ie.sub([],p,a),_=ie.length(m),y=ie.normalize([],m),v=t.worldSize/(2*Math.PI),b=ie.dot(y,u),S=Math.asin(v/_);if(S<Math.acos(b)){if(!i)return null;const H=[],J=[];ie.scale(H,u,_/b),ie.normalize(J,ie.sub(J,H,m)),ie.normalize(u,ie.add(u,m,ie.scale(u,J,Math.tan(S)*_)))}const T=[];new wm(a,u).closestPointOnSphere(p,v,T);const M=ie.normalize([],Pr(d,0)),C=ie.normalize([],Pr(d,1)),P=ie.normalize([],Pr(d,2)),k=ie.dot(M,T),z=ie.dot(C,T),L=ie.dot(P,T),B=ke(Math.asin(-z/v));let W=ke(Math.atan2(k,L));W=t.center.lng+function(H,J){const Q=(J-H+180)%360-180;return Q<-180?Q+360:Q}(t.center.lng,W);const Z=ei(W),X=ze(ai(B),0,1);return new cr(Z,X)}class jO{constructor(e,r,i){this.a=ie.sub([],e,i),this.b=ie.sub([],r,i),this.center=i;const a=ie.normalize([],this.a),s=ie.normalize([],this.b);this.angle=Math.acos(ie.dot(a,s))}}function hv(t,e){if(t.angle===0)return null;let r;return r=t.a[e]===0?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),r<0||r>1?null:function(i,a,s,c){const u=Math.sin(s);return i*(Math.sin((1-c)*s)/u)+a*(Math.sin(c*s)/u)}(t.a[e],t.b[e],t.angle,ze(r,0,1))+t.center[e]}function ea(t){if(t.z<=1)return NO[t.z+2*t.y+t.x];const e=fv(Sm(t));return _n.fromPoints(e)}function rs(t,e,r){return ie.scale(t,t,1-r),ie.scaleAndAdd(t,t,e,r)}function gT(t,e){const r=Qn(e.zoom);if(r===0)return ea(t);const i=Sm(t),a=fv(i),s=ei(i.getWest())*e.worldSize,c=ei(i.getEast())*e.worldSize,u=ai(i.getNorth())*e.worldSize,d=ai(i.getSouth())*e.worldSize,p=[s,u,0],m=[c,u,0],_=[s,d,0],y=[c,d,0],v=ge.invert([],e.globeMatrix);return ie.transformMat4(p,p,v),ie.transformMat4(m,m,v),ie.transformMat4(_,_,v),ie.transformMat4(y,y,v),a[0]=rs(a[0],_,r),a[1]=rs(a[1],y,r),a[2]=rs(a[2],m,r),a[3]=rs(a[3],p,r),_n.fromPoints(a)}function _T(t,e,r){for(const i of t)ie.transformMat4(i,i,e),ie.scale(i,i,r)}function dv(t,e,r,i){const a=e/t.worldSize,s=t.globeMatrix;if(r.z<=1){const Z=ea(r).getCorners();return _T(Z,s,a),_n.fromPoints(Z)}const c=Sm(r,i),u=fv(c);_T(u,s,a);const d=Number.MAX_VALUE,p=[-d,-d,-d],m=[d,d,d];if(c.contains(t.center)){for(const H of u)ie.min(m,m,H),ie.max(p,p,H);p[2]=0;const Z=t.point,X=[Z.x*a,Z.y*a,0];return ie.min(m,m,X),ie.max(p,p,X),new _n(m,p)}const _=[s[12]*a,s[13]*a,s[14]*a],y=c.getCenter(),v=ze(t.center.lat,-An,An),b=ze(y.lat,-An,An),S=ei(t.center.lng),T=ai(v);let M=S-ei(y.lng);const C=T-ai(b);M>.5?M-=1:M<-.5&&(M+=1);let P=0;if(Math.abs(M)>Math.abs(C))P=M>=0?1:3;else{P=C>=0?0:2;const Z=[s[4]*a,s[5]*a,s[6]*a],X=-Math.sin(se(C>=0?c.getSouth():c.getNorth()))*Wi;ie.scaleAndAdd(_,_,Z,X)}const k=u[P],z=u[(P+1)%4],L=new jO(k,z,_),B=[hv(L,0)||k[0],hv(L,1)||k[1],hv(L,2)||k[2]],W=Qn(t.zoom);if(W>0){const Z=function({x:H,y:J,z:Q},K,fe,he,_e){const oe=1/(1<<Q);let me=H*oe,ve=me+oe,Ce=J*oe,Se=Ce+oe,Je=0;const Ge=(me+ve)/2-he;return Ge>.5?Je=-1:Ge<-.5&&(Je=1),me=((me+Je)*K-(he*=K))*fe+he,ve=((ve+Je)*K-he)*fe+he,Ce=(Ce*K-(_e*=K))*fe+_e,Se=(Se*K-_e)*fe+_e,[[me,Se,0],[ve,Se,0],[ve,Ce,0],[me,Ce,0]]}(r,e,t._pixelsPerMercatorPixel,S,T);for(let H=0;H<u.length;H++)rs(u[H],Z[H],W);const X=ie.add([],Z[P],Z[(P+1)%4]);ie.scale(X,X,.5),rs(B,X,W)}for(const Z of u)ie.min(m,m,Z),ie.max(p,p,Z);return m[2]=Math.min(k[2],z[2]),ie.min(m,m,B),ie.max(p,p,B),new _n(m,p)}function Sm({x:t,y:e,z:r},i=!1){const a=1/(1<<r),s=new zt(Hi(t*a),e===(1<<r)-1&&i?-90:zn((e+1)*a)),c=new zt(Hi((t+1)*a),e===0&&i?90:zn(e*a));return new lo(s,c)}function fv(t){const e=se(t.getNorth()),r=se(t.getSouth()),i=Math.cos(e),a=Math.cos(r),s=Math.sin(e),c=Math.sin(r),u=t.getWest(),d=t.getEast();return[yu(a,c,u),yu(a,c,d),yu(i,s,d),yu(i,s,u)]}function yu(t,e,r,i=Wi){return r=se(r),[t*Math.sin(r)*i,-e*i,t*Math.cos(r)*i]}function Pi(t,e,r){return yu(Math.cos(se(t)),Math.sin(se(t)),e,r)}function Id(t,e,r,i){const a=1<<r.z,s=(t/Ae+r.x)/a;return Pi(zn((e/Ae+r.y)/a),Hi(s),i)}function Tm({min:t,max:e}){return BO/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}const yT=new Float64Array(16);function vu(t){const e=Tm(t),r=ge.fromScaling(yT,[e,e,e]);return ge.translate(r,r,ie.negate([],t.min))}function pv(t){const e=ge.fromTranslation(yT,t.min),r=1/Tm(t);return ge.scale(e,e,[r,r,r])}function mv(t){const e=Ae/(2*Math.PI);return t/(2*Math.PI)/e}function vT(t,e){return Ae/(512*Math.pow(2,t))*Tm(ea(e))}function xT(t,e,r,i,a){const s=mv(r),c=[t,e,-r/(2*Math.PI)],u=ge.identity(new Float64Array(16));return ge.translate(u,u,c),ge.scale(u,u,[s,s,s]),ge.rotateX(u,u,se(-a)),ge.rotateY(u,u,se(-i)),u}function Qn(t){return at(Ad,Zs,t)}function $O(t,e,r){const i=ge.identity(new Float64Array(16)),a=(e/(1<<t)-.5)*Math.PI*2;return ge.rotateY(i,r.globeMatrix,a),Float32Array.from(i)}function bT(t,e,r){const i=Qn(r.zoom),a=t.style.map._antialias,s=!!e.extStandardDerivatives,c=e.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return i===0&&!a&&!c&&s}function VO(t,e,r,i){const a=e.getNorth(),s=e.getSouth(),c=e.getWest(),u=e.getEast(),d=1<<t.z,p=u-c,m=a-s,_=p/_u,y=-m/uv[r],v=[0,_,0,y,0,0,a,c,0];if(t.z>0){const b=180/i;Ii.multiply(v,v,[b/p+1,0,0,0,b/m+1,0,-.5*b/_,.5*b/y,1])}return v[2]=d,v[5]=t.x,v[8]=t.y,v}function UO(t){const e=An-5;t=ze(t,-e,e)/e*90;const r=Math.pow(Math.abs(Math.sin(se(t))),3);return Math.round(r*(uv.length-1))}function wT(t){const e=[0,0,0],r=ge.identity(new Float64Array(16));return ge.multiply(r,t.pixelMatrix,t.globeMatrix),ie.transformMat4(e,e,r),new $(e[0],e[1])}function ET(t,e){const r=Pi(e.lat,e.lng),i=function(s){const c=Pi(s._center.lat,s._center.lng),u=ie.fromValues(0,1,0);let d=ie.cross([],u,c);const p=ge.fromRotation([],-s.angle,c);d=ie.transformMat4(d,d,p),ge.fromRotation(p,-s._pitch,d);const m=ie.normalize([],c);return ie.scale(m,m,Em(s.cameraToCenterDistance/s.pixelsPerMeter)),ie.transformMat4(m,m,p),ie.add([],c,m)}(t),a=ie.subtract([],i,r);return ie.angle(a,r)}function Mm(t,e){return ET(t,e)>Math.PI/2*1.01}const ST=se(85),GO=Math.cos(ST),WO=Math.sin(ST);class HO{constructor(e){this._createGrid(e),this._createPoles(e)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const e of this._poleSegments)e.destroy();for(const e of this._gridSegments)e.withSkirts.destroy(),e.withoutSkirts.destroy()}_fillGridMeshWithLods(e,r){const i=new Gi,a=new Bn,s=[],c=e+1+2,u=r[0]+1,d=r[0]+1+(1+r.length),p=(m,_,y)=>{let v=m===c-1?m-2:m===0?m:m-1;return v+=y?24575:0,[v,_]};for(let m=0;m<c;++m)i.emplaceBack(...p(m,0,!0));for(let m=0;m<u;++m)for(let _=0;_<c;++_)i.emplaceBack(...p(_,m,(_===0||_===c-1)&&!0));for(let m=0;m<r.length;++m){const _=r[m];for(let y=0;y<c;++y)i.emplaceBack(...p(y,_,!0))}for(let m=0;m<r.length;++m){const _=a.length,y=r[m]+1+2,v=new Bn;for(let T=0;T<y-1;T++){const M=T===y-2,C=M?c*(d-r.length+m-T):c;for(let P=0;P<c-1;P++){const k=T*c+P;T===0||M||P===0||P===c-2?(v.emplaceBack(k+1,k,k+C),v.emplaceBack(k+C,k+C+1,k+1)):(a.emplaceBack(k+1,k,k+C),a.emplaceBack(k+C,k+C+1,k+1))}}const b=Gr.simpleSegment(0,_,i.length,a.length-_);for(let T=0;T<v.uint16.length;T+=3)a.emplaceBack(v.uint16[T],v.uint16[T+1],v.uint16[T+2]);const S=Gr.simpleSegment(0,_,i.length,a.length-_);s.push({withoutSkirts:b,withSkirts:S})}return{vertices:i,indices:a,segments:s}}_createGrid(e){const r=this._fillGridMeshWithLods(_u,uv);this._gridSegments=r.segments,this._gridBuffer=e.createVertexBuffer(r.vertices,qs.members),this._gridIndexBuffer=e.createIndexBuffer(r.indices,!0)}_createPoles(e){const r=new Bn;for(let s=0;s<=_u;s++)r.emplaceBack(0,s+1,s+2);this._poleIndexBuffer=e.createIndexBuffer(r,!0);const i=new Sd,a=new Sd;this._poleSegments=[];for(let s=0,c=0;s<Ad;s++){const u=360/(1<<s);i.emplaceBack(0,-Wi,0,.5,0),a.emplaceBack(0,-Wi,0,.5,1);for(let d=0;d<=_u;d++){const p=d/_u,m=Ft(0,u,p),[_,y,v]=yu(GO,WO,m,Wi);i.emplaceBack(_,y,v,p,0),a.emplaceBack(_,y,v,p,1)}this._poleSegments.push(Gr.simpleSegment(c,0,66,64)),c+=66}this._poleNorthVertexBuffer=e.createVertexBuffer(i,hT,!1),this._poleSouthVertexBuffer=e.createVertexBuffer(a,hT,!1)}getGridBuffers(e,r){return[this._gridBuffer,this._gridIndexBuffer,r?this._gridSegments[e].withSkirts:this._gridSegments[e].withoutSkirts]}getPoleBuffers(e){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[e]]}}const xu=63710088e-1,gv=2*Math.PI*xu;class Xs{constructor(e,r){if(isNaN(e)||isNaN(r))throw new Error(`Invalid LngLat object: (${e}, ${r})`);if(this.lng=+e,this.lat=+r,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Xs(Pt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const r=Math.PI/180,i=this.lat*r,a=e.lat*r,s=Math.sin(i)*Math.sin(a)+Math.cos(i)*Math.cos(a)*Math.cos((e.lng-this.lng)*r);return xu*Math.acos(Math.min(s,1))}toBounds(e=0){const r=360*e/40075017,i=r/Math.cos(Math.PI/180*this.lat);return new lo(new Xs(this.lng-i,this.lat-r),new Xs(this.lng+i,this.lat+r))}toEcef(e){const r=Em(e);return Pi(this.lat,this.lng,Wi+r)}static convert(e){if(e instanceof Xs)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new Xs(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new Xs(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var zt=Xs,TT={};(function(t,e){(function(r){function i(s,c,u){var d=a(256*s,256*(c=Math.pow(2,u)-c-1),u),p=a(256*(s+1),256*(c+1),u);return d[0]+","+d[1]+","+p[0]+","+p[1]}function a(s,c,u){var d=2*Math.PI*6378137/256/Math.pow(2,u);return[s*d-2*Math.PI*6378137/2,c*d-2*Math.PI*6378137/2]}r.getURL=function(s,c,u,d,p,m){return m=m||{},s+"?"+["bbox="+i(u,d,p),"format="+(m.format||"image/png"),"service="+(m.service||"WMS"),"version="+(m.version||"1.1.1"),"request="+(m.request||"GetMap"),"srs="+(m.srs||"EPSG:3857"),"width="+(m.width||256),"height="+(m.height||256),"layers="+c].join("&")},r.getTileBBox=i,r.getMercCoords=a,Object.defineProperty(r,"__esModule",{value:!0})})(e)})(0,TT);var qO=TT;class ns{constructor(e,r,i){this.z=e,this.x=r,this.y=i,this.key=Pd(0,e,e,r,i)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,r){const i=qO.getTileBBox(this.x,this.y,this.z),a=function(s,c,u){let d,p="";for(let m=s;m>0;m--)d=1<<m-1,p+=(c&d?1:0)+(u&d?2:0);return p}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(r==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",a).replace("{bbox-epsg-3857}",i)}toString(){return`${this.z}/${this.x}/${this.y}`}}class _v{constructor(e,r){this.wrap=e,this.canonical=r,this.key=Pd(e,r.z,r.z,r.x,r.y)}}class Kr{constructor(e,r,i,a,s){this.overscaledZ=e,this.wrap=r,this.canonical=new ns(i,+a,+s),this.key=r===0&&e===i?this.canonical.key:Pd(r,e,i,a,s)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const r=this.canonical.z-e;return e>this.canonical.z?new Kr(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Kr(e,this.wrap,e,this.canonical.x>>r,this.canonical.y>>r)}calculateScaledKey(e,r=!0){if(this.overscaledZ===e&&r)return this.key;if(e>this.canonical.z)return Pd(this.wrap*+r,e,this.canonical.z,this.canonical.x,this.canonical.y);{const i=this.canonical.z-e;return Pd(this.wrap*+r,e,e,this.canonical.x>>i,this.canonical.y>>i)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const r=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>r&&e.canonical.y===this.canonical.y>>r}children(e){if(this.overscaledZ>=e)return[new Kr(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const r=this.canonical.z+1,i=2*this.canonical.x,a=2*this.canonical.y;return[new Kr(r,this.wrap,r,i,a),new Kr(r,this.wrap,r,i+1,a),new Kr(r,this.wrap,r,i,a+1),new Kr(r,this.wrap,r,i+1,a+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Kr(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Kr(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new _v(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Pd(t,e,r,i,a){const s=1<<Math.min(r,22);let c=s*(a%s)+i%s;return t&&r<22&&(c+=s*s*((t<0?-2*t-1:2*t)%(1<<2*(22-r)))),16*(32*c+r)+(e-r)}ht(ns,"CanonicalTileID"),ht(Kr,"OverscaledTileID",{omit:["projMatrix"]});const ZO=0,XO=25.5;function Cm(t){return gv*Math.cos(t*Math.PI/180)}function ei(t){return(180+t)/360}function ai(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function jr(t,e){return t/Cm(e)}function Hi(t){return 360*t-180}function zn(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function MT(t,e){return t*Cm(zn(e))}const An=85.051129;function CT(t){return Math.cos(se(ze(t,-An,An)))}function Ys(t,e){const r=ze(e,ZO,XO),i=Math.pow(2,r);return CT(t)*gv/(512*i)}function yv(t){return 1/Math.cos(t*Math.PI/180)}function kd(t,e=0){const r=Math.exp(Math.PI*(1-(t.y+e/Ae)/(1<<t.z)*2));return 80150034*r/(r*r+1)/Ae/(1<<t.z)}class cr{constructor(e,r,i=0){this.x=+e,this.y=+r,this.z=+i}static fromLngLat(e,r=0){const i=zt.convert(e);return new cr(ei(i.lng),ai(i.lat),jr(r,i.lat))}toLngLat(){return new zt(Hi(this.x),zn(this.y))}toAltitude(){return MT(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/gv*yv(zn(this.y))}}function vv(t,e,r,i,a,s,c,u,d){const p=(e+i)/2,m=(r+a)/2,_=new $(p,m);u(_),function(y,v,b,S,T,M){const C=b-T,P=S-M;return Math.abs((S-v)*C-(b-y)*P)/Math.hypot(C,P)}(_.x,_.y,s.x,s.y,c.x,c.y)>=d?(vv(t,e,r,p,m,s,_,u,d),vv(t,p,m,i,a,_,c,u,d)):t.push(c)}function AT(t,e,r){let i=t[0],a=i.x,s=i.y;e(i);const c=[i];for(let u=1;u<t.length;u++){const d=t[u],{x:p,y:m}=d;e(d),vv(c,a,s,p,m,i,d,e,r),a=p,s=m,i=d}return c}function xv(t,e,r,i){if(i(e,r)){const a=e.add(r)._mult(.5);xv(t,e,a,i),xv(t,a,r,i)}else t.push(r)}function YO(t,e){let r=t[0];const i=[r];for(let a=1;a<t.length;a++){const s=t[a];xv(i,r,s,e),r=s}return i}const bv=Math.pow(2,14)-1,IT=-bv-1;function KO(t,e){const r=Math.round(t.x*e),i=Math.round(t.y*e);return t.x=ze(r,IT,bv),t.y=ze(i,IT,bv),(r<t.x||r>t.x+1||i<t.y||i>t.y+1)&&re("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function Pa(t,e,r){const i=t.loadGeometry(),a=t.extent,s=Ae/a;if(e&&r&&r.projection.isReprojectedInTileSpace){const c=1<<e.z,{scale:u,x:d,y:p,projection:m}=r,_=y=>{const v=Hi((e.x+y.x/a)/c),b=zn((e.y+y.y/a)/c),S=m.project(v,b);y.x=(S.x*u-d)*a,y.y=(S.y*u-p)*a};for(let y=0;y<i.length;y++)if(t.type!==1)i[y]=AT(i[y],_,1);else{const v=[];for(const b of i[y])b.x<0||b.x>=a||b.y<0||b.y>=a||(_(b),v.push(b));i[y]=v}}for(const c of i)for(const u of c)KO(u,s);return i}function Ks(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Pa(t):[]}}function Am(t,e,r,i,a){t.emplaceBack(2*e+(i+1)/2,2*r+(a+1)/2)}function Im(t,e,r){t.emplaceBack(e.x,e.y,e.z,r[0]*16384,r[1]*16384,r[2]*16384)}class wv{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Gi,this.indexArray=new Bn,this.segments=new Gr,this.programConfigurations=new Ws(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,i,a){const s=this.layers[0],c=[];let u=null;s.type==="circle"&&(u=s.layout.get("circle-sort-key"));for(const{feature:p,id:m,index:_,sourceLayerIndex:y}of e){const v=this.layers[0]._featureFilter.needGeometry,b=Ks(p,v);if(!this.layers[0]._featureFilter.filter(new mn(this.zoom),b,i))continue;const S=u?u.evaluate(b,{},i):void 0,T={id:m,properties:p.properties,type:p.type,sourceLayerIndex:y,index:_,geometry:v?b.geometry:Pa(p,i,a),patterns:{},sortKey:S};c.push(T)}u&&c.sort((p,m)=>p.sortKey-m.sortKey);let d=null;a.projection.name==="globe"&&(this.globeExtVertexArray=new dm,d=a.projection);for(const p of c){const{geometry:m,index:_,sourceLayerIndex:y}=p,v=e[_].feature;this.addFeature(p,m,_,r.availableImages,i,d,r.brightness),r.featureIndex.insert(v,m,_,y,this.index)}}update(e,r,i,a,s){const c=Object.keys(e).length!==0;c&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,r,c?this.stateDependentLayers:this.layers,i,a,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,gO.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,_O.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,r,i,a,s,c,u){for(const d of r)for(const p of d){const m=p.x,_=p.y;if(m<0||m>=Ae||_<0||_>=Ae)continue;if(c){const b=c.projectTilePoint(m,_,s),S=c.upVector(s,m,_),T=this.globeExtVertexArray;Im(T,b,S),Im(T,b,S),Im(T,b,S),Im(T,b,S)}const y=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),v=y.vertexLength;Am(this.layoutVertexArray,m,_,-1,-1),Am(this.layoutVertexArray,m,_,1,-1),Am(this.layoutVertexArray,m,_,1,1),Am(this.layoutVertexArray,m,_,-1,1),this.indexArray.emplaceBack(v,v+1,v+2),this.indexArray.emplaceBack(v,v+2,v+3),y.vertexLength+=4,y.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,{},a,s,u)}}function PT(t,e){for(let r=0;r<t.length;r++)if(Js(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(Js(t,e[r]))return!0;return!!Ev(t,e)}function JO(t,e,r){return!!Js(t,e)||!!Sv(e,t,r)}function kT(t,e){if(t.length===1)return zT(e,t[0]);for(let r=0;r<e.length;r++){const i=e[r];for(let a=0;a<i.length;a++)if(Js(t,i[a]))return!0}for(let r=0;r<t.length;r++)if(zT(e,t[r]))return!0;for(let r=0;r<e.length;r++)if(Ev(t,e[r]))return!0;return!1}function QO(t,e,r){if(t.length>1){if(Ev(t,e))return!0;for(let i=0;i<e.length;i++)if(Sv(e[i],t,r))return!0}for(let i=0;i<t.length;i++)if(Sv(t[i],e,r))return!0;return!1}function Ev(t,e){if(t.length===0||e.length===0)return!1;for(let r=0;r<t.length-1;r++){const i=t[r],a=t[r+1];for(let s=0;s<e.length-1;s++)if(eF(i,a,e[s],e[s+1]))return!0}return!1}function eF(t,e,r,i){return we(t,r,i)!==we(e,r,i)&&we(t,e,r)!==we(t,e,i)}function Sv(t,e,r){const i=r*r;if(e.length===1)return t.distSqr(e[0])<i;for(let a=1;a<e.length;a++)if(RT(t,e[a-1],e[a])<i)return!0;return!1}function RT(t,e,r){const i=e.distSqr(r);if(i===0)return t.distSqr(e);const a=((t.x-e.x)*(r.x-e.x)+(t.y-e.y)*(r.y-e.y))/i;return t.distSqr(a<0?e:a>1?r:r.sub(e)._mult(a)._add(e))}function zT(t,e){let r,i,a,s=!1;for(let c=0;c<t.length;c++){r=t[c];for(let u=0,d=r.length-1;u<r.length;d=u++)i=r[u],a=r[d],i.y>e.y!=a.y>e.y&&e.x<(a.x-i.x)*(e.y-i.y)/(a.y-i.y)+i.x&&(s=!s)}return s}function Js(t,e){let r=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const s=t[i],c=t[a];s.y>e.y!=c.y>e.y&&e.x<(c.x-s.x)*(e.y-s.y)/(c.y-s.y)+s.x&&(r=!r)}return r}function DT(t,e,r,i,a){for(const c of t)if(e<=c.x&&r<=c.y&&i>=c.x&&a>=c.y)return!0;const s=[new $(e,r),new $(e,a),new $(i,a),new $(i,r)];if(t.length>2){for(const c of s)if(Js(t,c))return!0}for(let c=0;c<t.length-1;c++)if(tF(t[c],t[c+1],s))return!0;return!1}function tF(t,e,r){const i=r[0],a=r[2];if(t.x<i.x&&e.x<i.x||t.x>a.x&&e.x>a.x||t.y<i.y&&e.y<i.y||t.y>a.y&&e.y>a.y)return!1;const s=we(t,e,r[0]);return s!==we(t,e,r[1])||s!==we(t,e,r[2])||s!==we(t,e,r[3])}function bu(t,e,r,i,a,s){let c=e.y-t.y,u=t.x-e.x;if(s=s||0){const d=c*c+u*u;if(d===0)return!0;const p=Math.sqrt(d);c/=p,u/=p}return!((r.x-t.x)*c+(r.y-t.y)*u-s<0||(i.x-t.x)*c+(i.y-t.y)*u-s<0||(a.x-t.x)*c+(a.y-t.y)*u-s<0)}function Tv(t,e,r,i,a,s,c){return!(bu(t,e,i,a,s,c)||bu(e,r,i,a,s,c)||bu(r,t,i,a,s,c)||bu(i,a,t,e,r,c)||bu(a,s,t,e,r,c)||bu(s,i,t,e,r,c))}function wu(t,e,r){const i=e.paint.get(t).value;return i.kind==="constant"?i.value:r.programConfigurations.get(e.id).getMaxValue(t)}function Pm(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function LT(t,e,r,i,a){if(!e[0]&&!e[1])return t;const s=$.convert(e)._mult(a);r==="viewport"&&s._rotate(-i);const c=[];for(let u=0;u<t.length;u++)c.push(t[u].sub(s));return c}function OT(t,e,r,i){const a=$.convert(t)._mult(i);return e==="viewport"&&a._rotate(-r),a}ht(wv,"CircleBucket",{omit:["layers"]});const rF=new gn({"circle-sort-key":new St(pe.layout_circle["circle-sort-key"]),visibility:new Ke(pe.layout_circle.visibility)});var nF={paint:new gn({"circle-radius":new St(pe.paint_circle["circle-radius"]),"circle-color":new St(pe.paint_circle["circle-color"]),"circle-blur":new St(pe.paint_circle["circle-blur"]),"circle-opacity":new St(pe.paint_circle["circle-opacity"]),"circle-translate":new Ke(pe.paint_circle["circle-translate"]),"circle-translate-anchor":new Ke(pe.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Ke(pe.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Ke(pe.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new St(pe.paint_circle["circle-stroke-width"]),"circle-stroke-color":new St(pe.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new St(pe.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Ke(pe.paint_circle["circle-emissive-strength"])}),layout:rF};function FT(t,e,r,i,a,s,c,u,d){if(s&&t.queryGeometry.isAboveHorizon)return!1;s&&(d*=t.pixelToTileUnitsFactor);const p=t.tileID.canonical,m=r.projection.upVectorScale(p,r.center.lat,r.worldSize).metersToTile;for(const _ of e)for(const y of _){const v=y.add(u),b=a&&r.elevation?r.elevation.exaggeration()*a.getElevationAt(v.x,v.y,!0):0,S=r.projection.projectTilePoint(v.x,v.y,p);if(b>0){const P=r.projection.upVector(p,v.x,v.y);S.x+=P[0]*m*b,S.y+=P[1]*m*b,S.z+=P[2]*m*b}const T=s?v:iF(S.x,S.y,S.z,i),M=s?t.tilespaceRays.map(P=>aF(P,b)):t.queryGeometry.screenGeometry,C=Wr.transformMat4([],[S.x,S.y,S.z,1],i);if(!c&&s?d*=C[3]/r.cameraToCenterDistance:c&&!s&&(d*=r.cameraToCenterDistance/C[3]),s){const P=zn((y.y/Ae+p.y)/(1<<p.z));d/=r.projection.pixelsPerMeter(P,1)/jr(1,P)}if(JO(M,T,d))return!0}return!1}function iF(t,e,r,i){const a=Wr.transformMat4([],[t,e,r,1],i);return new $(a[0]/a[3],a[1]/a[3])}const BT=ie.fromValues(0,0,0),oF=ie.fromValues(0,0,1);function aF(t,e){const r=ie.create();return BT[2]=e,t.intersectsPlane(BT,oF,r),new $(r[0],r[1])}class NT extends wv{}function jT(t,{width:e,height:r},i,a){if(a){if(a instanceof Uint8ClampedArray)a=new Uint8Array(a.buffer);else if(a.length!==e*r*i)throw new RangeError("mismatched image size")}else a=new Uint8Array(e*r*i);return t.width=e,t.height=r,t.data=a,t}function $T(t,e,r){const{width:i,height:a}=e;i===t.width&&a===t.height||(Mv(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,i),height:Math.min(t.height,a)},r),t.width=i,t.height=a,t.data=e.data)}function Mv(t,e,r,i,a,s){if(a.width===0||a.height===0)return e;if(a.width>t.width||a.height>t.height||r.x>t.width-a.width||r.y>t.height-a.height)throw new RangeError("out of range source coordinates for image copy");if(a.width>e.width||a.height>e.height||i.x>e.width-a.width||i.y>e.height-a.height)throw new RangeError("out of range destination coordinates for image copy");const c=t.data,u=e.data;for(let d=0;d<a.height;d++){const p=((r.y+d)*t.width+r.x)*s,m=((i.y+d)*e.width+i.x)*s;for(let _=0;_<a.width*s;_++)u[m+_]=c[p+_]}return e}ht(NT,"HeatmapBucket",{omit:["layers"]});class is{constructor(e,r){jT(this,e,1,r)}resize(e){$T(this,new is(e),1)}clone(){return new is({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,i,a,s){Mv(e,r,i,a,s,1)}}class Sn{constructor(e,r){jT(this,e,4,r)}resize(e){$T(this,new Sn(e),4)}replace(e,r){r?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Sn({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,r,i,a,s){Mv(e,r,i,a,s,4)}}ht(is,"AlphaImage"),ht(Sn,"RGBAImage");const sF=new gn({visibility:new Ke(pe.layout_heatmap.visibility)});var lF={paint:new gn({"heatmap-radius":new St(pe.paint_heatmap["heatmap-radius"]),"heatmap-weight":new St(pe.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Ke(pe.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Ed(pe.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Ke(pe.paint_heatmap["heatmap-opacity"])}),layout:sF};function km(t){const e={},r=t.resolution||256,i=t.clips?t.clips.length:1,a=t.image||new Sn({width:r,height:i}),s=(c,u,d)=>{e[t.evaluationKey]=d;const p=t.expression.evaluate(e);a.data[c+u+0]=Math.floor(255*p.r/p.a),a.data[c+u+1]=Math.floor(255*p.g/p.a),a.data[c+u+2]=Math.floor(255*p.b/p.a),a.data[c+u+3]=Math.floor(255*p.a)};if(t.clips)for(let c=0,u=0;c<i;++c,u+=4*r)for(let d=0,p=0;d<r;d++,p+=4){const m=d/(r-1),{start:_,end:y}=t.clips[c];s(u,p,_*(1-m)+y*m)}else for(let c=0,u=0;c<r;c++,u+=4)s(0,u,c/(r-1));return a}const cF=new gn({visibility:new Ke(pe.layout_hillshade.visibility)});var uF={paint:new gn({"hillshade-illumination-direction":new Ke(pe.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Ke(pe.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Ke(pe.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Ke(pe.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Ke(pe.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Ke(pe.paint_hillshade["hillshade-accent-color"])}),layout:cF};const hF=Ar([{name:"a_pos",components:2,type:"Int16"}],4),{members:dF}=hF;var Cv={exports:{}};function Rm(t,e,r){r=r||2;var i,a,s,c,u,d,p,m=e&&e.length,_=m?e[0]*r:t.length,y=VT(t,0,_,r,!0),v=[];if(!y||y.next===y.prev)return v;if(m&&(y=function(S,T,M,C){var P,k,z,L=[];for(P=0,k=T.length;P<k;P++)(z=VT(S,T[P]*C,P<k-1?T[P+1]*C:S.length,C,!1))===z.next&&(z.steiner=!0),L.push(xF(z));for(L.sort(_F),P=0;P<L.length;P++)M=yF(L[P],M);return M}(t,e,y,r)),t.length>80*r){i=s=t[0],a=c=t[1];for(var b=r;b<_;b+=r)(u=t[b])<i&&(i=u),(d=t[b+1])<a&&(a=d),u>s&&(s=u),d>c&&(c=d);p=(p=Math.max(s-i,c-a))!==0?32767/p:0}return Rd(y,v,r,i,a,p,0),v}function VT(t,e,r,i,a){var s,c;if(a===Pv(t,e,r,i)>0)for(s=e;s<r;s+=i)c=WT(s,t[s],t[s+1],c);else for(s=r-i;s>=e;s-=i)c=WT(s,t[s],t[s+1],c);return c&&zm(c,c.next)&&(Dd(c),c=c.next),c}function nc(t,e){if(!t)return t;e||(e=t);var r,i=t;do if(r=!1,i.steiner||!zm(i,i.next)&&Nn(i.prev,i,i.next)!==0)i=i.next;else{if(Dd(i),(i=e=i.prev)===i.next)break;r=!0}while(r||i!==e);return e}function Rd(t,e,r,i,a,s,c){if(t){!c&&s&&function(m,_,y,v){var b=m;do b.z===0&&(b.z=Av(b.x,b.y,_,y,v)),b.prevZ=b.prev,b.nextZ=b.next,b=b.next;while(b!==m);b.prevZ.nextZ=null,b.prevZ=null,function(S){var T,M,C,P,k,z,L,B,W=1;do{for(M=S,S=null,k=null,z=0;M;){for(z++,C=M,L=0,T=0;T<W&&(L++,C=C.nextZ);T++);for(B=W;L>0||B>0&&C;)L!==0&&(B===0||!C||M.z<=C.z)?(P=M,M=M.nextZ,L--):(P=C,C=C.nextZ,B--),k?k.nextZ=P:S=P,P.prevZ=k,k=P;M=C}k.nextZ=null,W*=2}while(z>1)}(b)}(t,i,a,s);for(var u,d,p=t;t.prev!==t.next;)if(u=t.prev,d=t.next,s?pF(t,i,a,s):fF(t))e.push(u.i/r|0),e.push(t.i/r|0),e.push(d.i/r|0),Dd(t),t=d.next,p=d.next;else if((t=d)===p){c?c===1?Rd(t=mF(nc(t),e,r),e,r,i,a,s,2):c===2&&gF(t,e,r,i,a,s):Rd(nc(t),e,r,i,a,s,1);break}}}function fF(t){var e=t.prev,r=t,i=t.next;if(Nn(e,r,i)>=0)return!1;for(var a=e.x,s=r.x,c=i.x,u=e.y,d=r.y,p=i.y,m=a<s?a<c?a:c:s<c?s:c,_=u<d?u<p?u:p:d<p?d:p,y=a>s?a>c?a:c:s>c?s:c,v=u>d?u>p?u:p:d>p?d:p,b=i.next;b!==e;){if(b.x>=m&&b.x<=y&&b.y>=_&&b.y<=v&&Eu(a,u,s,d,c,p,b.x,b.y)&&Nn(b.prev,b,b.next)>=0)return!1;b=b.next}return!0}function pF(t,e,r,i){var a=t.prev,s=t,c=t.next;if(Nn(a,s,c)>=0)return!1;for(var u=a.x,d=s.x,p=c.x,m=a.y,_=s.y,y=c.y,v=u<d?u<p?u:p:d<p?d:p,b=m<_?m<y?m:y:_<y?_:y,S=u>d?u>p?u:p:d>p?d:p,T=m>_?m>y?m:y:_>y?_:y,M=Av(v,b,e,r,i),C=Av(S,T,e,r,i),P=t.prevZ,k=t.nextZ;P&&P.z>=M&&k&&k.z<=C;){if(P.x>=v&&P.x<=S&&P.y>=b&&P.y<=T&&P!==a&&P!==c&&Eu(u,m,d,_,p,y,P.x,P.y)&&Nn(P.prev,P,P.next)>=0||(P=P.prevZ,k.x>=v&&k.x<=S&&k.y>=b&&k.y<=T&&k!==a&&k!==c&&Eu(u,m,d,_,p,y,k.x,k.y)&&Nn(k.prev,k,k.next)>=0))return!1;k=k.nextZ}for(;P&&P.z>=M;){if(P.x>=v&&P.x<=S&&P.y>=b&&P.y<=T&&P!==a&&P!==c&&Eu(u,m,d,_,p,y,P.x,P.y)&&Nn(P.prev,P,P.next)>=0)return!1;P=P.prevZ}for(;k&&k.z<=C;){if(k.x>=v&&k.x<=S&&k.y>=b&&k.y<=T&&k!==a&&k!==c&&Eu(u,m,d,_,p,y,k.x,k.y)&&Nn(k.prev,k,k.next)>=0)return!1;k=k.nextZ}return!0}function mF(t,e,r){var i=t;do{var a=i.prev,s=i.next.next;!zm(a,s)&&UT(a,i,i.next,s)&&zd(a,s)&&zd(s,a)&&(e.push(a.i/r|0),e.push(i.i/r|0),e.push(s.i/r|0),Dd(i),Dd(i.next),i=t=s),i=i.next}while(i!==t);return nc(i)}function gF(t,e,r,i,a,s){var c=t;do{for(var u=c.next.next;u!==c.prev;){if(c.i!==u.i&&bF(c,u)){var d=GT(c,u);return c=nc(c,c.next),d=nc(d,d.next),Rd(c,e,r,i,a,s,0),void Rd(d,e,r,i,a,s,0)}u=u.next}c=c.next}while(c!==t)}function _F(t,e){return t.x-e.x}function yF(t,e){var r=function(a,s){var c,u=s,d=a.x,p=a.y,m=-1/0;do{if(p<=u.y&&p>=u.next.y&&u.next.y!==u.y){var _=u.x+(p-u.y)*(u.next.x-u.x)/(u.next.y-u.y);if(_<=d&&_>m&&(m=_,c=u.x<u.next.x?u:u.next,_===d))return c}u=u.next}while(u!==s);if(!c)return null;var y,v=c,b=c.x,S=c.y,T=1/0;u=c;do d>=u.x&&u.x>=b&&d!==u.x&&Eu(p<S?d:m,p,b,S,p<S?m:d,p,u.x,u.y)&&(y=Math.abs(p-u.y)/(d-u.x),zd(u,a)&&(y<T||y===T&&(u.x>c.x||u.x===c.x&&vF(c,u)))&&(c=u,T=y)),u=u.next;while(u!==v);return c}(t,e);if(!r)return e;var i=GT(r,t);return nc(i,i.next),nc(r,r.next)}function vF(t,e){return Nn(t.prev,t,e.prev)<0&&Nn(e.next,t,t.next)<0}function Av(t,e,r,i,a){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-r)*a|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*a|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function xF(t){var e=t,r=t;do(e.x<r.x||e.x===r.x&&e.y<r.y)&&(r=e),e=e.next;while(e!==t);return r}function Eu(t,e,r,i,a,s,c,u){return(a-c)*(e-u)>=(t-c)*(s-u)&&(t-c)*(i-u)>=(r-c)*(e-u)&&(r-c)*(s-u)>=(a-c)*(i-u)}function bF(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(r,i){var a=r;do{if(a.i!==r.i&&a.next.i!==r.i&&a.i!==i.i&&a.next.i!==i.i&&UT(a,a.next,r,i))return!0;a=a.next}while(a!==r);return!1}(t,e)&&(zd(t,e)&&zd(e,t)&&function(r,i){var a=r,s=!1,c=(r.x+i.x)/2,u=(r.y+i.y)/2;do a.y>u!=a.next.y>u&&a.next.y!==a.y&&c<(a.next.x-a.x)*(u-a.y)/(a.next.y-a.y)+a.x&&(s=!s),a=a.next;while(a!==r);return s}(t,e)&&(Nn(t.prev,t,e.prev)||Nn(t,e.prev,e))||zm(t,e)&&Nn(t.prev,t,t.next)>0&&Nn(e.prev,e,e.next)>0)}function Nn(t,e,r){return(e.y-t.y)*(r.x-e.x)-(e.x-t.x)*(r.y-e.y)}function zm(t,e){return t.x===e.x&&t.y===e.y}function UT(t,e,r,i){var a=Lm(Nn(t,e,r)),s=Lm(Nn(t,e,i)),c=Lm(Nn(r,i,t)),u=Lm(Nn(r,i,e));return a!==s&&c!==u||!(a!==0||!Dm(t,r,e))||!(s!==0||!Dm(t,i,e))||!(c!==0||!Dm(r,t,i))||!(u!==0||!Dm(r,e,i))}function Dm(t,e,r){return e.x<=Math.max(t.x,r.x)&&e.x>=Math.min(t.x,r.x)&&e.y<=Math.max(t.y,r.y)&&e.y>=Math.min(t.y,r.y)}function Lm(t){return t>0?1:t<0?-1:0}function zd(t,e){return Nn(t.prev,t,t.next)<0?Nn(t,e,t.next)>=0&&Nn(t,t.prev,e)>=0:Nn(t,e,t.prev)<0||Nn(t,t.next,e)<0}function GT(t,e){var r=new Iv(t.i,t.x,t.y),i=new Iv(e.i,e.x,e.y),a=t.next,s=e.prev;return t.next=e,e.prev=t,r.next=a,a.prev=r,i.next=r,r.prev=i,s.next=i,i.prev=s,i}function WT(t,e,r,i){var a=new Iv(t,e,r);return i?(a.next=i.next,a.prev=i,i.next.prev=a,i.next=a):(a.prev=a,a.next=a),a}function Dd(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Iv(t,e,r){this.i=t,this.x=e,this.y=r,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Pv(t,e,r,i){for(var a=0,s=e,c=r-i;s<r;s+=i)a+=(t[c]-t[s])*(t[s+1]+t[c+1]),c=s;return a}Cv.exports=Rm,Cv.exports.default=Rm,Rm.deviation=function(t,e,r,i){var a=e&&e.length,s=Math.abs(Pv(t,0,a?e[0]*r:t.length,r));if(a)for(var c=0,u=e.length;c<u;c++)s-=Math.abs(Pv(t,e[c]*r,c<u-1?e[c+1]*r:t.length,r));var d=0;for(c=0;c<i.length;c+=3){var p=i[c]*r,m=i[c+1]*r,_=i[c+2]*r;d+=Math.abs((t[p]-t[_])*(t[m+1]-t[p+1])-(t[p]-t[m])*(t[_+1]-t[p+1]))}return s===0&&d===0?0:Math.abs((d-s)/s)},Rm.flatten=function(t){for(var e=t[0][0].length,r={vertices:[],holes:[],dimensions:e},i=0,a=0;a<t.length;a++){for(var s=0;s<t[a].length;s++)for(var c=0;c<e;c++)r.vertices.push(t[a][s][c]);a>0&&r.holes.push(i+=t[a-1].length)}return r};var Om=V(Cv.exports);function kv(t,e){const r=t.length;if(r<=1)return[t];const i=[];let a,s;for(let c=0;c<r;c++){const u=Ie(t[c]);u!==0&&(t[c].area=Math.abs(u),s===void 0&&(s=u<0),s===u<0?(a&&i.push(a),a=[t[c]]):a.push(t[c]))}if(a&&i.push(a),e>1)for(let c=0;c<i.length;c++)i[c].length<=e||(oL(i[c],e,1,i[c].length-1,wF),i[c]=i[c].slice(0,e));return i}function wF(t,e){return e.area-t.area}function Rv(t,e,r){const i=r.patternDependencies;let a=!1;for(const s of e){const c=s.paint.get(`${t}-pattern`);c.isConstant()||(a=!0);const u=c.constantOr(null);u&&(a=!0,i[u]=!0)}return a}function zv(t,e,r,i,a){const s=a.patternDependencies;for(const c of e){const u=c.paint.get(`${t}-pattern`).value;if(u.kind!=="constant"){let d=u.evaluate({zoom:i},r,{},a.availableImages);d=d&&d.name?d.name:d,s[d]=!0,r.patterns[c.id]=d}}return r}class Fm{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Gi,this.indexArray=new Bn,this.indexArray2=new $s,this.programConfigurations=new Ws(e.layers,e.zoom),this.segments=new Gr,this.segments2=new Gr,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.projection=e.projection}populate(e,r,i,a){this.hasPattern=Rv("fill",this.layers,r);const s=this.layers[0].layout.get("fill-sort-key"),c=[];for(const{feature:u,id:d,index:p,sourceLayerIndex:m}of e){const _=this.layers[0]._featureFilter.needGeometry,y=Ks(u,_);if(!this.layers[0]._featureFilter.filter(new mn(this.zoom),y,i))continue;const v=s?s.evaluate(y,{},i,r.availableImages):void 0,b={id:d,properties:u.properties,type:u.type,sourceLayerIndex:m,index:p,geometry:_?y.geometry:Pa(u,i,a),patterns:{},sortKey:v};c.push(b)}s&&c.sort((u,d)=>u.sortKey-d.sortKey);for(const u of c){const{geometry:d,index:p,sourceLayerIndex:m}=u;if(this.hasPattern){const _=zv("fill",this.layers,u,this.zoom,r);this.patternFeatures.push(_)}else this.addFeature(u,d,p,i,{},r.availableImages,r.brightness);r.featureIndex.insert(e[p].feature,d,p,m,this.index)}}update(e,r,i,a,s){const c=Object.keys(e).length!==0;c&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,r,c?this.stateDependentLayers:this.layers,i,a,s)}addFeatures(e,r,i,a,s,c){for(const u of this.patternFeatures)this.addFeature(u,u.geometry,u.index,r,i,a,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,dF),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,r,i,a,s,c=[],u){for(const d of kv(r,500)){let p=0;for(const S of d)p+=S.length;const m=this.segments.prepareSegment(p,this.layoutVertexArray,this.indexArray),_=m.vertexLength,y=[],v=[];for(const S of d){if(S.length===0)continue;S!==d[0]&&v.push(y.length/2);const T=this.segments2.prepareSegment(S.length,this.layoutVertexArray,this.indexArray2),M=T.vertexLength;this.layoutVertexArray.emplaceBack(S[0].x,S[0].y),this.indexArray2.emplaceBack(M+S.length-1,M),y.push(S[0].x),y.push(S[0].y);for(let C=1;C<S.length;C++)this.layoutVertexArray.emplaceBack(S[C].x,S[C].y),this.indexArray2.emplaceBack(M+C-1,M+C),y.push(S[C].x),y.push(S[C].y);T.vertexLength+=S.length,T.primitiveLength+=S.length}const b=Om(y,v);for(let S=0;S<b.length;S+=3)this.indexArray.emplaceBack(_+b[S],_+b[S+1],_+b[S+2]);m.vertexLength+=p,m.primitiveLength+=b.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,s,c,a,u)}}ht(Fm,"FillBucket",{omit:["layers","patternFeatures"]});const EF=new gn({"fill-sort-key":new St(pe.layout_fill["fill-sort-key"]),visibility:new Ke(pe.layout_fill.visibility)});var SF={paint:new gn({"fill-antialias":new Ke(pe.paint_fill["fill-antialias"]),"fill-opacity":new St(pe.paint_fill["fill-opacity"]),"fill-color":new St(pe.paint_fill["fill-color"]),"fill-outline-color":new St(pe.paint_fill["fill-outline-color"]),"fill-translate":new Ke(pe.paint_fill["fill-translate"]),"fill-translate-anchor":new Ke(pe.paint_fill["fill-translate-anchor"]),"fill-pattern":new St(pe.paint_fill["fill-pattern"]),"fill-emissive-strength":new Ke(pe.paint_fill["fill-emissive-strength"])}),layout:EF};const TF=Ar([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),MF=Ar([{name:"a_pos_end",components:4,type:"Int16"}]),CF=Ar([{name:"a_centroid_pos",components:2,type:"Uint16"}]),AF=Ar([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),IF=Ar([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:PF}=TF;var Bm={},kF=ne,HT=Su;function Su(t,e,r,i,a){this.properties={},this.extent=r,this.type=0,this._pbf=t,this._geometry=-1,this._keys=i,this._values=a,t.readFields(RF,this,e)}function RF(t,e,r){t==1?e.id=r.readVarint():t==2?function(i,a){for(var s=i.readVarint()+i.pos;i.pos<s;){var c=a._keys[i.readVarint()],u=a._values[i.readVarint()];a.properties[c]=u}}(r,e):t==3?e.type=r.readVarint():t==4&&(e._geometry=r.pos)}function zF(t){for(var e,r,i=0,a=0,s=t.length,c=s-1;a<s;c=a++)i+=((r=t[c]).x-(e=t[a]).x)*(e.y+r.y);return i}Su.types=["Unknown","Point","LineString","Polygon"],Su.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,r=t.readVarint()+t.pos,i=1,a=0,s=0,c=0,u=[];t.pos<r;){if(a<=0){var d=t.readVarint();i=7&d,a=d>>3}if(a--,i===1||i===2)s+=t.readSVarint(),c+=t.readSVarint(),i===1&&(e&&u.push(e),e=[]),e.push(new kF(s,c));else{if(i!==7)throw new Error("unknown command "+i);e&&e.push(e[0].clone())}}return e&&u.push(e),u},Su.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,r=1,i=0,a=0,s=0,c=1/0,u=-1/0,d=1/0,p=-1/0;t.pos<e;){if(i<=0){var m=t.readVarint();r=7&m,i=m>>3}if(i--,r===1||r===2)(a+=t.readSVarint())<c&&(c=a),a>u&&(u=a),(s+=t.readSVarint())<d&&(d=s),s>p&&(p=s);else if(r!==7)throw new Error("unknown command "+r)}return[c,d,u,p]},Su.prototype.toGeoJSON=function(t,e,r){var i,a,s=this.extent*Math.pow(2,r),c=this.extent*t,u=this.extent*e,d=this.loadGeometry(),p=Su.types[this.type];function m(v){for(var b=0;b<v.length;b++){var S=v[b];v[b]=[360*(S.x+c)/s-180,360/Math.PI*Math.atan(Math.exp((180-360*(S.y+u)/s)*Math.PI/180))-90]}}switch(this.type){case 1:var _=[];for(i=0;i<d.length;i++)_[i]=d[i][0];m(d=_);break;case 2:for(i=0;i<d.length;i++)m(d[i]);break;case 3:for(d=function(v){var b=v.length;if(b<=1)return[v];for(var S,T,M=[],C=0;C<b;C++){var P=zF(v[C]);P!==0&&(T===void 0&&(T=P<0),T===P<0?(S&&M.push(S),S=[v[C]]):S.push(v[C]))}return S&&M.push(S),M}(d),i=0;i<d.length;i++)for(a=0;a<d[i].length;a++)m(d[i][a])}d.length===1?d=d[0]:p="Multi"+p;var y={type:"Feature",geometry:{type:p,coordinates:d},properties:this.properties};return"id"in this&&(y.id=this.id),y};var DF=HT,qT=ZT;function ZT(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(LF,this,e),this.length=this._features.length}function LF(t,e,r){t===15?e.version=r.readVarint():t===1?e.name=r.readString():t===5?e.extent=r.readVarint():t===2?e._features.push(r.pos):t===3?e._keys.push(r.readString()):t===4&&e._values.push(function(i){for(var a=null,s=i.readVarint()+i.pos;i.pos<s;){var c=i.readVarint()>>3;a=c===1?i.readString():c===2?i.readFloat():c===3?i.readDouble():c===4?i.readVarint64():c===5?i.readVarint():c===6?i.readSVarint():c===7?i.readBoolean():null}return a}(r))}ZT.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new DF(this._pbf,e,this.extent,this._keys,this._values)};var OF=qT;function FF(t,e,r){if(t===3){var i=new OF(r,r.readVarint()+r.pos);i.length&&(e[i.name]=i)}}var Dv=Bm.VectorTile=function(t,e){this.layers=t.readFields(FF,{},e)},Nm=Bm.VectorTileFeature=HT;function jm(t,e,r,i){const a=[],s=i===0?(c,u,d,p,m,_)=>{c.push(new $(_,d+(_-u)/(p-u)*(m-d)))}:(c,u,d,p,m,_)=>{c.push(new $(u+(_-d)/(m-d)*(p-u),_))};for(const c of t){const u=[];for(const d of c){if(d.length<=2)continue;const p=[];for(let y=0;y<d.length-1;y++){const v=d[y].x,b=d[y].y,S=d[y+1].x,T=d[y+1].y,M=i===0?v:b,C=i===0?S:T;M<e?C>e&&s(p,v,b,S,T,e):M>r?C<r&&s(p,v,b,S,T,r):p.push(d[y]),C<e&&M>=e&&s(p,v,b,S,T,e),C>r&&M<=r&&s(p,v,b,S,T,r)}let m=d[d.length-1];const _=i===0?m.x:m.y;_>=e&&_<=r&&p.push(m),p.length&&(m=p[p.length-1],p[0].x===m.x&&p[0].y===m.y||p.push(p[0]),u.push(p))}u.length&&a.push(u)}return a}Bm.VectorTileLayer=qT;class XT{constructor(e){this._stringToNumber={},this._numberToString=[];for(let r=0;r<e.length;r++){const i=e[r];this._stringToNumber[i]=r,this._numberToString[r]=i}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}var BF={read:function(t,e,r,i,a){var s,c,u=8*a-i-1,d=(1<<u)-1,p=d>>1,m=-7,_=r?a-1:0,y=r?-1:1,v=t[e+_];for(_+=y,s=v&(1<<-m)-1,v>>=-m,m+=u;m>0;s=256*s+t[e+_],_+=y,m-=8);for(c=s&(1<<-m)-1,s>>=-m,m+=i;m>0;c=256*c+t[e+_],_+=y,m-=8);if(s===0)s=1-p;else{if(s===d)return c?NaN:1/0*(v?-1:1);c+=Math.pow(2,i),s-=p}return(v?-1:1)*c*Math.pow(2,s-i)},write:function(t,e,r,i,a,s){var c,u,d,p=8*s-a-1,m=(1<<p)-1,_=m>>1,y=a===23?Math.pow(2,-24)-Math.pow(2,-77):0,v=i?0:s-1,b=i?1:-1,S=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,c=m):(c=Math.floor(Math.log(e)/Math.LN2),e*(d=Math.pow(2,-c))<1&&(c--,d*=2),(e+=c+_>=1?y/d:y*Math.pow(2,1-_))*d>=2&&(c++,d/=2),c+_>=m?(u=0,c=m):c+_>=1?(u=(e*d-1)*Math.pow(2,a),c+=_):(u=e*Math.pow(2,_-1)*Math.pow(2,a),c=0));a>=8;t[r+v]=255&u,v+=b,u/=256,a-=8);for(c=c<<a|u,p+=a;p>0;t[r+v]=255&c,v+=b,c/=256,p-=8);t[r+v-b]|=128*S}},YT=an,$m=BF;function an(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}an.Varint=0,an.Fixed64=1,an.Bytes=2,an.Fixed32=5;var Lv=4294967296,KT=1/Lv,JT=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function os(t){return t.type===an.Bytes?t.readVarint()+t.pos:t.pos+1}function Tu(t,e,r){return r?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}function QT(t,e,r){var i=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));r.realloc(i);for(var a=r.pos-1;a>=t;a--)r.buf[a+i]=r.buf[a]}function NF(t,e){for(var r=0;r<t.length;r++)e.writeVarint(t[r])}function jF(t,e){for(var r=0;r<t.length;r++)e.writeSVarint(t[r])}function $F(t,e){for(var r=0;r<t.length;r++)e.writeFloat(t[r])}function VF(t,e){for(var r=0;r<t.length;r++)e.writeDouble(t[r])}function UF(t,e){for(var r=0;r<t.length;r++)e.writeBoolean(t[r])}function GF(t,e){for(var r=0;r<t.length;r++)e.writeFixed32(t[r])}function WF(t,e){for(var r=0;r<t.length;r++)e.writeSFixed32(t[r])}function HF(t,e){for(var r=0;r<t.length;r++)e.writeFixed64(t[r])}function qF(t,e){for(var r=0;r<t.length;r++)e.writeSFixed64(t[r])}function Vm(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Mu(t,e,r){t[r]=e,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24}function eM(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}an.prototype={destroy:function(){this.buf=null},readFields:function(t,e,r){for(r=r||this.length;this.pos<r;){var i=this.readVarint(),a=i>>3,s=this.pos;this.type=7&i,t(a,e,this),this.pos===s&&this.skip(i)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Vm(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=eM(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Vm(this.buf,this.pos)+Vm(this.buf,this.pos+4)*Lv;return this.pos+=8,t},readSFixed64:function(){var t=Vm(this.buf,this.pos)+eM(this.buf,this.pos+4)*Lv;return this.pos+=8,t},readFloat:function(){var t=$m.read(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=$m.read(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,r,i=this.buf;return e=127&(r=i[this.pos++]),r<128?e:(e|=(127&(r=i[this.pos++]))<<7,r<128?e:(e|=(127&(r=i[this.pos++]))<<14,r<128?e:(e|=(127&(r=i[this.pos++]))<<21,r<128?e:function(a,s,c){var u,d,p=c.buf;if(u=(112&(d=p[c.pos++]))>>4,d<128||(u|=(127&(d=p[c.pos++]))<<3,d<128)||(u|=(127&(d=p[c.pos++]))<<10,d<128)||(u|=(127&(d=p[c.pos++]))<<17,d<128)||(u|=(127&(d=p[c.pos++]))<<24,d<128)||(u|=(1&(d=p[c.pos++]))<<31,d<128))return Tu(a,u,s);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(r=i[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&JT?function(r,i,a){return JT.decode(r.subarray(i,a))}(this.buf,e,t):function(r,i,a){for(var s="",c=i;c<a;){var u,d,p,m=r[c],_=null,y=m>239?4:m>223?3:m>191?2:1;if(c+y>a)break;y===1?m<128&&(_=m):y===2?(192&(u=r[c+1]))==128&&(_=(31&m)<<6|63&u)<=127&&(_=null):y===3?(d=r[c+2],(192&(u=r[c+1]))==128&&(192&d)==128&&((_=(15&m)<<12|(63&u)<<6|63&d)<=2047||_>=55296&&_<=57343)&&(_=null)):y===4&&(d=r[c+2],p=r[c+3],(192&(u=r[c+1]))==128&&(192&d)==128&&(192&p)==128&&((_=(15&m)<<18|(63&u)<<12|(63&d)<<6|63&p)<=65535||_>=1114112)&&(_=null)),_===null?(_=65533,y=1):_>65535&&(_-=65536,s+=String.fromCharCode(_>>>10&1023|55296),_=56320|1023&_),s+=String.fromCharCode(_),c+=y}return s}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==an.Bytes)return t.push(this.readVarint(e));var r=os(this);for(t=t||[];this.pos<r;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==an.Bytes)return t.push(this.readSVarint());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==an.Bytes)return t.push(this.readBoolean());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==an.Bytes)return t.push(this.readFloat());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==an.Bytes)return t.push(this.readDouble());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==an.Bytes)return t.push(this.readFixed32());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==an.Bytes)return t.push(this.readSFixed32());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==an.Bytes)return t.push(this.readFixed64());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==an.Bytes)return t.push(this.readSFixed64());var e=os(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===an.Varint)for(;this.buf[this.pos++]>127;);else if(e===an.Bytes)this.pos=this.readVarint()+this.pos;else if(e===an.Fixed32)this.pos+=4;else{if(e!==an.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var r=new Uint8Array(e);r.set(this.buf),this.buf=r,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Mu(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Mu(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Mu(this.buf,-1&t,this.pos),Mu(this.buf,Math.floor(t*KT),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Mu(this.buf,-1&t,this.pos),Mu(this.buf,Math.floor(t*KT),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,r){var i,a;if(e>=0?(i=e%4294967296|0,a=e/4294967296|0):(a=~(-e/4294967296),4294967295^(i=~(-e%4294967296))?i=i+1|0:(i=0,a=a+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");r.realloc(10),function(s,c,u){u.buf[u.pos++]=127&s|128,s>>>=7,u.buf[u.pos++]=127&s|128,s>>>=7,u.buf[u.pos++]=127&s|128,s>>>=7,u.buf[u.pos++]=127&s|128,u.buf[u.pos]=127&(s>>>=7)}(i,0,r),function(s,c){var u=(7&s)<<4;c.buf[c.pos++]|=u|((s>>>=3)?128:0),s&&(c.buf[c.pos++]=127&s|((s>>>=7)?128:0),s&&(c.buf[c.pos++]=127&s|((s>>>=7)?128:0),s&&(c.buf[c.pos++]=127&s|((s>>>=7)?128:0),s&&(c.buf[c.pos++]=127&s|((s>>>=7)?128:0),s&&(c.buf[c.pos++]=127&s)))))}(a,r)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(i,a,s){for(var c,u,d=0;d<a.length;d++){if((c=a.charCodeAt(d))>55295&&c<57344){if(!u){c>56319||d+1===a.length?(i[s++]=239,i[s++]=191,i[s++]=189):u=c;continue}if(c<56320){i[s++]=239,i[s++]=191,i[s++]=189,u=c;continue}c=u-55296<<10|c-56320|65536,u=null}else u&&(i[s++]=239,i[s++]=191,i[s++]=189,u=null);c<128?i[s++]=c:(c<2048?i[s++]=c>>6|192:(c<65536?i[s++]=c>>12|224:(i[s++]=c>>18|240,i[s++]=c>>12&63|128),i[s++]=c>>6&63|128),i[s++]=63&c|128)}return s}(this.buf,t,this.pos);var r=this.pos-e;r>=128&&QT(e,r,this),this.pos=e-1,this.writeVarint(r),this.pos+=r},writeFloat:function(t){this.realloc(4),$m.write(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),$m.write(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var r=0;r<e;r++)this.buf[this.pos++]=t[r]},writeRawMessage:function(t,e){this.pos++;var r=this.pos;t(e,this);var i=this.pos-r;i>=128&&QT(r,i,this),this.pos=r-1,this.writeVarint(i),this.pos+=i},writeMessage:function(t,e,r){this.writeTag(t,an.Bytes),this.writeRawMessage(e,r)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,NF,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,jF,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,UF,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,$F,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,VF,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,GF,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,WF,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,HF,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,qF,e)},writeBytesField:function(t,e){this.writeTag(t,an.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,an.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,an.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,an.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,an.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,an.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,an.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,an.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,an.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,an.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};var Um=V(YT);const ZF=["tile","layer","source","sourceLayer","state"];class tM{constructor(e,r,i,a,s){this.type="Feature",this._vectorTileFeature=e,this._z=r,this._x=i,this._y=a,this.properties=e.properties,this.id=s}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(e.id=this.id);for(const r of ZF)this[r]!==void 0&&(e[r]=this[r]);return e}}class XF{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,r,i){const a=String(r);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][a]=this.stateChanges[e][a]||{},Oe(this.stateChanges[e][a],i),this.deletedStates[e]===null){this.deletedStates[e]={};for(const s in this.state[e])s!==a&&(this.deletedStates[e][s]=null)}else if(this.deletedStates[e]&&this.deletedStates[e][a]===null){this.deletedStates[e][a]={};for(const s in this.state[e][a])i[s]||(this.deletedStates[e][a][s]=null)}else for(const s in i)this.deletedStates[e]&&this.deletedStates[e][a]&&this.deletedStates[e][a][s]===null&&delete this.deletedStates[e][a][s]}removeFeatureState(e,r,i){if(this.deletedStates[e]===null)return;const a=String(r);if(this.deletedStates[e]=this.deletedStates[e]||{},i&&r!==void 0)this.deletedStates[e][a]!==null&&(this.deletedStates[e][a]=this.deletedStates[e][a]||{},this.deletedStates[e][a][i]=null);else if(r!==void 0)if(this.stateChanges[e]&&this.stateChanges[e][a])for(i in this.deletedStates[e][a]={},this.stateChanges[e][a])this.deletedStates[e][a][i]=null;else this.deletedStates[e][a]=null;else this.deletedStates[e]=null}getState(e,r){const i=String(r),a=Oe({},(this.state[e]||{})[i],(this.stateChanges[e]||{})[i]);if(this.deletedStates[e]===null)return{};if(this.deletedStates[e]){const s=this.deletedStates[e][r];if(s===null)return{};for(const c in s)delete a[c]}return a}initializeTileState(e,r){e.setFeatureState(this.state,r)}coalesceChanges(e,r){const i={};for(const a in this.stateChanges){this.state[a]=this.state[a]||{};const s={};for(const c in this.stateChanges[a])this.state[a][c]||(this.state[a][c]={}),Oe(this.state[a][c],this.stateChanges[a][c]),s[c]=this.state[a][c];i[a]=s}for(const a in this.deletedStates){this.state[a]=this.state[a]||{};const s={};if(this.deletedStates[a]===null)for(const c in this.state[a])s[c]={},this.state[a][c]={};else for(const c in this.deletedStates[a]){if(this.deletedStates[a][c]===null)this.state[a][c]={};else if(this.state[a][c])for(const u of Object.keys(this.deletedStates[a][c]))delete this.state[a][c][u];s[c]=this.state[a][c]}i[a]=i[a]||{},Oe(i[a],s)}if(this.stateChanges={},this.deletedStates={},Object.keys(i).length!==0)for(const a in e)e[a].setFeatureState(i,r)}}class rM{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,r){const i=this.toIdx(e,r);return{min:this.minimums[i],max:this.maximums[i]}}isLeaf(e,r){return this.leaves[this.toIdx(e,r)]}toIdx(e,r){return r*this.size+e}}function nM(t,e,r,i){let a=0,s=Number.MAX_VALUE;for(let c=0;c<3;c++)if(Math.abs(i[c])<1e-15){if(r[c]<t[c]||r[c]>e[c])return null}else{const u=1/i[c];let d=(t[c]-r[c])*u,p=(e[c]-r[c])*u;if(d>p){const m=d;d=p,p=m}if(d>a&&(a=d),p<s&&(s=p),a>s)return null}return a}function iM(t,e,r,i,a,s,c,u,d,p,m){const _=i-t,y=a-e,v=s-r,b=c-t,S=u-e,T=d-r,M=m[1]*T-m[2]*S,C=m[2]*b-m[0]*T,P=m[0]*S-m[1]*b,k=_*M+y*C+v*P;if(Math.abs(k)<1e-15)return null;const z=1/k,L=p[0]-t,B=p[1]-e,W=p[2]-r,Z=(L*M+B*C+W*P)*z;if(Z<0||Z>1)return null;const X=B*v-W*y,H=W*_-L*v,J=L*y-B*_,Q=(m[0]*X+m[1]*H+m[2]*J)*z;return Q<0||Z+Q>1?null:(b*X+S*H+T*J)*z}function oM(t,e,r){return(t-e)/(r-e)}function aM(t,e,r,i,a,s,c,u,d){const p=1<<r,m=s-i,_=c-a,y=(t+1)/p*m+i,v=(e+0)/p*_+a,b=(e+1)/p*_+a;u[0]=(t+0)/p*m+i,u[1]=v,d[0]=y,d[1]=b}class sM{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const r=function(s){const c=Math.ceil(Math.log2(s.dim/8)),u=[];let d=Math.ceil(Math.pow(2,c));const p=1/d,m=(v,b,S,T,M)=>{const C=T?1:0,P=(v+1)*S-C,k=b*S,z=(b+1)*S-C;M[0]=v*S,M[1]=k,M[2]=P,M[3]=z};let _=new rM(d);const y=[];for(let v=0;v<d*d;v++){m(v%d,Math.floor(v/d),p,!1,y);const b=Qs(y[0],y[1],s),S=Qs(y[2],y[1],s),T=Qs(y[2],y[3],s),M=Qs(y[0],y[3],s);_.minimums.push(Math.min(b,S,T,M)),_.maximums.push(Math.max(b,S,T,M)),_.leaves.push(1)}for(u.push(_),d/=2;d>=1;d/=2){const v=u[u.length-1];_=new rM(d);for(let b=0;b<d*d;b++){m(b%d,Math.floor(b/d),2,!0,y);const S=v.getElevation(y[0],y[1]),T=v.getElevation(y[2],y[1]),M=v.getElevation(y[2],y[3]),C=v.getElevation(y[0],y[3]),P=v.isLeaf(y[0],y[1]),k=v.isLeaf(y[2],y[1]),z=v.isLeaf(y[2],y[3]),L=v.isLeaf(y[0],y[3]),B=Math.min(S.min,T.min,M.min,C.min),W=Math.max(S.max,T.max,M.max,C.max),Z=P&&k&&z&&L;_.maximums.push(W),_.minimums.push(B),_.leaves.push(W-B<=5&&Z?1:0)}u.push(_)}return u}(this.dem),i=r.length-1,a=r[i];this._addNode(a.minimums[0],a.maximums[0],a.leaves[0]),this._construct(r,0,0,i,0)}raycastRoot(e,r,i,a,s,c,u=1){return nM([e,r,-100],[i,a,this.maximums[0]*u],s,c)}raycast(e,r,i,a,s,c,u=1){if(!this.nodeCount)return null;const d=this.raycastRoot(e,r,i,a,s,c,u);if(d==null)return null;const p=[],m=[],_=[],y=[],v=[{idx:0,t:d,nodex:0,nodey:0,depth:0}];for(;v.length>0;){const{idx:b,t:S,nodex:T,nodey:M,depth:C}=v.pop();if(this.leaves[b]){aM(T,M,C,e,r,i,a,_,y);const k=1<<C,z=(T+0)/k,L=(T+1)/k,B=(M+0)/k,W=(M+1)/k,Z=Qs(z,B,this.dem)*u,X=Qs(L,B,this.dem)*u,H=Qs(L,W,this.dem)*u,J=Qs(z,W,this.dem)*u,Q=iM(_[0],_[1],Z,y[0],_[1],X,y[0],y[1],H,s,c),K=iM(y[0],y[1],H,_[0],y[1],J,_[0],_[1],Z,s,c),fe=Math.min(Q!==null?Q:Number.MAX_VALUE,K!==null?K:Number.MAX_VALUE);if(fe!==Number.MAX_VALUE)return fe;{const he=ie.scaleAndAdd([],s,c,S);if(lM(Z,X,J,H,oM(he[0],_[0],y[0]),oM(he[1],_[1],y[1]))>=he[2])return S}continue}let P=0;for(let k=0;k<this._siblingOffset.length;k++){aM((T<<1)+this._siblingOffset[k][0],(M<<1)+this._siblingOffset[k][1],C+1,e,r,i,a,_,y),_[2]=-100,y[2]=this.maximums[this.childOffsets[b]+k]*u;const z=nM(_,y,s,c);if(z!=null){const L=z;p[k]=L;let B=!1;for(let W=0;W<P&&!B;W++)L>=p[m[W]]&&(m.splice(W,0,k),B=!0);B||(m[P]=k),P++}}for(let k=0;k<P;k++){const z=m[k];v.push({idx:this.childOffsets[b]+z,t:p[z],nodex:(T<<1)+this._siblingOffset[z][0],nodey:(M<<1)+this._siblingOffset[z][1],depth:C+1})}}return null}_addNode(e,r,i){return this.minimums.push(e),this.maximums.push(r),this.leaves.push(i),this.childOffsets.push(0),this.nodeCount++}_construct(e,r,i,a,s){if(e[a].isLeaf(r,i)===1)return;this.childOffsets[s]||(this.childOffsets[s]=this.nodeCount);const c=a-1,u=e[c];let d=0,p=0;for(let m=0;m<this._siblingOffset.length;m++){const _=2*r+this._siblingOffset[m][0],y=2*i+this._siblingOffset[m][1],v=u.getElevation(_,y),b=u.isLeaf(_,y),S=this._addNode(v.min,v.max,b);b&&(d|=1<<m),p||(p=S)}for(let m=0;m<this._siblingOffset.length;m++)d&1<<m||this._construct(e,2*r+this._siblingOffset[m][0],2*i+this._siblingOffset[m][1],c,p+m)}}function lM(t,e,r,i,a,s){return Ft(Ft(t,r,s),Ft(e,i,s),a)}function Qs(t,e,r){const i=r.dim,a=ze(t*i-.5,0,i-1),s=ze(e*i-.5,0,i-1),c=Math.floor(a),u=Math.floor(s),d=Math.min(c+1,i-1),p=Math.min(u+1,i-1);return lM(r.get(c,u),r.get(d,u),r.get(c,p),r.get(d,p),a-c,s-u)}const cM={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function YF(t,e,r){return(256*t*256+256*e+r)/10-1e4}function KF(t,e,r){return 256*t+e+r/256-32768}class Cu{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,r,i,a=!1,s=!1){if(this.uid=e,r.height!==r.width)throw new RangeError("DEM tiles must be square");if(i&&i!=="mapbox"&&i!=="terrarium")return re(`"${i}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=r.height;const c=this.dim=r.height-2,u=new Uint32Array(r.data.buffer);if(this.pixels=new Uint8Array(r.data.buffer),this.encoding=i||"mapbox",this.borderReady=a,!a){for(let d=0;d<c;d++)u[this._idx(-1,d)]=u[this._idx(0,d)],u[this._idx(c,d)]=u[this._idx(c-1,d)],u[this._idx(d,-1)]=u[this._idx(d,0)],u[this._idx(d,c)]=u[this._idx(d,c-1)];u[this._idx(-1,-1)]=u[this._idx(0,0)],u[this._idx(c,-1)]=u[this._idx(c-1,0)],u[this._idx(-1,c)]=u[this._idx(0,c-1)],u[this._idx(c,c)]=u[this._idx(c-1,c-1)],s&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new sM(this)}get(e,r,i=!1){i&&(e=ze(e,-1,this.dim),r=ze(r,-1,this.dim));const a=4*this._idx(e,r);return(this.encoding==="terrarium"?KF:YF)(this.pixels[a],this.pixels[a+1],this.pixels[a+2])}static getUnpackVector(e){return cM[e]}get unpackVector(){return cM[this.encoding]}_idx(e,r){if(e<-1||e>=this.dim+1||r<-1||r>=this.dim+1)throw new RangeError(`out of range source coordinates for DEM; coords = (${e}, ${r}), dim = ${this.dim}, stride = ${this.stride}`);return(r+1)*this.stride+(e+1)}static pack(e,r){const i=[0,0,0,0],a=Cu.getUnpackVector(r);let s=Math.floor((e+a[3])/a[2]);return i[2]=s%256,s=Math.floor(s/256),i[1]=s%256,s=Math.floor(s/256),i[0]=s,i}getPixels(){return new Sn({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,r,i){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let a=r*this.dim,s=r*this.dim+this.dim,c=i*this.dim,u=i*this.dim+this.dim;switch(r){case-1:a=s-1;break;case 1:s=a+1}switch(i){case-1:c=u-1;break;case 1:u=c+1}const d=-r*this.dim,p=-i*this.dim;for(let m=c;m<u;m++)for(let _=a;_<s;_++){const y=4*this._idx(_,m),v=4*this._idx(_+d,m+p);this.pixels[y+0]=e.pixels[v+0],this.pixels[y+1]=e.pixels[v+1],this.pixels[y+2]=e.pixels[v+2],this.pixels[y+3]=e.pixels[v+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}ht(Cu,"DEMData"),ht(sM,"DemMinMaxQuadTree",{omit:["dem"]});class JF{isDataAvailableAtPoint(e){const r=this._source();if(this.isUsingMockSource()||!r||e.y<0||e.y>1)return!1;const i=r.getSource().maxzoom,a=1<<i,s=Math.floor(e.x),c=Math.floor((e.x-s)*a),u=Math.floor(e.y*a),d=this.findDEMTileFor(new Kr(i,s,i,c,u));return!(!d||!d.dem)}getAtPointOrZero(e,r=0){return this.getAtPoint(e,r)||0}getAtPoint(e,r,i=!0){if(this.isUsingMockSource())return null;r==null&&(r=null);const a=this._source();if(!a||e.y<0||e.y>1)return r;const s=a.getSource().maxzoom,c=1<<s,u=Math.floor(e.x),d=e.x-u,p=new Kr(s,u,s,Math.floor(d*c),Math.floor(e.y*c)),m=this.findDEMTileFor(p);if(!m||!m.dem)return r;const _=m.dem,y=1<<m.tileID.canonical.z,v=(d*y-m.tileID.canonical.x)*_.dim,b=(e.y*y-m.tileID.canonical.y)*_.dim,S=Math.floor(v),T=Math.floor(b);return(i?this.exaggeration():1)*Ft(Ft(_.get(S,T),_.get(S,T+1),b-T),Ft(_.get(S+1,T),_.get(S+1,T+1),b-T),v-S)}getAtTileOffset(e,r,i){const a=1<<e.canonical.z;return this.getAtPointOrZero(new cr(e.wrap+(e.canonical.x+r/Ae)/a,(e.canonical.y+i/Ae)/a))}getAtTileOffsetFunc(e,r,i,a){return s=>{const c=this.getAtTileOffset(e,s.x,s.y),u=a.upVector(e.canonical,s.x,s.y),d=a.upVectorScale(e.canonical,r,i).metersToTile;return ie.scale(u,u,c*d),u}}getForTilePoints(e,r,i,a){if(this.isUsingMockSource())return!1;const s=Au.create(this,e,a);return!!s&&(r.forEach(c=>{c[2]=this.exaggeration()*s.getElevationAt(c[0],c[1],i)}),!0)}getMinMaxForTile(e){if(this.isUsingMockSource())return null;const r=this.findDEMTileFor(e);if(!r||!r.dem)return null;const i=r.dem.tree,a=r.tileID,s=1<<e.canonical.z-a.canonical.z;let c=e.canonical.x/s-a.canonical.x,u=e.canonical.y/s-a.canonical.y,d=0;for(let p=0;p<e.canonical.z-a.canonical.z&&!i.leaves[d];p++){c*=2,u*=2;const m=2*Math.floor(u)+Math.floor(c);d=i.childOffsets[d]+m,c%=1,u%=1}return{min:this.exaggeration()*i.minimums[d],max:this.exaggeration()*i.maximums[d]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(e,r,i){throw new Error("Pure virtual method called.")}pointCoordinate(e){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(e){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}}class Au{constructor(e,r,i){this._demTile=e,this._dem=this._demTile.dem,this._scale=r,this._offset=i}static create(e,r,i){const a=i||e.findDEMTileFor(r);if(!a||!a.dem)return;const s=a.dem,c=a.tileID,u=1<<r.canonical.z-c.canonical.z;return new Au(a,a.tileSize/Ae/u,[(r.canonical.x/u-c.canonical.x)*s.dim,(r.canonical.y/u-c.canonical.y)*s.dim])}tileCoordToPixel(e,r){const i=r*this._scale+this._offset[1],a=Math.floor(e*this._scale+this._offset[0]),s=Math.floor(i);return new $(a,s)}getElevationAt(e,r,i,a){const s=e*this._scale+this._offset[0],c=r*this._scale+this._offset[1],u=Math.floor(s),d=Math.floor(c),p=this._dem;return a=!!a,i?Ft(Ft(p.get(u,d,a),p.get(u,d+1,a),c-d),Ft(p.get(u+1,d,a),p.get(u+1,d+1,a),c-d),s-u):p.get(u,d,a)}getElevationAtPixel(e,r,i){return this._dem.get(e,r,!!i)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*jr(1,e)*this._dem.stride}}class Ov{constructor(e,r){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new cu(Ae,16,0),this.featureIndexArray=new US,this.promoteId=r}insert(e,r,i,a,s,c=0){const u=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(i,a,s,c);const d=this.grid;for(let p=0;p<r.length;p++){const m=r[p],_=[1/0,1/0,-1/0,-1/0];for(let y=0;y<m.length;y++){const v=m[y];_[0]=Math.min(_[0],v.x),_[1]=Math.min(_[1],v.y),_[2]=Math.max(_[2],v.x),_[3]=Math.max(_[3],v.y)}_[0]<Ae&&_[1]<Ae&&_[2]>=0&&_[3]>=0&&d.insert(u,_[0],_[1],_[2],_[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Dv(new Um(this.rawTileData)).layers,this.sourceLayerCoder=new XT(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,r,i,a){this.loadVTLayers();const s=e.params||{},c=rm(s.filter),u=e.tileResult,d=e.transform,p=u.bufferedTilespaceBounds,m=this.grid.query(p.min.x,p.min.y,p.max.x,p.max.y,(b,S,T,M)=>DT(u.bufferedTilespaceGeometry,b,S,T,M));m.sort(QF);let _=null;d.elevation&&m.length>0&&(_=Au.create(d.elevation,this.tileID));const y={};let v;for(let b=0;b<m.length;b++){const S=m[b];if(S===v)continue;v=S;const T=this.featureIndexArray.get(S);let M=null;this.loadMatchingFeature(y,T,c,s.layers,s.availableImages,r,i,a,(C,P,k,z=0)=>(M||(M=Pa(C,this.tileID.canonical,e.tileTransform)),P.queryIntersectsFeature(u,C,k,M,this.z,e.transform,e.pixelPosMatrix,_,z)))}return y}loadMatchingFeature(e,r,i,a,s,c,u,d,p){const{featureIndex:m,bucketIndex:_,sourceLayerIndex:y,layoutVertexArrayOffset:v}=r,b=this.bucketLayerIDs[_];if(a&&!function(C,P){for(let k=0;k<C.length;k++)if(P.indexOf(C[k])>=0)return!0;return!1}(a,b))return;const S=this.sourceLayerCoder.decode(y),T=this.vtLayers[S].feature(m);if(i.needGeometry){const C=Ks(T,!0);if(!i.filter(new mn(this.tileID.overscaledZ),C,this.tileID.canonical))return}else if(!i.filter(new mn(this.tileID.overscaledZ),T))return;const M=this.getId(T,S);for(let C=0;C<b.length;C++){const P=b[C];if(a&&a.indexOf(P)<0)continue;const k=c[P];if(!k)continue;let z={};M!==void 0&&d&&(z=d.getState(k.sourceLayer||"_geojsonTileLayer",M));const L=Oe({},u[P]);L.paint=uM(L.paint,k.paint,T,z,s),L.layout=uM(L.layout,k.layout,T,z,s);const B=!p||p(T,k,z,v);if(!B)continue;const W=new tM(T,this.z,this.x,this.y,M);W.layer=L;let Z=e[P];Z===void 0&&(Z=e[P]=[]),Z.push({featureIndex:m,feature:W,intersectionZ:B})}}lookupSymbolFeatures(e,r,i,a,s,c,u,d){const p={};this.loadVTLayers();const m=rm(s);for(const _ of e)this.loadMatchingFeature(p,{bucketIndex:i,sourceLayerIndex:a,featureIndex:_,layoutVertexArrayOffset:0},m,c,u,d,r);return p}loadFeature(e){const{featureIndex:r,sourceLayerIndex:i}=e;this.loadVTLayers();const a=this.sourceLayerCoder.decode(i),s=this.vtFeatures[a];if(s[r])return s[r];const c=this.vtLayers[a].feature(r);return s[r]=c,c}hasLayer(e){for(const r of this.bucketLayerIDs)for(const i of r)if(e===i)return!0;return!1}getId(e,r){let i=e.id;if(this.promoteId){const a=typeof this.promoteId=="string"?this.promoteId:this.promoteId[r];a!=null&&(i=e.properties[a]),typeof i=="boolean"&&(i=Number(i))}return i}}function uM(t,e,r,i,a){return xr(t,(s,c)=>{const u=e instanceof lm?e.get(c):null;return u&&u.evaluate?u.evaluate(r,i,a):u})}function QF(t,e){return e-t}ht(Ov,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const e7=Ar([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),t7=Ar([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),r7=Ar([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ar([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const n7=Ar([{name:"a_texb",components:2,type:"Uint16"}]),i7=Ar([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),o7=Ar([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ar([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const hM=Ar([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),a7=Ar([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ar([{name:"triangle",components:3,type:"Uint16"}]),Ar([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ar([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint8",name:"hasIconTextFit"}]),Ar([{type:"Float32",name:"offsetX"}]),Ar([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var Xn=24;const ta=128;function Fv(t,e){const{expression:r}=e;if(r.kind==="constant")return{kind:"constant",layoutSize:r.evaluate(new mn(t+1))};if(r.kind==="source")return{kind:"source"};{const{zoomStops:i,interpolationType:a}=r;let s=0;for(;s<i.length&&i[s]<=t;)s++;s=Math.max(0,s-1);let c=s;for(;c<i.length&&i[c]<t+1;)c++;c=Math.min(i.length-1,c);const u=i[s],d=i[c];return r.kind==="composite"?{kind:"composite",minZoom:u,maxZoom:d,interpolationType:a}:{kind:"camera",minZoom:u,maxZoom:d,minSize:r.evaluate(new mn(u)),maxSize:r.evaluate(new mn(d)),interpolationType:a}}}function Ld(t,{uSize:e,uSizeT:r},{lowerSize:i,upperSize:a}){return t.kind==="source"?i/ta:t.kind==="composite"?Ft(i/ta,a/ta,r):e}function ka(t,e){let r=0,i=0;if(t.kind==="constant")i=t.layoutSize;else if(t.kind!=="source"){const{interpolationType:a,minZoom:s,maxZoom:c}=t,u=a?ze(Ma.interpolationFactor(a,e,s,c),0,1):0;t.kind==="camera"?i=Ft(t.minSize,t.maxSize,u):r=u}return{uSizeT:r,uSize:i}}var s7=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:ta,evaluateSizeForFeature:Ld,evaluateSizeForZoom:ka,getSizeData:Fv});function l7(t,e,r){return t.sections.forEach(i=>{i.text=function(a,s,c){const u=s.layout.get("text-transform").evaluate(c,{});return u==="uppercase"?a=a.toLocaleUpperCase():u==="lowercase"&&(a=a.toLocaleLowerCase()),Ro.applyArabicShaping&&(a=Ro.applyArabicShaping(a)),a}(i.text,e,r)}),t}const Od={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function c7(t){return t==="︶"||t==="﹈"||t==="︸"||t==="﹄"||t==="﹂"||t==="︾"||t==="︼"||t==="︺"||t==="︘"||t==="﹀"||t==="︐"||t==="︓"||t==="︔"||t==="｀"||t==="￣"||t==="︑"||t==="︒"}function u7(t){return t==="︵"||t==="﹇"||t==="︷"||t==="﹃"||t==="﹁"||t==="︽"||t==="︻"||t==="︹"||t==="︗"||t==="︿"}const Bv=3;function h7(t,e,r){e.glyphs=[],t===1&&r.readMessage(d7,e)}function d7(t,e,r){if(t===3){const{id:i,bitmap:a,width:s,height:c,left:u,top:d,advance:p}=r.readMessage(f7,{});e.glyphs.push({id:i,bitmap:new is({width:s+2*Bv,height:c+2*Bv},a),metrics:{width:s,height:c,left:u,top:d,advance:p}})}else t===4?e.ascender=r.readSVarint():t===5&&(e.descender=r.readSVarint())}function f7(t,e,r){t===1?e.id=r.readVarint():t===2?e.bitmap=r.readBytes():t===3?e.width=r.readVarint():t===4?e.height=r.readVarint():t===5?e.left=r.readSVarint():t===6?e.top=r.readSVarint():t===7&&(e.advance=r.readVarint())}const dM=Bv;function Nv(t){let e=0,r=0;for(const c of t)e+=c.w*c.h,r=Math.max(r,c.w);t.sort((c,u)=>u.h-c.h);const i=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),r),h:1/0}];let a=0,s=0;for(const c of t)for(let u=i.length-1;u>=0;u--){const d=i[u];if(!(c.w>d.w||c.h>d.h)){if(c.x=d.x,c.y=d.y,s=Math.max(s,c.y+c.h),a=Math.max(a,c.x+c.w),c.w===d.w&&c.h===d.h){const p=i.pop();u<i.length&&(i[u]=p)}else c.h===d.h?(d.x+=c.w,d.w-=c.w):c.w===d.w?(d.y+=c.h,d.h-=c.h):(i.push({x:d.x+c.w,y:d.y,w:d.w-c.w,h:c.h}),d.y+=c.h,d.h-=c.h);break}}return{w:a,h:s,fill:e/(a*s)||0}}const ki=1;class jv{constructor(e,{pixelRatio:r,version:i,stretchX:a,stretchY:s,content:c}){this.paddedRect=e,this.pixelRatio=r,this.stretchX=a,this.stretchY=s,this.content=c,this.version=i}get tl(){return[this.paddedRect.x+ki,this.paddedRect.y+ki]}get br(){return[this.paddedRect.x+this.paddedRect.w-ki,this.paddedRect.y+this.paddedRect.h-ki]}get displaySize(){return[(this.paddedRect.w-2*ki)/this.pixelRatio,(this.paddedRect.h-2*ki)/this.pixelRatio]}}class fM{constructor(e,r){const i={},a={};this.haveRenderCallbacks=[];const s=[];this.addImages(e,i,s),this.addImages(r,a,s);const{w:c,h:u}=Nv(s),d=new Sn({width:c||1,height:u||1});for(const p in e){const m=e[p],_=i[p].paddedRect;Sn.copy(m.data,d,{x:0,y:0},{x:_.x+ki,y:_.y+ki},m.data)}for(const p in r){const m=r[p],_=a[p].paddedRect,y=_.x+ki,v=_.y+ki,b=m.data.width,S=m.data.height;Sn.copy(m.data,d,{x:0,y:0},{x:y,y:v},m.data),Sn.copy(m.data,d,{x:0,y:S-1},{x:y,y:v-1},{width:b,height:1}),Sn.copy(m.data,d,{x:0,y:0},{x:y,y:v+S},{width:b,height:1}),Sn.copy(m.data,d,{x:b-1,y:0},{x:y-1,y:v},{width:1,height:S}),Sn.copy(m.data,d,{x:0,y:0},{x:y+b,y:v},{width:1,height:S})}this.image=d,this.iconPositions=i,this.patternPositions=a}addImages(e,r,i){for(const a in e){const s=e[a],c={x:0,y:0,w:s.data.width+2*ki,h:s.data.height+2*ki};i.push(c),r[a]=new jv(c,s),s.hasRenderCallback&&this.haveRenderCallbacks.push(a)}}patchUpdatedImages(e,r,i){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(a=>e.hasImage(a,i)),e.dispatchRenderCallbacks(this.haveRenderCallbacks,i);for(const a in e.getUpdatedImages(i))this.patchUpdatedImage(this.iconPositions[a],e.getImage(a,i),r),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a,i),r)}patchUpdatedImage(e,r,i){if(!e||!r||e.version===r.version)return;e.version=r.version;const[a,s]=e.tl;i.update(r.data,void 0,{x:a,y:s})}}ht(jv,"ImagePosition"),ht(fM,"ImageAtlas");const sn={horizontal:1,vertical:2,horizontalOnly:3},pM=-17;class Fd{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,r){const i=new Fd;return i.scale=e||1,i.fontStack=r,i}static forImage(e){const r=new Fd;return r.imageName=e,r}}class Iu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,r){const i=new Iu;for(let a=0;a<e.sections.length;a++){const s=e.sections[a];s.image?i.addImageSection(s):i.addTextSection(s,r)}return i}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCodePoint(e){return this.text.codePointAt(e)}verticalizePunctuation(e){this.text=function(r,i){let a="";for(let s=0;s<r.length;s++){const c=r.charCodeAt(s+1)||null,u=r.charCodeAt(s-1)||null;a+=!i&&(c&&CS(c)&&!Od[r[s+1]]||u&&CS(u)&&!Od[r[s-1]])||!Od[r[s]]?r[s]:Od[r[s]]}return a}(this.text,e)}trim(){let e=0;for(let i=0;i<this.text.length&&Gm[this.text.charCodeAt(i)];i++)e++;let r=this.text.length;for(let i=this.text.length-1;i>=0&&i>=e&&Gm[this.text.charCodeAt(i)];i--)r--;this.text=this.text.substring(e,r),this.sectionIndex=this.sectionIndex.slice(e,r)}substring(e,r){const i=new Iu;return i.text=this.text.substring(e,r),i.sectionIndex=this.sectionIndex.slice(e,r),i.sections=this.sections,i}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,r)=>Math.max(e,this.sections[r].scale),0)}addTextSection(e,r){this.text+=e.text,this.sections.push(Fd.forText(e.scale,e.fontStack||r));const i=this.sections.length-1;for(let a=0;a<e.text.length;++a)this.sectionIndex.push(i)}addImageSection(e){const r=e.image?e.image.namePrimary:"";if(r.length===0)return void re("Can't add FormattedSection with an empty image.");const i=this.getNextImageSectionCharCode();i?(this.text+=String.fromCodePoint(i),this.sections.push(Fd.forImage(r)),this.sectionIndex.push(this.sections.length-1)):re("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function $v(t,e,r,i,a,s,c,u,d,p,m,_,y,v,b){const S=Iu.fromFeature(t,a);_===sn.vertical&&S.verticalizePunctuation(y);let T=[];const M=function(L,B,W,Z,X,H){if(!L)return[];const J=[],Q=function(_e,oe,me,ve,Ce,Se){let Je=0;for(let Ge=0;Ge<_e.length();Ge++){const je=_e.getSection(Ge);Je+=mM(_e.getCodePoint(Ge),je,ve,Ce,oe,Se)}return Je/Math.max(1,Math.ceil(Je/me))}(L,B,W,Z,X,H),K=L.text.indexOf("​")>=0;let fe=0;for(let _e=0;_e<L.length();_e++){const oe=L.getSection(_e),me=L.getCodePoint(_e);if(Gm[me]||(fe+=mM(me,oe,Z,X,B,H)),_e<L.length()-1){const ve=!((he=me)<11904||!(vt["Bopomofo Extended"](he)||vt.Bopomofo(he)||vt["CJK Compatibility Forms"](he)||vt["CJK Compatibility Ideographs"](he)||vt["CJK Compatibility"](he)||vt["CJK Radicals Supplement"](he)||vt["CJK Strokes"](he)||vt["CJK Symbols and Punctuation"](he)||vt["CJK Unified Ideographs Extension A"](he)||vt["CJK Unified Ideographs"](he)||vt["Enclosed CJK Letters and Months"](he)||vt["Halfwidth and Fullwidth Forms"](he)||vt.Hiragana(he)||vt["Ideographic Description Characters"](he)||vt["Kangxi Radicals"](he)||vt["Katakana Phonetic Extensions"](he)||vt.Katakana(he)||vt["Vertical Forms"](he)||vt["Yi Radicals"](he)||vt["Yi Syllables"](he)));(p7[me]||ve||oe.imageName)&&J.push(_M(_e+1,fe,Q,J,m7(me,L.getCodePoint(_e+1),ve&&K),!1))}}var he;return yM(_M(L.length(),fe,Q,J,0,!0))}(S,p,s,e,i,v),{processBidirectionalText:C,processStyledBidirectionalText:P}=Ro;if(C&&S.sections.length===1){const L=C(S.toString(),M);for(const B of L){const W=new Iu;W.text=B,W.sections=S.sections;for(let Z=0;Z<B.length;Z++)W.sectionIndex.push(0);T.push(W)}}else if(P){const L=P(S.text,S.sectionIndex,M);for(const B of L){const W=new Iu;W.text=B[0],W.sectionIndex=B[1],W.sections=S.sections,T.push(W)}}else T=function(L,B){const W=[],Z=L.text;let X=0;for(const H of B)W.push(L.substring(X,H)),X=H;return X<Z.length&&W.push(L.substring(X,Z.length)),W}(S,M);const k=[],z={positionedLines:k,text:S.toString(),top:m[1],bottom:m[1],left:m[0],right:m[0],writingMode:_,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(L,B,W,Z,X,H,J,Q,K,fe,he,_e){let oe=0,me=0,ve=0;const Ce=Q==="right"?1:Q==="left"?0:.5;let Se=!1;for(const wt of X){const pt=wt.getSections();for(const dt of pt){if(dt.imageName)continue;const Et=B[dt.fontStack];if(Et&&(Se=Et.ascender!==void 0&&Et.descender!==void 0,!Se))break}if(!Se)break}let Je=0;for(const wt of X){wt.trim();const pt=wt.getMaxScale(),dt=(pt-1)*Xn,Et={positionedGlyphs:[],lineOffset:0};L.positionedLines[Je]=Et;const nr=Et.positionedGlyphs;let er=0;if(!wt.length()){me+=H,++Je;continue}let Rr=0,tr=0;for(let Dt=0;Dt<wt.length();Dt++){const Yt=wt.getSection(Dt),zr=wt.getSectionIndex(Dt),Kt=wt.getCodePoint(Dt);let Or=Yt.scale,Tn=null,Mn=null,dn=null,rn=Xn,Ln=0;const cn=!(K===sn.horizontal||!he&&!x1(Kt)||he&&(Gm[Kt]||(Ge=Kt,vt.Arabic(Ge)||vt["Arabic Supplement"](Ge)||vt["Arabic Extended-A"](Ge)||vt["Arabic Presentation Forms-A"](Ge)||vt["Arabic Presentation Forms-B"](Ge))));if(Yt.imageName){const jn=Z[Yt.imageName];if(!jn)continue;dn=Yt.imageName,L.iconsInText=L.iconsInText||!0,Mn=jn.paddedRect;const Fr=jn.displaySize;Or=Or*Xn/_e,Tn={width:Fr[0],height:Fr[1],left:ki,top:-dM,advance:cn?Fr[1]:Fr[0],localGlyph:!1},Ln=Se?-Tn.height*Or:pM+pt*Xn-Fr[1]*Or,rn=Tn.advance;const Ri=(cn?Fr[0]:Fr[1])*Or-Xn*pt;Ri>0&&Ri>er&&(er=Ri)}else{const jn=W[Yt.fontStack];if(!jn)continue;jn[Kt]&&(Mn=jn[Kt]);const Fr=B[Yt.fontStack];if(!Fr)continue;const Ri=Fr.glyphs[Kt];if(!Ri)continue;if(Tn=Ri.metrics,rn=Kt!==8203?Xn:0,Se){const Hu=Fr.ascender!==void 0?Math.abs(Fr.ascender):0,cs=Fr.descender!==void 0?Math.abs(Fr.descender):0,us=(Hu+cs)*Or;Rr<us&&(Rr=us,tr=(Hu-cs)/2*Or),Ln=-Hu*Or}else Ln=pM+(pt-Or)*Xn}cn?(L.verticalizable=!0,nr.push({glyph:Kt,imageName:dn,x:oe,y:me+Ln,vertical:cn,scale:Or,localGlyph:Tn.localGlyph,fontStack:Yt.fontStack,sectionIndex:zr,metrics:Tn,rect:Mn}),oe+=rn*Or+fe):(nr.push({glyph:Kt,imageName:dn,x:oe,y:me+Ln,vertical:cn,scale:Or,localGlyph:Tn.localGlyph,fontStack:Yt.fontStack,sectionIndex:zr,metrics:Tn,rect:Mn}),oe+=Tn.advance*Or+fe)}nr.length!==0&&(ve=Math.max(oe-fe,ve),Se?vM(nr,Ce,er,tr,H*pt/2):vM(nr,Ce,er,0,H/2)),oe=0;const ir=H*pt+er;Et.lineOffset=Math.max(er,dt),me+=ir,++Je}var Ge;const je=me,{horizontalAlign:Ve,verticalAlign:nt}=Wm(J);(function(wt,pt,dt,Et,nr,er){const Rr=(pt-dt)*nr,tr=-er*Et;for(const ir of wt)for(const Dt of ir.positionedGlyphs)Dt.x+=Rr,Dt.y+=tr})(L.positionedLines,Ce,Ve,nt,ve,je),L.top+=-nt*je,L.bottom=L.top+je,L.left+=-Ve*ve,L.right=L.left+ve,L.hasBaseline=Se}(z,e,r,i,T,c,u,d,_,p,y,b),!function(L){for(const B of L)if(B.positionedGlyphs.length!==0)return!1;return!0}(k)&&z}const Gm={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},p7={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function mM(t,e,r,i,a,s){if(e.imageName){const c=i[e.imageName];return c?c.displaySize[0]*e.scale*Xn/s+a:0}{const c=r[e.fontStack],u=c&&c.glyphs[t];return u?u.metrics.advance*e.scale+a:0}}function gM(t,e,r,i){const a=Math.pow(t-e,2);return i?t<e?a/2:2*a:a+Math.abs(r)*r}function m7(t,e,r){let i=0;return t===10&&(i-=1e4),r&&(i+=150),t!==40&&t!==65288||(i+=50),e!==41&&e!==65289||(i+=50),i}function _M(t,e,r,i,a,s){let c=null,u=gM(e,r,a,s);for(const d of i){const p=gM(e-d.x,r,a,s)+d.badness;p<=u&&(c=d,u=p)}return{index:t,x:e,priorBreak:c,badness:u}}function yM(t){return t?yM(t.priorBreak).concat(t.index):[]}function Wm(t){let e=.5,r=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0}return{horizontalAlign:e,verticalAlign:r}}function vM(t,e,r,i,a){if(!(e||r||i||a))return;const s=t.length-1,c=t[s],u=(c.x+c.metrics.advance*c.scale)*e;for(let d=0;d<=s;d++)t[d].x-=u,t[d].y+=r+i+a}function g7(t,e,r,i){const{horizontalAlign:a,verticalAlign:s}=Wm(i),c=r[0]-t.displaySize[0]*a,u=r[1]-t.displaySize[1]*s;return{imagePrimary:t,imageSecondary:e,top:u,bottom:u+t.displaySize[1],left:c,right:c+t.displaySize[0]}}function xM(t,e,r,i,a,s){const c=t.imagePrimary;let u;if(c.content){const T=c.content,M=c.pixelRatio||1;u=[T[0]/M,T[1]/M,c.displaySize[0]-T[2]/M,c.displaySize[1]-T[3]/M]}const d=e.left*s,p=e.right*s;let m,_,y,v;r==="width"||r==="both"?(v=a[0]+d-i[3],_=a[0]+p+i[1]):(v=a[0]+(d+p-c.displaySize[0])/2,_=v+c.displaySize[0]);const b=e.top*s,S=e.bottom*s;return r==="height"||r==="both"?(m=a[1]+b-i[0],y=a[1]+S+i[2]):(m=a[1]+(b+S-c.displaySize[1])/2,y=m+c.displaySize[1]),{imagePrimary:c,imageSecondary:void 0,top:m,right:_,bottom:y,left:v,collisionPadding:u}}class as extends ${constructor(e,r,i,a,s){super(e,r),this.angle=a,this.z=i,s!==void 0&&(this.segment=s)}clone(){return new as(this.x,this.y,this.z,this.angle,this.segment)}}function bM(t,e,r,i,a){if(e.segment===void 0)return!0;let s=e,c=e.segment+1,u=0;for(;u>-r/2;){if(c--,c<0)return!1;u-=t[c].dist(s),s=t[c]}u+=t[c].dist(t[c+1]),c++;const d=[];let p=0;for(;u<r/2;){const m=t[c],_=t[c+1];if(!_)return!1;let y=t[c-1].angleTo(m)-m.angleTo(_);for(y=Math.abs((y+3*Math.PI)%(2*Math.PI)-Math.PI),d.push({distance:u,angleDelta:y}),p+=y;u-d[0].distance>i;)p-=d.shift().angleDelta;if(p>a)return!1;c++,u+=m.dist(_)}return!0}function wM(t){let e=0;for(let r=0;r<t.length-1;r++)e+=t[r].dist(t[r+1]);return e}function EM(t,e,r){return t?.6*e*r:0}function SM(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function _7(t,e,r,i,a,s){const c=EM(r,a,s),u=SM(r,i)*s;let d=0;const p=wM(t)/2;for(let m=0;m<t.length-1;m++){const _=t[m],y=t[m+1],v=_.dist(y);if(d+v>p){const b=(p-d)/v,S=Ft(_.x,y.x,b),T=Ft(_.y,y.y,b),M=new as(S,T,0,y.angleTo(_),m);return!c||bM(t,M,u,c,e)?M:void 0}d+=v}}function y7(t,e,r,i,a,s,c,u,d){const p=EM(i,s,c),m=SM(i,a),_=m*c,y=t[0].x===0||t[0].x===d||t[0].y===0||t[0].y===d;return e-_<e/4&&(e=_+e/4),TM(t,y?e/2*u%e:(m/2+2*s)*c*u%e,e,p,r,_,y,!1,d)}function TM(t,e,r,i,a,s,c,u,d){const p=s/2,m=wM(t);let _=0,y=e-r,v=[];for(let b=0;b<t.length-1;b++){const S=t[b],T=t[b+1],M=S.dist(T),C=T.angleTo(S);for(;y+r<_+M;){y+=r;const P=(y-_)/M,k=Ft(S.x,T.x,P),z=Ft(S.y,T.y,P);if(k>=0&&k<d&&z>=0&&z<d&&y-p>=0&&y+p<=m){const L=new as(k,z,0,C,b);L._round(),i&&!bM(t,L,s,i,a)||v.push(L)}}_+=M}return u||v.length||c||(v=TM(t,_/2,r,i,a,s,c,!0,d)),v}function MM(t,e,r,i,a){const s=[];for(let c=0;c<t.length;c++){const u=t[c];let d;for(let p=0;p<u.length-1;p++){let m=u[p],_=u[p+1];m.x<e&&_.x<e||(m.x<e?m=new $(e,m.y+(e-m.x)/(_.x-m.x)*(_.y-m.y))._round():_.x<e&&(_=new $(e,m.y+(e-m.x)/(_.x-m.x)*(_.y-m.y))._round()),m.y<r&&_.y<r||(m.y<r?m=new $(m.x+(r-m.y)/(_.y-m.y)*(_.x-m.x),r)._round():_.y<r&&(_=new $(m.x+(r-m.y)/(_.y-m.y)*(_.x-m.x),r)._round()),m.x>=i&&_.x>=i||(m.x>=i?m=new $(i,m.y+(i-m.x)/(_.x-m.x)*(_.y-m.y))._round():_.x>=i&&(_=new $(i,m.y+(i-m.x)/(_.x-m.x)*(_.y-m.y))._round()),m.y>=a&&_.y>=a||(m.y>=a?m=new $(m.x+(a-m.y)/(_.y-m.y)*(_.x-m.x),a)._round():_.y>=a&&(_=new $(m.x+(a-m.y)/(_.y-m.y)*(_.x-m.x),a)._round()),d&&m.equals(d[d.length-1])||(d=[m],s.push(d)),d.push(_)))))}}return s}ht(as,"Anchor");const Bd=1e20;function CM(t,e,r,i,a,s,c,u,d){for(let p=e;p<e+i;p++)AM(t,r*s+p,s,a,c,u,d);for(let p=r;p<r+a;p++)AM(t,p*s+e,1,i,c,u,d)}function AM(t,e,r,i,a,s,c){s[0]=0,c[0]=-Bd,c[1]=Bd,a[0]=t[e];for(let u=1,d=0,p=0;u<i;u++){a[u]=t[e+u*r];const m=u*u;do{const _=s[d];p=(a[u]-a[_]+m-_*_)/(u-_)/2}while(p<=c[d]&&--d>-1);d++,s[d]=u,c[d]=p,c[d+1]=Bd}for(let u=0,d=0;u<i;u++){for(;c[d+1]<u;)d++;const p=s[d],m=u-p;t[e+u*r]=a[p]+m*m}}const ra=2;class Pu{constructor(e,r,i){this.requestManager=e,this.localGlyphMode=r,this.localFontFamily=i,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e,r){this.urls[r]=e}getGlyphs(e,r,i){const a=[],s=this.urls[r];if(s){for(const c in e)for(const u of e[c])a.push({stack:c,id:u});mt(a,({stack:c,id:u},d)=>{let p=this.entries[c];p||(p=this.entries[c]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let m=p.glyphs[u];if(m!==void 0)return void d(null,{stack:c,id:u,glyph:m});if(m=this._tinySDF(p,c,u),m)return p.glyphs[u]=m,void d(null,{stack:c,id:u,glyph:m});const _=Math.floor(u/256);if(256*_>65535)return void d(new Error("glyphs > 65535 not supported"));if(p.ranges[_])return void d(null,{stack:c,id:u,glyph:m});let y=p.requests[_];y||(y=p.requests[_]=[],Pu.loadGlyphRange(c,_,s,this.requestManager,(v,b)=>{if(b){p.ascender=b.ascender,p.descender=b.descender;for(const S in b.glyphs)this._doesCharSupportLocalGlyph(+S)||(p.glyphs[+S]=b.glyphs[+S]);p.ranges[_]=!0}for(const S of y)S(v,b);delete p.requests[_]})),y.push((v,b)=>{v?d(v):b&&d(null,{stack:c,id:u,glyph:b.glyphs[u]||null})})},(c,u)=>{if(c)i(c);else if(u){const d={};for(const{stack:p,id:m,glyph:_}of u)d[p]===void 0&&(d[p]={}),d[p].glyphs===void 0&&(d[p].glyphs={}),d[p].glyphs[m]=_&&{id:_.id,bitmap:_.bitmap.clone(),metrics:_.metrics},d[p].ascender=this.entries[p].ascender,d[p].descender=this.entries[p].descender;i(null,d)}})}else i(new Error("Missing glyph URL"))}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==0&&(this.localGlyphMode===2?!!this.localFontFamily:!!this.localFontFamily&&(vt["CJK Unified Ideographs"](e)||vt["Hangul Syllables"](e)||vt.Hiragana(e)||vt.Katakana(e)||vt["CJK Symbols and Punctuation"](e)||vt["CJK Unified Ideographs Extension A"](e)||vt["CJK Unified Ideographs Extension B"](e)))}_tinySDF(e,r,i){const a=this.localFontFamily;if(!a||!this._doesCharSupportLocalGlyph(i))return;let s=e.tinySDF;if(!s){let S="400";/bold/i.test(r)?S="900":/medium/i.test(r)?S="500":/light/i.test(r)&&(S="200"),s=e.tinySDF=new Pu.TinySDF({fontFamily:a,fontWeight:S,fontSize:24*ra,buffer:3*ra,radius:8*ra}),s.fontWeight=S}if(this.localGlyphs[s.fontWeight][i])return this.localGlyphs[s.fontWeight][i];const c=String.fromCodePoint(i),{data:u,width:d,height:p,glyphWidth:m,glyphHeight:_,glyphLeft:y,glyphTop:v,glyphAdvance:b}=s.draw(c);return this.localGlyphs[s.fontWeight][i]={id:i,bitmap:new is({width:d,height:p},u),metrics:{width:m/ra,height:_/ra,left:y/ra,top:v/ra-27,advance:b/ra,localGlyph:!0}}}}Pu.loadGlyphRange=function(t,e,r,i,a){const s=256*e,c=s+255,u=i.transformRequest(i.normalizeGlyphsURL(r).replace("{fontstack}",t).replace("{range}",`${s}-${c}`),be.Glyphs);Ue(u,(d,p)=>{if(d)a(d);else if(p){const m={},_=function(y){return new Um(y).readFields(h7,{})}(p);for(const y of _.glyphs)m[y.id]=y;a(null,{glyphs:m,ascender:_.ascender,descender:_.descender})}})},Pu.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:r=8,cutoff:i=.25,fontFamily:a="sans-serif",fontWeight:s="normal",fontStyle:c="normal"}={}){this.buffer=e,this.cutoff=i,this.radius=r;const u=this.size=t+4*e,d=this._createCanvas(u),p=this.ctx=d.getContext("2d",{willReadFrequently:!0});p.font=`${c} ${s} ${t}px ${a}`,p.textBaseline="alphabetic",p.textAlign="left",p.fillStyle="black",this.gridOuter=new Float64Array(u*u),this.gridInner=new Float64Array(u*u),this.f=new Float64Array(u),this.z=new Float64Array(u+1),this.v=new Uint16Array(u)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:r,actualBoundingBoxDescent:i,actualBoundingBoxLeft:a,actualBoundingBoxRight:s}=this.ctx.measureText(t),c=Math.ceil(r),u=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(s-a))),d=Math.min(this.size-this.buffer,c+Math.ceil(i)),p=u+2*this.buffer,m=d+2*this.buffer,_=Math.max(p*m,0),y=new Uint8ClampedArray(_),v={data:y,width:p,height:m,glyphWidth:u,glyphHeight:d,glyphTop:c,glyphLeft:0,glyphAdvance:e};if(u===0||d===0)return v;const{ctx:b,buffer:S,gridInner:T,gridOuter:M}=this;b.clearRect(S,S,u,d),b.fillText(t,S,S+c);const C=b.getImageData(S,S,u,d);M.fill(Bd,0,_),T.fill(0,0,_);for(let P=0;P<d;P++)for(let k=0;k<u;k++){const z=C.data[4*(P*u+k)+3]/255;if(z===0)continue;const L=(P+S)*p+k+S;if(z===1)M[L]=0,T[L]=Bd;else{const B=.5-z;M[L]=B>0?B*B:0,T[L]=B<0?B*B:0}}CM(M,0,0,p,m,p,this.f,this.v,this.z),CM(T,S,S,u,d,p,this.f,this.v,this.z);for(let P=0;P<_;P++){const k=Math.sqrt(M[P])-Math.sqrt(T[P]);y[P]=Math.round(255-255*(k/this.radius+this.cutoff))}return v}};const el=ki;function IM(t,e,r,i){const a=[],s=t.imagePrimary,c=s.pixelRatio,u=s.paddedRect.w-2*el,d=s.paddedRect.h-2*el,p=t.right-t.left,m=t.bottom-t.top,_=s.stretchX||[[0,u]],y=s.stretchY||[[0,d]],v=(H,J)=>H+J[1]-J[0],b=_.reduce(v,0),S=y.reduce(v,0),T=u-b,M=d-S;let C=0,P=b,k=0,z=S,L=0,B=T,W=0,Z=M;if(s.content&&i){const H=s.content;C=Hm(_,0,H[0]),k=Hm(y,0,H[1]),P=Hm(_,H[0],H[2]),z=Hm(y,H[1],H[3]),L=H[0]-C,W=H[1]-k,B=H[2]-H[0]-P,Z=H[3]-H[1]-z}const X=(H,J,Q,K)=>{const fe=qm(H.stretch-C,P,p,t.left),he=Zm(H.fixed-L,B,H.stretch,b),_e=qm(J.stretch-k,z,m,t.top),oe=Zm(J.fixed-W,Z,J.stretch,S),me=qm(Q.stretch-C,P,p,t.left),ve=Zm(Q.fixed-L,B,Q.stretch,b),Ce=qm(K.stretch-k,z,m,t.top),Se=Zm(K.fixed-W,Z,K.stretch,S),Je=new $(fe,_e),Ge=new $(me,_e),je=new $(me,Ce),Ve=new $(fe,Ce),nt=new $(he/c,oe/c),wt=new $(ve/c,Se/c),pt=e*Math.PI/180;if(pt){const tr=Math.sin(pt),ir=Math.cos(pt),Dt=[ir,-tr,tr,ir];Je._matMult(Dt),Ge._matMult(Dt),Ve._matMult(Dt),je._matMult(Dt)}const dt=H.stretch+H.fixed,Et=Q.stretch+Q.fixed,nr=J.stretch+J.fixed,er=K.stretch+K.fixed,Rr=t.imageSecondary;return{tl:Je,tr:Ge,bl:Ve,br:je,texPrimary:{x:s.paddedRect.x+el+dt,y:s.paddedRect.y+el+nr,w:Et-dt,h:er-nr},texSecondary:Rr?{x:Rr.paddedRect.x+el+dt,y:Rr.paddedRect.y+el+nr,w:Et-dt,h:er-nr}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:nt,pixelOffsetBR:wt,minFontScaleX:B/c/p,minFontScaleY:Z/c/m,isSDF:r}};if(i&&(s.stretchX||s.stretchY)){const H=PM(_,T,b),J=PM(y,M,S);for(let Q=0;Q<H.length-1;Q++){const K=H[Q],fe=H[Q+1];for(let he=0;he<J.length-1;he++)a.push(X(K,J[he],fe,J[he+1]))}}else a.push(X({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:u+1},{fixed:0,stretch:d+1}));return a}function Hm(t,e,r){let i=0;for(const a of t)i+=Math.max(e,Math.min(r,a[1]))-Math.max(e,Math.min(r,a[0]));return i}function PM(t,e,r){const i=[{fixed:-el,stretch:0}];for(const[a,s]of t){const c=i[i.length-1];i.push({fixed:a-c.stretch,stretch:c.stretch}),i.push({fixed:a-c.stretch,stretch:c.stretch+(s-a)})}return i.push({fixed:e+el,stretch:r}),i}function qm(t,e,r,i){return t/e*r+i}function Zm(t,e,r,i){return t-e*r/i}function v7(t,e,r,i){const a=e+t.positionedLines[i].lineOffset;return i===0?r+a/2:r+(a+(e+t.positionedLines[i-1].lineOffset))/2}function x7(t,e=1,r=!1){let i=1/0,a=1/0,s=-1/0,c=-1/0;const u=t[0];for(let v=0;v<u.length;v++){const b=u[v];(!v||b.x<i)&&(i=b.x),(!v||b.y<a)&&(a=b.y),(!v||b.x>s)&&(s=b.x),(!v||b.y>c)&&(c=b.y)}const d=Math.min(s-i,c-a);let p=d/2;const m=new Dy([],b7);if(d===0)return new $(i,a);for(let v=i;v<s;v+=d)for(let b=a;b<c;b+=d)m.push(new ku(v+p,b+p,p,t));let _=function(v){let b=0,S=0,T=0;const M=v[0];for(let C=0,P=M.length,k=P-1;C<P;k=C++){const z=M[C],L=M[k],B=z.x*L.y-L.x*z.y;S+=(z.x+L.x)*B,T+=(z.y+L.y)*B,b+=3*B}return new ku(S/b,T/b,0,v)}(t),y=m.length;for(;m.length;){const v=m.pop();(v.d>_.d||!_.d)&&(_=v,r&&console.log("found best %d after %d probes",Math.round(1e4*v.d)/1e4,y)),v.max-_.d<=e||(p=v.h/2,m.push(new ku(v.p.x-p,v.p.y-p,p,t)),m.push(new ku(v.p.x+p,v.p.y-p,p,t)),m.push(new ku(v.p.x-p,v.p.y+p,p,t)),m.push(new ku(v.p.x+p,v.p.y+p,p,t)),y+=4)}return r&&(console.log(`num probes: ${y}`),console.log(`best distance: ${_.d}`)),_.p}function b7(t,e){return e.max-t.max}class ku{constructor(e,r,i,a){this.p=new $(e,r),this.h=i,this.d=function(s,c){let u=!1,d=1/0;for(let p=0;p<c.length;p++){const m=c[p];for(let _=0,y=m.length,v=y-1;_<y;v=_++){const b=m[_],S=m[v];b.y>s.y!=S.y>s.y&&s.x<(S.x-b.x)*(s.y-b.y)/(S.y-b.y)+b.x&&(u=!u),d=Math.min(d,RT(s,b,S))}}return(u?1:-1)*Math.sqrt(d)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}}const Ru=7,Vv=Number.POSITIVE_INFINITY,w7=Math.sqrt(2);function Uv(t,[e,r]){let i=0,a=0;if(r===Vv){e<0&&(e=0);const s=e/w7;switch(t){case"top-right":case"top-left":a=s-Ru;break;case"bottom-right":case"bottom-left":a=-s+Ru;break;case"bottom":a=-e+Ru;break;case"top":a=e-Ru}switch(t){case"top-right":case"bottom-right":i=-s;break;case"top-left":case"bottom-left":i=s;break;case"left":i=e;break;case"right":i=-e}}else{switch(e=Math.abs(e),r=Math.abs(r),t){case"top-right":case"top-left":case"top":a=r-Ru;break;case"bottom-right":case"bottom-left":case"bottom":a=-r+Ru}switch(t){case"top-right":case"bottom-right":case"right":i=-e;break;case"top-left":case"bottom-left":case"left":i=e}}return[i,a]}function E7(t,e,r,i,a,s,c,u,d,p,m){t.createArrays(),t.tilePixelRatio=Ae/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const _=t.layers[0].layout,y=t.layers[0]._unevaluatedLayout._values,v={};if(t.textSizeData.kind==="composite"){const{minZoom:M,maxZoom:C}=t.textSizeData;v.compositeTextSizes=[y["text-size"].possiblyEvaluate(new mn(M),u),y["text-size"].possiblyEvaluate(new mn(C),u)]}if(t.iconSizeData.kind==="composite"){const{minZoom:M,maxZoom:C}=t.iconSizeData;v.compositeIconSizes=[y["icon-size"].possiblyEvaluate(new mn(M),u),y["icon-size"].possiblyEvaluate(new mn(C),u)]}v.layoutTextSize=y["text-size"].possiblyEvaluate(new mn(d+1),u),v.layoutIconSize=y["icon-size"].possiblyEvaluate(new mn(d+1),u),v.textMaxSize=y["text-size"].possiblyEvaluate(new mn(18),u);const b=_.get("text-rotation-alignment")==="map"&&_.get("symbol-placement")!=="point",S=_.get("text-size");let T=!1;for(const M of t.features)if(M.icon&&M.icon.nameSecondary){T=!0;break}for(const M of t.features){const C=_.get("text-font").evaluate(M,{},u).join(","),P=S.evaluate(M,{},u),k=v.layoutTextSize.evaluate(M,{},u),z=(v.layoutIconSize.evaluate(M,{},u),{horizontal:{},vertical:void 0}),L=M.text;let B,W=[0,0];if(L){const H=L.toString(),J=_.get("text-letter-spacing").evaluate(M,{},u)*Xn,Q=_.get("text-line-height").evaluate(M,{},u)*Xn,K=QL(H)?J:0,fe=_.get("text-anchor").evaluate(M,{},u),he=_.get("text-variable-anchor");if(!he){const Ce=_.get("text-radial-offset").evaluate(M,{},u);W=Ce?Uv(fe,[Ce*Xn,Vv]):_.get("text-offset").evaluate(M,{},u).map(Se=>Se*Xn)}let _e=b?"center":_.get("text-justify").evaluate(M,{},u);const oe=_.get("symbol-placement")==="point",me=oe?_.get("text-max-width").evaluate(M,{},u)*Xn:1/0,ve=Ce=>{t.allowVerticalPlacement&&v1(H)&&(z.vertical=$v(L,e,r,a,C,me,Q,fe,Ce,K,W,sn.vertical,!0,k,P))};if(!b&&he){const Ce=_e==="auto"?he.map(Je=>Gv(Je)):[_e];let Se=!1;for(let Je=0;Je<Ce.length;Je++){const Ge=Ce[Je];if(!z.horizontal[Ge])if(Se)z.horizontal[Ge]=z.horizontal[0];else{const je=$v(L,e,r,a,C,me,Q,"center",Ge,K,W,sn.horizontal,!1,k,P);je&&(z.horizontal[Ge]=je,Se=je.positionedLines.length===1)}}ve("left")}else{if(_e==="auto"&&(_e=Gv(fe)),oe||_.get("text-writing-mode").indexOf("horizontal")>=0||!v1(H)){const Ce=$v(L,e,r,a,C,me,Q,fe,_e,K,W,sn.horizontal,!1,k,P);Ce&&(z.horizontal[_e]=Ce)}ve(oe?"left":_e)}}let Z=!1;if(M.icon&&M.icon.namePrimary){const H=i[M.icon.namePrimary];H&&(B=g7(a[M.icon.namePrimary],M.icon.nameSecondary?a[M.icon.nameSecondary]:void 0,_.get("icon-offset").evaluate(M,{},u),_.get("icon-anchor").evaluate(M,{},u)),Z=H.sdf,t.sdfIcons===void 0?t.sdfIcons=H.sdf:t.sdfIcons!==H.sdf&&re("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(H.pixelRatio!==t.pixelRatio||_.get("icon-rotate").constantOr(1)!==0)&&(t.iconsNeedLinear=!0))}const X=RM(z.horizontal)||z.vertical;t.iconsInText||(t.iconsInText=!!X&&X.iconsInText),(X||B)&&S7(t,M,z,B,i,v,k,0,W,Z,c,u,p,m,T)}s&&t.generateCollisionDebugBuffers(d,t.collisionBoxArray)}function Gv(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function S7(t,e,r,i,a,s,c,u,d,p,m,_,y,v,b){let S=s.textMaxSize.evaluate(e,{},_);S===void 0&&(S=c);const T=t.layers[0].layout,M=T.get("icon-offset").evaluate(e,{},_),C=RM(r.horizontal)||r.vertical,P=y.name==="globe",k=Xn,z=c/k,L=t.tilePixelRatio*S/k,B=(fe=t.overscaling,t.zoom>18&&fe>2&&(fe>>=1),Math.max(Ae/(512*fe),1)*T.get("symbol-spacing")),W=T.get("text-padding")*t.tilePixelRatio,Z=T.get("icon-padding")*t.tilePixelRatio,X=se(T.get("text-max-angle")),H=T.get("text-rotation-alignment")==="map"&&T.get("symbol-placement")!=="point",J=T.get("icon-rotation-alignment")==="map"&&T.get("symbol-placement")!=="point",Q=T.get("symbol-placement"),K=B/2;var fe;const he=T.get("icon-text-fit").evaluate(e,{},_),_e=T.get("icon-text-fit-padding").evaluate(e,{},_),oe=he!=="none";let me;t.hasAnyIconTextFit===!1&&oe&&(t.hasAnyIconTextFit=!0),i&&oe&&(t.allowVerticalPlacement&&r.vertical&&(me=xM(i,r.vertical,he,_e,M,z)),C&&(i=xM(i,C,he,_e,M,z)));const ve=(Ce,Se,Je)=>{if(Se.x<0||Se.x>=Ae||Se.y<0||Se.y>=Ae)return;let Ge=null;if(P){const{x:je,y:Ve,z:nt}=y.projectTilePoint(Se.x,Se.y,Je);Ge={anchor:new as(je,Ve,nt,0,void 0),up:y.upVector(Je,Se.x,Se.y)}}(function(je,Ve,nt,wt,pt,dt,Et,nr,er,Rr,tr,ir,Dt,Yt,zr,Kt,Or,Tn,Mn,dn,rn,Ln,cn,jn,Fr,Ri,Hu){const cs=je.addToLineVertexArray(Ve,wt);let us,lf,cf,Lg,RA,zA,DA,LA=0,OA=0,FA=0,BA=0,jx=-1,$x=-1;const La={};let NA=U1("");const lc=nt?nt.anchor:Ve,Vx=er.layout.get("icon-text-fit").evaluate(rn,{},Fr)!=="none";let Ux=0,Gx=0;if(er._unevaluatedLayout.getValue("text-radial-offset")===void 0?[Ux,Gx]=er.layout.get("text-offset").evaluate(rn,{},Fr).map(Zi=>Zi*Xn):(Ux=er.layout.get("text-radial-offset").evaluate(rn,{},Fr)*Xn,Gx=Vv),je.allowVerticalPlacement&&pt.vertical){const Zi=pt.vertical;if(zr)zA=Wv(Zi),nr&&(DA=Wv(nr));else{const Xi=er.layout.get("text-rotate").evaluate(rn,{},Fr)+90;cf=Xm(Rr,lc,Ve,tr,ir,Dt,Zi,Yt,Xi,Kt),nr&&(Lg=Xm(Rr,lc,Ve,tr,ir,Dt,nr,Tn,Xi))}}if(dt){const Zi=er.layout.get("icon-rotate").evaluate(rn,{},Fr),Xi=IM(dt,Zi,cn,Vx),qu=nr?IM(nr,Zi,cn,Vx):void 0;lf=Xm(Rr,lc,Ve,tr,ir,Dt,dt,Tn,Zi),LA=4*Xi.length;const jA=je.iconSizeData;let cc=null;jA.kind==="source"?(cc=[ta*er.layout.get("icon-size").evaluate(rn,{},Fr)],cc[0]>tl&&re(`${je.layerIds[0]}: Value for "icon-size" is >= ${Nd}. Reduce your "icon-size".`)):jA.kind==="composite"&&(cc=[ta*Ln.compositeIconSizes[0].evaluate(rn,{},Fr),ta*Ln.compositeIconSizes[1].evaluate(rn,{},Fr)],(cc[0]>tl||cc[1]>tl)&&re(`${je.layerIds[0]}: Value for "icon-size" is >= ${Nd}. Reduce your "icon-size".`)),je.addSymbols(je.icon,Xi,cc,dn,Mn,rn,!1,nt,Ve,cs.lineStartIndex,cs.lineLength,-1,jn,Fr,Ri,Hu),jx=je.icon.placedSymbolArray.length-1,qu&&(OA=4*qu.length,je.addSymbols(je.icon,qu,cc,dn,Mn,rn,sn.vertical,nt,Ve,cs.lineStartIndex,cs.lineLength,-1,jn,Fr,Ri,Hu),$x=je.icon.placedSymbolArray.length-1)}for(const Zi in pt.horizontal){const Xi=pt.horizontal[Zi];us||(NA=U1(Xi.text),zr?RA=Wv(Xi):us=Xm(Rr,lc,Ve,tr,ir,Dt,Xi,Yt,er.layout.get("text-rotate").evaluate(rn,{},Fr),Kt));const qu=Xi.positionedLines.length===1;if(FA+=kM(je,nt,Ve,Xi,Et,er,zr,rn,Kt,cs,pt.vertical?sn.horizontal:sn.horizontalOnly,qu?Object.keys(pt.horizontal):[Zi],La,jx,Ln,jn,Fr,Ri),qu)break}pt.vertical&&(BA+=kM(je,nt,Ve,pt.vertical,Et,er,zr,rn,Kt,cs,sn.vertical,["vertical"],La,$x,Ln,jn,Fr,Ri));let hl=-1;const Wx=(Zi,Xi)=>Zi?Math.max(Zi,Xi):Xi;hl=Wx(RA,hl),hl=Wx(zA,hl),hl=Wx(DA,hl);const Kj=hl>-1?1:0;je.glyphOffsetArray.length>=Gd.MAX_GLYPHS&&re("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),rn.sortKey!==void 0&&je.addToSortKeyRanges(je.symbolInstances.length,rn.sortKey),je.symbolInstances.emplaceBack(lc.x,lc.y,lc.z,Ve.x,Ve.y,La.right>=0?La.right:-1,La.center>=0?La.center:-1,La.left>=0?La.left:-1,La.vertical>=0?La.vertical:-1,jx,$x,NA,us!==void 0?us:je.collisionBoxArray.length,us!==void 0?us+1:je.collisionBoxArray.length,cf!==void 0?cf:je.collisionBoxArray.length,cf!==void 0?cf+1:je.collisionBoxArray.length,lf!==void 0?lf:je.collisionBoxArray.length,lf!==void 0?lf+1:je.collisionBoxArray.length,Lg||je.collisionBoxArray.length,Lg?Lg+1:je.collisionBoxArray.length,tr,FA,BA,LA,OA,Kj,0,Ux,Gx,hl,Vx?1:0)})(t,Se,Ge,Ce,r,i,a,me,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,W,H,d,0,Z,J,M,e,s,p,m,_,v,b)};if(Q==="line")for(const Ce of MM(e.geometry,0,0,Ae,Ae)){const Se=y7(Ce,B,X,r.vertical||C,i,k,L,t.overscaling,Ae);for(const Je of Se)C&&T7(t,C.text,K,Je)||ve(Ce,Je,_)}else if(Q==="line-center"){for(const Ce of e.geometry)if(Ce.length>1){const Se=_7(Ce,X,r.vertical||C,i,k,L);Se&&ve(Ce,Se,_)}}else if(e.type==="Polygon")for(const Ce of kv(e.geometry,0)){const Se=x7(Ce,16);ve(Ce[0],new as(Se.x,Se.y,0,0,void 0),_)}else if(e.type==="LineString")for(const Ce of e.geometry)ve(Ce,new as(Ce[0].x,Ce[0].y,0,0,void 0),_);else if(e.type==="Point")for(const Ce of e.geometry)for(const Se of Ce)ve([Se],new as(Se.x,Se.y,0,0,void 0),_)}const Nd=255,tl=Nd*ta;function kM(t,e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T,M){const C=function(z,L,B,W,Z,X,H,J){const Q=[];if(L.positionedLines.length===0)return Q;const K=W.layout.get("text-rotate").evaluate(X,{})*Math.PI/180,fe=function(ve){const Ce=ve[0],Se=ve[1],Je=Ce*Se;return Je>0?[Ce,-Se]:Je<0?[-Ce,Se]:Ce===0?[Se,Ce]:[Se,-Ce]}(B);let he=Math.abs(L.top-L.bottom);for(const ve of L.positionedLines)he-=ve.lineOffset;const _e=L.positionedLines.length,oe=he/_e;let me=L.top-B[1];for(let ve=0;ve<_e;++ve){const Ce=L.positionedLines[ve];me=v7(L,oe,me,ve);for(const Se of Ce.positionedGlyphs){if(!Se.rect)continue;const Je=Se.rect||{};let Ge=dM+1,je=!0,Ve=1,nt=0;if(Se.imageName){const dn=H[Se.imageName];if(!dn)continue;if(dn.sdf){re("SDF images are not supported in formatted text and will be ignored.");continue}je=!1,Ve=dn.pixelRatio,Ge=ki/Ve}const wt=(Z||J)&&Se.vertical,pt=Se.metrics.advance*Se.scale/2,dt=Se.metrics,Et=Se.rect;if(Et===null)continue;J&&L.verticalizable&&(nt=Se.imageName?pt-Se.metrics.width*Se.scale/2:0);const nr=Z?[Se.x+pt,Se.y]:[0,0];let er=[0,0],Rr=[0,0],tr=!1;Z||(wt?(Rr=[Se.x+pt+fe[0],Se.y+fe[1]-nt],tr=!0):er=[Se.x+pt+B[0],Se.y+B[1]-nt]);const ir=Et.w*Se.scale/(Ve*(Se.localGlyph?ra:1)),Dt=Et.h*Se.scale/(Ve*(Se.localGlyph?ra:1));let Yt,zr,Kt,Or;if(wt){const dn=Se.y-me,rn=new $(-pt,pt-dn),Ln=-Math.PI/2,cn=new $(...Rr);Yt=new $(-pt+er[0],er[1]),Yt._rotateAround(Ln,rn)._add(cn),Yt.x+=-dn+pt,Yt.y-=(dt.left-Ge)*Se.scale;const jn=Se.imageName?dt.advance*Se.scale:Xn*Se.scale,Fr=String.fromCodePoint(Se.glyph);c7(Fr)?Yt.x+=(1-Ge)*Se.scale:u7(Fr)?Yt.x+=jn-dt.height*Se.scale+(-Ge-1)*Se.scale:Yt.x+=Se.imageName||dt.width+2*Ge===Et.w&&dt.height+2*Ge===Et.h?(jn-Dt)/2:(jn-(dt.height+2*Ge)*Se.scale)/2,zr=new $(Yt.x,Yt.y-ir),Kt=new $(Yt.x+Dt,Yt.y),Or=new $(Yt.x+Dt,Yt.y-ir)}else{const dn=(dt.left-Ge)*Se.scale-pt+er[0],rn=(-dt.top-Ge)*Se.scale+er[1],Ln=dn+ir,cn=rn+Dt;Yt=new $(dn,rn),zr=new $(Ln,rn),Kt=new $(dn,cn),Or=new $(Ln,cn)}if(K){let dn;dn=Z?new $(0,0):tr?new $(fe[0],fe[1]):new $(B[0],B[1]),Yt._rotateAround(K,dn),zr._rotateAround(K,dn),Kt._rotateAround(K,dn),Or._rotateAround(K,dn)}const Tn=new $(0,0),Mn=new $(0,0);Q.push({tl:Yt,tr:zr,bl:Kt,br:Or,texPrimary:Je,texSecondary:void 0,writingMode:L.writingMode,glyphOffset:nr,sectionIndex:Se.sectionIndex,isSDF:je,pixelOffsetTL:Tn,pixelOffsetBR:Mn,minFontScaleX:0,minFontScaleY:0})}}return Q}(0,i,d,s,c,u,a,t.allowVerticalPlacement),P=t.textSizeData;let k=null;P.kind==="source"?(k=[ta*s.layout.get("text-size").evaluate(u,{},T)],k[0]>tl&&re(`${t.layerIds[0]}: Value for "text-size" is >= ${Nd}. Reduce your "text-size".`)):P.kind==="composite"&&(k=[ta*b.compositeTextSizes[0].evaluate(u,{},T),ta*b.compositeTextSizes[1].evaluate(u,{},T)],(k[0]>tl||k[1]>tl)&&re(`${t.layerIds[0]}: Value for "text-size" is >= ${Nd}. Reduce your "text-size".`)),t.addSymbols(t.text,C,k,d,c,u,m,e,r,p.lineStartIndex,p.lineLength,v,S,T,M,!1);for(const z of _)y[z]=t.text.placedSymbolArray.length-1;return 4*C.length}function RM(t){for(const e in t)return t[e];return null}function Xm(t,e,r,i,a,s,c,u,d,p){let m=c.top,_=c.bottom,y=c.left,v=c.right;const b=c.collisionPadding;if(b&&(y-=b[0],m-=b[1],v+=b[2],_+=b[3]),d){const S=new $(y,m),T=new $(v,m),M=new $(y,_),C=new $(v,_),P=se(d);let k=new $(0,0);p&&(k=new $(p[0],p[1])),S._rotateAround(P,k),T._rotateAround(P,k),M._rotateAround(P,k),C._rotateAround(P,k),y=Math.min(S.x,T.x,M.x,C.x),v=Math.max(S.x,T.x,M.x,C.x),m=Math.min(S.y,T.y,M.y,C.y),_=Math.max(S.y,T.y,M.y,C.y)}return t.emplaceBack(e.x,e.y,e.z,r.x,r.y,y,m,v,_,u,i,a,s),t.length-1}function Wv(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function T7(t,e,r,i){const a=t.compareText;if(e in a){const s=a[e];for(let c=s.length-1;c>=0;c--)if(i.dist(s[c])<r)return!0}else a[e]=[];return a[e].push(i),!1}function zM(t,e){const r=t.fovAboveCenter,i=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,a=(t._camera.position[2]*t.worldSize-i)/Math.cos(t._pitch),s=Math.sin(r)*a/Math.sin(Math.max(Math.PI/2-t._pitch-r,.01)),c=Math.sin(t._pitch)*s+a;return Math.min(1.01*c,a*(1/t._horizonShift))}function ic(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const r=Math.pow(2,-t.z),i=t.x*r,a=(t.x+1)*r,s=t.y*r,c=(t.y+1)*r,u=Hi(i),d=Hi(a),p=zn(s),m=zn(c),_=e.project(u,p),y=e.project(d,p),v=e.project(d,m),b=e.project(u,m);let S=Math.min(_.x,y.x,v.x,b.x),T=Math.min(_.y,y.y,v.y,b.y),M=Math.max(_.x,y.x,v.x,b.x),C=Math.max(_.y,y.y,v.y,b.y);const P=r/16;function k(L,B,W,Z,X,H){const J=(W+X)/2,Q=(Z+H)/2,K=e.project(Hi(J),zn(Q)),fe=Math.max(0,S-K.x,T-K.y,K.x-M,K.y-C);S=Math.min(S,K.x),M=Math.max(M,K.x),T=Math.min(T,K.y),C=Math.max(C,K.y),fe>P&&(k(L,K,W,Z,J,Q),k(K,B,J,Q,X,H))}k(_,y,i,s,a,s),k(y,v,a,s,a,c),k(v,b,a,c,i,c),k(b,_,i,c,i,s),S-=P,T-=P,M+=P,C+=P;const z=1/Math.max(M-S,C-T);return{scale:z,x:S*z,y:T*z,x2:M*z,y2:C*z,projection:e}}function DM(t,e,r,i,a,s,c,u,d){if(d.name==="globe")return dv(t,e,new ns(r,i,a),!1);const p=ic({z:r,x:i,y:a},d);return new _n([(s+p.x/p.scale)*e,e*(p.y/p.scale),c],[(s+p.x2/p.scale)*e,e*(p.y2/p.scale),u])}function LM(t,{x:e,y:r},i=0){return new $(((e-i)*t.scale-t.x)*Ae,(r*t.scale-t.y)*Ae)}function OM(t,e,r=0){return ie.fromValues(((e.x-r)*t.scale-t.x)*Ae,(e.y*t.scale-t.y)*Ae,MT(e.z,e.y))}const M7=ge.identity(new Float32Array(16));class rl{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,r){return{x:0,y:0,z:0}}unproject(e,r){return new zt(0,0)}projectTilePoint(e,r,i){return{x:e,y:r,z:0}}locationPoint(e,r,i=!0){return e._coordinatePoint(e.locationCoordinate(r),i)}pixelsPerMeter(e,r){return jr(1,e)*r}pixelSpaceConversion(e,r,i){return 1}farthestPixelDistance(e){return zM(e,e.pixelsPerMeter)}pointCoordinate(e,r,i,a){const s=e.horizonLineFromTop(!1),c=new $(r,Math.max(s,i));return e.rayIntersectionCoordinate(e.pointRayIntersection(c,a))}pointCoordinate3D(e,r,i){const a=new $(r,i);if(e.elevation)return e.elevation.pointCoordinate(a);{const s=this.pointCoordinate(e,a.x,a.y,0);return[s.x,s.y,s.z]}}isPointAboveHorizon(e,r){if(e.elevation)return!this.pointCoordinate3D(e,r.x,r.y);const i=e.horizonLineFromTop();return r.y<i}createInversionMatrix(e,r){return M7}createTileMatrix(e,r,i){let a,s,c;const u=i.canonical,d=ge.identity(new Float64Array(16));if(this.isReprojectedInTileSpace){const p=ic(u,this);a=1,s=p.x+i.wrap*p.scale,c=p.y,ge.scale(d,d,[a/p.scale,a/p.scale,e.pixelsPerMeter/r])}else a=r/e.zoomScale(u.z),s=(u.x+Math.pow(2,u.z)*i.wrap)*a,c=u.y*a;return ge.translate(d,d,[s,c,0]),ge.scale(d,d,[a/Ae,a/Ae,1]),d}upVector(e,r,i){return[0,0,1]}upVectorScale(e,r,i){return{metersToTile:1}}}class C7 extends rl{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[r,i]=this.parallels=e.parallels||[29.5,45.5],a=Math.sin(se(r));this.n=(a+Math.sin(se(i)))/2,this.c=1+a*(2*this.n-a),this.r0=Math.sqrt(this.c)/this.n}project(e,r){const{n:i,c:a,r0:s}=this,c=se(e-this.center[0]),u=se(r),d=Math.sqrt(a-2*i*Math.sin(u))/i;return{x:d*Math.sin(c*i),y:d*Math.cos(c*i)-s,z:0}}unproject(e,r){const{n:i,c:a,r0:s}=this,c=s+r;let u=Math.atan2(e,Math.abs(c))*Math.sign(c);c*i<0&&(u-=Math.PI*Math.sign(e)*Math.sign(c));const d=se(this.center[0])*i;u=Pt(u,-Math.PI-d,Math.PI-d);const p=ze(ke(u/i)+this.center[0],-180,180),m=Math.asin(ze((a-(e*e+c*c)*i*i)/(2*i),-1,1)),_=ze(ke(m),-An,An);return new zt(p,_)}}const jd=1.340264,$d=-.081106,Vd=893e-6,Ud=.003796,Ym=Math.sqrt(3)/2;class A7 extends rl{project(e,r){r=r/180*Math.PI,e=e/180*Math.PI;const i=Math.asin(Ym*Math.sin(r)),a=i*i,s=a*a*a;return{x:.5*(e*Math.cos(i)/(Ym*(jd+3*$d*a+s*(7*Vd+9*Ud*a)))/Math.PI+.5),y:1-.5*(i*(jd+$d*a+s*(Vd+Ud*a))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let i=r=(2*(1-r)-1)*Math.PI,a=i*i,s=a*a*a;for(let m,_,y,v=0;v<12&&(_=i*(jd+$d*a+s*(Vd+Ud*a))-r,y=jd+3*$d*a+s*(7*Vd+9*Ud*a),m=_/y,i=ze(i-m,-Math.PI/3,Math.PI/3),a=i*i,s=a*a*a,!(Math.abs(m)<1e-12));++v);const c=Ym*e*(jd+3*$d*a+s*(7*Vd+9*Ud*a))/Math.cos(i),u=Math.asin(Math.sin(i)/Ym),d=ze(180*c/Math.PI,-180,180),p=ze(180*u/Math.PI,-An,An);return new zt(d,p)}}class I7 extends rl{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){return{x:.5+e/360,y:.5-r/360,z:0}}unproject(e,r){const i=360*(e-.5),a=ze(360*(.5-r),-An,An);return new zt(i,a)}}const zu=Math.PI/2;function Km(t){return Math.tan((zu+t)/2)}class P7 extends rl{constructor(e){super(e),this.center=e.center||[0,30];const[r,i]=this.parallels=e.parallels||[30,30];let a=se(r),s=se(i);this.southernCenter=a+s<0,this.southernCenter&&(a=-a,s=-s);const c=Math.cos(a),u=Km(a);this.n=a===s?Math.sin(a):Math.log(c/Math.cos(s))/Math.log(Km(s)/u),this.f=c*Math.pow(Km(a),this.n)/this.n}project(e,r){r=se(r),this.southernCenter&&(r=-r),e=se(e-this.center[0]);const i=1e-6,{n:a,f:s}=this;s>0?r<-zu+i&&(r=-zu+i):r>zu-i&&(r=zu-i);const c=s/Math.pow(Km(r),a);let u=c*Math.sin(a*e),d=s-c*Math.cos(a*e);return u=.5*(u/Math.PI+.5),d=.5*(d/Math.PI+.5),{x:u,y:this.southernCenter?d:1-d,z:0}}unproject(e,r){e=(2*e-.5)*Math.PI,this.southernCenter&&(r=1-r),r=(2*(1-r)-.5)*Math.PI;const{n:i,f:a}=this,s=a-r,c=Math.sign(s),u=Math.sign(i)*Math.sqrt(e*e+s*s);let d=Math.atan2(e,Math.abs(s))*c;s*i<0&&(d-=Math.PI*Math.sign(e)*c);const p=ze(ke(d/i)+this.center[0],-180,180),m=ze(ke(2*Math.atan(Math.pow(a/u,1/i))-zu),-An,An);return new zt(p,this.southernCenter?-m:m)}}class FM extends rl{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,r){return{x:ei(e),y:ai(r),z:0}}unproject(e,r){const i=Hi(e),a=zn(r);return new zt(i,a)}}const BM=se(An);class k7 extends rl{project(e,r){const i=(r=se(r))*r,a=i*i;return{x:.5*((e=se(e))*(.8707-.131979*i+a*(a*(.003971*i-.001529*a)-.013791))/Math.PI+.5),y:1-.5*(r*(1.007226+i*(.015085+a*(.028874*i-.044475-.005916*a)))/Math.PI+1),z:0}}unproject(e,r){e=(2*e-.5)*Math.PI;let i=r=(2*(1-r)-1)*Math.PI,a=25,s=0,c=i*i;do{c=i*i;const p=c*c;s=(i*(1.007226+c*(.015085+p*(.028874*c-.044475-.005916*p)))-r)/(1.007226+c*(.045255+p*(.259866*c-.311325-.005916*11*p))),i=ze(i-s,-BM,BM)}while(Math.abs(s)>1e-6&&--a>0);c=i*i;const u=ze(ke(e/(.8707+c*(c*(c*c*c*(.003971-.001529*c)-.013791)-.131979))),-180,180),d=ke(i);return new zt(u,d)}}const NM=se(An);class R7 extends rl{project(e,r){r=se(r),e=se(e);const i=Math.cos(r),a=2/Math.PI,s=Math.acos(i*Math.cos(e/2)),c=Math.sin(s)/s,u=.5*(e*a+2*i*Math.sin(e/2)/c)||0,d=.5*(r+Math.sin(r)/c)||0;return{x:.5*(u/Math.PI+.5),y:1-.5*(d/Math.PI+1),z:0}}unproject(e,r){let i=e=(2*e-.5)*Math.PI,a=r=(2*(1-r)-1)*Math.PI,s=25;const c=1e-6;let u=0,d=0;do{const p=Math.cos(a),m=Math.sin(a),_=2*m*p,y=m*m,v=p*p,b=Math.cos(i/2),S=Math.sin(i/2),T=2*b*S,M=S*S,C=1-v*b*b,P=C?1/C:0,k=C?Math.acos(p*b)*Math.sqrt(1/C):0,z=.5*(2*k*p*S+2*i/Math.PI)-e,L=.5*(k*m+a)-r,B=.5*P*(v*M+k*p*b*y)+1/Math.PI,W=P*(T*_/4-k*m*S),Z=.125*P*(_*S-k*m*v*T),X=.5*P*(y*b+k*M*p)+.5,H=W*Z-X*B;u=(L*W-z*X)/H,d=(z*Z-L*B)/H,i=ze(i-u,-Math.PI,Math.PI),a=ze(a-d,-NM,NM)}while((Math.abs(u)>c||Math.abs(d)>c)&&--s>0);return new zt(ke(i),ke(a))}}class jM extends rl{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(se(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,r){const{scale:i,cosPhi:a}=this;return{x:se(e)*a*i+.5,y:-Math.sin(se(r))/a*i+.5,z:0}}unproject(e,r){const{scale:i,cosPhi:a}=this,s=-(r-.5)/i,c=ze(ke((e-.5)/i)/a,-180,180),u=Math.asin(ze(s*a,-1,1)),d=ze(ke(u),-An,An);return new zt(c,d)}}class z7 extends FM{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,r,i){const a=Id(e,r,i),s=vu(ea(i));return ie.transformMat4(a,a,s),{x:a[0],y:a[1],z:a[2]}}locationPoint(e,r){const i=Pi(r.lat,r.lng),a=ie.normalize([],i),s=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(r),e._centerAltitude):e._centerAltitude,c=jr(1,0)*Ae*s;ie.scaleAndAdd(i,i,a,c);const u=ge.identity(new Float64Array(16));return ge.multiply(u,e.pixelMatrix,e.globeMatrix),ie.transformMat4(i,i,u),new $(i[0],i[1])}pixelsPerMeter(e,r){return jr(1,0)*r}pixelSpaceConversion(e,r,i){const a=jr(1,e)*r,s=Ft(jr(1,45)*r,a,i);return this.pixelsPerMeter(e,r)/s}createTileMatrix(e,r,i){const a=pv(ea(i.canonical));return ge.multiply(new Float64Array(16),e.globeMatrix,a)}createInversionMatrix(e,r){const{center:i}=e,a=vu(ea(r));return ge.rotateY(a,a,se(i.lng)),ge.rotateX(a,a,se(i.lat)),ge.scale(a,a,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(a)}pointCoordinate(e,r,i,a){return mT(e,r,i,!0)||new cr(0,0)}pointCoordinate3D(e,r,i){const a=this.pointCoordinate(e,r,i,0);return[a.x,a.y,a.z]}isPointAboveHorizon(e,r){return!mT(e,r.x,r.y,!1)}farthestPixelDistance(e){const r=function(a,s){const c=a.cameraToCenterDistance,u=a._centerAltitude*s,d=a._camera,p=a._camera.forward(),m=ie.add([],ie.scale([],p,-c),[0,0,u]),_=a.worldSize/(2*Math.PI),y=[0,0,-_],v=a.width/a.height,b=Math.tan(a.fovAboveCenter),S=ie.scale([],d.up(),b),T=ie.scale([],d.right(),b*v),M=ie.normalize([],ie.add([],ie.add([],p,S),T)),C=[];let P;if(new wm(m,M).closestPointOnSphere(y,_,C)){const k=ie.add([],C,y),z=ie.sub([],k,m);P=Math.cos(a.fovAboveCenter)*ie.length(z)}else{const k=ie.sub([],m,y),z=ie.sub([],y,m);ie.normalize(z,z);const L=ie.length(k)-_;P=Math.sqrt(L*(L+2*_));const B=Math.acos(P/(_+L))-Math.acos(ie.dot(p,z));P*=Math.cos(B)}return 1.01*P}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),i=Qn(e.zoom);if(i>0){const a=zM(e,jr(1,e.center.lat)*e.worldSize),s=e.worldSize/(2*Math.PI),c=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Ft(r,a+s*(1-Math.cos(c)),Math.pow(i,10))}return r}upVector(e,r,i){return Id(r,i,e,1)}upVectorScale(e){return{metersToTile:Em(Tm(ea(e)))}}}function Jm(t){const e=t.parallels,r=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new FM(t);case"equirectangular":return new I7(t);case"naturalEarth":return new k7(t);case"equalEarth":return new A7(t);case"winkelTripel":return new R7(t);case"albers":return r?new jM(t):new C7(t);case"lambertConformalConic":return r?new jM(t):new P7(t);case"globe":return new z7(t)}throw new Error(`Invalid projection name: ${t.name}`)}const D7=new gn({"symbol-placement":new Ke(pe.layout_symbol["symbol-placement"]),"symbol-spacing":new Ke(pe.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Ke(pe.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new St(pe.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Ke(pe.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Ke(pe.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Ke(pe.layout_symbol["icon-ignore-placement"]),"icon-optional":new Ke(pe.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Ke(pe.layout_symbol["icon-rotation-alignment"]),"icon-size":new St(pe.layout_symbol["icon-size"]),"icon-text-fit":new St(pe.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new St(pe.layout_symbol["icon-text-fit-padding"]),"icon-image":new St(pe.layout_symbol["icon-image"]),"icon-rotate":new St(pe.layout_symbol["icon-rotate"]),"icon-padding":new Ke(pe.layout_symbol["icon-padding"]),"icon-keep-upright":new Ke(pe.layout_symbol["icon-keep-upright"]),"icon-offset":new St(pe.layout_symbol["icon-offset"]),"icon-anchor":new St(pe.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Ke(pe.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Ke(pe.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Ke(pe.layout_symbol["text-rotation-alignment"]),"text-field":new St(pe.layout_symbol["text-field"]),"text-font":new St(pe.layout_symbol["text-font"]),"text-size":new St(pe.layout_symbol["text-size"]),"text-max-width":new St(pe.layout_symbol["text-max-width"]),"text-line-height":new St(pe.layout_symbol["text-line-height"]),"text-letter-spacing":new St(pe.layout_symbol["text-letter-spacing"]),"text-justify":new St(pe.layout_symbol["text-justify"]),"text-radial-offset":new St(pe.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Ke(pe.layout_symbol["text-variable-anchor"]),"text-anchor":new St(pe.layout_symbol["text-anchor"]),"text-max-angle":new Ke(pe.layout_symbol["text-max-angle"]),"text-writing-mode":new Ke(pe.layout_symbol["text-writing-mode"]),"text-rotate":new St(pe.layout_symbol["text-rotate"]),"text-padding":new Ke(pe.layout_symbol["text-padding"]),"text-keep-upright":new Ke(pe.layout_symbol["text-keep-upright"]),"text-transform":new St(pe.layout_symbol["text-transform"]),"text-offset":new St(pe.layout_symbol["text-offset"]),"text-allow-overlap":new Ke(pe.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Ke(pe.layout_symbol["text-ignore-placement"]),"text-optional":new Ke(pe.layout_symbol["text-optional"]),visibility:new Ke(pe.layout_symbol.visibility)});var Hv={paint:new gn({"icon-opacity":new St(pe.paint_symbol["icon-opacity"]),"icon-emissive-strength":new St(pe.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new St(pe.paint_symbol["text-emissive-strength"]),"icon-color":new St(pe.paint_symbol["icon-color"]),"icon-halo-color":new St(pe.paint_symbol["icon-halo-color"]),"icon-halo-width":new St(pe.paint_symbol["icon-halo-width"]),"icon-halo-blur":new St(pe.paint_symbol["icon-halo-blur"]),"icon-translate":new Ke(pe.paint_symbol["icon-translate"]),"icon-translate-anchor":new Ke(pe.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new St(pe.paint_symbol["icon-image-cross-fade"]),"text-opacity":new St(pe.paint_symbol["text-opacity"]),"text-color":new St(pe.paint_symbol["text-color"],{runtimeType:Io,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new St(pe.paint_symbol["text-halo-color"]),"text-halo-width":new St(pe.paint_symbol["text-halo-width"]),"text-halo-blur":new St(pe.paint_symbol["text-halo-blur"]),"text-translate":new Ke(pe.paint_symbol["text-translate"]),"text-translate-anchor":new Ke(pe.paint_symbol["text-translate-anchor"])}),layout:D7};class $M{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Jc,this.defaultValue=e}evaluate(e){if(e.formattedSection){const r=this.defaultValue.property.overrides;if(r&&r.hasOverride(e.formattedSection))return r.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}ht($M,"FormatSectionOverride",{omit:["defaultValue"]});class Qm extends so{constructor(e,r){super(e,Hv,r)}recalculate(e,r){super.recalculate(e,r),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const i=this.layout.get("text-writing-mode");if(i){const a=[];for(const s of i)a.indexOf(s)<0&&a.push(s);this.layout._values["text-writing-mode"]=a}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,r,i,a){const s=this.layout.get(e).evaluate(r,{},i,a),c=this._unevaluatedLayout._values[e];return c.isDataDriven()||Kp(c.value)||!s?s:function(u,d){return d.replace(/{([^{}]+)}/g,(p,m)=>m in u?String(u[m]):"")}(r.properties,s)}createBucket(e){return new Gd(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Hv.paint.overridableProperties){if(!Qm.hasPaintOverride(this.layout,e))continue;const r=this.paint.get(e),i=new $M(r),a=new d1(i,r.property.specification);let s=null;s=r.value.kind==="constant"||r.value.kind==="source"?new f1("source",a):new Jp("composite",a,r.value.zoomStops,r.value._interpolationType),this.paint._values[e]=new du(r.property,s,r.parameters)}}_handleOverridablePaintPropertyUpdate(e,r,i){return!(!this.layout||r.isDataDriven()||i.isDataDriven())&&Qm.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,r){const i=e.get("text-field"),a=Hv.paint.properties[r];let s=!1;const c=u=>{for(const d of u)if(a.overrides&&a.overrides.hasOverride(d))return void(s=!0)};if(i.value.kind==="constant"&&i.value.value instanceof Vi)c(i.value.value.sections);else if(i.value.kind==="source"){const u=p=>{s||(p instanceof ud&&Hn(p.value)===od?c(p.value.sections):p instanceof hd?c(p.sections):p.eachChild(u))},d=i.value;d._styleExpression&&u(d._styleExpression.expression)}return s}getProgramConfiguration(e){return new Gs(this,e)}}const L7=Nm.types,O7=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function eg(t,e,r,i,a,s,c,u,d,p,m,_,y){const v=u?Math.min(tl,Math.round(u[0])):0,b=u?Math.min(tl,Math.round(u[1])):0;t.emplaceBack(e,r,Math.round(32*i),Math.round(32*a),s,c,(v<<1)+(d?1:0),b,16*p,16*m,256*_,256*y)}function tg(t,e,r){t.emplaceBack(e,r)}function rg(t,e,r,i,a,s,c){t.emplaceBack(e,r,i,a,s,c)}function ng(t,e,r,i,a){const s=5*e+2;t.float32[s+0]=r,t.float32[s+1]=i,t.float32[s+2]=a}function Du(t,e,r,i,a){t.emplaceBack(e,r,i,a),t.emplaceBack(e,r,i,a),t.emplaceBack(e,r,i,a),t.emplaceBack(e,r,i,a)}function F7(t){for(const e of t.sections)if(rO(e.text))return!0;return!1}class qv{constructor(e){this.layoutVertexArray=new P1,this.indexArray=new Bn,this.programConfigurations=e,this.segments=new Gr,this.dynamicLayoutVertexArray=new Ns,this.opacityVertexArray=new R1,this.placedSymbolArray=new FS,this.iconTransitioningVertexArray=new $s,this.globeExtVertexArray=new k1}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(e,r,i,a){this.isEmpty()||(i&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,e7.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,r),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,r7.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,O7,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=e.createVertexBuffer(this.iconTransitioningVertexArray,n7.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,t7.members,!0)),this.opacityVertexBuffer.itemSize=1),(i||a)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}ht(qv,"SymbolBuffers");class Zv{constructor(e,r,i){this.layoutVertexArray=new e,this.layoutAttributes=r,this.indexArray=new i,this.segments=new Gr,this.collisionVertexArray=new L1,this.collisionVertexArrayExt=new Vs}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,i7.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,o7.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}ht(Zv,"CollisionBuffers");class ig{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(c=>c.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ge.identity([]),this.placementViewportMatrix=ge.identity([]);const r=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Fv(this.zoom,r["text-size"]),this.iconSizeData=Fv(this.zoom,r["icon-size"]);const i=this.layers[0].layout,a=i.get("symbol-sort-key"),s=i.get("symbol-z-order");this.canOverlap=i.get("text-allow-overlap")||i.get("icon-allow-overlap")||i.get("text-ignore-placement")||i.get("icon-ignore-placement"),this.sortFeaturesByKey=s!=="viewport-y"&&a.constantOr(1)!==void 0,this.sortFeaturesByY=(s==="viewport-y"||s==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=i.get("text-writing-mode").map(c=>sn[c]),this.stateDependentLayerIds=this.layers.filter(c=>c.isStateDependent()).map(c=>c.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new qv(new Ws(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new qv(new Ws(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new jS,this.lineVertexArray=new $S,this.symbolInstances=new NS}calculateGlyphDependencies(e,r,i,a,s){for(let c=0;c<e.length;c++){const u=e.codePointAt(c);if(u===void 0)break;if(r[u]=!0,a&&s&&u<=65535){const d=Od[e.charAt(c)];d&&(r[d.charCodeAt(0)]=!0)}}}populate(e,r,i,a){const s=this.layers[0],c=s.layout,u=this.projection.name==="globe",d=c.get("text-font"),p=c.get("text-field"),m=c.get("icon-image"),_=(p.value.kind!=="constant"||p.value.value instanceof Vi&&!p.value.value.isEmpty()||p.value.value.toString().length>0)&&(d.value.kind!=="constant"||d.value.value.length>0),y=m.value.kind!=="constant"||!!m.value.value||Object.keys(m.parameters).length>0,v=c.get("symbol-sort-key");if(this.features=[],!_&&!y)return;const b=r.iconDependencies,S=r.glyphDependencies,T=r.availableImages,M=new mn(this.zoom);for(const{feature:C,id:P,index:k,sourceLayerIndex:z}of e){const L=s._featureFilter.needGeometry,B=Ks(C,L);if(!s._featureFilter.filter(M,B,i))continue;if(L||(B.geometry=Pa(C,i,a)),u&&C.type!==1&&i.z<=5){const H=B.geometry,J=.98078528056,Q=(K,fe)=>{const he=Id(K.x,K.y,i,1),_e=Id(fe.x,fe.y,i,1);return ie.dot(he,_e)<J};for(let K=0;K<H.length;K++)H[K]=YO(H[K],Q)}let W,Z;if(_){const H=s.getValueAndResolveTokens("text-field",B,i,T),J=Vi.factory(H);F7(J)&&(this.hasRTLText=!0),(!this.hasRTLText||C1()==="unavailable"||this.hasRTLText&&Ro.isParsed())&&(W=l7(J,s,B))}if(y){const H=s.getValueAndResolveTokens("icon-image",B,i,T);Z=H instanceof Po?H:Po.fromString(H)}if(!W&&!Z)continue;const X=this.sortFeaturesByKey?v.evaluate(B,{},i):void 0;if(this.features.push({id:P,text:W,icon:Z,index:k,sourceLayerIndex:z,geometry:B.geometry,properties:C.properties,type:L7[C.type],sortKey:X}),Z&&(b[Z.namePrimary]=!0,Z.nameSecondary&&(b[Z.nameSecondary]=!0)),W){const H=d.evaluate(B,{},i).join(","),J=c.get("text-rotation-alignment")==="map"&&c.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(sn.vertical)>=0;for(const Q of W.sections)if(Q.image)b[Q.image.namePrimary]=!0;else{const K=v1(W.toString()),fe=Q.fontStack||H,he=S[fe]=S[fe]||{};this.calculateGlyphDependencies(Q.text,he,J,this.allowVerticalPlacement,K)}}}c.get("symbol-placement")==="line"&&(this.features=function(C){const P={},k={},z=[];let L=0;function B(H){z.push(C[H]),L++}function W(H,J,Q){const K=k[H];return delete k[H],k[J]=K,z[K].geometry[0].pop(),z[K].geometry[0]=z[K].geometry[0].concat(Q[0]),K}function Z(H,J,Q){const K=P[J];return delete P[J],P[H]=K,z[K].geometry[0].shift(),z[K].geometry[0]=Q[0].concat(z[K].geometry[0]),K}function X(H,J,Q){const K=Q?J[0][J[0].length-1]:J[0][0];return`${H}:${K.x}:${K.y}`}for(let H=0;H<C.length;H++){const J=C[H],Q=J.geometry,K=J.text?J.text.toString():null;if(!K){B(H);continue}const fe=X(K,Q),he=X(K,Q,!0);if(fe in k&&he in P&&k[fe]!==P[he]){const _e=Z(fe,he,Q),oe=W(fe,he,z[_e].geometry);delete P[fe],delete k[he],k[X(K,z[oe].geometry,!0)]=oe,z[_e].geometry=null}else fe in k?W(fe,he,Q):he in P?Z(fe,he,Q):(B(H),P[fe]=L-1,k[he]=L-1)}return z.filter(H=>H.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((C,P)=>C.sortKey-P.sortKey)}update(e,r,i,a,s){const c=Object.keys(e).length!==0;if(c&&!this.stateDependentLayers.length)return;const u=c?this.stateDependentLayers:this.layers;this.text.programConfigurations.updatePaintArrays(e,r,u,i,a,s),this.icon.programConfigurations.updatePaintArrays(e,r,u,i,a,s)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=Jm(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,r){const i=this.lineVertexArray.length;if(e.segment!==void 0)for(const{x:a,y:s}of r)this.lineVertexArray.emplaceBack(a,s);return{lineStartIndex:i,lineLength:this.lineVertexArray.length-i}}addSymbols(e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T){const M=e.indexArray,C=e.layoutVertexArray,P=e.globeExtVertexArray,k=e.segments.prepareSegment(4*r.length,C,M,this.canOverlap?c.sortKey:void 0),z=this.glyphOffsetArray.length,L=k.vertexLength,B=this.allowVerticalPlacement&&u===sn.vertical?Math.PI/2:0,W=c.text&&c.text.sections;for(let X=0;X<r.length;X++){const{tl:H,tr:J,bl:Q,br:K,texPrimary:fe,texSecondary:he,pixelOffsetTL:_e,pixelOffsetBR:oe,minFontScaleX:me,minFontScaleY:ve,glyphOffset:Ce,isSDF:Se,sectionIndex:Je}=r[X],Ge=k.vertexLength,je=Ce[1];if(eg(C,p.x,p.y,H.x,je+H.y,fe.x,fe.y,i,Se,_e.x,_e.y,me,ve),eg(C,p.x,p.y,J.x,je+J.y,fe.x+fe.w,fe.y,i,Se,oe.x,_e.y,me,ve),eg(C,p.x,p.y,Q.x,je+Q.y,fe.x,fe.y+fe.h,i,Se,_e.x,oe.y,me,ve),eg(C,p.x,p.y,K.x,je+K.y,fe.x+fe.w,fe.y+fe.h,i,Se,oe.x,oe.y,me,ve),d){const{x:Ve,y:nt,z:wt}=d.anchor,[pt,dt,Et]=d.up;rg(P,Ve,nt,wt,pt,dt,Et),rg(P,Ve,nt,wt,pt,dt,Et),rg(P,Ve,nt,wt,pt,dt,Et),rg(P,Ve,nt,wt,pt,dt,Et),Du(e.dynamicLayoutVertexArray,Ve,nt,wt,B)}else Du(e.dynamicLayoutVertexArray,p.x,p.y,p.z,B);if(T){const Ve=he||fe;tg(e.iconTransitioningVertexArray,Ve.x,Ve.y),tg(e.iconTransitioningVertexArray,Ve.x+Ve.w,Ve.y),tg(e.iconTransitioningVertexArray,Ve.x,Ve.y+Ve.h),tg(e.iconTransitioningVertexArray,Ve.x+Ve.w,Ve.y+Ve.h)}M.emplaceBack(Ge,Ge+1,Ge+2),M.emplaceBack(Ge+1,Ge+2,Ge+3),k.vertexLength+=4,k.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Ce[0]),X!==r.length-1&&Je===r[X+1].sectionIndex||e.programConfigurations.populatePaintArrays(C.length,c,c.index,{},v,b,S,W&&W[Je])}const Z=d?d.anchor:p;e.placedSymbolArray.emplaceBack(Z.x,Z.y,Z.z,p.x,p.y,z,this.glyphOffsetArray.length-z,L,m,_,p.segment,i?i[0]:0,i?i[1]:0,a[0],a[1],u,0,!1,0,y,0)}_commitLayoutVertex(e,r,i,a,s,c,u){e.emplaceBack(r,i,a,s,c,Math.round(u.x),Math.round(u.y))}_addCollisionDebugVertices(e,r,i,a,s,c,u){const d=i.segments.prepareSegment(4,i.layoutVertexArray,i.indexArray),p=d.vertexLength,m=u.tileAnchorX,_=u.tileAnchorY;for(let v=0;v<4;v++)i.collisionVertexArray.emplaceBack(0,0,0,0);i.collisionVertexArrayExt.emplaceBack(r,-e.padding,-e.padding),i.collisionVertexArrayExt.emplaceBack(r,e.padding,-e.padding),i.collisionVertexArrayExt.emplaceBack(r,e.padding,e.padding),i.collisionVertexArrayExt.emplaceBack(r,-e.padding,e.padding),this._commitLayoutVertex(i.layoutVertexArray,a,s,c,m,_,new $(e.x1,e.y1)),this._commitLayoutVertex(i.layoutVertexArray,a,s,c,m,_,new $(e.x2,e.y1)),this._commitLayoutVertex(i.layoutVertexArray,a,s,c,m,_,new $(e.x2,e.y2)),this._commitLayoutVertex(i.layoutVertexArray,a,s,c,m,_,new $(e.x1,e.y2)),d.vertexLength+=4;const y=i.indexArray;y.emplaceBack(p,p+1),y.emplaceBack(p+1,p+2),y.emplaceBack(p+2,p+3),y.emplaceBack(p+3,p),d.primitiveLength+=4}_addTextDebugCollisionBoxes(e,r,i,a,s,c){for(let u=a;u<s;u++){const d=i.get(u),p=this.getSymbolInstanceTextSize(e,c,r,u);this._addCollisionDebugVertices(d,p,this.textCollisionBox,d.projectedAnchorX,d.projectedAnchorY,d.projectedAnchorZ,c)}}_addIconDebugCollisionBoxes(e,r,i,a,s,c){for(let u=a;u<s;u++){const d=i.get(u),p=this.getSymbolInstanceIconSize(e,r,c.placedIconSymbolIndex);this._addCollisionDebugVertices(d,p,this.iconCollisionBox,d.projectedAnchorX,d.projectedAnchorY,d.projectedAnchorZ,c)}}generateCollisionDebugBuffers(e,r){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Zv(fm,hM.members,$s),this.iconCollisionBox=new Zv(fm,hM.members,$s);const i=ka(this.iconSizeData,e),a=ka(this.textSizeData,e);for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this._addTextDebugCollisionBoxes(a,e,r,c.textBoxStartIndex,c.textBoxEndIndex,c),this._addTextDebugCollisionBoxes(a,e,r,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c),this._addIconDebugCollisionBoxes(i,e,r,c.iconBoxStartIndex,c.iconBoxEndIndex,c),this._addIconDebugCollisionBoxes(i,e,r,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c)}}getSymbolInstanceTextSize(e,r,i,a){const s=this.text.placedSymbolArray.get(r.rightJustifiedTextSymbolIndex>=0?r.rightJustifiedTextSymbolIndex:r.centerJustifiedTextSymbolIndex>=0?r.centerJustifiedTextSymbolIndex:r.leftJustifiedTextSymbolIndex>=0?r.leftJustifiedTextSymbolIndex:r.verticalPlacedTextSymbolIndex>=0?r.verticalPlacedTextSymbolIndex:a),c=Ld(this.textSizeData,e,s)/Xn;return this.tilePixelRatio*c}getSymbolInstanceIconSize(e,r,i){const a=this.icon.placedSymbolArray.get(i),s=Ld(this.iconSizeData,e,a);return this.tilePixelRatio*s}_commitDebugCollisionVertexUpdate(e,r,i){e.emplaceBack(r,-i,-i),e.emplaceBack(r,i,-i),e.emplaceBack(r,i,i),e.emplaceBack(r,-i,i)}_updateTextDebugCollisionBoxes(e,r,i,a,s,c){for(let u=a;u<s;u++){const d=i.get(u),p=this.getSymbolInstanceTextSize(e,c,r,u);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,p,d.padding)}}_updateIconDebugCollisionBoxes(e,r,i,a,s,c){for(let u=a;u<s;u++){const d=i.get(u),p=this.getSymbolInstanceIconSize(e,r,c);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,p,d.padding)}}updateCollisionDebugBuffers(e,r){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const i=ka(this.iconSizeData,e),a=ka(this.textSizeData,e);for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this._updateTextDebugCollisionBoxes(a,e,r,c.textBoxStartIndex,c.textBoxEndIndex,c),this._updateTextDebugCollisionBoxes(a,e,r,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c),this._updateIconDebugCollisionBoxes(i,e,r,c.iconBoxStartIndex,c.iconBoxEndIndex,c.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(i,e,r,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex,c.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,r,i,a,s,c,u,d,p){const m={};if(r<i){const{x1:_,y1:y,x2:v,y2:b,padding:S,projectedAnchorX:T,projectedAnchorY:M,projectedAnchorZ:C,tileAnchorX:P,tileAnchorY:k,featureIndex:z}=e.get(r);m.textBox={x1:_,y1:y,x2:v,y2:b,padding:S,projectedAnchorX:T,projectedAnchorY:M,projectedAnchorZ:C,tileAnchorX:P,tileAnchorY:k},m.textFeatureIndex=z}if(a<s){const{x1:_,y1:y,x2:v,y2:b,padding:S,projectedAnchorX:T,projectedAnchorY:M,projectedAnchorZ:C,tileAnchorX:P,tileAnchorY:k,featureIndex:z}=e.get(a);m.verticalTextBox={x1:_,y1:y,x2:v,y2:b,padding:S,projectedAnchorX:T,projectedAnchorY:M,projectedAnchorZ:C,tileAnchorX:P,tileAnchorY:k},m.verticalTextFeatureIndex=z}if(c<u){const{x1:_,y1:y,x2:v,y2:b,padding:S,projectedAnchorX:T,projectedAnchorY:M,projectedAnchorZ:C,tileAnchorX:P,tileAnchorY:k,featureIndex:z}=e.get(c);m.iconBox={x1:_,y1:y,x2:v,y2:b,padding:S,projectedAnchorX:T,projectedAnchorY:M,projectedAnchorZ:C,tileAnchorX:P,tileAnchorY:k},m.iconFeatureIndex=z}if(d<p){const{x1:_,y1:y,x2:v,y2:b,padding:S,projectedAnchorX:T,projectedAnchorY:M,projectedAnchorZ:C,tileAnchorX:P,tileAnchorY:k,featureIndex:z}=e.get(d);m.verticalIconBox={x1:_,y1:y,x2:v,y2:b,padding:S,projectedAnchorX:T,projectedAnchorY:M,projectedAnchorZ:C,tileAnchorX:P,tileAnchorY:k},m.verticalIconFeatureIndex=z}return m}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let r=0;r<this.symbolInstances.length;r++){const i=this.symbolInstances.get(r);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,i.textBoxStartIndex,i.textBoxEndIndex,i.verticalTextBoxStartIndex,i.verticalTextBoxEndIndex,i.iconBoxStartIndex,i.iconBoxEndIndex,i.verticalIconBoxStartIndex,i.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(e,r){const i=e.placedSymbolArray.get(r),a=i.vertexStartIndex+4*i.numGlyphs;for(let s=i.vertexStartIndex;s<a;s+=4)e.indexArray.emplaceBack(s,s+1,s+2),e.indexArray.emplaceBack(s+1,s+2,s+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const r=Math.sin(e),i=Math.cos(e),a=[],s=[],c=[];for(let u=0;u<this.symbolInstances.length;++u){c.push(u);const d=this.symbolInstances.get(u);a.push(0|Math.round(r*d.tileAnchorX+i*d.tileAnchorY)),s.push(d.featureIndex)}return c.sort((u,d)=>a[u]-a[d]||s[d]-s[u]),c}addToSortKeyRanges(e,r){const i=this.sortKeyRanges[this.sortKeyRanges.length-1];i&&i.sortKey===r?i.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:r,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const r of this.symbolInstanceIndexes){const i=this.symbolInstances.get(r);this.featureSortOrder.push(i.featureIndex);const{rightJustifiedTextSymbolIndex:a,centerJustifiedTextSymbolIndex:s,leftJustifiedTextSymbolIndex:c,verticalPlacedTextSymbolIndex:u,placedIconSymbolIndex:d,verticalPlacedIconSymbolIndex:p}=i;a>=0&&this.addIndicesForPlacedSymbol(this.text,a),s>=0&&s!==a&&this.addIndicesForPlacedSymbol(this.text,s),c>=0&&c!==s&&c!==a&&this.addIndicesForPlacedSymbol(this.text,c),u>=0&&this.addIndicesForPlacedSymbol(this.text,u),d>=0&&this.addIndicesForPlacedSymbol(this.icon,d),p>=0&&this.addIndicesForPlacedSymbol(this.icon,p)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}ht(ig,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),ig.MAX_GLYPHS=65535,ig.addDynamicAttributes=Du;var Gd=ig;const B7=Ar([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:N7}=B7,j7=Ar([{name:"a_packed",components:4,type:"Float32"}]),{members:$7}=j7,V7=Nm.types,U7=Math.cos(Math.PI/180*37.5);class og{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(r=>{this.gradients[r.id]={}}),this.layoutVertexArray=new I1,this.layoutVertexArray2=new Ns,this.indexArray=new Bn,this.programConfigurations=new Ws(e.layers,e.zoom),this.segments=new Gr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id)}populate(e,r,i,a){this.hasPattern=Rv("line",this.layers,r);const s=this.layers[0].layout.get("line-sort-key"),c=[];for(const{feature:m,id:_,index:y,sourceLayerIndex:v}of e){const b=this.layers[0]._featureFilter.needGeometry,S=Ks(m,b);if(!this.layers[0]._featureFilter.filter(new mn(this.zoom),S,i))continue;const T=s?s.evaluate(S,{},i):void 0,M={id:_,properties:m.properties,type:m.type,sourceLayerIndex:v,index:y,geometry:b?S.geometry:Pa(m,i,a),patterns:{},sortKey:T};c.push(M)}s&&c.sort((m,_)=>m.sortKey-_.sortKey);const{lineAtlas:u,featureIndex:d}=r,p=this.addConstantDashes(u);for(const m of c){const{geometry:_,index:y,sourceLayerIndex:v}=m;if(p&&this.addFeatureDashes(m,u),this.hasPattern){const b=zv("line",this.layers,m,this.zoom,r);this.patternFeatures.push(b)}else this.addFeature(m,_,y,i,u.positions,r.availableImages,r.brightness);d.insert(e[y].feature,_,y,v,this.index)}}addConstantDashes(e){let r=!1;for(const i of this.layers){const a=i.paint.get("line-dasharray").value,s=i.layout.get("line-cap").value;if(a.kind!=="constant"||s.kind!=="constant")r=!0;else{const c=s.value,u=a.value;if(!u)continue;e.addDash(u,c)}}return r}addFeatureDashes(e,r){const i=this.zoom;for(const a of this.layers){const s=a.paint.get("line-dasharray").value,c=a.layout.get("line-cap").value;if(s.kind==="constant"&&c.kind==="constant")continue;let u,d;if(s.kind==="constant"){if(u=s.value,!u)continue}else u=s.evaluate({zoom:i},e);d=c.kind==="constant"?c.value:c.evaluate({zoom:i},e),r.addDash(u,d),e.patterns[a.id]=r.getKey(u,d)}}update(e,r,i,a,s){const c=Object.keys(e).length!==0;c&&!this.stateDependentLayers.length||this.programConfigurations.updatePaintArrays(e,r,c?this.stateDependentLayers:this.layers,i,a,s)}addFeatures(e,r,i,a,s,c){for(const u of this.patternFeatures)this.addFeature(u,u.geometry,u.index,r,i,a,c)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,$7)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,N7),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,r,i,a,s,c,u){const d=this.layers[0].layout,p=d.get("line-join").evaluate(e,{}),m=d.get("line-cap").evaluate(e,{}),_=d.get("line-miter-limit"),y=d.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const v of r)this.addLine(v,e,p,m,_,y);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,s,c,a,u)}addLine(e,r,i,a,s,c){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let M=0;M<e.length-1;M++)this.totalDistance+=e[M].dist(e[M+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const u=V7[r.type]==="Polygon";let d=e.length;for(;d>=2&&e[d-1].equals(e[d-2]);)d--;let p=0;for(;p<d-1&&e[p].equals(e[p+1]);)p++;if(d<(u?3:2))return;i==="bevel"&&(s=1.05);const m=this.overscaling<=16?15*Ae/(512*this.overscaling):0,_=this.segments.prepareSegment(10*d,this.layoutVertexArray,this.indexArray);let y,v,b,S,T;this.e1=this.e2=-1,u&&(y=e[d-2],T=e[p].sub(y)._unit()._perp());for(let M=p;M<d;M++){if(b=M===d-1?u?e[p+1]:void 0:e[M+1],b&&e[M].equals(b))continue;T&&(S=T),y&&(v=y),y=e[M],T=b?b.sub(y)._unit()._perp():S,S=S||T;let C=S.add(T);C.x===0&&C.y===0||C._unit();const P=S.x*T.x+S.y*T.y,k=C.x*T.x+C.y*T.y,z=k!==0?1/k:1/0,L=2*Math.sqrt(2-2*k),B=k<U7&&v&&b,W=S.x*T.y-S.y*T.x>0;if(B&&M>p){const H=y.dist(v);if(H>2*m){const J=y.sub(y.sub(v)._mult(m/H)._round());this.updateDistance(v,J),this.addCurrentVertex(J,S,0,0,_),v=J}}const Z=v&&b;let X=Z?i:u?"butt":a;if(Z&&X==="round"&&(z<c?X="miter":z<=2&&(X="fakeround")),X==="miter"&&z>s&&(X="bevel"),X==="bevel"&&(z>2&&(X="flipbevel"),z<s&&(X="miter")),v&&this.updateDistance(v,y),X==="miter")C._mult(z),this.addCurrentVertex(y,C,0,0,_);else if(X==="flipbevel"){if(z>100)C=T.mult(-1);else{const H=z*S.add(T).mag()/S.sub(T).mag();C._perp()._mult(H*(W?-1:1))}this.addCurrentVertex(y,C,0,0,_),this.addCurrentVertex(y,C.mult(-1),0,0,_)}else if(X==="bevel"||X==="fakeround"){const H=-Math.sqrt(z*z-1),J=W?H:0,Q=W?0:H;if(v&&this.addCurrentVertex(y,S,J,Q,_),X==="fakeround"){const K=Math.round(180*L/Math.PI/20);for(let fe=1;fe<K;fe++){let he=fe/K;if(he!==.5){const oe=he-.5;he+=he*oe*(he-1)*((1.0904+P*(P*(3.55645-1.43519*P)-3.2452))*oe*oe+(.848013+P*(.215638*P-1.06021)))}const _e=T.sub(S)._mult(he)._add(S)._unit()._mult(W?-1:1);this.addHalfVertex(y,_e.x,_e.y,!1,W,0,_)}}b&&this.addCurrentVertex(y,T,-J,-Q,_)}else if(X==="butt")this.addCurrentVertex(y,C,0,0,_);else if(X==="square"){const H=v?1:-1;v||this.addCurrentVertex(y,C,H,H,_),this.addCurrentVertex(y,C,0,0,_),v&&this.addCurrentVertex(y,C,H,H,_)}else X==="round"&&(v&&(this.addCurrentVertex(y,S,0,0,_),this.addCurrentVertex(y,S,1,1,_,!0)),b&&(this.addCurrentVertex(y,T,-1,-1,_,!0),this.addCurrentVertex(y,T,0,0,_)));if(B&&M<d-1){const H=y.dist(b);if(H>2*m){const J=y.add(b.sub(y)._mult(m/H)._round());this.updateDistance(y,J),this.addCurrentVertex(J,T,0,0,_),y=J}}}}addCurrentVertex(e,r,i,a,s,c=!1){const u=r.y*a-r.x,d=-r.y-r.x*a;this.addHalfVertex(e,r.x+r.y*i,r.y-r.x*i,c,!1,i,s),this.addHalfVertex(e,u,d,c,!0,-a,s)}addHalfVertex({x:e,y:r},i,a,s,c,u,d){this.layoutVertexArray.emplaceBack((e<<1)+(s?1:0),(r<<1)+(c?1:0),Math.round(63*i)+128,Math.round(63*a)+128,1+(u===0?0:u<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const p=d.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,p),d.primitiveLength++),c?this.e2=p:this.e1=p}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,r){this.distance+=e.dist(r),this.updateScaledDistance()}}ht(og,"LineBucket",{omit:["layers","patternFeatures"]});class Dn{constructor(e,r,i,a){this.context=e,this.format=i,this.texture=e.gl.createTexture(),this.update(r,a)}update(e,r,i){const{width:a,height:s}=e,{context:c}=this,{gl:u}=c,{HTMLImageElement:d,HTMLCanvasElement:p,HTMLVideoElement:m,ImageData:_,ImageBitmap:y}=w;if(u.bindTexture(u.TEXTURE_2D,this.texture),c.pixelStoreUnpackFlipY.set(!1),c.pixelStoreUnpack.set(1),c.pixelStoreUnpackPremultiplyAlpha.set(this.format===u.RGBA&&(!r||r.premultiply!==!1)),i||this.size&&this.size[0]===a&&this.size[1]===s){const{x:v,y:b}=i||{x:0,y:0};e instanceof d||e instanceof p||e instanceof m||e instanceof _||y&&e instanceof y?u.texSubImage2D(u.TEXTURE_2D,0,v,b,u.RGBA,u.UNSIGNED_BYTE,e):u.texSubImage2D(u.TEXTURE_2D,0,v,b,a,s,u.RGBA,u.UNSIGNED_BYTE,e.data)}else if(this.size=[a,s],e instanceof d||e instanceof p||e instanceof m||e instanceof _||y&&e instanceof y){let v=this.format;c.isWebGL2&&this.format===u.R8&&(v=u.RED),u.texImage2D(u.TEXTURE_2D,0,this.format,v,u.UNSIGNED_BYTE,e)}else{let v=this.format,b=u.UNSIGNED_BYTE;this.format===u.DEPTH_COMPONENT&&(v=u.DEPTH_COMPONENT16,b=u.UNSIGNED_SHORT),u.texImage2D(u.TEXTURE_2D,0,v,a,s,0,this.format,b,e.data)}this.useMipmap=!!(r&&r.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&u.generateMipmap(u.TEXTURE_2D)}bind(e,r){const{context:i}=this,{gl:a}=i;a.bindTexture(a.TEXTURE_2D,this.texture),e!==this.minFilter&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,e),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,this.useMipmap?e===a.NEAREST?a.NEAREST_MIPMAP_NEAREST:a.LINEAR_MIPMAP_NEAREST:e),this.minFilter=e),r!==this.wrapS&&(a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,r),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,r),this.wrapS=r)}bindExtraParam(e,r,i,a){const{context:s}=this,{gl:c}=s;c.bindTexture(c.TEXTURE_2D,this.texture),r!==this.magFilter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,r),this.magFilter=r),e!==this.minFilter&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,this.useMipmap?e===c.NEAREST?c.NEAREST_MIPMAP_NEAREST:c.LINEAR_MIPMAP_NEAREST:e),this.minFilter=e),i!==this.wrapS&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,i),this.wrapS=i),a!==this.wrapT&&(c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,a),this.wrapT=a)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}const Oo=32,Ra=33,nl=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,r=0,i=0,a=0,s=0,c=0,u=0;for(1&e?a=s=c=Oo:r=i=u=Oo;(e>>=1)>1;){const p=r+a>>1,m=i+s>>1;1&e?(a=r,s=i,r=c,i=u):(r=a,i=s,a=c,s=u),c=p,u=m}const d=4*t;nl[d+0]=r,nl[d+1]=i,nl[d+2]=a,nl[d+3]=s}const za=new Uint16Array(2178),il=new Uint8Array(1089),ag=new Uint16Array(1089);function VM(t){return t===0?-.03125:t===32?.03125:0}var Xv=Ar([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const UM={type:2,extent:Ae,loadGeometry:()=>[[new $(0,0),new $(Ae+1,0),new $(Ae+1,Ae+1),new $(0,Ae+1),new $(0,0)]]};class Wd{constructor(e,r,i,a,s){this.tileID=e,this.uid=Ir(),this.uses=0,this.tileSize=r,this.tileZoom=i,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=s,a&&a.style&&(this._lastUpdatedBrightness=a.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",a&&a.transform&&(this.projection=a.transform.projection)}registerFadeDuration(e){const r=e+this.timeAdded;r<Ot.now()||this.fadeEndTime&&r<this.fadeEndTime||(this.fadeEndTime=r)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=ic(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,r,i){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(a,s){const c={};if(!s)return c;for(const u of a){const d=u.layerIds.map(p=>s.getLayer(p)).filter(Boolean);if(d.length!==0){u.layers=d,u.stateDependentLayerIds&&(u.stateDependentLayers=u.stateDependentLayerIds.map(p=>d.filter(m=>m.id===p)[0]));for(const p of d)c[p.id]=u}}return c}(e.buckets,r.style),this.hasSymbolBuckets=!1;for(const a in this.buckets){const s=this.buckets[a];if(s instanceof Gd){if(this.hasSymbolBuckets=!0,!i)break;s.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const a in this.buckets){const s=this.buckets[a];if(s instanceof Gd&&s.hasRTLText){this.hasRTLText=!0,Ro.isLoading()||Ro.isLoaded()||C1()!=="deferred"||PS();break}}this.queryPadding=0;for(const a in this.buckets){const s=this.buckets[a];this.queryPadding=Math.max(this.queryPadding,r.style.getLayer(a).queryRadius(s))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas),this._lastUpdatedBrightness=e.brightness}else this.collisionBoxArray=new V1}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const i in this.buckets){const a=this.buckets[i];a.uploadPending()&&a.upload(e)}const r=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Dn(e,this.imageAtlas.image,r.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Dn(e,this.glyphAtlasImage,r.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Dn(e,this.lineAtlas.image,r.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e,r,i){if(this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture,i),!r||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const a=r.style.getBrightness();(this._lastUpdatedBrightness||a)&&(this._lastUpdatedBrightness&&a&&Math.abs(this._lastUpdatedBrightness-a)<.001||(this._lastUpdatedBrightness=a,this.updateBuckets(void 0,r)))}queryRenderedFeatures(e,r,i,a,s,c,u,d){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:a,pixelPosMatrix:u,transform:c,params:s,tileTransform:this.tileTransform},e,r,i):{}}querySourceFeatures(e,r){const i=this.latestFeatureIndex;if(!i||!i.rawTileData)return;const a=i.loadVTLayers(),s=r?r.sourceLayer:"",c=a._geojsonTileLayer||a[s];if(!c)return;const u=rm(r&&r.filter),{z:d,x:p,y:m}=this.tileID.canonical,_={z:d,x:p,y:m};for(let y=0;y<c.length;y++){const v=c.feature(y);if(u.needGeometry){const T=Ks(v,!0);if(!u.filter(new mn(this.tileID.overscaledZ),T,this.tileID.canonical))continue}else if(!u.filter(new mn(this.tileID.overscaledZ),v))continue;const b=i.getId(v,s),S=new tM(v,d,p,m,b);S.tile=_,e.push(S)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}bucketsLoaded(){for(const e in this.buckets)if(this.buckets[e].uploadPending())return!1;return!0}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const r=this.expirationTime;if(e.cacheControl){const i=gt(e.cacheControl);i["max-age"]&&(this.expirationTime=Date.now()+1e3*i["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const i=Date.now();let a=!1;if(this.expirationTime>i)a=!1;else if(r)if(this.expirationTime<r)a=!0;else{const s=this.expirationTime-r;s?this.expirationTime=i+Math.max(s,3e4):a=!0}else a=!0;a?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(e,r){this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData&&Object.keys(e).length!==0&&r&&this.updateBuckets(e,r)}updateBuckets(e,r){if(!this.latestFeatureIndex)return;const i=this.latestFeatureIndex.loadVTLayers(),a=r.style.listImages(),s=r.style.getBrightness();for(const c in this.buckets){if(!r.style.hasLayer(c))continue;const u=this.buckets[c],d=u.layers[0].sourceLayer||"_geojsonTileLayer",p=i[d];let m={};if(e&&(m=e[d],!p||!m||Object.keys(m).length===0))continue;if(u.update(m,p,a,this.imageAtlas&&this.imageAtlas.patternPositions||{},s),u instanceof og||u instanceof Fm){const y=r.style._getSourceCache(u.layers[0].source);r._terrain&&r._terrain.enabled&&y&&u.programConfigurations.needsUpload&&r._terrain._clearRenderCacheForTile(y.id,this.tileID)}const _=r&&r.style&&r.style.getLayer(c);_&&(this.queryPadding=Math.max(this.queryPadding,_.queryRadius(u)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ot.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Ot.now()+e}setTexture(e,r){const i=r.context,a=i.gl;this.texture=this.texture||r.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Dn(i,e,a.RGBA,{useMipmap:!0}),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE))}setDependencies(e,r){const i={};for(const a of r)i[a]=!0;this.dependencies[e]=i}hasDependency(e,r){for(const i of e){const a=this.dependencies[i];if(a){for(const s of r)if(a[s])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,r){if(!r||r.name==="mercator"||this._tileDebugBuffer)return;const i=Pa(UM,this.tileID.canonical,this.tileTransform)[0],a=new Gi,s=new Td;for(let c=0;c<i.length;c++){const{x:u,y:d}=i[c];a.emplaceBack(u,d),s.emplaceBack(c)}s.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(s),this._tileDebugBuffer=e.createVertexBuffer(a,qs.members),this._tileDebugSegments=Gr.simpleSegment(0,0,a.length,s.length)}_makeTileBoundsBuffers(e,r){if(this._tileBoundsBuffer||!r||r.name==="mercator")return;const i=Pa(UM,this.tileID.canonical,this.tileTransform)[0];let a,s;if(this.isRaster){const c=function(u,d){const p=ic(u,d),m=Math.pow(2,u.z);for(let T=0;T<Ra;T++)for(let M=0;M<Ra;M++){const C=Hi((u.x+(M+VM(M))/Oo)/m),P=zn((u.y+(T+VM(T))/Oo)/m),k=d.project(C,P),z=T*Ra+M;za[2*z+0]=Math.round((k.x*p.scale-p.x)*Ae),za[2*z+1]=Math.round((k.y*p.scale-p.y)*Ae)}il.fill(0),ag.fill(0);for(let T=2045;T>=0;T--){const M=4*T,C=nl[M+0],P=nl[M+1],k=nl[M+2],z=nl[M+3],L=C+k>>1,B=P+z>>1,W=L+B-P,Z=B+C-L,X=P*Ra+C,H=z*Ra+k,J=B*Ra+L,Q=Math.hypot((za[2*X+0]+za[2*H+0])/2-za[2*J+0],(za[2*X+1]+za[2*H+1])/2-za[2*J+1])>=16;il[J]=il[J]||(Q?1:0),T<1022&&(il[J]=il[J]||il[(P+Z>>1)*Ra+(C+W>>1)]||il[(z+Z>>1)*Ra+(k+W>>1)])}const _=new Bs,y=new Bn;let v=0;function b(T,M){const C=M*Ra+T;return ag[C]===0&&(_.emplaceBack(za[2*C+0],za[2*C+1],T*Ae/Oo,M*Ae/Oo),ag[C]=++v),ag[C]-1}function S(T,M,C,P,k,z){const L=T+C>>1,B=M+P>>1;if(Math.abs(T-k)+Math.abs(M-z)>1&&il[B*Ra+L])S(k,z,T,M,L,B),S(C,P,k,z,L,B);else{const W=b(T,M),Z=b(C,P),X=b(k,z);y.emplaceBack(W,Z,X)}}return S(0,0,Oo,Oo,Oo,0),S(Oo,Oo,0,0,0,Oo),{vertices:_,indices:y}}(this.tileID.canonical,r);a=c.vertices,s=c.indices}else{a=new Bs,s=new Bn;for(const{x:u,y:d}of i)a.emplaceBack(u,d,0,0);const c=Om(a.int16,void 0,4);for(let u=0;u<c.length;u+=3)s.emplaceBack(c[u],c[u+1],c[u+2])}this._tileBoundsBuffer=e.createVertexBuffer(a,Xv.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(s),this._tileBoundsSegments=Gr.simpleSegment(0,0,a.length,s.length)}_makeGlobeTileDebugBuffers(e,r){const i=r.projection;if(!i||i.name!=="globe"||r.freezeTileCoverage)return;const a=this.tileID.canonical,s=vu(gT(a,r)),c=Qn(r.zoom);let u;c>0&&(u=ge.invert(new Float64Array(16),r.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,a,r,s,u,c),this._makeGlobeTileDebugTextBuffer(e,a,r,s,u,c)}_globePoint(e,r,i,a,s,c,u){let d=Id(e,r,i);if(c){const p=1<<i.z,m=ei(a.center.lng),_=ai(a.center.lat),y=(i.x+.5)/p-m;let v=0;y>.5?v=-1:y<-.5&&(v=1);let b=(e/Ae+i.x)/p+v,S=(r/Ae+i.y)/p;b=(b-m)*a._pixelsPerMercatorPixel+m,S=(S-_)*a._pixelsPerMercatorPixel+_;const T=[b*a.worldSize,S*a.worldSize,0];ie.transformMat4(T,T,c),d=rs(d,T,u)}return ie.transformMat4(d,d,s)}_makeGlobeTileDebugBorderBuffer(e,r,i,a,s,c){const u=new Gi,d=new Td,p=new um,m=(y,v,b,S,T)=>{const M=(b-y)/(T-1),C=(S-v)/(T-1),P=u.length;for(let k=0;k<T;k++){const z=y+k*M,L=v+k*C;u.emplaceBack(z,L);const B=this._globePoint(z,L,r,i,a,s,c);p.emplaceBack(B[0],B[1],B[2]),d.emplaceBack(P+k)}},_=Ae;m(0,0,_,0,16),m(_,0,_,_,16),m(_,_,0,_,16),m(0,_,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(d),this._tileDebugBuffer=e.createVertexBuffer(u,qs.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(p,dT.members),this._tileDebugSegments=Gr.simpleSegment(0,0,u.length,d.length)}_makeGlobeTileDebugTextBuffer(e,r,i,a,s,c){const u=Ae/4,d=new Gi,p=new Bn,m=new um,_=25;p.reserve(32),d.reserve(_),m.reserve(_);const y=(v,b)=>_*v+b;for(let v=0;v<_;v++){const b=v*u;for(let S=0;S<_;S++){const T=S*u;d.emplaceBack(T,b);const M=this._globePoint(T,b,r,i,a,s,c);m.emplaceBack(M[0],M[1],M[2])}}for(let v=0;v<4;v++)for(let b=0;b<4;b++){const S=y(v,b),T=y(v,b+1),M=y(v+1,b),C=y(v+1,b+1);p.emplaceBack(S,T,M),p.emplaceBack(M,T,C)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(p),this._tileDebugTextBuffer=e.createVertexBuffer(d,qs.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(m,dT.members),this._tileDebugTextSegments=Gr.simpleSegment(0,0,_,32)}}class G7{constructor(e,r){this.max=e,this.onRemove=r,this.reset()}reset(){for(const e in this.data)for(const r of this.data[e])r.timeout&&clearTimeout(r.timeout),this.onRemove(r.value);return this.data={},this.order=[],this}add(e,r,i){const a=e.wrapped().key;this.data[a]===void 0&&(this.data[a]=[]);const s={value:r,timeout:void 0};if(i!==void 0&&(s.timeout=setTimeout(()=>{this.remove(e,s)},i)),this.data[a].push(s),this.order.push(a),this.order.length>this.max){const c=this._getAndRemoveByKey(this.order[0]);c&&this.onRemove(c)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const r=this.data[e].shift();return r.timeout&&clearTimeout(r.timeout),this.data[e].length===0&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),r.value}getByKey(e){const r=this.data[e];return r?r[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,r){if(!this.has(e))return this;const i=e.wrapped().key,a=r===void 0?0:this.data[i].indexOf(r),s=this.data[i][a];return this.data[i].splice(a,1),s.timeout&&clearTimeout(s.timeout),this.data[i].length===0&&delete this.data[i],this.onRemove(s.value),this.order.splice(this.order.indexOf(i),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const r=this._getAndRemoveByKey(this.order[0]);r&&this.onRemove(r)}return this}filter(e){const r=[];for(const i in this.data)for(const a of this.data[i])e(a.value)||r.push(a);for(const i of r)this.remove(i.value.tileID,i)}}class ol{constructor(e,r,i,a){this.id=ol.uniqueIdxCounter,ol.uniqueIdxCounter++,this.context=e;const s=e.gl;this.buffer=s.createBuffer(),this.dynamicDraw=!!i,this.context.unbindVAO(),e.bindElementBuffer.set(this.buffer),s.bufferData(s.ELEMENT_ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?s.DYNAMIC_DRAW:s.STATIC_DRAW),this.dynamicDraw||a||r.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(e){this.id=ol.uniqueIdxCounter,ol.uniqueIdxCounter++;const r=this.context.gl;this.context.unbindVAO(),this.bind(),r.bufferSubData(r.ELEMENT_ARRAY_BUFFER,0,e.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}ol.uniqueIdxCounter=0;const W7={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class H7{constructor(e,r,i,a,s){this.length=r.length,this.attributes=i,this.itemSize=r.bytesPerElement,this.dynamicDraw=a,this.context=e;const c=e.gl;this.buffer=c.createBuffer(),e.bindVertexBuffer.set(this.buffer),c.bufferData(c.ARRAY_BUFFER,r.arrayBuffer,this.dynamicDraw?c.DYNAMIC_DRAW:c.STATIC_DRAW),this.dynamicDraw||s||r.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(e){const r=this.context.gl;this.bind(),r.bufferSubData(r.ARRAY_BUFFER,0,e.arrayBuffer)}enableAttributes(e,r){for(let i=0;i<this.attributes.length;i++){const a=r.attributes[this.attributes[i].name];a!==void 0&&e.enableVertexAttribArray(a)}}setVertexAttribPointers(e,r,i){for(let a=0;a<this.attributes.length;a++){const s=this.attributes[a],c=r.attributes[s.name];c!==void 0&&e.vertexAttribPointer(c,s.components,e[W7[s.type]],!1,this.itemSize,s.offset+this.itemSize*(i||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class tn{constructor(e){this.gl=e.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(e){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class q7 extends tn{getDefault(){return Zt.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.clearColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class Z7 extends tn{getDefault(){return 1}set(e){(e!==this.current||this.dirty)&&(this.gl.clearDepth(e),this.current=e,this.dirty=!1)}}class X7 extends tn{getDefault(){return 0}set(e){(e!==this.current||this.dirty)&&(this.gl.clearStencil(e),this.current=e,this.dirty=!1)}}class Y7 extends tn{getDefault(){return[!0,!0,!0,!0]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.colorMask(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class K7 extends tn{getDefault(){return!0}set(e){(e!==this.current||this.dirty)&&(this.gl.depthMask(e),this.current=e,this.dirty=!1)}}class J7 extends tn{getDefault(){return 255}set(e){(e!==this.current||this.dirty)&&(this.gl.stencilMask(e),this.current=e,this.dirty=!1)}}class Q7 extends tn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(e){const r=this.current;(e.func!==r.func||e.ref!==r.ref||e.mask!==r.mask||this.dirty)&&(this.gl.stencilFunc(e.func,e.ref,e.mask),this.current=e,this.dirty=!1)}}class eB extends tn{getDefault(){const e=this.gl;return[e.KEEP,e.KEEP,e.KEEP]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||this.dirty)&&(this.gl.stencilOp(e[0],e[1],e[2]),this.current=e,this.dirty=!1)}}class tB extends tn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.STENCIL_TEST):r.disable(r.STENCIL_TEST),this.current=e,this.dirty=!1}}class rB extends tn{getDefault(){return[0,1]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||this.dirty)&&(this.gl.depthRange(e[0],e[1]),this.current=e,this.dirty=!1)}}class nB extends tn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.DEPTH_TEST):r.disable(r.DEPTH_TEST),this.current=e,this.dirty=!1}}class iB extends tn{getDefault(){return this.gl.LESS}set(e){(e!==this.current||this.dirty)&&(this.gl.depthFunc(e),this.current=e,this.dirty=!1)}}class oB extends tn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.BLEND):r.disable(r.BLEND),this.current=e,this.dirty=!1}}class aB extends tn{getDefault(){const e=this.gl;return[e.ONE,e.ZERO,e.ONE,e.ZERO]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.blendFuncSeparate(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class sB extends tn{getDefault(){return Zt.transparent}set(e){const r=this.current;(e.r!==r.r||e.g!==r.g||e.b!==r.b||e.a!==r.a||this.dirty)&&(this.gl.blendColor(e.r,e.g,e.b,e.a),this.current=e,this.dirty=!1)}}class lB extends tn{getDefault(){return this.gl.FUNC_ADD}set(e){(e!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(e,e),this.current=e,this.dirty=!1)}}class cB extends tn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;e?r.enable(r.CULL_FACE):r.disable(r.CULL_FACE),this.current=e,this.dirty=!1}}class uB extends tn{getDefault(){return this.gl.BACK}set(e){(e!==this.current||this.dirty)&&(this.gl.cullFace(e),this.current=e,this.dirty=!1)}}class hB extends tn{getDefault(){return this.gl.CCW}set(e){(e!==this.current||this.dirty)&&(this.gl.frontFace(e),this.current=e,this.dirty=!1)}}let dB=class extends tn{getDefault(){return null}set(t){(t!==this.current||this.dirty)&&(this.gl.useProgram(t),this.current=t,this.dirty=!1)}};class fB extends tn{getDefault(){return this.gl.TEXTURE0}set(e){(e!==this.current||this.dirty)&&(this.gl.activeTexture(e),this.current=e,this.dirty=!1)}}class pB extends tn{getDefault(){const e=this.gl;return[0,0,e.drawingBufferWidth,e.drawingBufferHeight]}set(e){const r=this.current;(e[0]!==r[0]||e[1]!==r[1]||e[2]!==r[2]||e[3]!==r[3]||this.dirty)&&(this.gl.viewport(e[0],e[1],e[2],e[3]),this.current=e,this.dirty=!1)}}class mB extends tn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindFramebuffer(r.FRAMEBUFFER,e),this.current=e,this.dirty=!1}}class gB extends tn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindRenderbuffer(r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class _B extends tn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindTexture(r.TEXTURE_2D,e),this.current=e,this.dirty=!1}}class yB extends tn{getDefault(){return null}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.bindBuffer(r.ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class vB extends tn{getDefault(){return null}set(e){const r=this.gl;r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,e),this.current=e,this.dirty=!1}}class xB extends tn{constructor(e){super(e),this.vao=e.extVertexArrayObject}getDefault(){return null}set(e){this.vao&&(e!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(e),this.current=e,this.dirty=!1)}}class bB extends tn{getDefault(){return 4}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_ALIGNMENT,e),this.current=e,this.dirty=!1}}class wB extends tn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e),this.current=e,this.dirty=!1}}class EB extends tn{getDefault(){return!1}set(e){if(e===this.current&&!this.dirty)return;const r=this.gl;r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,e),this.current=e,this.dirty=!1}}class Yv extends tn{constructor(e,r){super(e),this.context=e,this.parent=r}getDefault(){return null}}class SB extends Yv{setDirty(){this.dirty=!0}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class GM extends Yv{attachment(){return this.gl.DEPTH_ATTACHMENT}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferRenderbuffer(r.FRAMEBUFFER,this.attachment(),r.RENDERBUFFER,e),this.current=e,this.dirty=!1}}class TB extends Yv{attachment(){return this.gl.DEPTH_ATTACHMENT}set(e){if(e===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const r=this.gl;r.framebufferTexture2D(r.FRAMEBUFFER,this.attachment(),r.TEXTURE_2D,e,0),this.current=e,this.dirty=!1}}class MB extends GM{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class CB{constructor(e,r,i,a,s){this.context=e,this.width=r,this.height=i;const c=this.framebuffer=e.gl.createFramebuffer();a&&(this.colorAttachment=new SB(e,c)),s&&(this.depthAttachmentType=s,this.depthAttachment=s==="renderbuffer"?new GM(e,c):new TB(e,c))}destroy(){const e=this.context.gl;if(this.colorAttachment){const r=this.colorAttachment.get();r&&e.deleteTexture(r)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const r=this.depthAttachment.get();r&&e.deleteRenderbuffer(r)}else{const r=this.depthAttachment.get();r&&e.deleteTexture(r)}e.deleteFramebuffer(this.framebuffer)}}class Nt{constructor(e,r,i){this.func=e,this.mask=r,this.range=i}}Nt.ReadOnly=!1,Nt.ReadWrite=!0,Nt.disabled=new Nt(519,Nt.ReadOnly,[0,1]);const Kv=7680;class lr{constructor(e,r,i,a,s,c){this.test=e,this.ref=r,this.mask=i,this.fail=a,this.depthFail=s,this.pass=c}}lr.disabled=new lr({func:519,mask:0},0,0,Kv,Kv,Kv);const sg=771;class Lr{constructor(e,r,i,a){this.blendFunction=e,this.blendColor=r,this.mask=i,this.blendEquation=a}}Lr.Replace=[1,0,1,0],Lr.disabled=new Lr(Lr.Replace,Zt.transparent,[!1,!1,!1,!1]),Lr.unblended=new Lr(Lr.Replace,Zt.transparent,[!0,!0,!0,!0]),Lr.alphaBlended=new Lr([1,sg,1,sg],Zt.transparent,[!0,!0,!0,!0]),Lr.multiply=new Lr([774,0,774,0],Zt.transparent,[!0,!0,!0,!0]);const Jv=1029,Qv=2305;class ur{constructor(e,r,i){this.enable=e,this.mode=r,this.frontFace=i}}ur.disabled=new ur(!1,Jv,Qv),ur.backCCW=new ur(!0,Jv,Qv),ur.backCW=new ur(!0,Jv,2304),ur.frontCW=new ur(!0,1028,2304),ur.frontCCW=new ur(!0,1028,Qv);class AB{constructor(e,r=!1){if(this.gl=e,this.isWebGL2=r,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),r){const i=e;this.extVertexArrayObject={createVertexArrayOES:i.createVertexArray.bind(e),deleteVertexArrayOES:i.deleteVertexArray.bind(e),bindVertexArrayOES:i.bindVertexArray.bind(e)}}this.clearColor=new q7(this),this.clearDepth=new Z7(this),this.clearStencil=new X7(this),this.colorMask=new Y7(this),this.depthMask=new K7(this),this.stencilMask=new J7(this),this.stencilFunc=new Q7(this),this.stencilOp=new eB(this),this.stencilTest=new tB(this),this.depthRange=new rB(this),this.depthTest=new nB(this),this.depthFunc=new iB(this),this.blend=new oB(this),this.blendFunc=new aB(this),this.blendColor=new sB(this),this.blendEquation=new lB(this),this.cullFace=new cB(this),this.cullFaceSide=new uB(this),this.frontFace=new hB(this),this.program=new dB(this),this.activeTexture=new fB(this),this.viewport=new pB(this),this.bindFramebuffer=new mB(this),this.bindRenderbuffer=new gB(this),this.bindTexture=new _B(this),this.bindVertexBuffer=new yB(this),this.bindElementBuffer=new vB(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new xB(this),this.pixelStoreUnpack=new bB(this),this.pixelStoreUnpackPremultiplyAlpha=new wB(this),this.pixelStoreUnpackFlipY=new EB(this),this.extTextureFilterAnisotropic=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=e.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=e.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=e.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=e.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),r||(this.extTextureHalfFloat=e.getExtension("OES_texture_half_float")),(r||this.extTextureHalfFloat&&e.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=e.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=r||e.getExtension("OES_standard_derivatives"),this.extTimerQuery=e.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=e.getParameter(e.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(e,r,i){return new ol(this,e,r,i)}createVertexBuffer(e,r,i,a){return new H7(this,e,r,i,a)}createRenderbuffer(e,r,i){const a=this.gl,s=a.createRenderbuffer();return this.bindRenderbuffer.set(s),a.renderbufferStorage(a.RENDERBUFFER,e,r,i),this.bindRenderbuffer.set(null),s}createFramebuffer(e,r,i,a){return new CB(this,e,r,i,a)}clear({color:e,depth:r,stencil:i,colorMask:a}){const s=this.gl;let c=0;e&&(c|=s.COLOR_BUFFER_BIT,this.clearColor.set(e),this.colorMask.set(a||[!0,!0,!0,!0])),r!==void 0&&(c|=s.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(r),this.depthMask.set(!0)),i!==void 0&&(c|=s.STENCIL_BUFFER_BIT,this.clearStencil.set(i),this.stencilMask.set(255)),s.clear(c)}setCullFace(e){e.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(e.mode),this.frontFace.set(e.frontFace))}setDepthMode(e){e.func!==this.gl.ALWAYS||e.mask?(this.depthTest.set(!0),this.depthFunc.set(e.func),this.depthMask.set(e.mask),this.depthRange.set(e.range)):this.depthTest.set(!1)}setStencilMode(e){e.test.func!==this.gl.ALWAYS||e.mask?(this.stencilTest.set(!0),this.stencilMask.set(e.mask),this.stencilOp.set([e.fail,e.depthFail,e.pass]),this.stencilFunc.set({func:e.test.func,ref:e.ref,mask:e.test.mask})):this.stencilTest.set(!1)}setColorMode(e){ue(e.blendFunction,Lr.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(e.blendFunction),this.blendColor.set(e.blendColor),e.blendEquation?this.blendEquation.set(e.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(e.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class na extends dr{constructor(e,r,i){super(),this.id=e,this._onlySymbols=i,r.on("data",a=>{a.dataType==="source"&&a.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&a.dataType==="source"&&a.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),r.on("error",()=>{this._sourceErrored=!0}),this._source=r,this._tiles={},this._cache=new G7(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=r.minTileCacheSize,this._maxTileCacheSize=r.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new XF,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(e){this.map=e,this._minTileCacheSize=this._minTileCacheSize===void 0&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const r=this._tiles[e];if(r.state!=="errored"&&(r.state!=="loaded"||!r.bucketsLoaded()))return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,r){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,r)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const r in this._tiles){const i=this._tiles[r];i.upload(e),i.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return kt(this._tiles).map(e=>e.tileID).sort(WM).map(e=>e.key)}getRenderableIds(e){const r=[];for(const i in this._tiles)this._isIdRenderable(+i,e)&&r.push(this._tiles[i]);return e?r.sort((i,a)=>{const s=i.tileID,c=a.tileID,u=new $(s.canonical.x,s.canonical.y)._rotate(this.transform.angle),d=new $(c.canonical.x,c.canonical.y)._rotate(this.transform.angle);return s.overscaledZ-c.overscaledZ||d.y-u.y||d.x-u.x}).map(i=>i.tileID.key):r.map(i=>i.tileID).sort(WM).map(i=>i.key)}hasRenderableParent(e){const r=this.findLoadedParent(e,0);return!!r&&this._isIdRenderable(r.tileID.key)}_isIdRenderable(e,r){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(r||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)this._tiles[e].state!=="errored"&&this._reloadTile(+e,"reloading")}}_reloadTile(e,r){const i=this._tiles[e];i&&(i.state!=="loading"&&(i.state=r),this._loadTile(i,this._tileLoaded.bind(this,i,e,r)))}_tileLoaded(e,r,i,a){if(a)if(e.state="errored",a.status!==404)this._source.fire(new rt(a,{tile:e}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const s=this.map.painter.terrain;this.update(this.transform,s.getScaledDemTileSize(),!0),s.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Ot.now(),i==="expired"&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(r,e),this._source.type==="raster-dem"&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Ee("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const r=this.getRenderableIds();for(let a=0;a<r.length;a++){const s=r[a];if(e.neighboringTiles&&e.neighboringTiles[s]){const c=this.getTileByID(s);i(e,c),i(c,e)}}function i(a,s){if(!a.dem||a.dem.borderReady)return;a.needsHillshadePrepare=!0,a.needsDEMTextureUpload=!0;let c=s.tileID.canonical.x-a.tileID.canonical.x;const u=s.tileID.canonical.y-a.tileID.canonical.y,d=Math.pow(2,a.tileID.canonical.z),p=s.tileID.key;c===0&&u===0||Math.abs(u)>1||(Math.abs(c)>1&&(Math.abs(c+d)===1?c+=d:Math.abs(c-d)===1&&(c-=d)),s.dem&&a.dem&&(a.dem.backfillBorder(s.dem,c,u),a.neighboringTiles&&a.neighboringTiles[p]&&(a.neighboringTiles[p].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,r,i,a){for(const s in this._tiles){let c=this._tiles[s];if(a[s]||!c.hasData()||c.tileID.overscaledZ<=r||c.tileID.overscaledZ>i)continue;let u=c.tileID;for(;c&&c.tileID.overscaledZ>r+1;){const p=c.tileID.scaledTo(c.tileID.overscaledZ-1);c=this._tiles[p.key],c&&c.hasData()&&(u=p)}let d=u;for(;d.overscaledZ>r;)if(d=d.scaledTo(d.overscaledZ-1),e[d.key]){a[u.key]=u;break}}}findLoadedParent(e,r){if(e.key in this._loadedParentTiles){const i=this._loadedParentTiles[e.key];return i&&i.tileID.overscaledZ>=r?i:null}for(let i=e.overscaledZ-1;i>=r;i--){const a=e.scaledTo(i),s=this._getLoadedTile(a);if(s)return s}}_getLoadedTile(e){const r=this._tiles[e.key];return r&&r.hasData()?r:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,r){r=r||this._source.tileSize;const i=Math.ceil(e.width/r)+1,a=Math.ceil(e.height/r)+1,s=Math.floor(i*a*5),c=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,s):s,u=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,c):c;this._cache.setMaxSize(u)}handleWrapJump(e){const r=Math.round((e-(this._prevLng===void 0?e:this._prevLng))/360);if(this._prevLng=e,r){const i={};for(const a in this._tiles){const s=this._tiles[a];s.tileID=s.tileID.unwrapTo(s.tileID.wrap+r),i[s.tileID.key]=s}this._tiles=i;for(const a in this._timers)clearTimeout(this._timers[a]),delete this._timers[a];for(const a in this._tiles)this._setTileReloadTimer(+a,this._tiles[a])}}update(e,r,i){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!i)return;let a;this.updateCacheSize(e,r),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?a=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(u=>new Kr(u.canonical.z,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y)):(a=e.coveringTiles({tileSize:r||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!i,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(a=a.filter(u=>this._source.hasTile(u)))):a=[];const s=this._updateRetainedTiles(a);if(HM(this._source.type)&&a.length!==0){const u={},d={},p=Object.keys(s);for(const _ of p){const y=s[_],v=this._tiles[_];if(!v||v.fadeEndTime&&v.fadeEndTime<=Ot.now())continue;const b=this.findLoadedParent(y,Math.max(y.overscaledZ-na.maxOverzooming,this._source.minzoom));b&&(this._addTile(b.tileID),u[b.tileID.key]=b.tileID),d[_]=y}const m=a[a.length-1].overscaledZ;for(const _ in this._tiles){const y=this._tiles[_];if(s[_]||!y.hasData())continue;let v=y.tileID;for(;v.overscaledZ>m;){v=v.scaledTo(v.overscaledZ-1);const b=this._tiles[v.key];if(b&&b.hasData()&&d[v.key]){s[_]=y.tileID;break}}}for(const _ in u)s[_]||(this._coveredTiles[_]=!0,s[_]=u[_])}for(const u in s)this._tiles[u].clearFadeHold();const c=function(u,d){const p=[];for(const m in u)m in d||p.push(m);return p}(this._tiles,s);for(const u of c){const d=this._tiles[u];d.hasSymbolBuckets&&!d.holdingForFade()?d.setHoldDuration(this.map._fadeDuration):d.hasSymbolBuckets&&!d.symbolFadeFinished()||this._removeTile(+u)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const r={};if(e.length===0)return r;const i={},a=e.reduce((p,m)=>Math.min(p,m.overscaledZ),1/0),s=e[0].overscaledZ,c=Math.max(s-na.maxOverzooming,this._source.minzoom),u=Math.max(s+na.maxUnderzooming,this._source.minzoom),d={};for(const p of e){const m=this._addTile(p);r[p.key]=p,m.hasData()||a<this._source.maxzoom&&(d[p.key]=p)}this._retainLoadedChildren(d,a,u,r);for(const p of e){let m=this._tiles[p.key];if(m.hasData())continue;if(p.canonical.z>=this._source.maxzoom){const y=p.children(this._source.maxzoom)[0],v=this.getTile(y);if(v&&v.hasData()){r[y.key]=y;continue}}else{const y=p.children(this._source.maxzoom);if(r[y[0].key]&&r[y[1].key]&&r[y[2].key]&&r[y[3].key])continue}let _=m.wasRequested();for(let y=p.overscaledZ-1;y>=c;--y){const v=p.scaledTo(y);if(i[v.key]||(i[v.key]=!0,m=this.getTile(v),!m&&_&&(m=this._addTile(v)),m&&(r[v.key]=v,_=m.wasRequested(),m.hasData())))break}}return r}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const r=[];let i,a=this._tiles[e].tileID;for(;a.overscaledZ>0;){if(a.key in this._loadedParentTiles){i=this._loadedParentTiles[a.key];break}r.push(a.key);const s=a.scaledTo(a.overscaledZ-1);if(i=this._getLoadedTile(s),i)break;a=s}for(const s of r)this._loadedParentTiles[s]=i}}_addTile(e){let r=this._tiles[e.key];if(r)return r;r=this._cache.getAndRemove(e),r&&(this._setTileReloadTimer(e.key,r),r.tileID=e,this._state.initializeTileState(r,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,r)));const i=!!r;if(!i){const a=this.map?this.map.painter:null;r=new Wd(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,a,this._isRaster),this._loadTile(r,this._tileLoaded.bind(this,r,e.key,r.state))}return r?(r.uses++,this._tiles[e.key]=r,i||this._source.fire(new Ee("dataloading",{tile:r,coord:r.tileID,dataType:"source"})),r):null}_setTileReloadTimer(e,r){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const i=r.getExpiryTimeout();i&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},i))}_removeTile(e){const r=this._tiles[e];r&&(r.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),r.uses>0||(r.hasData()&&r.state!=="reloading"?this._cache.add(r.tileID,r,r.getExpiryTimeout()):(r.aborted=!0,this._abortTile(r),this._unloadTile(r))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,r,i){const a=[],s=this.transform;if(!s)return a;const c=s.projection.name==="globe",u=ei(s.center.lng);for(const d in this._tiles){const p=this._tiles[d];if(i&&p.clearQueryDebugViz(),p.holdingForFade())continue;let m;if(c){const _=p.tileID.canonical;if(_.z===0){const y=[Math.abs(ze(u,...Hd(_,-1))-u),Math.abs(ze(u,...Hd(_,1))-u)];m=[0,2*y.indexOf(Math.min(...y))-1]}else{const y=[Math.abs(ze(u,...Hd(_,-1))-u),Math.abs(ze(u,...Hd(_,0))-u),Math.abs(ze(u,...Hd(_,1))-u)];m=[y.indexOf(Math.min(...y))-1]}}else m=[0];for(const _ of m){const y=e.containsTile(p,s,r,_);y&&a.push(y)}}return a}getVisibleCoordinates(e){const r=this.getRenderableIds(e).map(i=>this._tiles[i].tileID);for(const i of r)i.projMatrix=this.transform.calculateProjMatrix(i.toUnwrapped());return r}hasTransition(){if(this._source.hasTransition())return!0;if(HM(this._source.type))for(const e in this._tiles){const r=this._tiles[e];if(r.fadeEndTime!==void 0&&r.fadeEndTime>=Ot.now())return!0}return!1}setFeatureState(e,r,i){this._state.updateState(e=e||"_geojsonTileLayer",r,i)}removeFeatureState(e,r,i){this._state.removeFeatureState(e=e||"_geojsonTileLayer",r,i)}getFeatureState(e,r){return this._state.getState(e=e||"_geojsonTileLayer",r)}setDependencies(e,r,i){const a=this._tiles[e];a&&a.setDependencies(r,i)}reloadTilesForDependencies(e,r){for(const i in this._tiles)this._tiles[i].hasDependency(e,r)&&this._reloadTile(+i,"reloading");this._cache.filter(i=>!i.hasDependency(e,r))}_preloadTiles(e,r){if(!this._sourceLoaded){const u=()=>{this._sourceLoaded&&(this._source.off("data",u),this._preloadTiles(e,r))};return void this._source.on("data",u)}const i=new Map,a=Array.isArray(e)?e:[e],s=this.map.painter.terrain,c=this.usedForTerrain&&s?s.getScaledDemTileSize():this._source.tileSize;for(const u of a){const d=u.coveringTiles({tileSize:c,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const p of d)i.set(p.key,p);this.usedForTerrain&&u.updateElevation(!1)}mt(Array.from(i.values()),(u,d)=>{const p=new Wd(u,this._source.tileSize*u.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(p,m=>{this._source.type==="raster-dem"&&p.dem&&this._backfillDEM(p),d(m,p)})},r)}}function WM(t,e){const r=Math.abs(2*t.wrap)-+(t.wrap<0),i=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||i-r||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function HM(t){return t==="raster"||t==="image"||t==="video"||t==="custom"}function Hd(t,e){const r=1<<t.z;return[t.x/r+e,(t.x+1)/r+e]}na.maxOverzooming=10,na.maxUnderzooming=3;const IB=Ar([{name:"a_pos_3f",components:3,type:"Float32"}]),PB=Ar([{name:"a_color_3f",components:3,type:"Float32"}]),kB=Ar([{name:"a_color_4f",components:4,type:"Float32"}]),RB=Ar([{name:"a_uv_2f",components:2,type:"Float32"}]),zB=Ar([{name:"a_normal_3f",components:3,type:"Float32"}]);Ar([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]);const DB=Ar([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]);class ex{constructor(e=0,r=0,i=0,a=0){if(isNaN(e)||e<0||isNaN(r)||r<0||isNaN(i)||i<0||isNaN(a)||a<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=e,this.bottom=r,this.left=i,this.right=a}interpolate(e,r,i){return r.top!=null&&e.top!=null&&(this.top=Ft(e.top,r.top,i)),r.bottom!=null&&e.bottom!=null&&(this.bottom=Ft(e.bottom,r.bottom,i)),r.left!=null&&e.left!=null&&(this.left=Ft(e.left,r.left,i)),r.right!=null&&e.right!=null&&(this.right=Ft(e.right,r.right,i)),this}getCenter(e,r){const i=ze((this.left+e-this.right)/2,0,e),a=ze((this.top+r-this.bottom)/2,0,r);return new $(i,a)}equals(e){return this.top===e.top&&this.bottom===e.bottom&&this.left===e.left&&this.right===e.right}clone(){return new ex(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function qM(t,e){const r=Pr(t,3);ge.fromQuat(t,e),Cr(t,3,r)}function tx(t,e){const r=oi.identity([]);return oi.rotateZ(r,r,-e),oi.rotateX(r,r,-t),r}function ZM(t,e){const r=[t[0],t[1],0],i=[e[0],e[1],0];if(ie.length(r)>=1e-15){const c=ie.normalize([],r);ie.scale(i,c,ie.dot(i,c)),e[0]=i[0],e[1]=i[1]}const a=ie.cross([],e,t);if(ie.len(a)<1e-15)return null;const s=Math.atan2(-a[1],a[0]);return tx(Math.atan2(Math.sqrt(t[0]*t[0]+t[1]*t[1]),-t[2]),s)}class XM{constructor(e,r){this.position=e,this.orientation=r}get position(){return this._position}set position(e){if(e){const r=e instanceof cr?e:new cr(e[0],e[1],e[2]);this._renderWorldCopies&&(r.x=Pt(r.x,0,1)),this._position=r}else this._position=null}lookAtPoint(e,r){if(this.orientation=null,!this.position)return;const i=this.position,a=this._elevation?this._elevation.getAtPointOrZero(cr.fromLngLat(e)):0,s=cr.fromLngLat(e,a),c=[s.x-i.x,s.y-i.y,s.z-i.z];r||(r=[0,0,1]),r[2]=Math.abs(r[2]),this.orientation=ZM(c,r)}setPitchBearing(e,r){this.orientation=tx(se(e),se(-r))}}class lg{constructor(e,r){this._transform=ge.identity([]),this.orientation=r,this.position=e}get mercatorPosition(){const e=this.position;return new cr(e[0],e[1],e[2])}get position(){const e=Pr(this._transform,3);return[e[0],e[1],e[2]]}set position(e){var r;e&&Cr(this._transform,3,[(r=e)[0],r[1],r[2],1])}get orientation(){return this._orientation}set orientation(e){this._orientation=e||oi.identity([]),e&&qM(this._transform,this._orientation)}getPitchBearing(){const e=this.forward(),r=this.right();return{bearing:Math.atan2(-r[1],r[0]),pitch:Math.atan2(Math.sqrt(e[0]*e[0]+e[1]*e[1]),-e[2])}}setPitchBearing(e,r){this._orientation=tx(e,r),qM(this._transform,this._orientation)}forward(){const e=Pr(this._transform,2);return[-e[0],-e[1],-e[2]]}up(){const e=Pr(this._transform,1);return[-e[0],-e[1],-e[2]]}right(){const e=Pr(this._transform,0);return[e[0],e[1],e[2]]}getCameraToWorld(e,r){const i=new Float64Array(16);return ge.invert(i,this.getWorldToCamera(e,r)),i}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(e,r,i){const a=this.position;ie.scale(a,a,-e);const s=new Float64Array(16);return ge.fromScaling(s,[i,i,i]),ge.translate(s,s,a),s[10]*=r,s}getWorldToCamera(e,r){const i=new Float64Array(16),a=new Float64Array(4),s=this.position;return oi.conjugate(a,this._orientation),ie.scale(s,s,-e),ge.fromQuat(i,a),ge.translate(i,i,s),i[1]*=-1,i[5]*=-1,i[9]*=-1,i[13]*=-1,i[8]*=r,i[9]*=r,i[10]*=r,i[11]*=r,i}getCameraToClipPerspective(e,r,i,a){const s=new Float64Array(16);return ge.perspective(s,e,r,i,a),s}getCameraToClipOrthographic(e,r,i,a,s,c){const u=new Float64Array(16);return ge.ortho(u,e,r,i,a,s,c),u}getDistanceToElevation(e,r=!1){const i=e===0?0:jr(e,r?zn(this.position[1]):this.position[1]),a=this.forward();return(i-this.position[2])/a[2]}clone(){return new lg([...this.position],[...this.orientation])}}function YM(t,e){const r=qd(t.projection,t.zoom,t.width,t.height),i=function(s,c,u,d,p){const m=new zt(u.lng-180*al,u.lat),_=new zt(u.lng+180*al,u.lat),y=s.project(m.lng,m.lat),v=s.project(_.lng,_.lat),b=-Math.atan2(v.y-y.y,v.x-y.x),S=cr.fromLngLat(u);S.y=ze(S.y,-1+al,1-al);const T=S.toLngLat(),M=s.project(T.lng,T.lat),C=cr.fromLngLat(T);C.x+=al;const P=C.toLngLat(),k=s.project(P.lng,P.lat),z=QM(k.x-M.x,k.y-M.y,b),L=cr.fromLngLat(T);L.y+=al;const B=L.toLngLat(),W=s.project(B.lng,B.lat),Z=QM(W.x-M.x,W.y-M.y,b),X=Math.abs(z.x)/Math.abs(Z.y),H=ge.identity([]);ge.rotateZ(H,H,-b*(1-(p?0:d)));const J=ge.identity([]);return ge.scale(J,J,[1,1-(1-X)*d,1]),J[4]=-Z.x/Z.y*d,ge.rotateZ(J,J,b),ge.multiply(J,H,J),J}(t.projection,0,t.center,r,e),a=KM(t);return ge.scale(i,i,[a,a,1]),i}function KM(t){const e=t.projection,r=qd(t.projection,t.zoom,t.width,t.height),i=JM(e,t.center),a=JM(e,zt.convert(e.center));return Math.pow(2,i*r+(1-r)*a)}function qd(t,e,r,i,a=1/0){const s=t.range;if(!s)return 0;const c=Math.min(a,Math.max(r,i)),u=Math.log(c/1024)/Math.LN2;return at(s[0]+u,s[1]+u,e)}const al=1/4e4;function JM(t,e){const r=ze(e.lat,-An,An),i=new zt(e.lng-180*al,r),a=new zt(e.lng+180*al,r),s=t.project(i.lng,r),c=t.project(a.lng,r),u=cr.fromLngLat(i),d=cr.fromLngLat(a),p=c.x-s.x,m=c.y-s.y,_=d.x-u.x,y=d.y-u.y,v=Math.sqrt((_*_+y*y)/(p*p+m*m));return Math.log(v)/Math.LN2}function QM(t,e,r){const i=Math.cos(r),a=Math.sin(r);return{x:t*i-e*a,y:t*a+e*i}}function oc(t,e,r){return e*(Ae/(t.tileSize*Math.pow(2,r-t.tileID.overscaledZ)))}const Lu={unknown:0,flipRequired:1,flipNotRequired:2},LB=Math.tan(85*Math.PI/180);function cg(t,e,r,i,a,s,c){const u=ge.create();if(r)if(s.name==="globe"){const d=function(p,m){const{x:_,y}=p.point,v=xT(_,y,p.worldSize/p._pixelsPerMercatorPixel,0,0);return ge.multiply(v,v,pv(ea(m)))}(a,e);ge.multiply(u,u,d)}else{const d=mu.invert([],c);u[0]=d[0],u[1]=d[1],u[4]=d[2],u[5]=d[3],i||ge.rotateZ(u,u,a.angle)}else ge.multiply(u,a.labelPlaneMatrix,t);return u}function eC(t,e,r,i,a,s,c){const u=cg(t,e,r,i,a,s,c);return s.name==="globe"&&r||(u[2]=u[6]=u[10]=u[14]=0),u}function tC(t,e,r,i,a,s,c){if(r){if(s.name==="globe"){const u=cg(t,e,r,i,a,s,c);return ge.invert(u,u),ge.multiply(u,t,u),u}{const u=ge.clone(t),d=ge.identity([]);return d[0]=c[0],d[1]=c[1],d[4]=c[2],d[5]=c[3],ge.multiply(u,u,d),i||ge.rotateZ(u,u,-a.angle),u}}return a.glCoordMatrix}function ia(t,e,r,i){const a=[t,e,r,1];r?Wr.transformMat4(a,a,i):lC(a,a,i);const s=a[3];return a[0]/=s,a[1]/=s,a[2]/=s,a}function rC(t,e){return Math.min(.5+t/e*.5,1.5)}function OB(t,e){const r=t[0]/t[3],i=t[1]/t[3];return r>=-e[0]&&r<=e[0]&&i>=-e[1]&&i<=e[1]}function FB(t,e,r,i,a,s,c,u,d,p){const m=r.transform,_=i?t.textSizeData:t.iconSizeData,y=ka(_,r.transform.zoom),v=m.projection.name==="globe",b=[256/r.width*2+1,256/r.height*2+1],S=i?t.text.dynamicLayoutVertexArray:t.icon.dynamicLayoutVertexArray;S.clear();let T=null;v&&(T=i?t.text.globeExtVertexArray:t.icon.globeExtVertexArray);const M=t.lineVertexArray,C=i?t.text.placedSymbolArray:t.icon.placedSymbolArray,P=r.transform.width/r.transform.height;let k,z=!1;for(let L=0;L<C.length;L++){const B=C.get(L),{numGlyphs:W,writingMode:Z}=B;if(Z!==sn.vertical||z||k===sn.horizontal||(z=!0),k=Z,(B.hidden||Z===sn.vertical)&&!z){Ou(W,S);continue}z=!1;const X=new $(B.tileAnchorX,B.tileAnchorY);let{x:H,y:J,z:Q}=m.projection.projectTilePoint(X.x,X.y,p.canonical);if(d){const[Je,Ge,je]=d(X);H+=Je,J+=Ge,Q+=je}const K=[H,J,Q,1];if(Wr.transformMat4(K,K,e),!OB(K,b)){Ou(W,S);continue}const fe=K[3],he=rC(r.transform.getCameraToCenterDistance(m.projection),fe),_e=Ld(_,y,B),oe=c?_e/he:_e*he,me=ia(H,J,Q,a);if(me[3]<=0){Ou(W,S);continue}let ve={};const Ce=c?null:d,Se=oC(B,oe,!1,u,e,a,s,t.glyphOffsetArray,M,S,T,me,X,ve,P,Ce,m.projection,p,c);z=Se.useVertical,Ce&&Se.needsFlipping&&(ve={}),(Se.notEnoughRoom||z||Se.needsFlipping&&oC(B,oe,!0,u,e,a,s,t.glyphOffsetArray,M,S,T,me,X,ve,P,Ce,m.projection,p,c).notEnoughRoom)&&Ou(W,S)}i?(t.text.dynamicLayoutVertexBuffer.updateData(S),T&&t.text.globeExtVertexBuffer&&t.text.globeExtVertexBuffer.updateData(T)):(t.icon.dynamicLayoutVertexBuffer.updateData(S),T&&t.icon.globeExtVertexBuffer&&t.icon.globeExtVertexBuffer.updateData(T))}function nC(t,e,r,i,a,s,c,u,d,p,m,_,y,v,b,S){const{lineStartIndex:T,glyphStartIndex:M,segment:C}=u,P=M+u.numGlyphs,k=T+u.lineLength,z=e.getoffsetX(M),L=e.getoffsetX(P-1),B=ug(t*z,r,i,a,s,c,C,T,k,d,p,m,_,y,!0,v,b,S);if(!B)return null;const W=ug(t*L,r,i,a,s,c,C,T,k,d,p,m,_,y,!0,v,b,S);return W?{first:B,last:W}:null}function iC(t,e,r,i){return t===sn.horizontal&&Math.abs(i)>Math.abs(r)?{useVertical:!0}:t===sn.vertical?i>0?{needsFlipping:!0}:null:e!==Lu.unknown&&function(a,s){return a===0||Math.abs(s/a)>LB}(r,i)?e===Lu.flipRequired?{needsFlipping:!0}:null:r<0?{needsFlipping:!0}:null}function oC(t,e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T,M,C){const P=e/24,k=t.lineOffsetX*P,z=t.lineOffsetY*P,{lineStartIndex:L,glyphStartIndex:B,numGlyphs:W,segment:Z,writingMode:X,flipState:H}=t,J=L+t.lineLength,Q=K=>{if(m){const[oe,me,ve]=K.up,Ce=p.length;ng(m,Ce+0,oe,me,ve),ng(m,Ce+1,oe,me,ve),ng(m,Ce+2,oe,me,ve),ng(m,Ce+3,oe,me,ve)}const[fe,he,_e]=K.point;Du(p,fe,he,_e,K.angle)};if(W>1){const K=nC(P,u,k,z,r,_,y,t,d,s,v,S,!1,T,M,C);if(!K)return{notEnoughRoom:!0};if(i&&!r){let[fe,he,_e]=K.first.point,[oe,me,ve]=K.last.point;[fe,he]=ia(fe,he,_e,c),[oe,me]=ia(oe,me,ve,c);const Ce=iC(X,H,(oe-fe)*b,me-he);if(t.flipState=Ce&&Ce.needsFlipping?Lu.flipRequired:Lu.flipNotRequired,Ce)return Ce}Q(K.first);for(let fe=B+1;fe<B+W-1;fe++){const he=ug(P*u.getoffsetX(fe),k,z,r,_,y,Z,L,J,d,s,v,S,!1,!1,T,M,C);if(!he)return p.length-=4*(fe-B),{notEnoughRoom:!0};Q(he)}Q(K.last)}else{if(i&&!r){const fe=ia(y.x,y.y,0,a),he=L+Z+1,_e=new $(d.getx(he),d.gety(he)),oe=ia(_e.x,_e.y,0,a),me=oe[3]>0?oe:sC(y,_e,fe,1,a,void 0,T,M.canonical),ve=iC(X,H,(me[0]-fe[0])*b,me[1]-fe[1]);if(t.flipState=ve&&ve.needsFlipping?Lu.flipRequired:Lu.flipNotRequired,ve)return ve}const K=ug(P*u.getoffsetX(B),k,z,r,_,y,Z,L,J,d,s,v,S,!1,!1,T,M,C);if(!K)return{notEnoughRoom:!0};Q(K)}return{}}function aC(t,e,r,i,a){const{x:s,y:c,z:u}=i.projectTilePoint(t.x,t.y,e);if(!a)return ia(s,c,u,r);const[d,p,m]=a(t);return ia(s+d,c+p,u+m,r)}function sC(t,e,r,i,a,s,c,u){const d=aC(t.sub(e)._unit()._add(t),u,a,c,s);return ie.sub(d,r,d),ie.normalize(d,d),ie.scaleAndAdd(d,r,d,i)}function ug(t,e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T,M){const C=i?t-e:t+e;let P=C>0?1:-1,k=0;i&&(P*=-1,k=Math.PI),P<0&&(k+=Math.PI);let z=u+c+(P>0?0:1)|0,L=a,B=a,W=0,Z=0;const X=Math.abs(C),H=[],J=[];let Q=s,K=Q;const fe=()=>sC(K,Q,B,X-W+1,m,y,S,T.canonical);for(;W+Z<=X;){if(z+=P,z<u||z>=d)return null;if(B=L,K=Q,H.push(B),v&&J.push(K),Q=new $(p.getx(z),p.gety(z)),L=_[z],!L){const Ge=aC(Q,T.canonical,m,S,y);L=Ge[3]>0?_[z]=Ge:fe()}W+=Z,Z=ie.distance(B,L)}b&&y&&(_[z]&&(L=fe(),Z=ie.distance(B,L)),_[z]=L);const he=(X-W)/Z,_e=Q.sub(K)._mult(he)._add(K),oe=ie.sub([],L,B),me=ie.scaleAndAdd([],B,oe,he);let ve=[0,0,1],Ce=oe[0],Se=oe[1];if(M&&(ve=S.upVector(T.canonical,_e.x,_e.y),ve[0]!==0||ve[1]!==0||ve[2]!==1)){const Ge=[ve[2],0,-ve[0]],je=ie.cross([],ve,Ge);ie.normalize(Ge,Ge),ie.normalize(je,je),Ce=ie.dot(oe,Ge),Se=ie.dot(oe,je)}if(r){const Ge=ie.cross([],ve,oe);ie.normalize(Ge,Ge),ie.scaleAndAdd(me,me,Ge,r*P)}const Je=k+Math.atan2(Se,Ce);return H.push(me),v&&J.push(_e),{point:me,angle:Je,path:H,tilePath:J,up:ve}}function Ou(t,e){const r=e.length,i=r+4*t;e.resize(i),e.float32.fill(-1/0,4*r,4*i)}function lC(t,e,r){const i=e[0],a=e[1];return t[0]=r[0]*i+r[4]*a+r[12],t[1]=r[1]*i+r[5]*a+r[13],t[3]=r[3]*i+r[7]*a+r[15],t}const Fu=15,cC=(t,e,r)=>(1-r)*t+r*e,uC=t=>t*t*t*t*t;class rx{constructor(e,r,i,a,s,c,u){this.tileSize=512,this._renderWorldCopies=s===void 0||s,this._minZoom=e||0,this._maxZoom=r||22,this._minPitch=i??0,this._maxPitch=a??60,this.setProjection(c),this.setMaxBounds(u),this.width=0,this.height=0,this._center=new zt(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new ex,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new lg,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1}clone(){const e=new rx(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return e._elevation=this._elevation,e._centerAltitude=this._centerAltitude,e._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,e.tileSize=this.tileSize,e.mercatorFromTransition=this.mercatorFromTransition,e.width=this.width,e.height=this.height,e.cameraElevationReference=this.cameraElevationReference,e._center=this._center,e._setZoom(this.zoom),e._seaLevelZoom=this._seaLevelZoom,e.angle=this.angle,e._fov=this._fov,e._pitch=this._pitch,e._nearZ=this._nearZ,e._farZ=this._farZ,e._averageElevation=this._averageElevation,e._unmodified=this._unmodified,e._edgeInsets=this._edgeInsets.clone(),e._camera=this._camera.clone(),e._calcMatrices(),e.freezeTileCoverage=this.freezeTileCoverage,e.frustumCorners=this.frustumCorners,e}get elevation(){return this._elevation}set elevation(e){this._elevation!==e&&(this._elevation=e,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(e,r=!1){const i=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||i)&&this._updateCameraOnTerrain(),(e||i)&&this._constrainCamera(r),this._calcMatrices()}getProjection(){return qt(this.projection,["name","center","parallels"])}setProjection(e){this.projectionOptions=e||{name:"mercator"};const r=this.projection?this.getProjection():void 0;this.projection=Jm(this.projectionOptions);const i=!ue(r,this.getProjection());return i&&this._calcMatrices(),this.mercatorFromTransition=!1,i}setOrthographicProjectionAtLowPitch(e){return this._orthographicProjectionAtLowPitch!==e&&(this._orthographicProjectionAtLowPitch=e,this._calcMatrices(),!0)}setMercatorFromTransition(){const e=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=Jm({name:"mercator"});const r=e!==this.projection.name;return r&&this._calcMatrices(),r}get minZoom(){return this._minZoom}set minZoom(e){this._minZoom!==e&&(this._minZoom=e,this.zoom=Math.max(this.zoom,e))}get maxZoom(){return this._maxZoom}set maxZoom(e){this._maxZoom!==e&&(this._maxZoom=e,this.zoom=Math.min(this.zoom,e))}get minPitch(){return this._minPitch}set minPitch(e){this._minPitch!==e&&(this._minPitch=e,this.pitch=Math.max(this.pitch,e))}get maxPitch(){return this._maxPitch}set maxPitch(e){this._maxPitch!==e&&(this._maxPitch=e,this.pitch=Math.min(this.pitch,e))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(e){e===void 0?e=!0:e===null&&(e=!1),this._renderWorldCopies=e}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get cameraWorldSize(){const e=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(e))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return jr(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new $(this.width,this.height)}get bearing(){return Pt(this.rotation,-180,180)}set bearing(e){this.rotation=e}get rotation(){return-this.angle/Math.PI*180}set rotation(e){const r=-e*Math.PI/180;this.angle!==r&&(this._unmodified=!1,this.angle=r,this._calcMatrices(),this.rotationMatrix=mu.create(),mu.rotate(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(e){const r=ze(e,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==r&&(this._unmodified=!1,this._pitch=r,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const e=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/e)}set fov(e){e=Math.max(.01,Math.min(60,e)),this._fov!==e&&(this._unmodified=!1,this._fov=se(e),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(e){this._averageElevation=e,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(e){const r=Math.min(Math.max(e,this.minZoom),this.maxZoom);this._zoom!==r&&(this._unmodified=!1,this._setZoom(r),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(e){this._zoom=e,this.scale=this.zoomScale(e),this.tileZoom=Math.floor(e),this.zoomFraction=e-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const e=this._elevation;this._centerAltitude=e.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=e.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const e=this._elevation,r=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],i=this.horizonLineFromTop();let a=0,s=0;for(let c=0;c<r.length;c++){const u=new $(r[c][0]*this.width,i+r[c][1]*(this.height-i)),d=e.pointCoordinate(u);if(!d)continue;const p=1/Math.hypot(d[0]-this._camera.position[0],d[1]-this._camera.position[1]);a+=d[3]*p,s+=p}return s===0?NaN:a/s}get center(){return this._center}set center(e){e.lat===this._center.lat&&e.lng===this._center.lng||(this._unmodified=!1,this._center=e,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const e=this._seaLevelZoom,r=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),i=this.pixelsPerMeter/this.worldSize*r,a=this._mercatorZfromZoom(e),s=this._mercatorZfromZoom(this._maxZoom),c=Math.max(a-i,s);this._setZoom(this._zoomFromMercatorZ(c))}get padding(){return this._edgeInsets.toJSON()}set padding(e){this._edgeInsets.equals(e)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,e,1),this._calcMatrices())}computeZoomRelativeTo(e){const r=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,e.toAltitude()));let i;i=e.z<this._camera.position[2]?[r.x,r.y,r.z]:[e.x,e.y,e.z];const a=ie.length(ie.sub([],this._camera.position,i));return ze(this._zoomFromMercatorZ(a),this._minZoom,this._maxZoom)}setFreeCameraOptions(e){if(!this.height||!e.position&&!e.orientation)return;this._updateCameraState();let r=!1;if(e.orientation&&!oi.exactEquals(e.orientation,this._camera.orientation)&&(r=this._setCameraOrientation(e.orientation)),e.position){const i=[e.position.x,e.position.y,e.position.z];ie.exactEquals(i,this._camera.position)||(this._setCameraPosition(i),r=!0)}r&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const e=this._camera.position,r=new XM;return r.position=new cr(e[0],e[1],e[2]),r.orientation=this._camera.orientation,r._elevation=this.elevation,r._renderWorldCopies=this.renderWorldCopies,r}_setCameraOrientation(e){if(!oi.length(e))return!1;oi.normalize(e,e);const r=ie.transformQuat([],[0,0,-1],e),i=ie.transformQuat([],[0,-1,0],e);if(i[2]<0)return!1;const a=ZM(r,i);return!!a&&(this._camera.orientation=a,!0)}_setCameraPosition(e){const r=this.zoomScale(this.minZoom)*this.tileSize,i=this.zoomScale(this.maxZoom)*this.tileSize,a=this.cameraToCenterDistance;e[2]=ze(e[2],a/i,a/r),this._camera.position=e}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(e){return this._edgeInsets.equals(e)}interpolatePadding(e,r,i){this._unmodified=!1,this._edgeInsets.interpolate(e,r,i),this._constrain(),this._calcMatrices()}coveringZoomLevel(e){const r=(e.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/e.tileSize));return Math.max(0,r)}getVisibleUnwrappedCoordinates(e){const r=[new _v(0,e)];if(this.renderWorldCopies){const i=this.pointCoordinate(new $(0,0)),a=this.pointCoordinate(new $(this.width,0)),s=this.pointCoordinate(new $(this.width,this.height)),c=this.pointCoordinate(new $(0,this.height)),u=Math.floor(Math.min(i.x,a.x,s.x,c.x)),d=Math.floor(Math.max(i.x,a.x,s.x,c.x)),p=1;for(let m=u-p;m<=d+p;m++)m!==0&&r.push(new _v(m,e))}return r}coveringTiles(e){let r=this.coveringZoomLevel(e);const i=r,a=this.elevation&&this.elevation.exaggeration(),s=a&&!e.isTerrainDEM,c=this.projection.name==="mercator";if(e.minzoom!==void 0&&r<e.minzoom)return[];e.maxzoom!==void 0&&r>e.maxzoom&&(r=e.maxzoom);const u=this.locationCoordinate(this.center),d=this.center.lat,p=1<<r,m=[p*u.x,p*u.y,0],_=this.projection.name==="globe",y=!_,v=gu.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,r,y),b=_?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),S=p*jr(1,this.center.lat),T=this._camera.position[2]/jr(1,this.center.lat),M=[p*b.x,p*b.y,T*(y?1:S)],C=_||a,P=this.cameraToCenterDistance/e.tileSize*(e.roundZoom?1:.502),k=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?r:0,z=e.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,L=e.isTerrainDEM?-z:this._elevation?this._elevation.getMinElevationBelowMSL():0,B=this.projection.isReprojectedInTileSpace?KM(this):1,W=oe=>{const ve=new cr(oe.x+25e-6,oe.y,oe.z),Ce=new cr(oe.x,oe.y+25e-6,oe.z),Se=oe.toLngLat(),Je=ve.toLngLat(),Ge=Ce.toLngLat(),je=this.locationCoordinate(Se),Ve=this.locationCoordinate(Je),nt=this.locationCoordinate(Ge),wt=Math.hypot(Ve.x-je.x,Ve.y-je.y),pt=Math.hypot(nt.x-je.x,nt.y-je.y);return Math.sqrt(wt*pt)*B/25e-6},Z=oe=>{const me=z,ve=L;return{aabb:DM(this,p,0,0,0,oe,ve,me,this.projection),zoom:0,x:0,y:0,minZ:ve,maxZ:me,wrap:oe,fullyVisible:!1}},X=[];let H=[];const J=r,Q=e.reparseOverscaled?i:r,K=oe=>oe*oe,fe=K((T-this._centerAltitude)*S),he=oe=>{if(!this._elevation||!oe.tileID||!c)return;const me=this._elevation.getMinMaxForTile(oe.tileID),ve=oe.aabb;me?(ve.min[2]=me.min,ve.max[2]=me.max,ve.center[2]=(ve.min[2]+ve.max[2])/2):(oe.shouldSplit=_e(oe),oe.shouldSplit||(ve.min[2]=ve.max[2]=ve.center[2]=this._centerAltitude))},_e=oe=>{if(oe.zoom<k)return!0;if(oe.zoom===J)return!1;if(oe.shouldSplit!=null)return oe.shouldSplit;const me=oe.aabb.distanceX(M),ve=oe.aabb.distanceY(M);let Ce=fe,Se=1;if(_){Ce=K(oe.aabb.distanceZ(M));const je=Math.pow(2,oe.zoom),Ve=zn((oe.y+1)/je),nt=zn(oe.y/je),wt=Math.min(Math.max(d,Ve),nt),pt=Cm(wt)/Cm(d);if(Se=wt===d?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,pt/this._mercatorScaleRatio),this.zoom<=Ad&&oe.zoom===J-1&&pt>=.9)return!0}else if(s&&(Ce=K(oe.aabb.distanceZ(M)*S)),this.projection.isReprojectedInTileSpace&&i<=5){const je=Math.pow(2,oe.zoom),Ve=W(new cr((oe.x+.5)/je,(oe.y+.5)/je));Se=Ve>.85?1:Ve}const Je=me*me+ve*ve+Ce,Ge=K((1<<J-oe.zoom)*P*Se*((je,Ve)=>{if(Ve*K(.707)<je)return 1;const nt=Math.sqrt(Ve/je);return nt/(1.4144271570014144+(Math.pow(1.1,nt-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Ce,fe),Je));return Je<Ge};if(this.renderWorldCopies)for(let oe=1;oe<=3;oe++)X.push(Z(-oe)),X.push(Z(oe));for(X.push(Z(0));X.length>0;){const oe=X.pop(),me=oe.x,ve=oe.y;let Ce=oe.fullyVisible;const Se=()=>this.projection.name==="globe"&&(oe.y===0||oe.y===(1<<oe.zoom)-1);if(!Ce){let Je=C?oe.aabb.intersects(v):oe.aabb.intersectsFlat(v);if(Je===0&&Se()){const Ge=new ns(oe.zoom,me,ve);Je=dv(this,p,Ge,!0).intersects(v)}if(Je===0)continue;Ce=Je===2}if(oe.zoom!==J&&_e(oe))for(let Je=0;Je<4;Je++){const Ge=(me<<1)+Je%2,je=(ve<<1)+(Je>>1),Ve={aabb:c?oe.aabb.quadrant(Je):DM(this,p,oe.zoom+1,Ge,je,oe.wrap,oe.minZ,oe.maxZ,this.projection),zoom:oe.zoom+1,x:Ge,y:je,wrap:oe.wrap,fullyVisible:Ce,tileID:void 0,shouldSplit:void 0,minZ:oe.minZ,maxZ:oe.maxZ};s&&!_&&(Ve.tileID=new Kr(oe.zoom+1===J?Q:oe.zoom+1,oe.wrap,oe.zoom+1,Ge,je),he(Ve)),X.push(Ve)}else{const Je=oe.zoom===J?Q:oe.zoom;if(e.minzoom&&e.minzoom>Je)continue;if(!Ce){let nt=C?oe.aabb.intersectsPrecise(v):oe.aabb.intersectsPreciseFlat(v);if(nt===0&&Se()){const wt=new ns(oe.zoom,me,ve);nt=dv(this,p,wt,!0).intersectsPrecise(v)}if(nt===0)continue}const Ge=m[0]-(.5+me+(oe.wrap<<oe.zoom))*(1<<r-oe.zoom),je=m[1]-.5-ve,Ve=oe.tileID?oe.tileID:new Kr(Je,oe.wrap,oe.zoom,me,ve);H.push({tileID:Ve,distanceSq:Ge*Ge+je*je})}}if(this.fogCullDistSq){const oe=this.fogCullDistSq,me=this.horizonLineFromTop();H=H.filter(ve=>{const Ce=[0,0,0,1],Se=[Ae,Ae,0,1],Je=this.calculateFogTileMatrix(ve.tileID.toUnwrapped());Wr.transformMat4(Ce,Ce,Je),Wr.transformMat4(Se,Se,Je);const Ge=function(nt,wt,pt){let dt=0;for(let Et=0;Et<2;++Et)nt[Et]>0&&(dt+=(nt[Et]-0)*(nt[Et]-0)),wt[Et]<0&&(dt+=(0-wt[Et])*(0-wt[Et]));return dt}(Ce,Se);if(Ge===0)return!0;let je=!1;const Ve=this._elevation;if(Ve&&Ge>oe&&me!==0){const nt=this.calculateProjMatrix(ve.tileID.toUnwrapped());let wt;e.isTerrainDEM||(wt=Ve.getMinMaxForTile(ve.tileID)),wt||(wt={min:L,max:z});const pt=function(Et){const nr=Math.round((Et+45+360)%360/90)%4;return $e[nr]}(this.rotation),dt=[pt[0]*Ae,pt[1]*Ae,wt.max];ie.transformMat4(dt,dt,nt),je=(1-dt[1])*this.height*.5<me}return Ge<oe||je})}return H.sort((oe,me)=>oe.distanceSq-me.distanceSq).map(oe=>oe.tileID)}resize(e,r){this.width=e,this.height=r,this.pixelsToGLUnits=[2/e,-2/r],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(e){return Math.pow(2,e)}scaleZoom(e){return Math.log(e)/Math.LN2}project(e){const r=ze(e.lat,-An,An),i=this.projection.project(e.lng,r);return new $(i.x*this.worldSize,i.y*this.worldSize)}unproject(e){return this.projection.unproject(e.x/this.worldSize,e.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/jr(1,this.center.lat)/this.worldSize}setLocationAtPoint(e,r){let i,a;const s=this.centerPoint;if(this.projection.name==="globe"){const u=this.worldSize;i=(r.x-s.x)/u,a=(r.y-s.y)/u}else{const u=this.pointCoordinate(r),d=this.pointCoordinate(s);i=u.x-d.x,a=u.y-d.y}const c=this.locationCoordinate(e);this.setLocation(new cr(c.x-i,c.y-a))}setLocation(e){this.center=this.coordinateLocation(e),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(e){return this.projection.locationPoint(this,e)}locationPoint3D(e){return this.projection.locationPoint(this,e,!0)}pointLocation(e){return this.coordinateLocation(this.pointCoordinate(e))}pointLocation3D(e){return this.coordinateLocation(this.pointCoordinate3D(e))}locationCoordinate(e,r){const i=r?jr(r,e.lat):void 0,a=this.projection.project(e.lng,e.lat);return new cr(a.x,a.y,i)}coordinateLocation(e){return this.projection.unproject(e.x,e.y)}pointRayIntersection(e,r){const i=r??this._centerAltitude,a=[e.x,e.y,0,1],s=[e.x,e.y,1,1];Wr.transformMat4(a,a,this.pixelMatrixInverse),Wr.transformMat4(s,s,this.pixelMatrixInverse);const c=s[3];Wr.scale(a,a,1/a[3]),Wr.scale(s,s,1/c);const u=a[2],d=s[2];return{p0:a,p1:s,t:u===d?0:(i-u)/(d-u)}}screenPointToMercatorRay(e){const r=[e.x,e.y,0,1],i=[e.x,e.y,1,1];return Wr.transformMat4(r,r,this.pixelMatrixInverse),Wr.transformMat4(i,i,this.pixelMatrixInverse),Wr.scale(r,r,1/r[3]),Wr.scale(i,i,1/i[3]),r[2]=jr(r[2],this._center.lat)*this.worldSize,i[2]=jr(i[2],this._center.lat)*this.worldSize,Wr.scale(r,r,1/this.worldSize),Wr.scale(i,i,1/this.worldSize),new wm([r[0],r[1],r[2]],ie.normalize([],ie.sub([],i,r)))}rayIntersectionCoordinate(e){const{p0:r,p1:i,t:a}=e,s=jr(r[2],this._center.lat),c=jr(i[2],this._center.lat);return new cr(Ft(r[0],i[0],a)/this.worldSize,Ft(r[1],i[1],a)/this.worldSize,Ft(s,c,a))}pointCoordinate(e,r=this._centerAltitude){return this.projection.pointCoordinate(this,e.x,e.y,r)}pointCoordinate3D(e){if(!this.elevation)return this.pointCoordinate(e);let r=this.projection.pointCoordinate3D(this,e.x,e.y);if(r)return new cr(r[0],r[1],r[2]);let i=0,a=this.horizonLineFromTop();if(e.y>a)return this.pointCoordinate(e);const s=.02*a,c=e.clone();for(let u=0;u<10&&a-i>s;u++){c.y=Ft(i,a,.66);const d=this.projection.pointCoordinate3D(this,c.x,c.y);d?(a=c.y,r=d):i=c.y}return r?new cr(r[0],r[1],r[2]):this.pointCoordinate(e)}isPointAboveHorizon(e){return this.projection.isPointAboveHorizon(this,e)}isPointOnSurface(e){if(e.y<0||e.y>this.height||e.x<0||e.x>this.width)return!1;if(this.elevation||this.zoom>=Zs)return!this.isPointAboveHorizon(e);const r=this.pointCoordinate(e);return r.y>=0&&r.y<=1}_coordinatePoint(e,r){const i=r&&this.elevation?this.elevation.getAtPointOrZero(e,this._centerAltitude):this._centerAltitude,a=[e.x*this.worldSize,e.y*this.worldSize,i+e.toAltitude(),1];return Wr.transformMat4(a,a,this.pixelMatrix),a[3]>0?new $(a[0]/a[3],a[1]/a[3]):new $(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:e,left:r}=this._edgeInsets,i=this.height-this._edgeInsets.bottom,a=this.width-this._edgeInsets.right,s=this.pointLocation3D(new $(r,e)),c=this.pointLocation3D(new $(a,e)),u=this.pointLocation3D(new $(a,i)),d=this.pointLocation3D(new $(r,i));let p=Math.min(s.lng,c.lng,u.lng,d.lng),m=Math.max(s.lng,c.lng,u.lng,d.lng),_=Math.min(s.lat,c.lat,u.lat,d.lat),y=Math.max(s.lat,c.lat,u.lat,d.lat);const v=Math.pow(2,-this.zoom)/16*270,b=this.projection.name==="globe"?1:4,S=(T,M,C,P,k)=>{const z=(T+C)/2,L=(M+P)/2,B=new $(z,L),{lng:W,lat:Z}=this.pointLocation3D(B),X=Math.max(0,p-W,_-Z,W-m,Z-y);p=Math.min(p,W),m=Math.max(m,W),_=Math.min(_,Z),y=Math.max(y,Z),(k<b||X>v)&&(S(T,M,z,L,k+1),S(z,L,C,P,k+1))};if(S(r,e,a,e,1),S(a,e,a,i,1),S(a,i,r,i,1),S(r,i,r,e,1),this.projection.name==="globe"){const[T,M]=function(C){const P=ge.identity(new Float64Array(16));ge.multiply(P,C.pixelMatrix,C.globeMatrix);const k=[0,Do,0],z=[0,Lo,0];return ie.transformMat4(k,k,P),ie.transformMat4(z,z,P),[k[0]>0&&k[0]<=C.width&&k[1]>0&&k[1]<=C.height&&!Mm(C,new zt(C.center.lat,90)),z[0]>0&&z[0]<=C.width&&z[1]>0&&z[1]<=C.height&&!Mm(C,new zt(C.center.lat,-90))]}(this);T?(y=90,m=180,p=-180):M&&(_=-90,m=180,p=-180)}return new lo(new zt(p,_),new zt(m,y))}_getBoundsRectangular(e,r){const{top:i,left:a}=this._edgeInsets,s=this.height-this._edgeInsets.bottom,c=this.width-this._edgeInsets.right,u=new $(a,i),d=new $(c,i),p=new $(c,s),m=new $(a,s);let _=this.pointCoordinate(u,e),y=this.pointCoordinate(d,e);const v=this.pointCoordinate(p,r),b=this.pointCoordinate(m,r),S=(T,M)=>(M.y-T.y)/(M.x-T.x);return _.y>1&&y.y>=0?_=new cr((1-b.y)/S(b,_)+b.x,1):_.y<0&&y.y<=1&&(_=new cr(-b.y/S(b,_)+b.x,0)),y.y>1&&_.y>=0?y=new cr((1-v.y)/S(v,y)+v.x,1):y.y<0&&_.y<=1&&(y=new cr(-v.y/S(v,y)+v.x,0)),new lo().extend(this.coordinateLocation(_)).extend(this.coordinateLocation(y)).extend(this.coordinateLocation(b)).extend(this.coordinateLocation(v))}_getBoundsRectangularTerrain(){const e=this.elevation;if(!e.visibleDemTiles.length||e.isUsingMockSource())return this._getBoundsRectangular(0,0);const r=e.visibleDemTiles.reduce((i,a)=>{if(a.dem){const s=a.dem.tree;i.min=Math.min(i.min,s.minimums[0]),i.max=Math.max(i.max,s.maximums[0])}return i},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(r.min*e.exaggeration(),r.max*e.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(e=!0){const r=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,i=this.height/2-r*(1-this._horizonShift);return e?Math.max(0,i):i}getMaxBounds(){return this.maxBounds}setMaxBounds(e){this.maxBounds=e,this.minLat=-An,this.maxLat=An,this.minLng=-180,this.maxLng=180,e&&(this.minLat=e.getSouth(),this.maxLat=e.getNorth(),this.minLng=e.getWest(),this.maxLng=e.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=ei(this.minLng)*this.tileSize,this.worldMaxX=ei(this.maxLng)*this.tileSize,this.worldMinY=ai(this.maxLat)*this.tileSize,this.worldMaxY=ai(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(e,r){return this.projection.createTileMatrix(this,r,e)}calculateDistanceTileData(e){const r=e.key,i=this._distanceTileDataCache;if(i[r])return i[r];const a=e.canonical,s=1/this.height,c=this.cameraWorldSize,u=c/this.zoomScale(a.z),d=(a.x+Math.pow(2,a.z)*e.wrap)*u,p=a.y*u,m=this.point;m.x*=c/this.worldSize,m.y*=c/this.worldSize;const _=this.angle,y=Math.sin(-_),v=-Math.cos(-_);return i[r]={bearing:[y,v],center:[(m.x-d)*s,(m.y-p)*s],scale:u/Ae*s},i[r]}calculateFogTileMatrix(e){const r=e.key,i=this._fogTileMatrixCache;if(i[r])return i[r];const a=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,e);return ge.multiply(a,this.worldToFogMatrix,a),i[r]=new Float32Array(a),i[r]}calculateProjMatrix(e,r=!1){const i=e.key,a=r?this._alignedProjMatrixCache:this._projMatrixCache;if(a[i])return a[i];const s=this.calculatePosMatrix(e,this.worldSize);return ge.multiply(s,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:r?this.alignedProjMatrix:this.projMatrix,s),a[i]=new Float32Array(s),a[i]}calculatePixelsToTileUnitsMatrix(e){const r=e.tileID.key,i=this._pixelsToTileUnitsCache;if(i[r])return i[r];const a=function(s,c){const{scale:u}=s.tileTransform,d=u*Ae/(s.tileSize*Math.pow(2,c.zoom-s.tileID.overscaledZ+s.tileID.canonical.z));return mu.scale(new Float32Array(4),c.inverseAdjustmentMatrix,[d,d])}(e,this);return i[r]=a,i[r]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const e=1/this.worldSize,r=ge.fromScaling([],[e,e,e]);return ge.multiply(r,r,this.globeMatrix),r}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const e=this._elevation;this._updateCameraState();const r=jr(1,this._center.lat)*this.worldSize,i=this._computeCameraPosition(r),a=this._camera.forward(),s=jr(1,this._center.lat);i[2]/=s,a[2]/=s,ie.normalize(a,a);const c=e.raycast(i,a,e.exaggeration());if(c){const u=ie.scaleAndAdd([],i,a,c),d=new cr(u[0],u[1],jr(u[2],zn(u[1]))),p=(d.z+ie.length([d.x-i[0],d.y-i[1],d.z-i[2]*s]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(p),this._centerAltitude=d.toAltitude(),this._center=this.coordinateLocation(d),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(e=!1){if(!this._elevation)return;const r=this._elevation,i=jr(1,this._center.lat)*this.worldSize,a=this._computeCameraPosition(i),s=r.getAtPointOrZero(new cr(...a)),c=this.pixelsPerMeter/this.worldSize*s,u=this._minimumHeightOverTerrain(),d=a[2]-c;if(d<=u)if(d<0||e){const p=this.locationCoordinate(this._center,this._centerAltitude),m=[a[0],a[1],p.z-a[2]],_=ie.length(m);m[2]-=(u-d)/this._pixelsPerMercatorPixel;const y=ie.length(m);if(y===0)return;ie.scale(m,m,_/y*this._pixelsPerMercatorPixel),this._camera.position=[a[0],a[1],p.z*this._pixelsPerMercatorPixel-m[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const e=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||e){const y=this.center;return y.lat=ze(y.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!e)&&(y.lng=ze(y.lng,this.minLng,this.maxLng)),this.center=y,void(this._constraining=!1)}const r=this._unmodified,{x:i,y:a}=this.point;let s=0,c=i,u=a;const d=this.width/2,p=this.height/2,m=this.worldMinY*this.scale,_=this.worldMaxY*this.scale;if(a-p<m&&(u=m+p),a+p>_&&(u=_-p),_-m<this.height&&(s=Math.max(s,this.height/(_-m)),u=(_+m)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const y=this.worldMinX*this.scale,v=this.worldMaxX*this.scale,b=this.worldSize/2-(y+v)/2;c=(i+b+this.worldSize)%this.worldSize-b,c-d<y&&(c=y+d),c+d>v&&(c=v-d),v-y<this.width&&(s=Math.max(s,this.width/(v-y)),c=(v+y)/2)}c===i&&u===a||(this.center=this.unproject(new $(c,u))),s&&(this.zoom+=this.scaleZoom(s)),this._constrainCamera(),this._unmodified=r,this._constraining=!1}_minZoomForBounds(){let e=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(e=Math.max(e,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),e}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const e=this.centerOffset,r=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=jr(1,this.center.lat)/jr(1,45));const i=qd(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,i),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const a=this.projection.zAxisUnit==="meters"?r:1,s=this._camera.getWorldToCamera(this.worldSize,a);let c;const u=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(u[8]=2*-e.x/this.width,u[9]=2*e.y/this.height,this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<Fu){let W=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),Z=W*this.aspect,X=-Z,H=-W;Z-=e.x,X-=e.x,W+=e.y,H+=e.y,c=this._camera.getCameraToClipOrthographic(X,Z,H,W,this._nearZ,this._farZ),((J,Q,K,fe)=>{for(let he=0;he<16;he++)J[he]=cC(Q[he],K[he],fe)})(c,c,u,uC(this.pitch>=Fu?1:this.pitch/Fu))}else c=u;const d=ge.mul([],u,s);let p=ge.mul([],c,s);if(this.projection.isReprojectedInTileSpace){const W=this.locationCoordinate(this.center),Z=ge.identity([]);ge.translate(Z,Z,[W.x*this.worldSize,W.y*this.worldSize,0]),ge.multiply(Z,Z,YM(this)),ge.translate(Z,Z,[-W.x*this.worldSize,-W.y*this.worldSize,0]),ge.multiply(p,p,Z),ge.multiply(d,d,Z),this.inverseAdjustmentMatrix=function(X){const H=YM(X,!0);return mu.invert([],[H[0],H[1],H[4],H[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=ge.scale([],p,[this.worldSize,this.worldSize,this.worldSize/a,1]),this.projMatrix=p,this.invProjMatrix=ge.invert(new Float64Array(16),this.projMatrix);const m=ge.invert([],c);this.frustumCorners=lv.fromInvProjectionMatrix(m,this.horizonLineFromTop(),this.height);const _=new Float32Array(16);ge.identity(_),ge.scale(_,_,[1,-1,1]),ge.rotateX(_,_,this._pitch),ge.rotateZ(_,_,this.angle);const y=ge.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=ge.clone(y);const v=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;y[8]=2*-e.x/this.width,y[9]=2*(e.y+v)/this.height,this.skyboxMatrix=ge.multiply(_,y,_);const b=this.point,S=b.x,T=b.y,M=this.width%2/2,C=this.height%2/2,P=Math.cos(this.angle),k=Math.sin(this.angle),z=S-Math.round(S)+P*M+k*C,L=T-Math.round(T)+P*C+k*M,B=new Float64Array(p);if(ge.translate(B,B,[z>.5?z-1:z,L>.5?L-1:L,0]),this.alignedProjMatrix=B,p=ge.create(),ge.scale(p,p,[this.width/2,-this.height/2,1]),ge.translate(p,p,[1,-1,0]),this.labelPlaneMatrix=p,p=ge.create(),ge.scale(p,p,[1,-1,1]),ge.translate(p,p,[-1,-1,0]),ge.scale(p,p,[2/this.width,2/this.height,1]),this.glCoordMatrix=p,this.pixelMatrix=ge.multiply(new Float64Array(16),this.labelPlaneMatrix,d),this._calcFogMatrices(),this._distanceTileDataCache={},p=ge.invert(new Float64Array(16),this.pixelMatrix),!p)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=p,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=function(Z){const{x:X,y:H}=Z.point,{lng:J,lat:Q}=Z._center;return xT(X,H,Z.worldSize,J,Q)}(this);const W=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=ie.transformMat4(W,W,s),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=p;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const e=this.cameraWorldSizeForFog,r=this.cameraPixelsPerMeter,i=this._camera.position,a=1/this.height/this._pixelsPerMercatorPixel,s=[e,e,r];ie.scale(s,s,a),ie.scale(i,i,-1),ie.multiply(i,i,s);const c=ge.create();ge.translate(c,c,i),ge.scale(c,c,s),this.mercatorFogMatrix=c,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(e,r,a)}_computeCameraPosition(e){const r=(e=e||this.pixelsPerMeter)/this.pixelsPerMeter,i=this._camera.forward(),a=this.point,s=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*r-e/this.worldSize*this._centerAltitude;return[a.x/this.worldSize-i[0]*s,a.y/this.worldSize-i[1]*s,e/this.worldSize*this._centerAltitude-i[2]*s]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(e){const r=this._maxCameraBoundsDistance()*Math.cos(this._pitch),i=this._camera.position[2],a=e[2];let s=1;this.projection.wrap&&(this.center=this.center.wrap()),a>0&&(s=Math.min((r-i)/a,1)),this._camera.position=ie.scaleAndAdd([],this._camera.position,e,s),this._updateStateFromCamera()}_updateStateFromCamera(){const e=this._camera.position,r=this._camera.forward(),{pitch:i,bearing:a}=this._camera.getPitchBearing(),s=jr(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,c=this._mercatorZfromZoom(this._maxZoom)*Math.cos(se(this._maxPitch)),u=Math.max((e[2]-s)/Math.cos(i),c),d=this._zoomFromMercatorZ(u);ie.scaleAndAdd(e,e,r,u),this._pitch=ze(i,se(this.minPitch),se(this.maxPitch)),this.angle=Pt(a,-Math.PI,Math.PI),this._setZoom(ze(d,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new cr(e[0],e[1],e[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(e){return Math.pow(2,e)*this.tileSize}_mercatorZfromZoom(e){return this.cameraToCenterDistance/this._worldSizeFromZoom(e)}_minimumHeightOverTerrain(){const e=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(e)}_zoomFromMercatorZ(e){return this.scaleZoom(this.cameraToCenterDistance/(e*this.tileSize))}zoomFromMercatorZAdjusted(e){let r=0,i=Zs,a=0,s=1/0;for(;i-r>1e-6&&i>r;){const c=r+.5*(i-r),u=this.tileSize*Math.pow(2,c),d=this.getCameraToCenterDistance(this.projection,c,u),p=this.scaleZoom(d/(e*this.tileSize)),m=Math.abs(c-p);m<s&&(s=m,a=c),c<p?r=c:i=c}return a}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(re("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(e,r){const i=Math.min(e.x,r.x),a=Math.max(e.x,r.x),s=Math.min(e.y,r.y),c=Math.max(e.y,r.y);if(s<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const u=[new $(i,s),new $(a,c),new $(i,c),new $(a,s)],d=this.renderWorldCopies?-3:0,p=this.renderWorldCopies?4:1;for(const m of u){const _=this.pointRayIntersection(m);if(_.t<0)return!0;const y=this.rayIntersectionCoordinate(_);if(y.x<d||y.y<0||y.x>p||y.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+ke(this.fovAboveCenter)>88||this.anyCornerOffEdge(new $(0,0),new $(this.width,this.height))}zoomDeltaToMovement(e,r){const i=ie.length(ie.sub([],this._camera.position,e)),a=this._zoomFromMercatorZ(i)+r;return i-this._mercatorZfromZoom(a)}getCameraPoint(){if(this.projection.name==="globe"){const e=function([r,i,a],s){const c=[r,i,a,1];Wr.transformMat4(c,c,s);const u=c[3]=Math.max(c[3],1e-6);return c[0]/=u,c[1]/=u,c[2]/=u,c}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new $(e[0],e[1])}{const e=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new $(0,e))}}getCameraToCenterDistance(e,r=this.zoom,i=this.worldSize){const a=qd(e,r,this.width,this.height,1024),s=e.pixelSpaceConversion(this.center.lat,i,a);let c=.5/Math.tan(.5*this._fov)*this.height*s;return this._orthographicProjectionAtLowPitch&&this.projection.name!=="globe"&&this.pitch<Fu&&(c=cC(1,c,uC(this.pitch>=Fu?1:this.pitch/Fu))),c}getWorldToCameraMatrix(){const e=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&ge.multiply(e,e,this.globeMatrix),e}}function hC(t,e,r){ge.identity(t),ge.rotateZ(t,t,se(e[2])),ge.rotateX(t,t,se(e[0])),ge.rotateY(t,t,se(e[1])),ge.scale(t,t,r),ge.multiply(t,t,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function hg(t,e,r,i,a,s,c,u){const d=[r[0]-e[0],r[1]-e[1],0],p=[i[0]-e[0],i[1]-e[1],0];if(ie.length(d)<1e-12||ie.length(p)<1e-12)return oi.identity(t);const m=ie.cross([],d,p);ie.normalize(m,m),ie.subtract(p,i,e),d[2]=(s-a)*u,p[2]=(c-a)*u;const _=d;return ie.cross(_,d,p),ie.normalize(_,_),oi.rotationTo(t,m,_)}function dC(t,e,r=!1){const i=Qn(e.zoom),a=function(s,c,u){const d=c.worldSize,p=[s[12],s[13],s[14]],m=zn(p[1]/d),_=Hi(p[0]/d),y=ge.identity([]),v=jr(1,m)*d,b=jr(1,0)*d*Ys(m,c.zoom),S=1/mv(d);let T=b*S;if(u){const k=qd(c.projection,c.zoom,c.width,c.height,1024);T=S*c.projection.pixelSpaceConversion(c.center.lat,d,k)}const M=Pi(m,_);ie.add(M,M,ie.scale([],ie.normalize([],M),v*T*p[2]));const C=function(k){const z=[k[0],k[1],k[2]];let L=[0,1,0];const B=ie.cross([],L,z);return ie.cross(L,z,B),ie.squaredLength(L)===0&&(L=[0,1,0],ie.cross(B,z,L)),ie.normalize(B,B),ie.normalize(L,L),ie.normalize(z,z),[B[0],B[1],B[2],0,L[0],L[1],L[2],0,z[0],z[1],z[2],0,k[0],k[1],k[2],1]}(M);ge.scale(y,y,[T,T,T*v]),ge.translate(y,y,[-p[0],-p[1],-p[2]]);const P=ge.multiply([],c.globeMatrix,C);return ge.multiply(P,P,y),ge.multiply(P,P,s),P}(t,e,r);if(i>0){const s=function(c,u){const d=u.worldSize,p=jr(1,0)*d*Ys(u.center.lat,u.zoom)/mv(d),m=jr(1,u.center.lat)*d,_=ge.identity([]);return ge.rotateY(_,_,se(u.center.lng)),ge.rotateX(_,_,se(u.center.lat)),ge.translate(_,_,[0,0,Wi]),ge.scale(_,_,[p,p,p*m]),ge.translate(_,_,[u.point.x-.5*d,u.point.y-.5*d,0]),ge.multiply(_,_,c),ge.multiply(_,u.globeMatrix,_)}(t,e);return function(c,u,d){const p=(b,S,T)=>{const M=ie.length(b),C=ie.length(S),P=rs(b,S,T);return ie.scale(P,P,1/ie.length(P)*Ft(M,C,T))},m=p([c[0],c[1],c[2]],[u[0],u[1],u[2]],d),_=p([c[4],c[5],c[6]],[u[4],u[5],u[6]],d),y=p([c[8],c[9],c[10]],[u[8],u[9],u[10]],d),v=rs([c[12],c[13],c[14]],[u[12],u[13],u[14]],d);return[m[0],m[1],m[2],0,_[0],_[1],_[2],0,y[0],y[1],y[2],0,v[0],v[1],v[2],1]}(a,s,i)}return a}const BB=[1,1,1];class fC{constructor(e,r,i,a,s){this.id=e,this.uri=r,this.position=i!=null?new zt(i[0],i[1]):new zt(0,0),this.orientation=a??[0,0,0],this.nodes=s,this.uploaded=!1,this.aabb=new _n([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(e,r){if(ge.multiply(e.matrix,r,e.matrix),e.meshes)for(const i of e.meshes){const a=_n.applyTransform(i.aabb,e.matrix);this.aabb.encapsulate(a)}if(e.children)for(const i of e.children)this._applyTransformations(i,e.matrix)}computeBoundsAndApplyParent(){const e=ge.identity([]);for(const r of this.nodes)this._applyTransformations(r,e)}_positionModelOnTerrain(e,r){const i=e.elevation;if(!i)return 0;const a=_n.projectAabbCorners(this.aabb,this.matrix),s=jr(1,this.position.lat)*e.worldSize,c=function(M,C){const P=[0,0,1],k=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const z of k){const L=M[z.corners[0]],B=M[z.corners[1]],W=M[z.corners[2]],Z=[B[0]-L[0],B[1]-L[1],C*(B[2]-L[2])],X=ie.cross(Z,Z,[W[0]-L[0],W[1]-L[1],C*(W[2]-L[2])]);ie.normalize(X,X),z.dotProductWithUp=ie.dot(X,P)}return k.sort((z,L)=>z.dotProductWithUp-L.dotProductWithUp),k[0].corners}(a,s),u=a[c[0]],d=a[c[1]],p=a[c[2]],m=a[c[3]],_=i.getAtPointOrZero(new cr(u[0]/e.worldSize,u[1]/e.worldSize),0),y=i.getAtPointOrZero(new cr(d[0]/e.worldSize,d[1]/e.worldSize),0),v=i.getAtPointOrZero(new cr(p[0]/e.worldSize,p[1]/e.worldSize),0),b=i.getAtPointOrZero(new cr(m[0]/e.worldSize,m[1]/e.worldSize),0),S=(_+b)/2,T=(y+v)/2;return S>T?y<v?hg(r,d,m,u,y,b,_,s):hg(r,p,u,m,v,_,b,s):_<b?hg(r,u,d,p,_,y,v,s):hg(r,m,p,d,b,v,y,s),Math.max(S,T)}computeModelMatrix(e,r,i,a,s,c,u=!1){const d=e.transform,p=d.zoom,m=d.project(this.position),_=Ys(this.position.lat,p),y=1/_;ge.identity(this.matrix),ge.translate(this.matrix,this.matrix,[m.x+a[0]*y,m.y+a[1]*y,a[2]]);let v=1,b=1;const S=d.worldSize;if(u){if(d.projection.name==="mercator"){let P=0;d.elevation&&(P=d.elevation.getAtPointOrZero(new cr(m.x/S,m.y/S),0));const k=Wr.transformMat4([],[m.x,m.y,P,1],d.projMatrix)[3]/d.cameraToCenterDistance;v=k,b=k*Ys(d.center.lat,p)}else if(d.projection.name==="globe"){const P=dC(this.matrix,d),k=ge.multiply([],d.projMatrix,P),z=[0,0,0,1];Wr.transformMat4(z,z,k);const L=z[3]/d.cameraToCenterDistance,B=Qn(p),W=d.projection.pixelsPerMeter(this.position.lat,S)*Ys(this.position.lat,p),Z=d.projection.pixelsPerMeter(d.center.lat,S)*Ys(d.center.lat,p);v=L/Ft(W,CT(d.center.lat),B),b=L*_/W,v*=Z,b*=Z}}else v=y;ge.scale(this.matrix,this.matrix,[v,v,b]);const T=[...this.matrix],M=this.orientation,C=[];if(hC(C,[M[0]+r[0],M[1]+r[1],M[2]+r[2]],i),ge.multiply(this.matrix,T,C),s&&d.elevation){let P=0;const k=[];if(c&&d.elevation){P=this._positionModelOnTerrain(d,k);const z=ge.fromQuat([],k),L=ge.multiply([],z,C);ge.multiply(this.matrix,T,L)}else P=d.elevation.getAtPointOrZero(new cr(m.x/S,m.y/S),0);P!==0&&(this.matrix[14]+=P)}}upload(e){if(!this.uploaded){for(const r of this.nodes)nx(r,e);for(const r of this.nodes)dg(r);this.uploaded=!0}}destroy(){for(const e of this.nodes)fg(e)}}function Zd(t,e,r=!1){t.uploaded||(t.gfxTexture=new Dn(e,t.image,r?e.gl.R8:e.gl.RGBA,{useMipmap:t.sampler.mipmaps}),t.uploaded=!0,t.image=null)}function NB(t,e,r){t.indexBuffer=e.createIndexBuffer(t.indexArray,!1,!0),t.vertexBuffer=e.createVertexBuffer(t.vertexArray,IB.members,!1,!0),t.normalArray&&(t.normalBuffer=e.createVertexBuffer(t.normalArray,zB.members,!1,!0)),t.texcoordArray&&(t.texcoordBuffer=e.createVertexBuffer(t.texcoordArray,RB.members,!1,!0)),t.colorArray&&(t.colorBuffer=e.createVertexBuffer(t.colorArray,(t.colorArray.bytesPerElement===12?PB:kB).members,!1,!0)),t.featureArray&&(t.pbrBuffer=e.createVertexBuffer(t.featureArray,DB.members,!0)),t.segments=Gr.simpleSegment(0,0,t.vertexArray.length,t.indexArray.length);const i=t.material;i.pbrMetallicRoughness.baseColorTexture&&Zd(i.pbrMetallicRoughness.baseColorTexture,e),i.pbrMetallicRoughness.metallicRoughnessTexture&&Zd(i.pbrMetallicRoughness.metallicRoughnessTexture,e),i.normalTexture&&Zd(i.normalTexture,e),i.occlusionTexture&&Zd(i.occlusionTexture,e,r),i.emissionTexture&&Zd(i.emissionTexture,e)}function nx(t,e,r){if(t.meshes)for(const i of t.meshes)NB(i,e,r);if(t.children)for(const i of t.children)nx(i,e,r)}function dg(t){if(t.meshes)for(const e of t.meshes)e.indexArray.destroy(),e.vertexArray.destroy(),e.colorArray&&e.colorArray.destroy(),e.normalArray&&e.normalArray.destroy(),e.texcoordArray&&e.texcoordArray.destroy(),e.featureArray&&e.featureArray.destroy();if(t.children)for(const e of t.children)dg(e)}function fg(t){if(t.meshes)for(const r of t.meshes)r.vertexBuffer&&(r.vertexBuffer.destroy(),r.indexBuffer.destroy(),r.normalBuffer&&r.normalBuffer.destroy(),r.texcoordBuffer&&r.texcoordBuffer.destroy(),r.colorBuffer&&r.colorBuffer.destroy(),r.pbrBuffer&&r.pbrBuffer.destroy(),r.segments.destroy(),r.material&&((e=r.material).pbrMetallicRoughness.baseColorTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture&&e.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),e.pbrMetallicRoughness.metallicRoughnessTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&e.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),e.normalTexture&&e.normalTexture.gfxTexture&&e.normalTexture.gfxTexture.destroy(),e.emissionTexture&&e.emissionTexture.gfxTexture&&e.emissionTexture.gfxTexture.destroy(),e.occlusionTexture&&e.occlusionTexture.gfxTexture&&e.occlusionTexture.gfxTexture.destroy()));var e;if(t.children)for(const r of t.children)fg(r)}class pC{constructor(e,r){this.feature=e,this.instancedDataOffset=r,this.instancedDataCount=0}}class mC{constructor(){this.instancedDataArray=new j1,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class gC{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.projection=e.projection,this.index=e.index,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0}populate(e,r,i,a){this.tileToMeter=kd(i);const s=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:c,id:u,index:d,sourceLayerIndex:p}of e){const m=Ks(c,s);if(!this.layers[0]._featureFilter.filter(new mn(this.zoom),m,i))continue;const _={id:u,sourceLayerIndex:p,index:d,geometry:s?m.geometry:Pa(c,i,a),properties:c.properties,type:c.type,patterns:{}},y=this.addFeature(_,_.geometry,m);y&&r.featureIndex.insert(c,_.geometry,d,p,this.index,this.instancesPerModel[y].instancedDataArray.length)}this.lookup=null}update(e,r,i,a){for(const s in this.instancesPerModel){const c=this.instancesPerModel[s];for(const u in e)c.idToFeaturesIndex.hasOwnProperty(u)&&this.evaluate(c.features[c.idToFeaturesIndex[u]],e[u],c,!0)}this.maxHeight=0}isEmpty(){for(const e in this.instancesPerModel)if(this.instancesPerModel[e].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(e){const r=Number.MAX_SAFE_INTEGER;if(!this.uploaded)for(const i in this.instancesPerModel){const a=this.instancesPerModel[i];a.instancedDataArray.length<r||a.instancedDataArray.length===0||(a.instancedDataBuffer?a.instancedDataBuffer.updateData(a.instancedDataArray):a.instancedDataBuffer=e.createVertexBuffer(a.instancedDataArray,a.instancedDataArray.members,!0))}this.uploaded=!0}destroy(){for(const e in this.instancesPerModel){const r=this.instancesPerModel[e];r.instancedDataArray.length!==0&&r.instancedDataBuffer&&r.instancedDataBuffer.destroy()}}addFeature(e,r,i){const a=this.layers[0],s=a.layout.get("model-id").evaluate(i,{},this.canonical);if(!s)return re(`modelId is not evaluated for layer ${a.id} and it is not going to get rendered.`),s;this.instancesPerModel[s]||(this.instancesPerModel[s]=new mC);const c=this.instancesPerModel[s],u=c.instancedDataArray,d=new pC(i,u.length);for(const p of r)for(const m of p){if(m.x<0||m.x>=Ae||m.y<0||m.y>=Ae)continue;const _=(this.lookupDim-1)/Ae,y=this.lookupDim*(m.y*_|0)+m.x*_|0;if(this.lookup){if(this.lookup[y]!==0)continue;this.lookup[y]=1}this.instanceCount++;const v=u.length;u.resize(v+1),c.instancesEvaluatedElevation.push(0),u.float32[16*v]=m.x,u.float32[16*v+1]=m.y}return d.instancedDataCount=c.instancedDataArray.length-d.instancedDataOffset,d.instancedDataCount>0&&(e.id&&(c.idToFeaturesIndex[e.id]=c.features.length),c.features.push(d),this.evaluate(d,{},c,!1)),s}evaluate(e,r,i,a){const s=this.layers[0],c=e.feature,u=this.canonical,d=s.paint.get("model-rotation").evaluate(c,r,u),p=s.paint.get("model-scale").evaluate(c,r,u),m=s.paint.get("model-translation").evaluate(c,r,u),_=s.paint.get("model-color").evaluate(c,r,u);_.a=s.paint.get("model-color-mix-intensity").evaluate(c,r,u);const y=[];this.maxVerticalOffset<m[2]&&(this.maxVerticalOffset=m[2]),this.maxScale=Math.max(Math.max(this.maxScale,p[0]),Math.max(p[1],p[2])),hC(y,d,p);const v=Math.round(100*_.a)+_.b/1.05;for(let b=0;b<e.instancedDataCount;++b){const S=e.instancedDataOffset+b,T=16*S,M=i.instancedDataArray.float32;let C=0;a&&(C=M[T+6]-i.instancesEvaluatedElevation[S]);const P=0|M[T+1];M[T]=(0|M[T])+_.r/1.05,M[T+1]=P+_.g/1.05,M[T+2]=v,M[T+3]=1/(u.z>10?this.tileToMeter:kd(u,P)),M[T+4]=m[0],M[T+5]=m[1],M[T+6]=m[2]+C,M[T+7]=y[0],M[T+8]=y[1],M[T+9]=y[2],M[T+10]=y[4],M[T+11]=y[5],M[T+12]=y[6],M[T+13]=y[8],M[T+14]=y[9],M[T+15]=y[10],i.instancesEvaluatedElevation[S]=m[2]}}}ht(gC,"ModelBucket",{omit:["layers"]}),ht(mC,"PerModelAttributes"),ht(pC,"ModelFeature");const jB=new gn({visibility:new Ke(pe.layout_model.visibility),"model-id":new St(pe.layout_model["model-id"])});var $B={paint:new gn({"model-opacity":new Ke(pe.paint_model["model-opacity"]),"model-rotation":new St(pe.paint_model["model-rotation"]),"model-scale":new St(pe.paint_model["model-scale"]),"model-translation":new St(pe.paint_model["model-translation"]),"model-color":new St(pe.paint_model["model-color"]),"model-color-mix-intensity":new St(pe.paint_model["model-color-mix-intensity"]),"model-type":new Ke(pe.paint_model["model-type"]),"model-cast-shadows":new Ke(pe.paint_model["model-cast-shadows"]),"model-receive-shadows":new Ke(pe.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Ke(pe.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new St(pe.paint_model["model-emissive-strength"]),"model-roughness":new St(pe.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new St(pe.paint_model["model-height-based-emissive-strength-multiplier"])}),layout:jB};function _C(t){let e=0;if(t.meshes)for(const r of t.meshes)e=Math.max(e,r.aabb.max[2]);if(t.children)for(const r of t.children)e=Math.max(e,_C(r));return e}const yC=["","wall","door","roof","window","lamp","logo"];class vC{constructor(e){this.node=e,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.feature={type:"Point",id:e.id,geometry:[],properties:{height:_C(e)}}}}class xC{constructor(e,r,i,a){this.nodes=e,this.id=r,this.modelTraits|=1,this.uploaded=!1,this.hasPattern=!1,i&&(this.modelTraits|=4),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=a,this.dirty=!0,this.needsUpload=!1}update(){console.log("Update 3D model bucket")}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(e){if(!this.needsUpload)return;const r=this.getNodesInfo();for(const i of r){const a=i.node;this.uploaded?this.updatePbrBuffer(a):nx(a,e,!0)}for(const i of r)dg(i.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(e){let r=!1;if(!e.meshes)return r;for(const i of e.meshes)i.pbrBuffer&&(i.pbrBuffer.updateData(i.featureArray),r=!0);return r}needsReEvaluation(e,r,i){const a=e.transform.projectionOptions,s=e.style.calculateLightsBrightness(),c=this.brightness!==s;return!!(!this.uploaded||this.dirty||a.name!==this.projection.name||pg(i.paint.get("model-color-mix-intensity").value,c)||pg(i.paint.get("model-roughness").value,c)||pg(i.paint.get("model-emissive-strength").value,c)||pg(i.paint.get("model-height-based-emissive-strength-multiplier").value,c))&&(this.dirty=!1,this.projection=a,this.brightness=s,!0)}evaluateScale(e,r){if(e.transform.zoom===this.zoom)return;this.zoom=e.transform.zoom;const i=this.getNodesInfo(),a=this.id.canonical;for(const s of i){const c=s.feature;s.evaluatedScale=r.paint.get("model-scale").evaluate(c,{},a)}}evaluate(e){const r=this.getNodesInfo();for(const i of r){if(!i.node.meshes)continue;const a=i.feature,s=i.evaluatedColor[2],c=i.evaluatedRMEA[2],u=this.id.canonical;if(i.node.meshes&&i.node.meshes[0].featureData){for(let d=0;d<yC.length;d++){const p=yC[d];p.length&&(a.properties.part=p);const m=e.paint.get("model-color").evaluate(a,{},u),_=e.paint.get("model-color-mix-intensity").evaluate(a,{},u);i.evaluatedColor[d]=[m.r,m.g,m.b,_],i.evaluatedRMEA[d][0]=e.paint.get("model-roughness").evaluate(a,{},u),i.evaluatedRMEA[d][2]=e.paint.get("model-emissive-strength").evaluate(a,{},u),i.evaluatedRMEA[d][3]=m.a,i.emissionHeightBasedParams[d]=e.paint.get("model-height-based-emissive-strength-multiplier").evaluate(a,{},u)}delete a.properties.part,UB(i,s!==i.evaluatedColor[2]||c!==i.evaluatedRMEA[2])}i.evaluatedScale=e.paint.get("model-scale").evaluate(a,{},u),this.updatePbrBuffer(i.node)||(this.needsUpload=!0)}}elevationUpdate(e,r,i){const a=e.findDEMTileFor(i);if((a!==this.terrainTile||r!==this.terrainExaggeration)&&e&&a&&a.dem&&a.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=a.tileID.overscaledZ;const s=Au.create(e,this.id,a);if(!s)return;for(const c of this.getNodesInfo()){const u=c.node;if(!u.footprint||!u.footprint.vertices||!u.footprint.vertices.length)continue;const d=u.footprint.vertices;let p=s.getElevationAt(d[0].x,d[0].y,!0,!0);for(let m=1;m<d.length;m++)p=Math.min(p,s.getElevationAt(d[m].x,d[m].y,!0,!0));u.elevation=p}}}getNodesInfo(){if(!this.nodesInfo){this.nodesInfo=[];for(const e of this.nodes)this.nodesInfo.push(new vC(e));this.freeNodes()}return this.nodesInfo}freeNodes(){if(this.nodes){for(const e of this.nodes)fg(e);this.nodes.splice(0,this.nodes.length)}}destroy(){this.freeNodes();const e=this.getNodesInfo();for(const r of e)dg(r.node),fg(r.node)}isEmpty(){return!this.nodes.length}updateReplacement(e,r){if(r.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=r.updateTime;const i=r.getReplacementRegionsForTile(e.toUnwrapped()),a=this.getNodesInfo();for(let s=0;s<this.nodesInfo.length;s++){const c=a[s].node;a[s].hiddenByReplacement=!!c.footprint&&!i.find(u=>u.footprint===c.footprint)}}}function pg(t,e){return!t.isLightConstant&&e}function VB(t,e,r,i,a,s,c,u){let d=(61440&e|(61440&e)>>4)>>8,p=(3840&e|(3840&e)>>4)>>4,m=240&e|(240&e)>>4;r[3]>0&&(d=Ft(d,255*r[0],r[3]),p=Ft(p,255*r[1],r[3]),m=Ft(m,255*r[2],r[3]));const _=d<<8|p,y=m<<8|Math.floor(255*i[3]),v=function(L){const B=ze(L,0,2);return Math.min(Math.round(.5*B*255),255)}(i[2])<<8|15*i[0]<<4|15*i[1],b=ze(a[0],0,1),S=ze(a[1],0,1),T=ze(a[2],0,1),M=ze(a[3],0,1);let C,P,k,z;if(b!==S&&c!==s&&S!==b){const L=c-s;P=1/(L*(S-b)),k=-(s+L*b)/(L*(S-b));const B=ze(a[4],-1,1);z=Math.pow(10,B),C=255*T<<8|255*M}else C=65535,P=0,k=1,z=1;if(t.emplaceBack(_,y,v,C,P,k,z),u){const L=u.length;u.clear();for(let B=0;B<L;B++)u.emplaceBack(_,y,v,C,P,k,z)}}function UB(t,e){const r=t.node;let i=0;for(const a of r.meshes){if(r.lights&&r.lightMeshIndex===i||!a.featureData)continue;a.featureArray=new mm,a.featureArray.reserve(a.featureData.length);let s=e;for(const c of a.featureData){let u;const d=65535&c,p=(15&d)<8?15&d:0,m=c>>16&65535,_=t.evaluatedRMEA[p],y=t.evaluatedColor[p],v=t.emissionHeightBasedParams[p];if(s&&p===2&&r.lights&&(u=new mm,u.resize(10*r.lights.length)),VB(a.featureArray,m,y,_,v,a.aabb.min[2],a.aabb.max[2],u),u&&s){s=!1;const b=r.meshes[r.lightMeshIndex];b.featureArray=u,b.featureArray._trim()}}a.featureArray._trim(),i++}}ht(xC,"Tiled3dModelBucket",{omit:["layers"]}),ht(vC,"Tiled3dModelFeature");class GB{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[]}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(e){const r=EC(new $(0,0),new $(Ae,Ae),e),i=[];for(const a of this._activeRegions){if(a.hiddenByOverlap||!wC(r,a))continue;const s=WB(a.min,a.max,e);i.push({min:s.min,max:s.max,sourceId:this._sourceIds[a.priority],footprint:a.footprint,footprintTileId:a.tileId})}return i}setSources(e){this._setSources(e.map(r=>({getSourceId:()=>r.cache.id,getFootprints:()=>{const i=[];for(const a of r.cache.getVisibleCoordinates()){const s=r.cache.getTile(a).buckets[r.layer];if(s)for(const c of s.getNodesInfo()){const u=c.node;u.footprint&&i.push({footprint:u.footprint,id:a.toUnwrapped()})}}return i}})))}_addSource(e){const r=e.getFootprints();if(r.length!==0){for(const i of r){if(!i.footprint)continue;const a=EC(i.footprint.min,i.footprint.max,i.id);this._activeRegions.push({min:a.min,max:a.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:i.id,footprint:i.footprint})}this._sourceIds.push(e.getSourceId())}}_computeReplacement(){this._activeRegions.sort((r,i)=>r.priority-i.priority||mg(r.min,i.min)||mg(r.max,i.max));let e=this._activeRegions.length!==this._prevRegions.length;if(!e){let r=0,i=0;for(;!e&&r!==this._activeRegions.length;){const a=this._activeRegions[r],s=this._prevRegions[i];e=a.priority!==s.priority||!bC(a,s),++r,++i}}if(e){++this._updateTime;const r=i=>{const a=this._activeRegions;if(i>=a.length)return i;const s=a[i].priority;for(;i<a.length&&a[i].priority===s;)++i;return i};if(this._sourceIds.length>1){let i=0,a=r(i);for(;i!==a;){let s=i;const c=i;for(;s!==a;){const u=this._activeRegions[s];u.hiddenByOverlap=!1;for(let d=0;d<c;d++){const p=this._activeRegions[d];if(!p.hiddenByOverlap&&wC(u,p)&&(u.hiddenByOverlap=TC(u.footprint,u.tileId,p.footprint,p.tileId),u.hiddenByOverlap))break}++s}i=a,a=r(i)}}}}_setSources(e){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let r=e.length-1;r>=0;r--)this._addSource(e[r]);this._computeReplacement()}}function mg(t,e){return t.x-e.x||t.y-e.y}function bC(t,e){return mg(t.min,e.min)===0&&mg(t.max,e.max)===0}function wC(t,e){return!(t.min.x>e.max.x||t.max.x<e.min.x||t.min.y>e.max.y||t.max.y<e.min.y)}function EC(t,e,r){const i=1/Ae,a=1/(1<<r.canonical.z),s=(e.x*i+r.canonical.x)*a+r.wrap,c=(e.y*i+r.canonical.y)*a;return{min:new $((t.x*i+r.canonical.x)*a+r.wrap,(t.y*i+r.canonical.y)*a),max:new $(s,c)}}function WB(t,e,r){const i=1<<r.canonical.z,a=((e.x-r.wrap)*i-r.canonical.x)*Ae,s=(e.y*i-r.canonical.y)*Ae;return{min:new $(((t.x-r.wrap)*i-r.canonical.x)*Ae,(t.y*i-r.canonical.y)*Ae),max:new $(a,s)}}function SC(t,e,r,i,a,s,c){const u=t.indices,d=t.vertices,p=[];for(let m=i;m<i+a;m+=3){const _=e[r[m+0]+s],y=e[r[m+1]+s],v=e[r[m+2]+s],b=Math.min(_.x,y.x,v.x),S=Math.max(_.x,y.x,v.x),T=Math.min(_.y,y.y,v.y),M=Math.max(_.y,y.y,v.y);p.length=0,t.grid.query(new $(b,T),new $(S,M),p);for(let C=0;C<p.length;C++){const P=p[C];if(Tv(d[u[3*P+0]],d[u[3*P+1]],d[u[3*P+2]],_,y,v,c))return!0}}return!1}function TC(t,e,r,i){if(!t||!r)return!1;let a=t.vertices;if(!e.canonical.equals(i.canonical)||e.wrap!==i.wrap){if(r.vertices.length<t.vertices.length)return TC(r,i,t,e);const s=e.canonical,c=i.canonical,u=Math.pow(2,c.z-s.z);a=t.vertices.map(d=>new $(d.x*s.x*Ae*u-c.x*Ae,d.y*s.y*Ae*u-c.y*Ae))}return SC(r,a,t.indices,0,t.indices.length,0,0)}const HB=Nm.types,qB=Math.pow(2,13),MC=new $(0,1),sl=2147483648;function Xd(t,e,r,i,a,s,c,u){t.emplaceBack((e<<1)+c,(r<<1)+s,(Math.floor(i*qB)<<1)+a,Math.round(u))}function gg(t,e,r,i,a){t.emplaceBack(e.x,e.y,(r.x<<1)+i,(r.y<<1)+a)}function Yd(t,e,r){t.emplaceBack(e.x,e.y,e.z,r[0]*16384,r[1]*16384,r[2]*16384)}class CC{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class AC{constructor(){this.centroidXY=new $(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.min=new $(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new $(-Number.MAX_VALUE,-Number.MAX_VALUE)}span(){return new $(this.max.x-this.min.x,this.max.y-this.min.y)}}class IC{constructor(){this.acc=new $(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(e,r){e.min.x===Number.MAX_VALUE&&(e.min.x=e.max.x=r.x,e.min.y=e.max.y=r.y)}appendEdge(e,r,i){this.accCount++,this.acc._add(r);let a=!!this.borders;r.x<e.min.x?(e.min.x=r.x,a=!0):r.x>e.max.x&&(e.max.x=r.x,a=!0),r.y<e.min.y?(e.min.y=r.y,a=!0):r.y>e.max.y&&(e.max.y=r.y,a=!0),((r.x===0||r.x===Ae)&&r.x===i.x)!=((r.y===0||r.y===Ae)&&r.y===i.y)&&this.processBorderOverlap(r,i),a&&this.checkBorderIntersection(r,i)}checkBorderIntersection(e,r){r.x<0!=e.x<0&&this.addBorderIntersection(0,Ft(r.y,e.y,(0-r.x)/(e.x-r.x))),r.x>Ae!=e.x>Ae&&this.addBorderIntersection(1,Ft(r.y,e.y,(Ae-r.x)/(e.x-r.x))),r.y<0!=e.y<0&&this.addBorderIntersection(2,Ft(r.x,e.x,(0-r.y)/(e.y-r.y))),r.y>Ae!=e.y>Ae&&this.addBorderIntersection(3,Ft(r.x,e.x,(Ae-r.y)/(e.y-r.y)))}addBorderIntersection(e,r){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const i=this.borders[e];r<i[0]&&(i[0]=r),r>i[1]&&(i[1]=r)}processBorderOverlap(e,r){if(e.x===r.x){if(e.y===r.y)return;const i=e.x===0?0:1;this.addBorderIntersection(i,r.y),this.addBorderIntersection(i,e.y)}else{const i=e.y===0?2:3;this.addBorderIntersection(i,r.x),this.addBorderIntersection(i,e.x)}}centroid(){return this.accCount===0?new $(0,0):new $(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((e,r)=>e+ +(r[0]!==Number.MAX_VALUE),0):0}}class PC{constructor(e){this.vertexArray=new Bs,this.indexArray=new Bn,this.programConfigurations=new Ws(e.layers,e.zoom),this.segments=new Gr,this.hiddenByLandmarkVertexArray=new $1}hasData(){return this.vertexArray.length!==0}addData(e,r){const i=e.length;if(i>2){const a=this.segments.prepareSegment(4*i,this.vertexArray,this.indexArray);for(let s=0;s<i;s++){const c=e[s],u=e[s===i-1?0:s+1];if(ix(c,u,r)||zC(c,r)&&zC(u,r))continue;const d=a.vertexLength;gg(this.vertexArray,c,u,1,1),gg(this.vertexArray,c,u,1,0),gg(this.vertexArray,c,u,0,1),gg(this.vertexArray,c,u,0,0),a.vertexLength+=4,this.indexArray.emplaceBack(d,d+1,d+3),this.indexArray.emplaceBack(d,d+3,d+2),a.primitiveLength+=2}}}addPaintPropertiesData(e,r,i,a,s,c){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,e,r,i,a,s,c)}upload(e){this.hasData()&&(this.vertexBuffer=e.createVertexBuffer(this.vertexArray,MF.members),this.indexBuffer=e.createIndexBuffer(this.indexArray))}uploadPaintProperties(e){this.hasData()&&this.programConfigurations.upload(e)}update(e,r,i,a,s,c){this.hasData()&&this.programConfigurations.updatePaintArrays(e,r,i,a,s,c)}updateHiddenByLandmark(e){if(!this.hasData())return;const r=e.groundVertexCount+e.groundVertexArrayOffset;if(e.groundVertexCount===0)return;const i=e.flags&sl?1:0;for(let a=e.groundVertexArrayOffset;a<r;++a)this.hiddenByLandmarkVertexArray.emplace(a,i);this.needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(e){this.hasData()&&this.needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=e.createVertexBuffer(this.hiddenByLandmarkVertexArray,AF.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this.needsHiddenByLandmarkUpdate=!1)}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this.segments.destroy(),this.programConfigurations.destroy())}}class Kd{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(r=>r.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new Bn,this.footprintVertices=new Gi,this.footprintSegments=[],this.layoutVertexArray=new Bs,this.centroidVertexArray=new GS,this.indexArray=new Bn,this.programConfigurations=new Ws(e.layers,e.zoom),this.segments=new Gr,this.stateDependentLayerIds=this.layers.filter(r=>r.isStateDependent()).map(r=>r.id),this.groundEffect=new PC(e)}populate(e,r,i,a){this.features=[],this.hasPattern=Rv("fill-extrusion",this.layers,r),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=kd(i),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:s,id:c,index:u,sourceLayerIndex:d}of e){const p=this.layers[0]._featureFilter.needGeometry,m=Ks(s,p);if(!this.layers[0]._featureFilter.filter(new mn(this.zoom),m,i))continue;const _={id:c,sourceLayerIndex:d,index:u,geometry:p?m.geometry:Pa(s,i,a),properties:s.properties,type:s.type,patterns:{}},y=this.layoutVertexArray.length;this.hasPattern?this.features.push(zv("fill-extrusion",this.layers,_,this.zoom,r)):this.addFeature(_,_.geometry,u,i,{},r.availableImages,a,r.brightness),r.featureIndex.insert(s,_.geometry,u,d,this.index,y)}this.sortBorders()}addFeatures(e,r,i,a,s,c){for(const u of this.features){const{geometry:d}=u;this.addFeature(u,d,u.index,r,i,a,s,c)}this.sortBorders()}update(e,r,i,a,s){const c=Object.keys(e).length!==0;if(c&&!this.stateDependentLayers.length)return;const u=c?this.stateDependentLayers:this.layers;this.programConfigurations.updatePaintArrays(e,r,u,i,a,s),this.groundEffect.update(e,r,u,i,a,s)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,PF),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,IF.members,!0)),this.groundEffect.upload(e)),this.groundEffect.uploadPaintProperties(e),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){this.groundEffect.uploadHiddenByLandmark(e),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,CF.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,r,i,a,s,c,u,d){const p=[new $(0,0),new $(Ae,Ae)],m=u.projection,_=m.name==="globe",y=HB[e.type]==="Polygon",v=new IC;v.centroidDataIndex=this.centroidData.length;const b=new AC;b.vertexArrayOffset=this.layoutVertexArray.length,b.groundVertexArrayOffset=this.groundEffect.vertexArray.length,_&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new dm);const S=kv(r,500);for(let P=S.length-1;P>=0;P--){const k=S[P];(k.length===0||(T=k[0]).every(z=>z.x<=0)||T.every(z=>z.x>=Ae)||T.every(z=>z.y<=0)||T.every(z=>z.y>=Ae))&&S.splice(P,1)}var T;let M;if(_)M=FC(S,p,a);else{M=[];for(const P of S)M.push({polygon:P,bounds:p})}const C=y?this.edgeRadius:0;for(const{polygon:P,bounds:k}of M){let z=0,L=0;for(const Z of P)y&&!Z[0].equals(Z[Z.length-1])&&Z.push(Z[0]),L+=y?Z.length-1:Z.length;const B=this.segments.prepareSegment((y?5:4)*L,this.layoutVertexArray,this.indexArray);b.footprintSegIdx<0&&(b.footprintSegIdx=this.footprintSegments.length);const W=new CC;if(W.vertexOffset=this.footprintVertices.length,W.indexOffset=3*this.footprintIndices.length,y){const Z=[],X=[];z=B.vertexLength;for(let J=0;J<P.length;J++){const Q=P[J];Q.length&&J!==0&&X.push(Z.length/2);const K=[];let fe,he;fe=Q[1].sub(Q[0])._perp()._unit();for(let _e=1;_e<Q.length;_e++){const oe=Q[_e],me=Q[_e===Q.length-1?1:_e+1];let{x:ve,y:Ce}=oe;if(C===0&&K.push(oe),C){he=me.sub(oe)._perp()._unit();const Se=fe.add(he)._unit(),Je=C*Math.min(4,1/(fe.x*Se.x+fe.y*Se.y));ve+=Je*Se.x,Ce+=Je*Se.y,fe=he}Xd(this.layoutVertexArray,ve,Ce,0,0,1,1,0),B.vertexLength++,this.footprintVertices.emplaceBack(oe.x,oe.y),Z.push(oe.x,oe.y),_&&Yd(this.layoutVertexExtArray,m.projectTilePoint(ve,Ce,a),m.upVector(a,ve,Ce))}C===0&&this.groundEffect.addData(K,k)}const H=Om(Z,X);for(let J=0;J<H.length;J+=3)this.footprintIndices.emplaceBack(W.vertexOffset+H[J+0],W.vertexOffset+H[J+1],W.vertexOffset+H[J+2]),this.indexArray.emplaceBack(z+H[J],z+H[J+2],z+H[J+1]),B.primitiveLength++;W.indexCount+=H.length,W.vertexCount+=this.footprintVertices.length-W.vertexOffset}for(let Z=0;Z<P.length;Z++){const X=P[Z];v.startRing(b,X[0]);let H=X.length>4&&DC(X[X.length-2],X[0],X[1]),J=C?ZB(X[X.length-2],X[0],X[1],C):0;const Q=[];let K,fe,he;fe=X[1].sub(X[0])._perp()._unit();let _e=!0;for(let oe=1,me=0;oe<X.length;oe++){let ve=X[oe-1],Ce=X[oe];const Se=X[oe===X.length-1?1:oe+1];if(v.appendEdge(b,Ce,ve),ix(Ce,ve,k)){C&&(fe=Se.sub(Ce)._perp()._unit(),_e=!_e);continue}const Je=Ce.sub(ve)._perp(),Ge=Je.x/(Math.abs(Je.x)+Math.abs(Je.y)),je=Je.y>0?1:0,Ve=ve.dist(Ce);if(me+Ve>32768&&(me=0),C){he=Se.sub(Ce)._perp()._unit();let dt=RC(ve,Ce,Se,kC(fe,he),C);isNaN(dt)&&(dt=0);const Et=Ce.sub(ve)._unit();ve=ve.add(Et.mult(J))._round(),Ce=Ce.add(Et.mult(-dt))._round(),J=dt,fe=he,Q.push(ve),Q.push(Ce)}const nt=B.vertexLength,wt=X.length>4&&DC(ve,Ce,Se);let pt=LC(me,H,_e);if(Xd(this.layoutVertexArray,ve.x,ve.y,Ge,je,0,0,pt),Xd(this.layoutVertexArray,ve.x,ve.y,Ge,je,0,1,pt),me+=Ve,pt=LC(me,wt,!_e),H=wt,Xd(this.layoutVertexArray,Ce.x,Ce.y,Ge,je,0,0,pt),Xd(this.layoutVertexArray,Ce.x,Ce.y,Ge,je,0,1,pt),B.vertexLength+=4,this.indexArray.emplaceBack(nt+0,nt+1,nt+2),this.indexArray.emplaceBack(nt+1,nt+3,nt+2),B.primitiveLength+=2,C){const dt=z+(oe===1?X.length-2:oe-2),Et=oe===1?z:dt+1;if(this.indexArray.emplaceBack(nt+1,dt,nt+3),this.indexArray.emplaceBack(dt,Et,nt+3),B.primitiveLength+=2,K===void 0&&(K=nt),!ix(Se,X[oe],k)){const nr=oe===X.length-1?K:B.vertexLength;this.indexArray.emplaceBack(nt+2,nt+3,nr),this.indexArray.emplaceBack(nt+3,nr+1,nr),this.indexArray.emplaceBack(nt+3,Et,nr+1),B.primitiveLength+=3}_e=!_e}if(_){const dt=this.layoutVertexExtArray,Et=m.projectTilePoint(ve.x,ve.y,a),nr=m.projectTilePoint(Ce.x,Ce.y,a),er=m.upVector(a,ve.x,ve.y),Rr=m.upVector(a,Ce.x,Ce.y);Yd(dt,Et,er),Yd(dt,Et,er),Yd(dt,nr,Rr),Yd(dt,nr,Rr)}}y&&(z+=X.length-1),C&&this.groundEffect.addData(Q,k)}this.footprintSegments.push(W),++b.footprintSegLen}if(b.vertexCount=this.layoutVertexArray.length-b.vertexArrayOffset,b.groundVertexCount=this.groundEffect.vertexArray.length-b.groundVertexArrayOffset,b.vertexCount!==0){if(b.centroidXY=v.borders?MC:this.encodeCentroid(v,b),this.centroidData.push(b),v.borders){this.featuresOnBorder.push(v);const P=this.featuresOnBorder.length-1;for(let k=0;k<v.borders.length;k++)v.borders[k][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[k].push(P)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,i,s,c,a,d),this.groundEffect.addPaintPropertiesData(e,i,s,c,a,d)}}sortBorders(){for(let e=0;e<this.borderFeatureIndices.length;e++)this.borderFeatureIndices[e].sort((r,i)=>this.featuresOnBorder[r].borders[e][0]-this.featuresOnBorder[i].borders[e][0])}encodeCentroid(e,r){const i=e.centroid(),a=r.span(),s=Math.min(7,Math.round(a.x*this.tileToMeter/10)),c=Math.min(7,Math.round(a.y*this.tileToMeter/10));return new $(ze(i.x,1,Ae-1)<<3|s,ze(i.y,1,Ae-1)<<3|c)}showCentroid(e){const r=this.centroidData[e.centroidDataIndex];r.flags&=sl,r.centroidXY.x=0,r.centroidXY.y=0,this.writeCentroidToBuffer(r)}writeCentroidToBuffer(e){this.groundEffect.updateHiddenByLandmark(e);const r=e.vertexArrayOffset,i=e.vertexCount+e.vertexArrayOffset,a=e.flags&sl?MC:e.centroidXY,s=this.centroidVertexArray.geta_centroid_pos0(r);if(this.centroidVertexArray.geta_centroid_pos1(r)!==a.y||s!==a.x){for(let c=r;c<i;++c)this.centroidVertexArray.emplace(c,a.x,a.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const e of this.centroidData)this.writeCentroidToBuffer(e)}updateReplacement(e,r){if(r.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=r.updateTime;const i=r.getReplacementRegionsForTile(e.toUnwrapped());if(function(s,c){if(s.length!==c.length)return!1;for(let u=0;u<s.length;u++)if(s[u].sourceId!==c[u].sourceId||!bC(s[u],c[u]))return!1;return!0}(this.activeReplacements,i))return;if(this.activeReplacements=i,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const s of this.centroidData)s.flags&=2147483647;const a=[];for(const s of this.activeReplacements){const c=Math.pow(2,s.footprintTileId.canonical.z-e.canonical.z);for(const u of this.centroidData)if(!(u.flags&sl||s.min.x>u.max.x||u.min.x>s.max.x||s.min.y>u.max.y||u.min.y>s.max.y))for(let d=0;d<u.footprintSegLen;d++){const p=this.footprintSegments[u.footprintSegIdx+d];if(a.length=0,XB(this.footprintVertices,p.vertexOffset,p.vertexCount,s.footprintTileId.canonical,e.canonical,a),SC(s.footprint,a,this.footprintIndices.uint16,p.indexOffset,p.indexCount,-p.vertexOffset,-c)){u.flags|=sl;break}}}for(const s of this.centroidData)this.writeCentroidToBuffer(s);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}}function kC(t,e){const r=t.add(e)._unit();return t.x*r.x+t.y*r.y}function ZB(t,e,r,i){const a=e.sub(t)._perp()._unit(),s=r.sub(e)._perp()._unit();return RC(t,e,r,kC(a,s),i)}function RC(t,e,r,i,a){const s=Math.sqrt(1-i*i);return Math.min(t.dist(e)/3,e.dist(r)/3,a*s/i)}function ix(t,e,r){return t.x<r[0].x&&e.x<r[0].x||t.x>r[1].x&&e.x>r[1].x||t.y<r[0].y&&e.y<r[0].y||t.y>r[1].y&&e.y>r[1].y}function zC(t,e){return t.x<e[0].x||t.x>e[1].x||t.y<e[0].y||t.y>e[1].y}function DC(t,e,r){if(t.x<0||t.x>=Ae||e.x<0||e.x>=Ae||r.x<0||r.x>=Ae)return!1;const i=r.sub(e),a=i.perp(),s=t.sub(e);return(i.x*s.x+i.y*s.y)/Math.sqrt((i.x*i.x+i.y*i.y)*(s.x*s.x+s.y*s.y))>-.866&&a.x*s.x+a.y*s.y<0}function LC(t,e,r){const i=e?2|t:-3&t;return r?1|i:-2&i}function OC(){const t=Math.PI/32,e=Math.tan(t),r=xu;return r*Math.sqrt(1+2*e*e)-r}function FC(t,e,r){const i=1<<r.z,a=Hi(r.x/i),s=Hi((r.x+1)/i),c=zn(r.y/i),u=zn((r.y+1)/i);return function(d,p,m,_,y=0,v){const b=[];if(!d.length||!m||!_)return b;const S=(L,B)=>{for(const W of L)b.push({polygon:W,bounds:B})},T=Math.ceil(Math.log2(m)),M=Math.ceil(Math.log2(_)),C=T-M,P=[];for(let L=0;L<Math.abs(C);L++)P.push(C>0?0:1);for(let L=0;L<Math.min(T,M);L++)P.push(0),P.push(1);let k=d;if(k=jm(k,p[0].y-y,p[1].y+y,1),k=jm(k,p[0].x-y,p[1].x+y,0),!k.length)return b;const z=[];for(P.length?z.push({polygons:k,bounds:p,depth:0}):S(k,p);z.length;){const L=z.pop(),B=L.depth,W=P[B],Z=L.bounds[0],X=L.bounds[1],H=W===0?Z.x:Z.y,J=W===0?X.x:X.y,Q=v?v(W,H,J):.5*(H+J),K=jm(L.polygons,H-y,Q+y,W),fe=jm(L.polygons,Q-y,J+y,W);if(K.length){const he=[Z,new $(W===0?Q:X.x,W===1?Q:X.y)];P.length>B+1?z.push({polygons:K,bounds:he,depth:B+1}):S(K,he)}if(fe.length){const he=[new $(W===0?Q:Z.x,W===1?Q:Z.y),X];P.length>B+1?z.push({polygons:fe,bounds:he,depth:B+1}):S(fe,he)}}return b}(t,e,Math.ceil((s-a)/11.25),Math.ceil((c-u)/11.25),1,(d,p,m)=>{if(d===0)return .5*(p+m);{const _=zn((r.y+p/Ae)/i);return(ai(.5*(zn((r.y+m/Ae)/i)+_))*i-r.y)*Ae}})}function XB(t,e,r,i,a,s){const c=Math.pow(2,i.z-a.z);for(let u=0;u<r;u++){let d=t.int16[2*(u+e)+0],p=t.int16[2*(u+e)+1];d=(d+a.x*Ae)*c-i.x*Ae,p=(p+a.y*Ae)*c-i.y*Ae,s.push(new $(d,p))}}ht(Kd,"FillExtrusionBucket",{omit:["layers","features"]}),ht(AC,"PartData"),ht(CC,"FootprintSegment"),ht(IC,"BorderCentroidData"),ht(PC,"GroundEffect");const YB=new gn({visibility:new Ke(pe["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Ke(pe["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var KB={paint:new gn({"fill-extrusion-opacity":new Ke(pe["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new St(pe["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Ke(pe["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Ke(pe["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new St(pe["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new St(pe["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new St(pe["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Ke(pe["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Ke(pe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Ke(pe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Ke(pe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Ke(pe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Ke(pe["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Ke(pe["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Ke(pe["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new St(pe["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new St(pe["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Ke(pe["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Ke(pe["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Ke(pe["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:YB};class Bu extends ${constructor(e,r,i){super(e,r),this.z=i}}function Jd(t,e){return t.x*e.x+t.y*e.y}function BC(t,e){if(t.length===1){let r=0;const i=e[r++];let a;for(;!a||i.equals(a);)if(a=e[r++],!a)return 1/0;for(;r<e.length;r++){const s=e[r],c=t[0],u=a.sub(i),d=s.sub(i),p=c.sub(i),m=Jd(u,u),_=Jd(u,d),y=Jd(d,d),v=Jd(p,u),b=Jd(p,d),S=m*y-_*_,T=(y*v-_*b)/S,M=(m*b-_*v)/S,C=i.z*(1-T-M)+a.z*T+s.z*M;if(isFinite(C))return C}return 1/0}{let r=1/0;for(const i of e)r=Math.min(r,i.z);return r}}function NC(t,e,r,i,a,s,c,u){const d=c*a.getElevationAt(t,e,!0,!0),p=s[0]!==0,m=p?s[1]===0?c*(s[0]/7-450):c*function(_,y,v){const b=Math.floor(y[0]/8),S=Math.floor(y[1]/8),T=10*(y[0]-8*b),M=10*(y[1]-8*S),C=_.getElevationAt(b,S,!0,!0),P=_.getMeterToDEM(v),k=Math.floor(.5*(T*P-1)),z=Math.floor(.5*(M*P-1)),L=_.tileCoordToPixel(b,S),B=2*k+1,W=2*z+1,Z=function(fe,he,_e,oe,me){return[fe.getElevationAtPixel(he,_e,!0),fe.getElevationAtPixel(he+me,_e,!0),fe.getElevationAtPixel(he,_e+me,!0),fe.getElevationAtPixel(he+oe,_e+me,!0)]}(_,L.x-k,L.y-z,B,W),X=Math.abs(Z[0]-Z[1]),H=Math.abs(Z[2]-Z[3]),J=Math.abs(Z[0]-Z[2])+Math.abs(Z[1]-Z[3]),Q=Math.min(.25,.5*P*(X+H)/B),K=Math.min(.25,.5*P*J/W);return C+Math.max(Q*T,K*M)}(a,s,u):d;return{base:d+(r===0)?-1:r,top:p?Math.max(m+i,d+r+2):d+i}}const JB=new gn({"line-cap":new St(pe.layout_line["line-cap"]),"line-join":new St(pe.layout_line["line-join"]),"line-miter-limit":new Ke(pe.layout_line["line-miter-limit"]),"line-round-limit":new Ke(pe.layout_line["line-round-limit"]),"line-sort-key":new St(pe.layout_line["line-sort-key"]),visibility:new Ke(pe.layout_line.visibility)});var jC={paint:new gn({"line-opacity":new St(pe.paint_line["line-opacity"]),"line-color":new St(pe.paint_line["line-color"]),"line-translate":new Ke(pe.paint_line["line-translate"]),"line-translate-anchor":new Ke(pe.paint_line["line-translate-anchor"]),"line-width":new St(pe.paint_line["line-width"]),"line-gap-width":new St(pe.paint_line["line-gap-width"]),"line-offset":new St(pe.paint_line["line-offset"]),"line-blur":new St(pe.paint_line["line-blur"]),"line-dasharray":new St(pe.paint_line["line-dasharray"]),"line-pattern":new St(pe.paint_line["line-pattern"]),"line-gradient":new Ed(pe.paint_line["line-gradient"]),"line-trim-offset":new Ke(pe.paint_line["line-trim-offset"]),"line-emissive-strength":new Ke(pe.paint_line["line-emissive-strength"]),"line-border-width":new St(pe.paint_line["line-border-width"]),"line-border-color":new St(pe.paint_line["line-border-color"])}),layout:JB};const $C=new class extends St{possiblyEvaluate(t,e){return e=new mn(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,r,i){return e=Oe({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,r,i)}}(jC.paint.properties["line-width"].specification);function VC(t,e){return e>0?e+2*t:t}$C.useIntegerZoom=!0;const QB=new gn({visibility:new Ke(pe.layout_background.visibility)});var e9={paint:new gn({"background-color":new Ke(pe.paint_background["background-color"]),"background-pattern":new Ke(pe.paint_background["background-pattern"]),"background-opacity":new Ke(pe.paint_background["background-opacity"]),"background-emissive-strength":new Ke(pe.paint_background["background-emissive-strength"])}),layout:QB};const t9=new gn({visibility:new Ke(pe.layout_raster.visibility)});var r9={paint:new gn({"raster-opacity":new Ke(pe.paint_raster["raster-opacity"]),"raster-color":new Ed(pe.paint_raster["raster-color"]),"raster-color-mix":new Ke(pe.paint_raster["raster-color-mix"]),"raster-color-range":new Ke(pe.paint_raster["raster-color-range"]),"raster-hue-rotate":new Ke(pe.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Ke(pe.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Ke(pe.paint_raster["raster-brightness-max"]),"raster-saturation":new Ke(pe.paint_raster["raster-saturation"]),"raster-contrast":new Ke(pe.paint_raster["raster-contrast"]),"raster-resampling":new Ke(pe.paint_raster["raster-resampling"]),"raster-fade-duration":new Ke(pe.paint_raster["raster-fade-duration"])}),layout:t9};class n9 extends so{constructor(e){super(e,{}),this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}const i9=new gn({visibility:new Ke(pe.layout_sky.visibility)});var o9={paint:new gn({"sky-type":new Ke(pe.paint_sky["sky-type"]),"sky-atmosphere-sun":new Ke(pe.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Ke(pe.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Ke(pe.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Ke(pe.paint_sky["sky-gradient-radius"]),"sky-gradient":new Ed(pe.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Ke(pe.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Ke(pe.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Ke(pe.paint_sky["sky-opacity"])}),layout:i9};function ox(t,e,r){const i=[0,0,1],a=oi.identity([]);return oi.rotateY(a,a,r?-se(t)+Math.PI:se(t)),oi.rotateX(a,a,-se(e)),ie.transformQuat(i,i,a),ie.normalize(i,i)}var a9={paint:new gn({})};const s9={circle:class extends so{constructor(t,e){super(t,nF,e)}createBucket(t){return new wv(t)}queryRadius(t){const e=t;return wu("circle-radius",this,e)+wu("circle-stroke-width",this,e)+Pm(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,r,i,a,s,c,u){const d=OT(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),s.angle,t.pixelToTileUnitsFactor),p=this.paint.get("circle-radius").evaluate(e,r)+this.paint.get("circle-stroke-width").evaluate(e,r);return FT(t,i,s,c,u,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",d,p)}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new Gs(this,t)}},heatmap:class extends so{createBucket(t){return new NT(t)}constructor(t,e){super(t,lF,e),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=km({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return wu("heatmap-radius",this,t)}queryIntersectsFeature(t,e,r,i,a,s,c,u){const d=this.paint.get("heatmap-radius").evaluate(e,r);return FT(t,i,s,c,u,!0,!0,new $(0,0),d)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new Gs(this,t)}},hillshade:class extends so{constructor(t,e){super(t,uF,e)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends so{constructor(t,e){super(t,SF,e)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),r=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&r.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),r}getProgramConfiguration(t){return new Gs(this,t)}recalculate(t,e){super.recalculate(t,e);const r=this.paint._values["fill-outline-color"];r.value.kind==="constant"&&r.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Fm(t)}queryRadius(){return Pm(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,r,i,a,s){return!t.queryGeometry.isAboveHorizon&&kT(LT(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),s.angle,t.pixelToTileUnitsFactor),i)}isTileClipped(){return!0}},"fill-extrusion":class extends so{constructor(t,e){super(t,KB,e)}createBucket(t){return new Kd(t)}queryRadius(){return Pm(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}hasShadowPass(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new Gs(this,t)}queryIntersectsFeature(t,e,r,i,a,s,c,u,d){const p=OT(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),s.angle,t.pixelToTileUnitsFactor),m=this.paint.get("fill-extrusion-height").evaluate(e,r),_=this.paint.get("fill-extrusion-base").evaluate(e,r),y=[0,0],v=u&&s.elevation,b=s.elevation?s.elevation.exaggeration():1,S=t.tile.getBucket(this);if(v&&S instanceof Kd){const k=S.centroidVertexArray,z=d+1;z<k.length&&(y[0]=k.geta_centroid_pos0(z),y[1]=k.geta_centroid_pos1(z))}if(y[0]===0&&y[1]===1)return!1;s.projection.name==="globe"&&(i=FC([i],[new $(0,0),new $(Ae,Ae)],t.tileID.canonical).map(k=>k.polygon).flat());const T=v?u:null,[M,C]=function(k,z,L,B,W,Z,X,H,J,Q,K){return k.projection.name==="globe"?function(fe,he,_e,oe,me,ve,Ce,Se,Je,Ge,je){const Ve=[],nt=[],wt=fe.projection.upVectorScale(je,fe.center.lat,fe.worldSize).metersToTile,pt=[0,0,0,1],dt=[0,0,0,1],Et=(er,Rr,tr,ir)=>{er[0]=Rr,er[1]=tr,er[2]=ir,er[3]=1},nr=OC();_e>0&&(_e+=nr),oe+=nr;for(const er of he){const Rr=[],tr=[];for(const ir of er){const Dt=ir.x+me.x,Yt=ir.y+me.y,zr=fe.projection.projectTilePoint(Dt,Yt,je),Kt=fe.projection.upVector(je,ir.x,ir.y);let Or=_e,Tn=oe;if(Ce){const Mn=NC(Dt,Yt,_e,oe,Ce,Se,Je,Ge);Or+=Mn.base,Tn+=Mn.top}_e!==0?Et(pt,zr.x+Kt[0]*wt*Or,zr.y+Kt[1]*wt*Or,zr.z+Kt[2]*wt*Or):Et(pt,zr.x,zr.y,zr.z),Et(dt,zr.x+Kt[0]*wt*Tn,zr.y+Kt[1]*wt*Tn,zr.z+Kt[2]*wt*Tn),ie.transformMat4(pt,pt,ve),ie.transformMat4(dt,dt,ve),Rr.push(new Bu(pt[0],pt[1],pt[2])),tr.push(new Bu(dt[0],dt[1],dt[2]))}Ve.push(Rr),nt.push(tr)}return[Ve,nt]}(k,z,L,B,W,Z,X,H,J,Q,K):X?function(fe,he,_e,oe,me,ve,Ce,Se,Je){const Ge=[],je=[],Ve=[0,0,0,1];for(const nt of fe){const wt=[],pt=[];for(const dt of nt){const Et=dt.x+oe.x,nr=dt.y+oe.y,er=NC(Et,nr,he,_e,ve,Ce,Se,Je);Ve[0]=Et,Ve[1]=nr,Ve[2]=er.base,Ve[3]=1,Wr.transformMat4(Ve,Ve,me),Ve[3]=Math.max(Ve[3],1e-5);const Rr=new Bu(Ve[0]/Ve[3],Ve[1]/Ve[3],Ve[2]/Ve[3]);Ve[0]=Et,Ve[1]=nr,Ve[2]=er.top,Ve[3]=1,Wr.transformMat4(Ve,Ve,me),Ve[3]=Math.max(Ve[3],1e-5);const tr=new Bu(Ve[0]/Ve[3],Ve[1]/Ve[3],Ve[2]/Ve[3]);wt.push(Rr),pt.push(tr)}Ge.push(wt),je.push(pt)}return[Ge,je]}(z,L,B,W,Z,X,H,J,Q):function(fe,he,_e,oe,me){const ve=[],Ce=[],Se=me[8]*he,Je=me[9]*he,Ge=me[10]*he,je=me[11]*he,Ve=me[8]*_e,nt=me[9]*_e,wt=me[10]*_e,pt=me[11]*_e;for(const dt of fe){const Et=[],nr=[];for(const er of dt){const Rr=er.x+oe.x,tr=er.y+oe.y,ir=me[0]*Rr+me[4]*tr+me[12],Dt=me[1]*Rr+me[5]*tr+me[13],Yt=me[2]*Rr+me[6]*tr+me[14],zr=me[3]*Rr+me[7]*tr+me[15],Kt=ir+Se,Or=Dt+Je,Tn=Yt+Ge,Mn=Math.max(zr+je,1e-5),dn=ir+Ve,rn=Dt+nt,Ln=Yt+wt,cn=Math.max(zr+pt,1e-5);Et.push(new Bu(Kt/Mn,Or/Mn,Tn/Mn)),nr.push(new Bu(dn/cn,rn/cn,Ln/cn))}ve.push(Et),Ce.push(nr)}return[ve,Ce]}(z,L,B,W,Z)}(s,i,_,m,p,c,T,y,b,s.center.lat,t.tileID.canonical),P=t.queryGeometry;return function(k,z,L){let B=1/0;kT(L,z)&&(B=BC(L,z[0]));for(let W=0;W<z.length;W++){const Z=z[W],X=k[W];for(let H=0;H<Z.length-1;H++){const J=Z[H],Q=[J,Z[H+1],X[H+1],X[H],J];PT(L,Q)&&(B=Math.min(B,BC(L,Q)))}}return B!==1/0&&B}(M,C,P.isPointQuery()?P.screenBounds:P.screenGeometry)}},line:class extends so{constructor(t,e){super(t,jC,e),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if(t==="line-gradient"){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Zy,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=$C.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new og(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new Gs(this,t)}queryRadius(t){const e=t,r=VC(wu("line-width",this,e),wu("line-gap-width",this,e)),i=wu("line-offset",this,e);return r/2+Math.abs(i)+Pm(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,r,i,a,s){if(t.queryGeometry.isAboveHorizon)return!1;const c=LT(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),s.angle,t.pixelToTileUnitsFactor),u=t.pixelToTileUnitsFactor/2*VC(this.paint.get("line-width").evaluate(e,r),this.paint.get("line-gap-width").evaluate(e,r)),d=this.paint.get("line-offset").evaluate(e,r);return d&&(i=function(p,m){const _=[],y=new $(0,0);for(let v=0;v<p.length;v++){const b=p[v],S=[];for(let T=0;T<b.length;T++){const M=b[T],C=b[T+1],P=T===0?y:M.sub(b[T-1])._unit()._perp(),k=T===b.length-1?y:C.sub(M)._unit()._perp(),z=P._add(k)._unit();z._mult(1/(z.x*k.x+z.y*k.y)),S.push(z._mult(m)._add(M))}_.push(S)}return _}(i,d*t.pixelToTileUnitsFactor)),function(p,m,_){for(let y=0;y<m.length;y++){const v=m[y];if(p.length>=3){for(let b=0;b<v.length;b++)if(Js(p,v[b]))return!0}if(QO(p,v,_))return!0}return!1}(c,i,u)}isTileClipped(){return!0}},symbol:Qm,background:class extends so{constructor(t,e){super(t,e9,e)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends so{constructor(t,e){super(t,r9,e),this._updateColorRamp()}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}_handleSpecialPaintPropertyUpdate(t){t!=="raster-color"&&t!=="raster-color-range"||this._updateColorRamp()}_updateColorRamp(){if(!this.hasColorMap())return;const t=this._transitionablePaint._values["raster-color"].value.expression,[e,r]=this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0});this.colorRamp=km({expression:t,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:e,end:r}]}),this.colorRampTexture=null}},sky:class extends so{constructor(t,e){super(t,o9,e),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){t==="sky-gradient"?this._updateColorRamp():t!=="sky-atmosphere-sun"&&t!=="sky-atmosphere-halo-color"&&t!=="sky-atmosphere-color"&&t!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=km({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if(this.paint.get("sky-type")==="atmosphere"){const i=this.paint.get("sky-atmosphere-sun"),a=!i,s=t.style.light,c=s.properties.get("position");return a&&s.properties.get("anchor")==="viewport"&&re("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),a?ox(c.azimuthal,90-c.polar,e):ox(i[0],90-i[1],e)}const r=this.paint.get("sky-gradient-center");return ox(r[0],90-r[1],e)}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return t==="atmosphere"?["skyboxCapture","skybox"]:t==="gradient"?["skyboxGradient"]:null}},slot:class extends so{constructor(t,e){super(t,a9)}},model:class extends so{constructor(t,e){super(t,$B,e)}createBucket(t){return new gC(t)}getProgramIds(){return["model"]}is3D(){return!0}hasShadowPass(){return!0}hasLightBeamPass(){return!0}queryRadius(){return 0}_handleOverridablePaintPropertyUpdate(t,e,r){return!(!this.layout||e.isDataDriven()||r.isDataDriven()||t!=="model-color"&&t!=="model-color-mix-intensity"&&t!=="model-rotation"&&t!=="model-scale"&&t!=="model-translation"&&t!=="model-emissive-strength")}}};function _g(t,e){return t.type==="custom"?new n9(t):new s9[t.type](t,e)}function l9(t){const{userImage:e}=t;return!!(e&&e.render&&e.render())&&(t.data.replace(new Uint8Array(e.data.buffer)),!0)}class c9 extends dr{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded={},this.requestors=[],this.patterns={},this.atlasImage={},this.atlasTexture={},this.dirty=!0}createScope(e){this.images[e]={},this.loaded[e]=!1,this.updatedImages[e]={},this.patterns[e]={},this.callbackDispatchedThisFrame[e]={},this.atlasImage[e]=new Sn({width:1,height:1})}isLoaded(){for(const e in this.loaded)if(!this.loaded[e])return!1;return!0}setLoaded(e,r){if(this.loaded[r]!==e&&(this.loaded[r]=e,e)){for(const{ids:i,callback:a}of this.requestors)this._notify(i,r,a);this.requestors=[]}}hasImage(e,r){return!!this.getImage(e,r)}getImage(e,r){return this.images[r][e]}addImage(e,r,i){this._validate(e,i)&&(this.images[r][e]=i)}_validate(e,r){let i=!0;return this._validateStretch(r.stretchX,r.data&&r.data.width)||(this.fire(new rt(new Error(`Image "${e}" has invalid "stretchX" value`))),i=!1),this._validateStretch(r.stretchY,r.data&&r.data.height)||(this.fire(new rt(new Error(`Image "${e}" has invalid "stretchY" value`))),i=!1),this._validateContent(r.content,r)||(this.fire(new rt(new Error(`Image "${e}" has invalid "content" value`))),i=!1),i}_validateStretch(e,r){if(!e)return!0;let i=0;for(const a of e){if(a[0]<i||a[1]<a[0]||r<a[1])return!1;i=a[1]}return!0}_validateContent(e,r){return!(e&&(e.length!==4||e[0]<0||r.data.width<e[0]||e[1]<0||r.data.height<e[1]||e[2]<0||r.data.width<e[2]||e[3]<0||r.data.height<e[3]||e[2]<e[0]||e[3]<e[1]))}updateImage(e,r,i){i.version=this.images[r][e].version+1,this.images[r][e]=i,this.updatedImages[r][e]=!0}removeImage(e,r){const i=this.images[r][e];delete this.images[r][e],delete this.patterns[r][e],i.userImage&&i.userImage.onRemove&&i.userImage.onRemove()}listImages(e){return Object.keys(this.images[e])}getImages(e,r,i){let a=!0;const s=!!this.loaded[r];if(!s)for(const c of e)this.images[r][c]||(a=!1);s||a?this._notify(e,r,i):this.requestors.push({ids:e,scope:r,callback:i})}getUpdatedImages(e){return this.updatedImages[e]}_notify(e,r,i){const a={};for(const s of e){this.images[r][s]||this.fire(new Ee("styleimagemissing",{id:s}));const c=this.images[r][s];c?a[s]={data:c.data.clone(),pixelRatio:c.pixelRatio,sdf:c.sdf,version:c.version,stretchX:c.stretchX,stretchY:c.stretchY,content:c.content,hasRenderCallback:!!(c.userImage&&c.userImage.render)}:re(`Image "${s}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}i(null,a)}getPixelSize(e){const{width:r,height:i}=this.atlasImage[e];return{width:r,height:i}}getPattern(e,r){const i=this.patterns[r][e],a=this.getImage(e,r);if(!a)return null;if(i&&i.position.version===a.version)return i.position;if(i)i.position.version=a.version;else{const s={w:a.data.width+2,h:a.data.height+2,x:0,y:0},c=new jv(s,a);this.patterns[r][e]={bin:s,position:c}}return this._updatePatternAtlas(r),this.patterns[r][e].position}bind(e,r){const i=e.gl;let a=this.atlasTexture[r];a?this.dirty&&(a.update(this.atlasImage[r]),this.dirty=!1):(a=new Dn(e,this.atlasImage[r],i.RGBA),this.atlasTexture[r]=a),a.bind(i.LINEAR,i.CLAMP_TO_EDGE)}_updatePatternAtlas(e){const r=[];for(const c in this.patterns[e])r.push(this.patterns[e][c].bin);const{w:i,h:a}=Nv(r),s=this.atlasImage[e];s.resize({width:i||1,height:a||1});for(const c in this.patterns[e]){const{bin:u}=this.patterns[e][c],d=u.x+1,p=u.y+1,m=this.images[e][c].data,_=m.width,y=m.height;Sn.copy(m,s,{x:0,y:0},{x:d,y:p},{width:_,height:y}),Sn.copy(m,s,{x:0,y:y-1},{x:d,y:p-1},{width:_,height:1}),Sn.copy(m,s,{x:0,y:0},{x:d,y:p+y},{width:_,height:1}),Sn.copy(m,s,{x:_-1,y:0},{x:d-1,y:p},{width:1,height:y}),Sn.copy(m,s,{x:0,y:0},{x:d+_,y:p},{width:1,height:y})}this.dirty=!0}beginFrame(){for(const e in this.images)this.callbackDispatchedThisFrame[e]={}}dispatchRenderCallbacks(e,r){for(const i of e){if(this.callbackDispatchedThisFrame[r][i])continue;this.callbackDispatchedThisFrame[r][i]=!0;const a=this.images[r][i];l9(a)&&this.updateImage(i,r,a)}}}const u9=new gn({anchor:new Ke(pe.light.anchor),position:new class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return Qe(t.expression.evaluate(e))}interpolate(t,e,r){return{x:Ft(t.x,e.x,r),y:Ft(t.y,e.y,r),z:Ft(t.z,e.z,r),azimuthal:Ft(t.azimuthal,e.azimuthal,r),polar:Ft(t.polar,e.polar,r)}}}(pe.light.position),color:new Ke(pe.light.color),intensity:new Ke(pe.light.intensity)});class UC extends dr{constructor(e,r="flat"){super(),this._transitionable=new wd(u9),this.setLight(e,r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(e,r,i={}){this._validate(GL,e,i)||(this._transitionable.setTransitionOrValue(e),this.id=r)}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,i){return(!i||i.validate!==!1)&&om(this,e.call(lu,Oe({value:r,style:{glyphs:!0,sprite:!0},styleSpec:pe})))}}const h9=new gn({source:new Ke(pe.terrain.source),exaggeration:new Ke(pe.terrain.exaggeration)});let d9=class extends dr{constructor(t,e){super(),this._transitionable=new wd(h9),this.set(t),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=e}get(){return this._transitionable.serialize()}set(t){this._transitionable.setTransitionOrValue(t)}updateTransitions(t){this._transitioning=this._transitionable.transitioned(t,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(t){this.properties=this._transitioning.possiblyEvaluate(t)}};function GC(t,e,r,i){const a=at(45,65,r),[s,c]=WC(t,i),u=ie.length(e);let d=1-Math.min(1,Math.exp((u-s)/(c-s)*-6));return d*=d*d,d=Math.min(1,1.00747*d),d*a*t.alpha}function WC(t,e){const r=.5/Math.tan(.5*e);return[t.range[0]+r,t.range[1]+r]}const f9=new gn({range:new Ke(pe.fog.range),color:new Ke(pe.fog.color),"high-color":new Ke(pe.fog["high-color"]),"space-color":new Ke(pe.fog["space-color"]),"horizon-blend":new Ke(pe.fog["horizon-blend"]),"star-intensity":new Ke(pe.fog["star-intensity"])});class p9 extends dr{constructor(e,r){super(),this._transitionable=new wd(f9),this.set(e),this._transitioning=this._transitionable.untransitioned(),this._transform=r}get state(){const e=this._transform,r=e.projection.name==="globe",i=Qn(e.zoom),a=this.properties.get("range"),s=[.5,3];return{range:r?[Ft(s[0],a[0],i),Ft(s[1],a[1],i)]:a,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(e,r={}){if(!this._validate(qL,e,r)){for(const i of Object.keys(pe.fog))e&&e[i]===void 0&&(e[i]=pe.fog[i].default);this._transitionable.setTransitionOrValue(e)}}getOpacity(e){if(!this._transform.projection.supportsFog)return 0;const r=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:at(45,65,e))*r.a}getOpacityAtLatLng(e,r){return this._transform.projection.supportsFog?function(i,a,s){const c=cr.fromLngLat(a),u=s.elevation?s.elevation.getAtPointOrZero(c):0,d=[c.x,c.y,u];return ie.transformMat4(d,d,s.mercatorFogMatrix),GC(i,d,s.pitch,s._fov)}(this.state,e,r):0}getFovAdjustedRange(e){return this._transform.projection.supportsFog?WC(this.state,e):[0,1]}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}_validate(e,r,i){return(!i||i.validate!==!1)&&om(this,e.call(lu,Oe({value:r,style:{glyphs:!0,sprite:!0},styleSpec:pe})))}}class m9{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class g9{constructor(){this.tasks={},this.taskQueue=[],ar(["process"],this),this.invoker=new m9(this.process),this.nextId=0}add(e,r){const i=this.nextId++,a=function({type:s,isSymbolTile:c,zoom:u}){return u=u||0,s==="message"?0:s!=="maybePrepare"||c?s!=="parseTile"||c?s==="parseTile"&&c?300-u:s==="maybePrepare"&&c?400-u:500:200-u:100-u}(r);if(a===0){Be();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[i]={fn:e,metadata:r,priority:a,id:i},this.taskQueue.push(i),this.invoker.trigger(),{cancel:()=>{delete this.tasks[i]}}}process(){Be();try{if(this.taskQueue=this.taskQueue.filter(i=>!!this.tasks[i]),!this.taskQueue.length)return;const e=this.pick();if(e===null)return;const r=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!r)return;r.fn()}finally{}}pick(){let e=null,r=1/0;for(let a=0;a<this.taskQueue.length;a++){const s=this.tasks[this.taskQueue[a]];s.priority<r&&(r=s.priority,e=a)}if(e===null)return null;const i=this.taskQueue[e];return this.taskQueue.splice(e,1),i}remove(){this.invoker.remove()}}class HC{constructor(e,r,i){this.target=e,this.parent=r,this.mapId=i,this.callbacks={},this.cancelCallbacks={},ar(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Be()?e:w,this.scheduler=new g9}send(e,r,i,a,s=!1,c){const u=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=c,this.callbacks[u]=i);const d=At(this.globalScope)?void 0:[];return this.target.postMessage({id:u,type:e,hasCallback:!!i,targetMapId:a,mustQueue:s,sourceMapId:this.mapId,data:uu(r,d)},d),{cancel:()=>{i&&delete this.callbacks[u],this.target.postMessage({id:u,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}receive(e){const r=e.data,i=r.id;if(i&&(!r.targetMapId||this.mapId===r.targetMapId))if(r.type==="<cancel>"){const a=this.cancelCallbacks[i];delete this.cancelCallbacks[i],a&&a.cancel()}else if(r.mustQueue||Be()){const a=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,r),a&&a.metadata||{type:"message"})}else this.processTask(i,r)}processTask(e,r){if(r.type==="<response>"){const i=this.callbacks[e];delete this.callbacks[e],i&&(r.error?i(hu(r.error)):i(null,hu(r.data)))}else{const i=At(this.globalScope)?void 0:[],a=r.hasCallback?(c,u)=>{delete this.cancelCallbacks[e],this.target.postMessage({id:e,type:"<response>",sourceMapId:this.mapId,error:c?uu(c):null,data:uu(u,i)},i)}:c=>{},s=hu(r.data);if(this.parent[r.type])this.parent[r.type](r.sourceMapId,s,a);else if(this.parent.getWorkerSource){const c=r.type.split(".");this.parent.getWorkerSource(r.sourceMapId,c[0],s.source,s.scope)[c[1]](s,a)}else a(new Error(`Could not find function ${r.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}class ac{constructor(e,r){this.workerPool=e,this.actors=[],this.currentActor=0,this.id=Ir();const i=this.workerPool.acquire(this.id);for(let a=0;a<i.length;a++){const s=new ac.Actor(i[a],r,this.id);s.name=`Worker ${a}`,this.actors.push(s)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(e,r,i){mt(this.actors,(a,s)=>{a.send(e,r,s)},i=i||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(e=>{e.remove()}),this.actors=[],this.workerPool.release(this.id)}}ac.Actor=HC;class qC extends dr{constructor(e,r,i){super(),this._options=e,this._transitionable=new wd(r,i),this._transitionable.setTransitionOrValue(e.properties),this._transitioning=this._transitionable.untransitioned()}updateTransitions(e){this._transitioning=this._transitionable.transitioned(e,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(e){this.properties=this._transitioning.possiblyEvaluate(e)}get(){return this._options.properties=this._transitionable.serialize(),this._options}}const _9=new gn({color:new Ke(pe.properties_light_ambient.color),intensity:new Ke(pe.properties_light_ambient.intensity)}),y9=new gn({direction:new class{constructor(t){this.specification=t}possiblyEvaluate(t,e){return function([r,i]){const a=Qe([1,r,i]);return{x:a.x,y:a.y,z:a.z}}(t.expression.evaluate(e))}interpolate(t,e,r){return{x:Ft(t.x,e.x,r),y:Ft(t.y,e.y,r),z:Ft(t.z,e.z,r)}}}(pe.properties_light_directional.direction),color:new Ke(pe.properties_light_directional.color),intensity:new Ke(pe.properties_light_directional.intensity),"cast-shadows":new Ke(pe.properties_light_directional["cast-shadows"]),"shadow-intensity":new Ke(pe.properties_light_directional["shadow-intensity"])});class ax{constructor(e,r,i,a){this.screenBounds=e,this.cameraPoint=r,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=i,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,a)}static createFromScreenPoints(e,r){let i,a;if(e instanceof $||typeof e[0]=="number"){const s=$.convert(e);i=[s],a=r.isPointAboveHorizon(s)}else{const s=$.convert(e[0]),c=$.convert(e[1]);i=[s,c],a=Re(s,c).every(u=>r.isPointAboveHorizon(u))}return new ax(i,r.getCameraPoint(),a,r)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(e){return Re(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],e)}bufferedCameraGeometry(e){const r=this.screenBounds[0],i=this.screenBounds.length===1?this.screenBounds[0].add(new $(1,1)):this.screenBounds[1],a=Re(r,i,0,!1);return this.cameraPoint.y>i.y&&(this.cameraPoint.x>r.x&&this.cameraPoint.x<i.x?a.splice(3,0,this.cameraPoint):this.cameraPoint.x>=i.x?a[2]=this.cameraPoint:this.cameraPoint.x<=r.x&&(a[3]=this.cameraPoint)),function(s,c){const u=[];for(let d=0;d<s.length;d++){const p=Pt(d-1,-1,s.length-1),m=Pt(d+1,-1,s.length-1),_=s[d],y=s[m],v=s[p].sub(_).unit(),b=y.sub(_).unit(),S=b.angleWithSep(v.x,v.y),T=v.add(b).unit().mult(-1*c/Math.sin(S/2));u.push(_.add(T))}return u}(a,e)}bufferedCameraGeometryGlobe(e){const r=this.screenBounds[0],i=this.screenBounds.length===1?this.screenBounds[0].add(new $(1,1)):this.screenBounds[1],a=Re(r,i,e),s=this.cameraPoint.clone();switch(3*((s.y>r.y)+(s.y>i.y))+((s.x>r.x)+(s.x>i.x))){case 0:a[0]=s,a[4]=s.clone();break;case 1:a.splice(1,0,s);break;case 2:a[1]=s;break;case 3:a.splice(4,0,s);break;case 5:a.splice(2,0,s);break;case 6:a[3]=s;break;case 7:a.splice(3,0,s);break;case 8:a[2]=s}return a}containsTile(e,r,i,a=0){const s=e.queryPadding/r._pixelsPerMercatorPixel+1,c=i?this._bufferedCameraMercator(s,r):this._bufferedScreenMercator(s,r);let u=e.tileID.wrap+(c.unwrapped?a:0);const d=c.polygon.map(T=>LM(e.tileTransform,T,u));if(!DT(d,0,0,Ae,Ae))return;u=e.tileID.wrap+(this.screenGeometryMercator.unwrapped?a:0);const p=this.screenGeometryMercator.polygon.map(T=>OM(e.tileTransform,T,u)),m=p.map(T=>new $(T[0],T[1])),_=r.getFreeCameraOptions().position||new cr(0,0,0),y=OM(e.tileTransform,_,u),v=p.map(T=>{const M=ie.sub(T,T,y);return ie.normalize(M,M),new wm(y,M)}),b=oc(e,1,r.zoom)*r._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:m,tilespaceRays:v,bufferedTilespaceGeometry:d,bufferedTilespaceBounds:(S=it(d),S.min.x=ze(S.min.x,0,Ae),S.min.y=ze(S.min.y,0,Ae),S.max.x=ze(S.max.x,0,Ae),S.max.y=ze(S.max.y,0,Ae),S),tile:e,tileID:e.tileID,pixelToTileUnitsFactor:b};var S}_bufferedScreenMercator(e,r){const i=ZC(e);if(this._screenRaycastCache[i])return this._screenRaycastCache[i];{let a;return a=r.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(e),r):{polygon:this.bufferedScreenGeometry(e).map(s=>r.pointCoordinate3D(s)),unwrapped:!0},this._screenRaycastCache[i]=a,a}}_bufferedCameraMercator(e,r){const i=ZC(e);if(this._cameraRaycastCache[i])return this._cameraRaycastCache[i];{let a;return a=r.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(e),r):{polygon:this.bufferedCameraGeometry(e).map(s=>r.pointCoordinate3D(s)),unwrapped:!0},this._cameraRaycastCache[i]=a,a}}_projectAndResample(e,r){const i=function(s,c){const u=ge.multiply([],c.pixelMatrix,c.globeMatrix),d=[0,-Wi,0,1],p=[0,Wi,0,1],m=[0,0,0,1];Wr.transformMat4(d,d,u),Wr.transformMat4(p,p,u),Wr.transformMat4(m,m,u);const _=new $(d[0]/d[3],d[1]/d[3]),y=new $(p[0]/p[3],p[1]/p[3]),v=Js(s,_)&&d[3]<m[3],b=Js(s,y)&&p[3]<m[3];if(!v&&!b)return null;const S=function(B,W,Z){for(let X=1;X<B.length;X++){const H=Qd(W.pointCoordinate3D(B[X-1]).x),J=Qd(W.pointCoordinate3D(B[X]).x);if(Z<0){if(H<J)return{idx:X,t:-H/(J-1-H)}}else if(J<H)return{idx:X,t:(1-H)/(J+1-H)}}return null}(s,c,v?-1:1);if(!S)return null;const{idx:T,t:M}=S;let C=T>1?sx(s.slice(0,T),c):[],P=T<s.length?sx(s.slice(T),c):[];C=C.map(B=>new $(Qd(B.x),B.y)),P=P.map(B=>new $(Qd(B.x),B.y));const k=[...C];k.length===0&&k.push(P[P.length-1]);const z=Ft(k[k.length-1].y,(P.length===0?C[0]:P[0]).y,M);let L;return L=v?[new $(0,z),new $(0,0),new $(1,0),new $(1,z)]:[new $(1,z),new $(1,1),new $(0,1),new $(0,z)],k.push(...L),P.length===0?k.push(C[0]):k.push(...P),{polygon:k.map(B=>new cr(B.x,B.y)),unwrapped:!1}}(e,r);if(i)return i;const a=function(s,c){let u=!1,d=-1/0,p=0;for(let _=0;_<s.length-1;_++)s[_].x>d&&(d=s[_].x,p=_);for(let _=0;_<s.length-1;_++){const y=(p+_)%(s.length-1),v=s[y],b=s[y+1];Math.abs(v.x-b.x)>.5&&(v.x<b.x?(v.x+=1,y===0&&(s[s.length-1].x+=1)):(b.x+=1,y+1===s.length-1&&(s[0].x+=1)),u=!0)}const m=ei(c.center.lng);return u&&m<Math.abs(m-1)&&s.forEach(_=>{_.x-=1}),{polygon:s,unwrapped:u}}(sx(e,r).map(s=>new $(Qd(s.x),s.y)),r);return{polygon:a.polygon.map(s=>new cr(s.x,s.y)),unwrapped:a.unwrapped}}}function sx(t,e){return AT(t,r=>{const i=e.pointCoordinate3D(r);r.x=i.x,r.y=i.y},1/256)}function Qd(t){return t<0?1+t%1:t%1}function ZC(t){return 100*t|0}function lx(t,e,r,i,a){const s=function(c,u){if(c)return a(c);if(u){t.url&&u.tiles&&t.tiles&&delete t.tiles;const d=qt(Oe(u,t),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);u.vector_layers&&(d.vectorLayers=u.vector_layers,d.vectorLayerIds=d.vectorLayers.map(p=>p.id)),d.tiles=e.canonicalizeTileset(d,t.url),a(null,d)}};return t.url?qe(e.transformRequest(e.normalizeSourceURL(t.url,null,r,i),be.Source),s):Ot.frame(()=>s(null,t))}class yg{constructor(e,r,i){this.bounds=lo.convert(this.validateBounds(e)),this.minzoom=r||0,this.maxzoom=i||24}validateBounds(e){return Array.isArray(e)&&e.length===4?[Math.max(-180,e[0]),Math.max(-90,e[1]),Math.min(180,e[2]),Math.min(90,e[3])]:[-180,-90,180,90]}contains(e){const r=Math.pow(2,e.z),i=Math.floor(ei(this.bounds.getWest())*r),a=Math.floor(ai(this.bounds.getNorth())*r),s=Math.ceil(ei(this.bounds.getEast())*r),c=Math.ceil(ai(this.bounds.getSouth())*r);return e.x>=i&&e.x<s&&e.y>=a&&e.y<c}}class XC{constructor(e,r){this.width=e,this.height=r,this.nextRow=0,this.image=new is({width:e,height:r}),this.positions={},this.uploaded=!1}getDash(e,r){const i=this.getKey(e,r);return this.positions[i]}trim(){const e=this.width,r=this.height=Ur(this.nextRow);this.image.resize({width:e,height:r})}getKey(e,r){return e.join(",")+r}getDashRanges(e,r,i){const a=[];let s=e.length%2==1?-e[e.length-1]*i:0,c=e[0]*i,u=!0;a.push({left:s,right:c,isDash:u,zeroLength:e[0]===0});let d=e[0];for(let p=1;p<e.length;p++){u=!u;const m=e[p];s=d*i,d+=m,c=d*i,a.push({left:s,right:c,isDash:u,zeroLength:m===0})}return a}addRoundDash(e,r,i){const a=r/2;for(let s=-i;s<=i;s++){const c=this.width*(this.nextRow+i+s);let u=0,d=e[u];for(let p=0;p<this.width;p++){p/d.right>1&&(d=e[++u]);const m=Math.abs(p-d.left),_=Math.abs(p-d.right),y=Math.min(m,_);let v;const b=s/i*(a+1);if(d.isDash){const S=a-Math.abs(b);v=Math.sqrt(y*y+S*S)}else v=a-Math.sqrt(y*y+b*b);this.image.data[c+p]=Math.max(0,Math.min(255,v+128))}}}addRegularDash(e,r){for(let d=e.length-1;d>=0;--d){const p=e[d],m=e[d+1];p.zeroLength?e.splice(d,1):m&&m.isDash===p.isDash&&(m.left=p.left,e.splice(d,1))}const i=e[0],a=e[e.length-1];i.isDash===a.isDash&&(i.left=a.left-this.width,a.right=i.right+this.width);const s=this.width*this.nextRow;let c=0,u=e[c];for(let d=0;d<this.width;d++){d/u.right>1&&(u=e[++c]);const p=Math.abs(d-u.left),m=Math.abs(d-u.right),_=Math.min(p,m);this.image.data[s+d]=Math.max(0,Math.min(255,(u.isDash?_:-_)+r+128))}}addDash(e,r){const i=this.getKey(e,r);if(this.positions[i])return this.positions[i];const a=r==="round",s=a?7:0,c=2*s+1;if(this.nextRow+c>this.height)return re("LineAtlas out of space"),null;e.length===0&&e.push(1);let u=0;for(let m=0;m<e.length;m++)e[m]<0&&(re("Negative value is found in line dasharray, replacing values with 0"),e[m]=0),u+=e[m];if(u!==0){const m=this.width/u,_=this.getDashRanges(e,this.width,m);a?this.addRoundDash(_,m,s):this.addRegularDash(_,r==="square"?.5*m:0)}const d=this.nextRow+s;this.nextRow+=c;const p={tl:[d,s],br:[u,0]};return this.positions[i]=p,p}}ht(XC,"LineAtlas");const YC=1*ra;class KC{constructor(e){const r={},i=[];for(const u in e){const d=e[u],p=r[u]={};for(const m in d.glyphs){const _=d.glyphs[+m];if(!_||_.bitmap.width===0||_.bitmap.height===0)continue;const y=_.metrics.localGlyph?YC:1,v={x:0,y:0,w:_.bitmap.width+2*y,h:_.bitmap.height+2*y};i.push(v),p[m]=v}}const{w:a,h:s}=Nv(i),c=new is({width:a||1,height:s||1});for(const u in e){const d=e[u];for(const p in d.glyphs){const m=d.glyphs[+p];if(!m||m.bitmap.width===0||m.bitmap.height===0)continue;const _=r[u][p],y=m.metrics.localGlyph?YC:1;is.copy(m.bitmap,c,{x:0,y:0},{x:_.x+y,y:_.y+y},m.bitmap)}}this.image=c,this.positions=r}}ht(KC,"GlyphAtlas");class v9{constructor(e){this.tileID=new Kr(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.scope=e.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=ic(e.tileID.canonical,e.projection),this.projection=e.projection,this.brightness=e.brightness}parse(e,r,i,a,s){this.status="parsing",this.data=e,this.collisionBoxArray=new V1;const c=new XT(Object.keys(e.layers).sort()),u=new Ov(this.tileID,this.promoteId);u.bucketLayerIDs=[];const d={},p=new XC(256,256),m={featureIndex:u,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:p,availableImages:i,brightness:this.brightness},_=r.familiesBySource[this.source];for(const z in _){const L=e.layers[z];if(!L)continue;let B=!1,W=!1;for(const H of _[z])H[0].type==="symbol"?B=!0:W=!0;if(this.isSymbolTile===!0&&!B||this.isSymbolTile===!1&&!W)continue;L.version===1&&re(`Vector tile source "${this.source}" layer "${z}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Z=c.encode(z),X=[];for(let H=0;H<L.length;H++){const J=L.feature(H),Q=u.getId(J,z);X.push({feature:J,id:Q,index:H,sourceLayerIndex:Z})}for(const H of _[z]){const J=H[0];this.isSymbolTile!==void 0&&J.type==="symbol"!==this.isSymbolTile||J.minzoom&&this.zoom<Math.floor(J.minzoom)||J.maxzoom&&this.zoom>=J.maxzoom||J.visibility!=="none"&&(cx(H,this.zoom,m.brightness,i),(d[J.id]=J.createBucket({index:u.bucketLayerIDs.length,layers:H,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Z,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec})).populate(X,m,this.tileID.canonical,this.tileTransform),u.bucketLayerIDs.push(H.map(Q=>Q.id)))}}let y,v,b,S;p.trim();const T={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},M=()=>{if(y)return s(y);if(v&&b&&S){const z=new KC(v),L=new fM(b,S);for(const B in d){const W=d[B];W instanceof Gd?(cx(W.layers,this.zoom,m.brightness,i),E7(W,v,z.positions,b,L.iconPositions,this.showCollisionBoxes,i,this.tileID.canonical,this.tileZoom,this.projection,this.brightness)):W.hasPattern&&(W instanceof og||W instanceof Fm||W instanceof Kd)&&(cx(W.layers,this.zoom,m.brightness,i),W.addFeatures(m,this.tileID.canonical,L.patternPositions,i,this.tileTransform,this.brightness))}this.status="done",s(null,{buckets:kt(d).filter(B=>!B.isEmpty()),featureIndex:u,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:z.image,lineAtlas:p,imageAtlas:L,brightness:m.brightness,glyphMap:this.returnDependencies?v:null,iconMap:this.returnDependencies?b:null,glyphPositions:this.returnDependencies?z.positions:null})}},C=xr(m.glyphDependencies,z=>Object.keys(z).map(Number));Object.keys(C).length?a.send("getGlyphs",{uid:this.uid,stacks:C,scope:this.scope},(z,L)=>{y||(y=z,v=L,M())},void 0,!1,T):v={};const P=Object.keys(m.iconDependencies);P.length?a.send("getImages",{icons:P,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(z,L)=>{y||(y=z,b=L,M())},void 0,!1,T):b={};const k=Object.keys(m.patternDependencies);k.length?a.send("getImages",{icons:k,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(z,L)=>{y||(y=z,S=L,M())},void 0,!1,T):S={},M()}}function cx(t,e,r,i){const a=new mn(e,{brightness:r});for(const s of t)s.recalculate(a,i)}class JC{constructor(e){this.entries={},this.scheduler=e}request(e,r,i,a){const s=this.entries[e]=this.entries[e]||{callbacks:[]};if(s.result){const[c,u]=s.result;return this.scheduler?this.scheduler.add(()=>{a(c,u)},r):a(c,u),()=>{}}return s.callbacks.push(a),s.cancel||(s.cancel=i((c,u)=>{s.result=[c,u];for(const d of s.callbacks)this.scheduler?this.scheduler.add(()=>{d(c,u)},r):d(c,u);setTimeout(()=>delete this.entries[e],3e3)})),()=>{s.result||(s.callbacks=s.callbacks.filter(c=>c!==a),s.callbacks.length||(s.cancel(),delete this.entries[e]))}}}function QC(t,e,r){const i=JSON.stringify(t.request);return t.data&&(this.deduped.entries[i]={result:[null,t.data]}),this.deduped.request(i,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},a=>{const s=Ue(t.request,(c,u,d,p)=>{c?a(c):u&&a(null,{vectorTile:r?void 0:new Dv(new Um(u)),rawData:u,cacheControl:d,expires:p})});return()=>{s.cancel(),a()}},e)}class e5 extends dr{constructor(e,r,i,a){if(super(),this.id=e,this.dispatcher=i,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,Oe(this,qt(r,["url","scheme","tileSize","promoteId"])),this._options=Oe({type:"vector"},r),this._collectResourceTiming=!!r.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(a),this._tileWorkers={},this._deduped=new JC}load(e){this._loaded=!1,this.fire(new Ee("dataloading",{dataType:"source"}));const r=Array.isArray(this.map._language)?this.map._language.join():this.map._language,i=this.map._worldview;this._tileJSONRequest=lx(this._options,this.map._requestManager,r,i,(a,s)=>{this._tileJSONRequest=null,this._loaded=!0,a?(r&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${r}`),i&&i.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${i}`),this.fire(new rt(a))):s&&(Oe(this,s),s.bounds&&(this.tileBounds=new yg(s.bounds,this.minzoom,this.maxzoom)),$l(s.tiles,this.map._requestManager._customAccessToken),this.fire(new Ee("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Ee("data",{dataType:"source",sourceDataType:"content"}))),e&&e(a)})}loaded(){return this._loaded}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return Oe({},this._options)}loadTile(e,r){const i=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme)),a={request:this.map._requestManager.transformRequest(i,be.Tile),data:void 0,uid:e.uid,tileID:e.tileID,tileZoom:e.tileZoom,zoom:e.tileID.overscaledZ,tileSize:this.tileSize*e.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:Ot.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:e.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(a.request.collectResourceTiming=this._collectResourceTiming,e.actor&&e.state!=="expired")e.state==="loading"?e.reloadCallback=r:e.request=e.actor.send("reloadTile",a,s.bind(this));else if(e.actor=this._tileWorkers[i]=this._tileWorkers[i]||this.dispatcher.getActor(),this.dispatcher.ready)e.request=e.actor.send("loadTile",a,s.bind(this),void 0,!0);else{const c=QC.call({deduped:this._deduped},a,(u,d)=>{u||!d?s.call(this,u):(a.data={cacheControl:d.cacheControl,expires:d.expires,rawData:d.rawData.slice(0)},e.actor&&e.actor.send("loadTile",a,s.bind(this),void 0,!0))},!0);e.request={cancel:c}}function s(c,u){return delete e.request,e.aborted?r(null):c&&c.status!==404?r(c):(u&&u.resourceTiming&&(e.resourceTiming=u.resourceTiming),this.map._refreshExpiredTiles&&u&&e.setExpiryData(u),e.loadVectorData(u,this.map.painter),ye(this.dispatcher),r(null),void(e.reloadCallback&&(this.loadTile(e,e.reloadCallback),e.reloadCallback=null)))}}abortTile(e){e.request&&(e.request.cancel(),delete e.request),e.actor&&e.actor.send("abortTile",{uid:e.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(e){e.unloadVectorData(),e.actor&&e.actor.send("removeTile",{uid:e.uid,type:this.type,source:this.id,scope:this.scope})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ef extends dr{constructor(e,r,i,a){super(),this.id=e,this.dispatcher=i,this.setEventedParent(a),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=Oe({type:"raster"},r),Oe(this,qt(r,["url","scheme","tileSize"]))}load(e){this._loaded=!1,this.fire(new Ee("dataloading",{dataType:"source"})),this._tileJSONRequest=lx(this._options,this.map._requestManager,null,null,(r,i)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new rt(r)):i&&(Oe(this,i),i.bounds&&(this.tileBounds=new yg(i.bounds,this.minzoom,this.maxzoom)),$l(i.tiles),this.fire(new Ee("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Ee("data",{dataType:"source",sourceDataType:"content"}))),e&&e(r)})}loaded(){return this._loaded}onAdd(e){this.map=e,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(e){return this._options.tiles=e,this.reload(),this}setUrl(e){return this.url=e,this._options.url=e,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return Oe({},this._options)}hasTile(e){return!this.tileBounds||this.tileBounds.contains(e.canonical)}loadTile(e,r){const i=Ot.devicePixelRatio>=2,a=this.map._requestManager.normalizeTileURL(e.tileID.canonical.url(this.tiles,this.scheme),i,this.tileSize);e.request=rr(this.map._requestManager.transformRequest(a,be.Tile),(s,c,u,d)=>(delete e.request,e.aborted?(e.state="unloaded",r(null)):s?(e.state="errored",r(s)):c?(this.map._refreshExpiredTiles&&e.setExpiryData({cacheControl:u,expires:d}),e.setTexture(c,this.map.painter),e.state="loaded",ye(this.dispatcher),void r(null)):r(null)))}static loadTileData(e,r,i){e.setTexture(r,i)}static unloadTileData(e,r){e.texture&&r.saveTileTexture(e.texture)}abortTile(e,r){e.request&&(e.request.cancel(),delete e.request),r()}unloadTile(e,r){e.texture&&this.map.painter.saveTileTexture(e.texture),r()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let ux;function t5(t,e,r,i,a,s,c,u){const d=[t,r,a,e,i,s,1,1,1],p=[c,u,1],m=Ii.adjoint([],d),[_,y,v]=ie.transformMat3(p,p,Ii.transpose(m,m));return Ii.multiply(d,[_,0,0,0,y,0,0,0,v],d)}class sc extends dr{constructor(e,r,i,a){super(),this.id=e,this.dispatcher=i,this.coordinates=r.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(a),this.options=r,this._dirty=!1}load(e,r){this._loaded=r||!1,this.fire(new Ee("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=rr(this.map._requestManager.transformRequest(this.url,be.Image),(i,a)=>{if(this._imageRequest=null,this._loaded=!0,i)this.fire(new rt(i));else if(a){const{HTMLImageElement:s}=w;this.image=a instanceof s?Ot.getImageData(a):a,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,e&&(this.coordinates=e),this._finishLoading()}})}loaded(){return this._loaded}updateImage(e){return this.image&&e.url?(this._imageRequest&&e.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=e.url,this.load(e.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Ee("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(e){this.map=e,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(e){this.coordinates=e,this._boundsArray=void 0;const r=e.map(cr.fromLngLat);return this.tileID=function(i){let a=1/0,s=1/0,c=-1/0,u=-1/0;for(const _ of i)a=Math.min(a,_.x),s=Math.min(s,_.y),c=Math.max(c,_.x),u=Math.max(u,_.y);const d=Math.max(c-a,u-s),p=Math.max(0,Math.floor(-Math.log(d)/Math.LN2)),m=Math.pow(2,p);return new ns(p,Math.floor((a+c)/2*m),Math.floor((s+u)/2*m))}(r),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new Ee("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(e){for(const d in this.tiles){const p=this.tiles[d];p.state!=="loaded"&&(p.state="loaded",p.texture=this.texture)}if(this._boundsArray)return;const r=ic(this.tileID,this.map.transform.projection),[i,a,s,c]=this.coordinates.map(d=>{const p=r.projection.project(d[0],d[1]);return LM(r,p)._round()});this.perspectiveTransform=function(d,p,m,_,y,v,b,S,T,M){const C=t5(0,0,d,0,0,p,d,p),P=t5(m,_,y,v,b,S,T,M);return Ii.multiply(P,Ii.adjoint(C,C),P),[P[6]/P[8]*d/Ae,P[7]/P[8]*p/Ae]}(this.width,this.height,i.x,i.y,a.x,a.y,c.x,c.y,s.x,s.y);const u=this._boundsArray=new Bs;u.emplaceBack(i.x,i.y,0,0),u.emplaceBack(a.x,a.y,Ae,0),u.emplaceBack(c.x,c.y,0,Ae),u.emplaceBack(s.x,s.y,Ae,Ae),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=e.createVertexBuffer(u,Xv.members),this.boundsSegments=Gr.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const e=this.map.painter.context,r=e.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new Dn(e,this.image,r.RGBA),this.texture.bind(r.LINEAR,r.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(e)}loadTile(e,r){this.tileID&&this.tileID.equals(e.tileID.canonical)?(this.tiles[String(e.tileID.wrap)]=e,e.buckets={},r(null)):(e.state="errored",r(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}class r5{constructor(e,r,i){if(this.triangleCount=r.length/3,this.min=new $(0,0),this.max=new $(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||e.length===0||i===0)return;const a=e.map(m=>m.x),s=e.map(m=>m.y);this.min=new $(Math.min(...a),Math.min(...s)),this.max=new $(Math.max(...a),Math.max(...s));const c=this.max.sub(this.min);c.x=Math.max(c.x,1),c.y=Math.max(c.y,1);const u=Math.max(c.x,c.y)/i;this.cellsX=Math.max(1,Math.ceil(c.x/u)),this.cellsY=Math.max(1,Math.ceil(c.y/u)),this.xScale=this.cellsX/c.x,this.yScale=this.cellsY/c.y;const d=[];for(let m=0;m<this.triangleCount;m++){const _=e[r[3*m+0]].sub(this.min),y=e[r[3*m+1]].sub(this.min),v=e[r[3*m+2]].sub(this.min),b=ll(Math.floor(Math.min(_.x,y.x,v.x)),this.xScale,this.cellsX),S=ll(Math.floor(Math.max(_.x,y.x,v.x)),this.xScale,this.cellsX),T=ll(Math.floor(Math.min(_.y,y.y,v.y)),this.yScale,this.cellsY),M=ll(Math.floor(Math.max(_.y,y.y,v.y)),this.yScale,this.cellsY),C=new $(0,0),P=new $(0,0),k=new $(0,0),z=new $(0,0);for(let L=T;L<=M;++L){C.y=P.y=L*u,k.y=z.y=(L+1)*u;for(let B=b;B<=S;++B)C.x=k.x=B*u,P.x=z.x=(B+1)*u,(Tv(_,y,v,C,P,z)||Tv(_,y,v,C,z,k))&&d.push({cellIdx:L*this.cellsX+B,triIdx:m})}}if(d.length===0)return;d.sort((m,_)=>m.cellIdx-_.cellIdx||m.triIdx-_.triIdx);let p=0;for(;p<d.length;){const m=d[p].cellIdx,_={start:this.payload.length,len:0};for(;p<d.length&&d[p].cellIdx===m;)++_.len,this.payload.push(d[p++].triIdx);this.cells[m]=_}}query(e,r,i){if(this.triangleCount===0||this.cells.length===0||e.x>this.max.x||this.min.x>r.x||e.y>this.max.y||this.min.y>r.y)return;this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8)));for(let d=0;d<this.lookup.length;d++)this.lookup[d]=0;const a=ll(e.x-this.min.x,this.xScale,this.cellsX),s=ll(r.x-this.min.x,this.xScale,this.cellsX),c=ll(e.y-this.min.y,this.yScale,this.cellsY),u=ll(r.y-this.min.y,this.yScale,this.cellsY);for(let d=c;d<=u;d++)for(let p=a;p<=s;p++){const m=this.cells[d*this.cellsX+p];if(m)for(let _=0;_<m.len;_++){const y=this.payload[m.start+_],v=Math.floor(y/8),b=1<<y%8;if(!(this.lookup[v]&b)&&(this.lookup[v]|=b,i.push(y),i.length===this.triangleCount))return}}}}function ll(t,e,r){return Math.max(0,Math.min(r-1,Math.floor(t*e)))}ht(r5,"TriangleGridIndex");const x9=5123,b9=5126,w9={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},n5={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function Nu(t,e){if(e.value&&e.value.length)return e.value;const r=t.json.bufferViews[e.bufferView],i=t.buffers[r.buffer];return new w9[e.componentType](i.arrayBuffer,i.byteOffset+(e.byteOffset||0)+(r.byteOffset||0),e.count*n5[e.type])}function E9(t,e,r){const i=t.indices,a=t.attributes,s={};s.indexArray=new Bn;const c=typeof i=="object"?i:e.json.accessors[i],u=c.count/3;s.indexArray.reserve(u);const d=Nu(e,c);for(let y=0;y<u;y++)s.indexArray.emplaceBack(d[3*y],d[3*y+1],d[3*y+2]);s.indexArray._trim(),s.vertexArray=new Vs;const p=typeof a.POSITION=="object"?a.POSITION:e.json.accessors[a.POSITION];s.vertexArray.reserve(p.count);const m=Nu(e,p);for(let y=0;y<p.count;y++)s.vertexArray.emplaceBack(m[3*y],m[3*y+1],m[3*y+2]);if(s.vertexArray._trim(),s.aabb=new _n(p.min,p.max),s.centroid=function(y,v){const b=[0,0,0],S=y.length;if(S>0){for(let T=0;T<S;T++){const M=3*y[T];b[0]+=v[M],b[1]+=v[M+1],b[2]+=v[M+2]}b[0]/=S,b[1]/=S,b[2]/=S}return b}(d,m),a.COLOR_0!==void 0){const y=typeof a.COLOR_0=="object"?a.COLOR_0:e.json.accessors[a.COLOR_0],v=n5[y.type];if(y.componentType===b9){s.colorArray=v===3?new Vs:new Ns,s.colorArray.reserve(y.count);const b=Nu(e,y);if(v===3)for(let S=0;S<y.count;S++)s.colorArray.emplaceBack(b[3*S],b[3*S+1],b[3*S+2]);else for(let S=0;S<y.count;S++)s.colorArray.emplaceBack(b[4*S],b[4*S+1],b[4*S+2],b[4*S+3]);s.colorArray._trim()}else if(y.componentType===x9&&v===4){s.colorArray=new Ns,s.colorArray.resize(y.count);const b=Nu(e,y),S=1/65535,T=s.colorArray.float32;for(let M=0;M<4*b.length;++M)T[M]=b[M]*S}else re(`glTF color buffer parsing for accessor ${JSON.stringify(y)} is not supported`)}if(a.NORMAL!==void 0){s.normalArray=new Vs;const y=typeof a.NORMAL=="object"?a.NORMAL:e.json.accessors[a.NORMAL];s.normalArray.reserve(y.count);const v=Nu(e,y);for(let b=0;b<y.count;b++)s.normalArray.emplaceBack(v[3*b],v[3*b+1],v[3*b+2]);s.normalArray._trim()}if(a.TEXCOORD_0!==void 0&&r.length>0){s.texcoordArray=new Md;const y=typeof a.TEXCOORD_0=="object"?a.TEXCOORD_0:e.json.accessors[a.TEXCOORD_0];s.texcoordArray.reserve(y.count);const v=Nu(e,y);for(let b=0;b<y.count;b++)s.texcoordArray.emplaceBack(v[2*b],v[2*b+1]);s.texcoordArray._trim()}const _=t.material;return s.material=function(y,v){const b=y.pbrMetallicRoughness?y.pbrMetallicRoughness:{},S={},T={},M=b.baseColorFactor?new Zt(b.baseColorFactor[0],b.baseColorFactor[1],b.baseColorFactor[2],b.baseColorFactor[3]):Zt.white;return T.baseColorFactor=M,T.metallicFactor=b.metallicFactor!==void 0?b.metallicFactor:1,T.roughnessFactor=b.roughnessFactor!==void 0?b.roughnessFactor:1,S.emissiveFactor=y.emissiveFactor?[y.emissiveFactor[0],y.emissiveFactor[1],y.emissiveFactor[2]]:[0,0,0],S.alphaMode=y.alphaMode?y.alphaMode:"OPAQUE",S.alphaCutoff=y.alphaCutoff!==void 0?y.alphaCutoff:.5,b.baseColorTexture&&(T.baseColorTexture=v[b.baseColorTexture.index]),b.metallicRoughnessTexture&&(T.metallicRoughnessTexture=v[b.metallicRoughnessTexture.index]),y.normalTexture&&(S.normalTexture=v[y.normalTexture.index]),y.occlusionTexture&&(S.occlusionTexture=v[y.occlusionTexture.index]),y.emissiveTexture&&(S.emissionTexture=v[y.emissiveTexture.index]),S.pbrMetallicRoughness=T,y.defined===void 0&&(S.defined=!0),S}(_!==void 0?e.json.materials[_]:{defined:!1},r),a.CUSTOM_ATTRIBUTE_3!==void 0&&(s.featureData=new Uint32Array(a.CUSTOM_ATTRIBUTE_3.value.buffer)),s}function i5(t,e,r){const i={};if(i.matrix=t.matrix?t.matrix:ge.identity([]),t.translation&&ge.translate(i.matrix,i.matrix,[t.translation[0],t.translation[1],t.translation[2]]),t.rotation){const a=ge.fromQuat([],[t.rotation[0],t.rotation[1],t.rotation[2],t.rotation[3]]);ge.multiply(i.matrix,i.matrix,a)}if(t.scale&&ge.scale(i.matrix,i.matrix,[t.scale[0],t.scale[1],t.scale[2]]),t.mesh!==void 0&&(i.meshes=r[t.mesh]),t.extras&&(t.extras.id&&(i.id=t.extras.id),t.extras.lights&&(i.lights=function(a){if(!a.length)return[];const s=function(m,_){const y=m.replace(/[^A-Za-z0-9+/]/g,""),v=y.length,b=3*v+1>>2,S=new Uint8Array(b);let T,M,C=0,P=0;for(let z=0;z<v;z++)if(M=3&z,C|=((k=y.charCodeAt(z))>64&&k<91?k-65:k>96&&k<123?k-71:k>47&&k<58?k+4:k===43?62:k===47?63:0)<<6*(3-M),M===3||v-z==1){for(T=0;T<3&&P<b;)S[P]=C>>>(16>>>T&24)&255,T++,P++;C=0}var k;return S}(a),c=[],u=s.length/24,d=new Uint16Array(s.buffer),p=new Float32Array(s.buffer);for(let m=0;m<u;m++){const _=d[2*m*6]/30,y=d[2*m*6+1]/30,v=[p[6*m+1],p[6*m+2],y],b=[p[6*m+3],p[6*m+4],y],S=ie.sub([],b,v),T=ie.length(S);S[2]=-S[0],S[0]=S[1],S[1]=S[2],S[2]=0,ie.scale(S,S,1/T);const M=d[2*m*6+10]/100,C=ie.add([],v,b);ie.scale(C,C,.5),c.push({pos:C,normal:S,width:T,height:_,depth:M,points:[v[0],v[1],b[0],b[1]]})}return c}(t.extras.lights)),i.meshes)){const a=[0,0];for(const s of i.meshes){const c=s.aabb;a[0]+=c.min[0]+c.max[0],a[1]+=c.min[1]+c.max[1]}a[0]=Math.floor(a[0]/i.meshes.length/2),a[1]=Math.floor(a[1]/i.meshes.length/2),i.anchor=a}if(t.children){const a=[];for(const s of t.children)a.push(i5(e.json.nodes[s],e,r));i.children=a}return i}function S9(t){if(t.vertices.length===0||t.indices.length===0)return null;const[e,r]=[t.vertices[0].clone(),t.vertices[0].clone()];for(let c=1;c<t.vertices.length;++c){const u=t.vertices[c];e.x=Math.min(e.x,u.x),e.y=Math.min(e.y,u.y),r.x=Math.max(r.x,u.x),r.y=Math.max(r.y,u.y)}const i=Math.ceil(Math.max(r.x-e.x,r.y-e.y)/256),a=Math.max(8,i),s=new r5(t.vertices,t.indices,a);return{vertices:t.vertices,indices:t.indices,grid:s,min:e,max:r}}function T9(t){if(!t.extras||!t.extras.ground)return null;const e=t.extras.ground;if(!e||!Array.isArray(e)||e.length===0)return null;const r=e[0];if(!r||!Array.isArray(r)||r.length===0)return null;const i=[];for(const c of r){if(!Array.isArray(c)||c.length!==2)continue;const u=c[0],d=c[1];typeof u=="number"&&typeof d=="number"&&i.push(new $(u,d))}if(i.length<3)return null;i.length>1&&i[i.length-1].equals(i[0])&&i.pop();let a=0;for(let c=0;c<i.length;c++){const u=i[c],d=i[(c+1)%i.length],p=i[(c+2)%i.length];a+=(u.x-d.x)*(p.y-d.y)-(p.x-d.x)*(u.y-d.y)}a>0&&i.reverse();const s=Om(i.flatMap(c=>[c.x,c.y]),[]);return s.length===0?null:{vertices:i,indices:s}}function M9(t){const e=[],r=[];let i=0;for(const a of t){i=e.length;const s=a.vertexArray.float32,c=a.indexArray.uint16;for(let u=0;u<a.vertexArray.length;u++)e.push(new $(s[3*u+0],s[3*u+1]));for(let u=0;u<3*a.indexArray.length;u++)r.push(c[u]+i)}if(r.length%3!=0)return null;for(let a=0;a<r.length;a+=3){const s=e[r[a+0]],c=e[r[a+1]],u=e[r[a+2]];(s.x-c.x)*(u.y-c.y)-(u.x-c.x)*(s.y-c.y)>0&&([r[a+1],r[a+2]]=[r[a+2],r[a+1]])}return{vertices:e,indices:r}}function hx(t){const e=function(u){const d=[];for(const p of u.images)d.push(p);return d}(t),r=function(u,d){const p=[],m=w.WebGLRenderingContext,_=u.json.samplers;if(u.json.textures)for(const y of u.json.textures){const v={magFilter:m.LINEAR,minFilter:m.NEAREST,wrapS:m.REPEAT,wrapT:m.REPEAT,mipmaps:!1};y.sampler!==void 0&&(_[y.sampler].magFilter&&(v.magFilter=_[y.sampler].magFilter),_[y.sampler].minFilter&&(v.minFilter=_[y.sampler].minFilter),v.minFilter>=m.NEAREST_MIPMAP_NEAREST&&(v.mipmaps=!0),_[y.sampler].wrapS&&(v.wrapS=_[y.sampler].wrapS),_[y.sampler].wrapT&&(v.wrapT=_[y.sampler].wrapT)),p.push({image:d[y.source],sampler:v,uploaded:!1})}return p}(t,e),i=function(u,d){const p=[];for(const m of u.json.meshes){const _=[];for(const y of m.primitives){const v=E9(y,u,d);_.push(v)}p.push(_)}return p}(t,r),a=[],s=t.json.scene?t.json.scenes[t.json.scene]:t.json.scenes?t.json.scenes[0]:void 0,c=s?s.nodes:t.json.nodes;for(const u of c)a.push(i5(t.json.nodes[u],t,i));return function(u,d,p){const m={},_=new Set;for(let y=0;y<u.length;y++){const v=p[d[y]];if(!v.extras)continue;const b=v.extras["mapbox:footprint:version"],S=v.extras["mapbox:footprint:id"];(b||S)&&_.add(y),b==="1.0.0"&&S&&(m[S]=y)}for(let y=0;y<u.length;y++){if(_.has(y))continue;const v=u[y],b=p[d[y]];if(!b.extras)continue;let S=null;v.id in m&&(S=M9(u[m[v.id]].meshes)),S||(S=T9(b)),S&&(v.footprint=S9(S))}if(_.size>0){const y=Array.from(_.values()).sort((v,b)=>v-b);for(let v=y.length-1;v>=0;v--)u.splice(y[v],1)}}(a,c,t.json.nodes),a}function C9(t,e){const r={};r.indexArray=new Bn,r.indexArray.reserve(4*t.length),r.vertexArray=new Vs,r.vertexArray.reserve(10*t.length),r.colorArray=new Ns,r.vertexArray.reserve(10*t.length);let i=0;for(const c of t){const u=Math.min(10,Math.max(4,1.3*c.height))*e,d=[-c.normal[1],c.normal[0],0],p=Math.min(.29,.1*c.width/c.depth),m=c.width-2*c.depth*e*(p+.01),_=ie.scaleAndAdd([],c.pos,d,m/2),y=ie.scaleAndAdd([],c.pos,d,-m/2),v=[_[0],_[1],_[2]+c.height],b=[y[0],y[1],y[2]+c.height],S=ie.scaleAndAdd([],c.normal,d,p);ie.scale(S,S,u);const T=ie.scaleAndAdd([],c.normal,d,-p);ie.scale(T,T,u),ie.add(S,_,S),ie.add(T,y,T),_[2]+=.1,y[2]+=.1,r.vertexArray.emplaceBack(S[0],S[1],S[2]),r.vertexArray.emplaceBack(T[0],T[1],T[2]),r.vertexArray.emplaceBack(_[0],_[1],_[2]),r.vertexArray.emplaceBack(y[0],y[1],y[2]),r.vertexArray.emplaceBack(v[0],v[1],v[2]),r.vertexArray.emplaceBack(b[0],b[1],b[2]),r.vertexArray.emplaceBack(_[0],_[1],_[2]),r.vertexArray.emplaceBack(y[0],y[1],y[2]),r.vertexArray.emplaceBack(S[0],S[1],S[2]),r.vertexArray.emplaceBack(T[0],T[1],T[2]);const M=m/u/2;r.colorArray.emplaceBack(-M-p,-1,M,.8),r.colorArray.emplaceBack(M+p,-1,M,.8),r.colorArray.emplaceBack(-M,0,M,1.3),r.colorArray.emplaceBack(M,0,M,1.3),r.colorArray.emplaceBack(M+p,-.8,M,.7),r.colorArray.emplaceBack(M+p,-.8,M,.7),r.colorArray.emplaceBack(0,0,M,1.3),r.colorArray.emplaceBack(0,0,M,1.3),r.colorArray.emplaceBack(M+p,-1.2,M,.8),r.colorArray.emplaceBack(M+p,-1.2,M,.8),r.indexArray.emplaceBack(6+i,4+i,8+i),r.indexArray.emplaceBack(7+i,9+i,5+i),r.indexArray.emplaceBack(0+i,1+i,2+i),r.indexArray.emplaceBack(1+i,3+i,2+i),i+=10}const a={defined:!0,emissiveFactor:[0,0,0]},s={};return s.baseColorFactor=Zt.white,a.pbrMetallicRoughness=s,r.material=a,r.aabb=new _n([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),r}function A9(){return Dg.workerClass!=null?new Dg.workerClass:new w.Worker(Dg.workerUrl)}const dx="mapboxgl_preloaded_worker_pool";class ju{constructor(){this.active={}}acquire(e){if(!this.workers)for(this.workers=[];this.workers.length<ju.workerCount;)this.workers.push(new A9);return this.active[e]=!0,this.workers.slice()}release(e){delete this.active[e],this.numActive()===0&&(this.workers.forEach(r=>{r.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[dx]}numActive(){return Object.keys(this.active).length}}let tf;function rf(){return tf||(tf=new ju),tf}ju.workerCount=2;let nf,fx,px=null;const I9=D.LOADERS_URL;function o5(){return Be()&&self.worker&&self.worker.loadersUrl?self.worker.loadersUrl:fx||I9}async function a5(){if(nf&&await nf,typeof mapboxglLoaders>"u"){const e=o5();try{t=e,nf=Be()?(importScripts(t),new Promise(r=>r())):new Promise((r,i)=>{const a=document.createElement("script");a.src=t,a.onload=r,a.onerror=i,document.head.appendChild(a),a.src=t}),await nf}catch{re(`Could not load bundle from ${e}.`)}}var t;nf=void 0}async function s5(t){return await a5(),mapboxglLoaders.load(t,mapboxglLoaders.GLTFLoader,{gltf:{postProcess:!1,loadBuffers:!0,loadImages:!0}})}const mx={vector:e5,raster:ef,"raster-dem":class extends ef{constructor(t,e,r,i){super(t,e,r,i),this.type="raster-dem",this.maxzoom=22,this._options=Oe({type:"raster-dem"},e),this.encoding=e.encoding||"mapbox"}loadTile(t,e){const r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function i(a,s){a&&(t.state="errored",e(a)),s&&(t.dem=s,t.dem.onDeserialize(),t.needsHillshadePrepare=!0,t.needsDEMTextureUpload=!0,t.state="loaded",e(null))}t.request=rr(this.map._requestManager.transformRequest(r,be.Tile),(function(a,s,c,u){if(delete t.request,t.aborted)t.state="unloaded",e(null);else if(a)t.state="errored",e(a);else if(s){this.map._refreshExpiredTiles&&t.setExpiryData({cacheControl:c,expires:u});const p=w.ImageBitmap&&s instanceof w.ImageBitmap&&(ux==null&&(ux=w.OffscreenCanvas&&new w.OffscreenCanvas(1,1).getContext("2d")&&typeof w.createImageBitmap=="function"),ux),m=1-(s.width-((d=s.width)<=1?1:Math.pow(2,Math.floor(Math.log(d)/Math.LN2))))/2;m<1||t.neighboringTiles||(t.neighboringTiles=this._getNeighboringTiles(t.tileID));const _=p?s:Ot.getImageData(s,m),y={uid:t.uid,coord:t.tileID,source:this.id,scope:this.scope,rawImageData:_,encoding:this.encoding,padding:m};t.actor&&t.state!=="expired"||(t.actor=this.dispatcher.getActor(),t.actor.send("loadDEMTile",y,i.bind(this),void 0,!0))}var d}).bind(this))}_getNeighboringTiles(t){const e=t.canonical,r=Math.pow(2,e.z),i=(e.x-1+r)%r,a=e.x===0?t.wrap-1:t.wrap,s=(e.x+1+r)%r,c=e.x+1===r?t.wrap+1:t.wrap,u={};return u[new Kr(t.overscaledZ,a,e.z,i,e.y).key]={backfilled:!1},u[new Kr(t.overscaledZ,c,e.z,s,e.y).key]={backfilled:!1},e.y>0&&(u[new Kr(t.overscaledZ,a,e.z,i,e.y-1).key]={backfilled:!1},u[new Kr(t.overscaledZ,t.wrap,e.z,e.x,e.y-1).key]={backfilled:!1},u[new Kr(t.overscaledZ,c,e.z,s,e.y-1).key]={backfilled:!1}),e.y+1<r&&(u[new Kr(t.overscaledZ,a,e.z,i,e.y+1).key]={backfilled:!1},u[new Kr(t.overscaledZ,t.wrap,e.z,e.x,e.y+1).key]={backfilled:!1},u[new Kr(t.overscaledZ,c,e.z,s,e.y+1).key]={backfilled:!1}),u}unloadTile(t){t.demTexture&&this.map.painter.saveTileTexture(t.demTexture),t.fbo&&(t.fbo.destroy(),delete t.fbo),t.dem&&delete t.dem,delete t.neighboringTiles,t.state="unloaded"}},geojson:class extends dr{constructor(t,e,r,i){super(),this.id=t,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=r.getActor(),this.setEventedParent(i),this._data=e.data,this._options=Oe({},e),this._collectResourceTiming=e.collectResourceTiming,e.maxzoom!==void 0&&(this.maxzoom=e.maxzoom),e.type&&(this.type=e.type),e.attribution&&(this.attribution=e.attribution),this.promoteId=e.promoteId;const a=Ae/this.tileSize;this.workerOptions=Oe({source:this.id,scope:this.scope,cluster:e.cluster||!1,geojsonVtOptions:{buffer:(e.buffer!==void 0?e.buffer:128)*a,tolerance:(e.tolerance!==void 0?e.tolerance:.375)*a,extent:Ae,maxZoom:this.maxzoom,lineMetrics:e.lineMetrics||!1,generateId:e.generateId||!1},superclusterOptions:{maxZoom:e.clusterMaxZoom!==void 0?e.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,e.clusterMinPoints||2),extent:Ae,radius:(e.clusterRadius!==void 0?e.clusterRadius:50)*a,log:!1,generateId:e.generateId||!1},clusterProperties:e.clusterProperties,filter:e.filter},e.workerOptions)}onAdd(t){this.map=t,this.setData(this._data)}setData(t){return this._data=t,this._updateWorkerData(),this}getClusterExpansionZoom(t,e){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:t,source:this.id,scope:this.scope},e),this}getClusterChildren(t,e){return this.actor.send("geojson.getClusterChildren",{clusterId:t,source:this.id,scope:this.scope},e),this}getClusterLeaves(t,e,r,i){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:t,limit:e,offset:r},i),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new Ee("dataloading",{dataType:"source"})),this._loaded=!1;const t=Oe({},this.workerOptions);t.scope=this.scope;const e=this._data;typeof e=="string"?(t.request=this.map._requestManager.transformRequest(Ot.resolveURL(e),be.Source),t.request.collectResourceTiming=this._collectResourceTiming):t.data=JSON.stringify(e),this._pendingLoad=this.actor.send(`${this.type}.loadData`,t,(r,i)=>{if(this._loaded=!0,this._pendingLoad=null,r)this.fire(new rt(r));else{const a={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&i&&i.resourceTiming&&i.resourceTiming[this.id]&&(a.resourceTiming=i.resourceTiming[this.id]),this.fire(new Ee("data",a)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(t,e){const r=t.actor?"reloadTile":"loadTile";t.actor=this.actor;const i={type:this.type,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,scope:this.scope,pixelRatio:Ot.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0};t.request=this.actor.send(r,i,(a,s)=>(delete t.request,t.unloadVectorData(),t.aborted?e(null):a?e(a):(t.loadVectorData(s,this.map.painter,r==="reloadTile"),e(null))),void 0,r==="loadTile")}abortTile(t){t.request&&(t.request.cancel(),delete t.request),t.aborted=!0}unloadTile(t){t.unloadVectorData(),this.actor.send("removeTile",{uid:t.uid,type:this.type,source:this.id,scope:this.scope})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return Oe({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends sc{constructor(t,e,r,i){super(t,e,r,i),this.roundZoom=!0,this.type="video",this.options=e}load(){this._loaded=!1;const t=this.options;this.urls=[];for(const e of t.urls)this.urls.push(this.map._requestManager.transformRequest(e,be.Source).url);(function(e,r){const i=w.document.createElement("video");i.muted=!0,i.onloadstart=function(){r(null,i)};for(let a=0;a<e.length;a++){const s=w.document.createElement("source");Ze(e[a])||(i.crossOrigin="Anonymous"),s.src=e[a],i.appendChild(s)}})(this.urls,(e,r)=>{this._loaded=!0,e?this.fire(new rt(e)):r&&(this.video=r,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(t){if(this.video){const e=this.video.seekable;t<e.start(0)||t>e.end(0)?this.fire(new rt(new st(`sources.${this.id}`,null,`Playback for this video can be set only between the ${e.start(0)} and ${e.end(0)}-second mark.`))):this.video.currentTime=t}}getVideo(){return this.video}onAdd(t){this.map||(this.map=t,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const t=this.map.painter.context,e=t.gl;this.texture?this.video.paused||(this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE),e.texSubImage2D(e.TEXTURE_2D,0,0,0,e.RGBA,e.UNSIGNED_BYTE,this.video)):(this.texture=new Dn(t,this.video,e.RGBA),this.texture.bind(e.LINEAR,e.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(t)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:sc,model:class extends dr{constructor(t,e,r,i){super(),this.id=t,this.type="model",this.models=[],this._loaded=!1,this._options=e}async load(){for(const t in this._options.models){const e=this._options.models[t],r=hx(await s5(e.uri)),i=new fC(t,e.uri,e.position,e.orientation,r);i.computeBoundsAndApplyParent(),this.models.push(i)}this._loaded=!0,this.fire(new Ee("data",{dataType:"source",sourceDataType:"metadata"}))}onAdd(t){this.map=t,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(t,e){}serialize(){return{type:"model"}}},"batched-model":class extends dr{constructor(t,e,r,i){super(),this.type="batched-model",this.id=t,this.tileSize=512,this._options=e,this.tiles=this._options.tiles,this.maxzoom=e.maxzoom||19,this.minzoom=e.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=r,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(i)}onAdd(t){this.map=t,this.load()}load(t){this._loaded=!1,this.fire(new Ee("dataloading",{dataType:"source"}));const e=Array.isArray(this.map._language)?this.map._language.join():this.map._language,r=this.map._worldview;this._tileJSONRequest=lx(this._options,this.map._requestManager,e,r,(i,a)=>{this._tileJSONRequest=null,this._loaded=!0,i?(e&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${e}`),r&&r.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${r}`),this.fire(new rt(i))):a&&(Oe(this,a),a.bounds&&(this.tileBounds=new yg(a.bounds,this.minzoom,this.maxzoom)),$l(a.tiles,this.map._requestManager._customAccessToken),this.fire(new Ee("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Ee("data",{dataType:"source",sourceDataType:"content"}))),t&&t(i)})}hasTransition(){return!1}hasTile(t){return!this.tileBounds||this.tileBounds.contains(t.canonical)}loaded(){return this._loaded}loadTile(t,e){const r=this.map._requestManager.normalizeTileURL(t.tileID.canonical.url(this.tiles,this.scheme)),i={request:this.map._requestManager.transformRequest(r,be.Tile),data:void 0,uid:t.uid,tileID:t.tileID,tileZoom:t.tileZoom,zoom:t.tileID.overscaledZ,tileSize:this.tileSize*t.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:t.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0};if(t.actor&&t.state!=="expired")if(t.state==="loading")t.reloadCallback=e;else{if(t.buckets){const s=Object.values(t.buckets);for(const c of s)c.dirty=!0;return void(t.state="loaded")}t.request=t.actor.send("reloadTile",i,a.bind(this))}else t.actor=this.dispatcher.getActor(),t.request=t.actor.send("loadTile",i,a.bind(this),void 0,!0);function a(s,c){return t.aborted?e(null):s?e(s):(c&&(c.resourceTiming&&(t.resourceTiming=c.resourceTiming),this.map._refreshExpiredTiles&&t.setExpiryData(c),t.buckets={...t.buckets,...c.buckets}),t.state="loaded",void e(null))}}serialize(){return{type:"batched-model"}}},canvas:class extends sc{constructor(t,e,r,i){super(t,e,r,i),e.coordinates?Array.isArray(e.coordinates)&&e.coordinates.length===4&&!e.coordinates.some(a=>!Array.isArray(a)||a.length!==2||a.some(s=>typeof s!="number"))||this.fire(new rt(new st(`sources.${t}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new rt(new st(`sources.${t}`,null,'missing required property "coordinates"'))),e.animate&&typeof e.animate!="boolean"&&this.fire(new rt(new st(`sources.${t}`,null,'optional "animate" property must be a boolean value'))),e.canvas?typeof e.canvas=="string"||e.canvas instanceof w.HTMLCanvasElement||this.fire(new rt(new st(`sources.${t}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new rt(new st(`sources.${t}`,null,'missing required property "canvas"'))),this.options=e,this.animate=e.animate===void 0||e.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof w.HTMLCanvasElement?this.options.canvas:w.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new rt(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(t){this.map=t,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let t=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,t=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,t=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const e=this.map.painter.context;this.texture?(t||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new Dn(e,this.canvas,e.gl.RGBA,{premultiply:!0}),this._prepareData(e)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const t of[this.canvas.width,this.canvas.height])if(isNaN(t)||t<=0)return!0;return!1}},custom:class extends dr{constructor(t,e,r,i){super(),this.id=t,this.type="custom",this._dataType="raster",this._dispatcher=r,this._implementation=e,this.setEventedParent(i),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new rt(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new rt(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new yg(this._implementation.bounds,this.minzoom,this.maxzoom)),e.update=this._update.bind(this),e.clearTiles=this._clearTiles.bind(this),e.coveringTiles=this._coveringTiles.bind(this),Oe(this,qt(e,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return qt(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new Ee("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new Ee("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(t){this._map=t,this._loaded=!1,this.fire(new Ee("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(t),this.load()}onRemove(t){this._implementation.onRemove&&this._implementation.onRemove(t)}hasTile(t){if(this._implementation.hasTile){const{x:e,y:r,z:i}=t.canonical;return this._implementation.hasTile({x:e,y:r,z:i})}return!this.tileBounds||this.tileBounds.contains(t.canonical)}loadTile(t,e){const{x:r,y:i,z:a}=t.tileID.canonical,s=new w.AbortController;t.request=Promise.resolve(this._implementation.loadTile({x:r,y:i,z:a},{signal:s.signal})).then((function(c){return delete t.request,t.aborted?(t.state="unloaded",e(null)):c===void 0?(t.state="errored",e(null)):c===null?(this.loadTileData(t,{width:this.tileSize,height:this.tileSize,data:null}),t.state="loaded",e(null)):function(u){return u instanceof w.ImageData||u instanceof w.HTMLCanvasElement||u instanceof w.ImageBitmap||u instanceof w.HTMLImageElement}(c)?(this.loadTileData(t,c),t.state="loaded",void e(null)):(t.state="errored",e(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(c=>{c.code!==20&&(t.state="errored",e(c))}),t.request.cancel=()=>s.abort()}loadTileData(t,e){ef.loadTileData(t,e,this._map.painter)}unloadTileData(t){ef.unloadTileData(t,this._map.painter)}unloadTile(t,e){if(this.unloadTileData(t),this._implementation.unloadTile){const{x:r,y:i,z:a}=t.tileID.canonical;this._implementation.unloadTile({x:r,y:i,z:a})}e()}abortTile(t,e){t.request&&t.request.cancel&&(t.request.cancel(),delete t.request),e()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(t=>({x:t.canonical.x,y:t.canonical.y,z:t.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new Ee("data",{dataType:"source",sourceDataType:"content"}))}}},gx=function(t,e,r,i){const a=new mx[e.type](t,e,r,i);if(a.id!==t)throw new Error(`Expected Source id to be ${t} instead of ${a.id}`);return ar(["load","abort","unload","serialize","prepare"],a),a};function P9(t,e){const r=ge.identity([]);return ge.scale(r,r,[.5*t.width,.5*-t.height,1]),ge.translate(r,r,[1,-1,0]),ge.multiply(r,r,t.calculateProjMatrix(e.toUnwrapped())),Float32Array.from(r)}function k9(t,e,r,i,a,s,c,u=!1){const d=t.tilesIn(i,c,u);d.sort(l5);const p=[];for(const _ of d)p.push({wrappedTileID:_.tile.tileID.wrapped().key,queryResults:_.tile.queryRenderedFeatures(e,r,t._state,_,a,s,P9(t.transform,_.tile.tileID),u)});const m=function(_){const y={},v={};for(const b of _){const S=b.queryResults,T=b.wrappedTileID,M=v[T]=v[T]||{};for(const C in S){const P=S[C],k=M[C]=M[C]||{},z=y[C]=y[C]||[];for(const L of P)k[L.featureIndex]||(k[L.featureIndex]=!0,z.push(L))}}return y}(p);for(const _ in m)m[_].forEach(y=>{const v=y.feature,b=v.layer;b&&b.type!=="background"&&b.type!=="sky"&&b.type!=="slot"&&(v.source=b.source,b["source-layer"]&&(v.sourceLayer=b["source-layer"]),v.state=v.id!==void 0?t.getFeatureState(b["source-layer"],v.id):{})});return m}function R9(t,e){const r=t.getRenderableIds().map(s=>t.getTileByID(s)),i=[],a={};for(let s=0;s<r.length;s++){const c=r[s],u=c.tileID.canonical.key;a[u]||(a[u]=!0,c.querySourceFeatures(i,e))}return i}function l5(t,e){const r=t.tileID,i=e.tileID;return r.overscaledZ-i.overscaledZ||r.canonical.y-i.canonical.y||r.wrap-i.wrap||r.canonical.x-i.canonical.x}var c5=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function z9(t,e){const r={};for(const i in t)i!=="ref"&&(r[i]=t[i]);return c5.forEach(i=>{i in e&&(r[i]=e[i])}),r}function u5(t){t=t.slice();const e=Object.create(null);for(let r=0;r<t.length;r++)e[t[r].id]=t[r];for(let r=0;r<t.length;r++)"ref"in t[r]&&(t[r]=z9(t[r],e[t[r].ref]));return t}const Hr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection"};function h5(t,e,r){r.push({command:Hr.addSource,args:[t,e[t]]})}function d5(t,e,r){e.push({command:Hr.removeSource,args:[t]}),r[t]=!0}function D9(t,e,r,i){d5(t,r,i),h5(t,e,r)}function L9(t,e,r){let i;for(i in t[r])if(t[r].hasOwnProperty(i)&&i!=="data"&&!ue(t[r][i],e[r][i]))return!1;for(i in e[r])if(e[r].hasOwnProperty(i)&&i!=="data"&&!ue(t[r][i],e[r][i]))return!1;return!0}function vg(t,e,r,i,a,s){let c;for(c in e=e||{},t=t||{})t.hasOwnProperty(c)&&(ue(t[c],e[c])||r.push({command:s,args:[i,c,e[c],a]}));for(c in e)e.hasOwnProperty(c)&&!t.hasOwnProperty(c)&&(ue(t[c],e[c])||r.push({command:s,args:[i,c,e[c],a]}))}function f5(t){return t.id}function p5(t,e){return t[e.id]=e,t}class O9{constructor(e,r){this.reset(e,r)}reset(e,r){this.points=e||[],this._distances=[0];for(let i=1;i<this.points.length;i++)this._distances[i]=this._distances[i-1]+this.points[i].dist(this.points[i-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(r||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(e){if(this.points.length===1)return this.points[0];e=ze(e,0,1);let r=1,i=this._distances[r];const a=e*this.paddedLength+this.padding;for(;i<a&&r<this._distances.length;)i=this._distances[++r];const s=r-1,c=this._distances[s],u=i-c,d=u>0?(a-c)/u:0;return this.points[s].mult(1-d).add(this.points[r].mult(d))}}class m5{constructor(e,r,i){const a=this.boxCells=[],s=this.circleCells=[];this.xCellCount=Math.ceil(e/i),this.yCellCount=Math.ceil(r/i);for(let c=0;c<this.xCellCount*this.yCellCount;c++)a.push([]),s.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=e,this.height=r,this.xScale=this.xCellCount/e,this.yScale=this.yCellCount/r,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(e,r,i,a,s){this._forEachCell(r,i,a,s,this._insertBoxCell,this.boxUid++),this.boxKeys.push(e),this.bboxes.push(r),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(s)}insertCircle(e,r,i,a){this._forEachCell(r-a,i-a,r+a,i+a,this._insertCircleCell,this.circleUid++),this.circleKeys.push(e),this.circles.push(r),this.circles.push(i),this.circles.push(a)}_insertBoxCell(e,r,i,a,s,c){this.boxCells[s].push(c)}_insertCircleCell(e,r,i,a,s,c){this.circleCells[s].push(c)}_query(e,r,i,a,s,c){if(i<0||e>this.width||a<0||r>this.height)return!s&&[];const u=[];if(e<=0&&r<=0&&this.width<=i&&this.height<=a){if(s)return!0;for(let d=0;d<this.boxKeys.length;d++)u.push({key:this.boxKeys[d],x1:this.bboxes[4*d],y1:this.bboxes[4*d+1],x2:this.bboxes[4*d+2],y2:this.bboxes[4*d+3]});for(let d=0;d<this.circleKeys.length;d++){const p=this.circles[3*d],m=this.circles[3*d+1],_=this.circles[3*d+2];u.push({key:this.circleKeys[d],x1:p-_,y1:m-_,x2:p+_,y2:m+_})}return c?u.filter(c):u}return this._forEachCell(e,r,i,a,this._queryCell,u,{hitTest:s,seenUids:{box:{},circle:{}}},c),s?u.length>0:u}_queryCircle(e,r,i,a,s){const c=e-i,u=e+i,d=r-i,p=r+i;if(u<0||c>this.width||p<0||d>this.height)return!a&&[];const m=[];return this._forEachCell(c,d,u,p,this._queryCellCircle,m,{hitTest:a,circle:{x:e,y:r,radius:i},seenUids:{box:{},circle:{}}},s),a?m.length>0:m}query(e,r,i,a,s){return this._query(e,r,i,a,!1,s)}hitTest(e,r,i,a,s){return this._query(e,r,i,a,!0,s)}hitTestCircle(e,r,i,a){return this._queryCircle(e,r,i,!0,a)}_queryCell(e,r,i,a,s,c,u,d){const p=u.seenUids,m=this.boxCells[s];if(m!==null){const y=this.bboxes;for(const v of m)if(!p.box[v]){p.box[v]=!0;const b=4*v;if(e<=y[b+2]&&r<=y[b+3]&&i>=y[b+0]&&a>=y[b+1]&&(!d||d(this.boxKeys[v]))){if(u.hitTest)return c.push(!0),!0;c.push({key:this.boxKeys[v],x1:y[b],y1:y[b+1],x2:y[b+2],y2:y[b+3]})}}}const _=this.circleCells[s];if(_!==null){const y=this.circles;for(const v of _)if(!p.circle[v]){p.circle[v]=!0;const b=3*v;if(this._circleAndRectCollide(y[b],y[b+1],y[b+2],e,r,i,a)&&(!d||d(this.circleKeys[v]))){if(u.hitTest)return c.push(!0),!0;{const S=y[b],T=y[b+1],M=y[b+2];c.push({key:this.circleKeys[v],x1:S-M,y1:T-M,x2:S+M,y2:T+M})}}}}}_queryCellCircle(e,r,i,a,s,c,u,d){const p=u.circle,m=u.seenUids,_=this.boxCells[s];if(_!==null){const v=this.bboxes;for(const b of _)if(!m.box[b]){m.box[b]=!0;const S=4*b;if(this._circleAndRectCollide(p.x,p.y,p.radius,v[S+0],v[S+1],v[S+2],v[S+3])&&(!d||d(this.boxKeys[b])))return c.push(!0),!0}}const y=this.circleCells[s];if(y!==null){const v=this.circles;for(const b of y)if(!m.circle[b]){m.circle[b]=!0;const S=3*b;if(this._circlesCollide(v[S],v[S+1],v[S+2],p.x,p.y,p.radius)&&(!d||d(this.circleKeys[b])))return c.push(!0),!0}}}_forEachCell(e,r,i,a,s,c,u,d){const p=this._convertToXCellCoord(e),m=this._convertToYCellCoord(r),_=this._convertToXCellCoord(i),y=this._convertToYCellCoord(a);for(let v=p;v<=_;v++)for(let b=m;b<=y;b++)if(s.call(this,e,r,i,a,this.xCellCount*b+v,c,u,d))return}_convertToXCellCoord(e){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(e*this.xScale)))}_convertToYCellCoord(e){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(e*this.yScale)))}_circlesCollide(e,r,i,a,s,c){const u=a-e,d=s-r,p=i+c;return p*p>u*u+d*d}_circleAndRectCollide(e,r,i,a,s,c,u){const d=(c-a)/2,p=Math.abs(e-(a+d));if(p>d+i)return!1;const m=(u-s)/2,_=Math.abs(r-(s+m));if(_>m+i)return!1;if(p<=d||_<=m)return!0;const y=p-d,v=_-m;return y*y+v*v<=i*i}}const Da=100;class F9{constructor(e,r,i=new m5(e.width+200,e.height+200,25),a=new m5(e.width+200,e.height+200,25)){this.transform=e,this.grid=i,this.ignoredGrid=a,this.pitchfactor=Math.cos(e._pitch)*e.cameraToCenterDistance,this.screenRightBoundary=e.width+Da,this.screenBottomBoundary=e.height+Da,this.gridRightBoundary=e.width+200,this.gridBottomBoundary=e.height+200,this.fogState=r}placeCollisionBox(e,r,i,a,s,c,u,d){let p=i.projectedAnchorX,m=i.projectedAnchorY,_=i.projectedAnchorZ;const y=i.elevation,v=i.tileID,b=e.getProjection();if(y&&v){const[L,B,W]=b.upVector(v.canonical,i.tileAnchorX,i.tileAnchorY),Z=b.upVectorScale(v.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;p+=L*y*Z,m+=B*y*Z,_+=W*y*Z}const S=this.projectAndGetPerspectiveRatio(u,p,m,_,i.tileID,b.name==="globe"||!!y||this.transform.pitch>0,b),T=c*S.perspectiveRatio,M=(i.x1*r+a.x-i.padding)*T+S.point.x,C=(i.y1*r+a.y-i.padding)*T+S.point.y,P=(i.x2*r+a.x+i.padding)*T+S.point.x,k=(i.y2*r+a.y+i.padding)*T+S.point.y,z=S.perspectiveRatio<=.55||S.occluded;return!this.isInsideGrid(M,C,P,k)||!s&&this.grid.hitTest(M,C,P,k,d)||z?{box:[],offscreen:!1,occluded:S.occluded}:{box:[M,C,P,k],offscreen:this.isOffscreen(M,C,P,k),occluded:!1}}placeCollisionCircles(e,r,i,a,s,c,u,d,p,m,_,y,v,b,S){const T=[],M=this.transform.elevation,C=e.getProjection(),P=M?M.getAtTileOffsetFunc(S,this.transform.center.lat,this.transform.worldSize,C):null,k=new $(i.tileAnchorX,i.tileAnchorY);let{x:z,y:L,z:B}=C.projectTilePoint(k.x,k.y,S.canonical);if(P){const[_e,oe,me]=P(k);z+=_e,L+=oe,B+=me}const W=C.name==="globe",Z=this.projectAndGetPerspectiveRatio(u,z,L,B,S,W||!!M||this.transform.pitch>0,C),{perspectiveRatio:X}=Z,H=(_?c/X:c*X)/Xn,J=ia(z,L,B,d),Q=Z.signedDistanceFromCamera>0?nC(H,s,i.lineOffsetX*H,i.lineOffsetY*H,!1,J,k,i,a,d,{},M&&!_?P:null,_&&!!M,C,S,_):null;let K=!1,fe=!1,he=!0;if(Q&&!Z.occluded){const _e=.5*v*X+b,oe=new $(-100,-100),me=new $(this.screenRightBoundary,this.screenBottomBoundary),ve=new O9,{first:Ce,last:Se}=Q,Je=Ce.path.length;let Ge=[];for(let nt=Je-1;nt>=1;nt--)Ge.push(Ce.path[nt]);for(let nt=1;nt<Se.path.length;nt++)Ge.push(Se.path[nt]);const je=2.5*_e;p&&(Ge=Ge.map(([nt,wt,pt],dt)=>(P&&!W&&(pt=P(dt<Je-1?Ce.tilePath[Je-1-dt]:Se.tilePath[dt-Je+2])[2]),ia(nt,wt,pt,p))),Ge.some(nt=>nt[3]<=0)&&(Ge=[]));let Ve=[];if(Ge.length>0){let nt=1/0,wt=-1/0,pt=1/0,dt=-1/0;for(const Et of Ge)nt=Math.min(nt,Et[0]),pt=Math.min(pt,Et[1]),wt=Math.max(wt,Et[0]),dt=Math.max(dt,Et[1]);wt>=oe.x&&nt<=me.x&&dt>=oe.y&&pt<=me.y&&(Ve=[Ge.map(Et=>new $(Et[0],Et[1]))],(nt<oe.x||wt>me.x||pt<oe.y||dt>me.y)&&(Ve=MM(Ve,oe.x,oe.y,me.x,me.y)))}for(const nt of Ve){ve.reset(nt,.25*_e);let wt=0;wt=ve.length<=.5*_e?1:Math.ceil(ve.paddedLength/je)+1;for(let pt=0;pt<wt;pt++){const dt=pt/Math.max(wt-1,1),Et=ve.lerp(dt),nr=Et.x+Da,er=Et.y+Da;T.push(nr,er,_e,0);const Rr=nr-_e,tr=er-_e,ir=nr+_e,Dt=er+_e;if(he=he&&this.isOffscreen(Rr,tr,ir,Dt),fe=fe||this.isInsideGrid(Rr,tr,ir,Dt),!r&&this.grid.hitTestCircle(nr,er,_e,y)&&(K=!0,!m))return{circles:[],offscreen:!1,collisionDetected:K,occluded:!1}}}}return{circles:!m&&K||!fe?[]:T,offscreen:he,collisionDetected:K,occluded:Z.occluded}}queryRenderedSymbols(e){if(e.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const r=[];let i=1/0,a=1/0,s=-1/0,c=-1/0;for(const m of e){const _=new $(m.x+Da,m.y+Da);i=Math.min(i,_.x),a=Math.min(a,_.y),s=Math.max(s,_.x),c=Math.max(c,_.y),r.push(_)}const u=this.grid.query(i,a,s,c).concat(this.ignoredGrid.query(i,a,s,c)),d={},p={};for(const m of u){const _=m.key;d[_.bucketInstanceId]===void 0&&(d[_.bucketInstanceId]={}),d[_.bucketInstanceId][_.featureIndex]||PT(r,[new $(m.x1,m.y1),new $(m.x2,m.y1),new $(m.x2,m.y2),new $(m.x1,m.y2)])&&(d[_.bucketInstanceId][_.featureIndex]=!0,p[_.bucketInstanceId]===void 0&&(p[_.bucketInstanceId]=[]),p[_.bucketInstanceId].push(_.featureIndex))}return p}insertCollisionBox(e,r,i,a,s){(r?this.ignoredGrid:this.grid).insert({bucketInstanceId:i,featureIndex:a,collisionGroupID:s},e[0],e[1],e[2],e[3])}insertCollisionCircles(e,r,i,a,s){const c=r?this.ignoredGrid:this.grid,u={bucketInstanceId:i,featureIndex:a,collisionGroupID:s};for(let d=0;d<e.length;d+=4)c.insertCircle(u,e[d],e[d+1],e[d+2])}projectAndGetPerspectiveRatio(e,r,i,a,s,c,u){const d=[r,i,a,1];let p=!1;a||this.transform.pitch>0?(Wr.transformMat4(d,d,e),this.fogState&&s&&u.name!=="globe"&&(p=function(y,v,b,S,T,M){const C=M.calculateFogTileMatrix(T),P=[v,b,S];return ie.transformMat4(P,P,C),GC(y,P,M.pitch,M._fov)}(this.fogState,r,i,a,s.toUnwrapped(),this.transform)>.9)):lC(d,d,e);const m=d[3];return{point:new $((d[0]/m+1)/2*this.transform.width+Da,(-d[1]/m+1)/2*this.transform.height+Da),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(u)/m*.5,1.5),signedDistanceFromCamera:m,occluded:c&&d[2]>m||p}}isOffscreen(e,r,i,a){return i<Da||e>=this.screenRightBoundary||a<Da||r>this.screenBottomBoundary}isInsideGrid(e,r,i,a){return i>=0&&e<this.gridRightBoundary&&a>=0&&r<this.gridBottomBoundary}getViewportMatrix(){const e=ge.identity([]);return ge.translate(e,e,[-100,-100,0]),e}}function _x(t,e,r){const i=e.createTileMatrix(t,t.worldSize,r.toUnwrapped());return ge.multiply(new Float32Array(16),t.projMatrix,i)}function B9(t,e,r){if(e.projection.name===r.projection.name)return t.projMatrix;const i=r.clone();return i.setProjection(e.projection),_x(i,e.getProjection(),t)}function yx(t,e,r){return e.name===r.projection.name?t.projMatrix:_x(r,e,t)}class g5{constructor(e,r,i,a){this.opacity=e?Math.max(0,Math.min(1,e.opacity+(e.placed?r:-r))):a&&i?1:0,this.placed=i}isHidden(){return this.opacity===0&&!this.placed}}class of{constructor(e,r,i,a,s,c=!1){this.text=new g5(e?e.text:null,r,i,s),this.icon=new g5(e?e.icon:null,r,a,s),this.clipped=c}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class vx{constructor(e,r,i,a=!1){this.text=e,this.icon=r,this.skipFade=i,this.clipped=a}}class N9{constructor(){this.invProjMatrix=ge.create(),this.viewportMatrix=ge.create(),this.circles=[]}}class j9{constructor(e,r,i,a,s){this.bucketInstanceId=e,this.featureIndex=r,this.sourceLayerIndex=i,this.bucketIndex=a,this.tileID=s}}class $9{constructor(e){this.crossSourceCollisions=e,this.maxGroupID=0,this.collisionGroups={}}get(e){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[e]){const r=++this.maxGroupID;this.collisionGroups[e]={ID:r,predicate:i=>i.collisionGroupID===r}}return this.collisionGroups[e]}}function _5(t,e,r,i,a){const{horizontalAlign:s,verticalAlign:c}=Wm(t),u=-(s-.5)*e,d=-(c-.5)*r,p=Uv(t,i);return new $(u+p[0]*a,d+p[1]*a)}function xx(t,e,r,i,a){const s=new $(t,e);return r&&s._rotate(i?a:-a),s}class V9{constructor(e,r,i,a,s){this.transform=e.clone(),this.projection=e.projection.name,this.collisionIndex=new F9(this.transform,s),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=r,this.retainedQueryData={},this.collisionGroups=new $9(i),this.collisionCircleArrays={},this.prevPlacement=a,a&&(a.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(e,r,i,a){const s=i.getBucket(r),c=i.latestFeatureIndex;if(!s||!c||r.id!==s.layerIds[0])return;const u=s.layers[0].layout,d=i.collisionBoxArray,p=Math.pow(2,this.transform.zoom-i.tileID.overscaledZ),m=i.tileSize/Ae,_=i.tileID.toUnwrapped();this.transform.setProjection(s.projection);const y=(v=i.tileID,b=s.getProjection(),S=this.transform,b.name===this.projection?S.calculateProjMatrix(v.toUnwrapped()):_x(S,b,v));var v,b,S;const T=u.get("text-pitch-alignment")==="map",M=u.get("text-rotation-alignment")==="map";r.compileFilter();const C=r.dynamicFilter(),P=r.dynamicFilterNeedsFeature(),k=this.transform.calculatePixelsToTileUnitsMatrix(i),z=eC(y,i.tileID.canonical,T,M,this.transform,s.getProjection(),k);let L=null;if(T){const Z=tC(y,i.tileID.canonical,T,M,this.transform,s.getProjection(),k);L=ge.multiply([],this.transform.labelPlaneMatrix,Z)}let B=null;C&&i.latestFeatureIndex&&(B={unwrappedTileID:_,dynamicFilter:C,dynamicFilterNeedsFeature:P,featureIndex:i.latestFeatureIndex}),this.retainedQueryData[s.bucketInstanceId]=new j9(s.bucketInstanceId,c,s.sourceLayerIndex,s.index,i.tileID);const W={bucket:s,layout:u,posMatrix:y,textLabelPlaneMatrix:z,labelToScreenMatrix:L,clippingData:B,scale:p,textPixelRatio:m,holdingForFade:i.holdingForFade(),collisionBoxArray:d,partiallyEvaluatedTextSize:ka(s.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:ka(s.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(s.sourceID)};if(a)for(const Z of s.sortKeyRanges){const{sortKey:X,symbolInstanceStart:H,symbolInstanceEnd:J}=Z;e.push({sortKey:X,symbolInstanceStart:H,symbolInstanceEnd:J,parameters:W})}else e.push({symbolInstanceStart:0,symbolInstanceEnd:s.symbolInstances.length,parameters:W})}attemptAnchorPlacement(e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T,M,C){const{textOffset0:P,textOffset1:k,crossTileID:z}=y,L=[P,k],B=_5(e,i,a,L,s),W=this.collisionIndex.placeCollisionBox(b,s,r,xx(B.x,B.y,c,u,this.transform.angle),_,d,p,m.predicate);if(T){const Z=b.getSymbolInstanceIconSize(C,this.transform.zoom,y.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(b,Z,T,xx(B.x,B.y,c,u,this.transform.angle),_,d,p,m.predicate).box.length===0)return}if(W.box.length>0){let Z;return this.prevPlacement&&this.prevPlacement.variableOffsets[z]&&this.prevPlacement.placements[z]&&this.prevPlacement.placements[z].text&&(Z=this.prevPlacement.variableOffsets[z].anchor),this.variableOffsets[z]={textOffset:L,width:i,height:a,anchor:e,textScale:s,prevAnchor:Z},this.markUsedJustification(b,e,y,S),b.allowVerticalPlacement&&(this.markUsedOrientation(b,S,y),this.placedOrientations[z]=S),{shift:B,placedGlyphBoxes:W}}}placeLayerBucketPart(e,r,i,a){const{bucket:s,layout:c,posMatrix:u,textLabelPlaneMatrix:d,labelToScreenMatrix:p,clippingData:m,textPixelRatio:_,holdingForFade:y,collisionBoxArray:v,partiallyEvaluatedTextSize:b,partiallyEvaluatedIconSize:S,collisionGroup:T}=e.parameters,M=c.get("text-optional"),C=c.get("icon-optional"),P=c.get("text-allow-overlap"),k=c.get("icon-allow-overlap"),z=c.get("text-rotation-alignment")==="map",L=c.get("text-pitch-alignment")==="map",B=c.get("symbol-z-order")==="viewport-y";this.transform.setProjection(s.projection);let W=P&&(k||!s.hasIconData()||C),Z=k&&(P||!s.hasTextData()||M);!s.collisionArrays&&v&&s.deserializeCollisionBoxes(v),i&&a&&s.updateCollisionDebugBuffers(this.transform.zoom,v);const X=(H,J,Q)=>{const{crossTileID:K,numVerticalGlyphVertices:fe}=H;if(m){const tr={zoom:this.transform.zoom,pitch:this.transform.pitch};let ir=null;if(m.dynamicFilterNeedsFeature){const Dt=this.retainedQueryData[s.bucketInstanceId];ir=m.featureIndex.loadFeature({featureIndex:H.featureIndex,bucketIndex:Dt.bucketIndex,sourceLayerIndex:Dt.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,m.dynamicFilter)(tr,ir,this.retainedQueryData[s.bucketInstanceId].tileID.canonical,new $(H.tileAnchorX,H.tileAnchorY),this.transform.calculateDistanceTileData(m.unwrappedTileID)))return this.placements[K]=new vx(!1,!1,!1,!0),void r.add(K)}if(r.has(K))return;if(y)return void(this.placements[K]=new vx(!1,!1,!1));let he=!1,_e=!1,oe=!0,me=!1,ve=!1,Ce=null,Se={box:null,offscreen:null,occluded:null},Je={box:null,offscreen:null,occluded:null},Ge=null,je=null,Ve=null,nt=0,wt=0,pt=0;Q.textFeatureIndex?nt=Q.textFeatureIndex:H.useRuntimeCollisionCircles&&(nt=H.featureIndex),Q.verticalTextFeatureIndex&&(wt=Q.verticalTextFeatureIndex);const dt=tr=>{tr.tileID=this.retainedQueryData[s.bucketInstanceId].tileID;const ir=this.transform.elevation;(ir||tr.elevation)&&(tr.elevation=ir?ir.getAtTileOffset(tr.tileID,tr.tileAnchorX,tr.tileAnchorY):0)},Et=Q.textBox;if(Et){dt(Et);const tr=Dt=>{let Yt=sn.horizontal;if(s.allowVerticalPlacement&&!Dt&&this.prevPlacement){const zr=this.prevPlacement.placedOrientations[K];zr&&(this.placedOrientations[K]=zr,Yt=zr,this.markUsedOrientation(s,Yt,H))}return Yt},ir=(Dt,Yt)=>{if(s.allowVerticalPlacement&&fe>0&&Q.verticalTextBox){for(const zr of s.writingModes)if(zr===sn.vertical?(Se=Yt(),Je=Se):Se=Dt(),Se&&Se.box&&Se.box.length)break}else Se=Dt()};if(c.get("text-variable-anchor")){let Dt=c.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[K]){const Kt=this.prevPlacement.variableOffsets[K];Dt.indexOf(Kt.anchor)>0&&(Dt=Dt.filter(Or=>Or!==Kt.anchor),Dt.unshift(Kt.anchor))}const Yt=(Kt,Or,Tn)=>{const Mn=s.getSymbolInstanceTextSize(b,H,this.transform.zoom,J),dn=(Kt.x2-Kt.x1)*Mn+2*Kt.padding,rn=(Kt.y2-Kt.y1)*Mn+2*Kt.padding,Ln=H.hasIconTextFit&&!k?Or:null;Ln&&dt(Ln);let cn={box:[],offscreen:!1,occluded:!1};const jn=P?2*Dt.length:Dt.length;for(let Fr=0;Fr<jn;++Fr){const Ri=this.attemptAnchorPlacement(Dt[Fr%Dt.length],Kt,dn,rn,Mn,z,L,_,u,T,Fr>=Dt.length,H,J,s,Tn,Ln,b,S);if(Ri&&(cn=Ri.placedGlyphBoxes,cn&&cn.box&&cn.box.length)){he=!0,Ce=Ri.shift;break}}return cn};ir(()=>Yt(Et,Q.iconBox,sn.horizontal),()=>{const Kt=Q.verticalTextBox;return Kt&&dt(Kt),s.allowVerticalPlacement&&!(Se&&Se.box&&Se.box.length)&&fe>0&&Kt?Yt(Kt,Q.verticalIconBox,sn.vertical):{box:null,offscreen:null,occluded:null}}),Se&&(he=Se.box,oe=Se.offscreen,me=Se.occluded);const zr=tr(!(!Se||!Se.box));if(!he&&this.prevPlacement){const Kt=this.prevPlacement.variableOffsets[K];Kt&&(this.variableOffsets[K]=Kt,this.markUsedJustification(s,Kt.anchor,H,zr))}}else{const Dt=(Yt,zr)=>{const Kt=s.getSymbolInstanceTextSize(b,H,this.transform.zoom,J),Or=this.collisionIndex.placeCollisionBox(s,Kt,Yt,new $(0,0),P,_,u,T.predicate);return Or&&Or.box&&Or.box.length&&(this.markUsedOrientation(s,zr,H),this.placedOrientations[K]=zr),Or};ir(()=>Dt(Et,sn.horizontal),()=>{const Yt=Q.verticalTextBox;return s.allowVerticalPlacement&&fe>0&&Yt?(dt(Yt),Dt(Yt,sn.vertical)):{box:null,offscreen:null,occluded:null}}),tr(!!(Se&&Se.box&&Se.box.length))}}if(Ge=Se,he=Ge&&Ge.box&&Ge.box.length>0,oe=Ge&&Ge.offscreen,me=Ge&&Ge.occluded,H.useRuntimeCollisionCircles){const tr=s.text.placedSymbolArray.get(H.centerJustifiedTextSymbolIndex>=0?H.centerJustifiedTextSymbolIndex:H.verticalPlacedTextSymbolIndex),ir=Ld(s.textSizeData,b,tr),Dt=c.get("text-padding");je=this.collisionIndex.placeCollisionCircles(s,P,tr,s.lineVertexArray,s.glyphOffsetArray,ir,u,d,p,i,L,T.predicate,H.collisionCircleDiameter*ir/Xn,Dt,this.retainedQueryData[s.bucketInstanceId].tileID),he=P||je.circles.length>0&&!je.collisionDetected,oe=oe&&je.offscreen,me=je.occluded}if(Q.iconFeatureIndex&&(pt=Q.iconFeatureIndex),Q.iconBox){const tr=ir=>{dt(ir);const Dt=H.hasIconTextFit&&Ce?xx(Ce.x,Ce.y,z,L,this.transform.angle):new $(0,0),Yt=s.getSymbolInstanceIconSize(S,this.transform.zoom,H.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(s,Yt,ir,Dt,k,_,u,T.predicate)};Je&&Je.box&&Je.box.length&&Q.verticalIconBox?(Ve=tr(Q.verticalIconBox),_e=Ve.box.length>0):(Ve=tr(Q.iconBox),_e=Ve.box.length>0),oe=oe&&Ve.offscreen,ve=Ve.occluded}const nr=M||H.numHorizontalGlyphVertices===0&&fe===0,er=C||H.numIconVertices===0;if(nr||er?er?nr||(_e=_e&&he):he=_e&&he:_e=he=_e&&he,he&&Ge&&Ge.box&&this.collisionIndex.insertCollisionBox(Ge.box,c.get("text-ignore-placement"),s.bucketInstanceId,Je&&Je.box&&wt?wt:nt,T.ID),_e&&Ve&&this.collisionIndex.insertCollisionBox(Ve.box,c.get("icon-ignore-placement"),s.bucketInstanceId,pt,T.ID),je&&(he&&this.collisionIndex.insertCollisionCircles(je.circles,c.get("text-ignore-placement"),s.bucketInstanceId,nt,T.ID),i)){const tr=s.bucketInstanceId;let ir=this.collisionCircleArrays[tr];ir===void 0&&(ir=this.collisionCircleArrays[tr]=new N9);for(let Dt=0;Dt<je.circles.length;Dt+=4)ir.circles.push(je.circles[Dt+0]),ir.circles.push(je.circles[Dt+1]),ir.circles.push(je.circles[Dt+2]),ir.circles.push(je.collisionDetected?1:0)}const Rr=s.projection.name!=="globe";W=W&&(Rr||!me),Z=Z&&(Rr||!ve),this.placements[K]=new vx(he||W,_e||Z,oe||s.justReloaded),r.add(K)};if(B){const H=s.getSortedSymbolIndexes(this.transform.angle);for(let J=H.length-1;J>=0;--J){const Q=H[J];X(s.symbolInstances.get(Q),Q,s.collisionArrays[Q])}}else for(let H=e.symbolInstanceStart;H<e.symbolInstanceEnd;H++)X(s.symbolInstances.get(H),H,s.collisionArrays[H]);if(i&&s.bucketInstanceId in this.collisionCircleArrays){const H=this.collisionCircleArrays[s.bucketInstanceId];ge.invert(H.invProjMatrix,u),H.viewportMatrix=this.collisionIndex.getViewportMatrix()}s.justReloaded=!1}markUsedJustification(e,r,i,a){const{leftJustifiedTextSymbolIndex:s,centerJustifiedTextSymbolIndex:c,rightJustifiedTextSymbolIndex:u,verticalPlacedTextSymbolIndex:d,crossTileID:p}=i,m=Gv(r),_=a===sn.vertical?d:m==="left"?s:m==="center"?c:m==="right"?u:-1;s>=0&&(e.text.placedSymbolArray.get(s).crossTileID=_>=0&&s!==_?0:p),c>=0&&(e.text.placedSymbolArray.get(c).crossTileID=_>=0&&c!==_?0:p),u>=0&&(e.text.placedSymbolArray.get(u).crossTileID=_>=0&&u!==_?0:p),d>=0&&(e.text.placedSymbolArray.get(d).crossTileID=_>=0&&d!==_?0:p)}markUsedOrientation(e,r,i){const a=r===sn.horizontal||r===sn.horizontalOnly?r:0,s=r===sn.vertical?r:0,{leftJustifiedTextSymbolIndex:c,centerJustifiedTextSymbolIndex:u,rightJustifiedTextSymbolIndex:d,verticalPlacedTextSymbolIndex:p}=i,m=e.text.placedSymbolArray;c>=0&&(m.get(c).placedOrientation=a),u>=0&&(m.get(u).placedOrientation=a),d>=0&&(m.get(d).placedOrientation=a),p>=0&&(m.get(p).placedOrientation=s)}commit(e){this.commitTime=e,this.zoomAtLastRecencyCheck=this.transform.zoom;const r=this.prevPlacement;let i=!1;this.prevZoomAdjustment=r?r.zoomAdjustment(this.transform.zoom):0;const a=r?r.symbolFadeChange(e):1,s=r?r.opacities:{},c=r?r.variableOffsets:{},u=r?r.placedOrientations:{};for(const d in this.placements){const p=this.placements[d],m=s[d];m?(this.opacities[d]=new of(m,a,p.text,p.icon,null,p.clipped),i=i||p.text!==m.text.placed||p.icon!==m.icon.placed):(this.opacities[d]=new of(null,a,p.text,p.icon,p.skipFade,p.clipped),i=i||p.text||p.icon)}for(const d in s){const p=s[d];if(!this.opacities[d]){const m=new of(p,a,!1,!1);m.isHidden()||(this.opacities[d]=m,i=i||p.text.placed||p.icon.placed)}}for(const d in c)this.variableOffsets[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.variableOffsets[d]=c[d]);for(const d in u)this.placedOrientations[d]||!this.opacities[d]||this.opacities[d].isHidden()||(this.placedOrientations[d]=u[d]);i?this.lastPlacementChangeTime=e:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=r?r.lastPlacementChangeTime:e)}updateLayerOpacities(e,r){const i=new Set;for(const a of r){const s=a.getBucket(e);s&&a.latestFeatureIndex&&e.id===s.layerIds[0]&&this.updateBucketOpacities(s,i,a.collisionBoxArray)}}updateBucketOpacities(e,r,i){e.hasTextData()&&e.text.opacityVertexArray.clear(),e.hasIconData()&&e.icon.opacityVertexArray.clear(),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexArray.clear(),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexArray.clear();const a=e.layers[0].layout,s=!!e.layers[0].dynamicFilter(),c=new of(null,0,!1,!1,!0),u=a.get("text-allow-overlap"),d=a.get("icon-allow-overlap"),p=a.get("text-variable-anchor"),m=a.get("text-rotation-alignment")==="map",_=a.get("text-pitch-alignment")==="map",y=new of(null,0,u&&(d||!e.hasIconData()||a.get("icon-optional")),d&&(u||!e.hasTextData()||a.get("text-optional")),!0);!e.collisionArrays&&i&&(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData())&&e.deserializeCollisionBoxes(i);const v=(S,T,M)=>{for(let C=0;C<T/4;C++)S.opacityVertexArray.emplaceBack(M)};let b=0;for(let S=0;S<e.symbolInstances.length;S++){const T=e.symbolInstances.get(S),{numHorizontalGlyphVertices:M,numVerticalGlyphVertices:C,crossTileID:P,numIconVertices:k}=T,z=r.has(P);let L=this.opacities[P];z?L=c:L||(L=y,this.opacities[P]=L),r.add(P);const B=M>0||C>0,W=k>0,Z=this.placedOrientations[P],X=Z===sn.vertical,H=Z===sn.horizontal||Z===sn.horizontalOnly;if(!B&&!W||L.isHidden()||b++,B){const J=y5(L.text);v(e.text,M,X?bg:J),v(e.text,C,H?bg:J);const Q=L.text.isHidden(),{leftJustifiedTextSymbolIndex:K,centerJustifiedTextSymbolIndex:fe,rightJustifiedTextSymbolIndex:he,verticalPlacedTextSymbolIndex:_e}=T,oe=e.text.placedSymbolArray,me=Q||X?1:0;K>=0&&(oe.get(K).hidden=me),fe>=0&&(oe.get(fe).hidden=me),he>=0&&(oe.get(he).hidden=me),_e>=0&&(oe.get(_e).hidden=Q||H?1:0);const ve=this.variableOffsets[P];ve&&this.markUsedJustification(e,ve.anchor,T,Z);const Ce=this.placedOrientations[P];Ce&&(this.markUsedJustification(e,"left",T,Ce),this.markUsedOrientation(e,Ce,T))}if(W){const J=y5(L.icon),{placedIconSymbolIndex:Q,verticalPlacedIconSymbolIndex:K}=T,fe=e.icon.placedSymbolArray,he=L.icon.isHidden()?1:0;Q>=0&&(v(e.icon,k,X?bg:J),fe.get(Q).hidden=he),K>=0&&(v(e.icon,T.numVerticalIconVertices,H?bg:J),fe.get(K).hidden=he)}if(e.hasIconCollisionBoxData()||e.hasTextCollisionBoxData()){const J=e.collisionArrays[S];if(J){let Q=new $(0,0),K=!0;if(J.textBox||J.verticalTextBox){if(p){const he=this.variableOffsets[P];he?(Q=_5(he.anchor,he.width,he.height,he.textOffset,he.textScale),m&&Q._rotate(_?this.transform.angle:-this.transform.angle)):K=!1}s&&(K=!L.clipped),J.textBox&&xg(e.textCollisionBox.collisionVertexArray,L.text.placed,!K||X,Q.x,Q.y),J.verticalTextBox&&xg(e.textCollisionBox.collisionVertexArray,L.text.placed,!K||H,Q.x,Q.y)}const fe=K&&!!(!H&&J.verticalIconBox);J.iconBox&&xg(e.iconCollisionBox.collisionVertexArray,L.icon.placed,fe,T.hasIconTextFit?Q.x:0,T.hasIconTextFit?Q.y:0),J.verticalIconBox&&xg(e.iconCollisionBox.collisionVertexArray,L.icon.placed,!fe,T.hasIconTextFit?Q.x:0,T.hasIconTextFit?Q.y:0)}}}if(e.fullyClipped=b===0,e.sortFeatures(this.transform.angle),this.retainedQueryData[e.bucketInstanceId]&&(this.retainedQueryData[e.bucketInstanceId].featureSortOrder=e.featureSortOrder),e.hasTextData()&&e.text.opacityVertexBuffer&&e.text.opacityVertexBuffer.updateData(e.text.opacityVertexArray),e.hasIconData()&&e.icon.opacityVertexBuffer&&e.icon.opacityVertexBuffer.updateData(e.icon.opacityVertexArray),e.hasIconCollisionBoxData()&&e.iconCollisionBox.collisionVertexBuffer&&e.iconCollisionBox.collisionVertexBuffer.updateData(e.iconCollisionBox.collisionVertexArray),e.hasTextCollisionBoxData()&&e.textCollisionBox.collisionVertexBuffer&&e.textCollisionBox.collisionVertexBuffer.updateData(e.textCollisionBox.collisionVertexArray),e.bucketInstanceId in this.collisionCircleArrays){const S=this.collisionCircleArrays[e.bucketInstanceId];e.placementInvProjMatrix=S.invProjMatrix,e.placementViewportMatrix=S.viewportMatrix,e.collisionCircleArray=S.circles,delete this.collisionCircleArrays[e.bucketInstanceId]}}symbolFadeChange(e){return this.fadeDuration===0?1:(e-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(e){return Math.max(0,(this.transform.zoom-e)/1.5)}hasTransitions(e){return this.stale||e-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(e,r){const i=this.zoomAtLastRecencyCheck===r?1-this.zoomAdjustment(r):1;return this.zoomAtLastRecencyCheck=r,this.commitTime+this.fadeDuration*i>e}setStale(){this.stale=!0}}function xg(t,e,r,i,a){t.emplaceBack(e?1:0,r?1:0,i||0,a||0),t.emplaceBack(e?1:0,r?1:0,i||0,a||0),t.emplaceBack(e?1:0,r?1:0,i||0,a||0),t.emplaceBack(e?1:0,r?1:0,i||0,a||0)}const U9=Math.pow(2,25),G9=Math.pow(2,24),W9=Math.pow(2,17),H9=Math.pow(2,16),q9=Math.pow(2,9),Z9=Math.pow(2,8),X9=Math.pow(2,1);function y5(t){if(t.opacity===0&&!t.placed)return 0;if(t.opacity===1&&t.placed)return 4294967295;const e=t.placed?1:0,r=Math.floor(127*t.opacity);return r*U9+e*G9+r*W9+e*H9+r*q9+e*Z9+r*X9+e}const bg=0;class Y9{constructor(e){this._sortAcrossTiles=e.layout.get("symbol-z-order")!=="viewport-y"&&e.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(e,r,i,a,s){const c=this._bucketParts;for(;this._currentTileIndex<e.length;)if(r.getBucketParts(c,a,e[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,s())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,c.sort((u,d)=>u.sortKey-d.sortKey));this._currentPartIndex<c.length;){const u=c[this._currentPartIndex];if(r.placeLayerBucketPart(u,this._seenCrossTileIDs,i,u.symbolInstanceStart===0),this._currentPartIndex++,s())return!0}return!1}}class K9{constructor(e,r,i,a,s,c,u,d){this.placement=new V9(e,s,c,u,d),this._currentPlacementIndex=r.length-1,this._forceFullPlacement=i,this._showCollisionBoxes=a,this._done=!1}isDone(){return this._done}continuePlacement(e,r,i){const a=Ot.now(),s=()=>{const c=Ot.now()-a;return!this._forceFullPlacement&&c>2};for(;this._currentPlacementIndex>=0;){const c=r[e[this._currentPlacementIndex]],u=this.placement.collisionIndex.transform.zoom;if(c.type==="symbol"&&(!c.minzoom||c.minzoom<=u)&&(!c.maxzoom||c.maxzoom>u)){if(this._inProgressLayer||(this._inProgressLayer=new Y9(c)),this._inProgressLayer.continuePlacement(i[c.source],this.placement,this._showCollisionBoxes,c,s))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(e){return this.placement.commit(e),this.placement}}const v5=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class wg{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[r,i]=new Uint8Array(e,0,2);if(r!==219)throw new Error("Data does not appear to be in a KDBush format.");const a=i>>4;if(a!==1)throw new Error(`Got v${a} data when expected v1.`);const s=v5[15&i];if(!s)throw new Error("Unrecognized array type.");const[c]=new Uint16Array(e,2,1),[u]=new Uint32Array(e,4,1);return new wg(u,c,s,e)}constructor(e,r=64,i=Float64Array,a){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+r,2),65535),this.ArrayType=i,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const s=v5.indexOf(this.ArrayType),c=2*e*this.ArrayType.BYTES_PER_ELEMENT,u=e*this.IndexArrayType.BYTES_PER_ELEMENT,d=(8-u%8)%8;if(s<0)throw new Error(`Unexpected typed array class: ${i}.`);a&&a instanceof ArrayBuffer?(this.data=a,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+u+d,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+c+u+d),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+u+d,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+s]),new Uint16Array(this.data,2,1)[0]=r,new Uint32Array(this.data,4,1)[0]=e)}add(e,r){const i=this._pos>>1;return this.ids[i]=i,this.coords[this._pos++]=e,this.coords[this._pos++]=r,i}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return bx(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,r,i,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:s,coords:c,nodeSize:u}=this,d=[0,s.length-1,0],p=[];for(;d.length;){const m=d.pop()||0,_=d.pop()||0,y=d.pop()||0;if(_-y<=u){for(let T=y;T<=_;T++){const M=c[2*T],C=c[2*T+1];M>=e&&M<=i&&C>=r&&C<=a&&p.push(s[T])}continue}const v=y+_>>1,b=c[2*v],S=c[2*v+1];b>=e&&b<=i&&S>=r&&S<=a&&p.push(s[v]),(m===0?e<=b:r<=S)&&(d.push(y),d.push(v-1),d.push(1-m)),(m===0?i>=b:a>=S)&&(d.push(v+1),d.push(_),d.push(1-m))}return p}within(e,r,i){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:a,coords:s,nodeSize:c}=this,u=[0,a.length-1,0],d=[],p=i*i;for(;u.length;){const m=u.pop()||0,_=u.pop()||0,y=u.pop()||0;if(_-y<=c){for(let T=y;T<=_;T++)b5(s[2*T],s[2*T+1],e,r)<=p&&d.push(a[T]);continue}const v=y+_>>1,b=s[2*v],S=s[2*v+1];b5(b,S,e,r)<=p&&d.push(a[v]),(m===0?e-i<=b:r-i<=S)&&(u.push(y),u.push(v-1),u.push(1-m)),(m===0?e+i>=b:r+i>=S)&&(u.push(v+1),u.push(_),u.push(1-m))}return d}}function bx(t,e,r,i,a,s){if(a-i<=r)return;const c=i+a>>1;x5(t,e,c,i,a,s),bx(t,e,r,i,c-1,1-s),bx(t,e,r,c+1,a,1-s)}function x5(t,e,r,i,a,s){for(;a>i;){if(a-i>600){const p=a-i+1,m=r-i+1,_=Math.log(p),y=.5*Math.exp(2*_/3),v=.5*Math.sqrt(_*y*(p-y)/p)*(m-p/2<0?-1:1);x5(t,e,r,Math.max(i,Math.floor(r-m*y/p+v)),Math.min(a,Math.floor(r+(p-m)*y/p+v)),s)}const c=e[2*r+s];let u=i,d=a;for(af(t,e,i,r),e[2*a+s]>c&&af(t,e,i,a);u<d;){for(af(t,e,u,d),u++,d--;e[2*u+s]<c;)u++;for(;e[2*d+s]>c;)d--}e[2*i+s]===c?af(t,e,i,d):(d++,af(t,e,d,a)),d<=r&&(i=d+1),r<=d&&(a=d-1)}}function af(t,e,r,i){wx(t,r,i),wx(e,2*r,2*i),wx(e,2*r+1,2*i+1)}function wx(t,e,r){const i=t[e];t[e]=t[r],t[r]=i}function b5(t,e,r,i){const a=t-r,s=e-i;return a*a+s*s}const Ex=512/Ae/2;class J9{constructor(e,r,i){this.tileID=e,this.bucketInstanceId=i,this.index=new wg(r.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const a=e.canonical.x*Ae,s=e.canonical.y*Ae;for(let c=0;c<r.length;c++){const{key:u,crossTileID:d,tileAnchorX:p,tileAnchorY:m}=r.get(c),_=Math.floor((a+p)*Ex),y=Math.floor((s+m)*Ex);this.index.add(_,y),this.keys.push(u),this.crossTileIDs.push(d)}this.index.finish()}findMatches(e,r,i){const a=this.tileID.canonical.z<r.canonical.z?1:Math.pow(2,this.tileID.canonical.z-r.canonical.z),s=Ex/Math.pow(2,r.canonical.z-this.tileID.canonical.z),c=r.canonical.x*Ae,u=r.canonical.y*Ae;for(let d=0;d<e.length;d++){const p=e.get(d);if(p.crossTileID)continue;const{key:m,tileAnchorX:_,tileAnchorY:y}=p,v=Math.floor((c+_)*s),b=Math.floor((u+y)*s),S=this.index.range(v-a,b-a,v+a,b+a);for(const T of S){const M=this.crossTileIDs[T];if(this.keys[T]===m&&!i.has(M)){i.add(M),p.crossTileID=M;break}}}}}class Q9{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class eN{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(e){const r=Math.round((e-this.lng)/360);if(r!==0)for(const i in this.indexes){const a=this.indexes[i],s={};for(const c in a){const u=a[c];u.tileID=u.tileID.unwrapTo(u.tileID.wrap+r),s[u.tileID.key]=u}this.indexes[i]=s}this.lng=e}addBucket(e,r,i){if(this.indexes[e.overscaledZ]&&this.indexes[e.overscaledZ][e.key]){if(this.indexes[e.overscaledZ][e.key].bucketInstanceId===r.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(e.overscaledZ,this.indexes[e.overscaledZ][e.key])}for(let s=0;s<r.symbolInstances.length;s++)r.symbolInstances.get(s).crossTileID=0;this.usedCrossTileIDs[e.overscaledZ]||(this.usedCrossTileIDs[e.overscaledZ]=new Set);const a=this.usedCrossTileIDs[e.overscaledZ];for(const s in this.indexes){const c=this.indexes[s];if(Number(s)>e.overscaledZ)for(const u in c){const d=c[u];d.tileID.isChildOf(e)&&d.findMatches(r.symbolInstances,e,a)}else{const u=c[e.scaledTo(Number(s)).key];u&&u.findMatches(r.symbolInstances,e,a)}}for(let s=0;s<r.symbolInstances.length;s++){const c=r.symbolInstances.get(s);c.crossTileID||(c.crossTileID=i.generate(),a.add(c.crossTileID))}return this.indexes[e.overscaledZ]===void 0&&(this.indexes[e.overscaledZ]={}),this.indexes[e.overscaledZ][e.key]=new J9(e,r.symbolInstances,r.bucketInstanceId),!0}removeBucketCrossTileIDs(e,r){for(const i of r.crossTileIDs)this.usedCrossTileIDs[e].delete(i)}removeStaleBuckets(e){let r=!1;for(const i in this.indexes){const a=this.indexes[i];for(const s in a)e[a[s].bucketInstanceId]||(this.removeBucketCrossTileIDs(i,a[s]),delete a[s],r=!0)}return r}}class tN{constructor(){this.layerIndexes={},this.crossTileIDs=new Q9,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(e,r,i,a){let s=this.layerIndexes[e.id];s===void 0&&(s=this.layerIndexes[e.id]=new eN);let c=!1;const u={};a.name!=="globe"&&s.handleWrapJump(i);for(const d of r){const p=d.getBucket(e);p&&e.id===p.layerIds[0]&&(p.bucketInstanceId||(p.bucketInstanceId=++this.maxBucketInstanceId),s.addBucket(d.tileID,p,this.crossTileIDs)&&(c=!0),u[p.bucketInstanceId]=!0)}return s.removeStaleBuckets(u)&&(c=!0),c}pruneUnusedLayers(e){const r={};e.forEach(i=>{r[i]=!0});for(const i in this.layerIndexes)r[i]||delete this.layerIndexes[i]}}function $u(t,e){return e?`${t}${e}`:t}function w5(t){const e=t.indexOf("");return e>=0?t.slice(0,e):t}function E5(t){const e=t.indexOf("");return e>=0?t.slice(e+1):""}var S5=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
vec3 linearTosRGB(vec3 color)
{return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn)
{return pow(srgbIn,vec3(2.2));}vec3 linearProduct(vec3 srgbIn,vec3 k)
{return srgbIn*pow(k,vec3(1./2.2));}
#if __VERSION__ >=300
#define _HANDLE_WIREFRAME_DEPTH gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define _HANDLE_WIREFRAME_DEPTH
#endif
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
gl_FragColor=vec4(0.7,0.0,0.0,0.7); \\
_HANDLE_WIREFRAME_DEPTH;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif`,T5="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",M5=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,C5=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,A5=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {
#ifdef FOG_DITHERING
vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);
#else
return color;
#endif
}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,I5=`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,asin(clamp(normal.z,-1.0,1.0))/PI+0.5);return vertical_factor*ambient_directional_factor;}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,P5=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,k5=`#ifdef RENDER_SHADOWS
#if defined(NATIVE) && __VERSION__ >=300
#define TEXTURE_GATHER
#endif
#ifdef DEPTH_TEXTURE
uniform highp sampler2D u_shadowmap_0;uniform highp sampler2D u_shadowmap_1;
#else
uniform sampler2D u_shadowmap_0;uniform sampler2D u_shadowmap_1;
#endif
uniform float u_shadow_intensity;uniform float u_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;highp float shadow_sample_1(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture2D(u_shadowmap_1,uv).r;
#else
shadow_depth=unpack_depth(texture2D(u_shadowmap_1,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_sample_0(highp vec2 uv,highp float compare) {highp float shadow_depth;
#ifdef DEPTH_TEXTURE
shadow_depth=texture2D(u_shadowmap_0,uv).r;
#else
shadow_depth=unpack_depth(texture2D(u_shadowmap_0,uv))*0.5+0.5;
#endif
return step(shadow_depth,compare);}highp float shadow_occlusion_1(highp vec4 pos,highp float bias) {highp float compare1=pos.z-bias;highp vec2 texel=pos.xy/u_texel_size-vec2(0.5);highp vec2 f=fract(texel);highp float s=u_texel_size;
#ifdef TEXTURE_GATHER
vec2 uv00=(texel-f+0.5)*s;highp vec4 d00=textureGather(u_shadowmap_1,uv00,0);highp vec4 c00=step(d00,vec4(compare1));highp float o00=c00.a;highp float o10=c00.b;highp float o01=c00.r;highp float o11=c00.g;
#else
highp vec2 uv00=(texel-f+0.5)*s;highp vec2 uv10=uv00+vec2(1.0*s,0.0);highp vec2 uv01=uv00+vec2(0.0,1.0*s);highp vec2 uv11=uv01+vec2(1.0*s,0.0);highp float o00=shadow_sample_1(uv00,compare1);highp float o10=shadow_sample_1(uv10,compare1);highp float o01=shadow_sample_1(uv01,compare1);highp float o11=shadow_sample_1(uv11,compare1);
#endif
highp float value=
(1.0-f.x)*(1.0-f.y)*o00+f.x*(1.0-f.y)*o10+(1.0-f.x)*f.y*o01+f.x*f.y*o11;return clamp(value,0.0,1.0);}highp float shadow_occlusion_0(highp vec4 pos,highp float bias) {highp float compare0=pos.z-bias;highp vec2 texel=pos.xy/u_texel_size-vec2(1.5);highp vec2 f=fract(texel);highp float s=u_texel_size;
#ifdef TEXTURE_GATHER
highp vec2 uv00=(texel-f+0.5)*s;highp vec2 uv10=uv00+vec2(2.0*s,0);highp vec2 uv01=uv00+vec2(0,2.0*s);highp vec2 uv11=uv10+vec2(0,2.0*s);highp vec4 d00=textureGather(u_shadowmap_0,uv00);highp vec4 d10=textureGather(u_shadowmap_0,uv10);highp vec4 d01=textureGather(u_shadowmap_0,uv01);highp vec4 d11=textureGather(u_shadowmap_0,uv11);highp vec4 c00=step(d00,vec4(compare0));highp vec4 c01=step(d01,vec4(compare0));highp vec4 c10=step(d10,vec4(compare0));highp vec4 c11=step(d11,vec4(compare0));highp float o00=c00.a;highp float o10=c00.b;highp float o20=c10.a;highp float o30=c10.b;highp float o01=c00.r;highp float o11=c00.g;highp float o21=c10.r;highp float o31=c10.g;highp float o02=c01.a;highp float o12=c01.b;highp float o22=c11.a;highp float o32=c11.b;highp float o03=c01.r;highp float o13=c01.g;highp float o23=c11.r;highp float o33=c11.g;
#else
highp vec2 uv00=(texel-f+0.5)*s;highp vec2 uv10=uv00+vec2(1.0*s,0);highp vec2 uv20=uv00+vec2(2.0*s,0);highp vec2 uv30=uv00+vec2(3.0*s,0);highp vec2 uv01=uv00+vec2(0.0,1.0*s);highp vec2 uv11=uv01+vec2(1.0*s,0);highp vec2 uv21=uv01+vec2(2.0*s,0);highp vec2 uv31=uv01+vec2(3.0*s,0);highp vec2 uv02=uv01+vec2(0.0,1.0*s);highp vec2 uv12=uv02+vec2(1.0*s,0);highp vec2 uv22=uv02+vec2(2.0*s,0);highp vec2 uv32=uv02+vec2(3.0*s,0);highp vec2 uv03=uv02+vec2(0.0,1.0*s);highp vec2 uv13=uv03+vec2(1.0*s,0);highp vec2 uv23=uv03+vec2(2.0*s,0);highp vec2 uv33=uv03+vec2(3.0*s,0);highp float o00=shadow_sample_0(uv00,compare0);highp float o10=shadow_sample_0(uv10,compare0);highp float o20=shadow_sample_0(uv20,compare0);highp float o30=shadow_sample_0(uv30,compare0);highp float o01=shadow_sample_0(uv01,compare0);highp float o11=shadow_sample_0(uv11,compare0);highp float o21=shadow_sample_0(uv21,compare0);highp float o31=shadow_sample_0(uv31,compare0);highp float o02=shadow_sample_0(uv02,compare0);highp float o12=shadow_sample_0(uv12,compare0);highp float o22=shadow_sample_0(uv22,compare0);highp float o32=shadow_sample_0(uv32,compare0);highp float o03=shadow_sample_0(uv03,compare0);highp float o13=shadow_sample_0(uv13,compare0);highp float o23=shadow_sample_0(uv23,compare0);highp float o33=shadow_sample_0(uv33,compare0);
#endif
highp float value=
(1.0-f.x)*(1.0-f.y)*o00+(1.0-f.y)*(o10+o20)+f.x*(1.0-f.y)*o30+(1.0-f.x)*(o01+o02)+f.x*(o31+o32)+(1.0-f.x)*f.y*o03+f.y*(o13+o23)+f.x*f.y*o33+o11+o21+o12+o22;return clamp(value/9.0,0.0,1.0);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;light_view_pos1.xyz/=light_view_pos1.w;vec4 uv=vec4(light_view_pos0.xy,light_view_pos1.xy);vec4 abs_bounds=abs(uv);if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {light_view_pos0.xyz=light_view_pos0.xyz*0.5+0.5;return shadow_occlusion_0(light_view_pos0,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}light_view_pos1.xyz=light_view_pos1.xyz*0.5+0.5;float occlusion1=shadow_occlusion_1(light_view_pos1,bias);return mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth));}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp float NDotL=dot(N,u_shadow_direction);if (NDotL < 0.0)
return 0.0;highp float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return (1.0-(u_shadow_intensity*occlusion))*NDotL;}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp float NDotL=dot(N,u_shadow_direction);if (NDotL < 0.0)
return 0.0;float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return (1.0-(u_shadow_intensity*occlusion))*NDotL;}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;let R5={},Sx={},Tx={};const cl=[];ss(S5,cl),ss(I5,cl),ss(M5,cl),ss(C5,cl),ss(A5,cl),ss(P5,cl),ss(k5,cl),R5=kr("",M5),Sx=kr(A5,C5),Tx=kr(k5,P5);const z5=kr(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec2 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color) {
#ifdef INDICATOR_CUTOUT
float holeMinOpacity=u_indicator_cutout_params.x;float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),D5=S5,L5=I5,Mx=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var O5={background:kr(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;varying vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:kr(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:kr(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:kr("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:kr(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:kr(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:kr("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:kr("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:kr("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:kr(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:kr(`varying vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:kr(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_emissive_strength;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:kr(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;uniform float u_emissive_strength;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:kr(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
varying highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
varying float v_flood_radius;varying float v_has_floodlight;
#endif
varying float v_height;void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
uniform highp float u_vertical_scale;varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
varying float v_flood_radius;varying float v_has_floodlight;
#endif
varying float v_height;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=color;
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:kr(`varying highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
gl_FragColor=pack_depth(v_depth);
#endif
}`,`uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_vertical_scale;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
varying highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base);pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:kr(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying vec3 v_normal;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying vec3 v_normal;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:kr(`#ifdef GL_ES
precision highp float;
#endif
uniform vec3 u_ground_shadow_factor;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0)).r);
#endif
gl_FragColor=vec4(shadow,1.0);}`,`uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;attribute vec2 a_pos;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#ifdef FOG
varying float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);v_depth=gl_Position.w;
#ifdef FOG
v_fog_opacity=fog(fog_position(a_pos));
#endif
}`),fillExtrusionGroundEffect:kr(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;
#ifdef SDF_SUBPASS
varying highp vec2 v_pos;varying highp vec4 v_line_segment;varying highp float v_flood_light_radius_tile;varying highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
varying highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texelFetch(u_fb,ivec2(gl_FragCoord.xy),0);
#endif
gl_FragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
gl_FragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
gl_FragColor=color;HANDLE_WIREFRAME_DEBUG;
#endif
#endif
}`,`attribute highp vec4 a_pos_end;attribute highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
varying highp vec2 v_pos;varying highp vec4 v_line_segment;varying highp float v_flood_light_radius_tile;varying highp vec2 v_ao;
#ifdef FOG
varying highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
#pragma mapbox: define highp float base
void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
#pragma mapbox: initialize highp float base
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float flood_radius_tile=flood_light_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass);vec2 offset_along_edge=v*effect_radius*(0.5-start_bottom.x)*2.0;vec2 extrusion=vec2(-v.y,v.x)*effect_radius*(start_bottom.y-1.0);vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=offset_along_edge+extrusion;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q);v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog=1.0-fog(fog_position(pos));
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(flood_light_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=float(base > 0.0);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));}`),hillshadePrepare:kr(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:kr(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting_ground(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:kr(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(border_color.rgb*border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:kr(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting_ground(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
color=applyCutout(color);
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:kr(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec2 u_colorization_scale;uniform highp vec4 u_colorization_mix;highp vec4 colormap (highp float value) {highp float scaled_value=value*u_colorization_scale.y+u_colorization_scale.x;highp vec2 coords=vec2(scaled_value,0.5);return texture2D(u_color_ramp,coords);}
#endif
void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);vec4 color;
#ifdef RASTER_COLOR
highp vec4 fadedColor=mix(color0,color1,u_fade_t);color=colormap(dot(vec4(fadedColor.rgb,1),u_colorization_mix));color.a*=fadedColor.a;if (color.a > 0.0) {color.rgb/=color.a;}
#else
if (color0.a > 0.0) {color0.rgb/=color0.a;}if (color1.a > 0.0) {color1.rgb/=color1.a;}color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_ground(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:kr(`uniform sampler2D u_texture;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
varying float v_fade_opacity;varying vec2 v_tex_a;
#ifdef ICON_TRANSITION
varying vec2 v_tex_b;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
lowp float alpha=opacity*v_fade_opacity;vec4 out_color;
#ifdef ICON_TRANSITION
vec4 a=texture2D(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture2D(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b)*alpha;
#else
out_color=texture2D(u_texture,v_tex_a)*alpha;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
attribute vec2 a_texb;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex_a;
#ifdef ICON_TRANSITION
varying vec2 v_tex_b;
#endif
varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
v_tex_a=a_tex/u_texsize;
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
v_fade_opacity=out_fade_opacity;}`),symbolSDF:kr(`#define SDF_PX 8.0
uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo;
#if __VERSION__ >=300
draw_halo=v_draw_halo > 0.0;
#else
draw_halo=u_is_halo;
#endif
if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;
#if __VERSION__ >=300
v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;
#endif
v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,out_fade_opacity);}`),symbolTextAndIcon:kr(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_halo;
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo;
#if __VERSION__ >=300
draw_halo=v_draw_halo > 0.0;
#else
draw_halo=u_is_halo;
#endif
if (draw_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);vec4 out_color=color*(alpha*opacity*fade_opacity);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
#if __VERSION__ >=300
flat varying float v_draw_halo;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
float out_fade_opacity=interpolated_fade_opacity*projection_transition_fade;float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,hidden);
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,hidden);
#endif
float gamma_scale=gl_Position.w;
#if __VERSION__ >=300
v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,out_fade_opacity,is_sdf);}`),terrainRaster:kr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture2D(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,v_depth,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,(1.0-(u_shadow_intensity*occlusion))*ndotl);vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color=apply_lighting(image_color,normal,lighting_factor);
#endif
#else
float lighting_factor=calculate_NdotL(normal);color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:kr(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:kr(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,T5),skyboxGradient:kr(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,T5),skyboxCapture:kr(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:kr(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(raster.rgb*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture2D(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:kr(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
gl_FragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
gl_FragColor=vec4(1,1,1,1);
#else
gl_FragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);gl_FragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;
#ifndef NATIVE
c=dither(c,gl_FragCoord.xy+u_temporal_offset);
#endif
gl_FragColor=vec4(c*t,t);
#endif
}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:kr(`uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;varying highp vec3 v_position;varying lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth_shadows;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
varying lowp vec4 v_roughness_metallic_emissive_alpha;varying mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
varying highp float v_depth;uniform sampler2D u_depthTexture;uniform vec2 u_inv_depth_size;bool isOccluded() {vec2 coord=gl_FragCoord.xy*u_inv_depth_size;highp float depth=unpack_depth(texture2D(u_depthTexture,coord));return v_depth > depth+0.0005;}
#endif
const float M_PI=3.141592653589793;
#define saturate(_x) clamp(_x,0.,1.)
float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture2D(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
texColor.rgb=sRGBToLinear(texColor.rgb);if(u_baseTextureIsAlpha) {if (texColor.w < 0.5) {discard;}albedo*=mix(vec4(texColor.rgb,texColor.a),vec4(texColor.a),float(u_baseTextureIsAlpha));} else {albedo*=texColor;}
#endif
return vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position.x),dFdx(v_position.y),dFdx(v_position.z));highp vec3 fdy=vec3(dFdy(v_position.x),dFdy(v_position.y),dFdy(v_position.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture2D( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture2D(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(M_PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/M_PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/M_PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 diffuse=getDiffuseShadedColor(getBaseColor().rgb,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture2D(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(diffuse,1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
float ao=(texture2D(u_occlusionTexture,uv_2f).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture2D(u_emissionTexture,uv_2f).rgb);
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);color=mix(color,v_color_mix.rgb,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor);
#endif
gl_FragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`attribute vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
attribute vec4 a_normal_matrix0;attribute vec4 a_normal_matrix1;attribute vec4 a_normal_matrix2;attribute vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth_shadows;
#endif
varying vec3 v_position;varying lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
varying highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
varying lowp vec4 v_roughness_metallic_emissive_alpha;varying mediump vec4 v_height_based_emission_params;
#endif
void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=u_matrix*pos;pos.z*=meter_to_tile;v_position=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 shadow_pos=local_pos;
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normalize(normal_3f));shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1);v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:kr(`varying highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
gl_FragColor=pack_depth(v_depth);
#endif
}`,`attribute vec3 a_pos_3f;uniform mat4 u_matrix;varying highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
attribute vec4 a_instance0;attribute vec4 a_instance1;attribute vec4 a_instance2;attribute vec4 a_instance3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_instance0,a_instance1,a_instance2,a_instance3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=u_matrix*pos;
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:kr(`varying highp vec2 v_uv;varying mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;gl_FragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
attribute vec3 a_pos_3f;attribute vec2 a_uv;attribute float a_size_scale;attribute float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;varying highp vec2 v_uv;varying mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`)};function ss(t,e){const r=t.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let i of r)if(i=i.trim(),i[0]==="#"&&i.includes("if")&&!i.includes("endif")){i=i.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const a=i.split(" ");for(const s of a)e.includes(s)||e.push(s)}}function kr(t,e){const r=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let i=e.match(/attribute(\S*) (highp |mediump |lowp )?([\w]+) ([\w]+)/g);i&&(i=i.filter((c,u)=>i.indexOf(c)===u));const a={},s=[...cl];return ss(t,s),ss(e,s),{fragmentSource:t=t.replace(r,(c,u,d,p,m)=>(a[m]=!0,u==="define"?`
#ifndef HAS_UNIFORM_u_${m}
varying ${d} ${p} ${m};
#else
uniform ${d} ${p} u_${m};
#endif
`:u==="initialize"?`
#ifdef HAS_UNIFORM_u_${m}
    ${d} ${p} ${m} = u_${m};
#endif
`:u==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${m}
    varying ${d} ${p} ${m};
#endif
`:u==="initialize-attribute"?"":void 0)),vertexSource:e=e.replace(r,(c,u,d,p,m)=>{const _=p==="float"?"vec2":p,y=m.match(/color/)?"color":_;return u==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${m}
attribute ${d} ${p} a_${m};
#endif
`:a[m]?u==="define"?`
#ifndef HAS_UNIFORM_u_${m}
uniform lowp float u_${m}_t;
attribute ${d} ${_} a_${m};
varying ${d} ${p} ${m};
#else
uniform ${d} ${p} u_${m};
#endif
`:u==="initialize"?y==="vec4"?`
#ifndef HAS_UNIFORM_u_${m}
    ${m} = a_${m};
#else
    ${d} ${p} ${m} = u_${m};
#endif
`:`
#ifndef HAS_UNIFORM_u_${m}
    ${m} = unpack_mix_${y}(a_${m}, u_${m}_t);
#else
    ${d} ${p} ${m} = u_${m};
#endif
`:u==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${m}
    attribute ${d} ${p} a_${m};
    varying ${d} ${p} ${m};
#endif
`:u==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${m}
    ${m} = a_${m};
#endif
`:void 0:u==="define"?`
#ifndef HAS_UNIFORM_u_${m}
uniform lowp float u_${m}_t;
attribute ${d} ${_} a_${m};
#else
uniform ${d} ${p} u_${m};
#endif
`:u==="define-instanced"?y==="mat4"?`
#ifdef INSTANCED_ARRAYS
attribute vec4 a_${m}0;
attribute vec4 a_${m}1;
attribute vec4 a_${m}2;
attribute vec4 a_${m}3;
#else
uniform ${d} ${p} u_${m};
#endif
`:`
#ifdef INSTANCED_ARRAYS
attribute ${d} ${_} a_${m};
#else
uniform ${d} ${p} u_${m};
#endif
`:u==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${m}
    ${d} ${p} ${m} = a_${m};
#endif
`:y==="vec4"?`
#ifndef HAS_UNIFORM_u_${m}
    ${d} ${p} ${m} = a_${m};
#else
    ${d} ${p} ${m} = u_${m};
#endif
`:`
#ifndef HAS_UNIFORM_u_${m}
    ${d} ${p} ${m} = unpack_mix_${y}(a_${m}, u_${m}_t);
#else
    ${d} ${p} ${m} = u_${m};
#endif
`}),staticAttributes:i,usedDefines:s}}class rN{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(e,r,i,a,s,c,u){this.context=e;let d=this.boundPaintVertexBuffers.length!==a.length;for(let m=0;!d&&m<a.length;m++)this.boundPaintVertexBuffers[m]!==a[m]&&(d=!0);let p=this.boundDynamicVertexBuffers.length!==u.length;for(let m=0;!p&&m<u.length;m++)this.boundDynamicVertexBuffers[m]!==u[m]&&(p=!0);if(!e.extVertexArrayObject||!this.vao||this.boundProgram!==r||this.boundLayoutVertexBuffer!==i||d||p||this.boundIndexBuffer!==s||this.boundVertexOffset!==c)this.freshBind(r,i,a,s,c,u);else{e.bindVertexArrayOES.set(this.vao);for(const m of u)m&&m.bind();s&&s.dynamicDraw&&s.bind()}}freshBind(e,r,i,a,s,c){let u;const d=e.numAttributes,p=this.context,m=p.gl;if(p.extVertexArrayObject)this.vao&&this.destroy(),this.vao=p.extVertexArrayObject.createVertexArrayOES(),p.bindVertexArrayOES.set(this.vao),u=0,this.boundProgram=e,this.boundLayoutVertexBuffer=r,this.boundPaintVertexBuffers=i,this.boundIndexBuffer=a,this.boundVertexOffset=s,this.boundDynamicVertexBuffers=c;else{u=p.currentNumAttributes||0;for(let _=d;_<u;_++)m.disableVertexAttribArray(_)}r.enableAttributes(m,e),r.bind(),r.setVertexAttribPointers(m,e,s);for(const _ of i)_.enableAttributes(m,e),_.bind(),_.setVertexAttribPointers(m,e,s);for(const _ of c)_&&(_.enableAttributes(m,e),_.bind(),_.setVertexAttribPointers(m,e,s));a&&a.bind(),p.currentNumAttributes=d}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function nN(t,e){const r=Math.pow(2,e.canonical.z),i=e.canonical.y;return[new cr(0,i/r).toLngLat().lat,new cr(0,(i+1)/r).toLngLat().lat]}function iN(t,e,r,i,a,s,c){const u=t.context,d=u.gl,p=r.fbo;if(!p)return;t.prepareDrawTile();const m=t.useProgram("hillshade");u.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,p.colorAttachment.get());const _=((S,T,M,C)=>{const P=M.paint.get("hillshade-shadow-color"),k=M.paint.get("hillshade-highlight-color"),z=M.paint.get("hillshade-accent-color");let L=M.paint.get("hillshade-illumination-direction")*(Math.PI/180);M.paint.get("hillshade-illumination-anchor")==="viewport"&&(L-=S.transform.angle);const B=!S.options.moving;return{u_matrix:C||S.transform.calculateProjMatrix(T.tileID.toUnwrapped(),B),u_image:0,u_latrange:nN(0,T.tileID),u_light:[M.paint.get("hillshade-exaggeration"),L],u_shadow:P,u_highlight:k,u_accent:z}})(t,r,i,t.terrain?e.projMatrix:null);t.uploadCommonUniforms(u,m,e.toUnwrapped());const{tileBoundsBuffer:y,tileBoundsIndexBuffer:v,tileBoundsSegments:b}=t.getTileBoundsBuffers(r);m.draw(t,d.TRIANGLES,a,s,c,ur.disabled,_,i.id,y,v,b)}function F5(t,e,r){if(!e.needsDEMTextureUpload)return;const i=t.context,a=i.gl;i.pixelStoreUnpackPremultiplyAlpha.set(!1),e.demTexture=e.demTexture||t.getTileTexture(r.stride);const s=r.getPixels();e.demTexture?e.demTexture.update(s,{premultiply:!1}):e.demTexture=new Dn(i,s,a.RGBA,{premultiply:!1}),e.needsDEMTextureUpload=!1}function oN(t,e,r,i,a,s){const c=t.context,u=c.gl;if(!e.dem)return;const d=e.dem;if(c.activeTexture.set(u.TEXTURE1),F5(t,e,d),!e.demTexture)return;e.demTexture.bind(u.NEAREST,u.CLAMP_TO_EDGE);const p=d.dim;c.activeTexture.set(u.TEXTURE0);let m=e.fbo;if(!m){const b=new Dn(c,{width:p,height:p,data:null},u.RGBA);b.bind(u.LINEAR,u.CLAMP_TO_EDGE),m=e.fbo=c.createFramebuffer(p,p,!0,"renderbuffer"),m.colorAttachment.set(b.texture)}c.bindFramebuffer.set(m.framebuffer),c.viewport.set([0,0,p,p]);const{tileBoundsBuffer:_,tileBoundsIndexBuffer:y,tileBoundsSegments:v}=t.getMercatorTileBoundsBuffers();t.useProgram("hillshadePrepare").draw(t,u.TRIANGLES,i,a,s,ur.disabled,((b,S)=>{const T=S.stride,M=ge.create();return ge.ortho(M,0,Ae,-Ae,0,0,1),ge.translate(M,M,[0,-Ae,0]),{u_matrix:M,u_image:1,u_dimension:[T,T],u_zoom:b.overscaledZ,u_unpack:S.unpackVector}})(e.tileID,d),r.id,_,y,v),e.needsHillshadePrepare=!1}const B5=t=>({u_matrix:new Gt(t),u_image0:new Qt(t),u_skirt_height:new Ye(t),u_ground_shadow_factor:new Vt(t)}),N5=(t,e,r)=>({u_matrix:t,u_image0:0,u_skirt_height:e,u_ground_shadow_factor:r}),j5=(t,e,r,i,a,s,c,u,d,p,m,_,y,v,b)=>({u_proj_matrix:Float32Array.from(t),u_globe_matrix:e,u_normalize_matrix:Float32Array.from(i),u_merc_matrix:r,u_zoom_transition:a,u_merc_center:s,u_image0:0,u_frustum_tl:c,u_frustum_tr:u,u_frustum_br:d,u_frustum_bl:p,u_globe_pos:m,u_globe_radius:_,u_viewport:y,u_grid_matrix:b?Float32Array.from(b):new Float32Array(9),u_skirt_height:v}),qi={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,ShadowMap0:10},Vu=2048;class aN{constructor(e){this.painter=e,this._enabled=!1,this._shadowLayerCount=0,this._cascades=[],this._depthMode=new Nt(e.context.gl.LEQUAL,Nt.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_texel_size:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this.useNormalOffset=!1}destroy(){for(const e of this._cascades)e.texture.destroy(),e.framebuffer.destroy();this._cascades=[]}updateShadowParameters(e,r){const i=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,!i.context.isWebGL2||!r||!r.properties)return;const a=r.properties.get("shadow-intensity");if(r.properties.get("cast-shadows")!==!0||a<=0||(this._shadowLayerCount=i.style.order.reduce((v,b)=>{const S=i.style._layers[b];return v+(S.hasShadowPass()&&!S.isHidden(e.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this._enabled))return;const s=i.context,c=Vu,u=Vu;if(this._cascades.length===0)for(let v=0;v<2;++v){const b=i._shadowMapDebug,S=s.gl,T=s.createFramebuffer(c,u,b,"texture"),M=new Dn(s,{width:c,height:u,data:null},S.DEPTH_COMPONENT);if(T.depthAttachment.set(M.texture),b){const C=new Dn(s,{width:c,height:u,data:null},S.RGBA);T.colorAttachment.set(C.texture)}this._cascades.push({framebuffer:T,texture:M,matrix:[],far:0,boundingSphereRadius:0,frustum:new gu})}const d=function(v,b){const S=b.properties.get("direction"),T=tt(S.x,S.y,S.z);T[2]=ze(T[2],0,75);const M=Qe([T[0],T[1],T[2]]);return ie.fromValues(M.x,M.y,M.z)}(0,r);let p=0;if(e.elevation){const v=e.elevation,b=[1e4,-1e4];v.visibleDemTiles.filter(S=>S.dem).forEach(S=>{const T=S.dem.tree;b[0]=Math.min(b[0],T.minimums[0]),b[1]=Math.max(b[1],T.maximums[0])}),b[0]!==1e4&&(p=(b[1]-b[0])*v.exaggeration())}const m=1.5*e.cameraToCenterDistance,_=3*m,y=new Float64Array(16);for(let v=0;v<2;++v){const b=this._cascades[v];let S=e.height/50,T=1;v===0?T=m:(S=m,T=_);const[M,C]=sN(e,d,S,T,Vu,p);b.matrix=M,b.boundingSphereRadius=C,ge.invert(y,b.matrix),b.frustum=gu.fromInvProjectionMatrix(y,1,0,!0),b.far=T}this._uniformValues.u_fade_range=[.75*this._cascades[1].far,this._cascades[1].far],this._uniformValues.u_shadow_intensity=a,this._uniformValues.u_shadow_direction=[d[0],d[1],d[2]],this._uniformValues.u_texel_size=.00048828125,this._uniformValues.u_shadowmap_0=qi.ShadowMap0,this._uniformValues.u_shadowmap_1=qi.ShadowMap0+1}get enabled(){return this._enabled}set enabled(e){this._enabled=e}drawShadowPass(e,r){if(!this._enabled)return;const i=this.painter,a=i.context;a.viewport.set([0,0,Vu,Vu]);for(let s=0;s<2;++s){i.currentShadowCascade=s,a.bindFramebuffer.set(this._cascades[s].framebuffer.framebuffer),a.clear({color:Zt.white,depth:1});for(const c of e.order){const u=e._layers[c];if(!u.hasShadowPass()||u.isHidden(i.transform.zoom))continue;const d=e._getLayerSourceCache(u),p=d?r[d.id]:void 0;(u.type==="model"||p&&p.length)&&i.renderLayer(i,d,u,p)}}i.currentShadowCascade=0}drawGroundShadows(){if(!this._enabled)return;const e=this.painter,r=e.style,i=e.context,a=r.directionalLight,s=r.ambientLight;if(!a||!s)return;const c=e.useProgram("groundShadow"),u=e.transform.coveringTiles({tileSize:512,renderWorldCopies:!0}),d=Cx(a,s),p=new Nt(i.gl.LEQUAL,Nt.ReadOnly,e.depthRangeFor3D);for(const m of u){const _=m.toUnwrapped();this.setupShadows(_,c),e.uploadCommonUniforms(i,c,_);const y={u_matrix:e.transform.calculateProjMatrix(_),u_ground_shadow_factor:d};c.draw(e,i.gl.TRIANGLES,p,lr.disabled,Lr.multiply,ur.disabled,y,"ground_shadow",e.tileExtentBuffer,e.quadTriangleIndexBuffer,e.tileExtentSegments,{},e.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?Lr.unblended:Lr.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(e){const r=this.painter.transform,i=r.calculatePosMatrix(e,r.worldSize);return ge.multiply(i,this._cascades[this.painter.currentShadowCascade].matrix,i),Float32Array.from(i)}calculateShadowPassMatrixFromMatrix(e){return ge.multiply(e,this._cascades[this.painter.currentShadowCascade].matrix,e),Float32Array.from(e)}setupShadows(e,r,i,a=0){if(!this._enabled)return;const s=this.painter.transform,c=this.painter.context,u=c.gl,d=this._uniformValues,p=new Float64Array(16),m=s.calculatePosMatrix(e,s.worldSize);for(let _=0;_<2;_++)ge.multiply(p,this._cascades[_].matrix,m),d[_===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(p),c.activeTexture.set(u.TEXTURE0+qi.ShadowMap0+_),this._cascades[_].texture.bind(u.NEAREST,u.CLAMP_TO_EDGE);if(this.useNormalOffset=!!i,this.useNormalOffset){const _=kd(e.canonical),y=2/s.tileSize*Ae/Vu,v=y*this._cascades[0].boundingSphereRadius,b=y*this._cascades[1].boundingSphereRadius,S=(i==="vector-tile"?1:3)/Math.pow(2,a-e.canonical.z-(1-s.zoom+Math.floor(s.zoom)));d.u_shadow_normal_offset=[_,v*S,b*S],d.u_shadow_bias=[6e-5,.0012,.012]}else d.u_shadow_bias=[36e-5,.0012,.012];r.setShadowUniformValues(c,d)}setupShadowsFromMatrix(e,r,i=!1){if(!this._enabled)return;const a=this.painter.context,s=a.gl,c=this._uniformValues,u=new Float64Array(16);for(let d=0;d<2;d++)ge.multiply(u,this._cascades[d].matrix,e),c[d===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(u),a.activeTexture.set(s.TEXTURE0+qi.ShadowMap0+d),this._cascades[d].texture.bind(s.NEAREST,s.CLAMP_TO_EDGE);this.useNormalOffset=i,i?(c.u_shadow_normal_offset=[1,5,5],c.u_shadow_bias=[6e-5,.0012,.012]):c.u_shadow_bias=[36e-5,.0012,.012],r.setShadowUniformValues(a,c)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}}function Cx(t,e){const r=t.properties.get("color"),i=t.properties.get("intensity"),a=t.properties.get("direction"),s=[a.x,a.y,a.z],c=e.properties.get("color"),u=e.properties.get("intensity"),d=Math.max(ie.dot([0,0,1],s),0),p=[0,0,0];ie.scale(p,c.toArray01Linear().slice(0,3),u);const m=[0,0,0];return ie.scale(m,r.toArray01Linear().slice(0,3),d*i),br([p[0]>0?p[0]/(p[0]+m[0]):0,p[1]>0?p[1]/(p[1]+m[1]):0,p[2]>0?p[2]/(p[2]+m[2]):0])}function sN(t,e,r,i,a,s){const c=t.zoom,u=t.scale,d=t.worldSize,p=1/d,m=t.aspect,_=Math.sqrt(1+m*m)*Math.tan(.5*t.fovX),y=_*_,v=i-r,b=i+r;let S,T;y>v/b?(S=i,T=i*_):(S=.5*b*(1+y),T=.5*Math.sqrt(v*v+2*(i*i+r*r)*y+b*b*y*y));const M=t.projection.pixelsPerMeter(t.center.lat,d),C=t._camera.getCameraToWorldMercator(),P=[0,0,-S*p];ie.transformMat4(P,P,C);let k=T*p;const z=t._edgeInsets;if(!(z.left===0&&z.top===0&&z.right===0&&z.bottom===0||z.left===z.right&&z.top===z.bottom)){const Ce=t._camera.getWorldToCamera(t.worldSize,t.projection.zAxisUnit==="meters"?M:1),Se=t._camera.getCameraToClipPerspective(t._fov,t.width/t.height,r,i);Se[8]=2*-t.centerOffset.x/t.width,Se[9]=2*t.centerOffset.y/t.height;const Je=new Float64Array(16);ge.mul(Je,Se,Ce);const Ge=new Float64Array(16);ge.invert(Ge,Je);const je=gu.fromInvProjectionMatrix(Ge,d,c,!0);for(const Ve of je.points){const nt=((L=Ve)[0]/=u,L[1]/=u,L[2]=jr(L[2],t._center.lat),L);k=Math.max(k,ie.len(ie.subtract([],P,nt)))}}var L;k*=a/(a-1);const B=Math.acos(e[2]),W=Math.atan2(-e[0],-e[1]),Z=new lg;Z.position=P,Z.setPitchBearing(B,W);const X=Z.getWorldToCamera(d,M),H=k*d,J=Math.min(t._mercatorZfromZoom(17)*d*-2,-2*H),Q=Z.getCameraToClipOrthographic(-H,H,-H,H,J,(H+s*M)/e[2]),K=new Float64Array(16);ge.multiply(K,Q,X);const fe=ie.fromValues(Math.floor(1e6*P[0])/1e6*d,Math.floor(1e6*P[1])/1e6*d,0),he=.5*a,_e=[0,0,0];ie.transformMat4(_e,fe,K),ie.scale(_e,_e,he);const oe=[Math.floor(_e[0]),Math.floor(_e[1]),Math.floor(_e[2])],me=[0,0,0];ie.sub(me,_e,oe),ie.scale(me,me,-1/he);const ve=new Float64Array(16);return ge.identity(ve),ge.translate(ve,ve,me),ge.multiply(K,ve,K),[K,H]}function $5(t,e){return t!=null&&e!=null&&!(!t.hasData()||!e.hasData())&&t.demTexture!=null&&e.demTexture!=null&&t.tileID.key!==e.tileID.key}const Uu=new class{constructor(){this.operations={}}newMorphing(t,e,r,i,a){if(t in this.operations){const s=this.operations[t];s.to.tileID.key!==r.tileID.key&&(s.queued=r)}else this.operations[t]={startTime:i,phase:0,duration:a,from:e,to:r,queued:null}}getMorphValuesForProxy(t){if(!(t in this.operations))return null;const e=this.operations[t];return{from:e.from,to:e.to,phase:e.phase}}update(t){for(const e in this.operations){const r=this.operations[e];for(r.phase=(t-r.startTime)/r.duration;r.phase>=1||!this._validOp(r);)if(!this._nextOp(r,t)){delete this.operations[e];break}}}_nextOp(t,e){return!!t.queued&&(t.from=t.to,t.to=t.queued,t.queued=null,t.phase=0,t.startTime=e,!0)}_validOp(t){return t.from.hasData()&&t.to.hasData()}},V5={0:null,1:"TERRAIN_VERTEX_MORPHING"};function U5(t,e,r){if(e===0)return 0;const i=e<1&&r===514?.25/e:1;return 6*Math.pow(1.5,22-t)*Math.max(e,1)*i}function lN(t,e){const r=1<<t.z;return!e&&(t.x===0||t.x===r-1)||t.y===0||t.y===r-1}const Ax=t=>({u_matrix:t});function G5(t,e,r,i,a){if(a>0){const s=Ot.now(),c=(s-t.timeAdded)/a,u=e?(s-e.timeAdded)/a:-1,d=r.getSource(),p=i.coveringZoomLevel({tileSize:d.tileSize,roundZoom:d.roundZoom}),m=!e||Math.abs(e.tileID.overscaledZ-p)>Math.abs(t.tileID.overscaledZ-p),_=m&&t.refreshedUponExpiration?1:ze(m?c:1-u,0,1);return t.refreshedUponExpiration&&c>=1&&(t.refreshedUponExpiration=!1),e?{opacity:1,mix:1-_}:{opacity:_,mix:0}}return{opacity:1,mix:0}}class cN extends na{constructor(e){const r={type:"raster-dem",maxzoom:e.transform.maxZoom},i=new ac(rf(),null),a=gx("mock-dem",r,i,e.style);super("mock-dem",a,!1),a.setEventedParent(this),this._sourceLoaded=!0}_loadTile(e,r){e.state="loaded",r(null)}}class uN extends na{constructor(e){const r=gx("proxy",{type:"geojson",maxzoom:e.transform.maxZoom},new ac(rf(),null),e.style);super("proxy",r,!1),r.setEventedParent(this),this.map=this.getSource().map=e,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(e,r,i){if(e.freezeTileCoverage)return;this.transform=e;const a=e.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((s,c)=>{if(s[c.key]="",!this._tiles[c.key]){const u=new Wd(c,this._source.tileSize*c.overscaleFactor(),e.tileZoom);u.state="loaded",this._tiles[c.key]=u}return s},{});for(const s in this._tiles)s in a||(this.freeFBO(s),this._tiles[s].unloadVectorData(),delete this._tiles[s])}freeFBO(e){const r=this.proxyCachedFBO[e];if(r!==void 0){const i=Object.values(r);this.renderCachePool.push(...i),delete this.proxyCachedFBO[e]}}deallocRenderCache(){this.renderCache.forEach(e=>e.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class W5 extends Kr{constructor(e,r,i){super(e.overscaledZ,e.wrap,e.canonical.z,e.canonical.x,e.canonical.y),this.proxyTileKey=r,this.projMatrix=i}}class hN extends JF{constructor(e,r){super(),this.painter=e,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[i,a,s]=function(d){const p=new Gi,m=new Bn,_=131;p.reserve(17161),m.reserve(33800);const y=Ae/128,v=Ae+y/2,b=v+y;for(let T=-y;T<b;T+=y)for(let M=-y;M<b;M+=y){const C=M<0||M>v||T<0||T>v?24575:0,P=ze(Math.round(M),0,Ae),k=ze(Math.round(T),0,Ae);p.emplaceBack(P+C,k)}const S=(T,M)=>{const C=M*_+T;m.emplaceBack(C+1,C,C+_),m.emplaceBack(C+_,C+_+1,C+1)};for(let T=1;T<129;T++)for(let M=1;M<129;M++)S(M,T);return[0,129].forEach(T=>{for(let M=0;M<130;M++)S(M,T),S(T,M)}),[p,m,32768]}(),c=e.context;this.gridBuffer=c.createVertexBuffer(i,qs.members),this.gridIndexBuffer=c.createIndexBuffer(a),this.gridSegments=Gr.simpleSegment(0,0,i.length,a.length),this.gridNoSkirtSegments=Gr.simpleSegment(0,0,i.length,s),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new uN(r.map),this.orthoMatrix=ge.create(),ge.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,Ae,0,Ae,0,1);const u=c.gl;this._overlapStencilMode=new lr({func:u.GEQUAL,mask:255},0,255,u.KEEP,u.KEEP,u.REPLACE),this._previousZoom=e.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=r,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new cN(r.map),this._pendingGroundEffectLayers=[]}set style(e){e.on("data",this._onStyleDataEvent.bind(this)),e.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=e,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(e,r,i){if(e&&e.terrain){this._style!==e&&(this.style=e),this.enabled=!0;const a=e.terrain.properties;this.sourceCache=e.terrain.drapeRenderMode===0?this._mockSourceCache:e._getSourceCache(a.get("source")),this._exaggeration=a.get("exaggeration");const s=()=>{this.sourceCache.used&&re(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const c=this.getScaledDemTileSize();this.sourceCache.update(r,c,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,s(),this._initializing=!0),s(),r.updateElevation(!0,i),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(r),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(e){this._findCoveringTileCache[e]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const e=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||e.efficiency!==100&&re(`Terrain render cache efficiency is not optimal (${e.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${e.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(e){e.coord&&e.dataType==="source"?this._clearRenderCacheForTile(e.sourceCacheId,e.coord):e.dataType==="style"&&(this.invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const e in this._style._sourceCaches)this._style._sourceCaches[e].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(e=>e.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const e=2*this.proxySourceCache.getSource().tileSize;return[e,e]}set useVertexMorphing(e){this._useVertexMorphing=e}updateTileBinding(e){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const r=this.proxySourceCache,i=this.painter.transform;this._initializing&&(this._initializing=i._centerAltitude===0&&this.getAtPointOrZero(cr.fromLngLat(i.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const a=this.proxyCoords=r.getIds().map(d=>{const p=r.getTileByID(d).tileID;return p.projMatrix=i.calculateProjMatrix(p.toUnwrapped()),p});(function(d,p){const m=p.transform.pointCoordinate(p.transform.getCameraPoint()),_=new $(m.x,m.y);d.sort((y,v)=>{if(v.overscaledZ-y.overscaledZ)return v.overscaledZ-y.overscaledZ;const b=new $(y.canonical.x+(1<<y.canonical.z)*y.wrap,y.canonical.y),S=new $(v.canonical.x+(1<<v.canonical.z)*v.wrap,v.canonical.y),T=_.mult(1<<y.canonical.z);return T.x-=.5,T.y-=.5,T.distSqr(b)-T.distSqr(S)})})(a,this.painter),this._previousZoom=i.zoom;const s=this.proxyToSource||{};this.proxyToSource={},a.forEach(d=>{this.proxyToSource[d.key]={}}),this.terrainTileForTile={};const c=this._style._sourceCaches;for(const d in c){const p=c[d];if(!p.used||(p!==this.sourceCache&&this.resetTileLookupCache(p.id),this._setupProxiedCoordsForOrtho(p,e[d],s),p.usedForTerrain))continue;const m=e[d];p.getSource().reparseOverscaled&&this._assignTerrainTiles(m)}this.proxiedCoords[r.id]=a.map(d=>new W5(d,d.key,this.orthoMatrix)),this._assignTerrainTiles(a),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(s),this.renderingToTexture=!1,this._updateTimestamp=Ot.now();const u={};this._visibleDemTiles=[];for(const d of this.proxyCoords){const p=this.terrainTileForTile[d.key];if(!p)continue;const m=p.tileID.key;m in u||(this._visibleDemTiles.push(p),u[m]=m)}}_assignTerrainTiles(e){this._initializing||e.forEach(r=>{if(this.terrainTileForTile[r.key])return;const i=this._findTileCoveringTileID(r,this.sourceCache);i&&(this.terrainTileForTile[r.key]=i)})}_prepareDEMTextures(){const e=this.painter.context,r=e.gl;for(const i in this.terrainTileForTile){const a=this.terrainTileForTile[i],s=a.dem;!s||a.demTexture&&!a.needsDEMTextureUpload||(e.activeTexture.set(r.TEXTURE1),F5(this.painter,a,s))}}_prepareDemTileUniforms(e,r,i,a){if(!r||r.demTexture==null)return!1;const s=e.tileID.canonical,c=Math.pow(2,r.tileID.canonical.z-s.z),u=a||"";return i[`u_dem_tl${u}`]=[s.x*c%1,s.y*c%1],i[`u_dem_scale${u}`]=c,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const e=this.painter.context,r=e.gl;if(!this._emptyDepthBufferTexture){const i=new Sn({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new Dn(e,i,r.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let e=0;const r=this._visibleDemTiles.reduce((i,a)=>{if(!a.dem)return i;const s=a.dem.tree.minimums[0];return s>0&&e++,i+s},0);return e?r/e:0}_updateEmptyDEMTexture(){const e=this.painter.context,r=e.gl;e.activeTexture.set(r.TEXTURE2);const i=this._getLoadedAreaMinimum(),a=new Sn({width:1,height:1},new Uint8Array(Cu.pack(i,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let s=this._emptyDEMTexture;return s?s.update(a,{premultiply:!1}):s=this._emptyDEMTexture=new Dn(e,a,r.RGBA,{premultiply:!1}),s}setupElevationDraw(e,r,i){const a=this.painter.context,s=a.gl,c=(u=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:Cu.getUnpackVector(u),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var u;c.u_dem_size=this.sourceCache.getSource().tileSize,c.u_exaggeration=this.exaggeration();let d=null,p=null,m=1;if(i&&i.morphing&&this._useVertexMorphing){const _=i.morphing.srcDemTile,y=i.morphing.dstDemTile;m=i.morphing.phase,_&&y&&(this._prepareDemTileUniforms(e,_,c,"_prev")&&(p=_),this._prepareDemTileUniforms(e,y,c)&&(d=y))}if(p&&d?(a.activeTexture.set(s.TEXTURE2),d.demTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE),a.activeTexture.set(s.TEXTURE4),p.demTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE),c.u_dem_lerp=m):(d=this.terrainTileForTile[e.tileID.key],a.activeTexture.set(s.TEXTURE2),(this._prepareDemTileUniforms(e,d,c)?d.demTexture:this.emptyDEMTexture).bind(s.NEAREST,s.CLAMP_TO_EDGE)),a.activeTexture.set(s.TEXTURE3),i&&i.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE),this._depthFBO&&(c.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(s.NEAREST,s.CLAMP_TO_EDGE),c.u_depth_size_inv=[1,1]),i&&i.useMeterToDem&&d){const _=(1<<d.tileID.canonical.z)*jr(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;c.u_meter_to_dem=_}if(i&&i.labelPlaneMatrixInv&&(c.u_label_plane_matrix_inv=i.labelPlaneMatrixInv),r.setTerrainUniformValues(a,c),this.painter.transform.projection.name==="globe"){const _=this.globeUniformValues(this.painter.transform,e.tileID.canonical,i&&i.useDenormalizedUpVectorScale);r.setGlobeUniformValues(a,_)}}globeUniformValues(e,r,i){const a=e.projection;return{u_tile_tl_up:a.upVector(r,0,0),u_tile_tr_up:a.upVector(r,Ae,0),u_tile_br_up:a.upVector(r,Ae,Ae),u_tile_bl_up:a.upVector(r,0,Ae),u_tile_up_scale:i?Em(1):a.upVectorScale(r,e.center.lat,e.worldSize).metersToTile}}renderToBackBuffer(e){const r=this.painter,i=this.painter.context;e.length!==0&&(i.bindFramebuffer.set(null),i.viewport.set([0,0,r.width,r.height]),r.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(a,s,c,u,d){if(a.transform.projection.name==="globe")(function(p,m,_,y,v){const b=p.context,S=b.gl;let T,M;const C=p.transform,P=bT(p,b,C),k=Q=>{if(M===Q)return;const K=[V5[Q],"PROJECTION_GLOBE_VIEW"];P&&K.push("CUSTOM_ANTIALIASING"),T=p.useProgram("globeRaster",null,K),M=Q},z=p.colorModeForRenderPass(),L=new Nt(S.LEQUAL,Nt.ReadWrite,p.depthRangeFor3D);Uu.update(v);const B=function(Q){const K=Q.pixelsPerMeter,fe=K/jr(1,Q.center.lat),he=ge.identity(new Float64Array(16));return ge.translate(he,he,[Q.point.x,Q.point.y,0]),ge.scale(he,he,[fe,fe,K]),Float32Array.from(he)}(C),W=[ei(C.center.lng),ai(C.center.lat)],Z=p.globeSharedBuffers,X=[C.width*Ot.devicePixelRatio,C.height*Ot.devicePixelRatio],H=Float32Array.from(C.globeMatrix),J={useDenormalizedUpVectorScale:!0};{const Q=p.transform,K=U5(Q.zoom,m.exaggeration(),m.sourceCache._source.tileSize);M=-1;const fe=S.TRIANGLES;for(const he of y){const _e=_.getTile(he),oe=lr.disabled,me=m.prevTerrainTileForTile[he.key],ve=m.terrainTileForTile[he.key];$5(me,ve)&&Uu.newMorphing(he.key,me,ve,v,250),b.activeTexture.set(S.TEXTURE0),_e.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE);const Ce=Uu.getMorphValuesForProxy(he.key),Se=Ce?1:0;Ce&&en(J,{morphing:{srcDemTile:Ce.from,dstDemTile:Ce.to,phase:Ne(Ce.phase)}});const Je=Sm(he.canonical),Ge=UO(Je.getCenter().lat),je=VO(he.canonical,Je,Ge,Q.worldSize/Q._pixelsPerMercatorPixel),Ve=vu(ea(he.canonical)),nt=j5(Q.projMatrix,H,B,Ve,Qn(Q.zoom),W,Q.frustumCorners.TL,Q.frustumCorners.TR,Q.frustumCorners.BR,Q.frustumCorners.BL,Q.globeCenterInViewSpace,Q.globeRadius,X,K,je);if(k(Se),T&&(m.setupElevationDraw(_e,T,J),p.uploadCommonUniforms(b,T,he.toUnwrapped()),Z)){const[wt,pt,dt]=Z.getGridBuffers(Ge,K!==0);T.draw(p,fe,L,oe,z,ur.backCCW,nt,"globe_raster",wt,pt,dt)}}}if(Z){const Q=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];P&&Q.push("CUSTOM_ANTIALIASING"),T=p.useProgram("globeRaster",null,Q);for(const K of y){const{x:fe,y:he,z:_e}=K.canonical,oe=he===0,me=he===(1<<_e)-1,[ve,Ce,Se,Je]=Z.getPoleBuffers(_e);if(Je&&(oe||me)){const Ge=_.getTile(K);b.activeTexture.set(S.TEXTURE0),Ge.texture.bind(S.LINEAR,S.CLAMP_TO_EDGE);let je=$O(_e,fe,C);const Ve=vu(ea(K.canonical)),nt=(wt,pt)=>wt.draw(p,S.TRIANGLES,L,lr.disabled,z,ur.disabled,j5(C.projMatrix,je,je,Ve,0,W,C.frustumCorners.TL,C.frustumCorners.TR,C.frustumCorners.BR,C.frustumCorners.BL,C.globeCenterInViewSpace,C.globeRadius,X,0),"globe_pole_raster",pt,Se,Je);m.setupElevationDraw(Ge,T,J),p.uploadCommonUniforms(b,T,K.toUnwrapped()),oe&&nt(T,ve),me&&(je=ge.scale(ge.create(),je,[1,-1,1]),nt(T,Ce))}}}})(a,s,c,u,d);else{const p=a.context,m=p.gl;let _,y;const v=a.shadowRenderer,b=k=>{y!==k&&(_=a.useProgram("terrainRaster",null,[V5[k]]),y=k)},S=a.colorModeForRenderPass(),T=new Nt(m.LEQUAL,Nt.ReadWrite,a.depthRangeFor3D);Uu.update(d);const M=a.transform,C=U5(M.zoom,s.exaggeration(),s.sourceCache._source.tileSize);let P=[0,0,0];if(v){const k=a.style.directionalLight,z=a.style.ambientLight;k&&z&&(P=Cx(k,z))}{y=-1;const k=m.TRIANGLES,[z,L]=[s.gridIndexBuffer,s.gridSegments];for(const B of u){const W=c.getTile(B),Z=lr.disabled,X=s.prevTerrainTileForTile[B.key],H=s.terrainTileForTile[B.key];$5(X,H)&&Uu.newMorphing(B.key,X,H,d,250),p.activeTexture.set(m.TEXTURE0),W.texture.bind(m.LINEAR,m.CLAMP_TO_EDGE,m.LINEAR_MIPMAP_NEAREST);const J=Uu.getMorphValuesForProxy(B.key),Q=J?1:0;let K;J&&(K={morphing:{srcDemTile:J.from,dstDemTile:J.to,phase:Ne(J.phase)}});const fe=N5(B.projMatrix,lN(B.canonical,M.renderWorldCopies)?C/10:C,P);if(b(Q),!_)continue;s.setupElevationDraw(W,_,K);const he=B.toUnwrapped();v&&v.setupShadows(he,_),a.uploadCommonUniforms(p,_,he),_.draw(a,k,T,Z,S,ur.backCCW,fe,"terrain_raster",s.gridBuffer,z,L)}}}}(r,this,this.proxySourceCache,e,this._updateTimestamp),this.renderingToTexture=!0,r.gpuTimingDeferredRenderEnd(),e.splice(0,e.length))}renderBatch(e){if(this._drapedRenderBatches.length===0)return e+1;this.renderingToTexture=!0;const r=this.painter,i=this.painter.context,a=this.proxySourceCache,s=this.proxiedCoords[a.id],c=this._drapedRenderBatches.shift(),u=r.style.order,d=[];let p=0;for(const m of s){const _=a.getTileByID(m.proxyTileKey),y=a.proxyCachedFBO[m.key]?a.proxyCachedFBO[m.key][e]:void 0,v=y!==void 0?a.renderCache[y]:this.pool[p++],b=y!==void 0;if(_.texture=v.tex,b&&!v.dirty){d.push(_.tileID);continue}let S;i.bindFramebuffer.set(v.fb.framebuffer),this.renderedToTile=!1,v.dirty&&(i.clear({color:Zt.transparent,stencil:0}),v.dirty=!1);for(let T=c.start;T<=c.end;++T){const M=r.style._layers[u[T]];if(M.isHidden(r.transform.zoom))continue;const C=r.style._getLayerSourceCache(M),P=C?this.proxyToSource[m.key][C.id]:[m];if(!P)continue;const k=P;i.viewport.set([0,0,v.fb.width,v.fb.height]),S!==(C?C.id:null)&&(this._setupStencil(v,P,M,C),S=C?C.id:null),r.renderLayer(r,C,M,k)}if(this._drapedRenderBatches.length===0)for(const T of this._pendingGroundEffectLayers){const M=r.style._layers[u[T]];if(M.isHidden(r.transform.zoom))continue;const C=r.style._getLayerSourceCache(M),P=C?this.proxyToSource[m.key][C.id]:[m];if(!P)continue;const k=P;i.viewport.set([0,0,v.fb.width,v.fb.height]),S!==(C?C.id:null)&&(this._setupStencil(v,P,M,C),S=C?C.id:null),r.renderLayer(r,C,M,k)}this.renderedToTile?(v.dirty=!0,d.push(_.tileID)):b||--p,p===5&&(p=0,this.renderToBackBuffer(d))}return this.renderToBackBuffer(d),this.renderingToTexture=!1,i.bindFramebuffer.set(null),i.viewport.set([0,0,r.width,r.height]),c.end+1}postRender(){}renderCacheEfficiency(e){const r=e.order.length;if(r===0)return{efficiency:100};let i,a=0,s=0,c=!1;for(let u=0;u<r;++u){const d=e._layers[e.order[u]];this._style.isLayerDraped(d)?(c&&++a,++s):c||(c=!0,i=d.id)}return s===0?{efficiency:100}:{efficiency:100*(1-a/s),firstUndrapedLayer:i}}getMinElevationBelowMSL(){let e=0;return this._visibleDemTiles.filter(r=>r.dem).forEach(r=>{e=Math.min(e,r.dem.tree.minimums[0])}),e===0?e:(e-30)*this._exaggeration}raycast(e,r,i){if(!this._visibleDemTiles)return null;const a=this._visibleDemTiles.filter(s=>s.dem).map(s=>{const c=s.tileID,u=1<<c.overscaledZ,{x:d,y:p}=c.canonical,m=d/u,_=(d+1)/u,y=p/u,v=(p+1)/u;return{minx:m,miny:y,maxx:_,maxy:v,t:s.dem.tree.raycastRoot(m,y,_,v,e,r,i),tile:s}});a.sort((s,c)=>(s.t!==null?s.t:Number.MAX_VALUE)-(c.t!==null?c.t:Number.MAX_VALUE));for(const s of a){if(s.t==null)return null;const c=s.tile.dem.tree.raycast(s.minx,s.miny,s.maxx,s.maxy,e,r,i);if(c!=null)return c}return null}_createFBO(){const e=this.painter.context,r=e.gl,i=this.drapeBufferSize;e.activeTexture.set(r.TEXTURE0);const a=new Dn(e,{width:i[0],height:i[1],data:null},r.RGBA);a.bind(r.LINEAR,r.CLAMP_TO_EDGE);const s=e.createFramebuffer(i[0],i[1],!0,null);return s.colorAttachment.set(a.texture),s.depthAttachment=new MB(e,s.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=e.createRenderbuffer(e.gl.DEPTH_STENCIL,i[0],i[1]),this._stencilRef=0,s.depthAttachment.set(this._sharedDepthStencil),e.clear({stencil:0})):s.depthAttachment.set(this._sharedDepthStencil),e.extTextureFilterAnisotropic&&!e.extTextureFilterAnisotropicForceOff&&r.texParameterf(r.TEXTURE_2D,e.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,e.extTextureFilterAnisotropicMax),{fb:s,tex:a,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const e in this._style._sourceCaches)if(this._style._sourceCaches[e].hasTransition())return!0;return this._style.order.some(e=>{const r=this._style._layers[e],i=r.isHidden(this.painter.transform.zoom);return r.type==="custom"?!i&&r.shouldRedrape():!i&&r.hasTransition()})}_clearLineLayersFromRenderCache(){let e=!1;for(const i of this._style._getSources())if(i instanceof e5){e=!0;break}if(!e)return;const r={};for(let i=0;i<this._style.order.length;++i){const a=this._style._layers[this._style.order[i]],s=this._style._getLayerSourceCache(a);if(s&&!r[s.id]&&!a.isHidden(this.painter.transform.zoom)&&a.type==="line"&&a.widthExpression()instanceof Jp){r[s.id]=!0;for(const c of this.proxyCoords){const u=this.proxyToSource[c.key][s.id];if(u)for(const d of u)this._clearRenderCacheForTile(s.id,d)}}}}_clearRasterLayersFromRenderCache(){let e=!1;for(const i in this._style._sourceCaches)if(this._style._sourceCaches[i]._source instanceof ef){e=!0;break}if(!e)return;const r={};for(let i=0;i<this._style.order.length;++i){const a=this._style._layers[this._style.order[i]],s=this._style._getLayerSourceCache(a);if(!s||r[s.id]||a.isHidden(this.painter.transform.zoom)||a.type!=="raster")continue;const c=a.paint.get("raster-fade-duration");for(const u of this.proxyCoords){const d=this.proxyToSource[u.key][s.id];if(d)for(const p of d){const m=G5(s.getTile(p),s.findLoadedParent(p,0),s,this.painter.transform,c);(m.opacity!==1||m.mix!==0)&&this._clearRenderCacheForTile(s.id,p)}}}}_setupDrapedRenderBatches(){const e=this._style.order,r=e.length;if(r===0)return;const i=[];this._pendingGroundEffectLayers=[];let a,s=0,c=this._style._layers[e[s]];for(;!this._style.isLayerDraped(c)&&c.isHidden(this.painter.transform.zoom)&&++s<r;)c=this._style._layers[e[s]];for(;s<r;++s){const u=this._style._layers[e[s]];u.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(u)?a===void 0&&(a=s):(u.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(s),a!==void 0&&(i.push({start:a,end:s-1}),a=void 0)))}if(a!==void 0&&i.push({start:a,end:s-1}),i.length!==0){const u=i[i.length-1];this._pendingGroundEffectLayers.every(p=>p>u.end)||re("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=i}_setupRenderCache(e){const r=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,r.renderCache.length>r.renderCachePool.length){const c=Object.values(r.proxyCachedFBO);r.proxyCachedFBO={};for(let u=0;u<c.length;++u){const d=Object.values(c[u]);r.renderCachePool.push(...d)}}return}this._clearRasterLayersFromRenderCache();const i=this.proxyCoords,a=this._tilesDirty;for(let c=i.length-1;c>=0;c--){const u=i[c];if(r.getTileByID(u.key),r.proxyCachedFBO[u.key]!==void 0){const d=e[u.key],p=this.proxyToSource[u.key];let m=0;for(const _ in p){const y=p[_],v=d[_];if(!v||v.length!==y.length||y.some((b,S)=>b!==v[S]||a[_]&&a[_].hasOwnProperty(b.key))){m=-1;break}++m}for(const _ in r.proxyCachedFBO[u.key])r.renderCache[r.proxyCachedFBO[u.key][_]].dirty=m<0||m!==Object.values(d).length}}const s=[...this._drapedRenderBatches];s.sort((c,u)=>u.end-u.start-(c.end-c.start));for(const c of s)for(const u of i){if(r.proxyCachedFBO[u.key])continue;let d=r.renderCachePool.pop();d===void 0&&r.renderCache.length<50&&(d=r.renderCache.length,r.renderCache.push(this._createFBO())),d!==void 0&&(r.proxyCachedFBO[u.key]={},r.proxyCachedFBO[u.key][c.start]=d,r.renderCache[d].dirty=!0)}this._tilesDirty={}}_setupStencil(e,r,i,a){if(!a||!this._sourceTilesOverlap[a.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const s=this.painter.context,c=s.gl;if(r.length<=1)return void(this._overlapStencilType=!1);let u;if(i.isTileClipped())u=r.length,this._overlapStencilMode.test={func:c.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(r[0].overscaledZ>r[r.length-1].overscaledZ))return void(this._overlapStencilType=!1);u=1,this._overlapStencilMode.test={func:c.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+u>255&&(s.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=u,this._overlapStencilMode.ref=this._stencilRef,i.isTileClipped()&&this._renderTileClippingMasks(r,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(e){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[e.key]),this._overlapStencilMode):lr.disabled}_renderTileClippingMasks(e,r){const i=this.painter,a=this.painter.context,s=a.gl;i._tileClippingMaskIDs={},a.setColorMode(Lr.disabled),a.setDepthMode(Nt.disabled);const c=i.useProgram("clippingMask");for(const u of e){const d=i._tileClippingMaskIDs[u.key]=--r;c.draw(i,s.TRIANGLES,Nt.disabled,new lr({func:s.ALWAYS,mask:0},d,255,s.KEEP,s.KEEP,s.REPLACE),Lr.disabled,ur.disabled,Ax(u.projMatrix),"$clipping",i.tileExtentBuffer,i.quadTriangleIndexBuffer,i.tileExtentSegments)}}pointCoordinate(e){const r=this.painter.transform;if(e.x<0||e.x>r.width||e.y<0||e.y>r.height)return null;const i=[e.x,e.y,1,1];Wr.transformMat4(i,i,r.pixelMatrixInverse),Wr.scale(i,i,1/i[3]),i[0]/=r.worldSize,i[1]/=r.worldSize;const a=r._camera.position,s=jr(1,r.center.lat),c=[a[0],a[1],a[2]/s,0],u=ie.subtract([],i.slice(0,3),c);ie.normalize(u,u);const d=this.raycast(c,u,this._exaggeration);return d!==null&&d?(ie.scaleAndAdd(c,c,u,d),c[3]=c[2],c[2]*=s,c):null}drawDepth(){const e=this.painter,r=e.context,i=this.proxySourceCache,a=Math.ceil(e.width),s=Math.ceil(e.height);if(!this._depthFBO||this._depthFBO.width===a&&this._depthFBO.height===s||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const c=r.gl,u=r.createFramebuffer(a,s,!0,"renderbuffer");r.activeTexture.set(c.TEXTURE0);const d=new Dn(r,{width:a,height:s,data:null},c.RGBA);d.bind(c.NEAREST,c.CLAMP_TO_EDGE),u.colorAttachment.set(d.texture);const p=r.createRenderbuffer(r.gl.DEPTH_COMPONENT16,a,s);u.depthAttachment.set(p),this._depthFBO=u,this._depthTexture=d}r.bindFramebuffer.set(this._depthFBO.framebuffer),r.viewport.set([0,0,a,s]),function(c,u,d,p){if(c.transform.projection.name==="globe")return;const m=c.context,_=m.gl;m.clear({depth:1});const y=c.useProgram("terrainDepth"),v=new Nt(_.LESS,Nt.ReadWrite,c.depthRangeFor3D);for(const b of p){const S=d.getTile(b),T=N5(b.projMatrix,0,[0,0,0]);u.setupElevationDraw(S,y),y.draw(c,_.TRIANGLES,v,lr.disabled,Lr.unblended,ur.backCCW,T,"terrain_depth",u.gridBuffer,u.gridIndexBuffer,u.gridNoSkirtSegments)}}(e,this,i,this.proxyCoords)}_setupProxiedCoordsForOrtho(e,r,i){if(e.getSource()instanceof sc)return this._setupProxiedCoordsForImageSource(e,r,i);this._findCoveringTileCache[e.id]=this._findCoveringTileCache[e.id]||{};const a=this.proxiedCoords[e.id]=[],s=this.proxyCoords;for(let u=0;u<s.length;u++){const d=s[u],p=this._findTileCoveringTileID(d,e);if(p){const m=this._createProxiedId(d,p,i[d.key]&&i[d.key][e.id]);a.push(m),this.proxyToSource[d.key][e.id]=[m]}}let c=!1;for(let u=0;u<r.length;u++){const d=e.getTile(r[u]);if(!d||!d.hasData())continue;const p=this._findTileCoveringTileID(d.tileID,this.proxySourceCache);if(p&&p.tileID.canonical.z!==d.tileID.canonical.z){const m=this.proxyToSource[p.tileID.key][e.id],_=this._createProxiedId(p.tileID,d,i[p.tileID.key]&&i[p.tileID.key][e.id]);m?m.splice(m.length-1,0,_):this.proxyToSource[p.tileID.key][e.id]=[_],a.push(_),c=!0}}this._sourceTilesOverlap[e.id]=c}_setupProxiedCoordsForImageSource(e,r,i){if(!e.getSource().loaded())return;const a=this.proxiedCoords[e.id]=[],s=this.proxyCoords,c=e.getSource(),u=new $(c.tileID.x,c.tileID.y)._div(1<<c.tileID.z),d=c.coordinates.map(cr.fromLngLat).reduce((m,_)=>(m.min.x=Math.min(m.min.x,_.x-u.x),m.min.y=Math.min(m.min.y,_.y-u.y),m.max.x=Math.max(m.max.x,_.x-u.x),m.max.y=Math.max(m.max.y,_.y-u.y),m),{min:new $(Number.MAX_VALUE,Number.MAX_VALUE),max:new $(-Number.MAX_VALUE,-Number.MAX_VALUE)}),p=(m,_)=>{const y=m.wrap+m.canonical.x/(1<<m.canonical.z),v=m.canonical.y/(1<<m.canonical.z),b=Ae/(1<<m.canonical.z),S=_.wrap+_.canonical.x/(1<<_.canonical.z),T=_.canonical.y/(1<<_.canonical.z);return y+b<S+d.min.x||y>S+d.max.x||v+b<T+d.min.y||v>T+d.max.y};for(let m=0;m<s.length;m++){const _=s[m];for(let y=0;y<r.length;y++){const v=e.getTile(r[y]);if(!v||!v.hasData()||p(_,v.tileID))continue;const b=this._createProxiedId(_,v,i[_.key]&&i[_.key][e.id]),S=this.proxyToSource[_.key][e.id];S?S.push(b):this.proxyToSource[_.key][e.id]=[b],a.push(b)}}}_createProxiedId(e,r,i){let a=this.orthoMatrix;if(i){const s=i.find(c=>c.key===r.tileID.key);if(s)return s}if(r.tileID.key!==e.key){const s=e.canonical.z-r.tileID.canonical.z;let c,u,d;a=ge.create();const p=r.tileID.wrap-e.wrap<<e.overscaledZ;s>0?(c=Ae>>s,u=c*((r.tileID.canonical.x<<s)-e.canonical.x+p),d=c*((r.tileID.canonical.y<<s)-e.canonical.y)):(c=Ae<<-s,u=Ae*(r.tileID.canonical.x-(e.canonical.x+p<<-s)),d=Ae*(r.tileID.canonical.y-(e.canonical.y<<-s))),ge.ortho(a,0,c,0,c,0,1),ge.translate(a,a,[u,d,0])}return new W5(r.tileID,e.key,a)}_findTileCoveringTileID(e,r){let i=r.getTile(e);if(i&&i.hasData())return i;const a=this._findCoveringTileCache[r.id],s=a[e.key];if(i=s?r.getTileByID(s):null,i&&i.hasData()||s===null)return i;let c=i?i.tileID:e,u=c.overscaledZ;const d=r.getSource().minzoom,p=[];if(!s){const _=r.getSource().maxzoom;if(e.canonical.z>=_){const y=e.canonical.z-_;r.getSource().reparseOverscaled?(u=Math.max(e.canonical.z+2,r.transform.tileZoom),c=new Kr(u,e.wrap,_,e.canonical.x>>y,e.canonical.y>>y)):y!==0&&(u=_,c=new Kr(u,e.wrap,_,e.canonical.x>>y,e.canonical.y>>y))}c.key!==e.key&&(p.push(c.key),i=r.getTile(c))}const m=_=>{p.forEach(y=>{a[y]=_}),p.length=0};for(u-=1;u>=d&&(!i||!i.hasData());u--){i&&m(i.tileID.key);const _=c.calculateScaledKey(u);if(i=r.getTileByID(_),i&&i.hasData())break;const y=a[_];if(y===null)break;y===void 0?p.push(_):i=r.getTileByID(y)}return m(i?i.tileID.key:null),i&&i.hasData()?i:null}findDEMTileFor(e){return this.enabled?this._findTileCoveringTileID(e,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(e,r){let i=this._tilesDirty[e];i||(i=this._tilesDirty[e]={}),i[r.key]=!0}}function dN(t,e,r){const i=function(u,d,p){const m=ie.dot(d,u),_=ie.dot(p,[.2126,.7152,.0722]),y=(b,S,T)=>(1-T)*b+T*S,v=y(1-.3*Math.min(_,1),1,Math.min(m+1,1));return y(.92,1,Math.asin(ze(d[2],-1,1))/Math.PI+.5)*v}(t,[0,0,1],e),a=[0,0,0];ie.scale(a,r.slice(0,3),i);const s=[0,0,0];ie.scale(s,e.slice(0,3),t[2]);const c=[0,0,0];return ie.add(c,a,s),br(c)}const fN=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],pN=["stars","fillExtrusion","fillExtrusionGroundEffect","model","symbolSDF","symbolIcon","symbolTextAndIcon"];class H5{static cacheKey(e,r,i,a){let s=`${r}${a?a.cacheKey:""}`;for(const c of i)e.usedDefines.includes(c)&&(s+=`/${c}`);return s}constructor(e,r,i,a,s,c){const u=e.gl;this.program=u.createProgram(),this.configuration=a,this.name=r,this.fixedDefines=[...c];const d=function(M){const C=[];for(let P=0;P<M.length;P++){if(M[P]===null)continue;const k=M[P].split(" ");C.push(k.pop())}return C}(i.staticAttributes),p=a?a.getBinderAttributes():[],m=d.concat(p);let _=a?a.defines():[];_=_.concat(c.map(M=>`#define ${M}`));const y=e.isWebGL2?`#version 300 es
`:"",v=y+_.concat(e.extStandardDerivatives&&y.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(Mx):Mx,Mx,D5,L5,z5.fragmentSource,Sx.fragmentSource,Tx.fragmentSource,i.fragmentSource).join(`
`),b=y+_.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,D5,L5,z5.vertexSource,Sx.vertexSource,Tx.vertexSource,R5.vertexSource,i.vertexSource).join(`
`),S=u.createShader(u.FRAGMENT_SHADER);if(u.isContextLost())return void(this.failedToCreate=!0);u.shaderSource(S,v),u.compileShader(S),u.attachShader(this.program,S);const T=u.createShader(u.VERTEX_SHADER);if(u.isContextLost())this.failedToCreate=!0;else{u.shaderSource(T,b),u.compileShader(T),u.attachShader(this.program,T),this.attributes={},this.numAttributes=m.length;for(let M=0;M<this.numAttributes;M++)if(m[M]){const C=m[M].startsWith("a_")?m[M]:`a_${m[M]}`;u.bindAttribLocation(this.program,M,C),this.attributes[C]=M}u.linkProgram(this.program),u.deleteShader(T),u.deleteShader(S),this.fixedUniforms=s(e),this.binderUniforms=a?a.getUniforms(e):[],c.includes("TERRAIN")&&(this.terrainUniforms=(M=>({u_dem:new Qt(M),u_dem_prev:new Qt(M),u_dem_unpack:new ao(M),u_dem_tl:new sr(M),u_dem_scale:new Ye(M),u_dem_tl_prev:new sr(M),u_dem_scale_prev:new Ye(M),u_dem_size:new Ye(M),u_dem_lerp:new Ye(M),u_exaggeration:new Ye(M),u_depth:new Qt(M),u_depth_size_inv:new sr(M),u_meter_to_dem:new Ye(M),u_label_plane_matrix_inv:new Gt(M)}))(e)),c.includes("GLOBE")&&(this.globeUniforms=(M=>({u_tile_tl_up:new Vt(M),u_tile_tr_up:new Vt(M),u_tile_br_up:new Vt(M),u_tile_bl_up:new Vt(M),u_tile_up_scale:new Ye(M)}))(e)),c.includes("FOG")&&(this.fogUniforms=(M=>({u_fog_matrix:new Gt(M),u_fog_range:new sr(M),u_fog_color:new ao(M),u_fog_horizon_blend:new Ye(M),u_fog_temporal_offset:new Ye(M),u_frustum_tl:new Vt(M),u_frustum_tr:new Vt(M),u_frustum_br:new Vt(M),u_frustum_bl:new Vt(M),u_globe_pos:new Vt(M),u_globe_radius:new Ye(M),u_globe_transition:new Ye(M),u_is_globe:new Qt(M),u_viewport:new sr(M)}))(e)),c.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(M=>({u_lighting_ambient_color:new Vt(M),u_lighting_directional_dir:new Vt(M),u_lighting_directional_color:new Vt(M),u_ground_radiance:new Vt(M)}))(e)),c.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(M=>({u_light_matrix_0:new Gt(M),u_light_matrix_1:new Gt(M),u_fade_range:new sr(M),u_shadow_normal_offset:new Vt(M),u_shadow_intensity:new Ye(M),u_texel_size:new Ye(M),u_shadow_direction:new Vt(M),u_shadow_bias:new Vt(M),u_shadowmap_0:new Qt(M),u_shadowmap_1:new Qt(M)}))(e))}}setTerrainUniformValues(e,r){if(!this.terrainUniforms)return;const i=this.terrainUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const a in r)i[a]&&i[a].set(this.program,a,r[a])}}setGlobeUniformValues(e,r){if(!this.globeUniforms)return;const i=this.globeUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const a in r)i[a]&&i[a].set(this.program,a,r[a])}}setFogUniformValues(e,r){if(!this.fogUniforms)return;const i=this.fogUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const a in r)i[a].set(this.program,a,r[a])}}setLightsUniformValues(e,r){if(!this.lightsUniforms)return;const i=this.lightsUniforms;if(!this.failedToCreate){e.program.set(this.program);for(const a in r)i[a].set(this.program,a,r[a])}}setShadowUniformValues(e,r){if(this.failedToCreate||!this.shadowUniforms)return;const i=this.shadowUniforms;e.program.set(this.program);for(const a in r)i[a].set(this.program,a,r[a])}_drawDebugWireframe(e,r,i,a,s,c,u,d,p){const m=e.options.wireframe;if(m.terrain===!1&&m.layers2D===!1&&m.layers3D===!1)return;const _=e.context;if(!_.isWebGL2||!(()=>!(!m.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!m.layers2D||e._terrain&&e._terrain.renderingToTexture||!fN.includes(this.name))||!(!m.layers3D||!pN.includes(this.name)))())return;const y=_.gl,v=e.wireframeDebugCache.getLinesFromTrianglesBuffer(e.frameCounter,s,_);if(!v)return;const b=[...this.fixedDefines];b.push("DEBUG_WIREFRAME");const S=e.useProgram(this.name,this.configuration,b);_.program.set(S.program);const T=(M,C,P)=>{if(C[M]&&P[M])for(const k in C[M])P[M][k]&&P[M][k].set(P.program,k,C[M][k].current)};p&&p.setUniforms(S.program,_,S.binderUniforms,u,{zoom:d}),T("fixedUniforms",this,S),T("terrainUniforms",this,S),T("globeUniforms",this,S),T("fogUniforms",this,S),T("lightsUniforms",this,S),T("shadowUniforms",this,S),v.bind(),_.setColorMode(new Lr([y.ONE,y.ONE_MINUS_SRC_ALPHA,y.ZERO,y.ONE],Zt.transparent,[!0,!0,!0,!1])),_.setDepthMode(new Nt(r.func===y.LESS?y.LEQUAL:r.func,Nt.ReadOnly,r.range)),_.setStencilMode(lr.disabled),y.drawElements(y.LINES,3*c.primitiveLength*2,y.UNSIGNED_SHORT,3*c.primitiveOffset*2*2),s.bind(),_.program.set(this.program),_.setDepthMode(r),_.setStencilMode(i),_.setColorMode(a)}draw(e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T){const M=e.context,C=M.gl;if(this.failedToCreate)return;M.program.set(this.program),M.setDepthMode(i),M.setStencilMode(a),M.setColorMode(s),M.setCullFace(c);for(const k of Object.keys(this.fixedUniforms))this.fixedUniforms[k].set(this.program,k,u[k]);b&&b.setUniforms(this.program,M,this.binderUniforms,y,{zoom:v});const P={[C.LINES]:2,[C.TRIANGLES]:3,[C.LINE_STRIP]:1}[r];for(const k of _.get()){const z=k.vaos||(k.vaos={});(z[d]||(z[d]=new rN)).bind(M,this,p,b?b.getPaintVertexBuffers():[],m,k.vertexOffset,S||[]),M.isWebGL2&&T&&T>1?C.drawElementsInstanced(r,k.primitiveLength*P,C.UNSIGNED_SHORT,k.primitiveOffset*P*2,T):C.drawElements(r,k.primitiveLength*P,C.UNSIGNED_SHORT,k.primitiveOffset*P*2),r===C.TRIANGLES&&this._drawDebugWireframe(e,i,a,s,m,k,y,v,b)}}}function q5(t,e){const r=Math.pow(2,e.tileID.overscaledZ),i=e.tileSize*Math.pow(2,t.transform.tileZoom)/r,a=i*(e.tileID.canonical.x+e.tileID.wrap*r),s=i*e.tileID.canonical.y;return{u_image:0,u_texsize:e.imageAtlasTexture.size,u_tile_units_to_pixels:1/oc(e,1,t.transform.tileZoom),u_pixel_coord_upper:[a>>16,s>>16],u_pixel_coord_lower:[65535&a,65535&s]}}const mN=ge.create(),Z5=(t,e,r,i,a,s,c,u,d,p,m,_,y,v,b)=>{const S=e.style.light,T=S.properties.get("position"),M=[T.x,T.y,T.z],C=Ii.create();S.properties.get("anchor")==="viewport"&&(Ii.fromRotation(C,-e.transform.angle),ie.transformMat3(M,M,C));const P=S.properties.get("color"),k=e.transform,z={u_matrix:t,u_lightpos:M,u_lightintensity:S.properties.get("intensity"),u_lightcolor:[P.r,P.g,P.b],u_vertical_gradient:+r,u_opacity:i,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:mN,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:a,u_edge_radius:s,u_flood_light_color:_,u_vertical_scale:y,u_flood_light_intensity:v,u_ground_shadow_factor:b};return k.projection.name==="globe"&&(z.u_tile_id=[c.canonical.x,c.canonical.y,1<<c.canonical.z],z.u_zoom_transition=d,z.u_inv_rot_matrix=m,z.u_merc_center=p,z.u_up_dir=k.projection.upVector(new ns(0,0,0),p[0]*Ae,p[1]*Ae),z.u_height_lift=u),z},gN=(t,e,r)=>({u_matrix:t,u_edge_radius:e,u_vertical_scale:r}),_N=(t,e,r,i,a,s,c,u,d,p,m,_,y,v)=>{const b=Z5(t,e,r,i,a,s,c,d,p,m,_,y,v,1,[0,0,0]),S={u_height_factor:-Math.pow(2,c.overscaledZ)/u.tileSize/8};return Oe(b,q5(e,u),S)},yN=(t,e,r,i,a,s,c,u,d)=>({u_matrix:e,u_opacity:r,u_ao_pass:i?1:0,u_meter_to_tile:a,u_ao:s,u_flood_light_intensity:c,u_flood_light_color:u,u_attenuation:d,u_fb:0}),X5=(t,e)=>({u_matrix:t,u_emissive_strength:e}),Y5=(t,e,r,i)=>Oe(X5(t,e),q5(r,i)),vN=(t,e,r)=>({u_matrix:t,u_world:r,u_emissive_strength:e}),xN=(t,e,r,i,a)=>Oe(Y5(t,e,r,i),{u_world:a}),bN=ge.create(),wN=(t,e,r,i,a,s)=>{const c=t.transform,u=c.projection.name==="globe";let d;if(s.paint.get("circle-pitch-alignment")==="map")if(u){const m=vT(c.zoom,e.canonical)*c._pixelsPerMercatorPixel;d=Float32Array.from([m,0,0,m])}else d=c.calculatePixelsToTileUnitsMatrix(r);else d=new Float32Array([c.pixelsToGLUnits[0],0,0,c.pixelsToGLUnits[1]]);const p={u_camera_to_center_distance:c.cameraToCenterDistance,u_matrix:t.translatePosMatrix(e.projMatrix,r,s.paint.get("circle-translate"),s.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Ot.devicePixelRatio,u_extrude_scale:d,u_inv_rot_matrix:bN,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:s.paint.get("circle-emissive-strength")};if(u){p.u_inv_rot_matrix=i,p.u_merc_center=a,p.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],p.u_zoom_transition=Qn(c.zoom);const m=a[0]*Ae,_=a[1]*Ae;p.u_up_dir=c.projection.upVector(new ns(0,0,0),m,_)}return p},EN=t=>{const e=[];return t.paint.get("circle-pitch-alignment")==="map"&&e.push("PITCH_WITH_MAP"),t.paint.get("circle-pitch-scale")==="map"&&e.push("SCALE_WITH_MAP"),e},SN=(t,e,r,i)=>{const a=Ae/r.tileSize;return{u_matrix:t,u_camera_to_center_distance:e.getCameraToCenterDistance(i),u_extrude_scale:[e.pixelsToGLUnits[0]/a,e.pixelsToGLUnits[1]/a]}},K5=(t,e,r=1)=>({u_matrix:t,u_color:e,u_overlay:0,u_overlay_scale:r}),TN=ge.create(),MN=(t,e,r,i,a,s,c)=>{const u=t.transform,d=u.projection.name==="globe",p=d?vT(u.zoom,e.canonical)*u._pixelsPerMercatorPixel:oc(r,1,s),m={u_matrix:e.projMatrix,u_extrude_scale:p,u_intensity:c,u_inv_rot_matrix:TN,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(d){m.u_inv_rot_matrix=i,m.u_merc_center=a,m.u_tile_id=[e.canonical.x,e.canonical.y,1<<e.canonical.z],m.u_zoom_transition=Qn(u.zoom);const _=a[0]*Ae,y=a[1]*Ae;m.u_up_dir=u.projection.upVector(new ns(0,0,0),_,y)}return m},CN=(t,e,r,i,a,s,c)=>{const u=t.transform,d=u.calculatePixelsToTileUnitsMatrix(e);return{u_matrix:Q5(t,e,r,i),u_pixels_to_tile_units:d,u_device_pixel_ratio:s,u_units_to_pixels:[1/u.pixelsToGLUnits[0],1/u.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:a,u_texsize:eA(r)?e.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:J5(e,t.transform),u_alpha_discard_threshold:0,u_trim_offset:c,u_emissive_strength:r.paint.get("line-emissive-strength")}},AN=(t,e,r,i,a)=>{const s=t.transform;return{u_matrix:Q5(t,e,r,i),u_texsize:e.imageAtlasTexture.size,u_pixels_to_tile_units:s.calculatePixelsToTileUnitsMatrix(e),u_device_pixel_ratio:a,u_image:0,u_tile_units_to_pixels:J5(e,s),u_units_to_pixels:[1/s.pixelsToGLUnits[0],1/s.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function J5(t,e){return 1/oc(t,1,e.tileZoom)}function Q5(t,e,r,i){return t.translatePosMatrix(i||e.tileID.projMatrix,e,r.paint.get("line-translate"),r.paint.get("line-translate-anchor"))}function eA(t){const e=t.paint.get("line-dasharray").value;return e.value||e.kind!=="constant"}const IN=(t,e,r,i,a,s,c,u,d)=>{return{u_matrix:t,u_tl_parent:e,u_scale_parent:r,u_fade_t:i.mix,u_opacity:i.opacity*a.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:a.paint.get("raster-brightness-min"),u_brightness_high:a.paint.get("raster-brightness-max"),u_saturation_factor:(m=a.paint.get("raster-saturation"),m>0?1-1/(1.001-m):-m),u_contrast_factor:(p=a.paint.get("raster-contrast"),p>0?1/(1-p):1+p),u_spin_weights:PN(a.paint.get("raster-hue-rotate")),u_perspective_transform:s,u_colorization_mix:u,u_colorization_scale:kN(d),u_color_ramp:c};var p,m};function PN(t){t*=Math.PI/180;const e=Math.sin(t),r=Math.cos(t);return[(2*r+1)/3,(-Math.sqrt(3)*e-r+1)/3,(Math.sqrt(3)*e-r+1)/3]}function kN([t,e]){return t===e?[t,e]:[-t/(e-t),1/(e-t)]}const tA=ge.create(),rA=(t,e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T)=>{const M=a.transform,C={u_is_size_zoom_constant:+(t==="constant"||t==="source"),u_is_size_feature_constant:+(t==="constant"||t==="camera"),u_size_t:e?e.uSizeT:0,u_size:e?e.uSize:0,u_camera_to_center_distance:M.getCameraToCenterDistance(S),u_rotate_symbol:+r,u_aspect_ratio:M.width/M.height,u_fade_change:a.options.fadeDuration?a.symbolFadeChange:1,u_matrix:s,u_label_plane_matrix:c,u_coord_matrix:u,u_is_text:+d,u_pitch_with_map:+i,u_texsize:p,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:tA,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:tA,u_up_vector:[0,-1,0],u_icon_transition:T||0};return S.name==="globe"&&(C.u_tile_id=[m.canonical.x,m.canonical.y,1<<m.canonical.z],C.u_zoom_transition=_,C.u_inv_rot_matrix=v,C.u_merc_center=y,C.u_camera_forward=M._camera.forward(),C.u_ecef_origin=function(P,k){const z=[0,0,0],L=vu(ea(k.canonical));return ie.transformMat4(z,z,L),ie.transformMat4(z,z,P),z}(M.globeMatrix,m.toUnwrapped()),C.u_tile_matrix=Float32Array.from(M.globeMatrix),C.u_up_vector=b),C},nA=(t,e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T)=>Oe(rA(t,e,r,i,a,s,c,u,d,p,_,y,v,b,S,T),{u_gamma_scale:i?a.transform.getCameraToCenterDistance(T)*Math.cos(a.terrain?0:a.transform._pitch):1,u_device_pixel_ratio:Ot.devicePixelRatio,u_is_halo:+m,undefined:void 0}),RN=(t,e,r,i,a,s,c,u,d,p,m,_,y,v,b,S)=>Oe(nA(t,e,r,i,a,s,c,u,!0,d,!0,m,_,y,v,b,S),{u_texsize_icon:p,u_texture_icon:1}),zN=(t,e,r,i)=>({u_matrix:t,u_emissive_strength:e,u_opacity:r,u_color:i}),DN=(t,e,r,i,a,s,c)=>Oe(function(u,d,p,m){const _=p.imageManager.getPattern(u.toString(),d),{width:y,height:v}=p.imageManager.getPixelSize(d),b=Math.pow(2,m.tileID.overscaledZ),S=m.tileSize*Math.pow(2,p.transform.tileZoom)/b,T=S*(m.tileID.canonical.x+m.tileID.wrap*b),M=S*m.tileID.canonical.y;return{u_image:0,u_pattern_tl:_.tl,u_pattern_br:_.br,u_texsize:[y,v],u_pattern_size:_.displaySize,u_tile_units_to_pixels:1/oc(m,1,p.transform.tileZoom),u_pixel_coord_upper:[T>>16,M>>16],u_pixel_coord_lower:[65535&T,65535&M]}}(a,s,i,c),{u_matrix:t,u_emissive_strength:e,u_opacity:r}),Ix=(t,e,r,i,a,s,c,u,d,p,m,_=[0,0,0])=>{const y=i.style.light,v=y.properties.get("position"),b=[-v.x,-v.y,v.z],S=Ii.create();y.properties.get("anchor")==="viewport"&&(Ii.fromRotation(S,-i.transform.angle),ie.transformMat3(b,b,S));const T=p.alphaMode==="MASK",M=y.properties.get("color"),C=m.paint.get("model-ambient-occlusion-intensity"),P=m.paint.get("model-color").constantOr(Zt.white),k=m.paint.get("model-color-mix-intensity").constantOr(0);return{u_matrix:t,u_lighting_matrix:e,u_normal_matrix:r,u_lightpos:b,u_lightintensity:y.properties.get("intensity"),u_lightcolor:[M.r,M.g,M.b],u_camera_pos:_,u_opacity:a,u_baseTextureIsAlpha:0,u_alphaMask:+T,u_alphaCutoff:p.alphaCutoff,u_baseColorFactor:[s.r,s.g,s.b,s.a],u_emissiveFactor:[c[0],c[1],c[2],1],u_metallicFactor:u,u_roughnessFactor:d,u_baseColorTexture:qi.BaseColor,u_metallicRoughnessTexture:qi.MetallicRoughness,u_normalTexture:qi.Normal,u_occlusionTexture:qi.Occlusion,u_emissionTexture:qi.Emission,u_color_mix:[P.r,P.g,P.b,k],u_aoIntensity:C}},iA=new Float32Array(16),oA=(t,e=iA,r=iA)=>({u_matrix:t,u_instance:e,u_node_matrix:r}),LN={fillExtrusion:t=>({u_matrix:new Gt(t),u_lightpos:new Vt(t),u_lightintensity:new Ye(t),u_lightcolor:new Vt(t),u_vertical_gradient:new Ye(t),u_opacity:new Ye(t),u_edge_radius:new Ye(t),u_ao:new sr(t),u_tile_id:new Vt(t),u_zoom_transition:new Ye(t),u_inv_rot_matrix:new Gt(t),u_merc_center:new sr(t),u_up_dir:new Vt(t),u_height_lift:new Ye(t),u_flood_light_color:new Vt(t),u_vertical_scale:new Ye(t),u_flood_light_intensity:new Ye(t),u_ground_shadow_factor:new Vt(t)}),fillExtrusionDepth:t=>({u_matrix:new Gt(t),u_edge_radius:new Ye(t),u_vertical_scale:new Ye(t)}),fillExtrusionPattern:t=>({u_matrix:new Gt(t),u_lightpos:new Vt(t),u_lightintensity:new Ye(t),u_lightcolor:new Vt(t),u_vertical_gradient:new Ye(t),u_height_factor:new Ye(t),u_edge_radius:new Ye(t),u_ao:new sr(t),u_tile_id:new Vt(t),u_zoom_transition:new Ye(t),u_inv_rot_matrix:new Gt(t),u_merc_center:new sr(t),u_up_dir:new Vt(t),u_height_lift:new Ye(t),u_image:new Qt(t),u_texsize:new sr(t),u_pixel_coord_upper:new sr(t),u_pixel_coord_lower:new sr(t),u_tile_units_to_pixels:new Ye(t),u_opacity:new Ye(t)}),fillExtrusionGroundEffect:t=>({u_matrix:new Gt(t),u_opacity:new Ye(t),u_ao_pass:new Ye(t),u_meter_to_tile:new Ye(t),u_ao:new sr(t),u_flood_light_intensity:new Ye(t),u_flood_light_color:new Vt(t),u_attenuation:new Ye(t),u_fb:new Qt(t)}),fill:t=>({u_matrix:new Gt(t),u_emissive_strength:new Ye(t)}),fillPattern:t=>({u_matrix:new Gt(t),u_emissive_strength:new Ye(t),u_image:new Qt(t),u_texsize:new sr(t),u_pixel_coord_upper:new sr(t),u_pixel_coord_lower:new sr(t),u_tile_units_to_pixels:new Ye(t)}),fillOutline:t=>({u_matrix:new Gt(t),u_emissive_strength:new Ye(t),u_world:new sr(t)}),fillOutlinePattern:t=>({u_matrix:new Gt(t),u_emissive_strength:new Ye(t),u_world:new sr(t),u_image:new Qt(t),u_texsize:new sr(t),u_pixel_coord_upper:new sr(t),u_pixel_coord_lower:new sr(t),u_tile_units_to_pixels:new Ye(t)}),circle:t=>({u_camera_to_center_distance:new Ye(t),u_extrude_scale:new W1(t),u_device_pixel_ratio:new Ye(t),u_matrix:new Gt(t),u_inv_rot_matrix:new Gt(t),u_merc_center:new sr(t),u_tile_id:new Vt(t),u_zoom_transition:new Ye(t),u_up_dir:new Vt(t),u_emissive_strength:new Ye(t)}),collisionBox:t=>({u_matrix:new Gt(t),u_camera_to_center_distance:new Ye(t),u_extrude_scale:new sr(t)}),collisionCircle:t=>({u_matrix:new Gt(t),u_inv_matrix:new Gt(t),u_camera_to_center_distance:new Ye(t),u_viewport_size:new sr(t)}),debug:t=>({u_color:new fu(t),u_matrix:new Gt(t),u_overlay:new Qt(t),u_overlay_scale:new Ye(t)}),clippingMask:t=>({u_matrix:new Gt(t)}),heatmap:t=>({u_extrude_scale:new Ye(t),u_intensity:new Ye(t),u_matrix:new Gt(t),u_inv_rot_matrix:new Gt(t),u_merc_center:new sr(t),u_tile_id:new Vt(t),u_zoom_transition:new Ye(t),u_up_dir:new Vt(t)}),heatmapTexture:t=>({u_image:new Qt(t),u_color_ramp:new Qt(t),u_opacity:new Ye(t)}),hillshade:t=>({u_matrix:new Gt(t),u_image:new Qt(t),u_latrange:new sr(t),u_light:new sr(t),u_shadow:new fu(t),u_highlight:new fu(t),u_accent:new fu(t)}),hillshadePrepare:t=>({u_matrix:new Gt(t),u_image:new Qt(t),u_dimension:new sr(t),u_zoom:new Ye(t),u_unpack:new ao(t)}),line:t=>({u_matrix:new Gt(t),u_pixels_to_tile_units:new W1(t),u_device_pixel_ratio:new Ye(t),u_units_to_pixels:new sr(t),u_dash_image:new Qt(t),u_gradient_image:new Qt(t),u_image_height:new Ye(t),u_texsize:new sr(t),u_tile_units_to_pixels:new Ye(t),u_alpha_discard_threshold:new Ye(t),u_trim_offset:new sr(t),u_emissive_strength:new Ye(t)}),linePattern:t=>({u_matrix:new Gt(t),u_texsize:new sr(t),u_pixels_to_tile_units:new W1(t),u_device_pixel_ratio:new Ye(t),u_image:new Qt(t),u_units_to_pixels:new sr(t),u_tile_units_to_pixels:new Ye(t),u_alpha_discard_threshold:new Ye(t)}),raster:t=>({u_matrix:new Gt(t),u_tl_parent:new sr(t),u_scale_parent:new Ye(t),u_fade_t:new Ye(t),u_opacity:new Ye(t),u_image0:new Qt(t),u_image1:new Qt(t),u_brightness_low:new Ye(t),u_brightness_high:new Ye(t),u_saturation_factor:new Ye(t),u_contrast_factor:new Ye(t),u_spin_weights:new Vt(t),u_perspective_transform:new sr(t),u_colorization_mix:new ao(t),u_colorization_scale:new sr(t),u_color_ramp:new Qt(t)}),symbolIcon:t=>({u_is_size_zoom_constant:new Qt(t),u_is_size_feature_constant:new Qt(t),u_size_t:new Ye(t),u_size:new Ye(t),u_camera_to_center_distance:new Ye(t),u_rotate_symbol:new Qt(t),u_aspect_ratio:new Ye(t),u_fade_change:new Ye(t),u_matrix:new Gt(t),u_label_plane_matrix:new Gt(t),u_coord_matrix:new Gt(t),u_is_text:new Qt(t),u_pitch_with_map:new Qt(t),u_texsize:new sr(t),u_tile_id:new Vt(t),u_zoom_transition:new Ye(t),u_inv_rot_matrix:new Gt(t),u_merc_center:new sr(t),u_camera_forward:new Vt(t),u_tile_matrix:new Gt(t),u_up_vector:new Vt(t),u_ecef_origin:new Vt(t),u_texture:new Qt(t),u_icon_transition:new Ye(t)}),symbolSDF:t=>({u_is_size_zoom_constant:new Qt(t),u_is_size_feature_constant:new Qt(t),u_size_t:new Ye(t),u_size:new Ye(t),u_camera_to_center_distance:new Ye(t),u_rotate_symbol:new Qt(t),u_aspect_ratio:new Ye(t),u_fade_change:new Ye(t),u_matrix:new Gt(t),u_label_plane_matrix:new Gt(t),u_coord_matrix:new Gt(t),u_is_text:new Qt(t),u_pitch_with_map:new Qt(t),u_texsize:new sr(t),u_texture:new Qt(t),u_gamma_scale:new Ye(t),u_device_pixel_ratio:new Ye(t),u_tile_id:new Vt(t),u_zoom_transition:new Ye(t),u_inv_rot_matrix:new Gt(t),u_merc_center:new sr(t),u_camera_forward:new Vt(t),u_tile_matrix:new Gt(t),u_up_vector:new Vt(t),u_ecef_origin:new Vt(t),u_is_halo:new Qt(t)}),symbolTextAndIcon:t=>({u_is_size_zoom_constant:new Qt(t),u_is_size_feature_constant:new Qt(t),u_size_t:new Ye(t),u_size:new Ye(t),u_camera_to_center_distance:new Ye(t),u_rotate_symbol:new Qt(t),u_aspect_ratio:new Ye(t),u_fade_change:new Ye(t),u_matrix:new Gt(t),u_label_plane_matrix:new Gt(t),u_coord_matrix:new Gt(t),u_is_text:new Qt(t),u_pitch_with_map:new Qt(t),u_texsize:new sr(t),u_texsize_icon:new sr(t),u_texture:new Qt(t),u_texture_icon:new Qt(t),u_gamma_scale:new Ye(t),u_device_pixel_ratio:new Ye(t),u_is_halo:new Qt(t)}),background:t=>({u_matrix:new Gt(t),u_emissive_strength:new Ye(t),u_opacity:new Ye(t),u_color:new fu(t)}),backgroundPattern:t=>({u_matrix:new Gt(t),u_emissive_strength:new Ye(t),u_opacity:new Ye(t),u_image:new Qt(t),u_pattern_tl:new sr(t),u_pattern_br:new sr(t),u_texsize:new sr(t),u_pattern_size:new sr(t),u_pixel_coord_upper:new sr(t),u_pixel_coord_lower:new sr(t),u_tile_units_to_pixels:new Ye(t)}),terrainRaster:B5,terrainDepth:B5,skybox:t=>({u_matrix:new Gt(t),u_sun_direction:new Vt(t),u_cubemap:new Qt(t),u_opacity:new Ye(t),u_temporal_offset:new Ye(t)}),skyboxGradient:t=>({u_matrix:new Gt(t),u_color_ramp:new Qt(t),u_center_direction:new Vt(t),u_radius:new Ye(t),u_opacity:new Ye(t),u_temporal_offset:new Ye(t)}),skyboxCapture:t=>({u_matrix_3f:new XS(t),u_sun_direction:new Vt(t),u_sun_intensity:new Ye(t),u_color_tint_r:new ao(t),u_color_tint_m:new ao(t),u_luminance:new Ye(t)}),globeRaster:t=>({u_proj_matrix:new Gt(t),u_globe_matrix:new Gt(t),u_normalize_matrix:new Gt(t),u_merc_matrix:new Gt(t),u_zoom_transition:new Ye(t),u_merc_center:new sr(t),u_image0:new Qt(t),u_grid_matrix:new XS(t),u_skirt_height:new Ye(t),u_frustum_tl:new Vt(t),u_frustum_tr:new Vt(t),u_frustum_br:new Vt(t),u_frustum_bl:new Vt(t),u_globe_pos:new Vt(t),u_globe_radius:new Ye(t),u_viewport:new sr(t)}),globeAtmosphere:t=>({u_frustum_tl:new Vt(t),u_frustum_tr:new Vt(t),u_frustum_br:new Vt(t),u_frustum_bl:new Vt(t),u_horizon:new Ye(t),u_transition:new Ye(t),u_fadeout_range:new Ye(t),u_color:new ao(t),u_high_color:new ao(t),u_space_color:new ao(t),u_temporal_offset:new Ye(t),u_horizon_angle:new Ye(t)}),model:t=>({u_matrix:new Gt(t),u_lighting_matrix:new Gt(t),u_normal_matrix:new Gt(t),u_lightpos:new Vt(t),u_lightintensity:new Ye(t),u_lightcolor:new Vt(t),u_camera_pos:new Vt(t),u_opacity:new Ye(t),u_baseColorFactor:new ao(t),u_emissiveFactor:new ao(t),u_metallicFactor:new Ye(t),u_roughnessFactor:new Ye(t),u_baseTextureIsAlpha:new Qt(t),u_alphaMask:new Qt(t),u_alphaCutoff:new Ye(t),u_baseColorTexture:new Qt(t),u_metallicRoughnessTexture:new Qt(t),u_normalTexture:new Qt(t),u_occlusionTexture:new Qt(t),u_emissionTexture:new Qt(t),u_color_mix:new ao(t),u_aoIntensity:new Ye(t)}),modelDepth:t=>({u_matrix:new Gt(t),u_instance:new Gt(t),u_node_matrix:new Gt(t)}),groundShadow:t=>({u_matrix:new Gt(t),u_ground_shadow_factor:new Vt(t)}),stars:t=>({u_matrix:new Gt(t),u_up:new Vt(t),u_right:new Vt(t),u_intensity_multiplier:new Ye(t)})};let Eg;function aA(t,e,r,i,a,s,c){const u=t.context,d=u.gl,p=t.transform,m=t.useProgram("collisionBox"),_=[];let y=0,v=0;for(let k=0;k<i.length;k++){const z=i[k],L=e.getTile(z),B=L.getBucket(r);if(!B)continue;const W=B9(z,B,p);let Z=W;a[0]===0&&a[1]===0||(Z=t.translatePosMatrix(W,L,a,s));const X=c?B.textCollisionBox:B.iconCollisionBox,H=B.collisionCircleArray;if(H.length>0){const J=ge.create(),Q=Z;ge.mul(J,B.placementInvProjMatrix,p.glCoordMatrix),ge.mul(J,J,B.placementViewportMatrix),_.push({circleArray:H,circleOffset:v,transform:Q,invTransform:J,projection:B.getProjection()}),y+=H.length/4,v=y}X&&(t.terrain&&t.terrain.setupElevationDraw(L,m),m.draw(t,d.LINES,Nt.disabled,lr.disabled,t.colorModeForRenderPass(),ur.disabled,SN(Z,p,L,B.getProjection()),r.id,X.layoutVertexBuffer,X.indexBuffer,X.segments,null,p.zoom,null,[X.collisionVertexBuffer,X.collisionVertexBufferExt]))}if(!c||!_.length)return;const b=t.useProgram("collisionCircle"),S=new D1;S.resize(4*y),S._trim();let T=0;for(const k of _)for(let z=0;z<k.circleArray.length/4;z++){const L=4*z,B=k.circleArray[L+0],W=k.circleArray[L+1],Z=k.circleArray[L+2],X=k.circleArray[L+3];S.emplace(T++,B,W,Z,X,0),S.emplace(T++,B,W,Z,X,1),S.emplace(T++,B,W,Z,X,2),S.emplace(T++,B,W,Z,X,3)}(!Eg||Eg.length<2*y)&&(Eg=function(k){const z=2*k,L=new Bn;L.resize(z),L._trim();for(let B=0;B<z;B++){const W=6*B;L.uint16[W+0]=4*B+0,L.uint16[W+1]=4*B+1,L.uint16[W+2]=4*B+2,L.uint16[W+3]=4*B+2,L.uint16[W+4]=4*B+3,L.uint16[W+5]=4*B+0}return L}(y));const M=u.createIndexBuffer(Eg,!0),C=u.createVertexBuffer(S,a7.members,!0);for(const k of _){const z={u_matrix:k.transform,u_inv_matrix:k.invTransform,u_camera_to_center_distance:(P=p).getCameraToCenterDistance(k.projection),u_viewport_size:[P.width,P.height]};b.draw(t,d.TRIANGLES,Nt.disabled,lr.disabled,t.colorModeForRenderPass(),ur.disabled,z,r.id,C,M,Gr.simpleSegment(0,2*k.circleOffset,k.circleArray.length,k.circleArray.length/2),null,p.zoom)}var P;C.destroy(),M.destroy()}const sA=ge.create();function ON({width:t,height:e,anchor:r,textOffset:i,textScale:a},s){const{horizontalAlign:c,verticalAlign:u}=Wm(r),d=-(c-.5)*t,p=-(u-.5)*e,m=Uv(r,i);return new $((d/a+m[0])*s,(p/a+m[1])*s)}function FN(t,e,r,i,a,s,c,u,d,p,m){const _=t.text.placedSymbolArray,y=t.text.dynamicLayoutVertexArray,v=t.icon.dynamicLayoutVertexArray,b={},S=t.getProjection(),T=yx(u,S,s),M=s.elevation,C=S.upVectorScale(u.canonical,s.center.lat,s.worldSize).metersToTile;y.clear();for(let P=0;P<_.length;P++){const k=_.get(P),{tileAnchorX:z,tileAnchorY:L,numGlyphs:B}=k,W=k.hidden||!k.crossTileID||t.allowVerticalPlacement&&!k.placedOrientation?null:i[k.crossTileID];if(W){let Z=0,X=0,H=0;if(M){const ve=M?M.getAtTileOffset(u,z,L):0,[Ce,Se,Je]=S.upVector(u.canonical,z,L);Z=ve*Ce*C,X=ve*Se*C,H=ve*Je*C}let[J,Q,K,fe]=ia(k.projectedAnchorX+Z,k.projectedAnchorY+X,k.projectedAnchorZ+H,r?T:c);const he=rC(s.getCameraToCenterDistance(S),fe);let _e=a.evaluateSizeForFeature(t.textSizeData,p,k)*he/Xn;r&&(_e*=t.tilePixelRatio/d);const oe=ON(W,_e);r?({x:J,y:Q,z:K}=S.projectTilePoint(z+oe.x,L+oe.y,u.canonical),[J,Q,K]=ia(J+Z,Q+X,K+H,c)):(e&&oe._rotate(-s.angle),J+=oe.x,Q+=oe.y,K=0);const me=t.allowVerticalPlacement&&k.placedOrientation===sn.vertical?Math.PI/2:0;for(let ve=0;ve<B;ve++)Du(y,J,Q,K,me);m&&k.associatedIconIndex>=0&&(b[k.associatedIconIndex]={x:J,y:Q,z:K,angle:me})}else Ou(B,y)}if(m){v.clear();const P=t.icon.placedSymbolArray;for(let k=0;k<P.length;k++){const z=P.get(k),{numGlyphs:L}=z,B=b[k];if(z.hidden||!B)Ou(L,v);else{const{x:W,y:Z,z:X,angle:H}=B;for(let J=0;J<L;J++)Du(v,W,Z,X,H)}}t.icon.dynamicLayoutVertexBuffer.updateData(v)}t.text.dynamicLayoutVertexBuffer.updateData(y)}function BN(t,e,r){return r.iconsInText&&e?"symbolTextAndIcon":t?"symbolSDF":"symbolIcon"}function lA(t,e,r,i,a,s,c,u,d,p,m,_){const y=t.context,v=y.gl,b=t.transform,S=u==="map",T=d==="map",M=S&&r.layout.get("symbol-placement")!=="point",C=S&&!T&&!M,P=r.layout.get("symbol-sort-key").constantOr(1)!==void 0;let k=!1;const z=t.depthModeForSublayer(0,Nt.ReadOnly),L=[ei(b.center.lng),ai(b.center.lat)],B=r.layout.get("text-variable-anchor"),W=b.projection.name==="globe",Z=[],X=[0,-1,0];let H=X;!W&&!b.mercatorFromTransition||S||(H=function(J){const Q=J._camera.getWorldToCamera(J.worldSize,1),K=ge.multiply([],Q,J.globeMatrix);ge.invert(K,K);const fe=[0,0,0],he=[0,1,0,0];return Wr.transformMat4(he,he,K),fe[0]=he[0],fe[1]=he[1],fe[2]=he[2],ie.normalize(fe,fe),fe}(b));for(const J of i){const Q=e.getTile(J),K=Q.getBucket(r);if(!K||K.projection.name==="mercator"&&W)continue;const fe=a?K.text:K.icon;if(!fe||K.fullyClipped||!fe.segments.get().length)continue;const he=fe.programConfigurations.get(r.id),_e=a||K.sdfIcons,oe=a?K.textSizeData:K.iconSizeData,me=T||b.pitch!==0,ve=ka(oe,b.zoom);let Ce,Se,Je,Ge,je=[0,0],Ve=null;if(a)Se=Q.glyphAtlasTexture,Je=v.LINEAR,Ce=Q.glyphAtlasTexture.size,K.iconsInText&&(je=Q.imageAtlasTexture.size,Ve=Q.imageAtlasTexture,Ge=me||t.options.rotating||t.options.zooming||oe.kind==="composite"||oe.kind==="camera"?v.LINEAR:v.NEAREST);else{const cn=r.layout.get("icon-size").constantOr(0)!==1||K.iconsNeedLinear;Se=Q.imageAtlasTexture,Je=_e||t.options.rotating||t.options.zooming||cn||me?v.LINEAR:v.NEAREST,Ce=Q.imageAtlasTexture.size}const nt=K.projection.name==="globe",wt=nt?H:X,pt=nt?Qn(b.zoom):0,dt=yx(J,K.getProjection(),b),Et=b.calculatePixelsToTileUnitsMatrix(Q),nr=cg(dt,Q.tileID.canonical,T,S,b,K.getProjection(),Et),er=t.terrain&&T&&M?ge.invert(ge.create(),nr):sA,Rr=tC(dt,Q.tileID.canonical,T,S,b,K.getProjection(),Et),tr=B&&K.hasTextData(),ir=K.hasIconTextFit()&&tr&&K.hasIconData();if(M){const cn=b.elevation,jn=cn?cn.getAtTileOffsetFunc(J,b.center.lat,b.worldSize,K.getProjection()):null,Fr=eC(dt,Q.tileID.canonical,T,S,b,K.getProjection(),Et);FB(K,dt,t,a,Fr,Rr,T,p,jn,J)}const Dt=M||a&&B||ir,Yt=t.translatePosMatrix(dt,Q,s,c),zr=Dt?sA:nr,Kt=t.translatePosMatrix(Rr,Q,s,c,!0),Or=K.getProjection().createInversionMatrix(b,J.canonical),Tn=r.paint.get("icon-image-cross-fade").constantOr(0),Mn=[];t.terrainRenderModeElevated()&&T&&Mn.push("PITCH_WITH_MAP_TERRAIN"),nt&&Mn.push("PROJECTION_GLOBE_VIEW"),Dt&&Mn.push("PROJECTED_POS_ON_VIEWPORT"),Tn>0&&Mn.push("ICON_TRANSITION");const dn=_e&&r.paint.get(a?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let rn;rn=_e?K.iconsInText?RN(oe.kind,ve,C,T,t,Yt,zr,Kt,Ce,je,J,pt,L,Or,wt,K.getProjection()):nA(oe.kind,ve,C,T,t,Yt,zr,Kt,a,Ce,!0,J,pt,L,Or,wt,K.getProjection()):rA(oe.kind,ve,C,T,t,Yt,zr,Kt,a,Ce,J,pt,L,Or,wt,K.getProjection(),Tn);const Ln={program:t.useProgram(BN(_e,a,K),he,Mn),buffers:fe,uniformValues:rn,atlasTexture:Se,atlasTextureIcon:Ve,atlasInterpolation:Je,atlasInterpolationIcon:Ge,isSDF:_e,hasHalo:dn,tile:Q,labelPlaneMatrixInv:er};if(P&&K.canOverlap){k=!0;const cn=fe.segments.get();for(const jn of cn)Z.push({segments:new Gr([jn]),sortKey:jn.sortKey,state:Ln})}else Z.push({segments:fe.segments,sortKey:0,state:Ln})}k&&Z.sort((J,Q)=>J.sortKey-Q.sortKey);for(const J of Z){const Q=J.state;if(t.terrain&&t.terrain.setupElevationDraw(Q.tile,Q.program,{useDepthForOcclusion:!W,labelPlaneMatrixInv:Q.labelPlaneMatrixInv}),y.activeTexture.set(v.TEXTURE0),Q.atlasTexture.bind(Q.atlasInterpolation,v.CLAMP_TO_EDGE),Q.atlasTextureIcon&&(y.activeTexture.set(v.TEXTURE1),Q.atlasTextureIcon&&Q.atlasTextureIcon.bind(Q.atlasInterpolationIcon,v.CLAMP_TO_EDGE)),t.uploadCommonLightUniforms(t.context,Q.program),y.isWebGL2&&Q.hasHalo){const K=Q.uniformValues;K.u_is_halo=1,Px(Q.buffers,J.segments,r,t,Q.program,z,m,_,K,2),K.u_is_halo=0}else{if(Q.isSDF){const K=Q.uniformValues;Q.hasHalo&&(K.u_is_halo=1,Px(Q.buffers,J.segments,r,t,Q.program,z,m,_,K,1)),K.u_is_halo=0}Px(Q.buffers,J.segments,r,t,Q.program,z,m,_,Q.uniformValues,1)}}}function Px(t,e,r,i,a,s,c,u,d,p){const m=[t.dynamicLayoutVertexBuffer,t.opacityVertexBuffer,t.iconTransitioningVertexBuffer,t.globeExtVertexBuffer];a.draw(i,i.context.gl.TRIANGLES,s,c,u,ur.disabled,d,r.id,t.layoutVertexBuffer,t.indexBuffer,e,r.paint,i.transform.zoom,t.programConfigurations.get(r.id),m,p)}function cA(t,e,r,i,a,s,c){const u=t.context.gl,d=r.paint.get("fill-pattern"),p=d&&d.constantOr(1);let m,_,y,v,b;c?(_=p&&!r.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",m=u.LINES):(_=p?"fillPattern":"fill",m=u.TRIANGLES);for(const S of i){const T=e.getTile(S);if(p&&!T.patternsLoaded())continue;const M=T.getBucket(r);if(!M)continue;t.prepareDrawTile();const C=M.programConfigurations.get(r.id),P=t.useProgram(_,C);p&&(t.context.activeTexture.set(u.TEXTURE0),T.imageAtlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE),C.updatePaintBuffers());const k=d.constantOr(null);if(k&&T.imageAtlas){const B=T.imageAtlas.patternPositions[k.toString()];B&&C.setConstantPatternPositions(B)}const z=t.translatePosMatrix(S.projMatrix,T,r.paint.get("fill-translate"),r.paint.get("fill-translate-anchor")),L=r.paint.get("fill-emissive-strength");if(c){v=M.indexBuffer2,b=M.segments2;const B=t.terrain&&t.terrain.renderingToTexture?t.terrain.drapeBufferSize:[u.drawingBufferWidth,u.drawingBufferHeight];y=_==="fillOutlinePattern"&&p?xN(z,L,t,T,B):vN(z,L,B)}else v=M.indexBuffer,b=M.segments,y=p?Y5(z,L,t,T):X5(z,L);t.uploadCommonUniforms(t.context,P,S.toUnwrapped()),P.draw(t,m,a,t.stencilModeForClipping(S),s,ur.disabled,y,r.id,M.layoutVertexBuffer,v,b,r.paint,t.transform.zoom,C,void 0)}}function Sg(t,e,r,i,a,s,c,u){const d=t.context,p=d.gl,m=t.transform,_=r.paint.get("fill-extrusion-pattern"),y=_.constantOr(1),v=r.paint.get("fill-extrusion-opacity"),b=t.style.enable3dLights(),S=r.paint.get(b&&!y?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),T=[r.paint.get("fill-extrusion-ambient-occlusion-intensity"),S],M=r.layout.get("fill-extrusion-edge-radius"),C=M>0&&!r.paint.get("fill-extrusion-rounded-roof"),P=C?0:M,k=m.projection.name==="globe"?OC():0,z=m.projection.name==="globe",L=z?Qn(m.zoom):0,B=[ei(m.center.lng),ai(m.center.lat)],W=r.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),Z=r.paint.get("fill-extrusion-flood-light-intensity"),X=r.paint.get("fill-extrusion-vertical-scale"),H=[];z&&H.push("PROJECTION_GLOBE_VIEW"),T[0]>0&&H.push("FAUX_AO"),C&&H.push("ZERO_ROOF_RADIUS"),u&&H.push("HAS_CENTROID"),Z>0&&H.push("FLOOD_LIGHT");const J=t.renderPass==="shadow",Q=t.shadowRenderer,K=J&&!!Q;t.shadowRenderer&&(t.shadowRenderer.useNormalOffset=!0);let fe=[0,0,0];if(Q){const he=t.style.directionalLight,_e=t.style.ambientLight;he&&_e&&(fe=Cx(he,_e))}for(const he of i){const _e=e.getTile(he),oe=_e.getBucket(r);if(!oe||oe.projection.name!==m.projection.name)continue;const me=oe.programConfigurations.get(r.id),ve=t.useProgram(K?"fillExtrusionDepth":y?"fillExtrusionPattern":"fillExtrusion",me,H);if(t.terrain){const je=t.terrain;t.style.terrainSetForDrapingOnly(),je.setupElevationDraw(_e,ve,{useMeterToDem:!0})}if(!oe.centroidVertexBuffer){const je=ve.attributes.a_centroid_pos;je!==void 0&&p.vertexAttrib2f(je,0,0)}!J&&Q&&Q.setupShadows(_e.tileID.toUnwrapped(),ve,"vector-tile",_e.tileID.overscaledZ),y&&(t.context.activeTexture.set(p.TEXTURE0),_e.imageAtlasTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),me.updatePaintBuffers());const Ce=_.constantOr(null);if(Ce&&_e.imageAtlas){const je=_e.imageAtlas.patternPositions[Ce.toString()];je&&me.setConstantPatternPositions(je)}const Se=r.paint.get("fill-extrusion-vertical-gradient");let Je;if(J&&Q){const je=Q.calculateShadowPassMatrixFromTile(_e.tileID.toUnwrapped());Je=gN(je,P,X)}else{const je=t.translatePosMatrix(he.projMatrix,_e,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),Ve=m.projection.createInversionMatrix(m,he.canonical);Je=y?_N(je,t,Se,v,T,P,he,_e,k,L,B,Ve,W,X):Z5(je,t,Se,v,T,P,he,k,L,B,Ve,W,X,Z,fe)}t.uploadCommonUniforms(d,ve,he.toUnwrapped());const Ge=[];(t.terrain||u)&&Ge.push(oe.centroidVertexBuffer),z&&Ge.push(oe.layoutVertexExtBuffer),ve.draw(t,d.gl.TRIANGLES,a,s,c,ur.backCCW,Je,r.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,r.paint,t.transform.zoom,me,Ge)}t.shadowRenderer&&(t.shadowRenderer.useNormalOffset=!1)}function Gu(t,e,r,i,a,s,c,u,d,p,m,_,y,v,b,S,T,M){const C=t.context,P=C.gl,k=t.transform,z=[];p==="clear"?(z.push("CLEAR_SUBPASS"),M&&(z.push("CLEAR_FROM_TEXTURE"),C.activeTexture.set(P.TEXTURE0),M.bind(P.LINEAR,P.CLAMP_TO_EDGE))):p==="sdf"&&z.push("SDF_SUBPASS"),T&&z.push("HAS_CENTROID");for(const L of i){const B=e.getTile(L),W=B.getBucket(r);if(!W||W.projection.name!==k.projection.name||!W.groundEffect)continue;const Z=W.groundEffect,X=Z.programConfigurations.get(r.id),H=t.useProgram("fillExtrusionGroundEffect",X,z),J=t.translatePosMatrix(L.projMatrix,B,r.paint.get("fill-extrusion-translate"),r.paint.get("fill-extrusion-translate-anchor")),Q=1/W.tileToMeter,K=yN(0,J,m,d,Q,[_,y*Q],v,b,S),fe=[];T&&fe.push(W.groundEffect.hiddenByLandmarkVertexBuffer),t.uploadCommonUniforms(C,H,L.toUnwrapped()),H.draw(t,C.gl.TRIANGLES,a,s,c,u,K,r.id,Z.vertexBuffer,Z.indexBuffer,Z.segments,r.paint,t.transform.zoom,X,fe)}}function NN(t,e,r,i,a,s,c){i.centroidVertexArray.length===0&&i.createCentroidsBuffer();const u=s?s.findDEMTileFor(r):null;if(!(u&&u.dem||c))return;const d=[C=>{let P=C.canonical.x-1,k=C.wrap;return P<0&&(P=(1<<C.canonical.z)-1,k--),new Kr(C.overscaledZ,k,C.canonical.z,P,C.canonical.y)},C=>{let P=C.canonical.x+1,k=C.wrap;return P===1<<C.canonical.z&&(P=0,k++),new Kr(C.overscaledZ,k,C.canonical.z,P,C.canonical.y)},C=>new Kr(C.overscaledZ,C.wrap,C.canonical.z,C.canonical.x,(C.canonical.y===0?1<<C.canonical.z:C.canonical.y)-1),C=>new Kr(C.overscaledZ,C.wrap,C.canonical.z,C.canonical.x,C.canonical.y===(1<<C.canonical.z)-1?0:C.canonical.y+1)],p=C=>{const P=e.getSource().minzoom,k=L=>{const B=e.getTileByID(L);if(B&&B.hasData())return B.getBucket(a)},z=[0,-1,1];for(const L of z){if(C.overscaledZ+L<P)continue;const B=k(C.calculateScaledKey(C.overscaledZ+L));if(B)return B}},m=[0,0,0],_=(C,P)=>(m[0]=Math.min(C.min.y,P.min.y),m[1]=Math.max(C.max.y,P.max.y),m[2]=Ae-P.min.x>C.max.x?P.min.x-Ae:C.max.x,m),y=(C,P)=>(m[0]=Math.min(C.min.x,P.min.x),m[1]=Math.max(C.max.x,P.max.x),m[2]=Ae-P.min.y>C.max.y?P.min.y-Ae:C.max.y,m),v=[(C,P)=>_(C,P),(C,P)=>_(P,C),(C,P)=>y(C,P),(C,P)=>y(P,C)],b=(C,P,k,z,L,B,W)=>{if(!s)return 0;const Z=[[B?k:C,B?C:k,0],[B?k:P,B?P:k,0]],X=W<0?Ae+W:W,H=[B?X:(C+P)/2,B?(C+P)/2:X,0];return k===0&&W<0||k!==0&&W>0?s.getForTilePoints(L,[H],!0,z):Z.push(H),s.getForTilePoints(r,Z,!0,u),Math.max(Z[0][2],Z[1][2],H[2])/s.exaggeration()};for(let C=0;C<4;C++){const P=i.borderFeatureIndices[C];if(P.length===0)continue;const k=d[C](r),z=p(k);if(!(z&&z instanceof Kd)||i.borderDoneWithNeighborZ[C]===z.canonical.z)continue;z.centroidVertexArray.length===0&&z.createCentroidsBuffer();const L=s?s.findDEMTileFor(k):null;if(!(L&&L.dem||c))continue;const B=(C<2?1:5)-C,W=z.borderDoneWithNeighborZ[B]!==i.canonical.z,Z=z.borderFeatureIndices[B];let X=0;if(i.canonical.z!==z.canonical.z){for(const H of P)i.showCentroid(i.featuresOnBorder[H]);if(W)for(const H of Z)z.showCentroid(z.featuresOnBorder[H]);i.borderDoneWithNeighborZ[C]=z.canonical.z,z.borderDoneWithNeighborZ[B]=i.canonical.z}for(const H of P){const J=i.featuresOnBorder[H],Q=i.centroidData[J.centroidDataIndex],K=J.borders[C];let fe;for(;X<Z.length;){fe=z.featuresOnBorder[Z[X]];const he=fe.borders[B];if(he[1]>K[0]+3||he[0]>K[0]-3)break;z.showCentroid(fe),X++}if(fe&&X<Z.length){const he=X;let _e=0;for(;!(fe.borders[B][0]>K[1]-3)&&(_e++,++X!==Z.length);)fe=z.featuresOnBorder[Z[X]];if(fe=z.featuresOnBorder[Z[he]],_e>1){const ve=fe.borders[B];Math.abs(K[0]-ve[0])<3&&Math.abs(K[1]-ve[1])<3&&(_e=1,X=he+1)}else if(_e===0){i.showCentroid(J);continue}const oe=z.centroidData[fe.centroidDataIndex];c&&_e===1&&(((T=Q).flags|(M=oe).flags)&sl?(T.flags|=sl,M.flags|=sl):(T.flags&=2147483647,M.flags&=2147483647));let me=new $(0,0);if(_e>1)X=he;else if(L&&L.dem&&!(J.intersectsCount()>1||fe.intersectsCount()>1)){const ve=v[C](Q,oe),Ce=C%2?Ae-1:0;S=b(ve[0],Math.min(Ae-1,ve[1]),Ce,L,k,C<2,ve[2]),me=new $(Math.ceil(7*(S+450)),0)}Q.centroidXY=oe.centroidXY=me,i.writeCentroidToBuffer(Q),z.writeCentroidToBuffer(oe)}else i.showCentroid(J)}i.borderDoneWithNeighborZ[C]=z.canonical.z,z.borderDoneWithNeighborZ[B]=i.canonical.z}var S,T,M;(i.needsCentroidUpdate||!i.centroidVertexBuffer&&i.centroidVertexArray.length!==0)&&i.uploadCentroid(t)}const jN=new Zt(1,0,0,1),$N=new Zt(0,1,0,1),VN=new Zt(0,0,1,1),UN=new Zt(1,0,1,1),GN=new Zt(0,1,1,1);function WN(t,e,r){const i=t.context,a=t.transform,s=i.gl,c=a.projection.name==="globe",u=c?["PROJECTION_GLOBE_VIEW"]:null;let d=r.projMatrix;if(c&&Qn(a.zoom)>0){const X=pv(gT(r.canonical,a));d=ge.multiply(new Float32Array(16),a.globeMatrix,X),ge.multiply(d,a.projMatrix,d)}const p=t.useProgram("debug",null,u),m=e.getTileByID(r.key);t.terrain&&t.terrain.setupElevationDraw(m,p);const _=Nt.disabled,y=lr.disabled,v=t.colorModeForRenderPass(),b="$debug";i.activeTexture.set(s.TEXTURE0),t.emptyTexture.bind(s.LINEAR,s.CLAMP_TO_EDGE),c?m._makeGlobeTileDebugBuffers(t.context,a):m._makeDebugTileBoundsBuffers(t.context,a.projection);const S=m._tileDebugBuffer||t.debugBuffer,T=m._tileDebugIndexBuffer||t.debugIndexBuffer,M=m._tileDebugSegments||t.debugSegments;p.draw(t,s.LINE_STRIP,_,y,v,ur.disabled,K5(d,Zt.red),b,S,T,M,null,null,null,[m._globeTileDebugBorderBuffer]);const C=m.latestRawTileData,P=Math.floor((C&&C.byteLength||0)/1024),k=e.getTile(r).tileSize,z=512/Math.min(k,512)*(r.overscaledZ/a.zoom)*.5;let L=r.canonical.toString();r.overscaledZ!==r.canonical.z&&(L+=` => ${r.overscaledZ}`),L+=` ${P}kb`,function(X,H){X.initDebugOverlayCanvas();const J=X.debugOverlayCanvas,Q=X.context.gl,K=X.debugOverlayCanvas.getContext("2d");K.clearRect(0,0,J.width,J.height),K.shadowColor="white",K.shadowBlur=2,K.lineWidth=1.5,K.strokeStyle="white",K.textBaseline="top",K.font="bold 36px Open Sans, sans-serif",K.fillText(H,5,5),K.strokeText(H,5,5),X.debugOverlayTexture.update(J),X.debugOverlayTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE)}(t,L);const B=m._tileDebugTextBuffer||t.debugBuffer,W=m._tileDebugTextIndexBuffer||t.quadTriangleIndexBuffer,Z=m._tileDebugTextSegments||t.debugSegments;p.draw(t,s.TRIANGLES,_,y,Lr.alphaBlended,ur.disabled,K5(d,Zt.transparent,z),b,B,W,Z,null,null,null,[m._globeTileDebugTextBuffer])}function uA(t,e,r,i){Tg(t,0,e+r/2,t.transform.width,r,i)}function hA(t,e,r,i){Tg(t,e-r/2,0,r,t.transform.height,i)}function Tg(t,e,r,i,a,s){const c=t.context,u=c.gl;u.enable(u.SCISSOR_TEST),u.scissor(e*Ot.devicePixelRatio,r*Ot.devicePixelRatio,i*Ot.devicePixelRatio,a*Ot.devicePixelRatio),c.clear({color:s}),u.disable(u.SCISSOR_TEST)}const HN=Ar([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:qN}=HN;function ul(t,e,r,i){t.emplaceBack(e,r,i)}class dA{constructor(e){this.vertexArray=new Vs,this.indices=new Bn,ul(this.vertexArray,-1,-1,1),ul(this.vertexArray,1,-1,1),ul(this.vertexArray,-1,1,1),ul(this.vertexArray,1,1,1),ul(this.vertexArray,-1,-1,-1),ul(this.vertexArray,1,-1,-1),ul(this.vertexArray,-1,1,-1),ul(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=e.createVertexBuffer(this.vertexArray,qN),this.indexBuffer=e.createIndexBuffer(this.indices),this.segment=Gr.simpleSegment(0,0,36,12)}}function Wu(t,e,r,i,a,s){const c=t.context.gl,u=e.paint.get("sky-atmosphere-color"),d=e.paint.get("sky-atmosphere-halo-color"),p=e.paint.get("sky-atmosphere-sun-intensity"),m=((_,y,v,b,S)=>({u_matrix_3f:_,u_sun_direction:y,u_sun_intensity:v,u_color_tint_r:[b.r,b.g,b.b,b.a],u_color_tint_m:[S.r,S.g,S.b,S.a],u_luminance:5e-5}))(Ii.fromMat4(Ii.create(),i),a,p,u,d);c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_CUBE_MAP_POSITIVE_X+s,e.skyboxTexture,0),r.draw(t,c.TRIANGLES,Nt.disabled,lr.disabled,Lr.unblended,ur.frontCW,m,"skyboxCapture",e.skyboxGeometry.vertexBuffer,e.skyboxGeometry.indexBuffer,e.skyboxGeometry.segment)}const ZN=Ar([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class XN{constructor(e){const r=new Sd;r.emplaceBack(-1,1,1,0,0),r.emplaceBack(1,1,1,1,0),r.emplaceBack(1,-1,1,1,1),r.emplaceBack(-1,-1,1,0,1);const i=new Bn;i.emplaceBack(0,1,2),i.emplaceBack(2,3,0),this.vertexBuffer=e.createVertexBuffer(r,ZN.members),this.indexBuffer=e.createIndexBuffer(i),this.segments=Gr.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const YN=Ar([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class KN{constructor(){this.colorModeAlphaBlendedWriteRGB=new Lr([1,sg,1,sg],Zt.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new Lr([1,0,1,0],Zt.transparent,[!1,!1,!1,!0])}update(e){const r=e.context;if(!this.atmosphereBuffer){this.atmosphereBuffer=new XN(r);const i=100,a=100,s=function(m){const _=l1(30),y=[];for(let v=0;v<16e3;++v){const b=2*Math.PI*_(),S=Math.acos(1-2*_())-.5*Math.PI;y.push(ie.fromValues(Math.cos(S)*Math.cos(b),Math.cos(S)*Math.sin(b),Math.sin(S)))}return y}(),c=l1(300),u=new B1,d=new Bn;let p=0;for(let m=0;m<s.length;++m){const _=ie.scale([],s[m],200),y=1+.01*i*(1*c()-.5),v=1+.01*a*(1*c()-.5);u.emplaceBack(_[0],_[1],_[2],-1,-1,y,v),u.emplaceBack(_[0],_[1],_[2],1,-1,y,v),u.emplaceBack(_[0],_[1],_[2],1,1,y,v),u.emplaceBack(_[0],_[1],_[2],-1,1,y,v),d.emplaceBack(p+0,p+1,p+2),d.emplaceBack(p+0,p+2,p+3),p+=4}this.starsVx=r.createVertexBuffer(u,YN.members),this.starsIdx=r.createIndexBuffer(d),this.starsSegments=Gr.simpleSegment(0,0,u.length,d.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(e,r){const i=e.context,a=i.gl,s=e.transform,c=new Nt(a.LEQUAL,Nt.ReadOnly,[0,1]),u=Qn(s.zoom),d=r.properties.get("color").toArray01(),p=r.properties.get("high-color").toArray01(),m=r.properties.get("space-color").toArray01PremultipliedAlpha(),_=5e-4,y=ze((r.properties.get("horizon-blend")-0)/1*.2495+_,5e-4,.25),v=bT(e,i,s)&&y===_?s.worldSize/(2*Math.PI*1.025)-1:s.globeRadius,b=e.frameCounter/1e3%1,S=ie.length(s.globeCenterInViewSpace),T=Math.sqrt(Math.pow(S,2)-Math.pow(v,2)),M=Math.acos(T/S),C=P=>{const k=s.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];P&&k.push("ALPHA_PASS");const z=e.useProgram("globeAtmosphere",null,k),L=((W,Z,X,H,J,Q,K,fe,he,_e,oe,me)=>({u_frustum_tl:W,u_frustum_tr:Z,u_frustum_br:X,u_frustum_bl:H,u_horizon:J,u_transition:Q,u_fadeout_range:K,u_color:fe,u_high_color:he,u_space_color:_e,u_temporal_offset:oe,u_horizon_angle:me}))(s.frustumCorners.TL,s.frustumCorners.TR,s.frustumCorners.BR,s.frustumCorners.BL,s.frustumCorners.horizon,u,y,d,p,m,b,M);e.uploadCommonUniforms(i,z);const B=this.atmosphereBuffer;B&&z.draw(e,a.TRIANGLES,c,lr.disabled,P?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,ur.backCW,L,P?"atmosphere_glow_alpha":"atmosphere_glow",B.vertexBuffer,B.indexBuffer,B.segments)};C(!1),C(!0)}drawStars(e,r){const i=ze(r.properties.get("star-intensity"),0,1);if(i===0)return;const a=e.context,s=a.gl,c=e.transform,u=e.useProgram("stars"),d=oi.identity([]);oi.rotateX(d,d,-c._pitch),oi.rotateZ(d,d,-c.angle),oi.rotateX(d,d,se(c._center.lat)),oi.rotateY(d,d,-se(c._center.lng));const p=ge.fromQuat(new Float32Array(16),d),m=ge.multiply([],c.starsProjMatrix,p),_=Ii.fromMat4([],p),y=Ii.invert([],_),v=[0,1,0];ie.transformMat3(v,v,y),ie.scale(v,v,.2);const b=[1,0,0];ie.transformMat3(b,b,y),ie.scale(b,b,.2);const S=((T,M,C,P)=>({u_matrix:Float32Array.from(T),u_up:M,u_right:C,u_intensity_multiplier:P}))(m,v,b,i);e.uploadCommonUniforms(a,u),this.starsVx&&this.starsIdx&&u.draw(e,s.TRIANGLES,Nt.disabled,lr.disabled,this.colorModeAlphaBlendedWriteRGB,ur.disabled,S,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function fA(t,e){const r=[...t],i=e.cameraWorldSizeForFog/e.worldSize,a=ge.identity([]);return ge.scale(a,a,[i,i,1]),ge.multiply(r,a,r),ge.multiply(r,e.worldToFogMatrix,r),r}function kx(t,e,r,i){const a=r.material,s=a.pbrMetallicRoughness,c=i.context;if(s.baseColorTexture){t.push("HAS_TEXTURE_u_baseColorTexture"),c.activeTexture.set(c.gl.TEXTURE0+qi.BaseColor);const u=s.baseColorTexture.sampler;s.baseColorTexture.gfxTexture&&s.baseColorTexture.gfxTexture.bindExtraParam(u.minFilter,u.magFilter,u.wrapS,u.wrapT)}if(s.metallicRoughnessTexture){t.push("HAS_TEXTURE_u_metallicRoughnessTexture"),c.activeTexture.set(c.gl.TEXTURE0+qi.MetallicRoughness);const u=s.metallicRoughnessTexture.sampler;s.metallicRoughnessTexture.gfxTexture&&s.metallicRoughnessTexture.gfxTexture.bindExtraParam(u.minFilter,u.magFilter,u.wrapS,u.wrapT)}if(a.normalTexture){t.push("HAS_TEXTURE_u_normalTexture"),c.activeTexture.set(c.gl.TEXTURE0+qi.Normal);const u=a.normalTexture.sampler;a.normalTexture.gfxTexture&&a.normalTexture.gfxTexture.bindExtraParam(u.minFilter,u.magFilter,u.wrapS,u.wrapT)}if(a.occlusionTexture){t.push("HAS_TEXTURE_u_occlusionTexture"),c.activeTexture.set(c.gl.TEXTURE0+qi.Occlusion);const u=a.occlusionTexture.sampler;a.occlusionTexture.gfxTexture&&a.occlusionTexture.gfxTexture.bindExtraParam(u.minFilter,u.magFilter,u.wrapS,u.wrapT)}if(a.emissionTexture){t.push("HAS_TEXTURE_u_emissionTexture"),c.activeTexture.set(c.gl.TEXTURE0+qi.Emission);const u=a.emissionTexture.sampler;a.emissionTexture.gfxTexture&&a.emissionTexture.gfxTexture.bindExtraParam(u.minFilter,u.magFilter,u.wrapS,u.wrapT)}r.texcoordBuffer&&(t.push("HAS_ATTRIBUTE_a_uv_2f"),e.push(r.texcoordBuffer)),r.colorBuffer&&(t.push(r.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),e.push(r.colorBuffer)),r.normalBuffer&&(t.push("HAS_ATTRIBUTE_a_normal_3f"),e.push(r.normalBuffer)),r.pbrBuffer&&(t.push("HAS_ATTRIBUTE_a_pbr"),t.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),e.push(r.pbrBuffer)),a.alphaMode!=="OPAQUE"&&a.alphaMode!=="MASK"||t.push("UNPREMULT_TEXTURE_IN_SHADER"),a.defined||t.push("DIFFUSE_SHADED"),t.push("USE_STANDARD_DERIVATIVES")}function Mg(t,e,r,i,a,s){const c=r.paint.get("model-opacity"),u=e.context,d=new Nt(e.context.gl.LEQUAL,Nt.ReadWrite,e.depthRangeFor3D),p=t.mesh,m=p.material,_=m.pbrMetallicRoughness;let y;y=e.transform.projection.zAxisUnit==="pixels"?[...t.nodeModelMatrix]:ge.multiply([],i.zScaleMatrix,t.nodeModelMatrix),ge.multiply(y,i.negCameraPosMatrix,y);const v=ge.invert([],y);ge.transpose(v,v);const b=Ix(new Float32Array(t.worldViewProjection),new Float32Array(y),new Float32Array(v),e,c,_.baseColorFactor,m.emissiveFactor,_.metallicFactor,_.roughnessFactor,m,r),S=[],T=[];kx(S,T,p,e);const M=e.shadowRenderer;M&&(M.useNormalOffset=!1);const C=e.useProgram("model",null,S);let P=null;if(e.style.fog){const k=fA(t.nodeModelMatrix,e.transform);S.push("FOG","FOG_DITHERING"),P=new Float32Array(k)}e.uploadCommonUniforms(u,C,null,P),e.renderPass!=="shadow"&&M&&M.setupShadowsFromMatrix(t.nodeModelMatrix,C),C.draw(e,u.gl.TRIANGLES,d,a,s,ur.backCCW,b,r.id,p.vertexBuffer,p.indexBuffer,p.segments,r.paint,e.transform.zoom,void 0,T)}function pA(t,e,r,i,a,s,c){let u;u=t.projection.name==="globe"?dC(r,t):[...r],ge.multiply(u,u,e.matrix);const d=ge.multiply([],i,u);if(e.meshes)for(const p of e.meshes){if(p.material.alphaMode!=="BLEND"){c.push({mesh:p,depth:0,modelIndex:a,worldViewProjection:d,nodeModelMatrix:u});continue}const m=ie.transformMat4([],p.centroid,d);m[2]>0&&s.push({mesh:p,depth:m[2],modelIndex:a,worldViewProjection:d,nodeModelMatrix:u})}if(e.children)for(const p of e.children)pA(t,p,r,i,a,s,c)}function Rx(t,e,r,i){const a=r.shadowRenderer;if(!a)return;const s=a.getShadowPassDepthMode(),c=a.getShadowPassColorMode(),u=a.calculateShadowPassMatrixFromMatrix(e),d=oA(u);r.useProgram("modelDepth",null,["DEPTH_TEXTURE"]).draw(r,r.context.gl.TRIANGLES,s,lr.disabled,c,ur.backCCW,d,i.id,t.vertexBuffer,t.indexBuffer,t.segments,i.paint,r.transform.zoom,void 0,void 0)}function JN(t,e,r){let i,a,s,c=t.terrain?t.terrain.exaggeration():0;if(t.terrain&&c>0){const u=t.terrain,d=u.findDEMTileFor(r);d&&d.dem?i=Au.create(u,r,d):c=0}if(c===0&&(e.terrainElevationMin=0,e.terrainElevationMax=0),c!==e.validForExaggeration||!(c===0||i&&i._demTile&&i._demTile.tileID===e.validForDEMTile)){for(const u in e.instancesPerModel){const d=e.instancesPerModel[u];for(let p=0;p<d.instancedDataArray.length;++p){const m=(i?c*i.getElevationAt(0|d.instancedDataArray.float32[16*p],0|d.instancedDataArray.float32[16*p+1],!0,!0):0)+d.instancesEvaluatedElevation[p];d.instancedDataArray.float32[16*p+6]=m,a=a?Math.min(e.terrainElevationMin,m):m,s=s?Math.max(e.terrainElevationMax,m):m}}e.terrainElevationMin=a||0,e.terrainElevationMax=s||0,e.validForExaggeration=c,e.validForDEMTile=i&&i._demTile?i._demTile.tileID:void 0,e.uploaded=!1,e.upload(t.context)}}const ls={shadowUniformsInitialized:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new _n([0,0,0],[Ae,Ae,0])};function mA(t,e,r,i,a,s,c){const u=t.context,d=t.renderPass==="shadow",p=t.shadowRenderer,m=d&&p?p.getShadowPassDepthMode():new Nt(u.gl.LEQUAL,Nt.ReadWrite,t.depthRangeFor3D),_=d&&p?p.getShadowPassColorMode():t.colorModeForRenderPass();if(r.meshes)for(const y of r.meshes){const v=["MODEL_POSITION_ON_GPU"],b=[];let S,T;if(d&&p)S=t.useProgram("modelDepth",null,v),T=oA(c.shadowTileMatrix,c.shadowTileMatrix,Float32Array.from(r.matrix));else{kx(v,b,y,t),S=t.useProgram("model",null,v);const C=y.material,P=C.pbrMetallicRoughness;T=Ix(s.projMatrix,Float32Array.from(r.matrix),new Float32Array(16),t,e.paint.get("model-opacity"),P.baseColorFactor,C.emissiveFactor,P.metallicFactor,P.roughnessFactor,C,e,a),p&&(c.shadowUniformsInitialized?S.setShadowUniformValues(u,p.getShadowUniformValues()):(p.setupShadows(s.toUnwrapped(),S,"model-tile",s.overscaledZ),c.shadowUniformsInitialized=!0))}t.uploadCommonUniforms(u,S,s.toUnwrapped());const M=d?"u_instance":"u_normal_matrix";for(let C=0;C<i.instancedDataArray.length;++C)T[M]=new Float32Array(i.instancedDataArray.arrayBuffer,64*C,16),S.draw(t,u.gl.TRIANGLES,m,lr.disabled,_,ur.disabled,T,e.id,y.vertexBuffer,y.indexBuffer,y.segments,e.paint,t.transform.zoom,void 0,b)}if(r.children)for(const y of r.children)mA(t,e,y,i,a,s,c)}const QN=[1,-1,1];function ej(t,e,r,i,a,s,c,u){if(r.renderPass==="opaque")return;const d=t.node,p=r.context,m=r.renderPass==="light-beam",_=[...s];for(let y=0;y<d.meshes.length;++y){const v=d.meshes[y],b=y===d.lightMeshIndex;if(b){if(!m&&!r.terrain&&r.shadowRenderer){r.currentLayer<r.firstLightBeamLayer&&(r.firstLightBeamLayer=r.currentLayer);continue}}else if(m)continue;const S=[],T=[];kx(S,T,v,r),4&e||S.push("DIFFUSE_SHADED");const M=t.evaluatedScale;let C=0;r.terrain&&d.elevation&&(C=d.elevation*r.terrain.exaggeration()),ge.translate(_,_,[(d.anchor?d.anchor[0]:0)*(M[0]-1),(d.anchor?d.anchor[1]:0)*(M[1]-1),C]),M!==BB&&ge.scale(_,_,M),ge.multiply(_,_,d.matrix);const P=r.renderPass==="shadow";if(P)return void Rx(v,_,r,i);let k=null;if(r.style.fog){const K=fA(_,r.transform);S.push("FOG","FOG_DITHERING"),k=new Float32Array(K)}const z=r.useProgram("model",null,S),L=ge.multiply([],c,_);ge.multiply(L,u,L);const B=ge.invert([],L);ge.transpose(B,B),ge.scale(B,B,QN);const W=ge.multiply([],r.transform.projMatrix,_),Z=r.shadowRenderer;!P&&Z&&(Z.useNormalOffset=!!v.normalBuffer,Z.setupShadowsFromMatrix(_,z,Z.useNormalOffset)),r.uploadCommonUniforms(p,z,a.toUnwrapped(),k);const X=v.material,H=X.pbrMetallicRoughness;H.metallicFactor=.9,H.roughnessFactor=.5;const J=Ix(new Float32Array(W),new Float32Array(L),new Float32Array(B),r,i.paint.get("model-opacity"),H.baseColorFactor,X.emissiveFactor,H.metallicFactor,H.roughnessFactor,X,i),Q=new Nt(p.gl.LEQUAL,b?Nt.ReadOnly:Nt.ReadWrite,r.depthRangeFor3D);z.draw(r,p.gl.TRIANGLES,Q,lr.disabled,r.colorModeForRenderPass(),ur.backCCW,J,i.id,v.vertexBuffer,v.indexBuffer,v.segments,i.paint,r.transform.zoom,void 0,T)}}function tj(t,e,r,i){if(!r.modelManager)return!0;const a=r.modelManager;if(!r.shadowRenderer)return!0;const s=r.shadowRenderer,c=e.aabb;let u=!0,d=t.maxHeight;if(d===0){let m=0;for(const _ in t.instancesPerModel){const y=a.getModel(_,i);y?m=Math.max(m,Math.max(Math.max(y.aabb.max[0],y.aabb.max[1]),y.aabb.max[2])):u=!1}d=t.maxScale*m*1.41+t.maxVerticalOffset,u&&(t.maxHeight=d)}c.max[2]=d,c.min[2]+=t.terrainElevationMin,c.max[2]+=t.terrainElevationMax,ie.transformMat4(c.min,c.min,e.tileMatrix),ie.transformMat4(c.max,c.max,e.tileMatrix);const p=c.intersects(s.getCurrentCascadeFrustum());return r.currentShadowCascade===0&&(t.isInsideFirstShadowMapFrustum=p===2),p===0}class rj{}class nj{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(e,r,i){if(!i.isWebGL2)return;{const y=this._storage.get(r.id);if(y)return y.lastUsedFrameIdx=e,y.buf}const a=i.gl,s=i.gl,c=s.getBufferParameter(a.ELEMENT_ARRAY_BUFFER,a.BUFFER_SIZE),u=new ArrayBuffer(c),d=new Int16Array(u);s.getBufferSubData(a.ELEMENT_ARRAY_BUFFER,0,new Int16Array(u));const p=new $s;for(let y=0;y<c/2;y+=3){const v=d[y],b=d[y+1],S=d[y+2];p.emplaceBack(v,b),p.emplaceBack(b,S),p.emplaceBack(S,v)}const m=i.bindVertexArrayOES.current,_=new rj;return _.buf=new ol(i,p),_.lastUsedFrameIdx=e,this._storage.set(r.id,_),i.bindVertexArrayOES.set(m),_.buf}update(e){for(const[r,i]of this._storage)e-i.lastUsedFrameIdx>30&&(i.buf.destroy(),this._storage.delete(r))}destroy(){for(const[e,r]of this._storage)r.buf.destroy(),this._storage.delete(e)}}const gA={symbol:function(t,e,r,i,a){if(t.renderPass!=="translucent")return;const s=lr.disabled,c=t.colorModeForRenderPass();r.layout.get("text-variable-anchor")&&function(u,d,p,m,_,y,v){const b=d.transform,S=_==="map",T=y==="map";for(const M of u){const C=m.getTile(M),P=C.getBucket(p);if(!P||!P.text||!P.text.segments.get().length)continue;const k=ka(P.textSizeData,b.zoom),z=yx(M,P.getProjection(),b),L=b.calculatePixelsToTileUnitsMatrix(C),B=cg(z,C.tileID.canonical,T,S,b,P.getProjection(),L),W=P.hasIconTextFit()&&P.hasIconData();if(k){const Z=Math.pow(2,b.zoom-C.tileID.overscaledZ);FN(P,S,T,v,s7,b,B,M,Z,k,W)}}}(i,t,r,e,r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),a),r.paint.get("icon-opacity").constantOr(1)!==0&&lA(t,e,r,i,!1,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),r.layout.get("icon-rotation-alignment"),r.layout.get("icon-pitch-alignment"),r.layout.get("icon-keep-upright"),s,c),r.paint.get("text-opacity").constantOr(1)!==0&&lA(t,e,r,i,!0,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),r.layout.get("text-rotation-alignment"),r.layout.get("text-pitch-alignment"),r.layout.get("text-keep-upright"),s,c),e.map.showCollisionBoxes&&(aA(t,e,r,i,r.paint.get("text-translate"),r.paint.get("text-translate-anchor"),!0),aA(t,e,r,i,r.paint.get("icon-translate"),r.paint.get("icon-translate-anchor"),!1))},circle:function(t,e,r,i){if(t.renderPass!=="translucent")return;const a=r.paint.get("circle-opacity"),s=r.paint.get("circle-stroke-width"),c=r.paint.get("circle-stroke-opacity"),u=r.layout.get("circle-sort-key").constantOr(1)!==void 0,d=r.paint.get("circle-emissive-strength");if(a.constantOr(1)===0&&(s.constantOr(1)===0||c.constantOr(1)===0))return;const p=t.context,m=p.gl,_=t.transform,y=t.depthModeForSublayer(0,Nt.ReadOnly),v=lr.disabled,b=t.colorModeForDrapableLayerRenderPass(d),S=_.projection.name==="globe",T=[ei(_.center.lng),ai(_.center.lat)],M=[];for(let P=0;P<i.length;P++){const k=i[P],z=e.getTile(k),L=z.getBucket(r);if(!L||L.projection.name!==_.projection.name)continue;const B=L.programConfigurations.get(r.id),W=EN(r);S&&W.push("PROJECTION_GLOBE_VIEW");const Z=t.useProgram("circle",B,W),X=L.layoutVertexBuffer,H=L.globeExtVertexBuffer,J=L.indexBuffer,Q=_.projection.createInversionMatrix(_,k.canonical),K={programConfiguration:B,program:Z,layoutVertexBuffer:X,globeExtVertexBuffer:H,indexBuffer:J,uniformValues:wN(t,k,z,Q,T,r),tile:z};if(u){const fe=L.segments.get();for(const he of fe)M.push({segments:new Gr([he]),sortKey:he.sortKey,state:K})}else M.push({segments:L.segments,sortKey:0,state:K})}u&&M.sort((P,k)=>P.sortKey-k.sortKey);const C={useDepthForOcclusion:!S};for(const P of M){const{programConfiguration:k,program:z,layoutVertexBuffer:L,globeExtVertexBuffer:B,indexBuffer:W,uniformValues:Z,tile:X}=P.state,H=P.segments;t.terrain&&t.terrain.setupElevationDraw(X,z,C),t.uploadCommonUniforms(p,z,X.tileID.toUnwrapped()),z.draw(t,m.TRIANGLES,y,v,b,ur.disabled,Z,r.id,L,W,H,r.paint,_.zoom,k,[B])}},heatmap:function(t,e,r,i){if(r.paint.get("heatmap-opacity")!==0)if(t.renderPass==="offscreen"){const a=t.context,s=a.gl,c=lr.disabled,u=new Lr([s.ONE,s.ONE,s.ONE,s.ONE],Zt.transparent,[!0,!0,!0,!0]);(function(v,b,S,T){const M=v.gl,C=b.width*T,P=b.height*T;v.activeTexture.set(M.TEXTURE1),v.viewport.set([0,0,C,P]);let k=S.heatmapFbo;if(!k||k&&(k.width!==C||k.height!==P)){k&&k.destroy();const z=M.createTexture();M.bindTexture(M.TEXTURE_2D,z),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_S,M.CLAMP_TO_EDGE),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_WRAP_T,M.CLAMP_TO_EDGE),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MIN_FILTER,M.LINEAR),M.texParameteri(M.TEXTURE_2D,M.TEXTURE_MAG_FILTER,M.LINEAR),k=S.heatmapFbo=v.createFramebuffer(C,P,!0,null),function(L,B,W,Z,X,H){const J=L.gl;J.texImage2D(J.TEXTURE_2D,0,L.isWebGL2&&L.extRenderToTextureHalfFloat?J.RGBA16F:J.RGBA,X,H,0,J.RGBA,L.extRenderToTextureHalfFloat?L.isWebGL2?J.HALF_FLOAT:L.extTextureHalfFloat.HALF_FLOAT_OES:J.UNSIGNED_BYTE,null),Z.colorAttachment.set(W)}(v,0,z,k,C,P)}else M.bindTexture(M.TEXTURE_2D,k.colorAttachment.get()),v.bindFramebuffer.set(k.framebuffer)})(a,t,r,t.transform.projection.name==="globe"?.5:.25),a.clear({color:Zt.transparent});const d=t.transform,p=d.projection.name==="globe",m=p?["PROJECTION_GLOBE_VIEW"]:null,_=p?ur.frontCCW:ur.disabled,y=[ei(d.center.lng),ai(d.center.lat)];for(let v=0;v<i.length;v++){const b=i[v];if(e.hasRenderableParent(b))continue;const S=e.getTile(b),T=S.getBucket(r);if(!T||T.projection.name!==d.projection.name)continue;const M=T.programConfigurations.get(r.id),C=t.useProgram("heatmap",M,m),{zoom:P}=t.transform;t.terrain&&t.terrain.setupElevationDraw(S,C),t.uploadCommonUniforms(a,C,b.toUnwrapped());const k=d.projection.createInversionMatrix(d,b.canonical);C.draw(t,s.TRIANGLES,Nt.disabled,c,u,_,MN(t,b,S,k,y,P,r.paint.get("heatmap-intensity")),r.id,T.layoutVertexBuffer,T.indexBuffer,T.segments,r.paint,t.transform.zoom,M,p?[T.globeExtVertexBuffer]:null)}a.viewport.set([0,0,t.width,t.height])}else t.renderPass==="translucent"&&(t.context.setColorMode(t.colorModeForRenderPass()),function(a,s){const c=a.context,u=c.gl,d=s.heatmapFbo;if(!d)return;c.activeTexture.set(u.TEXTURE0),u.bindTexture(u.TEXTURE_2D,d.colorAttachment.get()),c.activeTexture.set(u.TEXTURE1);let p=s.colorRampTexture;p||(p=s.colorRampTexture=new Dn(c,s.colorRamp,u.RGBA)),p.bind(u.LINEAR,u.CLAMP_TO_EDGE),a.useProgram("heatmapTexture").draw(a,u.TRIANGLES,Nt.disabled,lr.disabled,a.colorModeForRenderPass(),ur.disabled,((m,_,y,v)=>({u_image:0,u_color_ramp:1,u_opacity:_.paint.get("heatmap-opacity")}))(0,s),s.id,a.viewportBuffer,a.quadTriangleIndexBuffer,a.viewportSegments,s.paint,a.transform.zoom)}(t,r))},line:function(t,e,r,i){if(t.renderPass!=="translucent")return;const a=r.paint.get("line-opacity"),s=r.paint.get("line-width");if(a.constantOr(1)===0||s.constantOr(1)===0)return;const c=r.paint.get("line-emissive-strength"),u=t.depthModeForSublayer(0,Nt.ReadOnly),d=t.colorModeForDrapableLayerRenderPass(c),p=t.terrain&&t.terrain.renderingToTexture?1:Ot.devicePixelRatio,m=r.paint.get("line-dasharray"),_=m.constantOr(1),y=r.layout.get("line-cap"),v=r.paint.get("line-pattern"),b=v.constantOr(1),S=r.paint.get("line-gradient"),T=b?"linePattern":"line",M=t.context,C=M.gl,P=(z=>{const L=[];eA(z)&&L.push("RENDER_LINE_DASH"),z.paint.get("line-gradient")&&L.push("RENDER_LINE_GRADIENT");const B=z.paint.get("line-trim-offset");B[0]===0&&B[1]===0||L.push("RENDER_LINE_TRIM_OFFSET");const W=z.paint.get("line-pattern").constantOr(1),Z=z.paint.get("line-opacity").constantOr(1)!==1;return!W&&Z&&L.push("RENDER_LINE_ALPHA_DISCARD"),z.paint.get("line-border-width").constantOr(0)>0&&L.push("RENDER_LINE_BORDER"),z.paint.get("line-border-color").constantOr(Zt.transparent).a===0&&L.push("RENDER_LINE_BORDER_AUTO"),L})(r);let k=P.includes("RENDER_LINE_ALPHA_DISCARD");t.terrain&&t.terrain.clipOrMaskOverlapStencilType()&&(k=!1);for(const z of i){const L=e.getTile(z);if(b&&!L.patternsLoaded())continue;const B=L.getBucket(r);if(!B)continue;t.prepareDrawTile();const W=B.programConfigurations.get(r.id),Z=t.useProgram(T,W,P),X=v.constantOr(null);if(X&&L.imageAtlas){const oe=L.imageAtlas.patternPositions[X.toString()];oe&&W.setConstantPatternPositions(oe)}const H=m.constantOr(null),J=y.constantOr(null);if(!b&&H&&J&&L.lineAtlas){const oe=L.lineAtlas.getDash(H,J);oe&&W.setConstantPatternPositions(oe)}let[Q,K]=r.paint.get("line-trim-offset");(J==="round"||J==="square")&&Q!==K&&(Q===0&&(Q-=1),K===1&&(K+=1));const fe=t.terrain?z.projMatrix:null,he=b?AN(t,L,r,fe,p):CN(t,L,r,fe,B.lineClipsArray.length,p,[Q,K]);if(S){const oe=B.gradients[r.id];let me=oe.texture;if(r.gradientVersion!==oe.version){let ve=256;if(r.stepInterpolant){const Ce=e.getSource().maxzoom,Se=z.canonical.z===Ce?Math.ceil(1<<t.transform.maxZoom-z.canonical.z):1;ve=ze(Ur(B.maxLineLength/Ae*1024*Se),256,M.maxTextureSize)}oe.gradient=km({expression:r.gradientExpression(),evaluationKey:"lineProgress",resolution:ve,image:oe.gradient||void 0,clips:B.lineClipsArray}),oe.texture?oe.texture.update(oe.gradient):oe.texture=new Dn(M,oe.gradient,C.RGBA),oe.version=r.gradientVersion,me=oe.texture}M.activeTexture.set(C.TEXTURE1),me.bind(r.stepInterpolant?C.NEAREST:C.LINEAR,C.CLAMP_TO_EDGE)}_&&(M.activeTexture.set(C.TEXTURE0),L.lineAtlasTexture.bind(C.LINEAR,C.REPEAT),W.updatePaintBuffers()),b&&(M.activeTexture.set(C.TEXTURE0),L.imageAtlasTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),W.updatePaintBuffers()),t.uploadCommonUniforms(M,Z,z.toUnwrapped());const _e=oe=>{Z.draw(t,C.TRIANGLES,u,oe,d,ur.disabled,he,r.id,B.layoutVertexBuffer,B.indexBuffer,B.segments,r.paint,t.transform.zoom,W,[B.layoutVertexBuffer2])};if(k){const oe=t.stencilModeForClipping(z).ref;oe===0&&t.terrain&&M.clear({stencil:0});const me={func:C.EQUAL,mask:255};he.u_alpha_discard_threshold=.8,_e(new lr(me,oe,255,C.KEEP,C.KEEP,C.INVERT)),he.u_alpha_discard_threshold=0,_e(new lr(me,oe,255,C.KEEP,C.KEEP,C.KEEP))}else _e(t.stencilModeForClipping(z))}k&&(t.resetStencilClippingMasks(),t.terrain&&M.clear({stencil:0}))},fill:function(t,e,r,i){const a=r.paint.get("fill-color"),s=r.paint.get("fill-opacity");if(s.constantOr(1)===0)return;const c=r.paint.get("fill-emissive-strength"),u=t.colorModeForDrapableLayerRenderPass(c),d=r.paint.get("fill-pattern"),p=t.opaquePassEnabledForLayer()&&!d.constantOr(1)&&a.constantOr(Zt.transparent).a===1&&s.constantOr(0)===1?"opaque":"translucent";if(t.renderPass===p){const m=t.depthModeForSublayer(1,t.renderPass==="opaque"?Nt.ReadWrite:Nt.ReadOnly);cA(t,e,r,i,m,u,!1)}if(t.renderPass==="translucent"&&r.paint.get("fill-antialias")){const m=t.depthModeForSublayer(r.getPaintProperty("fill-outline-color")?2:0,Nt.ReadOnly);cA(t,e,r,i,m,u,!0)}},"fill-extrusion":function(t,e,r,i){const a=r.paint.get("fill-extrusion-opacity"),s=t.context,c=s.gl,u=t.terrain,d=u&&u.renderingToTexture;if(a===0)return;const p=t.conflationActive&&t.layerUsedInConflation(r,e.getSource());if(p&&function(m,_,y,v){for(const b of v){const S=_.getTile(b).getBucket(y);S&&(S.updateReplacement(b,m.replacementSource),S.uploadCentroid(m.context))}}(t,e,r,i),u||p)for(const m of i){const _=e.getTile(m).getBucket(r);_&&NN(t.context,e,m,_,r,u,p)}if(t.renderPass==="shadow"&&t.shadowRenderer){const m=t.shadowRenderer,_=m.getShadowPassDepthMode(),y=m.getShadowPassColorMode();Sg(t,e,r,i,_,lr.disabled,y,p)}else if(t.renderPass==="translucent"){const m=!r.paint.get("fill-extrusion-pattern").constantOr(1);if(!d){const y=new Nt(t.context.gl.LEQUAL,Nt.ReadWrite,t.depthRangeFor3D);if(a===1&&m){const v=t.colorModeForRenderPass();Sg(t,e,r,i,y,lr.disabled,v,p)}else Sg(t,e,r,i,y,lr.disabled,Lr.disabled,p),Sg(t,e,r,i,y,t.stencilModeFor3D(),t.colorModeForRenderPass(),p),t.resetStencilClippingMasks()}const _=t.style.enable3dLights();if(t.context.isWebGL2&&_&&m&&(!u&&t.transform.projection.name!=="globe"||d)){const y=r.paint.get("fill-extrusion-opacity"),v=r.paint.get("fill-extrusion-ambient-occlusion-intensity"),b=r.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),S=r.paint.get("fill-extrusion-flood-light-intensity"),T=r.paint.get("fill-extrusion-flood-light-color").toArray01().slice(0,3),M=v>0&&b>0,C=S>0,P=(z,L,B)=>(1-B)*z+B*L,k=z=>{const L=t.depthModeForSublayer(1,Nt.ReadOnly,c.LEQUAL,!0),B=r.paint.get(z?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),W=P(.1,3,B),Z=t._showOverdrawInspector;{const X=new lr({func:c.ALWAYS,mask:255},255,255,c.KEEP,c.KEEP,c.REPLACE),H=new Lr([c.ONE,c.ONE,c.ONE,c.ONE],Zt.transparent,[!1,!1,!1,!0],c.MIN);Gu(t,e,r,i,L,X,H,ur.disabled,z,"sdf",y,v,b,S,T,W,p)}{const X=new lr({func:c.EQUAL,mask:255},255,255,c.KEEP,c.DECR,c.DECR),H=new Lr([c.ONE_MINUS_DST_ALPHA,c.DST_ALPHA,c.ONE,c.ONE],Zt.transparent,[!0,!0,!0,!0]);Gu(t,e,r,i,L,X,Z?t.colorModeForRenderPass():H,ur.disabled,z,"color",y,v,b,S,T,W,p)}};if(d){const z=(L,B)=>{const W=t.depthModeForSublayer(1,Nt.ReadOnly,c.LEQUAL,!1),Z=r.paint.get(L?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),X=P(.1,3,Z);{const H=new Lr([c.ONE,c.ONE,c.ONE,c.ONE],Zt.transparent,[!1,!1,!1,!0]);Gu(t,e,r,i,W,lr.disabled,H,ur.disabled,L,"clear",y,v,b,S,T,X,p)}{const H=new lr({func:c.ALWAYS,mask:255},255,255,c.KEEP,c.KEEP,c.REPLACE),J=new Lr([c.ONE,c.ONE,c.ONE,c.ONE],Zt.transparent,[!1,!1,!1,!0],c.MIN);Gu(t,e,r,i,W,H,J,ur.disabled,L,"sdf",y,v,b,S,T,X,p)}{const H=L?c.ZERO:c.ONE_MINUS_DST_ALPHA,J=new lr({func:c.EQUAL,mask:255},255,255,c.KEEP,c.DECR,c.DECR),Q=new Lr([H,c.DST_ALPHA,c.ONE_MINUS_DST_ALPHA,c.ZERO],Zt.transparent,[!0,!0,!0,!0]);Gu(t,e,r,i,W,J,Q,ur.disabled,L,"color",y,v,b,S,T,X,p)}{const H=new Lr([c.ONE,c.ONE,c.ONE,L?c.ZERO:c.ONE],Zt.transparent,[!1,!1,!1,!0],L?c.FUNC_ADD:c.MAX);Gu(t,e,r,i,W,lr.disabled,H,ur.disabled,L,"clear",y,v,b,S,T,X,p,B)}};if(M||C){let L;if(t.prepareDrawTile(),u){const B=u.drapeBufferSize[0],W=u.drapeBufferSize[1];L=u.framebufferCopyTexture,L&&(!L||L.size[0]===B&&L.size[1]===W)||(L&&L.destroy(),L=u.framebufferCopyTexture=new Dn(s,new Sn({width:B,height:W}),c.RGBA)),L.bind(c.LINEAR,c.CLAMP_TO_EDGE),c.copyTexImage2D(c.TEXTURE_2D,0,c.RGBA,0,0,B,W,0)}M&&z(!0,L),C&&z(!1,L)}}else M&&k(!0),C&&k(!1)}}},hillshade:function(t,e,r,i){if(t.renderPass!=="offscreen"&&t.renderPass!=="translucent")return;const a=t.context,s=t.depthModeForSublayer(0,Nt.ReadOnly),c=t.colorModeForRenderPass(),u=t.terrain&&t.terrain.renderingToTexture,[d,p]=t.renderPass!=="translucent"||u?[{},i]:t.stencilConfigForOverlap(i);for(const m of p){const _=e.getTile(m);if(_.needsHillshadePrepare&&t.renderPass==="offscreen")oN(t,_,r,s,lr.disabled,c);else if(t.renderPass==="translucent"){const y=u&&t.terrain?t.terrain.stencilModeForRTTOverlap(m):d[m.overscaledZ];iN(t,m,_,r,s,y,c)}}a.viewport.set([0,0,t.width,t.height]),t.resetStencilClippingMasks()},raster:function(t,e,r,i,a,s){if(t.renderPass!=="translucent"||r.paint.get("raster-opacity")===0||!i.length)return;const c=t.context,u=c.gl,d=e.getSource(),p=function(M,C,P){const k=[];let z,L;if(M.paint.get("raster-color")){k.push("RASTER_COLOR"),z=M.paint.get("raster-color-mix"),L=M.paint.get("raster-color-range"),C.activeTexture.set(P.TEXTURE2);let B=M.colorRampTexture;B||(B=M.colorRampTexture=new Dn(C,M.colorRamp,P.RGBA)),B.bind(P.LINEAR,P.CLAMP_TO_EDGE)}return{mix:z,range:L,defines:k}}(r,c,u),m=t.useProgram("raster",null,p.defines),_=t.colorModeForDrapableLayerRenderPass(),y=t.terrain&&t.terrain.renderingToTexture,[v,b]=d instanceof sc||y?[{},i]:t.stencilConfigForOverlap(i),S=b[b.length-1].overscaledZ,T=!t.options.moving;for(const M of b){const C=y?Nt.disabled:t.depthModeForSublayer(M.overscaledZ-S,r.paint.get("raster-opacity")===1?Nt.ReadWrite:Nt.ReadOnly,u.LESS),P=M.toUnwrapped(),k=e.getTile(M);if(y&&(!k||!k.hasData()))continue;const z=y?M.projMatrix:t.transform.calculateProjMatrix(P,T),L=t.terrain&&y?t.terrain.stencilModeForRTTOverlap(M):v[M.overscaledZ],B=s?0:r.paint.get("raster-fade-duration");k.registerFadeDuration(B);const W=e.findLoadedParent(M,0),Z=G5(k,W,e,t.transform,B);let X,H;t.terrain&&t.terrain.prepareDrawTile();const J=r.paint.get("raster-resampling")==="nearest"?u.NEAREST:u.LINEAR;c.activeTexture.set(u.TEXTURE0),k.texture.bind(J,u.CLAMP_TO_EDGE),c.activeTexture.set(u.TEXTURE1),W?(W.texture.bind(J,u.CLAMP_TO_EDGE),X=Math.pow(2,W.tileID.overscaledZ-k.tileID.overscaledZ),H=[k.tileID.canonical.x*X%1,k.tileID.canonical.y*X%1]):k.texture.bind(J,u.CLAMP_TO_EDGE),k.texture.useMipmap&&c.extTextureFilterAnisotropic&&t.transform.pitch>20&&u.texParameterf(u.TEXTURE_2D,c.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c.extTextureFilterAnisotropicMax);const Q=IN(z,H||[0,0],X||1,Z,r,d instanceof sc?d.perspectiveTransform:[0,0],2,p.mix||[0,0,0,0],p.range||[0,0]);if(t.uploadCommonUniforms(c,m,P),d instanceof sc)d.boundsBuffer&&d.boundsSegments&&m.draw(t,u.TRIANGLES,C,lr.disabled,_,ur.disabled,Q,r.id,d.boundsBuffer,t.quadTriangleIndexBuffer,d.boundsSegments);else{const{tileBoundsBuffer:K,tileBoundsIndexBuffer:fe,tileBoundsSegments:he}=t.getTileBoundsBuffers(k);m.draw(t,u.TRIANGLES,C,L,_,ur.disabled,Q,r.id,K,fe,he)}}t.resetStencilClippingMasks()},background:function(t,e,r,i){const a=r.paint.get("background-color"),s=r.paint.get("background-opacity"),c=r.paint.get("background-emissive-strength");if(s===0)return;const u=t.context,d=u.gl,p=t.transform,m=p.tileSize,_=r.paint.get("background-pattern");if(t.isPatternMissing(_,r.scope))return;const y=!_&&a.a===1&&s===1&&t.opaquePassEnabledForLayer()?"opaque":"translucent";if(t.renderPass!==y)return;const v=lr.disabled,b=t.depthModeForSublayer(0,y==="opaque"?Nt.ReadWrite:Nt.ReadOnly),S=t.colorModeForDrapableLayerRenderPass(c),T=t.useProgram(_?"backgroundPattern":"background");let M,C=i;C||(M=t.getBackgroundTiles(),C=Object.values(M).map(P=>P.tileID)),_&&(u.activeTexture.set(d.TEXTURE0),t.imageManager.bind(t.context,r.scope));for(const P of C){const k=P.toUnwrapped(),z=i?P.projMatrix:t.transform.calculateProjMatrix(k);t.prepareDrawTile();const L=e?e.getTile(P):M?M[P.key]:new Wd(P,m,p.zoom,t),B=_?DN(z,c,s,t,_,r.scope,{tileID:P,tileSize:m}):zN(z,c,s,a);t.uploadCommonUniforms(u,T,k);const{tileBoundsBuffer:W,tileBoundsIndexBuffer:Z,tileBoundsSegments:X}=t.getTileBoundsBuffers(L);T.draw(t,d.TRIANGLES,b,v,S,ur.disabled,B,r.id,W,Z,X)}},sky:function(t,e,r){const i=t._atmosphere?Qn(t.transform.zoom):1,a=r.paint.get("sky-opacity")*i;if(a===0)return;const s=t.context,c=r.paint.get("sky-type"),u=new Nt(s.gl.LEQUAL,Nt.ReadOnly,[0,1]),d=t.frameCounter/1e3%1;c==="atmosphere"?t.renderPass==="offscreen"?r.needsSkyboxCapture(t)&&(function(p,m,_,y){const v=p.context,b=v.gl;let S=m.skyboxFbo;if(!S){S=m.skyboxFbo=v.createFramebuffer(32,32,!0,null),m.skyboxGeometry=new dA(v),m.skyboxTexture=v.gl.createTexture(),b.bindTexture(b.TEXTURE_CUBE_MAP,m.skyboxTexture),b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_WRAP_S,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_WRAP_T,b.CLAMP_TO_EDGE),b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_MIN_FILTER,b.LINEAR),b.texParameteri(b.TEXTURE_CUBE_MAP,b.TEXTURE_MAG_FILTER,b.LINEAR);for(let P=0;P<6;++P)b.texImage2D(b.TEXTURE_CUBE_MAP_POSITIVE_X+P,0,b.RGBA,32,32,0,b.RGBA,b.UNSIGNED_BYTE,null)}v.bindFramebuffer.set(S.framebuffer),v.viewport.set([0,0,32,32]);const T=m.getCenter(p,!0),M=p.useProgram("skyboxCapture"),C=new Float64Array(16);ge.identity(C),ge.rotateY(C,C,.5*-Math.PI),Wu(p,m,M,C,T,0),ge.identity(C),ge.rotateY(C,C,.5*Math.PI),Wu(p,m,M,C,T,1),ge.identity(C),ge.rotateX(C,C,.5*-Math.PI),Wu(p,m,M,C,T,2),ge.identity(C),ge.rotateX(C,C,.5*Math.PI),Wu(p,m,M,C,T,3),ge.identity(C),Wu(p,m,M,C,T,4),ge.identity(C),ge.rotateY(C,C,Math.PI),Wu(p,m,M,C,T,5),v.viewport.set([0,0,p.width,p.height])}(t,r),r.markSkyboxValid(t)):t.renderPass==="sky"&&function(p,m,_,y,v){const b=p.context,S=b.gl,T=p.transform,M=p.useProgram("skybox");b.activeTexture.set(S.TEXTURE0),S.bindTexture(S.TEXTURE_CUBE_MAP,m.skyboxTexture);const C=((P,k,z,L,B)=>({u_matrix:P,u_sun_direction:k,u_cubemap:0,u_opacity:L,u_temporal_offset:B}))(T.skyboxMatrix,m.getCenter(p,!1),0,y,v);p.uploadCommonUniforms(b,M),M.draw(p,S.TRIANGLES,_,lr.disabled,p.colorModeForRenderPass(),ur.backCW,C,"skybox",m.skyboxGeometry.vertexBuffer,m.skyboxGeometry.indexBuffer,m.skyboxGeometry.segment)}(t,r,u,a,d):c==="gradient"&&t.renderPass==="sky"&&function(p,m,_,y,v){const b=p.context,S=b.gl,T=p.transform,M=p.useProgram("skyboxGradient");m.skyboxGeometry||(m.skyboxGeometry=new dA(b)),b.activeTexture.set(S.TEXTURE0);let C=m.colorRampTexture;C||(C=m.colorRampTexture=new Dn(b,m.colorRamp,S.RGBA)),C.bind(S.LINEAR,S.CLAMP_TO_EDGE);const P=((k,z,L,B,W)=>({u_matrix:k,u_color_ramp:0,u_center_direction:z,u_radius:se(L),u_opacity:B,u_temporal_offset:W}))(T.skyboxMatrix,m.getCenter(p,!1),m.paint.get("sky-gradient-radius"),y,v);p.uploadCommonUniforms(b,M),M.draw(p,S.TRIANGLES,_,lr.disabled,p.colorModeForRenderPass(),ur.backCW,P,"skyboxGradient",m.skyboxGeometry.vertexBuffer,m.skyboxGeometry.indexBuffer,m.skyboxGeometry.segment)}(t,r,u,a,d)},debug:function(t,e,r){for(let i=0;i<r.length;i++)WN(t,e,r[i])},custom:function(t,e,r,i){const a=t.context,s=r.implementation;if(!t.transform.projection.unsupportedLayers||!t.transform.projection.unsupportedLayers.includes("custom")||t.terrain&&(t.terrain.renderingToTexture||t.renderPass==="offscreen")&&r.isLayerDraped()){if(t.renderPass==="offscreen"){const c=s.prerender;if(c){if(t.setCustomLayerDefaults(),a.setColorMode(t.colorModeForRenderPass()),t.transform.projection.name==="globe"){const u=t.transform.pointMerc;c.call(s,a.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),Qn(t.transform.zoom),[u.x,u.y],t.transform.pixelsPerMeterRatio)}else c.call(s,a.gl,t.transform.customLayerMatrix());a.setDirty(),t.setBaseState()}}else if(t.renderPass==="translucent"){if(t.terrain&&t.terrain.renderingToTexture){const u=s.renderToTile;if(u){const d=i[0].canonical,p=new cr(d.x+i[0].wrap*(1<<d.z),d.y,d.z);a.setDepthMode(Nt.disabled),a.setStencilMode(lr.disabled),a.setColorMode(t.colorModeForRenderPass()),t.setCustomLayerDefaults(),u.call(s,a.gl,p),a.setDirty(),t.setBaseState()}return}t.setCustomLayerDefaults(),a.setColorMode(t.colorModeForRenderPass()),a.setStencilMode(lr.disabled);const c=s.renderingMode==="3d"?new Nt(t.context.gl.LEQUAL,Nt.ReadWrite,t.depthRangeFor3D):t.depthModeForSublayer(0,Nt.ReadOnly);if(a.setDepthMode(c),t.transform.projection.name==="globe"){const u=t.transform.pointMerc;s.render(a.gl,t.transform.customLayerMatrix(),t.transform.getProjection(),t.transform.globeToMercatorMatrix(),Qn(t.transform.zoom),[u.x,u.y],t.transform.pixelsPerMeterRatio)}else s.render(a.gl,t.transform.customLayerMatrix());a.setDirty(),t.setBaseState(),a.bindFramebuffer.set(null)}}else re("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(t,e,r,i){if(t.renderPass==="opaque")return;const a=r.paint.get("model-opacity");if(a===0)return;const s=r.paint.get("model-cast-shadows");if(t.renderPass==="shadow"&&!s)return;const c=t.shadowRenderer,u=r.paint.get("model-receive-shadows");c&&(c.useNormalOffset=!0,u||(c.enabled=!1));const d=()=>{c&&(c.useNormalOffset=!0,u||(c.enabled=!0))},p=e.getSource();if(t.renderPass==="light-beam"&&p.type!=="batched-model"||!p.loaded())return;if(p.type==="vector"||p.type==="geojson")return function(M,C,P,k){const z=M.transform;if(z.projection.name!=="mercator")return void re(`Drawing 3D models for ${z.projection.name} projection is not yet implemented`);const L=z.getFreeCameraOptions().position,B=[L.x,L.y,L.z-z.pixelsPerMeter/z.worldSize*z._centerAltitude],W=M.transform._camera.forward(),Z=[0,0,0],X=[0,0,0];if(!M.modelManager)return;const H=M.modelManager;if(!P._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const J=P._unevaluatedLayout._values["model-id"],Q={...P.layout.get("model-id").parameters};for(const K of k){const fe=C.getTile(K).getBucket(P);if(!fe||fe.projection.name!==z.projection.name)continue;let he=fe.zoom;X[0]=K.wrap+(K.canonical.x+(M.transform.bearing<0?.75:.25))/(1<<K.canonical.z),X[1]=(K.canonical.y+(Math.abs(M.transform.bearing)<90?.75:.25))/(1<<K.canonical.z),ie.sub(Z,X,B);const _e=Math.max(0,ie.dot(Z,W));he=M.transform._zoomFromMercatorZ(_e),M.transform.pitch>30&&he<M.transform.zoom&&fe.instanceCount>400&&(he-=.5),Q.zoom=he;const oe=J.possiblyEvaluate(Q);if(JN(M,fe,K),ls.shadowUniformsInitialized=!1,M.renderPass==="shadow"&&M.shadowRenderer){const ve=M.shadowRenderer;if(M.currentShadowCascade===1&&fe.isInsideFirstShadowMapFrustum)continue;const Ce=z.calculatePosMatrix(K.toUnwrapped(),z.worldSize);if(ls.tileMatrix.set(Ce),ls.shadowTileMatrix=Float32Array.from(ve.calculateShadowPassMatrixFromMatrix(Ce)),ls.aabb.min.fill(0),ls.aabb.max[0]=ls.aabb.max[1]=Ae,ls.aabb.max[2]=0,tj(fe,ls,M,P.scope))continue}let me=ie.scale([],B,1<<K.canonical.z);me=[(me[0]-K.canonical.x-K.wrap*(1<<K.canonical.z))*Ae,(me[1]-K.canonical.y)*Ae,me[2]*Ae];for(let ve in fe.instancesPerModel){const Ce=fe.instancesPerModel[ve];Ce.features.length>0&&(ve=oe.evaluate(Ce.features[0].feature,{}));const Se=H.getModel(ve,P.scope);if(Se)for(const Je of Se.nodes)mA(M,P,Je,Ce,me,K,ls)}}}(t,e,r,i),void d();if(p.type==="batched-model")return function(M,C,P,k){const z=M.transform;if(z.projection.name!=="mercator")return void re(`Drawing 3D landmark models for ${z.projection.name} projection is not yet implemented`);const L=M.transform.getFreeCameraOptions().position,B=ie.scale([],[L.x,L.y,L.z],M.transform.worldSize);ie.negate(B,B);const W=ge.identity([]),Z=Ys(z.center.lat,z.zoom),X=ge.fromScaling([],[1,1,1/Z]);ge.translate(W,W,B),function(H,J,Q,K){const fe=H.terrain?H.terrain.exaggeration():0,he=H.transform.zoom;for(const _e of K){const oe=J.getTile(_e).getBucket(Q);oe&&(H.conflationActive&&oe.updateReplacement(_e,H.replacementSource),oe.evaluateScale(H,Q),H.terrain&&fe>0&&oe.elevationUpdate(H.terrain,fe,_e),oe.needsReEvaluation(H,he,Q)&&oe.evaluate(Q))}}(M,C,P,k);for(const H of k){const J=C.getTile(H).getBucket(P);if(!J||!J.uploaded)continue;const Q=z.calculatePosMatrix(H.toUnwrapped(),z.worldSize),K=J.getNodesInfo();for(const fe of K)fe.hiddenByReplacement||fe.node.meshes&&ej(fe,J.modelTraits,M,P,H,Q,X,W)}}(t,e,r,i),void d();const m=p.getModels(),_=[],y=t.transform.getFreeCameraOptions().position,v=ie.scale([],[y.x,y.y,y.z],t.transform.worldSize);ie.negate(v,v);const b=[],S=[];let T=0;for(const M of m){const C=r.paint.get("model-rotation").constantOr(null),P=r.paint.get("model-scale").constantOr(null),k=r.paint.get("model-translation").constantOr(null);M.computeModelMatrix(t,C,P,k,!0,!0,!1);const z=ge.identity([]),L=Ys(M.position.lat,t.transform.zoom),B=ge.fromScaling([],[1,1,1/L]);ge.translate(z,z,v),_.push({zScaleMatrix:B,negCameraPosMatrix:z});for(const W of M.nodes)pA(t.transform,W,M.matrix,t.transform.projMatrix,T,b,S);T++}if(b.sort((M,C)=>C.depth-M.depth),t.renderPass!=="shadow"){if(a===1)for(const M of S)Mg(M,t,r,_[M.modelIndex],lr.disabled,t.colorModeForRenderPass());else{for(const M of S)Mg(M,t,r,_[M.modelIndex],lr.disabled,Lr.disabled);for(const M of S)Mg(M,t,r,_[M.modelIndex],t.stencilModeFor3D(),t.colorModeForRenderPass());t.resetStencilClippingMasks()}for(const M of b)Mg(M,t,r,_[M.modelIndex],lr.disabled,t.colorModeForRenderPass());d()}else{for(const M of S)Rx(M.mesh,M.nodeModelMatrix,t,r);for(const M of b)Rx(M.mesh,M.nodeModelMatrix,t,r);d()}}},_A={modelUpload:function(t,e,r){const i=e.getSource();if(!i.loaded())return;if(i.type==="vector"||i.type==="geojson")return void(t.modelManager&&t.modelManager.upload(t,r));if(i.type==="batched-model")return;const a=i.getModels();for(const s of a)s.upload(t.context)}};class ij{constructor(e,r,i=!1){this.context=new AB(e,i),this.transform=r,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=na.maxUnderzooming+na.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new GB,this._shadowRenderer=new aN(this),this._wireframeDebugCache=new nj}updateTerrain(e,r){const i=!!e&&!!e.terrain&&this.transform.projection.supportsTerrain;if(!(i||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new hN(this,e));const a=this._terrain;this.transform.elevation=i?a:null,a.update(e,this.transform,r)}_updateFog(e){const r=e.fog;if(!r||this.transform.projection.name==="globe"||r.getOpacity(this.transform.pitch)<1||r.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[i,a]=r.getFovAdjustedRange(this.transform._fov);if(i>a)return void(this.transform.fogCullDistSq=null);const s=i+.78*(a-i);this.transform.fogCullDistSq=s*s}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(e,r){if(this.width=e*Ot.devicePixelRatio,this.height=r*Ot.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const i of this.style.order)this.style._layers[i].resize()}setup(){const e=this.context,r=new Gi;r.emplaceBack(0,0),r.emplaceBack(Ae,0),r.emplaceBack(0,Ae),r.emplaceBack(Ae,Ae),this.tileExtentBuffer=e.createVertexBuffer(r,qs.members),this.tileExtentSegments=Gr.simpleSegment(0,0,4,2);const i=new Gi;i.emplaceBack(0,0),i.emplaceBack(Ae,0),i.emplaceBack(0,Ae),i.emplaceBack(Ae,Ae),this.debugBuffer=e.createVertexBuffer(i,qs.members),this.debugSegments=Gr.simpleSegment(0,0,4,5);const a=new Gi;a.emplaceBack(-1,-1),a.emplaceBack(1,-1),a.emplaceBack(-1,1),a.emplaceBack(1,1),this.viewportBuffer=e.createVertexBuffer(a,qs.members),this.viewportSegments=Gr.simpleSegment(0,0,4,2);const s=new Bs;s.emplaceBack(0,0,0,0),s.emplaceBack(Ae,0,Ae,0),s.emplaceBack(0,Ae,0,Ae),s.emplaceBack(Ae,Ae,Ae,Ae),this.mercatorBoundsBuffer=e.createVertexBuffer(s,Xv.members),this.mercatorBoundsSegments=Gr.simpleSegment(0,0,4,2);const c=new Bn;c.emplaceBack(0,1,2),c.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=e.createIndexBuffer(c);const u=new Td;for(const p of[0,1,3,2,0])u.emplaceBack(p);this.debugIndexBuffer=e.createIndexBuffer(u),this.emptyTexture=new Dn(e,new Sn({width:1,height:1},Uint8Array.of(0,0,0,0)),e.gl.RGBA),this.identityMat=ge.create();const d=this.context.gl;this.stencilClearMode=new lr({func:d.ALWAYS,mask:0},0,255,d.ZERO,d.ZERO,d.ZERO),this.loadTimeStamps.push(w.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(e){return e._makeTileBoundsBuffers(this.context,this.transform.projection),e._tileBoundsBuffer?{tileBoundsBuffer:e._tileBoundsBuffer,tileBoundsIndexBuffer:e._tileBoundsIndexBuffer,tileBoundsSegments:e._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const e=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(this,e.TRIANGLES,Nt.disabled,this.stencilClearMode,Lr.disabled,ur.disabled,Ax(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(e,r,i){if(!r||this.currentStencilSource===r.id||!e.isTileClipped()||!i||i.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let u=!1;for(const d of i)if(this._tileClippingMaskIDs[d.key]===void 0){u=!0;break}if(!u)return}this.currentStencilSource=r.id;const a=this.context,s=a.gl;this.nextStencilID+i.length>256&&this.clearStencil(),a.setColorMode(Lr.disabled),a.setDepthMode(Nt.disabled);const c=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const u of i){const d=r.getTile(u),p=this._tileClippingMaskIDs[u.key]=this.nextStencilID++,{tileBoundsBuffer:m,tileBoundsIndexBuffer:_,tileBoundsSegments:y}=this.getTileBoundsBuffers(d);c.draw(this,s.TRIANGLES,Nt.disabled,new lr({func:s.ALWAYS,mask:0},p,255,s.KEEP,s.KEEP,s.REPLACE),Lr.disabled,ur.disabled,Ax(u.projMatrix),"$clipping",m,_,y)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const e=this.nextStencilID++,r=this.context.gl;return new lr({func:r.NOTEQUAL,mask:255},e,255,r.KEEP,r.KEEP,r.REPLACE)}stencilModeForClipping(e){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(e);const r=this.context.gl;return new lr({func:r.EQUAL,mask:255},this._tileClippingMaskIDs[e.key],0,r.KEEP,r.KEEP,r.REPLACE)}stencilConfigForOverlap(e){const r=this.context.gl,i=e.sort((c,u)=>u.overscaledZ-c.overscaledZ),a=i[i.length-1].overscaledZ,s=i[0].overscaledZ-a+1;if(s>1){this.currentStencilSource=void 0,this.nextStencilID+s>256&&this.clearStencil();const c={};for(let u=0;u<s;u++)c[u+a]=new lr({func:r.GEQUAL,mask:255},u+this.nextStencilID,255,r.KEEP,r.KEEP,r.REPLACE);return this.nextStencilID+=s,[c,i]}return[{[a]:lr.disabled},i]}colorModeForRenderPass(){const e=this.context.gl;return this._showOverdrawInspector?new Lr([e.CONSTANT_COLOR,e.ONE,e.CONSTANT_COLOR,e.ONE],new Zt(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Lr.unblended:Lr.alphaBlended}colorModeForDrapableLayerRenderPass(e){const r=this.context.gl;return(()=>this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.style.map._optimizeForTerrain)()&&this.renderPass==="translucent"?new Lr([r.ONE,r.ONE_MINUS_SRC_ALPHA,r.CONSTANT_ALPHA,r.ONE_MINUS_SRC_ALPHA],new Zt(0,0,0,e===void 0?0:e),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(e,r,i,a=!1){if(!this.opaquePassEnabledForLayer()&&!a)return Nt.disabled;const s=1-((1+this.currentLayer)*this.numSublayers+e)*this.depthEpsilon;return new Nt(i||this.context.gl.LEQUAL,r,[s,s])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(e,r){this._wireframeDebugCache.update(this.frameCounter),this.style=e,this.options=r;const i=this.style._layers,a=this.style.order,s=a.map(T=>i[T]),c=this.style._sourceCaches;this.imageManager=e.imageManager,this.modelManager=e.modelManager,this.symbolFadeChange=e.placement.symbolFadeChange(Ot.now()),this.imageManager.beginFrame();let u=0,d=!1;for(const T in c){const M=c[T];M.used&&(M.prepare(this.context),M.getSource().usedInConflation&&++u)}const p={},m={},_={};for(const T in c){const M=c[T];p[T]=M.getVisibleCoordinates(),m[T]=p[T].slice().reverse(),_[T]=M.getVisibleCoordinates(!0).reverse()}if(u){const T=C=>{const P=this.style._getLayerSourceCache(C);return P&&P.used?P.getSource():null},M=[];for(const C of s)this.layerUsedInConflation(C,T(C))&&M.push(C);if(M&&M.length>1){const C=[];for(const P of M){const k=this.style._getLayerSourceCache(P);k&&k.used&&k.getSource().usedInConflation&&C.push({layer:P.id,cache:k})}this.replacementSource.setSources(C),d=!0}}d||this.replacementSource.clear(),this.conflationActive=d,this.opaquePassCutoff=1/0;for(let T=0;T<s.length;T++)if(s[T].is3D()){this.opaquePassCutoff=T;break}this.terrain&&(this.terrain.updateTileBinding(_),this.opaquePassCutoff=0),this._shadowRenderer&&this._shadowRenderer.updateShadowParameters(this.transform,this.style.directionalLight),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new HO(this.context));for(const T of s){if(T.isHidden(this.transform.zoom))continue;const M=e._getLayerSourceCache(T);this.uploadLayer(this,T,M)}if(this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new KN),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),!io.has(this.context.gl))return;this.renderPass="offscreen";for(const T of s){const M=e._getLayerSourceCache(T);if(!T.hasOffscreenPass()||T.isHidden(this.transform.zoom))continue;const C=M?m[M.id]:void 0;(T.type==="custom"||T.isSky()||C&&C.length)&&this.renderLayer(this,M,T,C)}this.depthRangeFor3D=[0,1-(s.length+2)*this.numSublayers*this.depthEpsilon];const y=this.terrain;y&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&y.drawDepth(),this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,m)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const v=(()=>{if(r.showOverdrawInspector)return Zt.black;if(this.style.fog&&this.transform.projection.supportsFog){const T=this.style.fog.properties.get("space-color").toArray01();return new Zt(...T)}return Zt.transparent})();if(this.context.clear({color:v,depth:1}),this.clearStencil(),this._showOverdrawInspector=r.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=a.length-1;this.currentLayer>=0;this.currentLayer--){const T=s[this.currentLayer],M=e._getLayerSourceCache(T);if(T.isSky())continue;const C=M?m[M.id]:void 0;this._renderTileClippingMasks(T,M,C),this.renderLayer(this,M,T,C)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||Qn(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<a.length;this.currentLayer++){const T=s[this.currentLayer],M=e._getLayerSourceCache(T);T.isSky()&&this.renderLayer(this,M,T,M?m[M.id]:void 0)}this.renderPass="translucent",this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let b=0;const S=this.shadowRenderer;for(S&&(b=S.getShadowCastingLayerCount());this.currentLayer<a.length;){const T=s[this.currentLayer],M=e._getLayerSourceCache(T);if(T.isSky()){++this.currentLayer;continue}if(y&&this.style.isLayerDraped(T)){if(T.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=y.renderBatch(this.currentLayer);continue}const C=M?(T.type==="symbol"?_:m)[M.id]:void 0;if(this._renderTileClippingMasks(T,M,M?p[M.id]:void 0),this.renderLayer(this,M,T,C),!y&&S&&b>0&&T.hasShadowPass()&&--b==0&&(S.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer)){const P=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=P;this.currentLayer++){const k=s[this.currentLayer];if(!k.hasLightBeamPass())continue;const z=e._getLayerSourceCache(k);this.renderLayer(this,z,k,z?m[z.id]:void 0)}this.currentLayer=P,this.renderPass="translucent"}++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let T=null;s.forEach(M=>{const C=e._getLayerSourceCache(M);C&&!M.isHidden(this.transform.zoom)&&(!T||T.getSource().maxzoom<C.getSource().maxzoom)&&(T=C)}),T&&this.options.showTileBoundaries&&gA.debug(this,T,T.getVisibleCoordinates())}this.options.showPadding&&function(T){const M=T.transform.padding;uA(T,T.transform.height-(M.top||0),3,jN),uA(T,M.bottom||0,3,$N),hA(T,M.left||0,3,VN),hA(T,T.transform.width-(M.right||0),3,UN);const C=T.transform.centerPoint;(function(P,k,z,L){Tg(P,k-1,z-10,2,20,L),Tg(P,k-10,z-1,20,2,L)})(T,C.x,T.transform.height-C.y,GN)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(w.performance.now()),this.saveCanvasCopy()),d||(this.conflationActive=!1)}uploadLayer(e,r,i){this.gpuTimingStart(r),(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes(r.type)||e.terrain&&r.type==="custom")&&_A[`${r.type}Upload`]&&_A[`${r.type}Upload`](e,i,r.scope),this.gpuTimingEnd()}renderLayer(e,r,i,a){i.isHidden(this.transform.zoom)||(i.type==="background"||i.type==="sky"||i.type==="custom"||i.type==="model"||a&&a.length)&&(this.id=i.id,this.gpuTimingStart(i),(!e.transform.projection.unsupportedLayers||!e.transform.projection.unsupportedLayers.includes(i.type)||e.terrain&&i.type==="custom")&&gA[i.type](e,r,i,a,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(e){if(!this.options.gpuTiming)return;const r=this.context.extTimerQuery;let i=this.gpuTimers[e.id];i||(i=this.gpuTimers[e.id]={calls:0,cpuTime:0,query:r.createQueryEXT()}),i.calls++,r.beginQueryEXT(r.TIME_ELAPSED_EXT,i.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const e=this.context.extTimerQuery,r=e.createQueryEXT();this.deferredRenderGpuTimeQueries.push(r),e.beginQueryEXT(e.TIME_ELAPSED_EXT,r)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const e=this.context.extTimerQuery;e.endQueryEXT(e.TIME_ELAPSED_EXT)}collectGpuTimers(){const e=this.gpuTimers;return this.gpuTimers={},e}collectDeferredRenderGpuQueries(){const e=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],e}queryGpuTimers(e){const r={};for(const i in e){const a=e[i],s=this.context.extTimerQuery,c=s.getQueryObjectEXT(a.query,s.QUERY_RESULT_EXT)/1e6;s.deleteQueryEXT(a.query),r[i]=c}return r}queryGpuTimeDeferredRender(e){if(!this.options.gpuTimingDeferredRender)return 0;const r=this.context.extTimerQuery;let i=0;for(const a of e)i+=r.getQueryObjectEXT(a,r.QUERY_RESULT_EXT)/1e6,r.deleteQueryEXT(a);return i}translatePosMatrix(e,r,i,a,s){if(!i[0]&&!i[1])return e;const c=s?a==="map"?this.transform.angle:0:a==="viewport"?-this.transform.angle:0;if(c){const p=Math.sin(c),m=Math.cos(c);i=[i[0]*m-i[1]*p,i[0]*p+i[1]*m]}const u=[s?i[0]:oc(r,i[0],this.transform.zoom),s?i[1]:oc(r,i[1],this.transform.zoom),0],d=new Float32Array(16);return ge.translate(d,e,u),d}saveTileTexture(e){const r=this._tileTextures[e.size[0]];r?r.push(e):this._tileTextures[e.size[0]]=[e]}getTileTexture(e){const r=this._tileTextures[e];return r&&r.length>0?r.pop():null}isPatternMissing(e,r){return e===null||e!==void 0&&!this.imageManager.getPattern(e.toString(),r)}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(e){const r=this.terrain&&this.terrain.renderingToTexture,i=this.terrain&&this.terrain.exaggeration()===0,a=this.style&&this.style.fog,s=[];return this.style&&this.style.enable3dLights()&&(e==="globeRaster"||e==="terrainRaster"?this.style.map._optimizeForTerrain&&(s.push("LIGHTING_3D_MODE"),s.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):r&&this.style.map._optimizeForTerrain||s.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"?this._shadowMapDebug||s.push("DEPTH_TEXTURE"):this.shadowRenderer&&(this.shadowRenderer.useNormalOffset?s.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"):s.push("RENDER_SHADOWS","DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&s.push("TERRAIN"),this.transform.projection.name==="globe"&&s.push("GLOBE"),i&&s.push("ZERO_EXAGGERATION"),a&&!r&&a.getOpacity(this.transform.pitch)!==0&&s.push("FOG","FOG_DITHERING"),r&&s.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&s.push("OVERDRAW_INSPECTOR"),s}useProgram(e,r,i){this.cache=this.cache||{};const a=i||[],s=this.currentGlobalDefines(e).concat(a),c=H5.cacheKey(O5[e],e,s,r);return this.cache[c]||(this.cache[c]=new H5(this.context,e,O5[e],r,LN[e],s)),this.cache[c]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const e=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(e.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=w.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new Dn(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(e,r){if(this.style.enable3dLights()){const i=this.style.directionalLight,a=this.style.ambientLight;if(i&&a){const s=((c,u)=>{const d=c.properties.get("direction"),p=c.properties.get("color").toArray01(),m=c.properties.get("intensity"),_=u.properties.get("color").toArray01(),y=u.properties.get("intensity"),v=[d.x,d.y,d.z],b=Yr(_,y),S=Yr(p,m);return{u_lighting_ambient_color:b,u_lighting_directional_dir:v,u_lighting_directional_color:S,u_ground_radiance:dN(v,S,b)}})(i,a);r.setLightsUniformValues(e,s)}}}uploadCommonUniforms(e,r,i,a){if(this.uploadCommonLightUniforms(e,r),this.terrain&&this.terrain.renderingToTexture)return;const s=this.style.fog;if(s){const c=s.getOpacity(this.transform.pitch),u=((d,p,m,_,y,v,b,S,T,M,C,P)=>{const k=d.transform,z=p.properties.get("color").toArray01();z[3]=_;const L=d.frameCounter/1e3%1;return{u_fog_matrix:m?k.calculateFogTileMatrix(m):P||d.identityMat,u_fog_range:p.getFovAdjustedRange(k._fov),u_fog_color:z,u_fog_horizon_blend:p.properties.get("horizon-blend"),u_fog_temporal_offset:L,u_frustum_tl:y,u_frustum_tr:v,u_frustum_br:b,u_frustum_bl:S,u_globe_pos:T,u_globe_radius:M,u_viewport:C,u_globe_transition:Qn(k.zoom),u_is_globe:+(k.projection.name==="globe")}})(this,s,i,c,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*Ot.devicePixelRatio,this.transform.height*Ot.devicePixelRatio],a);r.setFogUniformValues(e,u)}}setTileLoadedFlag(e){this.tileLoaded=e}saveCanvasCopy(){const e=this.canvasCopy();e&&(this.frameCopies.push(e),this.tileLoaded=!1)}canvasCopy(){const e=this.context.gl,r=e.createTexture();return e.bindTexture(e.TEXTURE_2D,r),e.copyTexImage2D(e.TEXTURE_2D,0,e.RGBA,0,0,e.drawingBufferWidth,e.drawingBufferHeight,0),r}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const e=this.style&&this.style.fog;return!!e&&e.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const e=this._backgroundTiles,r=this._backgroundTiles={},i=this.transform.coveringTiles({tileSize:512});for(const a of i)r[a.key]=e[a.key]||new Wd(a,512,this.transform.tileZoom,this);return r}clearBackgroundTiles(){this._backgroundTiles={}}layerUsedInConflation(e,r){return!(!e.is3D()||e.minzoom&&e.minzoom>this.transform.zoom||e.sourceLayer!=="building"&&(!r||r.type!=="batched-model"))}}class oj extends dr{constructor(e){super(),this.requestManager=e,this.models={"":{}},this.loaded={}}async loadModel(e,r){const i=hx(await s5(r)),a=new fC(e,r,void 0,void 0,i);return a.computeBoundsAndApplyParent(),a}async load(e,r){this.models[r]||(this.models[r]={}),this.loaded[r]=!1;for(const i in e){const a=e[i],s=await this.loadModel(i,a);this.models[r][i]=s}this.loaded[r]=!0,this.fire(new Ee("data",{dataType:"style"}))}isLoaded(){for(const e in this.loaded)if(!this.loaded[e])return!1;return!0}hasModel(e,r){return!!this.getModel(e,r)}getModel(e,r){return this.models[r]||(this.models[r]={}),this.models[r][e]}async addModel(e,r,i){this.models[i]||(this.models[i]={}),this.hasModel(e,i)&&this.removeModel(e,i),this.load({[e]:this.requestManager.normalizeModelURL(r)},i)}addModels(e,r){const i={};for(const a in e)i[a]=this.requestManager.normalizeModelURL(e[a]);this.load(i,r)}removeModel(e,r){this.models[r]||(this.models[r]={});const i=this.models[r][e];delete this.models[r][e],i.destroy()}listModels(e){return this.models[e]||(this.models[e]={}),Object.keys(this.models[e])}upload(e,r){this.models[r]||(this.models[r]={});for(const i in this.models[r])this.models[r][i].upload(e.context)}}const sf=(t,e)=>om(t,e&&e.filter(r=>r.identifier!=="source.canvas")),aj=qt(Hr,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection","setCamera"]),sj=qt(Hr,["setCenter","setZoom","setBearing","setPitch"]),yA={version:8,layers:[],sources:{}},lj={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class oa extends dr{constructor(e,r={}){super(),this.map=e,this.imports=[],this.scope=r.scope||"",this.importDepth=r.importDepth||0,this.importsCache=r.importsCache||new Map,this.resolvedImports=r.resolvedImports||new Set,this.parentCamera=r.camera,this._ownOrder=[],this._ownLayers={},this._ownSourceCaches={},this.dispatcher=r.dispatcher?r.dispatcher:new ac(rf(),this),r.imageManager?this.imageManager=r.imageManager:(this.imageManager=new c9,this.imageManager.setEventedParent(this)),this.imageManager.createScope(this.scope),this.glyphManager=r.glyphManager?r.glyphManager:new Pu(e._requestManager,r.localFontFamily?2:r.localIdeographFontFamily?1:0,r.localFontFamily||r.localIdeographFontFamily),r.modelManager?this.modelManager=r.modelManager:(this.modelManager=new oj(e._requestManager),this.modelManager.setEventedParent(this)),this.crossTileSymbolIndex=new tN,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this.options=r.config||new Map,this._configDependentLayers=new Set,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",De());const i=this;this._rtlTextPluginCallback=oa.registerForPluginStateChange(a=>{i.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:a.pluginStatus,pluginURL:a.pluginURL},(s,c)=>{if(IS(s),c&&c.every(u=>u))for(const u in i._sourceCaches){const d=i._sourceCaches[u],p=d.getSource().type;p!=="vector"&&p!=="geojson"||d.reload()}})}),this.on("data",a=>{if(a.dataType!=="source"||a.sourceDataType!=="metadata")return;const s=this.getSource(a.sourceId);if(s&&s.vectorLayerIds)for(const c in this._layers){const u=this._layers[c];u.source===s.id&&this._validateLayer(u)}})}loadURL(e,r={}){this.fire(new Ee("dataloading",{dataType:"style"}));const i=typeof r.validate=="boolean"?r.validate:!wr(e);e=this.map._requestManager.normalizeStyleURL(e,r.accessToken),this.resolvedImports.add(e);const a=this.importsCache.get(e);if(a)return this._load(a,i);const s=this.map._requestManager.transformRequest(e,be.Style);this._request=qe(s,(c,u)=>{if(this._request=null,c)this.fire(new rt(c));else if(u)return this.importsCache.set(e,u),this._load(u,i)})}loadJSON(e,r={}){this.fire(new Ee("dataloading",{dataType:"style"})),this._request=Ot.frame(()=>{this._request=null,this._load(e,r.validate!==!1)})}loadEmpty(){this.fire(new Ee("dataloading",{dataType:"style"})),this._load(yA,!1)}_updateLayerCount(e,r){const i=r?1:-1;e.is3D()&&(this._num3DLayers+=i),e.type==="circle"&&(this._numCircleLayers+=i),e.type==="symbol"&&(this._numSymbolLayers+=i)}_loadImports(e,r){const i=()=>{this._mergeLayers(),this._mergeSources();for(const{style:s,id:c}of this.imports){for(const[u,d]of s.options.entries())this.options.set($u(u,c),d);s.stylesheet.camera!=null&&(this.stylesheet.camera=s.stylesheet.camera),s.stylesheet.projection!=null&&(this.stylesheet.projection=s.stylesheet.projection),s.stylesheet.light!=null&&(this.light=s.light),s.ambientLight!=null&&(this.ambientLight=s.ambientLight),s.directionalLight!=null&&(this.directionalLight=s.directionalLight),s.terrain!=null&&(this.terrain=s.terrain),s.fog!=null&&(this.fog=s.fog)}this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._ownOrder),scope:this.scope,options:this.options}),this.fire(new Ee("data",{dataType:"style"})),this.fire(new Ee("style.load"))};if(this.importDepth>=4)return re("Style doesn't support nesting deeper than 5"),i();const a=[];for(const s of e){const c=this.scope?$u(s.id,this.scope):s.id,u=new Map,d=s.config;if(d)for(const y of Object.keys(d)){const v=Ls(d[y]);v.result==="success"&&u.set(y,v.value.expression)}const p=new oa(this.map,{scope:c,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,camera:this.stylesheet.camera,config:u});p.setEventedParent(this.map,{style:p});const m=new Promise(y=>p.on("style.load",y));if(a.push(m),this.resolvedImports.has(s.url)){p.loadEmpty();continue}const _=s.data||this.importsCache.get(s.url);_?p.loadJSON(_,{validate:r}):s.url?p.loadURL(s.url,{validate:r}):p.loadEmpty(),this.imports.push({id:s.id,style:p,config:s.config})}Promise.all(a).then(i)}_load(e,r){const i=e.schema;if(this.importDepth===0&&(e.fragment||i)){const u=Oe({},yA,{imports:[{id:"basemap",data:e,url:""}]});return void this._load(u,r)}if(i)for(const u of Object.keys(i)){if(this.options.has(u))continue;const d=Ls(i[u].default);d.result==="success"&&this.options.set(u,d.value.expression)}if(r&&sf(this,lu(e)))return;this._loaded=!0,this.stylesheet=Y(e),this._updateMapProjection();for(const u in e.sources){const d=$u(u,this.scope);this.addSource(d,e.sources[u],{validate:!1})}this._changed=!1,e.sprite?this._loadSprite(e.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.glyphManager.setURL(e.glyphs,this.scope);const a=u5(this.stylesheet.layers);this._ownOrder=a.map(u=>$u(u.id,this.scope)),this._ownLayers={},this._serializedLayers={};for(const u of a){const d=_g(u,this.options);d.id=$u(d.id,this.scope),d.scope=this.scope,d.isConfigDependent&&this._configDependentLayers.add(d.id),d.source&&(d.source=$u(d.source,this.scope)),d.setEventedParent(this,{layer:{id:d.id}}),this._layers[d.id]=d,this._ownLayers[d.id]=d,this._serializedLayers[d.id]=d.serialize(),this._updateLayerCount(d,!0)}if(this.stylesheet.light&&console.log("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const u=this.stylesheet.lights[0];this.light=new UC(u.properties,u.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new UC(this.stylesheet.light)),this.stylesheet.models&&this.modelManager.addModels(this.stylesheet.models,this.scope);const s=this.stylesheet.terrain;s&&!this.terrainSetForDrapingOnly()&&this._createTerrain(s,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog);const c=this.stylesheet.camera=this.stylesheet.camera||this.parentCamera||{"camera-projection":"perspective"};this.map.setCamera(c),this._mergeLayers(),this._mergeSources(),this.fire(new Ee("data",{dataType:"style"})),e.imports?this._loadImports(e.imports,r):(this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._ownOrder),scope:this.scope,options:this.options}),this.fire(new Ee("style.load")))}_mergeSources(){const e={},r={},i={};(function a(s){for(const c of s.imports)a(c.style);for(const c in s._sourceCaches)e[c]=s._sourceCaches[c];for(const c in s._otherSourceCaches)r[c]=s._otherSourceCaches[c];for(const c in s._symbolSourceCaches)i[c]=s._symbolSourceCaches[c]})(this),this._sourceCaches=e,this._otherSourceCaches=r,this._symbolSourceCaches=i}_mergeLayers(){const e={},r=[],i={};(function s(c){for(const u of c.imports)s(u.style);for(const u of c._ownOrder){const d=c._ownLayers[u];if(d.type==="slot"){const p=w5(u);if(e[p])continue;e[p]=[]}d.slot&&e[d.slot]?e[d.slot].push(d):r.push(d)}})(this),this._order=[];const a=(s=[])=>{for(const c of s)if(c.type==="slot"){const u=w5(c.id);e[u]&&a(e[u])}else this._order.push(c.id),i[c.id]=c};a(r),this._layers=i,this._updateDrapeFirstLayers()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(e){e?this.stylesheet.projection=e:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(e){this._spriteRequest=function(r,i,a){let s,c,u;const d=Ot.devicePixelRatio>1?"@2x":"";let p=qe(i.transformRequest(i.normalizeSpriteURL(r,d,".json"),be.SpriteJSON),(y,v)=>{p=null,u||(u=y,s=v,_())}),m=rr(i.transformRequest(i.normalizeSpriteURL(r,d,".png"),be.SpriteImage),(y,v)=>{m=null,u||(u=y,c=v,_())});function _(){if(u)a(u);else if(s&&c){const y=Ot.getImageData(c),v={};for(const b in s){const{width:S,height:T,x:M,y:C,sdf:P,pixelRatio:k,stretchX:z,stretchY:L,content:B}=s[b],W=new Sn({width:S,height:T});Sn.copy(y,W,{x:M,y:C},{x:0,y:0},{width:S,height:T}),v[b]={data:W,pixelRatio:k,sdf:P,stretchX:z,stretchY:L,content:B}}a(null,v)}}return{cancel(){p&&(p.cancel(),p=null),m&&(m.cancel(),m=null)}}}(e,this.map._requestManager,(r,i)=>{if(this._spriteRequest=null,r)this.fire(new rt(r));else if(i)for(const a in i)this.imageManager.addImage(a,this.scope,i[a]);this.imageManager.setLoaded(!0,this.scope),this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new Ee("data",{dataType:"style"}))})}_validateLayer(e){const r=this.getSource(e.source);if(!r)return;const i=e.sourceLayer;i&&(r.type==="geojson"||r.vectorLayerIds&&r.vectorLayerIds.indexOf(i)===-1)&&this.fire(new rt(new Error(`Source layer "${i}" does not exist on source "${r.id}" as specified by style layer "${e.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const e in this._sourceCaches)if(!this._sourceCaches[e].loaded())return!1;if(!this.imageManager.isLoaded()||this.stylesheet.models&&!this.modelManager.isLoaded())return!1;for(const{style:e}of this.imports)if(!e.loaded())return!1;return!0}_serializeLayers(e){const r=[];for(const i of e){const a=this._layers[i];a&&a.type!=="custom"&&r.push(a.serialize())}return r}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const e in this._sourceCaches)if(this._sourceCaches[e].hasTransition())return!0;for(const e in this._layers)if(this._layers[e].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(e){return!!this.terrain&&(typeof e.isLayerDraped=="function"?e.isLayerDraped():lj[e.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(e){if(!this._loaded)return;e.brightness!==this._brightness&&(this._brightness=e.brightness,this.dispatcher.broadcast("setBrightness",e.brightness));const r=this._changed;if(this._changed){const a=Object.keys(this._updatedLayers),s=Object.keys(this._removedLayers);if(a.length||s.length){const c={};for(const u of a){const d=E5(u);(c[d]=c[d]||{updatedIds:[],removedIds:[]}).updatedIds.push(u)}for(const u of s){const d=E5(u);(c[d]=c[d]||{updatedIds:[],removedIds:[]}).removedIds.push(u)}for(const[u,{updatedIds:d,removedIds:p}]of Object.entries(c))this.getFragmentById(u)._updateWorkerLayers(d,p)}for(const c in this._updatedSources){const u=this._updatedSources[c];u==="reload"?this._reloadSource(c):u==="clear"&&this._clearSource(c)}this._updateTilesForChangedImages();for(const c in this._updatedPaintProps)this._layers[c].updateTransitions(e);this.light.updateTransitions(e),this.fog&&this.fog.updateTransitions(e),this._resetUpdates()}const i={};for(const a in this._sourceCaches){const s=this._sourceCaches[a];i[a]=s.used,s.used=!1}for(const a of this._order){const s=this._layers[a];if(s.recalculate(e,this._availableImages),!s.isHidden(e.zoom)){const u=this._getLayerSourceCache(s);u&&(u.used=!0)}const c=this.map.painter;if(c){const u=s.getProgramIds();if(!u)continue;const d=s.getProgramConfiguration(e.zoom);for(const p of u)c.useProgram(p,d)}}for(const a in i){const s=this._sourceCaches[a];i[a]!==s.used&&s.getSource().fire(new Ee("data",{sourceDataType:"visibility",dataType:"source",sourceId:s.getSource().id}))}this.light.recalculate(e),this.terrain&&this.terrain.recalculate(e),this.fog&&this.fog.recalculate(e),this.z=e.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),r&&this.fire(new Ee("data",{dataType:"style"}))}_updateTilesForChangedImages(){const e=Object.keys(this._changedImages);if(e.length){for(const r in this._sourceCaches)this._sourceCaches[r].reloadTilesForDependencies(["icons","patterns"],e);this._changedImages={}}}_updateWorkerLayers(e,r){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(e),scope:this.scope,removedIds:r,options:this.options})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(e){if(this._checkLoaded(),sf(this,lu(e)))return!1;(e=Y(e)).layers=u5(e.layers);const r=function(a,s){if(!a)return[{command:Hr.setStyle,args:[s]}];let c=[];try{if(!ue(a.version,s.version))return[{command:Hr.setStyle,args:[s]}];ue(a.center,s.center)||c.push({command:Hr.setCenter,args:[s.center]}),ue(a.zoom,s.zoom)||c.push({command:Hr.setZoom,args:[s.zoom]}),ue(a.bearing,s.bearing)||c.push({command:Hr.setBearing,args:[s.bearing]}),ue(a.pitch,s.pitch)||c.push({command:Hr.setPitch,args:[s.pitch]}),ue(a.sprite,s.sprite)||c.push({command:Hr.setSprite,args:[s.sprite]}),ue(a.glyphs,s.glyphs)||c.push({command:Hr.setGlyphs,args:[s.glyphs]}),ue(a.transition,s.transition)||c.push({command:Hr.setTransition,args:[s.transition]}),ue(a.light,s.light)||c.push({command:Hr.setLight,args:[s.light]}),ue(a.fog,s.fog)||c.push({command:Hr.setFog,args:[s.fog]}),ue(a.projection,s.projection)||c.push({command:Hr.setProjection,args:[s.projection]}),ue(a.lights,s.lights)||c.push({command:Hr.setLights,args:[s.lights]}),ue(a.camera,s.camera)||c.push({command:Hr.setCamera,args:[s.camera]});const u={},d=[];(function(_,y,v,b){let S;for(S in y=y||{},_=_||{})_.hasOwnProperty(S)&&(y.hasOwnProperty(S)||d5(S,v,b));for(S in y){if(!y.hasOwnProperty(S))continue;const T=y[S];_.hasOwnProperty(S)?ue(_[S],T)||(_[S].type==="geojson"&&T.type==="geojson"&&L9(_,y,S)?v.push({command:Hr.setGeoJSONSourceData,args:[S,T.data]}):D9(S,y,v,b)):h5(S,y,v)}})(a.sources,s.sources,d,u);const p=[];a.layers&&a.layers.forEach(_=>{_.source&&u[_.source]?c.push({command:Hr.removeLayer,args:[_.id]}):p.push(_)});let m=a.terrain;m&&u[m.source]&&(c.push({command:Hr.setTerrain,args:[void 0]}),m=void 0),c=c.concat(d),ue(m,s.terrain)||c.push({command:Hr.setTerrain,args:[s.terrain]}),function(_,y,v){y=y||[];const b=(_=_||[]).map(f5),S=y.map(f5),T=_.reduce(p5,{}),M=y.reduce(p5,{}),C=b.slice(),P=Object.create(null);let k,z,L,B,W,Z,X;for(k=0,z=0;k<b.length;k++)L=b[k],M.hasOwnProperty(L)?z++:(v.push({command:Hr.removeLayer,args:[L]}),C.splice(C.indexOf(L,z),1));for(k=0,z=0;k<S.length;k++)L=S[S.length-1-k],C[C.length-1-k]!==L&&(T.hasOwnProperty(L)?(v.push({command:Hr.removeLayer,args:[L]}),C.splice(C.lastIndexOf(L,C.length-z),1)):z++,Z=C[C.length-k],v.push({command:Hr.addLayer,args:[M[L],Z]}),C.splice(C.length-k,0,L),P[L]=!0);for(k=0;k<S.length;k++)if(L=S[k],B=T[L],W=M[L],!P[L]&&!ue(B,W))if(ue(B.source,W.source)&&ue(B["source-layer"],W["source-layer"])&&ue(B.type,W.type)){for(X in vg(B.layout,W.layout,v,L,null,Hr.setLayoutProperty),vg(B.paint,W.paint,v,L,null,Hr.setPaintProperty),ue(B.filter,W.filter)||v.push({command:Hr.setFilter,args:[L,W.filter]}),ue(B.minzoom,W.minzoom)&&ue(B.maxzoom,W.maxzoom)||v.push({command:Hr.setLayerZoomRange,args:[L,W.minzoom,W.maxzoom]}),B)B.hasOwnProperty(X)&&X!=="layout"&&X!=="paint"&&X!=="filter"&&X!=="metadata"&&X!=="minzoom"&&X!=="maxzoom"&&(X.indexOf("paint.")===0?vg(B[X],W[X],v,L,X.slice(6),Hr.setPaintProperty):ue(B[X],W[X])||v.push({command:Hr.setLayerProperty,args:[L,X,W[X]]}));for(X in W)W.hasOwnProperty(X)&&!B.hasOwnProperty(X)&&X!=="layout"&&X!=="paint"&&X!=="filter"&&X!=="metadata"&&X!=="minzoom"&&X!=="maxzoom"&&(X.indexOf("paint.")===0?vg(B[X],W[X],v,L,X.slice(6),Hr.setPaintProperty):ue(B[X],W[X])||v.push({command:Hr.setLayerProperty,args:[L,X,W[X]]}))}else v.push({command:Hr.removeLayer,args:[L]}),Z=C[C.lastIndexOf(L)+1],v.push({command:Hr.addLayer,args:[W,Z]})}(p,s.layers,c)}catch(u){console.warn("Unable to compute style diff:",u),c=[{command:Hr.setStyle,args:[s]}]}return c}(this.serialize(),e).filter(a=>!(a.command in sj));if(r.length===0)return!1;const i=r.filter(a=>!(a.command in aj));if(i.length>0)throw new Error(`Unimplemented: ${i.map(a=>a.command).join(", ")}.`);return r.forEach(a=>{a.command!=="setTransition"&&a.command!=="setProjection"&&this[a.command].apply(this,a.args)}),this.stylesheet=e,this._updateMapProjection(),!0}addImage(e,r){return this.getImage(e)?this.fire(new rt(new Error("An image with this name already exists."))):(this.imageManager.addImage(e,this.scope,r),this._afterImageUpdated(e),this)}updateImage(e,r){this.imageManager.updateImage(e,this.scope,r)}getImage(e){return this.imageManager.getImage(e,this.scope)}removeImage(e){return this.getImage(e)?(this.imageManager.removeImage(e,this.scope),this._afterImageUpdated(e),this):this.fire(new rt(new Error("No image with this name exists.")))}_afterImageUpdated(e){this._availableImages=this.imageManager.listImages(this.scope),this._changedImages[e]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages}),this.fire(new Ee("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModel(e,r,i={}){return this._checkLoaded(),this._validate(KL,`models.${e}`,r,null,i)||(this.modelManager.addModel(e,r,this.scope),this._changed=!0),this}hasModel(e){return this.modelManager.hasModel(e,this.scope)}removeModel(e){return this.hasModel(e)?(this.modelManager.removeModel(e,this.scope),this):this.fire(new rt(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(e,r,i={}){if(this._checkLoaded(),this.getSource(e)!==void 0)throw new Error("There is already a source with this ID");if(!r.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(r).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(r.type)>=0&&this._validate(UL,`sources.${e}`,r,null,i))return;this.map&&this.map._collectResourceTiming&&(r.collectResourceTiming=!0);const a=gx(e,r,this.dispatcher,this);a.scope=this.scope,a.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(e),source:a.serialize(),sourceId:e}));const s=c=>{const u=(c?"symbol:":"other:")+e,d=this._ownSourceCaches[e]=this._sourceCaches[u]=new na(u,a,c);(c?this._symbolSourceCaches:this._otherSourceCaches)[e]=d,d.style=this,d.onAdd(this.map)};s(!1),r.type!=="vector"&&r.type!=="geojson"||s(!0),a.onAdd&&a.onAdd(this.map),this._changed=!0}removeSource(e){this._checkLoaded();const r=this.getSource(e);if(!r)throw new Error("There is no source with this ID");for(const a in this._layers)if(this._layers[a].source===e)return this.fire(new rt(new Error(`Source "${e}" cannot be removed while layer "${a}" is using it.`)));if(this.terrain&&this.terrain.get().source===e)return this.fire(new rt(new Error(`Source "${e}" cannot be removed while terrain is using it.`)));const i=this._getSourceCaches(e);for(const a of i)delete this._sourceCaches[a.id],delete this._updatedSources[a.id],a.fire(new Ee("data",{sourceDataType:"metadata",dataType:"source",sourceId:a.getSource().id})),a.setEventedParent(null),a.clearTiles();return delete this._otherSourceCaches[e],delete this._symbolSourceCaches[e],r.setEventedParent(null),r.onRemove&&r.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(e,r){this._checkLoaded(),this.getSource(e).setData(r),this._changed=!0}getSource(e){const r=this._getSourceCache(e);return r&&r.getSource()}getOwnSource(e){const r=this._getOwnSourceCache(e);return r&&r.getSource()}_getSources(){const e=[];for(const r in this._otherSourceCaches){const i=this._getSourceCache(r);i&&e.push(i.getSource())}return e}setLights(e){if(this._checkLoaded(),delete this.ambientLight,delete this.directionalLight,e){for(const i of e){if(this._validate(WL,"lights",i))return;const a=this._getTransitionParameters({duration:0});switch(i.type){case"ambient":this.ambientLight=new qC(i,_9,this.options),this.ambientLight.updateTransitions(a);break;case"directional":this.directionalLight=new qC(i,y9,this.options),this.directionalLight.updateTransitions(a)}}const r=new mn(this.z||0,{now:Ot.now(),transition:this.getTransition()});this.ambientLight&&this.ambientLight.recalculate(r),this.directionalLight&&this.directionalLight.recalculate(r),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}}calculateLightsBrightness(){const e=this.directionalLight,r=this.ambientLight;if(!e||!r)return;const i=_=>.2126*(_[0]<=.03928?_[0]/12.92:Math.pow((_[0]+.055)/1.055,2.4))+.7152*(_[1]<=.03928?_[1]/12.92:Math.pow((_[1]+.055)/1.055,2.4))+.0722*(_[2]<=.03928?_[2]/12.92:Math.pow((_[2]+.055)/1.055,2.4)),a=e.properties.get("color").toArray01(),s=e.properties.get("intensity"),c=e.properties.get("direction"),u=1-tt(c.x,c.y,c.z)[2]/90,d=i(a)*s*u,p=r.properties.get("color").toArray01(),m=r.properties.get("intensity");return(d+i(p)*m)/2}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const e=[];return this.directionalLight&&e.push(this.directionalLight.get()),this.ambientLight&&e.push(this.ambientLight.get()),e}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentById(e){if(!e)return this;const r=this.imports.find(({id:i})=>i===e);if(!r)throw new Error(`Style import not found: ${e}`);return r.style}setConfigProperty(e,r,i){const a=Ls(i);if(a.result==="success"){const s=a.value.expression,c=this.getFragmentById(e);c.options.set(r,s);for(const u of c._configDependentLayers){const d=this.getLayer(u);d&&this._updateLayer(d)}this._changed=!0}else sf(this,a.value)}addLayer(e,r,i={}){this._checkLoaded();const a=e.id;if(this._ownLayers[a])return void this.fire(new rt(new Error(`Layer with id "${a}" already exists on this map`)));let s;if(e.type==="custom"){if(sf(this,function(d){const p=[],m=d.id;return m===void 0&&p.push({message:`layers.${m}: missing required property "id"`}),d.render===void 0&&p.push({message:`layers.${m}: missing required method "render"`}),d.renderingMode&&d.renderingMode!=="2d"&&d.renderingMode!=="3d"&&p.push({message:`layers.${m}: property "renderingMode" must be either "2d" or "3d"`}),p}(e)))return;s=_g(e,this.options)}else{if(typeof e.source=="object"&&(this.addSource(a,e.source),e=Oe(e=Y(e),{source:a})),this._validate(ZL,`layers.${a}`,e,{arrayIndex:-1},i))return;s=_g(e,this.options),this._validateLayer(s),s.setEventedParent(this,{layer:{id:a}}),this._serializedLayers[s.id]=s.serialize(),this._updateLayerCount(s,!0)}s.isConfigDependent&&this._configDependentLayers.add(s.id);const c=r?this._ownOrder.indexOf(r):this._ownOrder.length;if(r&&c===-1)return void this.fire(new rt(new Error(`Layer with id "${r}" does not exist on this map.`)));this._ownOrder.splice(c,0,a),this._layerOrderChanged=!0,this._ownLayers[a]=s;const u=this._getLayerSourceCache(s);if(this._removedLayers[a]&&s.source&&u&&s.type!=="custom"){const d=this._removedLayers[a];delete this._removedLayers[a],d.type!==s.type?this._updatedSources[s.source]="clear":(this._updatedSources[s.source]="reload",u.pause())}this._updateLayer(s),s.onAdd&&s.onAdd(this.map),this._mergeLayers()}moveLayer(e,r){if(this._checkLoaded(),this._changed=!0,!this._ownLayers[e])return void this.fire(new rt(new Error(`The layer '${e}' does not exist in the map's style and cannot be moved.`)));if(e===r)return;const i=this._ownOrder.indexOf(e);this._ownOrder.splice(i,1);const a=r?this._ownOrder.indexOf(r):this._ownOrder.length;r&&a===-1?this.fire(new rt(new Error(`Layer with id "${r}" does not exist on this map.`))):(this._ownOrder.splice(a,0,e),this._layerOrderChanged=!0,this._mergeLayers())}removeLayer(e){this._checkLoaded();const r=this._ownLayers[e];if(!r)return void this.fire(new rt(new Error(`The layer '${e}' does not exist in the map's style and cannot be removed.`)));r.setEventedParent(null),this._updateLayerCount(r,!1);const i=this._ownOrder.indexOf(e);this._ownOrder.splice(i,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[e]=r,delete this._ownLayers[e],delete this._serializedLayers[e],delete this._updatedLayers[e],delete this._updatedPaintProps[e],this._configDependentLayers.delete(e),r.onRemove&&r.onRemove(this.map),this._mergeLayers()}getLayer(e){return this._layers[e]}getOwnLayer(e){return this._ownLayers[e]}hasLayer(e){return e in this._layers}hasLayerType(e){for(const r in this._layers)if(this._layers[r].type===e)return!0;return!1}setLayerZoomRange(e,r,i){this._checkLoaded();const a=this.getLayer(e);a?a.minzoom===r&&a.maxzoom===i||(r!=null&&(a.minzoom=r),i!=null&&(a.maxzoom=i),this._updateLayer(a)):this.fire(new rt(new Error(`The layer '${e}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(e,r,i={}){this._checkLoaded();const a=this.getLayer(e);if(a){if(!ue(a.filter,r))return r==null?(a.filter=void 0,void this._updateLayer(a)):void(this._validate(y1,`layers.${a.id}.filter`,r,{layerType:a.type},i)||(a.filter=Y(r),this._updateLayer(a)))}else this.fire(new rt(new Error(`The layer '${e}' does not exist in the map's style and cannot be filtered.`)))}getFilter(e){const r=this.getLayer(e);return r&&Y(r.filter)}setLayoutProperty(e,r,i,a={}){this._checkLoaded();const s=this.getLayer(e);s?ue(s.getLayoutProperty(r),i)||(s.setLayoutProperty(r,i,a),s.isConfigDependent&&this._configDependentLayers.add(s.id),this._updateLayer(s)):this.fire(new rt(new Error(`The layer '${e}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(e,r){const i=this.getLayer(e);if(i)return i.getLayoutProperty(r);this.fire(new rt(new Error(`The layer '${e}' does not exist in the map's style.`)))}setPaintProperty(e,r,i,a={}){this._checkLoaded();const s=this.getLayer(e);if(!s)return void this.fire(new rt(new Error(`The layer '${e}' does not exist in the map's style and cannot be styled.`)));if(ue(s.getPaintProperty(r),i))return;const c=s.setPaintProperty(r,i,a);s.isConfigDependent&&this._configDependentLayers.add(s.id),c&&this._updateLayer(s),this._changed=!0,this._updatedPaintProps[e]=!0}getPaintProperty(e,r){const i=this.getLayer(e);return i&&i.getPaintProperty(r)}setFeatureState(e,r){this._checkLoaded();const i=e.source,a=e.sourceLayer,s=this.getSource(i);if(!s)return void this.fire(new rt(new Error(`The source '${i}' does not exist in the map's style.`)));const c=s.type;if(c==="geojson"&&a)return void this.fire(new rt(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(c==="vector"&&!a)return void this.fire(new rt(new Error("The sourceLayer parameter must be provided for vector source types.")));e.id===void 0&&this.fire(new rt(new Error("The feature id parameter must be provided.")));const u=this._getSourceCaches(i);for(const d of u)d.setFeatureState(a,e.id,r)}removeFeatureState(e,r){this._checkLoaded();const i=e.source,a=this.getSource(i);if(!a)return void this.fire(new rt(new Error(`The source '${i}' does not exist in the map's style.`)));const s=a.type,c=s==="vector"?e.sourceLayer:void 0;if(s==="vector"&&!c)return void this.fire(new rt(new Error("The sourceLayer parameter must be provided for vector source types.")));if(r&&typeof e.id!="string"&&typeof e.id!="number")return void this.fire(new rt(new Error("A feature id is required to remove its specific state property.")));const u=this._getSourceCaches(i);for(const d of u)d.removeFeatureState(c,e.id,r)}getFeatureState(e){this._checkLoaded();const r=e.source,i=e.sourceLayer,a=this.getSource(r);if(a){if(a.type!=="vector"||i)return e.id===void 0&&this.fire(new rt(new Error("The feature id parameter must be provided."))),this._getSourceCaches(r)[0].getFeatureState(i,e.id);this.fire(new rt(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new rt(new Error(`The source '${r}' does not exist in the map's style.`)))}getTransition(){return Oe({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){this._checkLoaded();const e={};for(const r in this._sourceCaches){const i=this._sourceCaches[r].getSource();e[i.id]||(e[i.id]=i.serialize())}return Fe({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,imports:this.stylesheet.imports,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:e,layers:this._serializeLayers(this._ownOrder)},r=>r!==void 0)}_updateLayer(e){this._updatedLayers[e.id]=!0;const r=this._getLayerSourceCache(e);e.source&&!this._updatedSources[e.source]&&r&&r.getSource().type!=="raster"&&(this._updatedSources[e.source]="reload",r.pause()),this._changed=!0,e.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(e){const r=c=>this._layers[c].type==="fill-extrusion",i={},a=[];for(let c=this._order.length-1;c>=0;c--){const u=this._order[c];if(r(u)){i[u]=c;for(const d of e){const p=d[u];if(p)for(const m of p)a.push(m)}}}a.sort((c,u)=>u.intersectionZ-c.intersectionZ);const s=[];for(let c=this._order.length-1;c>=0;c--){const u=this._order[c];if(r(u))for(let d=a.length-1;d>=0;d--){const p=a[d].feature;if(i[p.layer.id]<c)break;s.push(p),a.pop()}else for(const d of e){const p=d[u];if(p)for(const m of p)s.push(m.feature)}}return s}queryRenderedFeatures(e,r,i){r&&r.filter&&this._validate(y1,"queryRenderedFeatures.filter",r.filter,null,r);const a={};if(r&&r.layers){if(!Array.isArray(r.layers))return this.fire(new rt(new Error("parameters.layers must be an Array."))),[];for(const d of r.layers){const p=this._layers[d];if(!p)return this.fire(new rt(new Error(`The layer '${d}' does not exist in the map's style and cannot be queried for features.`))),[];a[p.source]=!0}}const s=[];r.availableImages=this._availableImages;const c=r&&r.layers?r.layers.some(d=>{const p=this.getLayer(d);return p&&p.is3D()}):this.has3DLayers(),u=ax.createFromScreenPoints(e,i);for(const d in this._sourceCaches){const p=this._sourceCaches[d].getSource().id;r.layers&&!a[p]||s.push(k9(this._sourceCaches[d],this._layers,this._serializedLayers,u,r,i,c,!!this.map._showQueryGeometry))}return this.placement&&s.push(function(d,p,m,_,y,v,b){const S={},T=v.queryRenderedSymbols(_),M=[];for(const C of Object.keys(T).map(Number))M.push(b[C]);M.sort(l5);for(const C of M){const P=C.featureIndex.lookupSymbolFeatures(T[C.bucketInstanceId],p,C.bucketIndex,C.sourceLayerIndex,y.filter,y.layers,y.availableImages,d);for(const k in P){const z=S[k]=S[k]||[],L=P[k];L.sort((B,W)=>{const Z=C.featureSortOrder;if(Z){const X=Z.indexOf(B.featureIndex);return Z.indexOf(W.featureIndex)-X}return W.featureIndex-B.featureIndex});for(const B of L)z.push(B)}}for(const C in S)S[C].forEach(P=>{const k=P.feature,z=m(d[C]);if(!z)return;const L=z.getFeatureState(k.layer["source-layer"],k.id);k.source=k.layer.source,k.layer["source-layer"]&&(k.sourceLayer=k.layer["source-layer"]),k.state=L});return S}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),u.screenGeometry,r,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(s)}querySourceFeatures(e,r){r&&r.filter&&this._validate(y1,"querySourceFeatures.filter",r.filter,null,r);const i=this._getSourceCaches(e);let a=[];for(const s of i)a=a.concat(R9(s,r));return a}addSourceType(e,r,i){return oa.getSourceType(e)?i(new Error(`A source type called "${e}" already exists.`)):(oa.setSourceType(e,r),r.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:e,url:r.workerSourceURL},i):i(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(e,r,i={}){this._checkLoaded();const a=this.light.getLight();let s=!1;for(const u in e)if(!ue(e[u],a[u])){s=!0;break}if(!s)return;const c=this._getTransitionParameters({duration:300,delay:0});this.light.setLight(e,r,i),this.light.updateTransitions(c)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(e,r=1){if(this._checkLoaded(),!e)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let i=e;if(r===1){if(typeof i.source=="object"){const a="terrain-dem-src";this.addSource(a,i.source),i=Y(i),i=Oe(i,{source:a})}if(this._validate(HL,"terrain",i))return}if(!this.terrain||this.terrain&&r!==this.terrain.drapeRenderMode){if(!i)return;this._createTerrain(i,r)}else{const a=this.terrain,s=a.get();for(const c of Object.keys(pe.terrain))!i.hasOwnProperty(c)&&pe.terrain[c].default&&(i[c]=pe.terrain[c].default);for(const c in e)if(!ue(e[c],s[c])){a.set(e),this.stylesheet.terrain=e;const u=this._getTransitionParameters({duration:0});a.updateTransitions(u);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(e){const r=this.fog=new p9(e,this.map.transform);this.stylesheet.fog=e;const i=this._getTransitionParameters({duration:0});r.updateTransitions(i)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const e of this.map._markers)e._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(e){if(this._checkLoaded(),!e)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const r=this.fog,i=r.get();Object.keys(e).length===0&&r.set(e);for(const a in e)if(!ue(e[a],i[a])){r.set(e),this.stylesheet.fog=e;const s=this._getTransitionParameters({duration:0});r.updateTransitions(s);break}}else this._createFog(e);this._markersNeedUpdate=!0}_getTransitionParameters(e){return{now:Ot.now(),transition:Oe(e,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const e=[],r=[];for(const i in this._layers){const a=this._layers[i];this.isLayerDraped(a)?e.push(a.id):r.push(a.id)}this._drapedFirstOrder=[],this._drapedFirstOrder.push(...e),this._drapedFirstOrder.push(...r)}_createTerrain(e,r){const i=this.terrain=new d9(e,r);this.stylesheet.terrain=e,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._updateDrapeFirstLayers(),this._force3DLayerUpdate();const a=this._getTransitionParameters({duration:0});i.updateTransitions(a)}_force3DLayerUpdate(){for(const e in this._layers){const r=this._layers[e];r.type==="fill-extrusion"&&this._updateLayer(r)}}_forceSymbolLayerUpdate(){for(const e in this._layers){const r=this._layers[e];r.type==="symbol"&&this._updateLayer(r)}}_validate(e,r,i,a,s={}){return(!s||s.validate!==!1)&&sf(this,e.call(lu,Oe({key:r,style:this.serialize(),value:i,styleSpec:pe},a)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),M1.off("pluginStateChange",this._rtlTextPluginCallback);for(const{style:e}of this.imports)e._remove();this._mergeLayers(),this._mergeSources();for(const e in this._layers)this._layers[e].setEventedParent(null);for(const e in this._sourceCaches)this._sourceCaches[e].clearTiles(),this._sourceCaches[e].setEventedParent(null);this.modelManager&&this.modelManager.setEventedParent(null),this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(e){const r=this._getSourceCaches(e);for(const i of r)i.clearTiles()}_reloadSource(e){const r=this._getSourceCaches(e);for(const i of r)i.resume(),i.reload()}_reloadSources(){for(const e of this._getSources())e.reload&&e.reload()}_updateSources(e){for(const r in this._sourceCaches)this._sourceCaches[r].update(e)}_generateCollisionBoxes(){for(const e in this._sourceCaches){const r=this._sourceCaches[e];r.resume(),r.reload()}}_updatePlacement(e,r,i,a,s=!1){let c=!1,u=!1;const d={};for(const p of this._order){const m=this._layers[p];if(m.type!=="symbol")continue;if(!d[m.source]){const y=this._getLayerSourceCache(m);if(!y)continue;d[m.source]=y.getRenderableIds(!0).map(v=>y.getTileByID(v)).sort((v,b)=>b.tileID.overscaledZ-v.tileID.overscaledZ||(v.tileID.isLessThan(b.tileID)?-1:1))}const _=this.crossTileSymbolIndex.addLayer(m,d[m.source],e.center.lng,e.projection);c=c||_}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),s=s||this._layerOrderChanged||i===0,this._layerOrderChanged&&this.fire(new Ee("neworder")),(s||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(Ot.now(),e.zoom))&&(this.pauseablePlacement=new K9(e,this._order,s,r,i,a,this.placement,this.fog&&e.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,d),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(Ot.now()),u=!0),c&&this.pauseablePlacement.placement.setStale()),u||c)for(const p of this._order){const m=this._layers[p];m.type==="symbol"&&this.placement.updateLayerOpacities(m,d[m.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(Ot.now())}_releaseSymbolFadeTiles(){for(const e in this._sourceCaches)this._sourceCaches[e].releaseSymbolFadeTiles()}getImages(e,r,i){this.imageManager.getImages(r.icons,r.scope,i),this._updateTilesForChangedImages();const a=s=>{s&&s.setDependencies(r.tileID.key,r.type,r.icons)};a(this._otherSourceCaches[r.source]),a(this._symbolSourceCaches[r.source])}getGlyphs(e,r,i){this.glyphManager.getGlyphs(r.stacks,r.scope,i)}getResource(e,r,i){return Le(r,i)}_getSourceCache(e){return this._otherSourceCaches[e]}_getOwnSourceCache(e){return this._ownSourceCaches[e]}_getLayerSourceCache(e){return e.type==="symbol"?this._symbolSourceCaches[e.source]:this._otherSourceCaches[e.source]}_getSourceCaches(e){const r=[];return this._otherSourceCaches[e]&&r.push(this._otherSourceCaches[e]),this._symbolSourceCaches[e]&&r.push(this._symbolSourceCaches[e]),r}_isSourceCacheLoaded(e){const r=this._getSourceCaches(e);return r.length===0?(this.fire(new rt(new Error(`There is no source with ID '${e}'`))),!1):r.every(i=>i.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}function vA(t,e){let r=!1,i=null;const a=()=>{i=null,r&&(t(),i=setTimeout(a,e),r=!1)};return()=>(r=!0,i||a(),i)}oa.getSourceType=function(t){return mx[t]},oa.setSourceType=function(t,e){mx[t]=e},oa.registerForPluginStateChange=function(t){return t({pluginStatus:Ui,pluginURL:Fs}),M1.on("pluginStateChange",t),t};class cj{constructor(e){this._hashName=e&&encodeURIComponent(e),ar(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=vA(this._updateHashUnthrottled.bind(this),300)}addTo(e){return this._map=e,w.addEventListener("hashchange",this._onHashChange,!1),e.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),w.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const e=this._map;if(!e)return"";const r=xA(e);if(this._hashName){const i=this._hashName;let a=!1;const s=w.location.hash.slice(1).split("&").map(c=>{const u=c.split("=")[0];return u===i?(a=!0,`${u}=${r}`):c}).filter(c=>c);return a||s.push(`${i}=${r}`),`#${s.join("&")}`}return`#${r}`}_getCurrentHash(){const e=w.location.hash.replace("#","");if(this._hashName){let r;return e.split("&").map(i=>i.split("=")).forEach(i=>{i[0]===this._hashName&&(r=i)}),(r&&r[1]||"").split("/")}return e.split("/")}_onHashChange(){const e=this._map;if(!e)return!1;const r=this._getCurrentHash();if(r.length>=3&&!r.some(i=>isNaN(i))){const i=e.dragRotate.isEnabled()&&e.touchZoomRotate.isEnabled()?+(r[3]||0):e.getBearing();return e.jumpTo({center:[+r[2],+r[1]],zoom:+r[0],bearing:i,pitch:+(r[4]||0)}),!0}return!1}_updateHashUnthrottled(){const e=w.location.href.replace(/(#.+)?$/,this.getHashString());w.history.replaceState(w.history.state,null,e)}}function xA(t,e){const r=t.getCenter(),i=Math.round(100*t.getZoom())/100,a=Math.ceil((i*Math.LN2+Math.log(512/360/.5))/Math.LN10),s=Math.pow(10,a),c=Math.round(r.lng*s)/s,u=Math.round(r.lat*s)/s,d=t.getBearing(),p=t.getPitch();let m=e?`/${c}/${u}/${i}`:`${i}/${u}/${c}`;return(d||p)&&(m+="/"+Math.round(10*d)/10),p&&(m+=`/${Math.round(p)}`),m}const Cg={linearity:.3,easing:He(0,0,.3,1)},uj=Oe({deceleration:2500,maxSpeed:1400},Cg),hj=Oe({deceleration:20,maxSpeed:1400},Cg),dj=Oe({deceleration:1e3,maxSpeed:360},Cg),fj=Oe({deceleration:1e3,maxSpeed:90},Cg);class pj{constructor(e){this._map=e,this.clear()}clear(){this._inertiaBuffer=[]}record(e){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:Ot.now(),settings:e})}_drainInertiaBuffer(){const e=this._inertiaBuffer,r=Ot.now();for(;e.length>0&&r-e[0].time>160;)e.shift()}_onMoveEnd(e){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const r={zoom:0,bearing:0,pitch:0,pan:new $(0,0),pinchAround:void 0,around:void 0};for(const{settings:s}of this._inertiaBuffer)r.zoom+=s.zoomDelta||0,r.bearing+=s.bearingDelta||0,r.pitch+=s.pitchDelta||0,s.panDelta&&r.pan._add(s.panDelta),s.around&&(r.around=s.around),s.pinchAround&&(r.pinchAround=s.pinchAround);const i=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,a={};if(r.pan.mag()){const s=Ig(r.pan.mag(),i,Oe({},uj,e||{}));a.offset=r.pan.mult(s.amount/r.pan.mag()),a.center=this._map.transform.center,Ag(a,s)}if(r.zoom){const s=Ig(r.zoom,i,hj);a.zoom=this._map.transform.zoom+s.amount,Ag(a,s)}if(r.bearing){const s=Ig(r.bearing,i,dj);a.bearing=this._map.transform.bearing+ze(s.amount,-179,179),Ag(a,s)}if(r.pitch){const s=Ig(r.pitch,i,fj);a.pitch=this._map.transform.pitch+s.amount,Ag(a,s)}if(a.zoom||a.bearing){const s=r.pinchAround===void 0?r.around:r.pinchAround;a.around=s?this._map.unproject(s):this._map.getCenter()}return this.clear(),a.noMoveStart=!0,a}}function Ag(t,e){(!t.duration||t.duration<e.duration)&&(t.duration=e.duration,t.easing=e.easing)}function Ig(t,e,r){const{maxSpeed:i,linearity:a,deceleration:s}=r,c=ze(t*a/(e/1e3),-i,i),u=Math.abs(c)/(s*a);return{easing:r.easing,duration:1e3*u,amount:c*(u/2)}}class ho extends Ee{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,i,a={}){const s=Co(r.getCanvasContainer(),i);super(e,Oe({point:s,lngLat:r.unproject(s),originalEvent:i},a)),this._defaultPrevented=!1,this.target=r}}class Pg extends Ee{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,i){const a=e==="touchend"?i.changedTouches:i.touches,s=Ea(r.getCanvasContainer(),a),c=s.map(d=>r.unproject(d)),u=s.reduce((d,p,m,_)=>d.add(p.div(_.length)),new $(0,0));super(e,{points:s,point:u,lngLats:c,lngLat:r.unproject(u),originalEvent:i}),this._defaultPrevented=!1}}class mj extends Ee{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(e,r,i){super(e,{originalEvent:i}),this._defaultPrevented=!1}}class gj{constructor(e,r){this._map=e,this._clickTolerance=r.clickTolerance}reset(){this._mousedownPos=void 0}wheel(e){return this._firePreventable(new mj(e.type,this._map,e))}mousedown(e,r){return this._mousedownPos=r,this._firePreventable(new ho(e.type,this._map,e))}mouseup(e){this._map.fire(new ho(e.type,this._map,e))}preclick(e){const r=Oe({},e);r.type="preclick",this._map.fire(new ho(r.type,this._map,r))}click(e,r){this._mousedownPos&&this._mousedownPos.dist(r)>=this._clickTolerance||(this.preclick(e),this._map.fire(new ho(e.type,this._map,e)))}dblclick(e){return this._firePreventable(new ho(e.type,this._map,e))}mouseover(e){this._map.fire(new ho(e.type,this._map,e))}mouseout(e){this._map.fire(new ho(e.type,this._map,e))}touchstart(e){return this._firePreventable(new Pg(e.type,this._map,e))}touchmove(e){this._map.fire(new Pg(e.type,this._map,e))}touchend(e){this._map.fire(new Pg(e.type,this._map,e))}touchcancel(e){this._map.fire(new Pg(e.type,this._map,e))}_firePreventable(e){if(this._map.fire(e),e.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class _j{constructor(e){this._map=e}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(e){this._map.fire(new ho(e.type,this._map,e))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new ho("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(e){this._delayContextMenu?this._contextMenuEvent=e:this._map.fire(new ho(e.type,this._map,e)),this._map.listens("contextmenu")&&e.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class yj{constructor(e,r){this._map=e,this._el=e.getCanvasContainer(),this._container=e.getContainer(),this._clickTolerance=r.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(e,r){this.isEnabled()&&e.shiftKey&&e.button===0&&(zs(),this._startPos=this._lastPos=r,this._active=!0)}mousemoveWindow(e,r){if(!this._active)return;const i=r,a=this._startPos,s=this._lastPos;if(!a||!s||s.equals(i)||!this._box&&i.dist(a)<this._clickTolerance)return;this._lastPos=i,this._box||(this._box=Tr("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",e));const c=Math.min(a.x,i.x),u=Math.max(a.x,i.x),d=Math.min(a.y,i.y),p=Math.max(a.y,i.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${c}px,${d}px)`,this._box.style.width=u-c+"px",this._box.style.height=p-d+"px")})}mouseupWindow(e,r){if(!this._active)return;const i=this._startPos,a=r;if(i&&e.button===0){if(this.reset(),Xo(),i.x!==a.x||i.y!==a.y)return this._map.fire(new Ee("boxzoomend",{originalEvent:e})),{cameraAnimation:s=>s.fitScreenCoordinates(i,a,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",e)}}keydown(e){this._active&&e.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",e))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Hl(),delete this._startPos,delete this._lastPos}_fireEvent(e,r){return this._map.fire(new Ee(e,{originalEvent:r}))}}function zx(t,e){const r={};for(let i=0;i<t.length;i++)r[t[i].identifier]=e[i];return r}class vj{constructor(e){this.reset(),this.numTouches=e.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(e,r,i){(this.centroid||i.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=e.timeStamp),i.length===this.numTouches&&(this.centroid=function(a){const s=new $(0,0);for(const c of a)s._add(c);return s.div(a.length)}(r),this.touches=zx(i,r)))}touchmove(e,r,i){if(this.aborted||!this.centroid)return;const a=zx(i,r);for(const s in this.touches){const c=a[s];(!c||c.dist(this.touches[s])>30)&&(this.aborted=!0)}}touchend(e,r,i){if((!this.centroid||e.timeStamp-this.startTime>500)&&(this.aborted=!0),i.length===0){const a=!this.aborted&&this.centroid;if(this.reset(),a)return a}}}class Dx{constructor(e){this.singleTap=new vj(e),this.numTaps=e.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(e,r,i){this.singleTap.touchstart(e,r,i)}touchmove(e,r,i){this.singleTap.touchmove(e,r,i)}touchend(e,r,i){const a=this.singleTap.touchend(e,r,i);if(a){const s=e.timeStamp-this.lastTime<500,c=!this.lastTap||this.lastTap.dist(a)<30;if(s&&c||this.reset(),this.count++,this.lastTime=e.timeStamp,this.lastTap=a,this.count===this.numTaps)return this.reset(),a}}}class xj{constructor(){this._zoomIn=new Dx({numTouches:1,numTaps:2}),this._zoomOut=new Dx({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(e,r,i){this._zoomIn.touchstart(e,r,i),this._zoomOut.touchstart(e,r,i)}touchmove(e,r,i){this._zoomIn.touchmove(e,r,i),this._zoomOut.touchmove(e,r,i)}touchend(e,r,i){const a=this._zoomIn.touchend(e,r,i),s=this._zoomOut.touchend(e,r,i);return a?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:c=>c.easeTo({duration:300,zoom:c.getZoom()+1,around:c.unproject(a)},{originalEvent:e})}):s?(this._active=!0,e.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:c=>c.easeTo({duration:300,zoom:c.getZoom()-1,around:c.unproject(s)},{originalEvent:e})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const bj={0:1,2:2};class Lx{constructor(e){this.reset(),this._clickTolerance=e.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(e,r){return!1}_move(e,r){return{}}mousedown(e,r){if(this._lastPoint)return;const i=Zc(e);this._correctButton(e,i)&&(this._lastPoint=r,this._eventButton=i)}mousemoveWindow(e,r){const i=this._lastPoint;if(i){if(e.preventDefault(),this._eventButton!=null&&function(a,s){const c=bj[s];return a.buttons===void 0||(a.buttons&c)!==c}(e,this._eventButton))this.reset();else if(this._moved||!(r.dist(i)<this._clickTolerance))return this._moved=!0,this._lastPoint=r,this._move(i,r)}}mouseupWindow(e){this._lastPoint&&Zc(e)===this._eventButton&&(this._moved&&Xo(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wj extends Lx{mousedown(e,r){super.mousedown(e,r),this._lastPoint&&(this._active=!0)}_correctButton(e,r){return r===0&&!e.ctrlKey}_move(e,r){return{around:r,panDelta:r.sub(e)}}}class bA extends Lx{_correctButton(e,r){return r===0&&e.ctrlKey||r===2}_move(e,r){const i=.8*(r.x-e.x);if(i)return this._active=!0,{bearingDelta:i}}contextmenu(e){e.preventDefault()}}class wA extends Lx{_correctButton(e,r){return r===0&&e.ctrlKey||r===2}_move(e,r){const i=-.5*(r.y-e.y);if(i)return this._active=!0,{pitchDelta:i}}contextmenu(e){e.preventDefault()}}class Ej{constructor(e,r){this._map=e,this._el=e.getCanvasContainer(),this._minTouches=1,this._clickTolerance=r.clickTolerance||1,this.reset(),ar(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new $(0,0)}touchstart(e,r,i){return this._calculateTransform(e,r,i)}touchmove(e,r,i){if(this._active&&!(i.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(i.length===1&&!mr())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return e.cancelable&&e.preventDefault(),this._calculateTransform(e,r,i)}}touchend(e,r,i){this._calculateTransform(e,r,i),this._active&&i.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(e,r,i){i.length>0&&(this._active=!0);const a=zx(i,r),s=new $(0,0),c=new $(0,0);let u=0;for(const p in a){const m=a[p],_=this._touches[p];_&&(s._add(m),c._add(m.sub(_)),u++,a[p]=m)}if(this._touches=a,u<this._minTouches||!c.mag())return;const d=c.div(u);return this._sum._add(d),this._sum.mag()<this._clickTolerance?void 0:{around:s.div(u),panDelta:d}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Tr("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Ox{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(e){}_move(e,r,i){return{}}touchstart(e,r,i){this._firstTwoTouches||i.length<2||(this._firstTwoTouches=[i[0].identifier,i[1].identifier],this._start([r[0],r[1]]))}touchmove(e,r,i){const a=this._firstTwoTouches;if(!a)return;e.preventDefault();const[s,c]=a,u=kg(i,r,s),d=kg(i,r,c);if(!u||!d)return;const p=this._aroundCenter?null:u.add(d).div(2);return this._move([u,d],p,e)}touchend(e,r,i){if(!this._firstTwoTouches)return;const[a,s]=this._firstTwoTouches,c=kg(i,r,a),u=kg(i,r,s);c&&u||(this._active&&Xo(),this.reset())}touchcancel(){this.reset()}enable(e){this._enabled=!0,this._aroundCenter=!!e&&e.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function kg(t,e,r){for(let i=0;i<t.length;i++)if(t[i].identifier===r)return e[i]}function EA(t,e){return Math.log(t/e)/Math.LN2}class Sj extends Ox{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(e){this._startDistance=this._distance=e[0].dist(e[1])}_move(e,r){const i=this._distance;if(this._distance=e[0].dist(e[1]),this._active||!(Math.abs(EA(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:EA(this._distance,i),pinchAround:r}}}function SA(t,e){return 180*t.angleWith(e)/Math.PI}class Tj extends Ox{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(e){this._startVector=this._vector=e[0].sub(e[1]),this._minDiameter=e[0].dist(e[1])}_move(e,r){const i=this._vector;if(this._vector=e[0].sub(e[1]),i&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:SA(this._vector,i),pinchAround:r}}_isBelowThreshold(e){this._minDiameter=Math.min(this._minDiameter,e.mag());const r=25/(Math.PI*this._minDiameter)*360,i=this._startVector;if(!i)return!1;const a=SA(e,i);return Math.abs(a)<r}}function Fx(t){return Math.abs(t.y)>Math.abs(t.x)}class Mj extends Ox{constructor(e){super(),this._map=e}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(e){this._lastPoints=e,Fx(e[0].sub(e[1]))&&(this._valid=!1)}_move(e,r,i){const a=this._lastPoints;if(!a)return;const s=e[0].sub(a[0]),c=e[1].sub(a[1]);return this._map._cooperativeGestures&&!mr()&&i.touches.length<3||(this._valid=this.gestureBeginsVertically(s,c,i.timeStamp),!this._valid)?void 0:(this._lastPoints=e,this._active=!0,{pitchDelta:(s.y+c.y)/2*-.5})}gestureBeginsVertically(e,r,i){if(this._valid!==void 0)return this._valid;const a=e.mag()>=2,s=r.mag()>=2;if(!a&&!s)return;if(!a||!s)return this._firstMove==null&&(this._firstMove=i),i-this._firstMove<100&&void 0;const c=e.y>0==r.y>0;return Fx(e)&&Fx(r)&&c}}const Cj={panStep:100,bearingStep:15,pitchStep:10};class Aj{constructor(){const e=Cj;this._panStep=e.panStep,this._bearingStep=e.bearingStep,this._pitchStep=e.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(e){if(e.altKey||e.ctrlKey||e.metaKey)return;let r=0,i=0,a=0,s=0,c=0;switch(e.keyCode){case 61:case 107:case 171:case 187:r=1;break;case 189:case 109:case 173:r=-1;break;case 37:e.shiftKey?i=-1:(e.preventDefault(),s=-1);break;case 39:e.shiftKey?i=1:(e.preventDefault(),s=1);break;case 38:e.shiftKey?a=1:(e.preventDefault(),c=-1);break;case 40:e.shiftKey?a=-1:(e.preventDefault(),c=1);break;default:return}return this._rotationDisabled&&(i=0,a=0),{cameraAnimation:u=>{const d=u.getZoom();u.easeTo({duration:300,easeId:"keyboardHandler",easing:Ij,zoom:r?Math.round(d)+r*(e.shiftKey?2:1):d,bearing:u.getBearing()+i*this._bearingStep,pitch:u.getPitch()+a*this._pitchStep,offset:[-s*this._panStep,-c*this._panStep],center:u.getCenter()},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ij(t){return t*(2-t)}const TA=4.000244140625;class Pj{constructor(e,r){this._map=e,this._el=e.getCanvasContainer(),this._handler=r,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,ar(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(e){this._defaultZoomRate=e}setWheelZoomRate(e){this._wheelZoomRate=e}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(e){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!e&&e.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(e){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(e.ctrlKey||e.metaKey||this.isZooming()||mr()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let r=e.deltaMode===w.WheelEvent.DOM_DELTA_LINE?40*e.deltaY:e.deltaY;const i=Ot.now(),a=i-(this._lastWheelEventTime||0);this._lastWheelEventTime=i,r!==0&&r%TA==0?this._type="wheel":r!==0&&Math.abs(r)<4?this._type="trackpad":a>400?(this._type=null,this._lastValue=r,this._timeout=setTimeout(this._onTimeout,40,e)):this._type||(this._type=Math.abs(a*r)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,r+=this._lastValue)),e.shiftKey&&r&&(r/=4),this._type&&(this._lastWheelEvent=e,this._delta-=r,this._active||this._start(e)),e.preventDefault()}_onTimeout(e){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(e)}_start(e){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const r=Co(this._el,e);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:r,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const e=this._map.transform;this._type==="wheel"&&e.projection.wrap&&(e._center.lng>=180||e._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const r=()=>e._terrainEnabled()&&this._aroundCoord?e.computeZoomRelativeTo(this._aroundCoord):e.zoom;if(this._delta!==0){const d=this._type==="wheel"&&Math.abs(this._delta)>TA?this._wheelZoomRate:this._defaultZoomRate;let p=2/(1+Math.exp(-Math.abs(this._delta*d)));this._delta<0&&p!==0&&(p=1/p);const m=r(),_=Math.pow(2,m),y=typeof this._targetZoom=="number"?e.zoomScale(this._targetZoom):_;this._targetZoom=Math.min(e.maxZoom,Math.max(e.minZoom,e.scaleZoom(y*p))),this._type==="wheel"&&(this._startZoom=m,this._easing=this._smoothOutEasing(200)),this._delta=0}const i=typeof this._targetZoom=="number"?this._targetZoom:r(),a=this._startZoom,s=this._easing;let c,u=!1;if(this._type==="wheel"&&a&&s){const d=Math.min((Ot.now()-this._lastWheelEventTime)/200,1);c=Ft(a,i,s(d)),d<1?this._frameId||(this._frameId=!0):u=!0}else c=i,u=!0;return this._active=!0,u&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!u,zoomDelta:c-r(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(e){let r=Xe;if(this._prevEase){const i=this._prevEase,a=(Ot.now()-i.start)/i.duration,s=i.easing(a+.01)-i.easing(a),c=.27/Math.sqrt(s*s+1e-4)*.01;r=He(c,Math.sqrt(.0729-c*c),.25,1)}return this._prevEase={start:Ot.now(),duration:e,easing:r},r}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Tr("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(w.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class kj{constructor(e,r){this._clickZoom=e,this._tapZoom=r}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Rj{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(e,r){return e.preventDefault(),{cameraAnimation:i=>{i.easeTo({duration:300,zoom:i.getZoom()+(e.shiftKey?-1:1),around:i.unproject(r)},{originalEvent:e})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class zj{constructor(){this._tap=new Dx({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(e,r,i){this._swipePoint||(this._tapTime&&e.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?i.length>0&&(this._swipePoint=r[0],this._swipeTouch=i[0].identifier):this._tap.touchstart(e,r,i))}touchmove(e,r,i){if(this._tapTime){if(this._swipePoint){if(i[0].identifier!==this._swipeTouch)return;const a=r[0],s=a.y-this._swipePoint.y;return this._swipePoint=a,e.preventDefault(),this._active=!0,{zoomDelta:s/128}}}else this._tap.touchmove(e,r,i)}touchend(e,r,i){this._tapTime?this._swipePoint&&i.length===0&&this.reset():this._tap.touchend(e,r,i)&&(this._tapTime=e.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Dj{constructor(e,r,i){this._el=e,this._mousePan=r,this._touchPan=i}enable(e){this._inertiaOptions=e||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Lj{constructor(e,r,i){this._pitchWithRotate=e.pitchWithRotate,this._mouseRotate=r,this._mousePitch=i}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Oj{constructor(e,r,i,a){this._el=e,this._touchZoom=r,this._touchRotate=i,this._tapDragZoom=a,this._rotationDisabled=!1,this._enabled=!0}enable(e){this._touchZoom.enable(e),this._rotationDisabled||this._touchRotate.enable(e),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Rg=t=>t.zoom||t.drag||t.pitch||t.rotate;class Fj extends Ee{}class Bj{constructor(){this.constants=[1,1,.01],this.radius=0}setup(e,r){const i=ie.sub([],r,e);this.radius=ie.length(i[2]<0?ie.div([],i,this.constants):[i[0],i[1],0])}projectRay(e){ie.div(e,e,this.constants),ie.normalize(e,e),ie.mul(e,e,this.constants);const r=ie.scale([],e,this.radius);if(r[2]>0){const i=ie.scale([],[0,0,1],ie.dot(r,[0,0,1])),a=ie.scale([],ie.normalize([],[r[0],r[1],0]),this.radius),s=ie.add([],r,ie.scale([],ie.sub([],ie.add([],a,i),r),2));r[0]=s[0],r[1]=s[1]}return r}}function zg(t){return t.panDelta&&t.panDelta.mag()||t.zoomDelta||t.bearingDelta||t.pitchDelta}class Nj{constructor(e,r){this._map=e,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new pj(e),this._bearingSnap=r.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Bj,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(r),ar(["handleEvent","handleWindowEvent"],this);const i=this._el;this._listeners=[[i,"touchstart",{passive:!0}],[i,"touchmove",{passive:!1}],[i,"touchend",void 0],[i,"touchcancel",void 0],[i,"mousedown",void 0],[i,"mousemove",void 0],[i,"mouseup",void 0],[w.document,"mousemove",{capture:!0}],[w.document,"mouseup",void 0],[i,"mouseover",void 0],[i,"mouseout",void 0],[i,"dblclick",void 0],[i,"click",void 0],[i,"keydown",{capture:!1}],[i,"keyup",void 0],[i,"wheel",{passive:!1}],[i,"contextmenu",void 0],[w,"blur",void 0]];for(const[a,s,c]of this._listeners)a.addEventListener(s,a===w.document?this.handleWindowEvent:this.handleEvent,c)}destroy(){for(const[e,r,i]of this._listeners)e.removeEventListener(r,e===w.document?this.handleWindowEvent:this.handleEvent,i)}_addDefaultHandlers(e){const r=this._map,i=r.getCanvasContainer();this._add("mapEvent",new gj(r,e));const a=r.boxZoom=new yj(r,e);this._add("boxZoom",a);const s=new xj,c=new Rj;r.doubleClickZoom=new kj(c,s),this._add("tapZoom",s),this._add("clickZoom",c);const u=new zj;this._add("tapDragZoom",u);const d=r.touchPitch=new Mj(r);this._add("touchPitch",d);const p=new bA(e),m=new wA(e);r.dragRotate=new Lj(e,p,m),this._add("mouseRotate",p,["mousePitch"]),this._add("mousePitch",m,["mouseRotate"]);const _=new wj(e),y=new Ej(r,e);r.dragPan=new Dj(i,_,y),this._add("mousePan",_),this._add("touchPan",y,["touchZoom","touchRotate"]);const v=new Tj,b=new Sj;r.touchZoomRotate=new Oj(i,b,v,u),this._add("touchRotate",v,["touchPan","touchZoom"]),this._add("touchZoom",b,["touchPan","touchRotate"]),this._add("blockableMapEvent",new _j(r));const S=r.scrollZoom=new Pj(r,this);this._add("scrollZoom",S,["mousePan"]);const T=r.keyboard=new Aj;this._add("keyboard",T);for(const M of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])e.interactive&&e[M]&&r[M].enable(e[M])}_add(e,r,i){this._handlers.push({handlerName:e,handler:r,allowed:i}),this._handlersById[e]=r}stop(e){if(!this._updatingCamera){for(const{handler:r}of this._handlers)r.reset();this._inertia.clear(),this._fireEvents({},{},e),this._changes=[]}}isActive(){for(const{handler:e}of this._handlers)if(e.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Rg(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(e,r,i){for(const a in e)if(a!==i&&(!r||r.indexOf(a)<0))return!0;return!1}handleWindowEvent(e){this.handleEvent(e,`${e.type}Window`)}_getMapTouches(e){const r=[];for(const i of e)this._el.contains(i.target)&&r.push(i);return r}handleEvent(e,r){this._updatingCamera=!0;const i=e.type==="renderFrame",a=i?void 0:e,s={needsRenderFrame:!1},c={},u={},d=e.touches?this._getMapTouches(e.touches):void 0,p=d?Ea(this._el,d):i?void 0:Co(this._el,e);for(const{handlerName:y,handler:v,allowed:b}of this._handlers){if(!v.isEnabled())continue;let S;this._blockedByActive(u,b,y)?v.reset():v[r||e.type]&&(S=v[r||e.type](e,p,d),this.mergeHandlerResult(s,c,S,y,a),S&&S.needsRenderFrame&&this._triggerRenderFrame()),(S||v.isActive())&&(u[y]=v)}const m={};for(const y in this._previousActiveHandlers)u[y]||(m[y]=a);this._previousActiveHandlers=u,(Object.keys(m).length||zg(s))&&(this._changes.push([s,c,m]),this._triggerRenderFrame()),(Object.keys(u).length||zg(s))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:_}=s;_&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],_(this._map))}mergeHandlerResult(e,r,i,a,s){if(!i)return;Oe(e,i);const c={handlerName:a,originalEvent:i.originalEvent||s};i.zoomDelta!==void 0&&(r.zoom=c),i.panDelta!==void 0&&(r.drag=c),i.pitchDelta!==void 0&&(r.pitch=c),i.bearingDelta!==void 0&&(r.rotate=c)}_applyChanges(){const e={},r={},i={};for(const[a,s,c]of this._changes)a.panDelta&&(e.panDelta=(e.panDelta||new $(0,0))._add(a.panDelta)),a.zoomDelta&&(e.zoomDelta=(e.zoomDelta||0)+a.zoomDelta),a.bearingDelta&&(e.bearingDelta=(e.bearingDelta||0)+a.bearingDelta),a.pitchDelta&&(e.pitchDelta=(e.pitchDelta||0)+a.pitchDelta),a.around!==void 0&&(e.around=a.around),a.aroundCoord!==void 0&&(e.aroundCoord=a.aroundCoord),a.pinchAround!==void 0&&(e.pinchAround=a.pinchAround),a.noInertia&&(e.noInertia=a.noInertia),Oe(r,s),Oe(i,c);this._updateMapTransform(e,r,i),this._changes=[]}_updateMapTransform(e,r,i){const a=this._map,s=a.transform,c=C=>[C.x,C.y,C.z];if((C=>{const P=this._eventsInProgress.drag;return P&&!this._handlersById[P.handlerName].isActive()})()&&!zg(e)){const C=s.zoom;s.cameraElevationReference="sea",s.recenterOnTerrain(),s.cameraElevationReference="ground",C!==s.zoom&&this._map._update(!0)}if(s._isCameraConstrained&&a._stop(!0),!zg(e))return void this._fireEvents(r,i,!0);let{panDelta:u,zoomDelta:d,bearingDelta:p,pitchDelta:m,around:_,aroundCoord:y,pinchAround:v}=e;s._isCameraConstrained&&(d>0&&(d=0),s._isCameraConstrained=!1),v!==void 0&&(_=v),(d||(C=>r[C]&&!this._eventsInProgress[C])("drag"))&&_&&(this._dragOrigin=c(s.pointCoordinate3D(_)),this._trackingEllipsoid.setup(s._camera.position,this._dragOrigin)),s.cameraElevationReference="sea",a._stop(!0),_=_||a.transform.centerPoint,p&&(s.bearing+=p),m&&(s.pitch+=m),s._updateCameraState();const b=[0,0,0];if(u)if(s.projection.name==="mercator"){const C=this._trackingEllipsoid.projectRay(s.screenPointToMercatorRay(_).dir),P=this._trackingEllipsoid.projectRay(s.screenPointToMercatorRay(_.sub(u)).dir);b[0]=P[0]-C[0],b[1]=P[1]-C[1]}else{const C=s.pointCoordinate(_);if(s.projection.name==="globe"){u=u.rotate(-s.angle);const P=s._pixelsPerMercatorPixel/s.worldSize;b[0]=-u.x*yv(zn(C.y))*P,b[1]=-u.y*yv(s.center.lat)*P}else{const P=s.pointCoordinate(_.sub(u));C&&P&&(b[0]=P.x-C.x,b[1]=P.y-C.y)}}const S=s.zoom,T=[0,0,0];if(d){const C=c(y||s.pointCoordinate3D(_)),P={dir:ie.normalize([],ie.sub([],C,s._camera.position))};if(P.dir[2]<0){const k=s.zoomDeltaToMovement(C,d);ie.scale(T,P.dir,k)}}const M=ie.add(b,b,T);s._translateCameraConstrained(M),d&&Math.abs(s.zoom-S)>1e-4&&s.recenterOnTerrain(),s.cameraElevationReference="ground",this._map._update(),e.noInertia||this._inertia.record(e),this._fireEvents(r,i,!0)}_fireEvents(e,r,i){const a=Rg(this._eventsInProgress),s=Rg(e),c={};for(const m in e){const{originalEvent:_}=e[m];this._eventsInProgress[m]||(c[`${m}start`]=_),this._eventsInProgress[m]=e[m]}!a&&s&&this._fireEvent("movestart",s.originalEvent);for(const m in c)this._fireEvent(m,c[m]);s&&this._fireEvent("move",s.originalEvent);for(const m in e){const{originalEvent:_}=e[m];this._fireEvent(m,_)}const u={};let d;for(const m in this._eventsInProgress){const{handlerName:_,originalEvent:y}=this._eventsInProgress[m];this._handlersById[_].isActive()||(delete this._eventsInProgress[m],d=r[_]||y,u[`${m}end`]=d)}for(const m in u)this._fireEvent(m,u[m]);const p=Rg(this._eventsInProgress);if(i&&(a||s)&&!p){this._updatingCamera=!0;const m=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),_=y=>y!==0&&-this._bearingSnap<y&&y<this._bearingSnap;m?(_(m.bearing||this._map.getBearing())&&(m.bearing=0),this._map.easeTo(m,{originalEvent:d})):(this._map.fire(new Ee("moveend",{originalEvent:d})),_(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(e,r){this._map.fire(new Ee(e,r?{originalEvent:r}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(e=>{this._frameId=void 0,this.handleEvent(new Fj("renderFrame",{timeStamp:e})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const MA="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class jj extends dr{constructor(e,r){super(),this._moving=!1,this._zooming=!1,this.transform=e,this._bearingSnap=r.bearingSnap,this._respectPrefersReducedMotion=r.respectPrefersReducedMotion!==!1,ar(["_renderFrameCallback"],this)}getCenter(){return new zt(this.transform.center.lng,this.transform.center.lat)}setCenter(e,r){return this.jumpTo({center:e},r)}panBy(e,r,i){return e=$.convert(e).mult(-1),this.panTo(this.transform.center,Oe({offset:e},r),i)}panTo(e,r,i){return this.easeTo(Oe({center:e},r),i)}getZoom(){return this.transform.zoom}setZoom(e,r){return this.jumpTo({zoom:e},r),this}zoomTo(e,r,i){return this.easeTo(Oe({zoom:e},r),i)}zoomIn(e,r){return this.zoomTo(this.getZoom()+1,e,r),this}zoomOut(e,r){return this.zoomTo(this.getZoom()-1,e,r),this}getBearing(){return this.transform.bearing}setBearing(e,r){return this.jumpTo({bearing:e},r),this}getPadding(){return this.transform.padding}setPadding(e,r){return this.jumpTo({padding:e},r),this}rotateTo(e,r,i){return this.easeTo(Oe({bearing:e},r),i)}resetNorth(e,r){return this.rotateTo(0,Oe({duration:1e3},e),r),this}resetNorthPitch(e,r){return this.easeTo(Oe({bearing:0,pitch:0,duration:1e3},e),r),this}snapToNorth(e,r){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(e,r):this}getPitch(){return this.transform.pitch}setPitch(e,r){return this.jumpTo({pitch:e},r),this}cameraForBounds(e,r){e=lo.convert(e);const i=r&&r.bearing||0,a=r&&r.pitch||0,s=e.getNorthWest(),c=e.getSouthEast();return this._cameraForBounds(this.transform,s,c,i,a,r)}_extendCameraOptions(e){const r={top:0,bottom:0,right:0,left:0};if(typeof(e=Oe({padding:r,offset:[0,0],maxZoom:this.transform.maxZoom},e)).padding=="number"){const i=e.padding;e.padding={top:i,bottom:i,right:i,left:i}}return e.padding=Oe(r,e.padding),e}_minimumAABBFrustumDistance(e,r){const i=r.max[0]-r.min[0],a=r.max[1]-r.min[1];return i/a>e.aspect?i/(2*Math.tan(.5*e.fovX)*e.aspect):a/(2*Math.tan(.5*e.fovY)*e.aspect)}_cameraForBoundsOnGlobe(e,r,i,a,s,c){const u=e.clone(),d=this._extendCameraOptions(c);u.bearing=a,u.pitch=s;const p=zt.convert(r),m=zt.convert(i),_=.5*(p.lat+m.lat),y=.5*(p.lng+m.lng),v=Pi(_,y),b=ie.normalize([],v),S=ie.normalize([],ie.cross([],b,[0,1,0])),T=ie.cross([],S,b),M=[S[0],S[1],S[2],0,T[0],T[1],T[2],0,b[0],b[1],b[2],0,0,0,0,1],C=[v,Pi(p.lat,p.lng),Pi(m.lat,p.lng),Pi(m.lat,m.lng),Pi(p.lat,m.lng),Pi(_,p.lng),Pi(_,m.lng),Pi(p.lat,y),Pi(m.lat,y)];let P=_n.fromPoints(C.map(me=>[ie.dot(S,me),ie.dot(T,me),ie.dot(b,me)]));const k=ie.transformMat4([],P.center,M);ie.squaredLength(k)===0&&ie.set(k,0,0,1),ie.normalize(k,k),ie.scale(k,k,Wi),u.center=function([me,ve,Ce]){const Se=Math.hypot(me,ve,Ce),Je=Math.atan2(me,Ce),Ge=.5*Math.PI-Math.acos(-ve/Se);return new zt(ke(Je),ke(Ge))}(k);const z=u.getWorldToCameraMatrix(),L=ge.invert(new Float64Array(16),z);P=_n.applyTransform(P,ge.multiply([],z,M)),ie.transformMat4(k,k,z);const B=.5*(P.max[2]-P.min[2]),W=this._minimumAABBFrustumDistance(u,P),Z=ie.scale([],[0,0,1],B),X=ie.add(Z,k,Z),H=W+(u.pitch===0?0:ie.distance(k,X)),J=u.globeCenterInViewSpace,Q=ie.sub([],k,[J[0],J[1],J[2]]);ie.normalize(Q,Q),ie.scale(Q,Q,H);const K=ie.add([],k,Q);ie.transformMat4(K,K,L);const fe=xu/Wi,he=ie.length(K),_e=jr(Math.max(he*fe-xu,Number.EPSILON),0),oe=Math.min(u.zoomFromMercatorZAdjusted(_e),d.maxZoom);return oe>.5*(Ad+Zs)?(u.setProjection({name:"mercator"}),u.zoom=oe,this._cameraForBounds(u,r,i,a,s,c)):{center:u.center,zoom:oe,bearing:a,pitch:s}}queryTerrainElevation(e,r){const i=this.transform.elevation;return i?(r=Oe({},{exaggerated:!0},r),i.getAtPoint(cr.fromLngLat(e),null,r.exaggerated)):null}_cameraForBounds(e,r,i,a,s,c){if(e.projection.name==="globe")return this._cameraForBoundsOnGlobe(e,r,i,a,s,c);const u=e.clone(),d=this._extendCameraOptions(c),p=u.padding;u.bearing=a,u.pitch=s;const m=zt.convert(r),_=zt.convert(i),y=new zt(m.lng,_.lat),v=new zt(_.lng,m.lat),b=u.project(m),S=u.project(_),T=this.queryTerrainElevation(m),M=this.queryTerrainElevation(_),C=this.queryTerrainElevation(y),P=this.queryTerrainElevation(v),k=[[b.x,b.y,Math.min(T||0,M||0,C||0,P||0)],[S.x,S.y,Math.max(T||0,M||0,C||0,P||0)]];let z=_n.fromPoints(k);const L=u.getWorldToCameraMatrix(),B=ge.invert(new Float64Array(16),L);z=_n.applyTransform(z,L);const W=ie.sub([],z.max,z.min),Z=p.left||0,X=p.right||0,H=p.bottom||0,J=p.top||0,{left:Q,right:K,top:fe,bottom:he}=d.padding,_e=.5*(Z+X),oe=.5*(J+H),me=Math.min(u.scaleZoom(u.scale*Math.min((u.width-(Z+X+Q+K))/W[0],(u.height-(H+J+he+fe))/W[1])),d.maxZoom),ve=u.scale/u.zoomScale(me);z=new _n([z.min[0]-(Q+_e)*ve,z.min[1]-(he+oe)*ve,z.min[2]],[z.max[0]+(K+_e)*ve,z.max[1]+(fe+oe)*ve,z.max[2]]);const Ce=.5*W[2],Se=this._minimumAABBFrustumDistance(u,z),Je=[0,0,1,0];Wr.transformMat4(Je,Je,L),Wr.normalize(Je,Je);const Ge=ie.scale([],Je,Se+Ce),je=ie.add([],z.center,Ge),Ve=(typeof d.offset.x=="number"&&typeof d.offset.y=="number"?new $(d.offset.x,d.offset.y):$.convert(d.offset)).rotate(-se(a));z.center[0]-=Ve.x*ve,z.center[1]+=Ve.y*ve,ie.transformMat4(z.center,z.center,B),ie.transformMat4(je,je,B);const nt=[z.center[0],z.center[1],je[2]*u.pixelsPerMeter];ie.scale(nt,nt,1/u.worldSize);const wt=Hi(nt[0]),pt=zn(nt[1]),dt=Math.min(u._zoomFromMercatorZ(nt[2]),d.maxZoom),Et=new zt(wt,pt);return u.mercatorFromTransition&&dt<.5*(Ad+Zs)?(u.setProjection({name:"globe"}),u.zoom=dt,this._cameraForBounds(u,r,i,a,s,c)):{center:Et,zoom:dt,bearing:a,pitch:s}}fitBounds(e,r,i){const a=this.cameraForBounds(e,r);return this._fitInternal(a,r,i)}fitScreenCoordinates(e,r,i,a,s){const c=$.convert(e),u=$.convert(r),d=new $(Math.min(c.x,u.x),Math.min(c.y,u.y)),p=new $(Math.max(c.x,u.x),Math.max(c.y,u.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(c,u))return this;const m=this.transform.pointLocation3D(d),_=this.transform.pointLocation3D(p),y=this.transform.pointLocation3D(new $(d.x,p.y)),v=this.transform.pointLocation3D(new $(p.x,d.y)),b=[Math.min(m.lng,_.lng,y.lng,v.lng),Math.min(m.lat,_.lat,y.lat,v.lat)],S=[Math.max(m.lng,_.lng,y.lng,v.lng),Math.max(m.lat,_.lat,y.lat,v.lat)],T=a&&a.pitch?a.pitch:this.getPitch(),M=this._cameraForBounds(this.transform,b,S,i,T,a);return this._fitInternal(M,a,s)}_fitInternal(e,r,i){return e?(delete(r=Oe(e,r)).padding,r.linear?this.easeTo(r,i):this.flyTo(r,i)):this}jumpTo(e,r){this.stop();const i=e.preloadOnly?this.transform.clone():this.transform;let a=!1,s=!1,c=!1;return"zoom"in e&&i.zoom!==+e.zoom&&(a=!0,i.zoom=+e.zoom),e.center!==void 0&&(i.center=zt.convert(e.center)),"bearing"in e&&i.bearing!==+e.bearing&&(s=!0,i.bearing=+e.bearing),"pitch"in e&&i.pitch!==+e.pitch&&(c=!0,i.pitch=+e.pitch),e.padding==null||i.isPaddingEqual(e.padding)||(i.padding=e.padding),e.preloadOnly?(this._preloadTiles(i),this):(this.fire(new Ee("movestart",r)).fire(new Ee("move",r)),a&&this.fire(new Ee("zoomstart",r)).fire(new Ee("zoom",r)).fire(new Ee("zoomend",r)),s&&this.fire(new Ee("rotatestart",r)).fire(new Ee("rotate",r)).fire(new Ee("rotateend",r)),c&&this.fire(new Ee("pitchstart",r)).fire(new Ee("pitch",r)).fire(new Ee("pitchend",r)),this.fire(new Ee("moveend",r)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||re(MA),this.transform.getFreeCameraOptions()}setFreeCameraOptions(e,r){const i=this.transform;if(!i.projection.supportsFreeCamera)return re(MA),this;this.stop();const a=i.zoom,s=i.pitch,c=i.bearing;i.setFreeCameraOptions(e);const u=a!==i.zoom,d=s!==i.pitch,p=c!==i.bearing;return this.fire(new Ee("movestart",r)).fire(new Ee("move",r)),u&&this.fire(new Ee("zoomstart",r)).fire(new Ee("zoom",r)).fire(new Ee("zoomend",r)),p&&this.fire(new Ee("rotatestart",r)).fire(new Ee("rotate",r)).fire(new Ee("rotateend",r)),d&&this.fire(new Ee("pitchstart",r)).fire(new Ee("pitch",r)).fire(new Ee("pitchend",r)),this.fire(new Ee("moveend",r)),this}easeTo(e,r){this._stop(!1,e.easeId),((e=Oe({offset:[0,0],duration:500,easing:Xe},e)).animate===!1||this._prefersReducedMotion(e))&&(e.duration=0);const i=this.transform,a=this.getZoom(),s=this.getBearing(),c=this.getPitch(),u=this.getPadding(),d="zoom"in e?+e.zoom:a,p="bearing"in e?this._normalizeBearing(e.bearing,s):s,m="pitch"in e?+e.pitch:c,_="padding"in e?e.padding:i.padding,y=$.convert(e.offset);let v,b,S;if(i.projection.name==="globe"){const Z=cr.fromLngLat(i.center),X=y.rotate(-i.angle);Z.x+=X.x/i.worldSize,Z.y+=X.y/i.worldSize;const H=Z.toLngLat(),J=zt.convert(e.center||H);this._normalizeCenter(J),v=i.centerPoint.add(X),b=new $(Z.x,Z.y).mult(i.worldSize),S=new $(ei(J.lng),ai(J.lat)).mult(i.worldSize).sub(b)}else{v=i.centerPoint.add(y);const Z=i.pointLocation(v),X=zt.convert(e.center||Z);this._normalizeCenter(X),b=i.project(Z),S=i.project(X).sub(b)}const T=i.zoomScale(d-a);let M,C;e.around&&(M=zt.convert(e.around),C=i.locationPoint(M));const P=this._zooming||d!==a,k=this._rotating||s!==p,z=this._pitching||m!==c,L=!i.isPaddingEqual(_),B=Z=>X=>{if(P&&(Z.zoom=Ft(a,d,X)),k&&(Z.bearing=Ft(s,p,X)),z&&(Z.pitch=Ft(c,m,X)),L&&(Z.interpolatePadding(u,_,X),v=Z.centerPoint.add(y)),M)Z.setLocationAtPoint(M,C);else{const H=Z.zoomScale(Z.zoom-a),J=d>a?Math.min(2,T):Math.max(.5,T),Q=Math.pow(J,1-X),K=Z.unproject(b.add(S.mult(X*Q)).mult(H));Z.setLocationAtPoint(Z.renderWorldCopies?K.wrap():K,v)}return e.preloadOnly||this._fireMoveEvents(r),Z};if(e.preloadOnly){const Z=this._emulate(B,e.duration,i);return this._preloadTiles(Z),this}const W={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=P,this._rotating=k,this._pitching=z,this._padding=L,this._easeId=e.easeId,this._prepareEase(r,e.noMoveStart,W),this._ease(B(i),Z=>{i.recenterOnTerrain(),this._afterEase(r,Z)},e),this}_prepareEase(e,r,i={}){this._moving=!0,this.transform.cameraElevationReference="sea",r||i.moving||this.fire(new Ee("movestart",e)),this._zooming&&!i.zooming&&this.fire(new Ee("zoomstart",e)),this._rotating&&!i.rotating&&this.fire(new Ee("rotatestart",e)),this._pitching&&!i.pitching&&this.fire(new Ee("pitchstart",e))}_fireMoveEvents(e){this.fire(new Ee("move",e)),this._zooming&&this.fire(new Ee("zoom",e)),this._rotating&&this.fire(new Ee("rotate",e)),this._pitching&&this.fire(new Ee("pitch",e))}_afterEase(e,r){if(this._easeId&&r&&this._easeId===r)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const i=this._zooming,a=this._rotating,s=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,i&&this.fire(new Ee("zoomend",e)),a&&this.fire(new Ee("rotateend",e)),s&&this.fire(new Ee("pitchend",e)),this.fire(new Ee("moveend",e))}flyTo(e,r){if(this._prefersReducedMotion(e)){const me=qt(e,["center","zoom","bearing","pitch","around"]);return this.jumpTo(me,r)}this.stop(),e=Oe({offset:[0,0],speed:1.2,curve:1.42,easing:Xe},e);const i=this.transform,a=this.getZoom(),s=this.getBearing(),c=this.getPitch(),u=this.getPadding(),d="zoom"in e?ze(+e.zoom,i.minZoom,i.maxZoom):a,p="bearing"in e?this._normalizeBearing(e.bearing,s):s,m="pitch"in e?+e.pitch:c,_="padding"in e?e.padding:i.padding,y=i.zoomScale(d-a),v=$.convert(e.offset);let b=i.centerPoint.add(v);const S=i.pointLocation(b),T=zt.convert(e.center||S);this._normalizeCenter(T);const M=i.project(S),C=i.project(T).sub(M);let P=e.curve;const k=Math.max(i.width,i.height),z=k/y,L=C.mag();if("minZoom"in e){const me=ze(Math.min(e.minZoom,a,d),i.minZoom,i.maxZoom),ve=k/i.zoomScale(me-a);P=Math.sqrt(ve/L*2)}const B=P*P;function W(me){const ve=(z*z-k*k+(me?-1:1)*B*B*L*L)/(2*(me?z:k)*B*L);return Math.log(Math.sqrt(ve*ve+1)-ve)}function Z(me){return(Math.exp(me)-Math.exp(-me))/2}function X(me){return(Math.exp(me)+Math.exp(-me))/2}const H=W(0);let J=function(me){return X(H)/X(H+P*me)},Q=function(me){return k*((X(H)*(Z(ve=H+P*me)/X(ve))-Z(H))/B)/L;var ve},K=(W(1)-H)/P;if(Math.abs(L)<1e-6||!isFinite(K)){if(Math.abs(k-z)<1e-6)return this.easeTo(e,r);const me=z<k?-1:1;K=Math.abs(Math.log(z/k))/P,Q=function(){return 0},J=function(ve){return Math.exp(me*P*ve)}}e.duration="duration"in e?+e.duration:1e3*K/("screenSpeed"in e?+e.screenSpeed/P:+e.speed),e.maxDuration&&e.duration>e.maxDuration&&(e.duration=0);const fe=s!==p,he=m!==c,_e=!i.isPaddingEqual(_),oe=me=>ve=>{const Ce=ve*K,Se=1/J(Ce);me.zoom=ve===1?d:a+me.scaleZoom(Se),fe&&(me.bearing=Ft(s,p,ve)),he&&(me.pitch=Ft(c,m,ve)),_e&&(me.interpolatePadding(u,_,ve),b=me.centerPoint.add(v));const Je=ve===1?T:me.unproject(M.add(C.mult(Q(Ce))).mult(Se));return me.setLocationAtPoint(me.renderWorldCopies?Je.wrap():Je,b),me._updateCameraOnTerrain(),e.preloadOnly||this._fireMoveEvents(r),me};if(e.preloadOnly){const me=this._emulate(oe,e.duration,i);return this._preloadTiles(me),this}return this._zooming=!0,this._rotating=fe,this._pitching=he,this._padding=_e,this._prepareEase(r,!1),this._ease(oe(i),()=>this._afterEase(r),e),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(e,r){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const i=this._onEaseEnd;this._onEaseEnd=void 0,i.call(this,r)}if(!e){const i=this.handlers;i&&i.stop(!1)}return this}_ease(e,r,i){i.animate===!1||i.duration===0?(e(1),r()):(this._easeStart=Ot.now(),this._easeOptions=i,this._onEaseFrame=e,this._onEaseEnd=r,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const e=Math.min((Ot.now()-this._easeStart)/this._easeOptions.duration,1),r=this._onEaseFrame;r&&r(this._easeOptions.easing(e)),e<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(e,r){e=Pt(e,-180,180);const i=Math.abs(e-r);return Math.abs(e-360-r)<i&&(e-=360),Math.abs(e+360-r)<i&&(e+=360),e}_normalizeCenter(e){const r=this.transform;if(!r.renderWorldCopies||r.maxBounds)return;const i=e.lng-r.center.lng;e.lng+=i>180?-360:i<-180?360:0}_prefersReducedMotion(e){return this._respectPrefersReducedMotion&&Ot.prefersReducedMotion&&!(e&&e.essential)}_emulate(e,r,i){const a=Math.ceil(15*r/1e3),s=[],c=e(i.clone());for(let u=0;u<=a;u++){const d=c(u/a);s.push(d.clone())}return s}}class CA{constructor(e={}){this.options=e,ar(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(e){const r=this.options&&this.options.compact;return this._map=e,this._container=Tr("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Tr("button","mapboxgl-ctrl-attrib-button",this._container),Tr("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Tr("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),r&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),r===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(e,r){const i=this._map._getUIString(`AttributionControl.${r}`);e.setAttribute("aria-label",i),e.removeAttribute("title"),e.firstElementChild&&e.firstElementChild.setAttribute("title",i)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let e=this._editLink;e||(e=this._editLink=this._container.querySelector(".mapbox-improve-map"));const r=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||D.ACCESS_TOKEN}];if(e){const i=r.reduce((a,s,c)=>(s.value&&(a+=`${s.key}=${s.value}${c<r.length-1?"&":""}`),a),"?");e.href=`${D.FEEDBACK_URL}/${i}#${xA(this._map,!0)}`,e.rel="noopener nofollow",this._setElementTitle(e,"MapFeedback")}}_updateData(e){!e||e.sourceDataType!=="metadata"&&e.sourceDataType!=="visibility"&&e.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let e=[];if(this._map.style.stylesheet){const a=this._map.style.stylesheet;this.styleOwner=a.owner,this.styleId=a.id}const r=this._map.style._sourceCaches;for(const a in r){const s=r[a];if(s.used){const c=s.getSource();c.attribution&&e.indexOf(c.attribution)<0&&e.push(c.attribution)}}e.sort((a,s)=>a.length-s.length),e=e.filter((a,s)=>{for(let c=s+1;c<e.length;c++)if(e[c].indexOf(a)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?e=[...this.options.customAttribution,...e]:e.unshift(this.options.customAttribution));const i=e.join(" | ");i!==this._attribHTML&&(this._attribHTML=i,e.length?(this._innerContainer.innerHTML=i,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class AA{constructor(){ar(["_updateLogo","_updateCompact"],this)}onAdd(e){this._map=e,this._container=Tr("div","mapboxgl-ctrl");const r=Tr("a","mapboxgl-ctrl-logo");return r.target="_blank",r.rel="noopener nofollow",r.href="https://www.mapbox.com/",r.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),r.setAttribute("rel","noopener nofollow"),this._container.appendChild(r),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(e){e&&e.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const e=this._map.style._sourceCaches;if(Object.entries(e).length===0)return!0;for(const r in e){const i=e[r].getSource();if(i.hasOwnProperty("mapbox_logo")&&!i.mapbox_logo)return!1}return!0}_updateCompact(){const e=this._container.children;if(e.length){const r=e[0];this._map.getCanvasContainer().offsetWidth<250?r.classList.add("mapboxgl-compact"):r.classList.remove("mapboxgl-compact")}}}class IA{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(e){const r=++this._id;return this._queue.push({callback:e,id:r,cancelled:!1}),r}remove(e){const r=this._currentlyRunning,i=r?this._queue.concat(r):this._queue;for(const a of i)if(a.id===e)return void(a.cancelled=!0)}run(e=0){const r=this._currentlyRunning=this._queue;this._queue=[];for(const i of r)if(!i.cancelled&&(i.callback(e),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function PA(t,e,r){if(t=new zt(t.lng,t.lat),e){const i=new zt(t.lng-360,t.lat),a=new zt(t.lng+360,t.lat),s=360*Math.ceil(Math.abs(t.lng-r.center.lng)/360),c=r.locationPoint(t).distSqr(e),u=e.x<0||e.y<0||e.x>r.width||e.y>r.height;r.locationPoint(i).distSqr(e)<c&&(u||Math.abs(i.lng-r.center.lng)<s)?t=i:r.locationPoint(a).distSqr(e)<c&&(u||Math.abs(a.lng-r.center.lng)<s)&&(t=a)}for(;Math.abs(t.lng-r.center.lng)>180;){const i=r.locationPoint(t);if(i.x>=0&&i.y>=0&&i.x<=r.width&&i.y<=r.height)break;t.lng>r.center.lng?t.lng-=360:t.lng+=360}return t}const Bx={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Nx extends dr{constructor(e,r){if(super(),(e instanceof w.HTMLElement||r)&&(e=Oe({element:e},r)),ar(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=e&&e.anchor||"center",this._color=e&&e.color||"#3FB1CE",this._scale=e&&e.scale||1,this._draggable=e&&e.draggable||!1,this._clickTolerance=e&&e.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=e&&e.rotation||0,this._rotationAlignment=e&&e.rotationAlignment||"auto",this._pitchAlignment=e&&e.pitchAlignment&&e.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=e&&e.occludedOpacity||.2,e&&e.element)this._element=e.element,this._offset=$.convert(e&&e.offset||[0,0]);else{this._defaultMarker=!0,this._element=Tr("div");const s=41,c=27,u=gi("svg",{display:"block",height:s*this._scale+"px",width:c*this._scale+"px",viewBox:`0 0 ${c} ${s}`},this._element),d=gi("radialGradient",{id:"shadowGradient"},gi("defs",{},u));gi("stop",{offset:"10%","stop-opacity":.4},d),gi("stop",{offset:"100%","stop-opacity":.05},d),gi("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},u),gi("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},u),gi("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},u),gi("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},u),this._offset=$.convert(e&&e.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",s=>{s.preventDefault()}),this._element.addEventListener("mousedown",s=>{s.preventDefault()});const i=this._element.classList;for(const s in Bx)i.remove(`mapboxgl-marker-anchor-${s}`);i.add(`mapboxgl-marker-anchor-${this._anchor}`);const a=e&&e.className?e.className.trim().split(/\s+/):[];i.add(...a),this._popup=null}addTo(e){return e===this._map||(this.remove(),this._map=e,e.getCanvasContainer().appendChild(this._element),e.on("move",this._updateMoving),e.on("moveend",this._update),e.on("remove",this._clearFadeTimer),e._addMarker(this),this.setDraggable(this._draggable),this._update(),e.on("click",this._onMapClick)),this}remove(){const e=this._map;return e&&(e.off("click",this._onMapClick),e.off("move",this._updateMoving),e.off("moveend",this._update),e.off("mousedown",this._addDragHandler),e.off("touchstart",this._addDragHandler),e.off("mouseup",this._onUp),e.off("touchend",this._onUp),e.off("mousemove",this._onMove),e.off("touchmove",this._onMove),e.off("remove",this._clearFadeTimer),e._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(e){return this._lngLat=zt.convert(e),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(e){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),e){if(!("offset"in e.options)){const a=Math.sqrt(Math.pow(13.5,2)/2);e.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[a,-1*(38.1-13.5+a)],"bottom-right":[-a,-1*(38.1-13.5+a)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=e,e._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(e){const r=e.code,i=e.charCode||e.keyCode;r!=="Space"&&r!=="Enter"&&i!==32&&i!==13||this.togglePopup()}_onMapClick(e){const r=e.originalEvent.target,i=this._element;this._popup&&(r===i||i.contains(r))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const e=this._popup;return e?(e.isOpen()?(e.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(e.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const e=this._map,r=this._pos;if(!e||!r)return!1;const i=e.unproject(r),a=e.getFreeCameraOptions();if(!a.position)return!1;const s=a.position.toLngLat();return s.distanceTo(i)<.9*s.distanceTo(this._lngLat)}_evaluateOpacity(){const e=this._map;if(!e)return;const r=this._pos;if(!r||r.x<0||r.x>e.transform.width||r.y<0||r.y>e.transform.height)return void this._clearFadeTimer();const i=e.unproject(r);let a;e._showingGlobe()&&Mm(e.transform,this._lngLat)?a=0:(a=1-e._queryFogOpacity(i),e.transform._terrainEnabled()&&e.getTerrain()&&this._behindTerrain()&&(a*=this._occludedOpacity)),this._element.style.opacity=`${a}`,this._element.style.pointerEvents=a>0?"auto":"none",this._popup&&this._popup._setOpacity(a),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const e=this._pos;if(!e||!this._map)return;const r=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${e.x}px,${e.y}px)
            ${Bx[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${r.x}px,${r.y}px)
        `}_calculateXYTransform(){const e=this._pos,r=this._map,i=this.getPitchAlignment();if(!r||!e||i!=="map")return"";if(!r._showingGlobe()){const d=r.getPitch();return d?`rotateX(${d}deg)`:""}const a=ke(ET(r.transform,this._lngLat)),s=e.sub(wT(r.transform)),c=Math.abs(s.x)+Math.abs(s.y);if(c===0)return"";const u=a/c;return`rotateX(${-s.y*u}deg) rotateY(${s.x*u}deg)`}_calculateZTransform(){const e=this._pos,r=this._map;if(!r||!e)return"";let i=0;const a=this.getRotationAlignment();if(a==="map")if(r._showingGlobe()){const s=r.project(new zt(this._lngLat.lng,this._lngLat.lat+.001)),c=r.project(new zt(this._lngLat.lng,this._lngLat.lat-.001)).sub(s);i=ke(Math.atan2(c.y,c.x))-90}else i=-r.getBearing();else if(a==="horizon"){const s=at(4,6,r.getZoom()),c=wT(r.transform);c.y+=s*r.transform.height;const u=e.sub(c),d=ke(Math.atan2(u.y,u.x));i=(d>90?d-270:d+90)*(1-s)}return i+=this._rotation,i?`rotateZ(${i}deg)`:""}_update(e){w.cancelAnimationFrame(this._updateFrameId);const r=this._map;r&&(r.transform.renderWorldCopies&&(this._lngLat=PA(this._lngLat,this._pos,r.transform)),this._pos=r.project(this._lngLat),e===!0?this._updateFrameId=w.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),r._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(r._showingGlobe()||r.getTerrain()||r.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(e){return this._offset=$.convert(e),this._update(),this}addClassName(e){return this._element.classList.add(e),this}removeClassName(e){return this._element.classList.remove(e),this}toggleClassName(e){return this._element.classList.toggle(e)}_onMove(e){const r=this._map;if(!r)return;const i=this._pointerdownPos,a=this._positionDelta;if(i&&a){if(!this._isDragging){const s=this._clickTolerance||r._clickTolerance;if(e.point.dist(i)<s)return;this._isDragging=!0}this._pos=e.point.sub(a),this._lngLat=r.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new Ee("dragstart"))),this.fire(new Ee("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const e=this._map;e&&(e.off("mousemove",this._onMove),e.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new Ee("dragend")),this._state="inactive"}_addDragHandler(e){const r=this._map,i=this._pos;r&&i&&this._element.contains(e.originalEvent.target)&&(e.preventDefault(),this._positionDelta=e.point.sub(i),this._pointerdownPos=e.point,this._state="pending",r.on("mousemove",this._onMove),r.on("touchmove",this._onMove),r.once("mouseup",this._onUp),r.once("touchend",this._onUp))}setDraggable(e){this._draggable=!!e;const r=this._map;return r&&(e?(r.on("mousedown",this._addDragHandler),r.on("touchstart",this._addDragHandler)):(r.off("mousedown",this._addDragHandler),r.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(e){return this._rotation=e||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(e){return this._rotationAlignment=e||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(e){return this._pitchAlignment=e||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(e){return this._occludedOpacity=e||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const $j={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Vj=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function kA(t=new $(0,0),e="bottom"){if(typeof t=="number"){const r=Math.round(Math.sqrt(.5*Math.pow(t,2)));switch(e){case"top":return new $(0,t);case"top-left":return new $(r,r);case"top-right":return new $(-r,r);case"bottom":return new $(0,-t);case"bottom-left":return new $(r,-r);case"bottom-right":return new $(-r,-r);case"left":return new $(t,0);case"right":return new $(-t,0)}return new $(0,0)}return t instanceof $||Array.isArray(t)?$.convert(t):$.convert(t[e]||[0,0])}class Uj{constructor(e){this.jumpTo(e)}getValue(e){if(e<=this._startTime)return this._start;if(e>=this._endTime)return this._end;const r=Ne((e-this._startTime)/(this._endTime-this._startTime));return this._start*(1-r)+this._end*r}isEasing(e){return e>=this._startTime&&e<=this._endTime}jumpTo(e){this._startTime=-1/0,this._endTime=-1/0,this._start=e,this._end=e}easeTo(e,r,i){this._start=this.getValue(r),this._end=e,this._startTime=r,this._endTime=r+i}}const Gj={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Wj={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,useWebGL2:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1},Hj={showCompass:!0,showZoom:!0,visualizePitch:!1};class qj{constructor(e,r,i=!1){this._clickTolerance=10,this.element=r,this.mouseRotate=new bA({clickTolerance:e.dragRotate._mouseRotate._clickTolerance}),this.map=e,i&&(this.mousePitch=new wA({clickTolerance:e.dragRotate._mousePitch._clickTolerance})),ar(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),r.addEventListener("mousedown",this.mousedown),r.addEventListener("touchstart",this.touchstart,{passive:!1}),r.addEventListener("touchmove",this.touchmove),r.addEventListener("touchend",this.touchend),r.addEventListener("touchcancel",this.reset)}down(e,r){this.mouseRotate.mousedown(e,r),this.mousePitch&&this.mousePitch.mousedown(e,r),zs()}move(e,r){const i=this.map,a=this.mouseRotate.mousemoveWindow(e,r),s=a&&a.bearingDelta;if(s&&i.setBearing(i.getBearing()+s),this.mousePitch){const c=this.mousePitch.mousemoveWindow(e,r),u=c&&c.pitchDelta;u&&i.setPitch(i.getPitch()+u)}}off(){const e=this.element;e.removeEventListener("mousedown",this.mousedown),e.removeEventListener("touchstart",this.touchstart,{passive:!1}),e.removeEventListener("touchmove",this.touchmove),e.removeEventListener("touchend",this.touchend),e.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Hl(),w.removeEventListener("mousemove",this.mousemove),w.removeEventListener("mouseup",this.mouseup)}mousedown(e){this.down(Oe({},e,{ctrlKey:!0,preventDefault:()=>e.preventDefault()}),Co(this.element,e)),w.addEventListener("mousemove",this.mousemove),w.addEventListener("mouseup",this.mouseup)}mousemove(e){this.move(e,Co(this.element,e))}mouseup(e){this.mouseRotate.mouseupWindow(e),this.mousePitch&&this.mousePitch.mouseupWindow(e),this.offTemp()}touchstart(e){e.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Ea(this.element,e.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>e.preventDefault()},this._startPos))}touchmove(e){e.targetTouches.length!==1?this.reset():(this._lastPos=Ea(this.element,e.targetTouches)[0],this.move({preventDefault:()=>e.preventDefault()},this._lastPos))}touchend(e){e.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Zj={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Xj={maxWidth:100,unit:"metric"},Yj={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Dg={version:I,supported:qc,setRTLTextPlugin:function(t,e,r=!1){if(Ui===b1||Ui===w1||Ui===E1)throw new Error("setRTLTextPlugin cannot be called multiple times.");Fs=Ot.resolveURL(t),Ui=b1,S1=e,T1(),r||PS()},getRTLTextPluginStatus:C1,Map:class extends jj{constructor(t){if(Vl.mark(Is.create),(t=Oe({},Wj,t)).minZoom!=null&&t.maxZoom!=null&&t.minZoom>t.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(t.minPitch!=null&&t.maxPitch!=null&&t.minPitch>t.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(t.minPitch!=null&&t.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(t.maxPitch!=null&&t.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(t.antialias&&function(e){const r=e.navigator?e.navigator.userAgent:null;return!!At(e)&&r&&(r.match("Version/15.4")||r.match("Version/15.5")||r.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))}(w)&&(t.antialias=!1,re("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new rx(t.minZoom,t.maxZoom,t.minPitch,t.maxPitch,t.renderWorldCopies),t),this._interactive=t.interactive,this._minTileCacheSize=t.minTileCacheSize,this._maxTileCacheSize=t.maxTileCacheSize,this._failIfMajorPerformanceCaveat=t.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=t.preserveDrawingBuffer,this._antialias=t.antialias,this._useWebGL2=t.useWebGL2,this._trackResize=t.trackResize,this._bearingSnap=t.bearingSnap,this._refreshExpiredTiles=t.refreshExpiredTiles,this._fadeDuration=t.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=t.crossSourceCollisions,this._collectResourceTiming=t.collectResourceTiming,this._optimizeForTerrain=t.optimizeForTerrain,this._language=this._parseLanguage(t.language),this._worldview=t.worldview,this._renderTaskQueue=new IA,this._domRenderTaskQueue=new IA,this._controls=[],this._markers=[],this._popups=[],this._mapId=Ir(),this._locale=Oe({},Gj,t.locale),this._clickTolerance=t.clickTolerance,this._cooperativeGestures=t.cooperativeGestures,this._performanceMetricsCollection=t.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Uj(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new _r(t.transformRequest,t.accessToken,t.testMode),this._silenceAuthErrors=!!t.testMode,typeof t.container=="string"){if(this._container=w.document.getElementById(t.container),!this._container)throw new Error(`Container '${t.container.toString()}' not found.`)}else{if(!(t.container instanceof w.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=t.container}if(this._container.childNodes.length>0&&re("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),t.maxBounds&&this.setMaxBounds(t.maxBounds),ar(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),w!==void 0&&(this._fullscreenchangeEvent="onfullscreenchange"in w.document?"fullscreenchange":"webkitfullscreenchange",w.addEventListener("online",this._onWindowOnline,!1),w.addEventListener("resize",this._onWindowResize,!1),w.addEventListener("orientationchange",this._onWindowResize,!1),w.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),w.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Nj(this,t),this._localFontFamily=t.localFontFamily,this._localIdeographFontFamily=t.localIdeographFontFamily,(t.style||!t.testMode)&&this.setStyle(t.style||D.DEFAULT_STYLE,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),t.projection&&this.setProjection(t.projection),t.hash&&(this._hash=new cj(typeof t.hash=="string"&&t.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){this.jumpTo({center:t.center,zoom:t.zoom,bearing:t.bearing,pitch:t.pitch});const e=t.bounds;e&&(this.resize(),this.fitBounds(e,Oe({},t.fitBoundsOptions,{duration:0})))}this.resize(),t.attributionControl&&this.addControl(new CA({customAttribution:t.customAttribution})),this._logoControl=new AA,this.addControl(this._logoControl,t.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",e=>{this._update(e.dataType==="style"),this.fire(new Ee(`${e.dataType}data`,e))}),this.on("dataloading",e=>{this.fire(new Ee(`${e.dataType}dataloading`,e))})}_getMapId(){return this._mapId}addControl(t,e){if(e===void 0&&(e=t.getDefaultPosition?t.getDefaultPosition():"top-right"),!t||!t.onAdd)return this.fire(new rt(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const r=t.onAdd(this);this._controls.push(t);const i=this._controlPositions[e];return e.indexOf("bottom")!==-1?i.insertBefore(r,i.firstChild):i.appendChild(r),this}removeControl(t){if(!t||!t.onRemove)return this.fire(new rt(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const e=this._controls.indexOf(t);return e>-1&&this._controls.splice(e,1),t.onRemove(this),this}hasControl(t){return this._controls.indexOf(t)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(t){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const e=!this._moving;return e&&this.fire(new Ee("movestart",t)).fire(new Ee("move",t)),this.fire(new Ee("resize",t)),e&&this.fire(new Ee("moveend",t)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(t){return this.transform.setMaxBounds(lo.convert(t)),this._update()}setMinZoom(t){if((t=t??-2)>=-2&&t<=this.transform.maxZoom)return this.transform.minZoom=t,this._update(),this.getZoom()<t?this.setZoom(t):this.fire(new Ee("zoomstart")).fire(new Ee("zoom")).fire(new Ee("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(t){if((t=t??22)>=this.transform.minZoom)return this.transform.maxZoom=t,this._update(),this.getZoom()>t?this.setZoom(t):this.fire(new Ee("zoomstart")).fire(new Ee("zoom")).fire(new Ee("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(t){if((t=t??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(t>=0&&t<=this.transform.maxPitch)return this.transform.minPitch=t,this._update(),this.getPitch()<t?this.setPitch(t):this.fire(new Ee("pitchstart")).fire(new Ee("pitch")).fire(new Ee("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(t){if((t=t??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(t>=this.transform.minPitch)return this.transform.maxPitch=t,this._update(),this.getPitch()>t?this.setPitch(t):this.fire(new Ee("pitchstart")).fire(new Ee("pitch")).fire(new Ee("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(t){return this.transform.renderWorldCopies=t,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(t){return t==="auto"?w.navigator.language:Array.isArray(t)?t.length===0?void 0:t.map(e=>e==="auto"?w.navigator.language:e):t}setLanguage(t){const e=this._parseLanguage(t);if(!this.style||e===this._language)return this;this._language=e,this.style._reloadSources();for(const r of this._controls)r._setLanguage&&r._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(t){return this.style&&t!==this._worldview?(this._worldview=t,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(t){return this._lazyInitEmptyStyle(),t?typeof t=="string"&&(t={name:t}):t=null,this._useExplicitProjection=!!t,this._prioritizeAndUpdateProjection(t,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const t=this.transform,e=t.projection.name;let r;e==="globe"&&t.zoom>=Zs?(t.setMercatorFromTransition(),r=!0):e==="mercator"&&t.zoom<Zs&&(t.setProjection({name:"globe"}),r=!0),r&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(t,e){return this._updateProjection(t||e||{name:"mercator"})}_updateProjection(t){let e;if(e=t.name==="globe"&&this.transform.zoom>=Zs?this.transform.setMercatorFromTransition():this.transform.setProjection(t),this.style.applyProjectionUpdate(),e){this.painter.clearBackgroundTiles();for(const r in this.style._sourceCaches)this.style._sourceCaches[r].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(t){return this.transform.locationPoint3D(zt.convert(t))}unproject(t){return this.transform.pointLocation3D($.convert(t))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(t,e,r){if(t==="mouseenter"||t==="mouseover"){let i=!1;const a=c=>{const u=e.filter(p=>this.getLayer(p)),d=u.length?this.queryRenderedFeatures(c.point,{layers:u}):[];d.length?i||(i=!0,r.call(this,new ho(t,this,c.originalEvent,{features:d}))):i=!1},s=()=>{i=!1};return{layers:new Set(e),listener:r,delegates:{mousemove:a,mouseout:s}}}if(t==="mouseleave"||t==="mouseout"){let i=!1;const a=c=>{const u=e.filter(d=>this.getLayer(d));(u.length?this.queryRenderedFeatures(c.point,{layers:u}):[]).length?i=!0:i&&(i=!1,r.call(this,new ho(t,this,c.originalEvent)))},s=c=>{i&&(i=!1,r.call(this,new ho(t,this,c.originalEvent)))};return{layers:new Set(e),listener:r,delegates:{mousemove:a,mouseout:s}}}{const i=a=>{const s=e.filter(u=>this.getLayer(u)),c=s.length?this.queryRenderedFeatures(a.point,{layers:s}):[];c.length&&(a.features=c,r.call(this,a),delete a.features)};return{layers:new Set(e),listener:r,delegates:{[t]:i}}}}on(t,e,r){if(r===void 0)return super.on(t,e);Array.isArray(e)||(e=[e]);const i=this._createDelegatedListener(t,e,r);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[t]=this._delegatedListeners[t]||[],this._delegatedListeners[t].push(i);for(const a in i.delegates)this.on(a,i.delegates[a]);return this}once(t,e,r){if(r===void 0)return super.once(t,e);Array.isArray(e)||(e=[e]);const i=this._createDelegatedListener(t,e,r);for(const a in i.delegates)this.once(a,i.delegates[a]);return this}off(t,e,r){if(r===void 0)return super.off(t,e);e=new Set(Array.isArray(e)?e:[e]);const i=(s,c)=>{if(s.size!==c.size)return!1;for(const u of s)if(!c.has(u))return!1;return!0},a=this._delegatedListeners?this._delegatedListeners[t]:void 0;return a&&(s=>{for(let c=0;c<s.length;c++){const u=s[c];if(u.listener===r&&i(u.layers,e)){for(const d in u.delegates)this.off(d,u.delegates[d]);return s.splice(c,1),this}}})(a),this}queryRenderedFeatures(t,e){return this.style?(e!==void 0||t===void 0||t instanceof $||Array.isArray(t)||(e=t,t=void 0),this.style.queryRenderedFeatures(t=t||[[0,0],[this.transform.width,this.transform.height]],e=e||{},this.transform)):[]}querySourceFeatures(t,e){return this.style.querySourceFeatures(t,e)}isPointOnSurface(t){const{name:e}=this.transform.projection;return e!=="globe"&&e!=="mercator"&&re(`${e} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface($.convert(t))}setStyle(t,e){return(e=Oe({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},e)).diff!==!1&&e.localIdeographFontFamily===this._localIdeographFontFamily&&e.localFontFamily===this._localFontFamily&&this.style&&t?(this._diffStyle(t,e),this):(this._localIdeographFontFamily=e.localIdeographFontFamily,this._localFontFamily=e.localFontFamily,this._updateStyle(t,e))}_getUIString(t){const e=this._locale[t];if(e==null)throw new Error(`Missing UI string '${t}'`);return e}_updateStyle(t,e){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),t&&(this.style=new oa(this,e||{}),this.style.setEventedParent(this,{style:this.style}),typeof t=="string"?this.style.loadURL(t):this.style.loadJSON(t)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new oa(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(t,e){if(typeof t=="string"){const r=this._requestManager.normalizeStyleURL(t),i=this._requestManager.transformRequest(r,be.Style);qe(i,(a,s)=>{a?this.fire(new rt(a)):s&&this._updateDiff(s,e)})}else typeof t=="object"&&this._updateDiff(t,e)}_updateDiff(t,e){try{this.style.setState(t)&&this._update(!0)}catch(r){re(`Unable to perform style diff: ${r.message||r.error||r}.  Rebuilding the style from scratch.`),this._updateStyle(t,e)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(re("There is no style added to the map."),!1)}addSource(t,e){return this._lazyInitEmptyStyle(),this.style.addSource(t,e),this._update(!0)}isSourceLoaded(t){return!!this.style&&this.style._isSourceCacheLoaded(t)}areTilesLoaded(){const t=this.style&&this.style._sourceCaches;for(const e in t){const r=t[e]._tiles;for(const i in r){const a=r[i];if(a.state!=="loaded"&&a.state!=="errored")return!1}}return!0}addSourceType(t,e,r){this._lazyInitEmptyStyle(),this.style.addSourceType(t,e,r)}removeSource(t){return this.style.removeSource(t),this._updateTerrain(),this._update(!0)}getSource(t){return this.style.getOwnSource(t)}addImage(t,e,{pixelRatio:r=1,sdf:i=!1,stretchX:a,stretchY:s,content:c}={}){if(this._lazyInitEmptyStyle(),e instanceof w.HTMLImageElement||w.ImageBitmap&&e instanceof w.ImageBitmap){const{width:u,height:d,data:p}=Ot.getImageData(e);this.style.addImage(t,{data:new Sn({width:u,height:d},p),pixelRatio:r,stretchX:a,stretchY:s,content:c,sdf:i,version:0})}else if(e.width===void 0||e.height===void 0)this.fire(new rt(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:u,height:d}=e,p=e;this.style.addImage(t,{data:new Sn({width:u,height:d},new Uint8Array(p.data)),pixelRatio:r,stretchX:a,stretchY:s,content:c,sdf:i,version:0,userImage:p}),p.onAdd&&p.onAdd(this,t)}}updateImage(t,e){const r=this.style.getImage(t);if(!r)return void this.fire(new rt(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const i=e instanceof w.HTMLImageElement||w.ImageBitmap&&e instanceof w.ImageBitmap?Ot.getImageData(e):e,{width:a,height:s}=i;a!==void 0&&s!==void 0?a===r.data.width&&s===r.data.height?(r.data.replace(i.data,!(e instanceof w.HTMLImageElement||w.ImageBitmap&&e instanceof w.ImageBitmap)),this.style.updateImage(t,r)):this.fire(new rt(new Error(`The width and height of the updated image (${a}, ${s})
                must be that same as the previous version of the image
                (${r.data.width}, ${r.data.height})`))):this.fire(new rt(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(t){return t?!!this.style.getImage(t):(this.fire(new rt(new Error("Missing required image id"))),!1)}removeImage(t){this.style.removeImage(t)}loadImage(t,e){rr(this._requestManager.transformRequest(t,be.Image),(r,i)=>{e(r,i instanceof w.HTMLImageElement?Ot.getImageData(i):i)})}listImages(){return this.style.listImages()}addModel(t,e){this._lazyInitEmptyStyle(),this.style.addModel(t,e)}hasModel(t){return t?this.style.hasModel(t):(this.fire(new rt(new Error("Missing required model id"))),!1)}removeModel(t){this.style.removeModel(t)}listModels(){return this.style.listModels()}addLayer(t,e){return this._lazyInitEmptyStyle(),this.style.addLayer(t,e),this._update(!0)}moveLayer(t,e){return this.style.moveLayer(t,e),this._update(!0)}removeLayer(t){return this.style.removeLayer(t),this._update(!0)}setLights(t){if(this._lazyInitEmptyStyle(),t&&t.length===1&&t[0].type==="flat"){const e=t[0];e.properties?this.style.setFlatLight(e.properties,e.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(t),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const t=this.style.getLights()||[];return t.length===0&&t.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),t}getLayer(t){return this.style.getOwnLayer(t)}setLayerZoomRange(t,e,r){return this.style.setLayerZoomRange(t,e,r),this._update(!0)}setFilter(t,e,r={}){return this.style.setFilter(t,e,r),this._update(!0)}getFilter(t){return this.style.getFilter(t)}setPaintProperty(t,e,r,i={}){return this.style.setPaintProperty(t,e,r,i),this._update(!0)}getPaintProperty(t,e){return this.style.getPaintProperty(t,e)}setLayoutProperty(t,e,r,i={}){return this.style.setLayoutProperty(t,e,r,i),this._update(!0)}getLayoutProperty(t,e){return this.style.getLayoutProperty(t,e)}setConfigProperty(t,e,r){return this.style.setConfigProperty(t,e,r),this._update(!0)}setLight(t,e={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:t}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(t){return this._lazyInitEmptyStyle(),!t&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(t),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(t){return this._lazyInitEmptyStyle(),this.style.setFog(t),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setCamera(t){return this.style.stylesheet.camera=t,this._update(this.transform.setOrthographicProjectionAtLowPitch(t["camera-projection"]==="orthographic"))}getCamera(){return this.style.stylesheet.camera}_queryFogOpacity(t){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(zt.convert(t),this.transform):0}setFeatureState(t,e){return this.style.setFeatureState(t,e),this._update()}removeFeatureState(t,e){return this.style.removeFeatureState(t,e),this._update()}getFeatureState(t){return this.style.getFeatureState(t)}_updateContainerDimensions(){if(!this._container)return;const t=this._container.getBoundingClientRect().width||400,e=this._container.getBoundingClientRect().height||300;let r,i,a,s=this._container;for(;s&&(!i||!a);){const c=w.getComputedStyle(s).transform;c&&c!=="none"&&(r=c.match(/matrix.*\((.+)\)/)[1].split(", "),r[0]&&r[0]!=="0"&&r[0]!=="1"&&(i=r[0]),r[3]&&r[3]!=="0"&&r[3]!=="1"&&(a=r[3])),s=s.parentElement}this._containerWidth=i?Math.abs(t/i):t,this._containerHeight=a?Math.abs(e/a):e}_detectMissingCSS(){w.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&re("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const t=this._container;t.classList.add("mapboxgl-map"),(this._missingCSSCanary=Tr("div","mapboxgl-canary",t)).style.visibility="hidden",this._detectMissingCSS();const e=this._canvasContainer=Tr("div","mapboxgl-canvas-container",t);this._interactive&&e.classList.add("mapboxgl-interactive"),this._canvas=Tr("canvas","mapboxgl-canvas",e),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const r=this._controlContainer=Tr("div","mapboxgl-control-container",t),i=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(a=>{i[a]=Tr("div",`mapboxgl-ctrl-${a}`,r)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(t,e){const r=Ot.devicePixelRatio||1;this._canvas.width=r*Math.ceil(t),this._canvas.height=r*Math.ceil(e),this._canvas.style.width=`${t}px`,this._canvas.style.height=`${e}px`}_addMarker(t){this._markers.push(t)}_removeMarker(t){const e=this._markers.indexOf(t);e!==-1&&this._markers.splice(e,1)}_addPopup(t){this._popups.push(t)}_removePopup(t){const e=this._popups.indexOf(t);e!==-1&&this._popups.splice(e,1)}_setupPainter(){const t=Oe({},qc.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),e=this._useWebGL2&&this._canvas.getContext("webgl2",t),r=e||this._canvas.getContext("webgl",t)||this._canvas.getContext("experimental-webgl",t);r?(this._useWebGL2&&!e&&re("Failed to create WebGL 2 context. Using WebGL 1."),As(r,!0),this.painter=new ij(r,this.transform,!!e),this.on("data",i=>{i.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),F.testSupport(r)):this.fire(new rt(new Error("Failed to initialize WebGL")))}_contextLost(t){t.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new Ee("webglcontextlost",{originalEvent:t}))}_contextRestored(t){this._setupPainter(),this.resize(),this._update(),this.fire(new Ee("webglcontextrestored",{originalEvent:t}))}_onMapScroll(t){if(t.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(t){return this.style?(this._styleDirty=this._styleDirty||t,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(t){return this._update(),this._renderTaskQueue.add(t)}_cancelRenderFrame(t){this._renderTaskQueue.remove(t)}_requestDomTask(t){!this.loaded()||this.loaded()&&!this.isMoving()?t():this._domRenderTaskQueue.add(t)}_render(t){let e;const r=this.painter.context.extTimerQuery,i=Ot.now();if(this.listens("gpu-timing-frame")&&(e=r.createQueryEXT(),r.beginQueryEXT(r.TIME_ELAPSED_EXT,e)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],w.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],w.performance.now())),this._renderTaskQueue.run(t),this._domRenderTaskQueue.run(t),this._removed)return;this._updateProjectionTransition();const a=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const u=this.transform.zoom,d=this.transform.pitch,p=Ot.now(),m=new mn(u,{now:p,fadeDuration:a,pitch:d,transition:this.style.getTransition()});this.style.ambientLight&&this.style.ambientLight.recalculate(m),this.style.directionalLight&&this.style.directionalLight.recalculate(m);const _=this.style.calculateLightsBrightness();_!==void 0&&(m.brightness=_||0),this.style.update(m)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let s=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),s=this._updateAverageElevation(i),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):s=this._updateAverageElevation(i),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,a,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:a,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new Ee("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new Ee("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),e){const u=Ot.now()-i;r.endQueryEXT(r.TIME_ELAPSED_EXT,e),setTimeout(()=>{const d=r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6;r.deleteQueryEXT(e),this.fire(new Ee("gpu-timing-frame",{cpuTime:u,gpuTime:d})),w.performance.mark("frame-gpu",{startTime:i,detail:{gpuTime:d}})},50)}if(this.listens("gpu-timing-layer")){const u=this.painter.collectGpuTimers();setTimeout(()=>{const d=this.painter.queryGpuTimers(u);this.fire(new Ee("gpu-timing-layer",{layerTimes:d}))},50)}if(this.listens("gpu-timing-deferred-render")){const u=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const d=this.painter.queryGpuTimeDeferredRender(u);this.fire(new Ee("gpu-timing-deferred-render",{gpuTime:d}))},50)}const c=this._sourcesDirty||this._styleDirty||this._placementDirty||s;if(c||this._repaint)this.triggerRepaint();else{const u=!this.isMoving()&&this.loaded();if(u&&(s=this._updateAverageElevation(i,!0)),s)this.triggerRepaint();else if(this._triggerFrame(!1),u&&(this.fire(new Ee("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const d=this._calculateSpeedIndex();this.fire(new Ee("speedindexcompleted",{speedIndex:d})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||c||(this._fullyLoaded=!0,Vl.mark(Is.fullLoad),this._performanceMetricsCollection&&Wa(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(t){for(const e of this._markers)t&&!this.getRenderWorldCopies()&&(e._lngLat=e._lngLat.wrap()),e._update();for(const e of this._popups)!t||this.getRenderWorldCopies()||e._trackPointer||(e._lngLat=e._lngLat.wrap()),e._update()}_updateAverageElevation(t,e=!1){const r=i=>(this.transform.averageElevation=i,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&r(0);if((e||t-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(t)){const i=this.transform.averageElevation;let a=this.transform.sampleAverageElevation(),s=!1;this.transform.elevation&&(s=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(a)?a=0:this._averageElevationLastSampledAt=t;const c=Math.abs(i-a);if(c>1){if(this._isInitialLoad||s)return this._averageElevation.jumpTo(a),r(a);this._averageElevation.easeTo(a,t,300)}else if(c>1e-4)return this._averageElevation.jumpTo(a),r(a)}return!!this._averageElevation.isEasing(t)&&r(this._averageElevation.getValue(t))}_authenticate(){Ha(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,t=>{if(t&&(t.message===yt||t.status===401)){const e=this.painter.context.gl;As(e,!1),this._logoControl instanceof AA&&this._logoControl._updateLogo(),e&&e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT|e.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new rt(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),Gc(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const t=this._isDragging();this.painter.updateTerrain(this.style,t)}_calculateSpeedIndex(){const t=this.painter.canvasCopy(),e=this.painter.getCanvasCopiesAndTimestamps();e.timeStamps.push(performance.now());const r=this.painter.context.gl,i=r.createFramebuffer();function a(s){r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,s,0);const c=new Uint8Array(r.drawingBufferWidth*r.drawingBufferHeight*4);return r.readPixels(0,0,r.drawingBufferWidth,r.drawingBufferHeight,r.RGBA,r.UNSIGNED_BYTE,c),c}return r.bindFramebuffer(r.FRAMEBUFFER,i),this._canvasPixelComparison(a(t),e.canvasCopies.map(a),e.timeStamps)}_canvasPixelComparison(t,e,r){let i=r[1]-r[0];const a=t.length/4;for(let s=0;s<e.length;s++){const c=e[s];let u=0;for(let d=0;d<c.length;d+=4)c[d]===t[d]&&c[d+1]===t[d+1]&&c[d+2]===t[d+2]&&c[d+3]===t[d+3]&&(u+=1);i+=(r[s+2]-r[s+1])*(1-u/a)}return i}remove(){this._hash&&this._hash.remove();for(const e of this._controls)e.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),w!==void 0&&(w.removeEventListener("resize",this._onWindowResize,!1),w.removeEventListener("orientationchange",this._onWindowResize,!1),w.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),w.removeEventListener("online",this._onWindowOnline,!1),w.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const t=this.painter.context.gl.getExtension("WEBGL_lose_context");t&&t.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),io.delete(this.painter.context.gl),this._removed=!0,this.fire(new Ee("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(t){this._renderNextFrame=this._renderNextFrame||t,this.style&&!this._frame&&(this._frame=Ot.frame(e=>{const r=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,r&&this._render(e)}))}_preloadTiles(t){return mt(this.style?Object.values(this.style._sourceCaches):[],(e,r)=>e._preloadTiles(t,r),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(t){this._trackResize&&this.resize({originalEvent:t})._update()}_onVisibilityChange(){w.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(t){this._showTileBoundaries!==t&&(this._showTileBoundaries=t,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(t){this._showTerrainWireframe!==t&&(this._showTerrainWireframe=t,this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(t){this._showLayers2DWireframe!==t&&(this._showLayers2DWireframe=t,this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(t){this._showLayers3DWireframe!==t&&(this._showLayers3DWireframe=t,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(t){this._speedIndexTiming!==t&&(this._speedIndexTiming=t,this._update())}get showPadding(){return!!this._showPadding}set showPadding(t){this._showPadding!==t&&(this._showPadding=t,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(t){this._showCollisionBoxes!==t&&(this._showCollisionBoxes=t,t?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(t){this._showOverdrawInspector!==t&&(this._showOverdrawInspector=t,this._update())}get repaint(){return!!this._repaint}set repaint(t){this._repaint!==t&&(this._repaint=t,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(t){this._vertices=t,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(t){this._showTileAABBs!==t&&(this._showTileAABBs=t,t&&this._update())}_setCacheLimits(t,e){(function(r,i){Pe=r,et=i})(t,e)}get version(){return I}},NavigationControl:class{constructor(t){this.options=Oe({},Hj,t),this._container=Tr("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",e=>e.preventDefault()),this.options.showZoom&&(ar(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",e=>{this._map&&this._map.zoomIn({},{originalEvent:e})}),Tr("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",e=>{this._map&&this._map.zoomOut({},{originalEvent:e})}),Tr("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(ar(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",e=>{const r=this._map;r&&(this.options.visualizePitch?r.resetNorthPitch({},{originalEvent:e}):r.resetNorth({},{originalEvent:e}))}),this._compassIcon=Tr("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const t=this._map;if(!t)return;const e=t.getZoom(),r=e===t.getMaxZoom(),i=e===t.getMinZoom();this._zoomInButton.disabled=r,this._zoomOutButton.disabled=i,this._zoomInButton.setAttribute("aria-disabled",r.toString()),this._zoomOutButton.setAttribute("aria-disabled",i.toString())}_rotateCompassArrow(){const t=this._map;if(!t)return;const e=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(t.transform.pitch*(Math.PI/180)),.5)}) rotateX(${t.transform.pitch}deg) rotateZ(${t.transform.angle*(180/Math.PI)}deg)`:`rotate(${t.transform.angle*(180/Math.PI)}deg)`;t._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=e)})}onAdd(t){return this._map=t,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),t.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&t.on("pitch",this._rotateCompassArrow),t.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new qj(t,this._compass,this.options.visualizePitch)),this._container}onRemove(){const t=this._map;t&&(this._container.remove(),this.options.showZoom&&t.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&t.off("pitch",this._rotateCompassArrow),t.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(t,e){const r=Tr("button",t,this._container);return r.type="button",r.addEventListener("click",e),r}_setButtonTitle(t,e){if(!this._map)return;const r=this._map._getUIString(`NavigationControl.${e}`);t.setAttribute("aria-label",r),t.firstElementChild&&t.firstElementChild.setAttribute("title",r)}},GeolocateControl:class extends dr{constructor(t){super(),this.options=Oe({geolocation:w.navigator.geolocation},Zj,t),ar(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=vA(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(t){return this._map=t,this._container=Tr("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(t){const e=(r=!!this.options.geolocation)=>{this._supportsGeolocation=r,t(r)};this._supportsGeolocation!==void 0?t(this._supportsGeolocation):w.navigator.permissions!==void 0?w.navigator.permissions.query({name:"geolocation"}).then(r=>e(r.state!=="denied")).catch(()=>e()):e()}_isOutOfMapMaxBounds(t){const e=this._map.getMaxBounds(),r=t.coords;return!!e&&(r.longitude<e.getWest()||r.longitude>e.getEast()||r.latitude<e.getSouth()||r.latitude>e.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(t){if(this._map){if(this._isOutOfMapMaxBounds(t))return this._setErrorState(),this.fire(new Ee("outofmaxbounds",t)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=t,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(t),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(t),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new Ee("geolocate",t)),this._finish()}}_updateCamera(t){const e=new zt(t.coords.longitude,t.coords.latitude),r=t.coords.accuracy,i=Oe({bearing:this._map.getBearing()},this.options.fitBoundsOptions);this._map.fitBounds(e.toBounds(r),i,{geolocateSource:!0})}_updateMarker(t){if(t){const e=new zt(t.coords.longitude,t.coords.latitude);this._accuracyCircleMarker.setLngLat(e).addTo(this._map),this._userLocationDotMarker.setLngLat(e).addTo(this._map),this._accuracy=t.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const t=this._map.transform,e=jr(1,t._center.lat)*t.worldSize,r=Math.ceil(2*this._accuracy*e);this._circleElement.style.width=`${r}px`,this._circleElement.style.height=`${r}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(t){if(this._map){if(this.options.trackUserLocation)if(t.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(t.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new Ee("error",t)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(t){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",e=>e.preventDefault()),this._geolocateButton=Tr("button","mapboxgl-ctrl-geolocate",this._container),Tr("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",t===!1){re("Geolocation support is not available so the GeolocateControl will be disabled.");const e=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}else{const e=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",e),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",e)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Tr("div","mapboxgl-user-location"),this._dotElement.appendChild(Tr("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Tr("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Nx({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Tr("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Nx({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",e=>{e.geolocateSource||this._watchState!=="ACTIVE_LOCK"||e.originalEvent&&e.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new Ee("trackuserlocationend")))})}}_onDeviceOrientation(t){this._userLocationDotMarker&&(t.webkitCompassHeading?this._heading=t.webkitCompassHeading:t.absolute===!0&&(this._heading=-1*t.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return re("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new Ee("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new Ee("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new Ee("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let t;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(t={maximumAge:6e5,timeout:0},this._noTimeout=!0):(t=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,t),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const t=()=>{w.addEventListener("ondeviceorientationabsolute"in w?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};w.DeviceMotionEvent!==void 0&&typeof w.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(e=>{e==="granted"&&t()}).catch(console.error):t()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),w.removeEventListener("deviceorientation",this._onDeviceOrientation),w.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:CA,ScaleControl:class{constructor(t){this.options=Oe({},Xj,t),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),ar(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const t=this.options.maxWidth||100,e=this._map,r=e._containerHeight/2,i=e._containerWidth/2-t/2,a=e.unproject([i,r]),s=e.unproject([i+t,r]),c=a.distanceTo(s);if(this.options.unit==="imperial"){const u=3.2808*c;u>5280?this._setScale(t,u/5280,"mile"):this._setScale(t,u,"foot")}else this.options.unit==="nautical"?this._setScale(t,c/1852,"nautical-mile"):c>=1e3?this._setScale(t,c/1e3,"kilometer"):this._setScale(t,c,"meter")}_setScale(t,e,r){this._map._requestDomTask(()=>{const i=function(s){const c=Math.pow(10,`${Math.floor(s)}`.length-1);let u=s/c;return u=u>=10?10:u>=5?5:u>=3?3:u>=2?2:u>=1?1:function(d){const p=Math.pow(10,Math.ceil(-Math.log(d)/Math.LN10));return Math.round(d*p)/p}(u),c*u}(e),a=i/e;this._container.innerHTML=this._isNumberFormatSupported&&r!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:r}).format(i):`${i}&nbsp;${Yj[r]}`,this._container.style.width=t*a+"px"})}onAdd(t){return this._map=t,this._language=t.getLanguage(),this._container=Tr("div","mapboxgl-ctrl mapboxgl-ctrl-scale",t.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(t){this._language=t,this._update()}setUnit(t){this.options.unit=t,this._update()}},FullscreenControl:class{constructor(t){this._fullscreen=!1,t&&t.container&&(t.container instanceof w.HTMLElement?this._container=t.container:re("Full screen control 'container' must be a DOM element.")),ar(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in w.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in w.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(t){return this._map=t,this._container||(this._container=this._map.getContainer()),this._controlContainer=Tr("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",re("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,w.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!w.document.fullscreenEnabled&&!w.document.webkitFullscreenEnabled)}_setupUI(){const t=this._fullscreenButton=Tr("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Tr("span","mapboxgl-ctrl-icon",t).setAttribute("aria-hidden","true"),t.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),w.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const t=this._getTitle();this._fullscreenButton.setAttribute("aria-label",t),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",t)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(w.document.fullscreenElement||w.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?w.document.exitFullscreen?w.document.exitFullscreen():w.document.webkitCancelFullScreen&&w.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends dr{constructor(t){super(),this.options=Oe(Object.create($j),t),ar(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(t&&t.className?t.className.trim().split(/\s+/):[])}addTo(t){return this._map&&this.remove(),this._map=t,this.options.closeOnClick&&t.on("preclick",this._onClose),this.options.closeOnMove&&t.on("move",this._onClose),t.on("remove",this.remove),this._update(),t._addPopup(this),this._focusFirstElement(),this._trackPointer?(t.on("mousemove",this._onMouseEvent),t.on("mouseup",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")):t.on("move",this._update),this.fire(new Ee("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const t=this._map;return t&&(t.off("move",this._update),t.off("move",this._onClose),t.off("preclick",this._onClose),t.off("click",this._onClose),t.off("remove",this.remove),t.off("mousemove",this._onMouseEvent),t.off("mouseup",this._onMouseEvent),t.off("drag",this._onMouseEvent),t._canvasContainer&&t._canvasContainer.classList.remove("mapboxgl-track-pointer"),t._removePopup(this),this._map=void 0),this.fire(new Ee("close")),this}getLngLat(){return this._lngLat}setLngLat(t){this._lngLat=zt.convert(t),this._pos=null,this._trackPointer=!1,this._update();const e=this._map;return e&&(e.on("move",this._update),e.off("mousemove",this._onMouseEvent),e._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const t=this._map;return t&&(t.off("move",this._update),t.on("mousemove",this._onMouseEvent),t.on("drag",this._onMouseEvent),t._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(t){return this.setDOMContent(w.document.createTextNode(t))}setHTML(t){const e=w.document.createDocumentFragment(),r=w.document.createElement("body");let i;for(r.innerHTML=t;i=r.firstChild,i;)e.appendChild(i);return this.setDOMContent(e)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(t){return this.options.maxWidth=t,this._update(),this}setDOMContent(t){let e=this._content;if(e)for(;e.hasChildNodes();)e.firstChild&&e.removeChild(e.firstChild);else e=this._content=Tr("div","mapboxgl-popup-content",this._container||void 0);if(e.appendChild(t),this.options.closeButton){const r=this._closeButton=Tr("button","mapboxgl-popup-close-button",e);r.type="button",r.setAttribute("aria-label","Close popup"),r.setAttribute("aria-hidden","true"),r.innerHTML="&#215;",r.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(t){return this._classList.add(t),this._updateClassList(),this}removeClassName(t){return this._classList.delete(t),this._updateClassList(),this}setOffset(t){return this.options.offset=t,this._update(),this}toggleClassName(t){let e;return this._classList.delete(t)?e=!1:(this._classList.add(t),e=!0),this._updateClassList(),e}_onMouseEvent(t){this._update(t.point)}_getAnchor(t){if(this.options.anchor)return this.options.anchor;const e=this._map,r=this._container,i=this._pos;if(!e||!r||!i)return"bottom";const a=r.offsetWidth,s=r.offsetHeight,c=i.x<a/2,u=i.x>e.transform.width-a/2;if(i.y+t<s)return c?"top-left":u?"top-right":"top";if(i.y>e.transform.height-s){if(c)return"bottom-left";if(u)return"bottom-right"}return c?"left":u?"right":"bottom"}_updateClassList(){const t=this._container;if(!t)return;const e=[...this._classList];e.push("mapboxgl-popup"),this._anchor&&e.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&e.push("mapboxgl-popup-track-pointer"),t.className=e.join(" ")}_update(t){const e=this._map,r=this._content;if(!e||!this._lngLat&&!this._trackPointer||!r)return;let i=this._container;if(i||(i=this._container=Tr("div","mapboxgl-popup",e.getContainer()),this._tip=Tr("div","mapboxgl-popup-tip",i),i.appendChild(r)),this.options.maxWidth&&i.style.maxWidth!==this.options.maxWidth&&(i.style.maxWidth=this.options.maxWidth),e.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=PA(this._lngLat,this._pos,e.transform)),!this._trackPointer||t){const a=this._pos=this._trackPointer&&t?t:e.project(this._lngLat),s=kA(this.options.offset),c=this._anchor=this._getAnchor(s.y),u=kA(this.options.offset,c),d=a.add(u).round();e._requestDomTask(()=>{this._container&&c&&(this._container.style.transform=`${Bx[c]} translate(${d.x}px,${d.y}px)`)})}if(!this._marker&&e._showingGlobe()){const a=Mm(e.transform,this._lngLat)?0:1;this._setOpacity(a)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const t=this._container.querySelector(Vj);t&&t.focus()}_onClose(){this.remove()}_setOpacity(t){this._container&&(this._container.style.opacity=`${t}`),this._content&&(this._content.style.pointerEvents=t?"auto":"none")}},Marker:Nx,Style:oa,LngLat:zt,LngLatBounds:lo,Point:$,MercatorCoordinate:cr,FreeCameraOptions:XM,Evented:dr,config:D,prewarm:function(){rf().acquire(dx)},clearPrewarmedResources:function(){const t=tf;t&&(t.isPreloaded()&&t.numActive()===1?(t.release(dx),tf=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return D.ACCESS_TOKEN},set accessToken(t){D.ACCESS_TOKEN=t},get baseApiUrl(){return D.API_URL},set baseApiUrl(t){D.API_URL=t},get workerCount(){return ju.workerCount},set workerCount(t){ju.workerCount=t},get maxParallelImageRequests(){return D.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(t){D.MAX_PARALLEL_IMAGE_REQUESTS=t},clearStorage(t){(function(e){if(!bt())return;const r=w.caches.delete(Te);e&&r.catch(e).then(()=>e())})(t)},workerUrl:"",workerClass:null,get loadersUrl(){return o5()},set loadersUrl(t){(function(e){fx=Ot.resolveURL(e),px||(px=new ac(rf(),new dr)),px.broadcast("setLoadersUrl",fx)})(t)},setNow:Ot.setNow,restoreNow:Ot.restoreNow};E.Actor=HC,E.DEMData=Cu,E.EXTENT=Ae,E.Event=Ee,E.FeatureIndex=Ov,E.KDBush=wg,E.OverscaledTileID=Kr,E.Point=$,E.Tiled3dModelBucket=xC,E.VectorTileFeature=Nm,E.VectorTileWorkerSource=class extends dr{constructor(t,e,r,i,a,s){super(),this.actor=t,this.layerIndex=e,this.availableImages=r,this.loadVectorData=a||QC,this.loading={},this.loaded={},this.deduped=new JC(t.scheduler),this.isSpriteLoaded=i,this.scheduler=t.scheduler,this.brightness=s}loadTile(t,e){const r=t.uid,i=t&&t.request,a=i&&i.collectResourceTiming,s=this.loading[r]=new v9(t);s.abort=this.loadVectorData(t,(c,u)=>{const d=!this.loading[r];if(delete this.loading[r],d||c||!u)return s.status="done",d||(this.loaded[r]=s),e(c);const p=u.rawData,m={};u.expires&&(m.expires=u.expires),u.cacheControl&&(m.cacheControl=u.cacheControl),s.vectorTile=u.vectorTile||new Dv(new Um(p));const _=()=>{s.parse(s.vectorTile,this.layerIndex,this.availableImages,this.actor,(y,v)=>{if(y||!v)return e(y);const b={};if(a){const S=Hc(i);S.length>0&&(b.resourceTiming=JSON.parse(JSON.stringify(S)))}e(null,Oe({rawTileData:p.slice(0)},v,m,b))})};this.isSpriteLoaded?_():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(_,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):_()}),this.loaded=this.loaded||{},this.loaded[r]=s})}reloadTile(t,e){const r=this.loaded,i=t.uid,a=this;if(r&&r[i]){const s=r[i];s.showCollisionBoxes=t.showCollisionBoxes,s.enableTerrain=!!t.enableTerrain,s.projection=t.projection,s.brightness=t.brightness,s.tileTransform=ic(t.tileID.canonical,t.projection);const c=(u,d)=>{const p=s.reloadCallback;p&&(delete s.reloadCallback,s.parse(s.vectorTile,a.layerIndex,this.availableImages,a.actor,p)),e(u,d)};s.status==="parsing"?s.reloadCallback=c:s.status==="done"&&(s.vectorTile?s.parse(s.vectorTile,this.layerIndex,this.availableImages,this.actor,c):c())}}abortTile(t,e){const r=t.uid,i=this.loading[r];i&&(i.abort&&i.abort(),delete this.loading[r]),e()}removeTile(t,e){const r=this.loaded,i=t.uid;r&&r[i]&&delete r[i],e()}},E.convertB3dm=function(t,e){const r=hx(t);for(const i of r)i.lights&&(i.meshes.push(C9(i.lights,e)),i.lightMeshIndex=i.meshes.length-1);return r},E.createExpression=Ls,E.createStyleLayer=_g,E.enforceCacheSizeLimit=function(t){ct(),_t&&_t.then(e=>{e.keys().then(r=>{for(let i=0;i<r.length-t;i++)e.delete(r[i])})})},E.exported=Dg,E.extend=Oe,E.getArrayBuffer=Ue,E.getDefaultExportFromCjs=V,E.getJSON=qe,E.getPerformanceMeasurement=Hc,E.getProjection=Jm,E.load3DTile=async function(t){return await a5(),mapboxglLoaders.parse(t,mapboxglLoaders.Tiles3DLoader,{worker:!1,gltf:{decompressMeshes:!0,postProcess:!1,loadBuffers:!0,loadImages:!0}})},E.pbf=YT,E.plugin=Ro,E.pointGeometry=ne,E.refProperties=c5,E.tileToMeter=kd,E.values=kt,E.vectorTile=Bm,E.window=w}),g(["./shared"],function(E){function w(Fe){if(typeof Fe=="number"||typeof Fe=="boolean"||typeof Fe=="string"||Fe==null)return JSON.stringify(Fe);if(Array.isArray(Fe)){let ee="[";for(const re of Fe)ee+=`${w(re)},`;return`${ee}]`}let Y="{";for(const ee of Object.keys(Fe).sort())Y+=`${ee}:${w(Fe[ee])},`;return`${Y}}`}function I(Fe){let Y="";for(const ee of E.refProperties)Y+=`/${w(Fe[ee])}`;return Y}class R{constructor(Y){this.keyCache={},Y&&this.replace(Y)}replace(Y,ee){this._layerConfigs={},this._layers={},this.update(Y,[],ee)}update(Y,ee,re){this._options=re;for(const Ie of Y)this._layerConfigs[Ie.id]=Ie,(this._layers[Ie.id]=E.createStyleLayer(Ie,this._options)).compileFilter(),this.keyCache[Ie.id]&&delete this.keyCache[Ie.id];for(const Ie of ee)delete this.keyCache[Ie],delete this._layerConfigs[Ie],delete this._layers[Ie];this.familiesBySource={};const we=function(Ie,Qe){const tt={};for(let gt=0;gt<Ie.length;gt++){const Tt=Qe&&Qe[Ie[gt].id]||I(Ie[gt]);Qe&&(Qe[Ie[gt].id]=Tt);let At=tt[Tt];At||(At=tt[Tt]=[]),At.push(Ie[gt])}const Be=[];for(const gt in tt)Be.push(tt[gt]);return Be}(E.values(this._layerConfigs),this.keyCache);for(const Ie of we){const Qe=Ie.map(mr=>this._layers[mr.id]),tt=Qe[0];if(tt.visibility==="none")continue;const Be=tt.source||"";let gt=this.familiesBySource[Be];gt||(gt=this.familiesBySource[Be]={});const Tt=tt.sourceLayer||"_geojsonTileLayer";let At=gt[Tt];At||(At=gt[Tt]=[]),At.push(Qe)}}}class D{loadTile(Y,ee){const{uid:re,encoding:we,rawImageData:Ie,padding:Qe,buildQuadTree:tt}=Y,Be=E.window.ImageBitmap&&Ie instanceof E.window.ImageBitmap?this.getImageData(Ie,Qe):Ie;ee(null,new E.DEMData(re,Be,we,Qe<1,tt))}getImageData(Y,ee){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(Y.width,Y.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=Y.width,this.offscreenCanvas.height=Y.height,this.offscreenCanvasContext.drawImage(Y,0,0,Y.width,Y.height);const re=this.offscreenCanvasContext.getImageData(-ee,-ee,Y.width+2*ee,Y.height+2*ee);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),re}}function F(Fe,Y){if(Fe.length!==0){q(Fe[0],Y);for(var ee=1;ee<Fe.length;ee++)q(Fe[ee],!Y)}}function q(Fe,Y){for(var ee=0,re=0,we=0,Ie=Fe.length,Qe=Ie-1;we<Ie;Qe=we++){var tt=(Fe[we][0]-Fe[Qe][0])*(Fe[Qe][1]+Fe[we][1]),Be=ee+tt;re+=Math.abs(ee)>=Math.abs(tt)?ee-Be+tt:tt-Be+ee,ee=Be}ee+re>=0!=!!Y&&Fe.reverse()}var G=E.getDefaultExportFromCjs(function Fe(Y,ee){var re,we=Y&&Y.type;if(we==="FeatureCollection")for(re=0;re<Y.features.length;re++)Fe(Y.features[re],ee);else if(we==="GeometryCollection")for(re=0;re<Y.geometries.length;re++)Fe(Y.geometries[re],ee);else if(we==="Feature")Fe(Y.geometry,ee);else if(we==="Polygon")F(Y.coordinates,ee);else if(we==="MultiPolygon")for(re=0;re<Y.coordinates.length;re++)F(Y.coordinates[re],ee);return Y});const j=E.VectorTileFeature.prototype.toGeoJSON;var te={exports:{}},N=E.pointGeometry,O=E.vectorTile.VectorTileFeature,V=U;function U(Fe,Y){this.options=Y||{},this.features=Fe,this.length=Fe.length}function ae(Fe,Y){this.id=typeof Fe.id=="number"?Fe.id:void 0,this.type=Fe.type,this.rawGeometry=Fe.type===1?[Fe.geometry]:Fe.geometry,this.properties=Fe.tags,this.extent=Y||4096}U.prototype.feature=function(Fe){return new ae(this.features[Fe],this.options.extent)},ae.prototype.loadGeometry=function(){var Fe=this.rawGeometry;this.geometry=[];for(var Y=0;Y<Fe.length;Y++){for(var ee=Fe[Y],re=[],we=0;we<ee.length;we++)re.push(new N(ee[we][0],ee[we][1]));this.geometry.push(re)}return this.geometry},ae.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Fe=this.geometry,Y=1/0,ee=-1/0,re=1/0,we=-1/0,Ie=0;Ie<Fe.length;Ie++)for(var Qe=Fe[Ie],tt=0;tt<Qe.length;tt++){var Be=Qe[tt];Y=Math.min(Y,Be.x),ee=Math.max(ee,Be.x),re=Math.min(re,Be.y),we=Math.max(we,Be.y)}return[Y,re,ee,we]},ae.prototype.toGeoJSON=O.prototype.toGeoJSON;var le=E.pbf,ne=V;function de(Fe){var Y=new le;return function(ee,re){for(var we in ee.layers)re.writeMessage(3,$,ee.layers[we])}(Fe,Y),Y.finish()}function $(Fe,Y){var ee;Y.writeVarintField(15,Fe.version||1),Y.writeStringField(1,Fe.name||""),Y.writeVarintField(5,Fe.extent||4096);var re={keys:[],values:[],keycache:{},valuecache:{}};for(ee=0;ee<Fe.length;ee++)re.feature=Fe.feature(ee),Y.writeMessage(2,ue,re);var we=re.keys;for(ee=0;ee<we.length;ee++)Y.writeStringField(3,we[ee]);var Ie=re.values;for(ee=0;ee<Ie.length;ee++)Y.writeMessage(4,$e,Ie[ee])}function ue(Fe,Y){var ee=Fe.feature;ee.id!==void 0&&Y.writeVarintField(1,ee.id),Y.writeMessage(2,xe,Fe),Y.writeVarintField(3,ee.type),Y.writeMessage(4,ke,ee)}function xe(Fe,Y){var ee=Fe.feature,re=Fe.keys,we=Fe.values,Ie=Fe.keycache,Qe=Fe.valuecache;for(var tt in ee.properties){var Be=ee.properties[tt],gt=Ie[tt];if(Be!==null){gt===void 0&&(re.push(tt),Ie[tt]=gt=re.length-1),Y.writeVarint(gt);var Tt=typeof Be;Tt!=="string"&&Tt!=="boolean"&&Tt!=="number"&&(Be=JSON.stringify(Be));var At=Tt+":"+Be,mr=Qe[At];mr===void 0&&(we.push(Be),Qe[At]=mr=we.length-1),Y.writeVarint(mr)}}}function ce(Fe,Y){return(Y<<3)+(7&Fe)}function se(Fe){return Fe<<1^Fe>>31}function ke(Fe,Y){for(var ee=Fe.loadGeometry(),re=Fe.type,we=0,Ie=0,Qe=ee.length,tt=0;tt<Qe;tt++){var Be=ee[tt],gt=1;re===1&&(gt=Be.length),Y.writeVarint(ce(1,gt));for(var Tt=re===3?Be.length-1:Be.length,At=0;At<Tt;At++){At===1&&re!==1&&Y.writeVarint(ce(2,Tt-1));var mr=Be[At].x-we,nn=Be[At].y-Ie;Y.writeVarint(se(mr)),Y.writeVarint(se(nn)),we+=mr,Ie+=nn}re===3&&Y.writeVarint(ce(7,1))}}function $e(Fe,Y){var ee=typeof Fe;ee==="string"?Y.writeStringField(1,Fe):ee==="boolean"?Y.writeBooleanField(7,Fe):ee==="number"&&(Fe%1!=0?Y.writeDoubleField(3,Fe):Fe<0?Y.writeSVarintField(6,Fe):Y.writeVarintField(5,Fe))}te.exports=de,te.exports.fromVectorTileJs=de,te.exports.fromGeojsonVt=function(Fe,Y){Y=Y||{};var ee={};for(var re in Fe)ee[re]=new ne(Fe[re].features,Y),ee[re].name=re,ee[re].version=Y.version,ee[re].extent=Y.extent;return de({layers:ee})},te.exports.GeoJSONWrapper=ne;var Ne=E.getDefaultExportFromCjs(te.exports);const it={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Fe=>Fe},Re=Math.fround||(He=new Float32Array(1),Fe=>(He[0]=+Fe,He[0]));var He;const Xe=3,ze=5,at=6;class Pt{constructor(Y){this.options=Object.assign(Object.create(it),Y),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(Y){const{log:ee,minZoom:re,maxZoom:we}=this.options;ee&&console.time("total time");const Ie=`prepare ${Y.length} points`;ee&&console.time(Ie),this.points=Y;const Qe=[];for(let Be=0;Be<Y.length;Be++){const gt=Y[Be];if(!gt.geometry)continue;const[Tt,At]=gt.geometry.coordinates,mr=Re(Oe(Tt)),nn=Re(qt(At));Qe.push(mr,nn,1/0,Be,-1,1),this.options.reduce&&Qe.push(0)}let tt=this.trees[we+1]=this._createTree(Qe);ee&&console.timeEnd(Ie);for(let Be=we;Be>=re;Be--){const gt=+Date.now();tt=this.trees[Be]=this._createTree(this._cluster(tt,Be)),ee&&console.log("z%d: %d clusters in %dms",Be,tt.numItems,+Date.now()-gt)}return ee&&console.timeEnd("total time"),this}getClusters(Y,ee){let re=((Y[0]+180)%360+360)%360-180;const we=Math.max(-90,Math.min(90,Y[1]));let Ie=Y[2]===180?180:((Y[2]+180)%360+360)%360-180;const Qe=Math.max(-90,Math.min(90,Y[3]));if(Y[2]-Y[0]>=360)re=-180,Ie=180;else if(re>Ie){const At=this.getClusters([re,we,180,Qe],ee),mr=this.getClusters([-180,we,Ie,Qe],ee);return At.concat(mr)}const tt=this.trees[this._limitZoom(ee)],Be=tt.range(Oe(re),qt(Qe),Oe(Ie),qt(we)),gt=tt.data,Tt=[];for(const At of Be){const mr=this.stride*At;Tt.push(gt[mr+ze]>1?mt(gt,mr,this.clusterProps):this.points[gt[mr+Xe]])}return Tt}getChildren(Y){const ee=this._getOriginId(Y),re=this._getOriginZoom(Y),we="No cluster with the specified id.",Ie=this.trees[re];if(!Ie)throw new Error(we);const Qe=Ie.data;if(ee*this.stride>=Qe.length)throw new Error(we);const tt=this.options.radius/(this.options.extent*Math.pow(2,re-1)),Be=Ie.within(Qe[ee*this.stride],Qe[ee*this.stride+1],tt),gt=[];for(const Tt of Be){const At=Tt*this.stride;Qe[At+4]===Y&&gt.push(Qe[At+ze]>1?mt(Qe,At,this.clusterProps):this.points[Qe[At+Xe]])}if(gt.length===0)throw new Error(we);return gt}getLeaves(Y,ee,re){const we=[];return this._appendLeaves(we,Y,ee=ee||10,re=re||0,0),we}getTile(Y,ee,re){const we=this.trees[this._limitZoom(Y)],Ie=Math.pow(2,Y),{extent:Qe,radius:tt}=this.options,Be=tt/Qe,gt=(re-Be)/Ie,Tt=(re+1+Be)/Ie,At={features:[]};return this._addTileFeatures(we.range((ee-Be)/Ie,gt,(ee+1+Be)/Ie,Tt),we.data,ee,re,Ie,At),ee===0&&this._addTileFeatures(we.range(1-Be/Ie,gt,1,Tt),we.data,Ie,re,Ie,At),ee===Ie-1&&this._addTileFeatures(we.range(0,gt,Be/Ie,Tt),we.data,-1,re,Ie,At),At.features.length?At:null}getClusterExpansionZoom(Y){let ee=this._getOriginZoom(Y)-1;for(;ee<=this.options.maxZoom;){const re=this.getChildren(Y);if(ee++,re.length!==1)break;Y=re[0].properties.cluster_id}return ee}_appendLeaves(Y,ee,re,we,Ie){const Qe=this.getChildren(ee);for(const tt of Qe){const Be=tt.properties;if(Be&&Be.cluster?Ie+Be.point_count<=we?Ie+=Be.point_count:Ie=this._appendLeaves(Y,Be.cluster_id,re,we,Ie):Ie<we?Ie++:Y.push(tt),Y.length===re)break}return Ie}_createTree(Y){const ee=new E.KDBush(Y.length/this.stride|0,this.options.nodeSize,Float32Array);for(let re=0;re<Y.length;re+=this.stride)ee.add(Y[re],Y[re+1]);return ee.finish(),ee.data=Y,ee}_addTileFeatures(Y,ee,re,we,Ie,Qe){for(const tt of Y){const Be=tt*this.stride,gt=ee[Be+ze]>1;let Tt,At,mr;if(gt)Tt=kt(ee,Be,this.clusterProps),At=ee[Be],mr=ee[Be+1];else{const Cr=this.points[ee[Be+Xe]];Tt=Cr.properties;const[Yr,br]=Cr.geometry.coordinates;At=Oe(Yr),mr=qt(br)}const nn={type:1,geometry:[[Math.round(this.options.extent*(At*Ie-re)),Math.round(this.options.extent*(mr*Ie-we))]],tags:Tt};let Pr;Pr=gt||this.options.generateId?ee[Be+Xe]:this.points[ee[Be+Xe]].id,Pr!==void 0&&(nn.id=Pr),Qe.features.push(nn)}}_limitZoom(Y){return Math.max(this.options.minZoom,Math.min(Math.floor(+Y),this.options.maxZoom+1))}_cluster(Y,ee){const{radius:re,extent:we,reduce:Ie,minPoints:Qe}=this.options,tt=re/(we*Math.pow(2,ee)),Be=Y.data,gt=[],Tt=this.stride;for(let At=0;At<Be.length;At+=Tt){if(Be[At+2]<=ee)continue;Be[At+2]=ee;const mr=Be[At],nn=Be[At+1],Pr=Y.within(Be[At],Be[At+1],tt),Cr=Be[At+ze];let Yr=Cr;for(const br of Pr){const Te=br*Tt;Be[Te+2]>ee&&(Yr+=Be[Te+ze])}if(Yr>Cr&&Yr>=Qe){let br,Te=mr*Cr,Pe=nn*Cr,et=-1;const _t=((At/Tt|0)<<5)+(ee+1)+this.points.length;for(const Rt of Pr){const bt=Rt*Tt;if(Be[bt+2]<=ee)continue;Be[bt+2]=ee;const ct=Be[bt+ze];Te+=Be[bt]*ct,Pe+=Be[bt+1]*ct,Be[bt+4]=_t,Ie&&(br||(br=this._map(Be,At,!0),et=this.clusterProps.length,this.clusterProps.push(br)),Ie(br,this._map(Be,bt)))}Be[At+4]=_t,gt.push(Te/Yr,Pe/Yr,1/0,_t,-1,Yr),Ie&&gt.push(et)}else{for(let br=0;br<Tt;br++)gt.push(Be[At+br]);if(Yr>1)for(const br of Pr){const Te=br*Tt;if(!(Be[Te+2]<=ee)){Be[Te+2]=ee;for(let Pe=0;Pe<Tt;Pe++)gt.push(Be[Te+Pe])}}}}return gt}_getOriginId(Y){return Y-this.points.length>>5}_getOriginZoom(Y){return(Y-this.points.length)%32}_map(Y,ee,re){if(Y[ee+ze]>1){const Qe=this.clusterProps[Y[ee+at]];return re?Object.assign({},Qe):Qe}const we=this.points[Y[ee+Xe]].properties,Ie=this.options.map(we);return re&&Ie===we?Object.assign({},Ie):Ie}}function mt(Fe,Y,ee){return{type:"Feature",id:Fe[Y+Xe],properties:kt(Fe,Y,ee),geometry:{type:"Point",coordinates:[(re=Fe[Y],360*(re-.5)),Sr(Fe[Y+1])]}};var re}function kt(Fe,Y,ee){const re=Fe[Y+ze],we=re>=1e4?`${Math.round(re/1e3)}k`:re>=1e3?Math.round(re/100)/10+"k":re,Ie=Fe[Y+at],Qe=Ie===-1?{}:Object.assign({},ee[Ie]);return Object.assign(Qe,{cluster:!0,cluster_id:Fe[Y+Xe],point_count:re,point_count_abbreviated:we})}function Oe(Fe){return Fe/360+.5}function qt(Fe){const Y=Math.sin(Fe*Math.PI/180),ee=.5-.25*Math.log((1+Y)/(1-Y))/Math.PI;return ee<0?0:ee>1?1:ee}function Sr(Fe){const Y=(180-360*Fe)*Math.PI/180;return 360*Math.atan(Math.exp(Y))/Math.PI-90}var Ir={exports:{}};Ir.exports=function(){function Fe(ye,be,Me,De){for(var Le,qe=De,Ue=Me-be>>1,Ze=Me-be,ot=ye[be],We=ye[be+1],xt=ye[Me],rr=ye[Me+1],yt=be+3;yt<Me;yt+=3){var _r=Y(ye[yt],ye[yt+1],ot,We,xt,rr);if(_r>qe)Le=yt,qe=_r;else if(_r===qe){var wr=Math.abs(yt-Ue);wr<Ze&&(Le=yt,Ze=wr)}}qe>De&&(Le-be>3&&Fe(ye,be,Le,De),ye[Le+2]=qe,Me-Le>3&&Fe(ye,Le,Me,De))}function Y(ye,be,Me,De,Le,qe){var Ue=Le-Me,Ze=qe-De;if(Ue!==0||Ze!==0){var ot=((ye-Me)*Ue+(be-De)*Ze)/(Ue*Ue+Ze*Ze);ot>1?(Me=Le,De=qe):ot>0&&(Me+=Ue*ot,De+=Ze*ot)}return(Ue=ye-Me)*Ue+(Ze=be-De)*Ze}function ee(ye,be,Me,De){var Le={id:ye===void 0?null:ye,type:be,geometry:Me,tags:De,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(qe){var Ue=qe.geometry,Ze=qe.type;if(Ze==="Point"||Ze==="MultiPoint"||Ze==="LineString")re(qe,Ue);else if(Ze==="Polygon"||Ze==="MultiLineString")for(var ot=0;ot<Ue.length;ot++)re(qe,Ue[ot]);else if(Ze==="MultiPolygon")for(ot=0;ot<Ue.length;ot++)for(var We=0;We<Ue[ot].length;We++)re(qe,Ue[ot][We])}(Le),Le}function re(ye,be){for(var Me=0;Me<be.length;Me+=3)ye.minX=Math.min(ye.minX,be[Me]),ye.minY=Math.min(ye.minY,be[Me+1]),ye.maxX=Math.max(ye.maxX,be[Me]),ye.maxY=Math.max(ye.maxY,be[Me+1])}function we(ye,be,Me,De){if(be.geometry){var Le=be.geometry.coordinates,qe=be.geometry.type,Ue=Math.pow(Me.tolerance/((1<<Me.maxZoom)*Me.extent),2),Ze=[],ot=be.id;if(Me.promoteId?ot=be.properties[Me.promoteId]:Me.generateId&&(ot=De||0),qe==="Point")Ie(Le,Ze);else if(qe==="MultiPoint")for(var We=0;We<Le.length;We++)Ie(Le[We],Ze);else if(qe==="LineString")Qe(Le,Ze,Ue,!1);else if(qe==="MultiLineString"){if(Me.lineMetrics){for(We=0;We<Le.length;We++)Qe(Le[We],Ze=[],Ue,!1),ye.push(ee(ot,"LineString",Ze,be.properties));return}tt(Le,Ze,Ue,!1)}else if(qe==="Polygon")tt(Le,Ze,Ue,!0);else{if(qe!=="MultiPolygon"){if(qe==="GeometryCollection"){for(We=0;We<be.geometry.geometries.length;We++)we(ye,{id:ot,geometry:be.geometry.geometries[We],properties:be.properties},Me,De);return}throw new Error("Input data is not a valid GeoJSON object.")}for(We=0;We<Le.length;We++){var xt=[];tt(Le[We],xt,Ue,!0),Ze.push(xt)}}ye.push(ee(ot,qe,Ze,be.properties))}}function Ie(ye,be){be.push(Be(ye[0])),be.push(gt(ye[1])),be.push(0)}function Qe(ye,be,Me,De){for(var Le,qe,Ue=0,Ze=0;Ze<ye.length;Ze++){var ot=Be(ye[Ze][0]),We=gt(ye[Ze][1]);be.push(ot),be.push(We),be.push(0),Ze>0&&(Ue+=De?(Le*We-ot*qe)/2:Math.sqrt(Math.pow(ot-Le,2)+Math.pow(We-qe,2))),Le=ot,qe=We}var xt=be.length-3;be[2]=1,Fe(be,0,xt,Me),be[xt+2]=1,be.size=Math.abs(Ue),be.start=0,be.end=be.size}function tt(ye,be,Me,De){for(var Le=0;Le<ye.length;Le++){var qe=[];Qe(ye[Le],qe,Me,De),be.push(qe)}}function Be(ye){return ye/360+.5}function gt(ye){var be=Math.sin(ye*Math.PI/180),Me=.5-.25*Math.log((1+be)/(1-be))/Math.PI;return Me<0?0:Me>1?1:Me}function Tt(ye,be,Me,De,Le,qe,Ue,Ze){if(De/=be,qe>=(Me/=be)&&Ue<De)return ye;if(Ue<Me||qe>=De)return null;for(var ot=[],We=0;We<ye.length;We++){var xt=ye[We],rr=xt.geometry,yt=xt.type,_r=Le===0?xt.minX:xt.minY,wr=Le===0?xt.maxX:xt.maxY;if(_r>=Me&&wr<De)ot.push(xt);else if(!(wr<Me||_r>=De)){var Bt=[];if(yt==="Point"||yt==="MultiPoint")At(rr,Bt,Me,De,Le);else if(yt==="LineString")mr(rr,Bt,Me,De,Le,!1,Ze.lineMetrics);else if(yt==="MultiLineString")Pr(rr,Bt,Me,De,Le,!1);else if(yt==="Polygon")Pr(rr,Bt,Me,De,Le,!0);else if(yt==="MultiPolygon")for(var yr=0;yr<rr.length;yr++){var Qr=[];Pr(rr[yr],Qr,Me,De,Le,!0),Qr.length&&Bt.push(Qr)}if(Bt.length){if(Ze.lineMetrics&&yt==="LineString"){for(yr=0;yr<Bt.length;yr++)ot.push(ee(xt.id,yt,Bt[yr],xt.tags));continue}yt!=="LineString"&&yt!=="MultiLineString"||(Bt.length===1?(yt="LineString",Bt=Bt[0]):yt="MultiLineString"),yt!=="Point"&&yt!=="MultiPoint"||(yt=Bt.length===3?"Point":"MultiPoint"),ot.push(ee(xt.id,yt,Bt,xt.tags))}}}return ot.length?ot:null}function At(ye,be,Me,De,Le){for(var qe=0;qe<ye.length;qe+=3){var Ue=ye[qe+Le];Ue>=Me&&Ue<=De&&(be.push(ye[qe]),be.push(ye[qe+1]),be.push(ye[qe+2]))}}function mr(ye,be,Me,De,Le,qe,Ue){for(var Ze,ot,We=nn(ye),xt=Le===0?Yr:br,rr=ye.start,yt=0;yt<ye.length-3;yt+=3){var _r=ye[yt],wr=ye[yt+1],Bt=ye[yt+2],yr=ye[yt+3],Qr=ye[yt+4],Wn=Le===0?_r:wr,Er=Le===0?yr:Qr,on=!1;Ue&&(Ze=Math.sqrt(Math.pow(_r-yr,2)+Math.pow(wr-Qr,2))),Wn<Me?Er>Me&&(ot=xt(We,_r,wr,yr,Qr,Me),Ue&&(We.start=rr+Ze*ot)):Wn>De?Er<De&&(ot=xt(We,_r,wr,yr,Qr,De),Ue&&(We.start=rr+Ze*ot)):Cr(We,_r,wr,Bt),Er<Me&&Wn>=Me&&(ot=xt(We,_r,wr,yr,Qr,Me),on=!0),Er>De&&Wn<=De&&(ot=xt(We,_r,wr,yr,Qr,De),on=!0),!qe&&on&&(Ue&&(We.end=rr+Ze*ot),be.push(We),We=nn(ye)),Ue&&(rr+=Ze)}var Br=ye.length-3;_r=ye[Br],wr=ye[Br+1],Bt=ye[Br+2],(Wn=Le===0?_r:wr)>=Me&&Wn<=De&&Cr(We,_r,wr,Bt),Br=We.length-3,qe&&Br>=3&&(We[Br]!==We[0]||We[Br+1]!==We[1])&&Cr(We,We[0],We[1],We[2]),We.length&&be.push(We)}function nn(ye){var be=[];return be.size=ye.size,be.start=ye.start,be.end=ye.end,be}function Pr(ye,be,Me,De,Le,qe){for(var Ue=0;Ue<ye.length;Ue++)mr(ye[Ue],be,Me,De,Le,qe,!1)}function Cr(ye,be,Me,De){ye.push(be),ye.push(Me),ye.push(De)}function Yr(ye,be,Me,De,Le,qe){var Ue=(qe-be)/(De-be);return ye.push(qe),ye.push(Me+(Le-Me)*Ue),ye.push(1),Ue}function br(ye,be,Me,De,Le,qe){var Ue=(qe-Me)/(Le-Me);return ye.push(be+(De-be)*Ue),ye.push(qe),ye.push(1),Ue}function Te(ye,be){for(var Me=[],De=0;De<ye.length;De++){var Le,qe=ye[De],Ue=qe.type;if(Ue==="Point"||Ue==="MultiPoint"||Ue==="LineString")Le=Pe(qe.geometry,be);else if(Ue==="MultiLineString"||Ue==="Polygon"){Le=[];for(var Ze=0;Ze<qe.geometry.length;Ze++)Le.push(Pe(qe.geometry[Ze],be))}else if(Ue==="MultiPolygon")for(Le=[],Ze=0;Ze<qe.geometry.length;Ze++){for(var ot=[],We=0;We<qe.geometry[Ze].length;We++)ot.push(Pe(qe.geometry[Ze][We],be));Le.push(ot)}Me.push(ee(qe.id,Ue,Le,qe.tags))}return Me}function Pe(ye,be){var Me=[];Me.size=ye.size,ye.start!==void 0&&(Me.start=ye.start,Me.end=ye.end);for(var De=0;De<ye.length;De+=3)Me.push(ye[De]+be,ye[De+1],ye[De+2]);return Me}function et(ye,be){if(ye.transformed)return ye;var Me,De,Le,qe=1<<ye.z,Ue=ye.x,Ze=ye.y;for(Me=0;Me<ye.features.length;Me++){var ot=ye.features[Me],We=ot.geometry,xt=ot.type;if(ot.geometry=[],xt===1)for(De=0;De<We.length;De+=2)ot.geometry.push(_t(We[De],We[De+1],be,qe,Ue,Ze));else for(De=0;De<We.length;De++){var rr=[];for(Le=0;Le<We[De].length;Le+=2)rr.push(_t(We[De][Le],We[De][Le+1],be,qe,Ue,Ze));ot.geometry.push(rr)}}return ye.transformed=!0,ye}function _t(ye,be,Me,De,Le,qe){return[Math.round(Me*(ye*De-Le)),Math.round(Me*(be*De-qe))]}function Rt(ye,be,Me,De,Le){for(var qe=be===Le.maxZoom?0:Le.tolerance/((1<<be)*Le.extent),Ue={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:Me,y:De,z:be,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ze=0;Ze<ye.length;Ze++){Ue.numFeatures++,bt(Ue,ye[Ze],qe,Le);var ot=ye[Ze].minX,We=ye[Ze].minY,xt=ye[Ze].maxX,rr=ye[Ze].maxY;ot<Ue.minX&&(Ue.minX=ot),We<Ue.minY&&(Ue.minY=We),xt>Ue.maxX&&(Ue.maxX=xt),rr>Ue.maxY&&(Ue.maxY=rr)}return Ue}function bt(ye,be,Me,De){var Le=be.geometry,qe=be.type,Ue=[];if(qe==="Point"||qe==="MultiPoint")for(var Ze=0;Ze<Le.length;Ze+=3)Ue.push(Le[Ze]),Ue.push(Le[Ze+1]),ye.numPoints++,ye.numSimplified++;else if(qe==="LineString")ct(Ue,Le,ye,Me,!1,!1);else if(qe==="MultiLineString"||qe==="Polygon")for(Ze=0;Ze<Le.length;Ze++)ct(Ue,Le[Ze],ye,Me,qe==="Polygon",Ze===0);else if(qe==="MultiPolygon")for(var ot=0;ot<Le.length;ot++){var We=Le[ot];for(Ze=0;Ze<We.length;Ze++)ct(Ue,We[Ze],ye,Me,!0,Ze===0)}if(Ue.length){var xt=be.tags||null;if(qe==="LineString"&&De.lineMetrics){for(var rr in xt={},be.tags)xt[rr]=be.tags[rr];xt.mapbox_clip_start=Le.start/Le.size,xt.mapbox_clip_end=Le.end/Le.size}var yt={geometry:Ue,type:qe==="Polygon"||qe==="MultiPolygon"?3:qe==="LineString"||qe==="MultiLineString"?2:1,tags:xt};be.id!==null&&(yt.id=be.id),ye.features.push(yt)}}function ct(ye,be,Me,De,Le,qe){var Ue=De*De;if(De>0&&be.size<(Le?Ue:De))Me.numPoints+=be.length/3;else{for(var Ze=[],ot=0;ot<be.length;ot+=3)(De===0||be[ot+2]>Ue)&&(Me.numSimplified++,Ze.push(be[ot]),Ze.push(be[ot+1])),Me.numPoints++;Le&&function(We,xt){for(var rr=0,yt=0,_r=We.length,wr=_r-2;yt<_r;wr=yt,yt+=2)rr+=(We[yt]-We[wr])*(We[yt+1]+We[wr+1]);if(rr>0===xt)for(yt=0,_r=We.length;yt<_r/2;yt+=2){var Bt=We[yt],yr=We[yt+1];We[yt]=We[_r-2-yt],We[yt+1]=We[_r-1-yt],We[_r-2-yt]=Bt,We[_r-1-yt]=yr}}(Ze,qe),ye.push(Ze)}}function It(ye,be){var Me=(be=this.options=function(Le,qe){for(var Ue in qe)Le[Ue]=qe[Ue];return Le}(Object.create(this.options),be)).debug;if(Me&&console.time("preprocess data"),be.maxZoom<0||be.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(be.promoteId&&be.generateId)throw new Error("promoteId and generateId cannot be used together.");var De=function(Le,qe){var Ue=[];if(Le.type==="FeatureCollection")for(var Ze=0;Ze<Le.features.length;Ze++)we(Ue,Le.features[Ze],qe,Ze);else we(Ue,Le.type==="Feature"?Le:{geometry:Le},qe);return Ue}(ye,be);this.tiles={},this.tileCoords=[],Me&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",be.indexMaxZoom,be.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(De=function(Le,qe){var Ue=qe.buffer/qe.extent,Ze=Le,ot=Tt(Le,1,-1-Ue,Ue,0,-1,2,qe),We=Tt(Le,1,1-Ue,2+Ue,0,-1,2,qe);return(ot||We)&&(Ze=Tt(Le,1,-Ue,1+Ue,0,-1,2,qe)||[],ot&&(Ze=Te(ot,1).concat(Ze)),We&&(Ze=Ze.concat(Te(We,-1)))),Ze}(De,be)).length&&this.splitTile(De,0,0,0),Me&&(De.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Mt(ye,be,Me){return 32*((1<<ye)*Me+be)+ye}return It.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},It.prototype.splitTile=function(ye,be,Me,De,Le,qe,Ue){for(var Ze=[ye,be,Me,De],ot=this.options,We=ot.debug;Ze.length;){De=Ze.pop(),Me=Ze.pop(),be=Ze.pop(),ye=Ze.pop();var xt=1<<be,rr=Mt(be,Me,De),yt=this.tiles[rr];if(!yt&&(We>1&&console.time("creation"),yt=this.tiles[rr]=Rt(ye,be,Me,De,ot),this.tileCoords.push({z:be,x:Me,y:De}),We)){We>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",be,Me,De,yt.numFeatures,yt.numPoints,yt.numSimplified),console.timeEnd("creation"));var _r="z"+be;this.stats[_r]=(this.stats[_r]||0)+1,this.total++}if(yt.source=ye,Le){if(be===ot.maxZoom||be===Le)continue;var wr=1<<Le-be;if(Me!==Math.floor(qe/wr)||De!==Math.floor(Ue/wr))continue}else if(be===ot.indexMaxZoom||yt.numPoints<=ot.indexMaxPoints)continue;if(yt.source=null,ye.length!==0){We>1&&console.time("clipping");var Bt,yr,Qr,Wn,Er,on,Br=.5*ot.buffer/ot.extent,ro=.5-Br,qo=.5+Br,bi=1+Br;Bt=yr=Qr=Wn=null,Er=Tt(ye,xt,Me-Br,Me+qo,0,yt.minX,yt.maxX,ot),on=Tt(ye,xt,Me+ro,Me+bi,0,yt.minX,yt.maxX,ot),ye=null,Er&&(Bt=Tt(Er,xt,De-Br,De+qo,1,yt.minY,yt.maxY,ot),yr=Tt(Er,xt,De+ro,De+bi,1,yt.minY,yt.maxY,ot),Er=null),on&&(Qr=Tt(on,xt,De-Br,De+qo,1,yt.minY,yt.maxY,ot),Wn=Tt(on,xt,De+ro,De+bi,1,yt.minY,yt.maxY,ot),on=null),We>1&&console.timeEnd("clipping"),Ze.push(Bt||[],be+1,2*Me,2*De),Ze.push(yr||[],be+1,2*Me,2*De+1),Ze.push(Qr||[],be+1,2*Me+1,2*De),Ze.push(Wn||[],be+1,2*Me+1,2*De+1)}}},It.prototype.getTile=function(ye,be,Me){var De=this.options,Le=De.extent,qe=De.debug;if(ye<0||ye>24)return null;var Ue=1<<ye,Ze=Mt(ye,be=(be%Ue+Ue)%Ue,Me);if(this.tiles[Ze])return et(this.tiles[Ze],Le);qe>1&&console.log("drilling down to z%d-%d-%d",ye,be,Me);for(var ot,We=ye,xt=be,rr=Me;!ot&&We>0;)We--,xt=Math.floor(xt/2),rr=Math.floor(rr/2),ot=this.tiles[Mt(We,xt,rr)];return ot&&ot.source?(qe>1&&console.log("found parent tile z%d-%d-%d",We,xt,rr),qe>1&&console.time("drilling down"),this.splitTile(ot.source,We,xt,rr,ye,be,Me),qe>1&&console.timeEnd("drilling down"),this.tiles[Ze]?et(this.tiles[Ze],Le):null):null},function(ye,be){return new It(ye,be)}}();var Xr=E.getDefaultExportFromCjs(Ir.exports);function Ur(Fe,Y){const ee=Fe.tileID.canonical;if(!this._geoJSONIndex)return Y(null,null);const re=this._geoJSONIndex.getTile(ee.z,ee.x,ee.y);if(!re)return Y(null,null);const we=new class{constructor(Qe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=E.EXTENT,this.length=Qe.length,this._features=Qe}feature(Qe){return new class{constructor(tt){this._feature=tt,this.extent=E.EXTENT,this.type=tt.type,this.properties=tt.tags,"id"in tt&&!isNaN(tt.id)&&(this.id=parseInt(tt.id,10))}loadGeometry(){if(this._feature.type===1){const tt=[];for(const Be of this._feature.geometry)tt.push([new E.Point(Be[0],Be[1])]);return tt}{const tt=[];for(const Be of this._feature.geometry){const gt=[];for(const Tt of Be)gt.push(new E.Point(Tt[0],Tt[1]));tt.push(gt)}return tt}}toGeoJSON(tt,Be,gt){return j.call(this,tt,Be,gt)}}(this._features[Qe])}}(re.features);let Ie=Ne(we);Ie.byteOffset===0&&Ie.byteLength===Ie.buffer.byteLength||(Ie=new Uint8Array(Ie)),Y(null,{vectorTile:we,rawData:Ie.buffer})}class pr extends E.VectorTileWorkerSource{constructor(Y,ee,re,we,Ie,Qe){super(Y,ee,re,we,Ur,Qe),Ie&&(this.loadGeoJSON=Ie)}loadData(Y,ee){const re=Y&&Y.request,we=re&&re.collectResourceTiming;this.loadGeoJSON(Y,(Ie,Qe)=>{if(Ie||!Qe)return ee(Ie);if(typeof Qe!="object")return ee(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));{G(Qe,!0);try{if(Y.filter){const Be=E.createExpression(Y.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Be.result==="error")throw new Error(Be.value.map(Tt=>`${Tt.key}: ${Tt.message}`).join(", "));Qe={type:"FeatureCollection",features:Qe.features.filter(Tt=>Be.value.evaluate({zoom:0},Tt))}}this._geoJSONIndex=Y.cluster?new Pt(function({superclusterOptions:Be,clusterProperties:gt}){if(!gt||!Be)return Be;const Tt={},At={},mr={accumulated:null,zoom:0},nn={properties:null},Pr=Object.keys(gt);for(const Cr of Pr){const[Yr,br]=gt[Cr],Te=E.createExpression(br),Pe=E.createExpression(typeof Yr=="string"?[Yr,["accumulated"],["get",Cr]]:Yr);Tt[Cr]=Te.value,At[Cr]=Pe.value}return Be.map=Cr=>{nn.properties=Cr;const Yr={};for(const br of Pr)Yr[br]=Tt[br].evaluate(mr,nn);return Yr},Be.reduce=(Cr,Yr)=>{nn.properties=Yr;for(const br of Pr)mr.accumulated=Cr[br],Cr[br]=At[br].evaluate(mr,nn)},Be}(Y)).load(Qe.features):Xr(Qe,Y.geojsonVtOptions)}catch(Be){return ee(Be)}this.loaded={};const tt={};if(we){const Be=E.getPerformanceMeasurement(re);Be&&(tt.resourceTiming={},tt.resourceTiming[Y.source]=JSON.parse(JSON.stringify(Be)))}ee(null,tt)}})}reloadTile(Y,ee){const re=this.loaded;return re&&re[Y.uid]?super.reloadTile(Y,ee):this.loadTile(Y,ee)}loadGeoJSON(Y,ee){if(Y.request)E.getJSON(Y.request,ee);else{if(typeof Y.data!="string")return ee(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`));try{return ee(null,JSON.parse(Y.data))}catch{return ee(new Error(`Input data given to '${Y.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(Y,ee){try{ee(null,this._geoJSONIndex.getClusterExpansionZoom(Y.clusterId))}catch(re){ee(re)}}getClusterChildren(Y,ee){try{ee(null,this._geoJSONIndex.getChildren(Y.clusterId))}catch(re){ee(re)}}getClusterLeaves(Y,ee){try{ee(null,this._geoJSONIndex.getLeaves(Y.clusterId,Y.limit,Y.offset))}catch(re){ee(re)}}}class ar{constructor(Y,ee){this.tileID=new E.OverscaledTileID(Y.tileID.overscaledZ,Y.tileID.wrap,Y.tileID.canonical.z,Y.tileID.canonical.x,Y.tileID.canonical.y),this.tileZoom=Y.tileZoom,this.uid=Y.uid,this.zoom=Y.zoom,this.canonical=Y.tileID.canonical,this.pixelRatio=Y.pixelRatio,this.tileSize=Y.tileSize,this.source=Y.source,this.overscaling=this.tileID.overscaleFactor(),this.enableTerrain=!!Y.enableTerrain,this.projection=Y.projection,this.brightness=ee}async parse(Y,ee,re,we){this.status="parsing";const Ie=new E.OverscaledTileID(re.tileID.overscaledZ,re.tileID.wrap,re.tileID.canonical.z,re.tileID.canonical.x,re.tileID.canonical.y),Qe={},tt=ee.familiesBySource[re.source],Be=new E.FeatureIndex(Ie,re.promoteId);Be.bucketLayerIDs=[];const gt=await E.load3DTile(Y),Tt=E.convertB3dm(gt.gltf,1/E.tileToMeter(re.tileID.canonical)),At=gt.gltf.json.extensionsUsed&&gt.gltf.json.extensionsUsed.includes("MAPBOX_mesh_features");for(const mr in tt)for(const nn of tt[mr]){const Pr=nn[0],Cr=gt.gltf.json.extensionsUsed,Yr=new E.Tiled3dModelBucket(Tt,Ie,Cr&&Cr.includes("MAPBOX_mesh_features"),this.brightness);At||(Yr.needsUpload=!0),Qe[Pr.id]=Yr}this.status="done",we(null,{buckets:Qe,featureIndex:Be})}}class hr{constructor(Y,ee,re,we,Ie,Qe){this.actor=Y,this.layerIndex=ee,this.brightness=Qe,this.loading={},this.loaded={}}loadTile(Y,ee){const re=Y.uid,we=this.loading[re]=new ar(Y,this.brightness);E.getArrayBuffer(Y.request,(Ie,Qe)=>{const tt=!this.loading[re];return delete this.loading[re],tt||Ie?(we.status="done",tt||(this.loaded[re]=we),ee(Ie)):Qe&&Qe.byteLength!==0?(we.parse(Qe,this.layerIndex,Y,ee),this.loaded=this.loaded||{},void(this.loaded[re]=we)):(we.status="done",this.loaded[re]=we,ee())})}reloadTile(Y,ee){const re=this.loaded,we=Y.uid;if(re&&re[we]){const Ie=re[we];Ie.enableTerrain=!!Y.enableTerrain,Ie.projection=Y.projection,Ie.brightness=Y.brightness;const Qe=(tt,Be)=>{Ie.reloadCallback&&(delete Ie.reloadCallback,this.loadTile(Y,ee)),ee(tt,Be)};Ie.status==="parsing"?Ie.reloadCallback=Qe:Ie.status==="done"&&this.loadTile(Y,ee)}}abortTile(Y,ee){const re=Y.uid;this.loading[re]&&delete this.loading[re],ee()}removeTile(Y,ee){const re=this.loaded,we=Y.uid;re&&re[we]&&delete re[we],ee()}}class xr{constructor(Y){this.self=Y,this.actor=new E.Actor(Y,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=E.getProjection({name:"mercator"}),this.workerSourceTypes={vector:E.VectorTileWorkerSource,geojson:pr,"batched-model":hr},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ee,re)=>{if(this.workerSourceTypes[ee])throw new Error(`Worker source with name "${ee}" already registered.`);this.workerSourceTypes[ee]=re},this.self.registerRTLTextPlugin=ee=>{if(E.plugin.isParsed())throw new Error("RTL text plugin already registered.");E.plugin.applyArabicShaping=ee.applyArabicShaping,E.plugin.processBidirectionalText=ee.processBidirectionalText,E.plugin.processStyledBidirectionalText=ee.processStyledBidirectionalText}}clearCaches(Y,ee,re){delete this.layerIndexes[Y],delete this.availableImages[Y],delete this.workerSources[Y],delete this.demWorkerSources[Y],re()}checkIfReady(Y,ee,re){re()}setReferrer(Y,ee){this.referrer=ee}spriteLoaded(Y,ee){this.isSpriteLoaded[Y]||(this.isSpriteLoaded[Y]={}),this.isSpriteLoaded[Y][ee.scope]=ee.isLoaded;for(const re in this.workerSources[Y]){const we=this.workerSources[Y][re];for(const Ie in we)we[Ie]instanceof E.VectorTileWorkerSource&&(we[Ie].isSpriteLoaded=ee.isLoaded,we[Ie].fire(new E.Event("isSpriteLoaded")))}}setImages(Y,ee,re){const{scope:we,images:Ie}=ee;this.availableImages[Y]||(this.availableImages[Y]={}),this.availableImages[Y][we]=Ie;for(const Qe in this.workerSources[Y]){const tt=this.workerSources[Y][Qe];for(const Be in tt)tt[Be].availableImages=Ie}re()}enableTerrain(Y,ee,re){this.terrain=ee,re()}setProjection(Y,ee){this.projections[Y]=E.getProjection(ee)}setBrightness(Y,ee,re){this.brightness=ee,re()}setLayers(Y,ee,re){this.getLayerIndex(Y,ee.scope).replace(ee.layers,ee.options),re()}updateLayers(Y,ee,re){this.getLayerIndex(Y,ee.scope).update(ee.layers,ee.removedIds,ee.options),re()}loadTile(Y,ee,re){const we=this.enableTerrain?E.extend({enableTerrain:this.terrain},ee):ee;we.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,ee.type,ee.source,ee.scope).loadTile(we,re)}loadDEMTile(Y,ee,re){const we=this.enableTerrain?E.extend({buildQuadTree:this.terrain},ee):ee;this.getDEMWorkerSource(Y,ee.source,ee.scope).loadTile(we,re)}reloadTile(Y,ee,re){const we=this.enableTerrain?E.extend({enableTerrain:this.terrain},ee):ee;we.projection=this.projections[Y]||this.defaultProjection,this.getWorkerSource(Y,ee.type,ee.source,ee.scope).reloadTile(we,re)}abortTile(Y,ee,re){this.getWorkerSource(Y,ee.type,ee.source,ee.scope).abortTile(ee,re)}removeTile(Y,ee,re){this.getWorkerSource(Y,ee.type,ee.source,ee.scope).removeTile(ee,re)}removeSource(Y,ee,re){if(!this.workerSources[Y]||!this.workerSources[Y][ee.type]||!this.workerSources[Y][ee.type][ee.source])return;const we=this.workerSources[Y][ee.type][ee.source];delete this.workerSources[Y][ee.type][ee.source],we.removeSource!==void 0?we.removeSource(ee,re):re()}loadWorkerSource(Y,ee,re){try{this.self.importScripts(ee.url),re()}catch(we){re(we.toString())}}syncRTLPluginState(Y,ee,re){try{E.plugin.setState(ee);const we=E.plugin.getPluginURL();if(E.plugin.isLoaded()&&!E.plugin.isParsed()&&we!=null){this.self.importScripts(we);const Ie=E.plugin.isParsed();re(Ie?void 0:new Error(`RTL Text Plugin failed to import scripts from ${we}`),Ie)}}catch(we){re(we.toString())}}setLoadersUrl(Y,ee){this.loadersUrl=ee}getAvailableImages(Y,ee){this.availableImages[Y]||(this.availableImages[Y]={});let re=this.availableImages[Y][ee];return re||(re=[]),re}getLayerIndex(Y,ee){this.layerIndexes[Y]||(this.layerIndexes[Y]={});let re=this.layerIndexes[Y][ee];return re||(re=this.layerIndexes[Y][ee]=new R),re}getWorkerSource(Y,ee,re,we){if(this.workerSources[Y]||(this.workerSources[Y]={}),this.workerSources[Y][ee]||(this.workerSources[Y][ee]={}),this.isSpriteLoaded[Y]||(this.isSpriteLoaded[Y]={}),!this.workerSources[Y][ee][re]){const Ie={send:(Qe,tt,Be,gt,Tt,At)=>{this.actor.send(Qe,tt,Be,Y,Tt,At)},scheduler:this.actor.scheduler};this.workerSources[Y][ee][re]=new this.workerSourceTypes[ee](Ie,this.getLayerIndex(Y,we),this.getAvailableImages(Y,we),this.isSpriteLoaded[Y][we],void 0,this.brightness)}return this.workerSources[Y][ee][re]}getDEMWorkerSource(Y,ee,re){return this.demWorkerSources[Y]||(this.demWorkerSources[Y]={}),this.demWorkerSources[Y][re]||(this.demWorkerSources[Y][re]={}),this.demWorkerSources[Y][re][ee]||(this.demWorkerSources[Y][re][ee]=new D),this.demWorkerSources[Y][re][ee]}enforceCacheSizeLimit(Y,ee){E.enforceCacheSizeLimit(ee)}getWorkerPerformanceMetrics(Y,ee,re){re(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new xr(self)),xr}),g(["./shared"],function(E){return E.exported});var x=f;return x})})(HD);var ere=HD.exports;const ZD=Gh(ere);var tre=Object.defineProperty,rre=(n,o,l)=>o in n?tre(n,o,{enumerable:!0,configurable:!0,writable:!0,value:l}):n[o]=l,nre=(n,o,l)=>(rre(n,typeof o!="symbol"?o+"":o,l),l);let ire=class extends ZD.Map{constructor(o){super(o),nre(this,"_groupLayers",new Map)}getGroupLayer(o){return this._groupLayers.get(o)}addGroupLayer(o,l){if(this.getGroupLayer(o))throw new Error(`The groupLayer '${o}' has already existed.`);const{sources:h={},layers:f=[],bounds:g,fitBoundsOptions:x={padding:{top:20,bottom:20,left:20,right:20}},flyToOptions:E}=l;for(const w in h)Object.prototype.hasOwnProperty.call(h,w)&&(this.getSource(w)?console.warn(`The source '${w}' has already existed.`):this.addSource(w,h[w]));for(const w of f){if(this.getLayer(w.id))throw new Error(`The layer '${w.id}' has already existed.`);{const I=w.metadata||{},R=I.before?this._getBeforeLayerId(w.id,I.before):void 0;w.metadata={...I,grouplayer:o},this.addLayer(w,R),this._setLayerCursor(w)}}return g?this.fitBounds(g,x):E&&this.flyTo(E),this._groupLayers.set(o,l),this}removeGroupLayer(o,l=!0){const h=this.getGroupLayer(o);if(h){const{sources:f={},layers:g=[]}=h;for(const x of g){const E=x.id;this.getLayer(E)&&this.removeLayer(E),x.source&&typeof x.source=="object"&&l&&this.getSource(E)&&this.removeSource(E)}l&&Object.keys(f).map(x=>{this.getSource(x)&&this.removeSource(x)}),this._groupLayers.delete(o)}return this}removeGroupLayers(o=!0){return this._groupLayers.forEach((l,h)=>{this.removeGroupLayer(h,o)}),this}setBasemapStyle(o,l=!0,h){this.setStyle(o,h);const f=l?new Map(this._groupLayers):void 0;this._groupLayers.clear(),f&&this.once("styledata",()=>{f.forEach((g,x)=>{this.addGroupLayer(x,g)})})}_getBeforeLayerIdByString(o){const l=this.getGroupLayer(o);return l&&l.layers.length>0?l.layers[0].id:this.getLayer(o)?o:void 0}_getBeforeLayerId(o,l){let h;if(typeof l=="string")h=this._getBeforeLayerIdByString(l);else if(Array.isArray(l)){for(const f of l)if(h=this._getBeforeLayerIdByString(f),h)break}return h||console.warn(`Layer with id "${l}" does not exist on this map. The layer with id "${o}" will be appended to the end of the layers array and appear visually above all other layers.`),h}_setLayerCursor(o){const l=o.metadata||{},h=o.id;l&&l.cursor&&(this.on("mouseenter",h,()=>{this.getCanvas().style.cursor=l.cursor}),this.on("mouseleave",h,()=>{this.getCanvas().style.cursor=""}))}};const qP=n=>{let o;const l=new Set,h=(w,I)=>{const R=typeof w=="function"?w(o):w;if(!Object.is(R,o)){const D=o;o=I??typeof R!="object"?R:Object.assign({},o,R),l.forEach(F=>F(o,D))}},f=()=>o,E={setState:h,getState:f,subscribe:w=>(l.add(w),()=>l.delete(w)),destroy:()=>{l.clear()}};return o=n(h,f,E),E},ore=n=>n?qP(n):qP;var XD={exports:{}},YD={},KD={exports:{}},JD={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uh=A;function are(n,o){return n===o&&(n!==0||1/n===1/o)||n!==n&&o!==o}var sre=typeof Object.is=="function"?Object.is:are,lre=Uh.useState,cre=Uh.useEffect,ure=Uh.useLayoutEffect,hre=Uh.useDebugValue;function dre(n,o){var l=o(),h=lre({inst:{value:l,getSnapshot:o}}),f=h[0].inst,g=h[1];return ure(function(){f.value=l,f.getSnapshot=o,qb(f)&&g({inst:f})},[n,l,o]),cre(function(){return qb(f)&&g({inst:f}),n(function(){qb(f)&&g({inst:f})})},[n]),hre(l),l}function qb(n){var o=n.getSnapshot;n=n.value;try{var l=o();return!sre(n,l)}catch{return!0}}function fre(n,o){return o()}var pre=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?fre:dre;JD.useSyncExternalStore=Uh.useSyncExternalStore!==void 0?Uh.useSyncExternalStore:pre;KD.exports=JD;var mre=KD.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yy=A,gre=mre;function _re(n,o){return n===o&&(n!==0||1/n===1/o)||n!==n&&o!==o}var yre=typeof Object.is=="function"?Object.is:_re,vre=gre.useSyncExternalStore,xre=yy.useRef,bre=yy.useEffect,wre=yy.useMemo,Ere=yy.useDebugValue;YD.useSyncExternalStoreWithSelector=function(n,o,l,h,f){var g=xre(null);if(g.current===null){var x={hasValue:!1,value:null};g.current=x}else x=g.current;g=wre(function(){function w(q){if(!I){if(I=!0,R=q,q=h(q),f!==void 0&&x.hasValue){var G=x.value;if(f(G,q))return D=G}return D=q}if(G=D,yre(R,q))return G;var j=h(q);return f!==void 0&&f(G,j)?G:(R=q,D=j)}var I=!1,R,D,F=l===void 0?null:l;return[function(){return w(o())},F===null?void 0:function(){return w(F())}]},[o,l,h,f]);var E=vre(n,g[0],g[1]);return bre(function(){x.hasValue=!0,x.value=E},[E]),Ere(E),E};XD.exports=YD;var Sre=XD.exports;const Tre=Gh(Sre),{useSyncExternalStoreWithSelector:Mre}=Tre;function Cre(n,o=n.getState,l){const h=Mre(n.subscribe,n.getState,n.getServerState||n.getState,o,l);return A.useDebugValue(h),h}const ZP=n=>{const o=typeof n=="function"?ore(n):n,l=(h,f)=>Cre(o,h,f);return Object.assign(l,o),l},Are=n=>n?ZP(n):ZP,vy=Are()((n,o)=>({map:void 0,setMap:l=>n({map:l}),removeMap:()=>{n({map:void 0})},addGroupLayer(l,h){const f=o().map;f&&f.addGroupLayer(l,h)},removeGroupLayer(l,h){const f=o().map;f&&f.removeGroupLayer(l,h)},removeGroupLayers(){const l=o().map;l&&l.removeGroupLayers()},getSource(l){const h=o().map;if(h)return h.getSource(l)},addSource(l,h){const f=o().map;f&&f.addSource(l,h)},removeSource(l){const h=o().map;h&&h.removeSource(l)},getLayer(l){const h=o().map;if(h)return h.getLayer(l)},addLayer(l,h){const f=o().map;f&&f.addLayer(l,h)},removeLayer(l){const h=o().map;h&&h.removeLayer(l)},setBasemapStyle(l,h,f){const g=o().map;g&&g.setBasemapStyle(l,h,f)},clear:l=>{const h=o().map;if(h&&h.getStyle())if(Array.isArray(l))for(let f=0,g=l.length;f<g;f++){const x=l[f];h.removeGroupLayer(x),h.getLayer(x)&&h.removeLayer(x),h.getSource(x)&&h.removeSource(x)}else{if(l.customStyleIds)for(let f=0,g=l.customStyleIds.length;f<g;f++)h.removeGroupLayer(l.customStyleIds[f]);if(l.layerIds)for(let f=0,g=l.layerIds.length;f<g;f++)h.removeLayer(l.layerIds[f]);if(l.sourceIds)for(let f=0,g=l.sourceIds.length;f<g;f++)h.removeSource(l.sourceIds[f])}}})),Ire=n=>{const{setMap:o,removeMap:l}=vy(),h=A.useRef(null),[f]=A.useState(Math.random().toString(16).substring(2));ZD.accessToken="pk.eyJ1IjoiY3F5aiIsImEiOiJja3d2cXcydTYyMnY1Mm5vMmh6N3d2a2s2In0.A4I9DmsUsrdbZuMRr922MQ";const x=Object.assign({},{style:"./standard-beta.json",container:f,center:[0,0],zoom:1.8},n.mapboxOptions);return A.useEffect(()=>{const E=new ire(x);return E.on("load",()=>{if(o(E),n.onMapLoaded&&n.onMapLoaded(E),n.sprites)for(const w in n.sprites){const I=n.sprites[w];E.loadImage(I,(R,D)=>{if(R)throw R;D&&!E.hasImage(w)&&E.addImage(w,D)})}}),E.on("remove",()=>{l()}),()=>E.remove()},[]),Ct.jsx("div",{id:f,className:n.className,style:{width:"100%",height:"100%"},ref:h})},Pre=()=>Ct.jsx("aside",{className:"w-28 p-2","aria-label":"Sidebar",children:Ct.jsx("div",{className:"overflow-y-auto p-2 rounded bg-gray-800",children:Ct.jsx("div",{className:"sidebar-menu space-y-1",children:eL.map((n,o)=>Ct.jsx(Kte,{to:n.path,children:n.name},o))})})});const kre=()=>Ct.jsx("div",{className:"bg-gray-900 h-[100vh] flex flex-col",children:Ct.jsxs("div",{className:"flex flex-auto",children:[Ct.jsx(Pre,{}),Ct.jsxs("div",{className:"flex-1 relative",children:[Ct.jsx(Ire,{}),Ct.jsx(Nte,{})]})]})});function Rre(){const n=pE(),o=WD();return console.error(o),Ct.jsx(CD,{status:"500",title:"500",subTitle:"对不起，服务器发生了错误。",extra:Ct.jsx(Y8,{type:"primary",onClick:()=>n("/"),children:"返回首页"})})}const zre=()=>{const n=pE();return Ct.jsx(CD,{status:"404",title:"404",subTitle:"对不起，您访问的页面不存在。",extra:Ct.jsx(Y8,{type:"primary",onClick:()=>n("/"),children:"返回首页"})})},Dre=Ct.jsx(Y3,{style:{fontSize:24},spin:!0}),QD=n=>{const{map:o}=vy();return Ct.jsx("div",{className:`widget bg-gray-800 bg-opacity-50 ${n.className}`,children:Ct.jsx($Q,{spinning:!o,indicator:Dre,children:n.children})})},Zb={showPlaceLabels:!0,showRoadLabels:!0,showPointOfInterestLabels:!0,showTransitLabels:!0,lightPreset:"day"},uc="maine",Lre=()=>{const{map:n}=vy();A.useEffect(()=>(n&&n.flyTo({center:[-68.137343,45.137451],zoom:5.5}),()=>{n&&(Object.keys(Zb).map(f=>{n.setConfigProperty("basemap",f,Zb[f])}),l())}),[n]);const o=f=>{const g=Object.keys(f)[0];n==null||n.setConfigProperty("basemap",g,f[g])},l=()=>{n&&(n.getLayer(uc)&&n.removeLayer(uc),n.getSource(uc)&&n.removeSource(uc))},h=f=>{n&&(l(),n.addSource(uc,{type:"geojson",data:"./maine.geojson"}),n.addLayer({id:uc,slot:f,source:uc,type:"fill",paint:{"fill-color":"#0080ff","fill-opacity":.5}}))};return Ct.jsxs(QD,{className:"w-[380px]",children:[Ct.jsxs(ml,{initialValues:Zb,labelCol:{span:5},wrapperCol:{span:19},onValuesChange:o,children:[Ct.jsx(ml.Item,{label:"地名注记",name:"showPlaceLabels",children:Ct.jsxs(vn.Group,{children:[Ct.jsx(vn,{value:!0,children:"开启"}),Ct.jsx(vn,{value:!1,children:"关闭"})]})}),Ct.jsx(ml.Item,{label:"道路注记",name:"showRoadLabels",children:Ct.jsxs(vn.Group,{children:[Ct.jsx(vn,{value:!0,children:"开启"}),Ct.jsx(vn,{value:!1,children:"关闭"})]})}),Ct.jsx(ml.Item,{label:"POI 注记",name:"showPointOfInterestLabels",children:Ct.jsxs(vn.Group,{children:[Ct.jsx(vn,{value:!0,children:"开启"}),Ct.jsx(vn,{value:!1,children:"关闭"})]})}),Ct.jsx(ml.Item,{label:"交通注记",name:"showTransitLabels",children:Ct.jsxs(vn.Group,{children:[Ct.jsx(vn,{value:!0,children:"开启"}),Ct.jsx(vn,{value:!1,children:"关闭"})]})}),Ct.jsx(ml.Item,{label:"预设灯光",name:"lightPreset",children:Ct.jsxs(vn.Group,{children:[Ct.jsx(vn,{value:"day",children:"白天"}),Ct.jsx(vn,{value:"night",children:"晚上"}),Ct.jsx(vn,{value:"dusk",children:"黄昏"}),Ct.jsx(vn,{value:"dawn",children:"黎明"})]})})]}),Ct.jsx(xD,{style:{margin:"6px 0"}}),Ct.jsx(ml,{labelCol:{span:5},wrapperCol:{span:19},children:Ct.jsx(ml.Item,{label:"图层插槽",children:Ct.jsxs(vn.Group,{onChange:f=>{h(f.target.value)},children:[Ct.jsx(vn,{value:"bottom",children:"面上方"}),Ct.jsx(vn,{value:"middle",children:"线上方"}),Ct.jsx(vn,{value:"none",children:"最上方"})]})})})]})},Ore=[{id:"1",title:"朝天门",camera:{center:[106.583,29.5667],zoom:15.78,bearing:-41.38,pitch:45.12}},{id:"2",title:"东方明珠",camera:{center:[121.4968,31.2402],zoom:16.06,bearing:137.6,pitch:63.5}},{id:"3",title:"Statue of Liberty",camera:{center:[-74.04546645789205,40.68964503655931],zoom:17,bearing:-60,pitch:70}}],Fre=()=>{const{map:n}=vy();return Ct.jsxs(QD,{children:[Ct.jsxs(vn.Group,{onChange:o=>{const l=o.target.value;n==null||n.setConfigProperty("basemap","lightPreset",l)},children:[Ct.jsx(vn,{value:"day",children:"白天"}),Ct.jsx(vn,{value:"night",children:"晚上"}),Ct.jsx(vn,{value:"dusk",children:"黄昏"}),Ct.jsx(vn,{value:"dawn",children:"黎明"})]}),Ct.jsx(xD,{style:{margin:"6px 0"}}),Ct.jsx(vn.Group,{onChange:o=>{const l=o.target.value;n==null||n.flyTo(l.camera)},children:Ore.map(o=>Ct.jsx(vn,{value:o,children:o.title},o.id))})]})},eL=[{index:!0,name:"3D尝鲜",path:"3d-taste",element:Ct.jsx(Fre,{})},{name:"标准样式",path:"standard-style",element:Ct.jsx(Lre,{})}],Bre=Hte([{id:"root",path:"/",element:Ct.jsx(kre,{}),errorElement:Ct.jsx(Rre,{}),children:eL},{path:"*",element:Ct.jsx(zre,{})}]);function Nre(){return Ct.jsx(Fte,{router:Bre,fallbackElement:Ct.jsx(Qte,{})})}const jre=(n,o)=>console.log(`%c ${n} %c v${o} `,"padding: 2px 1px; border-radius: 3px 0 0 3px; color: #fff; background: #606060; font-weight: bold;","padding: 2px 1px; border-radius: 0 3px 3px 0; color: #fff; background: #42c02e; font-weight: bold;");Cw.createRoot(document.getElementById("root")).render(Ct.jsx(VH,{locale:kD,theme:{algorithm:hD.darkAlgorithm},children:Ct.jsx(Nre,{})}));jre("version:",Ree.version);
